<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [ OWASP - Montr&#233;al ][ OWASP - Montr&#195;&#169;al ]XSFR/CSFR testing difficulty level
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-montreal%40lists.owasp.org?Subject=%3D%3Futf-8%3Fb%3FWyBPV0FTUCAtIE1vbnRyw6lhbCBd%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3F%3D5B_OWASP%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3F_-_Montr%3DC3%3DA9al_%3D5DXSFR/CSFR_testing_difficulty_le%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3Fvel%3F%3D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000028.html">
   <LINK REL="Next"  HREF="000036.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ OWASP - Montr&#233;al ][ OWASP - Montr&#195;&#169;al ]XSFR/CSFR testing difficulty level</H1>
    <B>Fortier, Hugo</B> 
    <A HREF="mailto:owasp-montreal%40lists.owasp.org?Subject=%3D%3Futf-8%3Fb%3FWyBPV0FTUCAtIE1vbnRyw6lhbCBd%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3F%3D5B_OWASP%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3F_-_Montr%3DC3%3DA9al_%3D5DXSFR/CSFR_testing_difficulty_le%3F%3D%0A%09%3D%3Fiso-8859-1%3Fq%3Fvel%3F%3D&In-Reply-To="
       TITLE="[ OWASP - Montr&#233;al ][ OWASP - Montr&#195;&#169;al ]XSFR/CSFR testing difficulty level">hugo at securitycompass.com
       </A><BR>
    <I>Thu Nov 27 23:11:15 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000028.html">[ OWASP - Montreal ] [ OWASP - Montr&#233;al ]XSFR/CSFR testing difficulty level
</A></li>
        <LI>Next message: <A HREF="000036.html">[ OWASP - Montreal ] [ OWASP - Montr&#233;al ] XSFR/CSFR testing difficulty level
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20">[ date ]</a>
              <a href="thread.html#20">[ thread ]</a>
              <a href="subject.html#20">[ subject ]</a>
              <a href="author.html#20">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>XSRF are everywhere, It doesn't mater if it's a GET or a POST. Any site can create post to any site using Javascript. Anytime that a request can be sent without needing a &quot;secret&quot; to perform a action on web it can be vulnerable to cross site request forgery. 

Session Management on most website rely uniquely on Session Cookie or Basic Auth. Some way to protect from XSRF is to verify a token that would be session or request related that would be sent across a post or a get request (it's better to send it in the post as get parameter are sometime leaker to third party site if they load or redirect to third party website).

I seen website that wouldn't require to enter back your password before changing it once your authenticated, with XSRF you can often force them to change their password. This is why it's a good practice to require a new authentication before any critical request, by example before allowing a money transfer, you might want to request the user to type in their password again or you might issue a unique token that would be embedded in the submit form.

The hard part of exploitation is to have the user connecting to your &quot;malicious&quot; website while they are on the website your targeting with your XSRF attack. It can be done effectively by clever social engineering or phishing attack, or if you are doing a MITM attack. I like the MITM attack approach to demonstrate those attack, if you can see the traffic of your victim even if it's SSL you know on witch site they are, and can hijack a secondary http connection that is in clear text to perform XSRF attack on the SSL site.

A other thing that you can attempt to exploit with XSRF are services binded on the localhost interface (or other service that might be in their LAN that isn't accessible from internet) of your victim, they often don't require authentication or your browser might send the credential automatically. By example IIS administration console used to be vulnerable to that if your where logged as Admin, not sure if that got fixed or not. 

In general if the website doesn't have a mechanism to protect against XSRF, they are vulnerable.

Hugo

-----Original Message-----
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-montreal">owasp-montreal-bounces at lists.owasp.org</A> on behalf of Laurent Desaulniers
Sent: Thu 11/27/2008 9:51 PM
To: Benoit Guerette
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-montreal">owasp-montreal at lists.owasp.org</A>
Subject: Re: [ OWASP - Montr&#195;&#169;al ]XSFR/CSFR testing difficulty level
 
Some XSRF are very easy to find. Most &quot;logout&quot; feature are vulnerable to xsrf. A good way to find XSRF is to try to reproduce the usual requests with netcat. Once you get a &quot;feel&quot; how the application works and what parameters are needed, you can test it easily. Simply create a local html file and embed your request in img tag. Then, load your page and voila.

But i have to agree with you. Most XSRF are difficult to exploit. A good way to test the &quot;xsrf potential&quot;, try to send POST requests as GET. For example, if your POST is 

POST /?password=mypassword&amp;user=toto then you may want to try GET password=mypassword&amp;user=toto

Some programmer (usually the slightly less experienced) forward the post to a get. Of course, this is a great XSRF potential. (Imagine an image called setpassword=mypasswordicanuse&amp;setemail=myevilhackeremail&amp;confirm=1

Lot of fun possible. Webscarab has a &quot;potential XSRF&quot; tool. It does not work too well but it is worth a try. 

I hope it helps


Laurent




On Thu, Nov 27, 2008 at 10:34 PM, Benoit Guerette &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-montreal">benoit.guerette at gmail.com</A>&gt; wrote:


	I don't know which term to use but I mean Cross Site Request Forgery
	(both seems ok).
	
	How do you test XSRF vulnerabilities? From what I can understand,
	finding a successful XSRF vulnerabilty need a lot of understanding of
	the web application, and lot of time. I don't thing lots of clients
	allow huge buffers $ for that kind of test, but it is so important.
	
	Forging a request with the right parameters values for success is very
	hard, and result are not always easy to see. Example: XSRF
	vulnerability of a bank web apps, allowing you to transfer money to
	your 'attacker' account. When you test, you cannot transfer money to
	your own account, so you need a friend at the same bank, leaving is
	session open and surfing to your 'blog' containing the the forged
	request hidden in the image html tags.
	
	My conclusion: XSRF vulnerability is easier and faster to find by
	talking to the dev team, asking them specific question (do you use a
	token associated with the session to avoid XSFR) to find the
	vulnerability?
	
	What did I miss? :) Thanks!
	
	--
	<A HREF="http://www.linkedin.com/in/benoitguerette">http://www.linkedin.com/in/benoitguerette</A>
	_______________________________________________
	Owasp-montreal mailing list
	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-montreal">Owasp-montreal at lists.owasp.org</A>
	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-montreal">https://lists.owasp.org/mailman/listinfo/owasp-montreal</A>
	




-- 
*CONFIDENTIALIT* L'information apparaissant dans ce message lectronique est de nature lgalement privilgie et confidentielle. Si ce message vous est parvenu par erreur et que vous n'tes pas le destinataire vis, vous tes par les prsentes avis que tout usage, copie ou distribution de ce message est strictement interdit. Vous tes donc pri de nous informer immdiatement de cette erreur et de dtruire ce message.



*CONFIDENTIALITY* The information in this message is legally privileged and confidential. In the event of a transmission error and if you are not the individual or entity mentioned above, you are hereby advised that any use, copying or reproduction of this document is strictly forbidden. Please advise us of this error and destroy this message.


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-montreal/attachments/20081127/4c374d7b/attachment.html">https://lists.owasp.org/pipermail/owasp-montreal/attachments/20081127/4c374d7b/attachment.html</A> 
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000028.html">[ OWASP - Montreal ] [ OWASP - Montr&#233;al ]XSFR/CSFR testing difficulty level
</A></li>
	<LI>Next message: <A HREF="000036.html">[ OWASP - Montreal ] [ OWASP - Montr&#233;al ] XSFR/CSFR testing difficulty level
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#20">[ date ]</a>
              <a href="thread.html#20">[ thread ]</a>
              <a href="subject.html#20">[ subject ]</a>
              <a href="author.html#20">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-montreal">More information about the Owasp-montreal
mailing list</a><br>
</body></html>
