<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [ OWASP - Montreal ] XSS and H1 tag
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-montreal%40lists.owasp.org?Subject=%5B%20OWASP%20-%20Montreal%20%5D%20XSS%20and%20H1%20tag&In-Reply-To=838c48810903010729x4d64c97em8264fd504eb2b633%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000085.html">
   <LINK REL="Next"  HREF="000086.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[ OWASP - Montreal ] XSS and H1 tag</H1>
    <B>Hugo Fortier</B> 
    <A HREF="mailto:owasp-montreal%40lists.owasp.org?Subject=%5B%20OWASP%20-%20Montreal%20%5D%20XSS%20and%20H1%20tag&In-Reply-To=838c48810903010729x4d64c97em8264fd504eb2b633%40mail.gmail.com"
       TITLE="[ OWASP - Montreal ] XSS and H1 tag">hugo at securitycompass.com
       </A><BR>
    <I>Sun Mar  1 15:02:06 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000085.html">[ OWASP - Montreal ] XSS and H1 tag
</A></li>
        <LI>Next message: <A HREF="000086.html">[ OWASP - Montreal ] XSS and H1 tag
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84">[ date ]</a>
              <a href="thread.html#84">[ thread ]</a>
              <a href="subject.html#84">[ subject ]</a>
              <a href="author.html#84">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Laurent,

Most HTML Injection can lead to cross site scripting or to cross site 
request forgery, only way you can protect yourself is proper encoding of 
any user input that are been redisplayed back to the user.  It seem that 
the site your testing does not do proper input validation and output 
encoding. OWASP have a PHP Anti XSS Library 
<A HREF="http://www.owasp.org/index.php/Category:OWASP_PHP_AntiXSS_Library_Project,">http://www.owasp.org/index.php/Category:OWASP_PHP_AntiXSS_Library_Project,</A> 
I have never used it so I can't tell you if it's good or not.

If you can inject &lt;&gt; you can usually inject image tag(&lt;img 
src='/admin/adduser?user=w00t&amp;password=w00t'&gt;) , very usefull for cross 
site request forgery. You can also probably play with frames, flash, 
activex... You don't need to use SCRIPT tag to take over a session.

Also depending on what type of detection they do, there is many way to 
manipulate for a script tag to look different &quot; &lt;script &gt;&quot;or just like 
you mention use onLoad parameter. Rsnake have put together a extensive 
list of what cross site scripting look like and  you can find it on his 
site (seem to be down right now) <A HREF="http://ha.ckers.org/xss.html,">http://ha.ckers.org/xss.html,</A> if it's 
not back up just use google cache to get it.

No mater what if they allow unencoded '&lt;' and '&gt;' character it's game 
over, 99.99% of the cases and even if they do there is still many 
payload that doesn't require to use tag. I also went across many user 
input that would be then use inside a script, In those case you just 
have to end the script line without breaking the code and add directly 
some code in there...

One of my coworker wrote a Firefox extension called XSS Me, that will 
test a huge quantity of payloads and tell you witch of them are 
successful for the page you want to test, you can find that tool in the 
Firefox Add-ons(  <A HREF="https://addons.mozilla.org/en-US/firefox/addon/7598">https://addons.mozilla.org/en-US/firefox/addon/7598</A>).

I also recommend a talk about BlackBox Reversing of XSS Filters that was 
given by Alexander Sotirov at my last conference 
<A HREF="http://recon.cx/2008/speakers.html#xss">http://recon.cx/2008/speakers.html#xss</A> | Video 
<A HREF="http://www.archive.org/details/RECON2008">http://www.archive.org/details/RECON2008</A>

Hugo
Laurent Desaulniers wrote:
&gt;<i> I have been doing a few black box testing on some php system. I found 
</I>&gt;<i> that i can escape the input box to write html. For example, i can add 
</I>&gt;<i> buttons, make the text bigger (using B or h1) but i am not able to 
</I>&gt;<i> insert scripts, so far.
</I>&gt;<i>
</I>&gt;<i> My question is: does any html injection can lead to script? Or is 
</I>&gt;<i> there some php mecanism that detects any use of javascript (ex: 
</I>&gt;<i> onLoad, img src=myscript.js)
</I>&gt;<i>
</I>&gt;<i> P.S. Sadly, i cant provide the link.
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> *CONFIDENTIALIT&#201;* L'information apparaissant dans ce message 
</I>&gt;<i> &#233;lectronique est de nature l&#233;galement privil&#233;gi&#233;e et confidentielle. 
</I>&gt;<i> Si ce message vous est parvenu par erreur et que vous n'&#234;tes pas le 
</I>&gt;<i> destinataire vis&#233;, vous &#234;tes par les pr&#233;sentes avis&#233; que tout usage, 
</I>&gt;<i> copie ou distribution de ce message est strictement interdit. Vous 
</I>&gt;<i> &#234;tes donc pri&#233; de nous informer imm&#233;diatement de cette erreur et de 
</I>&gt;<i> d&#233;truire ce message.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *CONFIDENTIALITY* The information in this message is legally 
</I>&gt;<i> privileged and confidential. In the event of a transmission error and 
</I>&gt;<i> if you are not the individual or entity mentioned above, you are 
</I>&gt;<i> hereby advised that any use, copying or reproduction of this document 
</I>&gt;<i> is strictly forbidden. Please advise us of this error and destroy this 
</I>&gt;<i> message.
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000085.html">[ OWASP - Montreal ] XSS and H1 tag
</A></li>
	<LI>Next message: <A HREF="000086.html">[ OWASP - Montreal ] XSS and H1 tag
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84">[ date ]</a>
              <a href="thread.html#84">[ thread ]</a>
              <a href="subject.html#84">[ subject ]</a>
              <a href="author.html#84">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-montreal">More information about the Owasp-montreal
mailing list</a><br>
</body></html>
