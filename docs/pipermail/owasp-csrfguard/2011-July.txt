From nmacaraeg at jaspersoft.com  Fri Jul  1 15:15:00 2011
From: nmacaraeg at jaspersoft.com (Normando Macaraeg)
Date: Fri, 1 Jul 2011 12:15:00 -0700 (PDT)
Subject: [Owasp-csrfguard] difference between session tokens and csrf tokens
Message-ID: <010f01cc3823$36c06110$a4412330$@com>

Please forgive me if this is a silly question, but unfortunately I could
not give my team a clean answer to this question.  The question was "What
is the difference between a session token and a CSRF token (as generated
by CSRFGuard)?"

 

My understanding is that a session token is unique per user connection.

 

On the other hand, CSRFGuard tokens are injected into all HTML forms, all
src and href attributes in each page presented to the user.  Additionally,
a CSRF prevention token can be generated per session, if configured to do
so.  Isn't this CSRF session token basically the same as the web app
session token?  Or am I comparing apples to oranges?

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110701/1d3d08bf/attachment.html 

From thomas at suse.de  Mon Jul  4 09:56:02 2011
From: thomas at suse.de (Thomas Biege)
Date: Mon, 4 Jul 2011 15:56:02 +0200
Subject: [Owasp-csrfguard] difference between session tokens and csrf
	tokens
In-Reply-To: <010f01cc3823$36c06110$a4412330$@com>
References: <010f01cc3823$36c06110$a4412330$@com>
Message-ID: <201107041556.02346.thomas@suse.de>

Am Freitag, 1. Juli 2011, 21:15:00 schrieb Normando Macaraeg:
> Please forgive me if this is a silly question, but unfortunately I could
> not give my team a clean answer to this question.  The question was "What
> is the difference between a session token and a CSRF token (as generated
> by CSRFGuard)?"
> 
>  
> 
> My understanding is that a session token is unique per user connection.
> 
>  
> 
> On the other hand, CSRFGuard tokens are injected into all HTML forms, all
> src and href attributes in each page presented to the user.  Additionally,
> a CSRF prevention token can be generated per session, if configured to do
> so.  Isn't this CSRF session token basically the same as the web app
> session token?  Or am I comparing apples to oranges?

The difference is in the technical details.
Today the session token is a session cookie or part of it. The browser
sends the session cookie automatically when it sends a HTTP request to a
side it has a cached cookie for. That is why CSRF attacks work for
restricted sites.
The CSRF token is used to protect POST requests and is not automatically
send but only with some user interaction. Example:
1.) admin goes to CreateUser page
2.) web-app puts a hidden field in CreateUser page that contains
    the random csrf token
3.) admin inserts user info and clicks submit
4.) the form fields and a hidden field containing the csrf token
    are send to the CreatUserSubmit page
5.) CreateUserSubmit verifies the correctness of the csrf token

An attacker would try to call CreateUserSubmit directly providing
the fom fields to create a new backdoor account and trick the admin
in "executing" this POST request.
This will not work anymore because the attacker does not know the random
csrf token and the CreateUSerSubmit page will reject the request therefore.

HTH
Thomas


-- 
Thomas Biege <thomas at suse.de>, SUSE LINUX, Security Support & Auditing
SUSE LINUX GmbH, GF: Jeff Hawn, Jennifer Guild, Felix Imend?rffer, HRB 21284 (AG N?rnberg
--
  Wer aufhoert besser werden zu wollen, hoert auf gut zu sein.
                            -- Marie von Ebner-Eschenbach

From pradtke at stanford.edu  Tue Jul  5 20:07:17 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Tue, 05 Jul 2011 17:07:17 -0700
Subject: [Owasp-csrfguard] Redirect with token not working when query
 parameters present and TokenPerPage=true
Message-ID: <4E13A735.6070105@stanford.edu>

Hi,

I needed support for appending the CSRF token as part of a redirect.
I saw this feature was available in git, but there is a bug that prevents it
from working when query parameters are present.
Basically 'isValidRequest' ignores query params, while 'getTokenValue' 
doesn't.

Example:
I access
/AccountApp/editmf
which redirects to
/AccountApp/editmf?execution=e1s1

After adding CSRF Guard
I access
{/AccountApp/editmf?OWASP_CSRFTOKEN=RSDP-3A22-LV7E-Y53P-ZSBE-QCJG-DLQS-FL6K}
the per page token is stored under the key '/AccountApp/editmf'
The redirect is to '/AccountApp/editmf?execution=e1s1' which
doesn't match the key, so the session token is used to construct the 
redirect url
/AccountApp/editmf?execution=e1s1&OWASP_CSRFTOKEN=OWZF-U0O1-4LKU-W4UR-40KB-0LRI-6TMF-5GCM
This happens in 'getTokenValue()'

However, when isValidRequest after the redirect, only 
'/AccountApp/editmf' is used to check the pageTokens map,
so the token no longer matches.

The 'location' needs the query params stripped off. I'm not familiar enough
with servlets to know if there is standard call to do that.

(approx line 75 of CsrfGuardFilter)
String location = redirectResponse.getLocation()

This all works fine if TokenPerPage=false.

thanks,

Patrick



From pradtke at stanford.edu  Wed Jul  6 13:58:09 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Wed, 06 Jul 2011 10:58:09 -0700
Subject: [Owasp-csrfguard] Redirect with token not working when query
 parameters present and TokenPerPage=true
In-Reply-To: <4E13A735.6070105@stanford.edu>
References: <4E13A735.6070105@stanford.edu>
Message-ID: <4E14A231.6070102@stanford.edu>

I'm not sure how to submit a patch via github so I've attached one here.
I didn't see any place for unit tests in the current code base, so my 
testing was
manual in one of our apps.

-Patrick

On 7/5/11 5:07 PM, Patrick Radtke wrote:
> Hi,
>
> I needed support for appending the CSRF token as part of a redirect.
> I saw this feature was available in git, but there is a bug that prevents it
> from working when query parameters are present.
> Basically 'isValidRequest' ignores query params, while 'getTokenValue'
> doesn't.
>
> Example:
> I access
> /AccountApp/editmf
> which redirects to
> /AccountApp/editmf?execution=e1s1
>
> After adding CSRF Guard
> I access
> {/AccountApp/editmf?OWASP_CSRFTOKEN=RSDP-3A22-LV7E-Y53P-ZSBE-QCJG-DLQS-FL6K}
> the per page token is stored under the key '/AccountApp/editmf'
> The redirect is to '/AccountApp/editmf?execution=e1s1' which
> doesn't match the key, so the session token is used to construct the
> redirect url
> /AccountApp/editmf?execution=e1s1&OWASP_CSRFTOKEN=OWZF-U0O1-4LKU-W4UR-40KB-0LRI-6TMF-5GCM
> This happens in 'getTokenValue()'
>
> However, when isValidRequest after the redirect, only
> '/AccountApp/editmf' is used to check the pageTokens map,
> so the token no longer matches.
>
> The 'location' needs the query params stripped off. I'm not familiar enough
> with servlets to know if there is standard call to do that.
>
> (approx line 75 of CsrfGuardFilter)
> String location = redirectResponse.getLocation()
>
> This all works fine if TokenPerPage=false.
>
> thanks,
>
> Patrick
>
>
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard

-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: redirect.patch
Url: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110706/dd87147f/attachment.pl 

From anderius+csrfguard at gmail.com  Thu Jul 14 06:44:52 2011
From: anderius+csrfguard at gmail.com (=?UTF-8?Q?Anders_B=C3=A5tstrand?=)
Date: Thu, 14 Jul 2011 12:44:52 +0200
Subject: [Owasp-csrfguard] The meaning of NewTokenLandingPage
Message-ID: <CAP7S1R9nU46xr-ubc3Bscp7gw20x-oLQ4P-=2YhEUsxK-wcreA@mail.gmail.com>

Hi

I am trying to use CSRFGuard in an application, but I am having some
troubles. First, let me start with a question about NewTokenLandingPage.

If I read the source code correct, the NewTokenLandingPage is written to the
response if session.isNew(), even if you visit an unprotected page.

I do not see the purpose of this, as the page does not require a token. Is
there someone that would like to elaborate on the meaning of the
NewTokenLandingPage?

The code I am talking about is in CsrfGuardFilter.java:

			if(session.isNew()) {

				csrfGuard.writeLandingPage(httpRequest, redirectResponse);

			} else if(csrfGuard.isValidRequest(httpRequest, redirectResponse)) {


				filterChain.doFilter(httpRequest, redirectResponse);

			} else {
				/** invalid request - nothing to do - actions already executed **/

			}



Best regards,

Anders B?tstrand

PS: Is there any plans for migrating the project to Maven, and using
automatic testing? I would be very happy to help in that matter.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110714/bc7dc314/attachment.html 

From pradtke at stanford.edu  Thu Jul 14 13:27:54 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Thu, 14 Jul 2011 10:27:54 -0700
Subject: [Owasp-csrfguard] The meaning of NewTokenLandingPage
In-Reply-To: <CAP7S1R9nU46xr-ubc3Bscp7gw20x-oLQ4P-=2YhEUsxK-wcreA@mail.gmail.com>
References: <CAP7S1R9nU46xr-ubc3Bscp7gw20x-oLQ4P-=2YhEUsxK-wcreA@mail.gmail.com>
Message-ID: <4E1F271A.2050404@stanford.edu>

On 7/14/11 3:44 AM, Anders B?tstrand wrote:
> Hi
>
> I am trying to use CSRFGuard in an application, but I am having some 
> troubles. First, let me start with a question about NewTokenLandingPage.
>
> If I read the source code correct, the NewTokenLandingPage is written 
> to the response if session.isNew(), even if you visit an unprotected 
> page.
I thought the CsrfGuardFilter would only get invoked if the page matched 
the URLs you defined as protected in the web.xml

<filter-mapping>
<filter-name>CSRFGuard</filter-name>
<url-pattern>/manage/mf/*</url-pattern>
</filter-mapping>

>
> I do not see the purpose of this, as the page does not require a 
> token. Is there someone that would like to elaborate on the meaning of 
> the NewTokenLandingPage?
I have never used it.
>
>
> PS: Is there any plans for migrating the project to Maven, and using 
> automatic testing? I would be very happy to help in that matter.
I would also be happy to help with such an effort.

-Patrick

From anderius+csrfguard at gmail.com  Fri Jul 15 06:04:07 2011
From: anderius+csrfguard at gmail.com (=?UTF-8?Q?Anders_B=C3=A5tstrand?=)
Date: Fri, 15 Jul 2011 12:04:07 +0200
Subject: [Owasp-csrfguard] The meaning of NewTokenLandingPage
In-Reply-To: <CAP7S1R_KLEC_qpRNMhZvKp-fk7e5OQ2Pwug-8UH65h6zbhZ+kg@mail.gmail.com>
References: <CAP7S1R9nU46xr-ubc3Bscp7gw20x-oLQ4P-=2YhEUsxK-wcreA@mail.gmail.com>
	<4E1F271A.2050404@stanford.edu>
	<CAP7S1R_KLEC_qpRNMhZvKp-fk7e5OQ2Pwug-8UH65h6zbhZ+kg@mail.gmail.com>
Message-ID: <CAP7S1R-7YFGjo-fSDOUZcMusq9ffkkuB+45kS5C-oYiKKG0QxA@mail.gmail.com>

On 14 July 2011 19:27, Patrick Radtke <pradtke at stanford.edu> wrote:

>  > If I read the source code correct, the NewTokenLandingPage is written
> > to the response if session.isNew(), even if you visit an unprotected
> > page.
> I thought the CsrfGuardFilter would only get invoked if the page matched
> the URLs you defined as protected in the web.xml
>
> <filter-mapping>
> <filter-name>CSRFGuard</filter-name>
> <url-pattern>/manage/mf/*</url-pattern>
> </filter-mapping>
>
> I am sorry I was not clear on my setup. To apply the principle of
white-listing, I apply the filter on all pages (except static resources),
and define all my exceptions (entry-points) in the properties file for
CSRFGuard (as uprotected pages).

I see that I could solve my problem by not applying the filter to pages I do
not want to be protected, but in my case the URLs are accessed from other
applications (so I can not change them), and I do not want to introduce a
URL rewrite filter only for this.

Regards,

Anders B?tstrand

2011/7/15 Anders B?tstrand <anderius at gmail.com>

>
>
> On 14 July 2011 19:27, Patrick Radtke <pradtke at stanford.edu> wrote:
>
>>  > If I read the source code correct, the NewTokenLandingPage is written
>> > to the response if session.isNew(), even if you visit an unprotected
>> > page.
>> I thought the CsrfGuardFilter would only get invoked if the page matched
>> the URLs you defined as protected in the web.xml
>>
>> <filter-mapping>
>> <filter-name>CSRFGuard</filter-name>
>> <url-pattern>/manage/mf/*</url-pattern>
>> </filter-mapping>
>>
>> I am sorry I was not clear on my setup. To apply the principle of
> white-listing, I apply the filter on all pages (except static resources),
> and define all my exceptions (entry-points) in the properties file for
> CSRFGuard (as uprotected pages).
>
> I see that I could solve my problem by not applying the filter to pages I
> do not want to be protected, but in my case the URLs are accessed from other
> applications (so I can not change them), and I do not want to introduce a
> URL rewrite filter only for this.
>
> Regards,
>
> Anders B?tstrand
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110715/510b34b1/attachment.html 

From pradtke at stanford.edu  Thu Jul 21 20:19:05 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Thu, 21 Jul 2011 17:19:05 -0700
Subject: [Owasp-csrfguard] The meaning of NewTokenLandingPage
In-Reply-To: <CAP7S1R9nU46xr-ubc3Bscp7gw20x-oLQ4P-=2YhEUsxK-wcreA@mail.gmail.com>
References: <CAP7S1R9nU46xr-ubc3Bscp7gw20x-oLQ4P-=2YhEUsxK-wcreA@mail.gmail.com>
Message-ID: <4E28C1F9.1050705@stanford.edu>

On 7/14/11 3:44 AM, Anders B?tstrand wrote:
> Hi
>
> I am trying to use CSRFGuard in an application, but I am having some 
> troubles. First, let me start with a question about NewTokenLandingPage.
>
> If I read the source code correct, the NewTokenLandingPage is written 
> to the response if session.isNew(), even if you visit an unprotected 
> page.
>
> I do not see the purpose of this, as the page does not require a 
> token. Is there someone that would like to elaborate on the meaning of 
> the NewTokenLandingPage?
>
> The code I am talking about is in CsrfGuardFilter.java:
>
> if(session.isNew()) {
>
>
> csrfGuard.writeLandingPage(httpRequest, redirectResponse);
>
>
> } else if(csrfGuard.isValidRequest(httpRequest, redirectResponse)) {
>
>
>
>
> filterChain.doFilter(httpRequest, redirectResponse);
>
>
> } else {
> /** invalid request - nothing to do - actions already executed **/
>
>
> }
We started moving our app to the white list approach as well.
We filter '/*' and then white list other things and have run into the 
same issue you describe.
For us the whole concept of NewTokenLandingPage is a non starter for us 
since we need to support
browsers with javascript disabled.

I removed the whole 'NewTokenLandingPage' landing page from the code 
CsrfGuardFilter
and now everything works. Non javascript users don't just get a blank page.
I think an option to disable NewTokenLandingPage may be the way to go.
I am also not sure the purpose of NewTokenLandingPage, since 
CsrfGuardListener
creates the token when the session is established. Maybe Eric Sheridan 
can weigh in.

Anyhow, the code changes we are deploying with are currently:

     if(csrfGuard.isValidRequest(httpRequest, redirectResponse)) {
                 filterChain.doFilter(httpRequest, redirectResponse);
             } else {
                 /** invalid request - nothing to do - actions already 
executed **/
             }

I'd be happy to set up a branch on github tomorrow for anyone that wants 
to pull this
change (and a redirect bug fix)

-Patrick

From cfpt at securitybyte.org  Sat Jul 23 12:09:46 2011
From: cfpt at securitybyte.org (Papers, Call For)
Date: Sat, 23 Jul 2011 21:39:46 +0530
Subject: [Owasp-csrfguard] CFP Secuirtybyte India
Message-ID: <CAKDYTU2vEezd=RQJ+4rkSpk9F5mxY6R0zSDpMOa5xkMx7rf3dw@mail.gmail.com>

Hi All,


 The first round of speakers have been selected for Securitybyte, please
follow us on twitter @securitybyte to get the latest updates on speakers and
event.



Deral Heiland, From Printer to Owned: Leveraging Multifunction Printers
During Penetration Testing

Nithya Raman, Security threats on social networks

Alexander Polyakov, A Crushing Blow At the Heart of SAP J2EE Engine

Bishan Singh, Enabling Un-trusted Mashups

Krzysztof Kotowicz, HTML5: Something Wicked This Way Comes

John McColl, Hacking Corporate Telephony

Aseem Jakhar, Runtime thread injection and execution in Linux processes

George Nicolaou, Alternative Exploitation Vectors (A study of CVE-3333)

Michele Orru, Securing the Browser

Kanwal K. Mookhey, The Data Theft Epidemic in India

Vivek Ramachandran, Enterprise Wi-Fi Worms, Backdoors and Botnets for Fun
and Profit



The 2nd round of CFP is out



CFP/CTP



Securitybyte is proud to announce its Second Annual International
Information Security Conference, "Securitybyte 2011" in Bangalore, India.
This 4-day event features two days of conferences and two days of
post-conference hands-on Trainings & Certifications covering every aspect of
Information Security. The Securitybyte conference features some of the most
respected names in the Security space and is focused around new research and
innovation. The Securitybyte Conference 2011 is planned for Sept 6th through
9th, 2011 at The Taj Hotel in Bangalore, India.



The two-day conference (Sept 6th & 7th) will have the following three
tracks:



    Deep Technical

   Government & Governance

    Management



Submission Deadline: The first round of submission of papers for conference
talks and trainings should be done no later than August 5th, 2011. Please
send all your submissions to cfp at securitybyte.org, keeping subject line as
"SB 2011 CFP Submission".



TOPICS



Got a new attack against any technology or device? We want to see it.



Topics of interest include, but are not limited to, the following:



Management

                Case studies around any of the topics above of how the
implementation was done and what were some of the lessons learned.



Technology-Focused



                Cloud Security

                Electronic Device Security (Cell Phones / PDA's)

                Defeating Biometrics

                WLAN, RFID and Bluetooth Security

                Data Recovery and Incident Response

                Virtualization Security

                Database Security

                Forensic & Cyber security



Regulatory & Law



                Copyright infringement and anti-copyright infringement
enforcement technologies

                Critical infrastructure issues

                Data security and privacy issues

                Identity theft, identity creation & identity fraud

                Corporate Espionage





National Security



    Cyber forensics

    Cyber warfare

    Cyber Espionage

    Next hyphenGen Cyber threats

    Critical Infrastructure protection

    Surveillance & counter-surveillance



Speaker Submission:



Please use the following submission form template to respond:



    Name, title, address, email, and phone/contact number

    Short biography, qualifications, occupation, achievements, and
affiliations (limit 250 words.)

    Summary or abstract of your presentation (limit 1250 words.)

    Technical requirements (video, internet, wireless, audio, etc.)

    References (Contact name, title, and email address of two conferences
you have spoken at or comparable references.)



Please note, product or vendor pitches are not accepted. If your talk
involves an advertisement for a new product or service your company is
offering, please do not submit a proposal.


Regards
SecurityBytes
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110723/a72c7df9/attachment.html 

From nirav.shah83 at gmail.com  Fri Jul 29 10:29:47 2011
From: nirav.shah83 at gmail.com (Nirav)
Date: Fri, 29 Jul 2011 15:29:47 +0100
Subject: [Owasp-csrfguard] Cant Get Forms Working
In-Reply-To: <CAA1+OusxzpbF=EvjsF8eecp8yTXsyDmJE+d=jabExjBeh=yY2g@mail.gmail.com>
References: <CAA1+OusxzpbF=EvjsF8eecp8yTXsyDmJE+d=jabExjBeh=yY2g@mail.gmail.com>
Message-ID: <CAA1+OuubCCYTmbSRZu=J=FzZ8oE-aqwbdvtR9O+Wb-K1_2_2qQ@mail.gmail.com>

Hello All !

I just got the latest version of the CSRFGuard from github and built it and
deployed it on our application on Glassfish 2.1. We use Stripes as our MVC.
Most parts of the app seem to be working fine and I see the token being
injected where it should be. But I cant get any of the forms to work. The
POST in firebug shows the token being sent. But when its intercepted by the
CSRFGuardFilter - it does not find it. I debugged further and found that
there were no request parameters at all in my HTTPRequest !

Any idea what the weirdness is? We have been at it for two days now ! :(

Regards!
Nirav
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110729/f7396184/attachment.html 

From pradtke at stanford.edu  Fri Jul 29 11:45:36 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Fri, 29 Jul 2011 08:45:36 -0700
Subject: [Owasp-csrfguard] Cant Get Forms Working
In-Reply-To: <CAA1+OuubCCYTmbSRZu=J=FzZ8oE-aqwbdvtR9O+Wb-K1_2_2qQ@mail.gmail.com>
References: <CAA1+OusxzpbF=EvjsF8eecp8yTXsyDmJE+d=jabExjBeh=yY2g@mail.gmail.com>
	<CAA1+OuubCCYTmbSRZu=J=FzZ8oE-aqwbdvtR9O+Wb-K1_2_2qQ@mail.gmail.com>
Message-ID: <4E32D5A0.7020005@stanford.edu>

On 7/29/11 7:29 AM, Nirav wrote:
> Hello All !
>
> I just got the latest version of the CSRFGuard from github and built 
> it and deployed it on our application on Glassfish 2.1. We use Stripes 
> as our MVC. Most parts of the app seem to be working fine and I see 
> the token being injected where it should be. But I cant get any of the 
> forms to work. The POST in firebug shows the token being sent. But 
> when its intercepted by the CSRFGuardFilter - it does not find it. I 
> debugged further and found that there were no request parameters at 
> all in my HTTPRequest !
>
> Any idea what the weirdness is? We have been at it for two days now ! :(
>
> Regards!
> Nirav
>
Are you posting with the token as a form parameter, or are you posting 
to URL that contains the token?
We post to a url that contains the token and that works fine.
Are you using the JavaScript library or the JSTL tags?

-Patrick


-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110729/cfb85db4/attachment.html 

From nirav.shah83 at gmail.com  Fri Jul 29 11:59:06 2011
From: nirav.shah83 at gmail.com (Nirav)
Date: Fri, 29 Jul 2011 16:59:06 +0100
Subject: [Owasp-csrfguard] Cant Get Forms Working
In-Reply-To: <4E32D5A0.7020005@stanford.edu>
References: <CAA1+OusxzpbF=EvjsF8eecp8yTXsyDmJE+d=jabExjBeh=yY2g@mail.gmail.com>
	<CAA1+OuubCCYTmbSRZu=J=FzZ8oE-aqwbdvtR9O+Wb-K1_2_2qQ@mail.gmail.com>
	<4E32D5A0.7020005@stanford.edu>
Message-ID: <CAA1+Outz+zJEo4n0+FXwKPhWRSnhyjkX2oYyN=Uzj51AqXRugQ@mail.gmail.com>

Hi Patrick,

Thanks for replying. We are using the Javascript DOM Manipulation. The
application POSTs to a URL without the token.
The token's included in the Referer header. A firebug snapshot attached.

Thanks!
Nirav



On Fri, Jul 29, 2011 at 4:45 PM, Patrick Radtke <pradtke at stanford.edu>wrote:

>  On 7/29/11 7:29 AM, Nirav wrote:
>
> Hello All !
>
> I just got the latest version of the CSRFGuard from github and built it and
> deployed it on our application on Glassfish 2.1. We use Stripes as our MVC.
> Most parts of the app seem to be working fine and I see the token being
> injected where it should be. But I cant get any of the forms to work. The
> POST in firebug shows the token being sent. But when its intercepted by the
> CSRFGuardFilter - it does not find it. I debugged further and found that
> there were no request parameters at all in my HTTPRequest !
>
> Any idea what the weirdness is? We have been at it for two days now ! :(
>
> Regards!
> Nirav
>
>  Are you posting with the token as a form parameter, or are you posting to
> URL that contains the token?
> We post to a url that contains the token and that works fine.
> Are you using the JavaScript library or the JSTL tags?
>
> -Patrick
>
>
>
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110729/d4b02524/attachment-0001.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PostHeader.JPG
Type: image/jpeg
Size: 120772 bytes
Desc: not available
Url : https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110729/d4b02524/attachment-0001.jpe 

From pradtke at stanford.edu  Sat Jul 30 16:56:10 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Sat, 30 Jul 2011 13:56:10 -0700
Subject: [Owasp-csrfguard] Cant Get Forms Working
In-Reply-To: <CAA1+Outz+zJEo4n0+FXwKPhWRSnhyjkX2oYyN=Uzj51AqXRugQ@mail.gmail.com>
References: <CAA1+OusxzpbF=EvjsF8eecp8yTXsyDmJE+d=jabExjBeh=yY2g@mail.gmail.com>
	<CAA1+OuubCCYTmbSRZu=J=FzZ8oE-aqwbdvtR9O+Wb-K1_2_2qQ@mail.gmail.com>
	<4E32D5A0.7020005@stanford.edu>
	<CAA1+Outz+zJEo4n0+FXwKPhWRSnhyjkX2oYyN=Uzj51AqXRugQ@mail.gmail.com>
Message-ID: <4E346FEA.1070103@stanford.edu>

On 7/29/11 8:59 AM, Nirav wrote:
> Hi Patrick,
>
> Thanks for replying. We are using the Javascript DOM Manipulation. The 
> application POSTs to a URL without the token.
> The token's included in the Referer header. A firebug snapshot attached.
>
> Thanks!
> Nirav

Nirav,

The token should be added as a hidden form field. The referer header 
just shows which page you were posting from, in
your case you are posting from a page that had a token in the URL.

I would use a javascript debugger and look at why the token isn't being 
added as a hidden from field.

-Patrick
>
>
>
> On Fri, Jul 29, 2011 at 4:45 PM, Patrick Radtke <pradtke at stanford.edu 
> <mailto:pradtke at stanford.edu>> wrote:
>
>     On 7/29/11 7:29 AM, Nirav wrote:
>>     Hello All !
>>
>>     I just got the latest version of the CSRFGuard from github and
>>     built it and deployed it on our application on Glassfish 2.1. We
>>     use Stripes as our MVC. Most parts of the app seem to be working
>>     fine and I see the token being injected where it should be. But I
>>     cant get any of the forms to work. The POST in firebug shows the
>>     token being sent. But when its intercepted by the CSRFGuardFilter
>>     - it does not find it. I debugged further and found that there
>>     were no request parameters at all in my HTTPRequest !
>>
>>     Any idea what the weirdness is? We have been at it for two days
>>     now ! :(
>>
>>     Regards!
>>     Nirav
>>
>     Are you posting with the token as a form parameter, or are you
>     posting to URL that contains the token?
>     We post to a url that contains the token and that works fine.
>     Are you using the JavaScript library or the JSTL tags?
>
>     -Patrick
>
>
>
>     _______________________________________________
>     Owasp-csrfguard mailing list
>     Owasp-csrfguard at lists.owasp.org
>     <mailto:Owasp-csrfguard at lists.owasp.org>
>     https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>
>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20110730/2a9bc20c/attachment.html 

