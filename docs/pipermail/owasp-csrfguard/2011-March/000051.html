<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] CSRFGuard and Spring MVC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20CSRFGuard%20and%20Spring%20MVC&In-Reply-To=AANLkTind8EpX9weUHwwFBQtQntGYyEWS%3D-3_peZXyz83%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000049.html">
   <LINK REL="Next"  HREF="000048.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] CSRFGuard and Spring MVC</H1>
    <B>Avner Cohen</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20CSRFGuard%20and%20Spring%20MVC&In-Reply-To=AANLkTind8EpX9weUHwwFBQtQntGYyEWS%3D-3_peZXyz83%40mail.gmail.com"
       TITLE="[Owasp-csrfguard] CSRFGuard and Spring MVC">AvnerCo at fundtech.co.il
       </A><BR>
    <I>Tue Mar  8 04:00:16 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000049.html">[Owasp-csrfguard] CSRFGuard and Spring MVC
</A></li>
        <LI>Next message: <A HREF="000048.html">[Owasp-csrfguard] unable to deploy CSRFGAURD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51">[ date ]</a>
              <a href="thread.html#51">[ thread ]</a>
              <a href="subject.html#51">[ subject ]</a>
              <a href="author.html#51">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Eric,

Your description of the issue is correct.

In terms of resolution, after complex review of the CSRF risks, We will
have to take an all new approach for our specific solution.

To your suggested solution, I'm not sure if it will solve the problem
without understanding the details of CSRFGuard implementation,  if you
suggest setting a simple Boolean to support this, I would even suggest
avoiding this, I think that in all redirect cases, you'd want to use
this feature.


One suggestion, to get CSRFGuard on its fit, it might be good for you to
create a complete test case in for example, the PetClinic example of
Spring MVC, this way you'll know for sure if there are any basic
features missing in the implementation.


 

Regards,
       Avner Cohen


-----Original Message-----
From: eric sheridan [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">eric.sheridan at owasp.org</A>] 
Sent: Tuesday, March 08, 2011 12:18 AM
To: Avner Cohen
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>
Subject: Re: [Owasp-csrfguard] CSRFGuard and Spring MVC

Avner,

&gt;<i>From your note below, it sounds like you're running into the following
</I>- please confirm: You're returning a &quot;redirect:&quot; prefix in your
controller forcing Spring to send the user to a different url. This
destination url requires the csrf token yet the token is not included
in the redirect and thus the &quot;required token is missing from the
request&quot;. Correct?

I don't think I have a good solution/work-around with what is present
in the current code base. I suspect someone using
response.sendRedirect(&quot;mypage.html&quot;) would have the same exact
problem. What I could do is implement a check in CsrfGuard to see if
your application is redirecting the user to another page. If the url
is to be protected by csrfguard, it will automatically include the
token for you. All the user would have to do is set some property (ex:
&quot;org.owasp.csrfguard.Redirect&quot;) to true. What do you think about that
fix? Think that would address your problem(s)?

-Eric

On Thu, Mar 3, 2011 at 4:01 PM, Avner Cohen &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">AvnerCo at fundtech.co.il</A>&gt;
wrote:
&gt;<i> Greetings,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I'm trying to implement CSRFGuard in an existing application, based
</I>(to some
&gt;<i> degree) on Spring MVC.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Despite seeing the INPUT value being past to the application (HTTP
</I>Proxy is
&gt;<i> used to check that), I am still getting the &quot;error:required token is
</I>missing
&gt;<i> from the request&quot; error.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Some analysis on this is suggesting that this is happening when
</I>redirect is
&gt;<i> used in the Spring MVC code
</I>&gt;<i>
</I>(<A HREF="http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html#mvc">http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html#mvc</A>
-redirecting-redirect-prefix)
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is rather unfortunate and I'd appreciate input in this regards.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> --Avner
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-csrfguard mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000049.html">[Owasp-csrfguard] CSRFGuard and Spring MVC
</A></li>
	<LI>Next message: <A HREF="000048.html">[Owasp-csrfguard] unable to deploy CSRFGAURD
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51">[ date ]</a>
              <a href="thread.html#51">[ thread ]</a>
              <a href="subject.html#51">[ subject ]</a>
              <a href="author.html#51">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
