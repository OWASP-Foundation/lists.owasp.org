<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] CSRFGuard and Spring MVC
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20CSRFGuard%20and%20Spring%20MVC&In-Reply-To=94A96E51ABBF2F47B4F11D83F2714AC6F68956%40mail01.fundtech.isr">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000047.html">
   <LINK REL="Next"  HREF="000051.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] CSRFGuard and Spring MVC</H1>
    <B>eric sheridan</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20CSRFGuard%20and%20Spring%20MVC&In-Reply-To=94A96E51ABBF2F47B4F11D83F2714AC6F68956%40mail01.fundtech.isr"
       TITLE="[Owasp-csrfguard] CSRFGuard and Spring MVC">eric.sheridan at owasp.org
       </A><BR>
    <I>Mon Mar  7 17:18:12 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000047.html">[Owasp-csrfguard] CSRFGuard and Spring MVC
</A></li>
        <LI>Next message: <A HREF="000051.html">[Owasp-csrfguard] CSRFGuard and Spring MVC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Avner,

&gt;<i>From your note below, it sounds like you're running into the following
</I>- please confirm: You're returning a &quot;redirect:&quot; prefix in your
controller forcing Spring to send the user to a different url. This
destination url requires the csrf token yet the token is not included
in the redirect and thus the &quot;required token is missing from the
request&quot;. Correct?

I don't think I have a good solution/work-around with what is present
in the current code base. I suspect someone using
response.sendRedirect(&quot;mypage.html&quot;) would have the same exact
problem. What I could do is implement a check in CsrfGuard to see if
your application is redirecting the user to another page. If the url
is to be protected by csrfguard, it will automatically include the
token for you. All the user would have to do is set some property (ex:
&quot;org.owasp.csrfguard.Redirect&quot;) to true. What do you think about that
fix? Think that would address your problem(s)?

-Eric

On Thu, Mar 3, 2011 at 4:01 PM, Avner Cohen &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">AvnerCo at fundtech.co.il</A>&gt; wrote:
&gt;<i> Greetings,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I&#8217;m trying to implement CSRFGuard in an existing application, based (to some
</I>&gt;<i> degree) on Spring MVC.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Despite seeing the INPUT value being past to the application (HTTP Proxy is
</I>&gt;<i> used to check that), I am still getting the &#8220;error:required token is missing
</I>&gt;<i> from the request&#8221; error.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Some analysis on this is suggesting that this is happening when redirect is
</I>&gt;<i> used in the Spring MVC code
</I>&gt;<i> (<A HREF="http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html#mvc-redirecting-redirect-prefix">http://static.springsource.org/spring/docs/2.0.x/reference/mvc.html#mvc-redirecting-redirect-prefix</A>)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is rather unfortunate and I&#8217;d appreciate input in this regards.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> --Avner
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-csrfguard mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000047.html">[Owasp-csrfguard] CSRFGuard and Spring MVC
</A></li>
	<LI>Next message: <A HREF="000051.html">[Owasp-csrfguard] CSRFGuard and Spring MVC
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#49">[ date ]</a>
              <a href="thread.html#49">[ thread ]</a>
              <a href="subject.html#49">[ subject ]</a>
              <a href="author.html#49">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
