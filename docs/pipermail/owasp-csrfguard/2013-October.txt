From mchyzer at isc.upenn.edu  Tue Oct  1 05:10:56 2013
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Tue, 1 Oct 2013 05:10:56 +0000
Subject: [Owasp-csrfguard] first request is not protected?
In-Reply-To: <5245CF6F.3020500@stanford.edu>
References: <04BE669BEE19E54BBDC2A9A2585BB6886CD8A2FF@exch-mbx01.exchange.upenn.edu>
	<CAKrLoaTnBucOXprTWZFyBEDUAH8V_AnLKO-64Y6qOQ8JwUaUEw@mail.gmail.com>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE41ADF@exch-mbx01.exchange.upenn.edu>
	<5245CF6F.3020500@stanford.edu>
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB6886CE44E52@exch-mbx01.exchange.upenn.edu>

I have a protected URL: /whatever, and the first request can go through CSRFguard, but subsequent requests cannot (they go to the error page).  Shouldn't the first request by default be protected unless that page is allowed in the properties file?  Is there a setting I can change to make the first request be protected?  Granted I understand that users will need to login, but I would prefer if all requests to protected resources are protected unless the CSRF token is there.  I tried this setting and it didn't seem to work...  


# New Token Redirect Page
#
# Defines where to send a user if the token is being generated for the first time.
# Failure to define a redirect page will allow CSRF attacks to work for unauthenticated
# users
org.owasp.csrfguard.NewTokenRedirectPage=/myApp/assets/html/csrfError.html

Thanks,
Chris

From mchyzer at isc.upenn.edu  Tue Oct  1 19:17:37 2013
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Tue, 1 Oct 2013 19:17:37 +0000
Subject: [Owasp-csrfguard] first request is not protected?
References: <04BE669BEE19E54BBDC2A9A2585BB6886CD8A2FF@exch-mbx01.exchange.upenn.edu>
	<CAKrLoaTnBucOXprTWZFyBEDUAH8V_AnLKO-64Y6qOQ8JwUaUEw@mail.gmail.com>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE41ADF@exch-mbx01.exchange.upenn.edu>
	<5245CF6F.3020500@stanford.edu> 
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB6886CE4ADE1@exch-mbx01.exchange.upenn.edu>

Not sure if this is the culprit... but I don't really understand it: (from CsrfGuardFilter)

			if (session == null) {
				// If there is no session, no harm can be done
				filterChain.doFilter(httpRequest, (HttpServletResponse) response);
				return;
			}

Isnt it possible a request to come not from an existing session that would be single-signed on with a cookie, and authenticated, authorized, and perform the action?  Seems like this shouldn't pass through, but should be checked by csrfguard (even if it is an option to do so for people who want it).  I guess this assumes the Java session timeout is exactly the same or greater than the authentication timeout.  At Penn that is not the case.  You could be timed out from the Java app, but the single sign on cookie will get you right back in without redirect or user-input, I think this is a gap.  Another use case is you have a bunch of apps on one apache, you are logged in to one, the single sign on cookie is valid, but you have no session on another, it would be vulnerable to CSRF.

Thanks,
Chris


-----Original Message-----
From: Chris Hyzer 
Sent: Tuesday, October 01, 2013 1:11 AM
To: owasp-csrfguard at lists.owasp.org
Subject: first request is not protected?

I have a protected URL: /whatever, and the first request can go through CSRFguard, but subsequent requests cannot (they go to the error page).  Shouldn't the first request by default be protected unless that page is allowed in the properties file?  Is there a setting I can change to make the first request be protected?  Granted I understand that users will need to login, but I would prefer if all requests to protected resources are protected unless the CSRF token is there.  I tried this setting and it didn't seem to work...  


# New Token Redirect Page
#
# Defines where to send a user if the token is being generated for the first time.
# Failure to define a redirect page will allow CSRF attacks to work for unauthenticated
# users
org.owasp.csrfguard.NewTokenRedirectPage=/myApp/assets/html/csrfError.html

Thanks,
Chris

From pradtke at stanford.edu  Tue Oct  1 21:15:09 2013
From: pradtke at stanford.edu (Patrick Radtke)
Date: Tue, 01 Oct 2013 14:15:09 -0700
Subject: [Owasp-csrfguard] first request is not protected?
In-Reply-To: <04BE669BEE19E54BBDC2A9A2585BB6886CE4ADE1@exch-mbx01.exchange.upenn.edu>
References: <04BE669BEE19E54BBDC2A9A2585BB6886CD8A2FF@exch-mbx01.exchange.upenn.edu>
	<CAKrLoaTnBucOXprTWZFyBEDUAH8V_AnLKO-64Y6qOQ8JwUaUEw@mail.gmail.com>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE41ADF@exch-mbx01.exchange.upenn.edu>
	<5245CF6F.3020500@stanford.edu>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE4ADE1@exch-mbx01.exchange.upenn.edu>
Message-ID: <524B3B5D.1010500@stanford.edu>

I know in your original email you stated the app was sessionless. Where 
are you storing the CSRFGuard session data? In our Single sign on 
scenarios we create the session prior to the CsrfGuardFilter filter 
running, so this hadn't been an issue.




On 10/1/13 12:17 PM, Chris Hyzer wrote:
> Not sure if this is the culprit... but I don't really understand it: (from CsrfGuardFilter)
>
> 			if (session == null) {
> 				// If there is no session, no harm can be done
> 				filterChain.doFilter(httpRequest, (HttpServletResponse) response);
> 				return;
> 			}
>
> Isnt it possible a request to come not from an existing session that would be single-signed on with a cookie, and authenticated, authorized, and perform the action?  Seems like this shouldn't pass through, but should be checked by csrfguard (even if it is an option to do so for people who want it).  I guess this assumes the Java session timeout is exactly the same or greater than the authentication timeout.  At Penn that is not the case.  You could be timed out from the Java app, but the single sign on cookie will get you right back in without redirect or user-input, I think this is a gap.  Another use case is you have a bunch of apps on one apache, you are logged in to one, the single sign on cookie is valid, but you have no session on another, it would be vulnerable to CSRF.
>
> Thanks,
> Chris
>
>
> -----Original Message-----
> From: Chris Hyzer
> Sent: Tuesday, October 01, 2013 1:11 AM
> To: owasp-csrfguard at lists.owasp.org
> Subject: first request is not protected?
>
> I have a protected URL: /whatever, and the first request can go through CSRFguard, but subsequent requests cannot (they go to the error page).  Shouldn't the first request by default be protected unless that page is allowed in the properties file?  Is there a setting I can change to make the first request be protected?  Granted I understand that users will need to login, but I would prefer if all requests to protected resources are protected unless the CSRF token is there.  I tried this setting and it didn't seem to work...
>
>
> # New Token Redirect Page
> #
> # Defines where to send a user if the token is being generated for the first time.
> # Failure to define a redirect page will allow CSRF attacks to work for unauthenticated
> # users
> org.owasp.csrfguard.NewTokenRedirectPage=/myApp/assets/html/csrfError.html
>
> Thanks,
> Chris
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>


From ajay.pinninti at gmail.com  Sun Oct  6 05:17:31 2013
From: ajay.pinninti at gmail.com (apinninti .)
Date: Sun, 6 Oct 2013 10:47:31 +0530
Subject: [Owasp-csrfguard] Problem in using CSRF 3
In-Reply-To: <CAK1TbwmL0pCeBGgPGjsb0j49axHQzPZAkJzGdeyTphzGSZ5r4A@mail.gmail.com>
References: <CAK1TbwmL0pCeBGgPGjsb0j49axHQzPZAkJzGdeyTphzGSZ5r4A@mail.gmail.com>
Message-ID: <CAK1Tbwm22J2Df6TgCx2RHtRgYUWqpJYjzBEy=p0urUCh3ZmZZw@mail.gmail.com>

Hi,

I am started using CSRF for one of the projects and I am facing few
problems. we are using websphere with Struts 1.3 and SSL enabled.I am able
to configure CSRF, but the issues are

1. Web pages contains tab, click on tab will get submitted to same page and
I am having problem with Page Token. since Same action class get called
CSRF returning a exception "request token does not match page token". How
to fix this problem.
2. I have jsp page contains a text field order no lookup page with search
button. these buttons we declared as unprotected pages. by declaring these
pages as unprotected, we are allowing some one can create dummy request for
these pages and able to do Request Forgery, How can we fix this problem.

please help me in resolving these problem.

Thanks

Ajay Pinninti


On Sun, Oct 6, 2013 at 10:44 AM, apinninti . <ajay.pinninti at gmail.com>wrote:

> Hi,
>
> I am started using CSRF for one of the projects and I am facing few
> problems. we are using websphere with Struts 1.3 and SSL enabled.I am able
> to configure CSRF, but the issues are
>
> 1. Web pages contains tab, click on tab will get submitted to same page
> and I am having problem with Page Token. since Same action class get called
> CSRF returning a exception "request token does not match page token". How
> to fix this problem.
> 2. I have jsp page contains a text field order no lookup page with search
> button. these buttons we declared as unprotected pages. by declaring these
> pages as unprotected, we are allowing some one can create dummy request for
> these pages and able to do Request Forgery, How can we fix this problem.
>
> please help me in resolving these problem.
>
> Thanks
>
> Ajay Pinninti
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20131006/9d0e1672/attachment.html>

From mchyzer at isc.upenn.edu  Mon Oct  7 20:58:10 2013
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Mon, 7 Oct 2013 20:58:10 +0000
Subject: [Owasp-csrfguard] problems with dynamic images
In-Reply-To: <524B3B5D.1010500@stanford.edu>
References: <04BE669BEE19E54BBDC2A9A2585BB6886CD8A2FF@exch-mbx01.exchange.upenn.edu>
	<CAKrLoaTnBucOXprTWZFyBEDUAH8V_AnLKO-64Y6qOQ8JwUaUEw@mail.gmail.com>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE41ADF@exch-mbx01.exchange.upenn.edu>
	<5245CF6F.3020500@stanford.edu>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE4ADE1@exch-mbx01.exchange.upenn.edu>
	<524B3B5D.1010500@stanford.edu>
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB6886CE5EB9E@exch-mbx01.exchange.upenn.edu>

I have a QR code that I would like not to be able to be requested unless the CSRF token is there.  Its not really working.  When I just have this it doesn't work (get an error about potential problem):

<img src="UiMain.qrCode.gif" height="300" width="300" />


And when I try to put the token in the query string, it also doesn't work (same error).  It does put two tokens in the request sometimes though (the Javascript at work... maybe it should see if there is already a code in the query string and not change those)

<img src="UiMain.qrCode.gif?<csrf:token-name/>=<csrf:token-value uri="${pageContext.request.contextPath}/twoFactorUi/app/UiMain.qrCode.gif"/>" height="300" width="300" />

Its not that important so I can add it to the ignore entries I guess

Thanks,
Chris

From mchyzer at isc.upenn.edu  Mon Oct 14 05:20:34 2013
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Mon, 14 Oct 2013 05:20:34 +0000
Subject: [Owasp-csrfguard] context root in config for unprotected, and regex
In-Reply-To: <04BE669BEE19E54BBDC2A9A2585BB6886CE5EB9E@exch-mbx01.exchange.upenn.edu>
References: <04BE669BEE19E54BBDC2A9A2585BB6886CD8A2FF@exch-mbx01.exchange.upenn.edu>
	<CAKrLoaTnBucOXprTWZFyBEDUAH8V_AnLKO-64Y6qOQ8JwUaUEw@mail.gmail.com>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE41ADF@exch-mbx01.exchange.upenn.edu>
	<5245CF6F.3020500@stanford.edu>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE4ADE1@exch-mbx01.exchange.upenn.edu>
	<524B3B5D.1010500@stanford.edu>
	<04BE669BEE19E54BBDC2A9A2585BB6886CE5EB9E@exch-mbx01.exchange.upenn.edu>
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB6886CE66DC0@exch-mbx01.exchange.upenn.edu>

A gap I see in using csrf guard in my project is the context root being in the config file.  I would like the same config to be able to be deployed to any context root for the application.  For example:

org.owasp.csrfguard.unprotected.SomePage=/contextRoot/somePage
org.owasp.csrfguard.unprotected.SomeOtherPage=/contextRoot/someOtherPage

I would like to be able to configure instead:

org.owasp.csrfguard.unprotected.SomePage=$$contextRoot$$/somePage
org.owasp.csrfguard.unprotected.SomeOtherPage=$$contextRoot$$/someOtherPage

And have Java figure out the context root (if there even is one), and substitute that in.  For the unprotected pages it would be nice if it supported regex somehow too.  Something like this?  (assume context root is not part of the regex, must be in front)

org.owasp.csrfguard.unprotectedRegex.SomePages=$$contextRoot$$^/somePage.*View.*$

Are these things I could try to code and contribute back to the project?  If so, if there are any guidelines, instructions, or advice please let me know.

Thanks,
Chris

From mchyzer at isc.upenn.edu  Sun Oct 20 15:22:15 2013
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Sun, 20 Oct 2013 15:22:15 +0000
Subject: [Owasp-csrfguard] Double Refresh for every request
In-Reply-To: <CAKrLoaTnBucOXprTWZFyBEDUAH8V_AnLKO-64Y6qOQ8JwUaUEw@mail.gmail.com>
References: <04BE669BEE19E54BBDC2A9A2585BB6886CD8A2FF@exch-mbx01.exchange.upenn.edu>
	<CAKrLoaTnBucOXprTWZFyBEDUAH8V_AnLKO-64Y6qOQ8JwUaUEw@mail.gmail.com>
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB6886CE6AC63@exch-mbx01.exchange.upenn.edu>

Not sure if anyone else is having problems with this message from last year.  I have this problem.  I am using dojo, and I can reproduce it on chrome on windows, and other browsers / OSs...

It seems like the CSRFGuard javascript is adding the token to scripts, css, and images in the page, and browser is making dual requests, and re-rendering the page.

I think ideally, if a URL pattern is ignored in the config, the Javascript should ignore urls or hrefs of that pattern as well.  However, the simple solution for me is to just ignore those tags in the javascript since I don't want any CSS or javascript (or images) protected by csrfguard.

So change the CSRF javascript:

FROM:   (line 340)

        /** inject into attribute **/
      } else if(%INJECT_ATTRIBUTES% == true) {
        injectTokenAttribute(element, "src", tokenName, tokenValue, pageTokens);
        injectTokenAttribute(element, "href", tokenName, tokenValue, pageTokens);
      }

TO:

        /** inject into attribute **/
      } else if(%INJECT_ATTRIBUTES% == true) {
        if(element.tagName.toLowerCase() != "script" && element.tagName.toLowerCase() != "link" && element.tagName.toLowerCase() != "img") {
          injectTokenAttribute(element, "src", tokenName, tokenValue, pageTokens);
          injectTokenAttribute(element, "href", tokenName, tokenValue, pageTokens);
        }
      }



This fixes the problem... any chance we could get this or something like it into GIT for CSRFGuard?  Either this, or an option to do this (true/false), or code the javascript to honor the ignores in the config file...

Thanks,
Chris

[Owasp-csrfguard] Double Refresh for every request
Mehdi Bennani mehdibennani at hotmail.com <mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Double%20Refresh%20for%20every%20request&In-Reply-To=%3CSNT134-W58088A860BD9D732E5FB9FC3190%40phx.gbl%3E>
Thu May 17 15:31:37 UTC 2012

  *   Previous message: [Owasp-csrfguard] source code for 3.0.0.503 release<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/000143.html>
  *   Messages sorted by: [ date ]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/date.html#144> [ thread ]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/thread.html#144> [ subject ]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/subject.html#144> [ author ]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/author.html#144>

________________________________
Hi You guys,

I  have just set up CSRF guard to work with my strut2-spring  project. I have 2 issues:

1- For every request, all my resources are requested twice. I.e: all the css, images, etc...are requested twice, once without the OWASP token and once with the token.
In fact, a quick inspection through firebug reveals the following timeline:
- A bunch of GETs are issues (my resources) (without the OWASP token)
  Among them, a GET to OWASP JavaScriptServlet
- Then at some point, a POST to JavaScriptServlet is sent out
- Then a slew of Gets (the same ones as before, i.e: my resources) this time with the ?OWASP_CSRFTOKEN=... appended to each GET

Is this how is it supposed to be working?? I must have configured something wrong....
I mean even I would like to disregard the performance loss related to the double requests, my site is loads funny now, as it loads without the CSS/JS at first (so looks pretty much ugly), then a split of a second later, the site is refreshed and everything is there. It is slow enough that we can notice it.

2- When I login, it fails with a 403. I checked my form submission and it does not seem to contain the OWASP_CSRTOKEN. Hence the 403...

Any help is appreciated,

Here is my config:

org.owasp.csrfguard.Logger=org.owasp.csrfguard.log.ConsoleLogger
org.owasp.csrfguard.TokenPerPage=true
org.owasp.csrfguard.Ajax=true

org.owasp.csrfguard.unprotected.DefaultHome=/localhost/home
org.owasp.csrfguard.unprotected.403=/localhost/403.jsp
org.owasp.csrfguard.unprotected.404=/localhost/404.jsp

org.owasp.csrfguard.action.Log=org.owasp.csrfguard.action.Log
org.owasp.csrfguard.action.Log.Message=potential cross-site request forgery (CSRF) attack thwarted (user:%user%, ip:%remote_ip%, uri:%request_uri%, error:%exception_message%)
org.owasp.csrfguard.action.Redirect=org.owasp.csrfguard.action.Redirect
org.owasp.csrfguard.action.Redirect.Page=/localhost/403.jsp
org.owasp.csrfguard.action.Rotate=org.owasp.csrfguard.action.Rotate

org.owasp.csrfguard.TokenName=OWASP_CSRFTOKEN
org.owasp.csrfguard.SessionKey=OWASP_CSRFTOKEN
org.owasp.csrfguard.TokenLength=32
org.owasp.csrfguard.PRNG=SHA1PRNG

And JavaScriptServlet

   <servlet>
       <servlet-name>JavaScriptServlet</servlet-name>
       <servlet-class>org.owasp.csrfguard.servlet.JavaScriptServlet</servlet-class>
         <init-param>
            <param-name>source-file</param-name>
            <param-value>WEB-INF/Owasp.CsrfGuard.js</param-value>
         </init-param>
         <init-param>
            <param-name>inject-into-forms</param-name>
            <param-value>true</param-value>
         </init-param>
         <init-param>
            <param-name>inject-into-attributes</param-name>
            <param-value>true</param-value>
         </init-param>
         <init-param>
            <param-name>domain-strict</param-name>
            <param-value>false</param-value>
         </init-param>
         <init-param>
            <param-name>referer-pattern</param-name>
            <param-value>.*localhost.*</param-value>
         </init-param>
    </servlet>
    <servlet-mapping>
           <servlet-name>JavaScriptServlet</servlet-name>
           <url-pattern>/JavaScriptServlet</url-pattern>
    </servlet-mapping>

Elextra/
-------------- next part --------------
An HTML attachment was scrubbed...

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20131020/399beba3/attachment-0001.html>

From mchyzer at isc.upenn.edu  Fri Oct 25 05:12:13 2013
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Fri, 25 Oct 2013 05:12:13 +0000
Subject: [Owasp-csrfguard] Owasp-csrfguard Digest, Vol 38, Issue 6
In-Reply-To: <002401ced133$d0b87590$722960b0$@gmail.com>
References: <mailman.3618.1382282600.2550.owasp-csrfguard@lists.owasp.org>
	<002401ced133$d0b87590$722960b0$@gmail.com>
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB6886CE70868@exch-mbx01.exchange.upenn.edu>

I was using the latest chrome on windows 7, though I believe my colleague was on a mac.

I had HTML that had dojo, and some CSS and images, and the browser would request the resource, then URL rewriting from CSRFguard would take place and change the link or src, and the request would happen again.

Thanks,
Chris

-----Original Message-----
From: Manish Java [mailto:manish.in.java at gmail.com] 
Sent: Thursday, October 24, 2013 11:39 PM
To: Chris Hyzer
Cc: owasp-csrfguard at lists.owasp.org
Subject: RE: Owasp-csrfguard Digest, Vol 38, Issue 6

Hi Chris

I will take a look at this issue and let you know of my findings.  In the
meantime, could you help me by providing the following information:

1. Which OS is the problem seen on?
2. Which browser and version is the problem seen on?
3. Steps to reproduce the problem.

Cheers
~ Manish

----------------------------------------------------------------------

Message: 1
Date: Sun, 20 Oct 2013 15:22:15 +0000
From: Chris Hyzer <mchyzer at isc.upenn.edu>
To: "owasp-csrfguard at lists.owasp.org"
	<owasp-csrfguard at lists.owasp.org>
Subject: [Owasp-csrfguard] Double Refresh for every request
Message-ID:
	
<04BE669BEE19E54BBDC2A9A2585BB6886CE6AC63 at exch-mbx01.exchange.upenn.edu>
	
Content-Type: text/plain; charset="us-ascii"

Not sure if anyone else is having problems with this message from last year.
I have this problem.  I am using dojo, and I can reproduce it on chrome on
windows, and other browsers / OSs...

It seems like the CSRFGuard javascript is adding the token to scripts, css,
and images in the page, and browser is making dual requests, and
re-rendering the page.

I think ideally, if a URL pattern is ignored in the config, the Javascript
should ignore urls or hrefs of that pattern as well.  However, the simple
solution for me is to just ignore those tags in the javascript since I don't
want any CSS or javascript (or images) protected by csrfguard.

So change the CSRF javascript:

FROM:   (line 340)

        /** inject into attribute **/
      } else if(%INJECT_ATTRIBUTES% == true) {
        injectTokenAttribute(element, "src", tokenName, tokenValue,
pageTokens);
        injectTokenAttribute(element, "href", tokenName, tokenValue,
pageTokens);
      }

TO:

        /** inject into attribute **/
      } else if(%INJECT_ATTRIBUTES% == true) {
        if(element.tagName.toLowerCase() != "script" &&
element.tagName.toLowerCase() != "link" && element.tagName.toLowerCase() !=
"img") {
          injectTokenAttribute(element, "src", tokenName, tokenValue,
pageTokens);
          injectTokenAttribute(element, "href", tokenName, tokenValue,
pageTokens);
        }
      }



This fixes the problem... any chance we could get this or something like it
into GIT for CSRFGuard?  Either this, or an option to do this (true/false),
or code the javascript to honor the ignores in the config file...

Thanks,
Chris

[Owasp-csrfguard] Double Refresh for every request Mehdi Bennani
mehdibennani at hotmail.com
<mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard
%5D%20Double%20Refresh%20for%20every%20request&In-Reply-To=%3CSNT134-W58088A
860BD9D732E5FB9FC3190%40phx.gbl%3E>
Thu May 17 15:31:37 UTC 2012

  *   Previous message: [Owasp-csrfguard] source code for 3.0.0.503
release<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/000143.htm
l>
  *   Messages sorted by: [ date
]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/date.html#144> [
thread
]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/thread.html#144>
[ subject
]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/subject.html#144
> [ author
]<http://lists.owasp.org/pipermail/owasp-csrfguard/2012-May/author.html#144>

________________________________
Hi You guys,

I  have just set up CSRF guard to work with my strut2-spring  project. I
have 2 issues:

1- For every request, all my resources are requested twice. I.e: all the
css, images, etc...are requested twice, once without the OWASP token and
once with the token.
In fact, a quick inspection through firebug reveals the following timeline:
- A bunch of GETs are issues (my resources) (without the OWASP token)
  Among them, a GET to OWASP JavaScriptServlet
- Then at some point, a POST to JavaScriptServlet is sent out
- Then a slew of Gets (the same ones as before, i.e: my resources) this time
with the ?OWASP_CSRFTOKEN=... appended to each GET

Is this how is it supposed to be working?? I must have configured something
wrong....
I mean even I would like to disregard the performance loss related to the
double requests, my site is loads funny now, as it loads without the CSS/JS
at first (so looks pretty much ugly), then a split of a second later, the
site is refreshed and everything is there. It is slow enough that we can
notice it.

2- When I login, it fails with a 403. I checked my form submission and it
does not seem to contain the OWASP_CSRTOKEN. Hence the 403...

Any help is appreciated,

Here is my config:

org.owasp.csrfguard.Logger=org.owasp.csrfguard.log.ConsoleLogger
org.owasp.csrfguard.TokenPerPage=true
org.owasp.csrfguard.Ajax=true

org.owasp.csrfguard.unprotected.DefaultHome=/localhost/home
org.owasp.csrfguard.unprotected.403=/localhost/403.jsp
org.owasp.csrfguard.unprotected.404=/localhost/404.jsp

org.owasp.csrfguard.action.Log=org.owasp.csrfguard.action.Log
org.owasp.csrfguard.action.Log.Message=potential cross-site request forgery
(CSRF) attack thwarted (user:%user%, ip:%remote_ip%, uri:%request_uri%,
error:%exception_message%)
org.owasp.csrfguard.action.Redirect=org.owasp.csrfguard.action.Redirect
org.owasp.csrfguard.action.Redirect.Page=/localhost/403.jsp
org.owasp.csrfguard.action.Rotate=org.owasp.csrfguard.action.Rotate

org.owasp.csrfguard.TokenName=OWASP_CSRFTOKEN
org.owasp.csrfguard.SessionKey=OWASP_CSRFTOKEN
org.owasp.csrfguard.TokenLength=32
org.owasp.csrfguard.PRNG=SHA1PRNG

And JavaScriptServlet

   <servlet>
       <servlet-name>JavaScriptServlet</servlet-name>
 
<servlet-class>org.owasp.csrfguard.servlet.JavaScriptServlet</servlet-class>
         <init-param>
            <param-name>source-file</param-name>
            <param-value>WEB-INF/Owasp.CsrfGuard.js</param-value>
         </init-param>
         <init-param>
            <param-name>inject-into-forms</param-name>
            <param-value>true</param-value>
         </init-param>
         <init-param>
            <param-name>inject-into-attributes</param-name>
            <param-value>true</param-value>
         </init-param>
         <init-param>
            <param-name>domain-strict</param-name>
            <param-value>false</param-value>
         </init-param>
         <init-param>
            <param-name>referer-pattern</param-name>
            <param-value>.*localhost.*</param-value>
         </init-param>
    </servlet>
    <servlet-mapping>
           <servlet-name>JavaScriptServlet</servlet-name>
           <url-pattern>/JavaScriptServlet</url-pattern>
    </servlet-mapping>

Elextra/
-------------- next part --------------
An HTML attachment was scrubbed...

-------------- next part --------------
An HTML attachment was scrubbed...
URL:
<http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20131020/399be
ba3/attachment.html>

------------------------------

_______________________________________________
Owasp-csrfguard mailing list
Owasp-csrfguard at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-csrfguard


End of Owasp-csrfguard Digest, Vol 38, Issue 6
**********************************************


From eric.sheridan at owasp.org  Fri Oct 25 13:50:20 2013
From: eric.sheridan at owasp.org (Eric Sheridan)
Date: Fri, 25 Oct 2013 09:50:20 -0400
Subject: [Owasp-csrfguard] CSRFGuard Java Project Needs a Leader
Message-ID: <526A771C.80802@owasp.org>

Folks,

The CSRFGuard Java Project is in desperate need of leadership and TLC.
There have been numerous bug submissions, a couple security related, for
which I do not have the time to address. The project has been moving
along slowly thanks to generous contributions from the community, but
the project as a whole is not keeping up with demand.

Unfortunately, I do not have the time to lead and support this project
anymore. Professional development and product management have completely
taken over. For this reason, I am resigning as the lead of the OWASP
CSRFGuard Java Project. I strongly encourage those of you who are
interested in taking the project further to speak up and work with
Samantha Groves (CCed) to communicate your interest in leadership and
facilitate the transition of ownership.

Thanks to everyone for their support over the years. I hope that by my
stepping back, the CSRFGuard Java project will prosper.

-- 
Sincerely,
Eric Sheridan
(twitter) @eric_sheridan
(blog) http://ericsheridan.blogspot.com

From samantha.groves at owasp.org  Fri Oct 25 15:39:12 2013
From: samantha.groves at owasp.org (Samantha Groves)
Date: Fri, 25 Oct 2013 08:39:12 -0700
Subject: [Owasp-csrfguard] CSRFGuard Java Project Needs a Leader
In-Reply-To: <526A771C.80802@owasp.org>
References: <526A771C.80802@owasp.org>
Message-ID: <CA+EttN_J=-PspOuKpQq5SZXgE6jH1My7JAWhtcPksbAJxhMTfg@mail.gmail.com>

Hello Eric,


Azzeddine, cced into this message, is very interested in helping out.
Please touch base with each other to sort out whether you can
collaborate/transition the project duties?

Thank you, Eric and Azzeddine.

SG



On Fri, Oct 25, 2013 at 6:50 AM, Eric Sheridan <eric.sheridan at owasp.org>wrote:

> Folks,
>
> The CSRFGuard Java Project is in desperate need of leadership and TLC.
> There have been numerous bug submissions, a couple security related, for
> which I do not have the time to address. The project has been moving
> along slowly thanks to generous contributions from the community, but
> the project as a whole is not keeping up with demand.
>
> Unfortunately, I do not have the time to lead and support this project
> anymore. Professional development and product management have completely
> taken over. For this reason, I am resigning as the lead of the OWASP
> CSRFGuard Java Project. I strongly encourage those of you who are
> interested in taking the project further to speak up and work with
> Samantha Groves (CCed) to communicate your interest in leadership and
> facilitate the transition of ownership.
>
> Thanks to everyone for their support over the years. I hope that by my
> stepping back, the CSRFGuard Java project will prosper.
>
> --
> Sincerely,
> Eric Sheridan
> (twitter) @eric_sheridan
> (blog) http://ericsheridan.blogspot.com
>



-- 

*Samantha Groves, MBA*****

*OWASP Projects Manager*

*
*

The OWASP Foundation

Phoenix, USA

Email: samantha.groves at owasp.org

Skype: samanthahz


OWASP Global Projects<https://www.owasp.org/index.php/Category:OWASP_Project>

Book a Meeting with Me <http://goo.gl/mZXdZ>

OWASP Contact US Form <http://owasp4.owasp.org/contactus.html>

New Project Application
Form<https://docs.google.com/a/owasp.org/spreadsheet/viewform?formkey=dHZfWGhHZ0Z4UFFwZU42djBXcVVLSlE6MQ#gid=0>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20131025/3c4c3c46/attachment.html>

From azzeddine.ramrami at owasp.org  Fri Oct 25 16:27:32 2013
From: azzeddine.ramrami at owasp.org (OWASP)
Date: Fri, 25 Oct 2013 18:27:32 +0200
Subject: [Owasp-csrfguard] [Owasp-leaders] CSRFGuard Java Project Needs
	a Leader
Message-ID: <526a9bf4.c6dab40a.360c.ffff9e7d@mx.google.com>

Hi,
My Skype id is azzeddine.ramrami
My phone number is 00 33 6 65 48 90 04
I will be available to chat starting from this Sunday.
Regards,
Azzeddine

-----Original Message-----
From: Samantha Groves
Sent: 25/10/2013 17:40
To: Eric Sheridan
Cc: owasp-csrfguard at lists.owasp.org; Leaders
Subject: Re: [Owasp-leaders] CSRFGuard Java Project Needs a Leader

Hello Eric,






Azzeddine, cced into this message, is very interested in helping out. Please touch base with each other to sort out whether you can collaborate/transition the project duties?
 



Thank you, Eric and Azzeddine.




SG






On Fri, Oct 25, 2013 at 6:50 AM, Eric Sheridan <eric.sheridan at owasp.org> wrote:
 
Folks,
 
The CSRFGuard Java Project is in desperate need of leadership and TLC.
 There have been numerous bug submissions, a couple security related, for
 which I do not have the time to address. The project has been moving
 along slowly thanks to generous contributions from the community, but
 the project as a whole is not keeping up with demand.
 
Unfortunately, I do not have the time to lead and support this project
 anymore. Professional development and product management have completely
 taken over. For this reason, I am resigning as the lead of the OWASP
 CSRFGuard Java Project. I strongly encourage those of you who are
 interested in taking the project further to speak up and work with
 Samantha Groves (CCed) to communicate your interest in leadership and
 facilitate the transition of ownership.
 
Thanks to everyone for their support over the years. I hope that by my
 stepping back, the CSRFGuard Java project will prosper.
 
--
 Sincerely,
 Eric Sheridan
 (twitter) @eric_sheridan
 (blog) http://ericsheridan.blogspot.com
 





-- 


Samantha Groves, MBA
 
OWASP Projects Manager

 


The OWASP Foundation

 Phoenix, USA

Email: samantha.groves at owasp.org
 
Skype: samanthahz 

 


OWASP Global Projects
 
Book a Meeting with Me

 OWASP Contact US Form

 New Project Application Form

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20131025/d4db271f/attachment.html>

