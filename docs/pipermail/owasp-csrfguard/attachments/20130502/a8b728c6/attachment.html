<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&#39;ve&nbsp;a&nbsp;simple&nbsp;Email&nbsp;application&nbsp;in&nbsp;servlets.&nbsp;I&nbsp;want&nbsp;to&nbsp;secure&nbsp;email&nbsp;sending&nbsp;using&nbsp;the&nbsp;csrfguard.&nbsp;The&nbsp;Compose&nbsp;and&nbsp;Send&nbsp;servlets&nbsp;are&nbsp;differerent.&nbsp;The&nbsp;compose&nbsp;servlet&nbsp;just&nbsp;displays&nbsp;the&nbsp;compose&nbsp;page&nbsp;and&nbsp;the&nbsp;send&nbsp;page&nbsp;is&nbsp;invoked&nbsp;to&nbsp;send&nbsp;the&nbsp;mail.&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&#39;ve&nbsp;installed&nbsp;and&nbsp;configured&nbsp;it&nbsp;according&nbsp;to&nbsp;the&nbsp;document. &lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;For&nbsp;protecting&nbsp;the&nbsp;send&nbsp;page,&nbsp;I&#39;ve&nbsp;added&nbsp;it&nbsp;in&nbsp;filter&nbsp;like&nbsp;:&lt;/div&gt;<br>
&lt;div&nbsp;style&gt;&lt;div&gt; &nbsp; &nbsp;&lt;filter-mapping&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;filter-name&gt;CSRFGuard&lt;/filter-name&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;url-pattern&gt;/servlet/Send&lt;/url-pattern&gt;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/filter-mapping&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;When&nbsp;any&nbsp;user&nbsp;logs&nbsp;in&nbsp;and&nbsp;sends&nbsp;mail,&nbsp;he&nbsp;gets&nbsp;error&nbsp;from&nbsp;csrf.&nbsp;In&nbsp;log&nbsp;it&nbsp;shows&nbsp;:&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;div&gt;&lt;div&gt;[Thu&nbsp;May&nbsp;02&nbsp;17:02:27&nbsp;IST&nbsp;2013]&nbsp;[Info]&nbsp;CsrfGuard&nbsp;analyzing&nbsp;request&nbsp;/baya/servlet/Send&lt;/div&gt;<br>
&lt;div&gt;[Thu&nbsp;May&nbsp;02&nbsp;17:02:27&nbsp;IST&nbsp;2013]&nbsp;[Error]&nbsp;potential&nbsp;cross-site&nbsp;request&nbsp;forgery&nbsp;(CSRF)&nbsp;attack&nbsp;thwarted&nbsp;(&lt;a&nbsp;href=&quot;mailto:user%3Aabuse@test.int&quot;&gt;user:abuse@test.int&lt;/a&gt;,&nbsp;ip:192.168.0.17,&nbsp;uri:/baya/servlet/Send,&nbsp;error:required&nbsp;token&nbsp;is&nbsp;missing&nbsp;from&nbsp;the&nbsp;request&nbsp;org.owasp.csrfguard.CsrfGuardException:&nbsp;required&nbsp;token&nbsp;is&nbsp;missing&nbsp;from&nbsp;the&nbsp;request)&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;I&nbsp;think&nbsp;I&#39;m&nbsp;missing&nbsp;something&nbsp;here.&lt;/div&gt;&lt;div&nbsp;style&gt;Can&nbsp;anyone&nbsp;help&nbsp;me&nbsp;out&nbsp;?&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Thanks,&lt;/div&gt;&lt;div&nbsp;style&gt;Amol.&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
