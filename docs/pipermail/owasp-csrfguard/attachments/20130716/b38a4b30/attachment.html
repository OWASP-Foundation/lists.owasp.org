<tt>
&lt;p&gt;You&nbsp;Rule!&nbsp;&nbsp;It&nbsp;does&nbsp;indeed&nbsp;work,&nbsp;but&nbsp;now&nbsp;all&nbsp;my&nbsp;requests&nbsp;for&nbsp;images,&nbsp;css,&nbsp;etc&nbsp;all&nbsp;fail&nbsp;with&nbsp;missing&nbsp;token&nbsp;messages.&nbsp;&nbsp;I&nbsp;tried&nbsp;adding&nbsp;the&nbsp;config&nbsp;property&nbsp;org.owasp.csrfguard.Ajax=true,&nbsp;but&nbsp;this&nbsp;makes&nbsp;no&nbsp;difference.&nbsp;&nbsp;I&nbsp;still&nbsp;get&nbsp;a&nbsp;ton&nbsp;of&nbsp;messages&nbsp;like:&nbsp;&lt;strong&gt;Potential&nbsp;Cross-Site<br>
Request&nbsp;Forgery&nbsp;(CSRF)&nbsp;attack&nbsp;thwarted&nbsp;(user:&lt;anonymous&gt;,&nbsp;ip:127.0.0.1,&nbsp;uri:/drbms/img/sort_down.gif,&nbsp;error:required&nbsp;token&nbsp;is&nbsp;missing&nbsp;from&nbsp;the&nbsp;request)&lt;/strong&gt;.&nbsp;&nbsp;What&nbsp;am&nbsp;I&nbsp;missing&nbsp;now?&nbsp;&nbsp;Any&nbsp;ideas?&lt;/p&gt;&lt;p&gt;Also,&nbsp;I&nbsp;am&nbsp;now&nbsp;leaving&nbsp;the&nbsp;login&nbsp;page&nbsp;unprotected,&nbsp;which&nbsp;can't&nbsp;be&nbsp;a&nbsp;very&nbsp;good<br>
idea.&nbsp;&nbsp;Is&nbsp;there&nbsp;a&nbsp;better&nbsp;method&nbsp;using&nbsp;the&nbsp;NewTokenLandingPage?&nbsp;&nbsp;I&nbsp;still&nbsp;have&nbsp;that&nbsp;config&nbsp;setting,&nbsp;but&nbsp;it&nbsp;never&nbsp;goes&nbsp;there.&nbsp;&nbsp;Should&nbsp;the&nbsp;NewTokenLandingPage&nbsp;redirect&nbsp;to&nbsp;the&nbsp;login&nbsp;page,&nbsp;or&nbsp;what&nbsp;does&nbsp;it&nbsp;do?&nbsp;&nbsp;There&nbsp;isn't&nbsp;much&nbsp;discussion&nbsp;of&nbsp;this&nbsp;in&nbsp;the&nbsp;documentation,<br>
AFAIK.&lt;/p&gt;&lt;p&gt;Thanks&nbsp;very&nbsp;much&nbsp;for&nbsp;the&nbsp;help&nbsp;so&nbsp;far&nbsp;-&nbsp;there&nbsp;was&nbsp;some&nbsp;danger&nbsp;of&nbsp;me&nbsp;going&nbsp;berserk,&nbsp;which&nbsp;is&nbsp;now&nbsp;receding&nbsp;into&nbsp;the&nbsp;distance.&lt;/p&gt;&lt;p&gt;-&nbsp;Ray&nbsp;Clough&lt;/p&gt;&lt;p&gt;&nbsp;&lt;/p&gt;&lt;p&gt;&lt;br&nbsp;/&gt;----------------------------&nbsp;Original&nbsp;Message&nbsp;----------------------------&lt;br&nbsp;/&gt;<br>
Subject:&nbsp;RE:&nbsp;[Owasp-csrfguard]&nbsp;can't&nbsp;get&nbsp;it&nbsp;to&nbsp;work&lt;br&nbsp;/&gt;<br>
From:&nbsp;&quot;Tom&nbsp;Barber&quot;&nbsp;&lt;tom.a.barber@gmail.com&gt;&lt;br&nbsp;/&gt;<br>
Date:&nbsp;Tue,&nbsp;July&nbsp;16,&nbsp;2013&nbsp;2:30&nbsp;pm&lt;br&nbsp;/&gt;<br>
To:&nbsp;ray@allthisisthat.com&lt;br&nbsp;/&gt;<br>
owasp-csrfguard@lists.owasp.org&lt;br&nbsp;/&gt;<br>
--------------------------------------------------------------------------&lt;br&nbsp;/&gt;<br>
&lt;br&nbsp;/&gt;<br>
{C}&lt;!--&nbsp;begin&nbsp;sanitized&nbsp;html&nbsp;--&gt;<br>
&lt;style&nbsp;type=&quot;text/css&quot;&gt;<br>
-&gt;&lt;/style&gt;<br>
&lt;/tom.a.barber@gmail.com&gt;&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;bodyclass&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;Hi&nbsp;Ray,&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;I&rsquo;m&nbsp;not<br>
certain&nbsp;this&nbsp;is&nbsp;the&nbsp;case,&nbsp;but&nbsp;I&nbsp;believe&nbsp;I&nbsp;know&nbsp;the&nbsp;problem.&nbsp;If&nbsp;you&nbsp;look&nbsp;at&nbsp;the&nbsp;comments&nbsp;above&nbsp;the&nbsp;unprotected&nbsp;section&nbsp;of&nbsp;the&nbsp;property&nbsp;files&nbsp;the&nbsp;options&nbsp;it&nbsp;gives&nbsp;you&nbsp;are:&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;line-height:13.5pt&quot;&gt;&lt;i&gt;&lt;span&nbsp;style=&quot;font-size:9.0pt;font-family:Consolas;color:#999988&quot;&gt;#&nbsp;Case&nbsp;1:&nbsp;exact&nbsp;match&nbsp;between&nbsp;request&nbsp;uri&nbsp;and<br>
unprotected&nbsp;page&lt;/span&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;line-height:13.5pt&quot;&gt;&lt;i&gt;&lt;span&nbsp;style=&quot;font-size:9.0pt;font-family:Consolas;color:#999988&quot;&gt;#&nbsp;Case&nbsp;2:&nbsp;longest&nbsp;path&nbsp;prefix&nbsp;match,&nbsp;&lt;u&gt;beginning&nbsp;/&nbsp;and&nbsp;ending&nbsp;/*&lt;/u&gt;&lt;/span&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;line-height:13.5pt&quot;&gt;&lt;i&gt;&lt;span<br>
style=&quot;font-size:9.0pt;font-family:Consolas;color:#999988&quot;&gt;#&nbsp;Case&nbsp;3:&nbsp;extension&nbsp;match,&nbsp;&lt;u&gt;beginning&nbsp;*&lt;/u&gt;.&lt;/span&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;line-height:13.5pt&quot;&gt;&lt;i&gt;&lt;span&nbsp;style=&quot;font-size:9.0pt;font-family:Consolas;color:#999988&quot;&gt;#&nbsp;Default:&nbsp;requested&nbsp;resource&nbsp;must&nbsp;be&nbsp;validated&nbsp;by<br>
CSRFGuard&lt;/span&gt;&lt;/i&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;In&nbsp;your&nbsp;case&nbsp;you&nbsp;seem&nbsp;to&nbsp;have&nbsp;used&nbsp;wildcard&nbsp;in&nbsp;an&nbsp;unsupported&nbsp;manner&nbsp;&ldquo;/login*&rdquo;&nbsp;.&nbsp;Perhaps&nbsp;you&nbsp;could&nbsp;specify&nbsp;the&nbsp;exact&nbsp;uri<br>
&ldquo;&lt;/span&gt;&lt;strong&gt;drbms/login.seam&rdquo;&lt;/strong&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;strong&gt;&nbsp;&lt;/strong&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;Let&nbsp;me&nbsp;know&nbsp;if&nbsp;you&nbsp;have&nbsp;any&nbsp;luck.&lt;/span&gt;&lt;/p&gt;&lt;p<br>
class=&quot;MsoNormal&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;Thanks&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;Tom&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;span<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;mso-fareast-language:EN-US&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;lang=&quot;EN-US&quot;&nbsp;style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;&quot;&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;lang=&quot;EN-US&quot;<br>
style=&quot;font-size:11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;&quot;&gt;&nbsp;owasp-csrfguard-bounces@lists.owasp.org&nbsp;[mailto:owasp-csrfguard-bounces@lists.owasp.org]&nbsp;&lt;b&gt;On&nbsp;Behalf&nbsp;Of&nbsp;&lt;/b&gt;ray@allthisisthat.com&lt;br&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;Sent:&lt;/b&gt;&nbsp;16&nbsp;July&nbsp;2013&nbsp;21:44&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;To:&lt;/b&gt;&nbsp;owasp-csrfguard@lists.owasp.org&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;Subject:&lt;/b&gt;&nbsp;[Owasp-csrfguard]&nbsp;can't&nbsp;get&nbsp;it&nbsp;to&nbsp;work&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&nbsp;&lt;/p&gt;&lt;p&gt;I&nbsp;am&nbsp;unable&nbsp;to&nbsp;get&nbsp;the&nbsp;CsrfGuard&nbsp;filter&nbsp;to&nbsp;work.&nbsp;&nbsp;Regardless&nbsp;of&nbsp;the&nbsp;properties&nbsp;I&nbsp;set,&nbsp;the&nbsp;app&nbsp;tries&nbsp;to&nbsp;go&nbsp;to&nbsp;the&nbsp;login&nbsp;page,&nbsp;and&nbsp;I&nbsp;get&nbsp;this&nbsp;log&nbsp;message:&lt;/p&gt;&lt;p&gt;&lt;strong&gt;[Tue&nbsp;Jul&nbsp;16&nbsp;13:08:38&nbsp;PDT<br>
2013]&nbsp;[Error]&nbsp;Potential&nbsp;Cross-Site&nbsp;Request&nbsp;Forgery&nbsp;(CSRF)&nbsp;attack&nbsp;thwarted&nbsp;(user:&lt;anonymous&gt;,&nbsp;ip:127.0.0.1,&nbsp;uri:/drbms/login.seam,&nbsp;error:required&nbsp;token&nbsp;is&nbsp;missing&nbsp;from&nbsp;the&nbsp;request)&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;Obviously&nbsp;I&nbsp;am&nbsp;doing&nbsp;something&nbsp;wrong.&nbsp;&nbsp;Here&nbsp;is&nbsp;my&nbsp;configuration<br>
file&lt;/p&gt;&lt;p&gt;org.owasp.csrfguard.Logger=org.owasp.csrfguard.log.ConsoleLogger&lt;br&nbsp;/&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.UseNewTokenLandingPage=true&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.NewTokenLandingPage=/NewTokenLandingPage.html&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.TokenPerPage=true&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.TokenPerPagePrecreate=false&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.Ajax=false&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.unprotected.Index=/login*&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.action.Log=org.owasp.csrfguard.action.Log&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.action.Log.Message=Potential&nbsp;Cross-Site&nbsp;Request&nbsp;Forgery&nbsp;(CSRF)&nbsp;attack&nbsp;thwarted&nbsp;(user:%user%,&nbsp;ip:%remote_ip%,&nbsp;uri:%request_uri%,&nbsp;error:%exception_message%)&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.TokenName=OWASP_CSRFTOKEN&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.SessionKey=OWASP_CSRFTOKEN&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.TokenLength=32&lt;br&nbsp;/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;org.owasp.csrfguard.PRNG=SHA1PRNG&lt;/p&gt;&lt;p&gt;When&nbsp;the&nbsp;server&nbsp;starts,&nbsp;I&nbsp;see&nbsp;the&nbsp;config&nbsp;properties&nbsp;output&nbsp;to&nbsp;the&nbsp;console,&nbsp;so&nbsp;I&nbsp;know&nbsp;the&nbsp;config&nbsp;file&nbsp;is&nbsp;being&nbsp;read&nbsp;correctly.&lt;/p&gt;&lt;p&gt;I&nbsp;have&nbsp;tried&nbsp;various&nbsp;combinations&nbsp;of&nbsp;using&nbsp;a&nbsp;NewTokenLandingPage&nbsp;with&nbsp;the&nbsp;login&nbsp;page&nbsp;protected,&nbsp;and&nbsp;un-protecting&nbsp;the&nbsp;login<br>
page&nbsp;but&nbsp;not&nbsp;using&nbsp;a&nbsp;New&nbsp;Token&nbsp;Landing&nbsp;Page.&nbsp;&nbsp;Also,&nbsp;I&nbsp;have&nbsp;seen&nbsp;no&nbsp;info&nbsp;on&nbsp;what&nbsp;the&nbsp;New&nbsp;Token&nbsp;Landing&nbsp;Page&nbsp;needs&nbsp;to&nbsp;do&nbsp;-&nbsp;If&nbsp;I&nbsp;can&nbsp;ever&nbsp;get&nbsp;it&nbsp;to&nbsp;appear,&nbsp;my&nbsp;guess&nbsp;is&nbsp;that&nbsp;it&nbsp;needs&nbsp;to&nbsp;redirect&nbsp;to&nbsp;the&nbsp;login&nbsp;page.&nbsp;&nbsp;Is&nbsp;that&nbsp;correct?&nbsp;&nbsp;Also,&nbsp;all&nbsp;the&nbsp;examples&nbsp;use&nbsp;jsp,&nbsp;not&nbsp;facelets.&nbsp;&nbsp;Are<br>
there&nbsp;any&nbsp;issues&nbsp;with&nbsp;this&nbsp;difference?&nbsp;&nbsp;I&nbsp;built&nbsp;the&nbsp;project&nbsp;from&nbsp;source&nbsp;using&nbsp;the&nbsp;latest&nbsp;code.&lt;/p&gt;&lt;p&gt;Any&nbsp;help&nbsp;you&nbsp;could&nbsp;offer&nbsp;would&nbsp;be&nbsp;greatly&nbsp;appreciated.&lt;/p&gt;&lt;p&gt;&nbsp;&lt;/p&gt;&lt;p&gt;Thank&nbsp;you,&lt;/p&gt;&lt;p&gt;Ray&nbsp;Clough&lt;/p&gt;&lt;p&gt;&nbsp;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;!--&nbsp;end&nbsp;sanitized&nbsp;html&nbsp;--&gt;&lt;p&gt;&nbsp;&lt;/p&gt;
</tt>
