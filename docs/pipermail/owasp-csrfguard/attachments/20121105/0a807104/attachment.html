<tt>
&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;See&nbsp;the&nbsp;following&nbsp;pull&nbsp;request&nbsp;which&nbsp;fixes<br>
this&nbsp;issue:&nbsp;&lt;/font&gt;&lt;a&nbsp;href=&quot;https://github.com/esheri3/OWASP-CSRFGuard/pull/30&quot;&gt;&lt;font&nbsp;size=3&nbsp;color=blue&gt;&lt;u&gt;https://github.com/esheri3/OWASP-CSRFGuard/pull/30&lt;/u&gt;&lt;/font&gt;&lt;/a&gt;&lt;font&nbsp;size=3&gt;<br>
&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;hr&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Arial&quot;&gt;&lt;b&gt;Jason&nbsp;C&nbsp;Lindquist&lt;/b&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;color=#808080&nbsp;face=&quot;Arial&quot;&gt;Sr.&nbsp;Analyst,&nbsp;Development&nbsp;Support,<br>
Information&nbsp;Technology&nbsp;&nbsp;&#8226;&nbsp;&nbsp;Securian&nbsp;Financial&nbsp;Group&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;color=#808080&nbsp;face=&quot;Arial&quot;&gt;400&nbsp;Robert&nbsp;Street&nbsp;North&nbsp;&nbsp;&#8226;<br>
&nbsp;St.&nbsp;Paul,&nbsp;MN&nbsp;55101-2098&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;color=#808080&nbsp;face=&quot;Arial&quot;&gt;651-665-5771&lt;/font&gt;<br>
&lt;br&gt;&lt;a&nbsp;href=mailto:jason.lindquist@securian.com&gt;&lt;font&nbsp;size=2&nbsp;color=blue&nbsp;face=&quot;sans-serif&quot;&gt;jason.lindquist@securian.com&lt;/font&gt;&lt;/a&gt;&lt;font&nbsp;size=2&nbsp;color=#808080&nbsp;face=&quot;Arial&quot;&gt;<br>
&nbsp;&#8226;&nbsp;&nbsp;&lt;/font&gt;&lt;a&nbsp;href=www.securian.com&gt;&lt;font&nbsp;size=2&nbsp;color=blue&nbsp;face=&quot;sans-serif&quot;&gt;www.securian.com&lt;/font&gt;&lt;/a&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;color=#808080&nbsp;face=&quot;Arial&quot;&gt;Securian&nbsp;Financial&nbsp;Group&nbsp;&#8211;<br>
Financial&nbsp;security&nbsp;&lt;i&gt;for&nbsp;the&nbsp;long&nbsp;run&nbsp;&lt;/i&gt;®&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#808080&nbsp;face=&quot;Arial&quot;&gt;This&nbsp;email&nbsp;transmission&nbsp;and<br>
any&nbsp;file&nbsp;attachments&nbsp;may&nbsp;contain&nbsp;confidential&nbsp;information&nbsp;intended&nbsp;solely<br>
for&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;individual&nbsp;or&nbsp;entity&nbsp;to&nbsp;whom&nbsp;it&nbsp;is&nbsp;addressed.&nbsp;If&nbsp;you<br>
have&nbsp;received&nbsp;this&nbsp;email&nbsp;message&nbsp;in&nbsp;error,&nbsp;please&nbsp;notify&nbsp;the&nbsp;sender&nbsp;and<br>
delete&nbsp;this&nbsp;email&nbsp;from&nbsp;your&nbsp;system.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,<br>
you&nbsp;may&nbsp;not&nbsp;disclose,&nbsp;copy,&nbsp;or&nbsp;distribute&nbsp;the&nbsp;contents&nbsp;of&nbsp;this&nbsp;email.&lt;/font&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;<br>
&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;From:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;Eric&nbsp;Sheridan&nbsp;&lt;eric.sheridan@owasp.org&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;To:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;owasp-csrfguard@lists.owasp.org&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;11/05/2012&nbsp;07:27&nbsp;AM&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Subject:&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;Re:&nbsp;[Owasp-csrfguard]<br>
Possible&nbsp;bug&nbsp;in&nbsp;InterceptRedirectResponse&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;class&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=1&nbsp;color=#5f5f5f&nbsp;face=&quot;sans-serif&quot;&gt;Sent&nbsp;by:&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&lt;/font&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;owasp-csrfguard-bounces@lists.owasp.org&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;hr&nbsp;noshade&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;I&nbsp;think&nbsp;you&nbsp;understand&nbsp;it&nbsp;correctly.&nbsp;Care&nbsp;to&nbsp;submit<br>
a&nbsp;patch/pull&nbsp;request?&lt;br&gt;<br>
&lt;br&gt;<br>
Sincerely,&lt;br&gt;<br>
Eric&nbsp;Sheridan&lt;br&gt;<br>
(twitter)&nbsp;@eric_sheridan&lt;br&gt;<br>
(blog)&nbsp;&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=http://ericsheridan.blogspot.com/&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;http://ericsheridan.blogspot.com&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;11/5/12&nbsp;7:47&nbsp;AM,&nbsp;Gaurav&nbsp;Katiyar&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi&nbsp;All,&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;using&nbsp;the&nbsp;CSRF&nbsp;Guard&nbsp;project&nbsp;in&nbsp;a&nbsp;web&nbsp;application&nbsp;and&nbsp;I&nbsp;think&lt;br&gt;<br>
&gt;&nbsp;there&nbsp;is&nbsp;a&nbsp;bug&nbsp;in&nbsp;the&nbsp;latest&nbsp;code.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;https://github.com/esheri3/OWASP-CSRFGuard/blame/master/Owasp.CsrfGuard/src/org/owasp/csrfguard/http/InterceptRedirectResponse.java&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;https://github.com/esheri3/OWASP-CSRFGuard/blame/master/Owasp.CsrfGuard/src/org/owasp/csrfguard/http/InterceptRedirectResponse.java&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;class&nbsp;InterceptRedirectResponse&nbsp;on&nbsp;line&nbsp;21&nbsp;has&nbsp;the&nbsp;following&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;if&nbsp;(!location.contains(&quot;://&quot;)&nbsp;&amp;&amp;&nbsp;(csrfGuard.isProtectedPage(location)&lt;br&gt;<br>
&gt;&nbsp;||&nbsp;csrfGuard.isUnprotectedMethod(&quot;GET&quot;)))&nbsp;{&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;//&nbsp;code&nbsp;to&nbsp;add&nbsp;the&nbsp;token&nbsp;to&nbsp;the&nbsp;redirected&nbsp;URL&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;}&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;which&nbsp;says&nbsp;if&nbsp;redirect&nbsp;is&nbsp;to&nbsp;same&nbsp;domain&nbsp;and&nbsp;if&nbsp;page&nbsp;is&nbsp;protected<br>
or&lt;br&gt;<br>
&gt;&nbsp;GET&nbsp;is&nbsp;not&nbsp;protected&nbsp;then&nbsp;add&nbsp;the&nbsp;token&nbsp;to&nbsp;the&nbsp;URL&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;I&nbsp;think&nbsp;it&nbsp;should&nbsp;be&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;if&nbsp;redirect&nbsp;is&nbsp;to&nbsp;same&nbsp;domain&nbsp;and&nbsp;if&nbsp;the&nbsp;page&nbsp;is&nbsp;protected&nbsp;and&nbsp;GET<br>
is&lt;br&gt;<br>
&gt;&nbsp;protected&nbsp;then&nbsp;add&nbsp;the&nbsp;csrf&nbsp;token.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;if&nbsp;(!location.contains(&quot;://&quot;)&nbsp;&amp;&amp;&nbsp;csrfGuard.isProtectedPage(location)&lt;br&gt;<br>
&gt;&nbsp;&amp;&amp;&nbsp;!csrfGuard.isUnprotectedMethod(&quot;GET&quot;))&nbsp;{&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;//&nbsp;code&nbsp;to&nbsp;add&nbsp;the&nbsp;token&nbsp;to&nbsp;the&nbsp;redirected&nbsp;URL&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;}&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Have&nbsp;I&nbsp;understood&nbsp;this&nbsp;incorrectly?&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Please&nbsp;help.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Thanks,&lt;br&gt;<br>
&gt;&nbsp;Gaurav&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Owasp-csrfguard&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;Owasp-csrfguard@lists.owasp.org&lt;br&gt;<br>
&gt;&nbsp;&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-csrfguard&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;https://lists.owasp.org/mailman/listinfo/owasp-csrfguard&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-csrfguard&nbsp;mailing&nbsp;list&lt;br&gt;<br>
Owasp-csrfguard@lists.owasp.org&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-csrfguard&quot;&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;https://lists.owasp.org/mailman/listinfo/owasp-csrfguard&lt;/font&gt;&lt;/tt&gt;&lt;/a&gt;&lt;tt&gt;&lt;font&nbsp;size=2&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;
</tt>
