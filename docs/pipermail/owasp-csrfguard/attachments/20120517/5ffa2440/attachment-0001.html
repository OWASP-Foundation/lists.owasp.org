<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;10pt;<br>
font-family:Tahoma<br>
}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;<br>
Hi&nbsp;You&nbsp;guys,&lt;br&gt;&lt;br&gt;I&nbsp;&nbsp;have&nbsp;just&nbsp;set&nbsp;up&nbsp;CSRF&nbsp;guard&nbsp;to&nbsp;work&nbsp;with&nbsp;my&nbsp;strut2-spring&nbsp;&nbsp;project.&nbsp;I&nbsp;have&nbsp;2&nbsp;issues:&lt;br&gt;&lt;br&gt;1-&nbsp;For&nbsp;every&nbsp;request,&nbsp;all&nbsp;my&nbsp;resources&nbsp;are&nbsp;requested&nbsp;twice.&nbsp;I.e:&nbsp;all&nbsp;the&nbsp;css,&nbsp;images,&nbsp;etc...are&nbsp;requested&nbsp;twice,&nbsp;once&nbsp;without&nbsp;the&nbsp;OWASP&nbsp;token&nbsp;and&nbsp;once&nbsp;with&nbsp;the&nbsp;token.&lt;br&gt;In&nbsp;fact,&nbsp;a&nbsp;quick&nbsp;inspection&nbsp;through&nbsp;firebug&nbsp;reveals&nbsp;the&nbsp;following&nbsp;timeline:&lt;br&gt;-&nbsp;A&nbsp;bunch&nbsp;of&nbsp;GETs&nbsp;are&nbsp;issues&nbsp;(my&nbsp;resources)&nbsp;(without&nbsp;the&nbsp;OWASP&nbsp;token)&lt;br&gt;&nbsp;&nbsp;Among&nbsp;them,&nbsp;a&nbsp;GET&nbsp;to&nbsp;OWASP&nbsp;JavaScriptServlet&lt;br&gt;-&nbsp;Then&nbsp;at&nbsp;some&nbsp;point,&nbsp;a&nbsp;POST&nbsp;to&nbsp;JavaScriptServlet&nbsp;is&nbsp;sent&nbsp;out&lt;br&gt;-&nbsp;Then&nbsp;a&nbsp;slew&nbsp;of&nbsp;Gets&nbsp;(the&nbsp;same&nbsp;ones&nbsp;as&nbsp;before,&nbsp;i.e:&nbsp;my&nbsp;resources)&nbsp;this&nbsp;time&nbsp;with&nbsp;the&nbsp;?OWASP_CSRFTOKEN=...&nbsp;appended&nbsp;to&nbsp;each&nbsp;GET&lt;br&gt;&lt;br&gt;Is&nbsp;this&nbsp;how&nbsp;is&nbsp;it&nbsp;supposed&nbsp;to&nbsp;be&nbsp;working??&nbsp;I&nbsp;must&nbsp;have&nbsp;configured&nbsp;something&nbsp;wrong....&lt;br&gt;I&nbsp;mean&nbsp;even&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;disregard&nbsp;the&nbsp;performance&nbsp;loss&nbsp;related&nbsp;to&nbsp;the&nbsp;double&nbsp;requests,&nbsp;my&nbsp;site&nbsp;is&nbsp;loads&nbsp;funny&nbsp;now,&nbsp;as&nbsp;it&nbsp;loads&nbsp;without&nbsp;the&nbsp;CSS/JS&nbsp;at&nbsp;first&nbsp;(so&nbsp;looks&nbsp;pretty&nbsp;much&nbsp;ugly),&nbsp;then&nbsp;a&nbsp;split&nbsp;of&nbsp;a&nbsp;second&nbsp;later,&nbsp;the&nbsp;site&nbsp;is&nbsp;refreshed&nbsp;and&nbsp;everything&nbsp;is&nbsp;there.&nbsp;It&nbsp;is&nbsp;slow&nbsp;enough&nbsp;that&nbsp;we&nbsp;can&nbsp;notice&nbsp;it.&lt;br&gt;&lt;br&gt;2-&nbsp;When&nbsp;I&nbsp;login,&nbsp;it&nbsp;fails&nbsp;with&nbsp;a&nbsp;403.&nbsp;I&nbsp;checked&nbsp;my&nbsp;form&nbsp;submission&nbsp;and&nbsp;it&nbsp;does&nbsp;not&nbsp;seem&nbsp;to&nbsp;contain&nbsp;the&nbsp;OWASP_CSRTOKEN.&nbsp;Hence&nbsp;the&nbsp;403...&lt;br&gt;&lt;br&gt;Any&nbsp;help&nbsp;is&nbsp;appreciated,&lt;br&gt;&lt;br&gt;Here&nbsp;is&nbsp;my&nbsp;config:&lt;br&gt;&lt;br&gt;org.owasp.csrfguard.Logger=org.owasp.csrfguard.log.ConsoleLogger&lt;br&gt;org.owasp.csrfguard.TokenPerPage=true&lt;br&gt;org.owasp.csrfguard.Ajax=true&lt;br&gt;&lt;br&gt;org.owasp.csrfguard.unprotected.DefaultHome=/localhost/home&lt;br&gt;org.owasp.csrfguard.unprotected.403=/localhost/403.jsp&lt;br&gt;org.owasp.csrfguard.unprotected.404=/localhost/404.jsp&lt;br&gt;&lt;br&gt;org.owasp.csrfguard.action.Log=org.owasp.csrfguard.action.Log&lt;br&gt;org.owasp.csrfguard.action.Log.Message=potential&nbsp;cross-site&nbsp;request&nbsp;forgery&nbsp;(CSRF)&nbsp;attack&nbsp;thwarted&nbsp;(user:%user%,&nbsp;ip:%remote_ip%,&nbsp;uri:%request_uri%,&nbsp;error:%exception_message%)&lt;br&gt;org.owasp.csrfguard.action.Redirect=org.owasp.csrfguard.action.Redirect&lt;br&gt;org.owasp.csrfguard.action.Redirect.Page=/localhost/403.jsp&lt;br&gt;org.owasp.csrfguard.action.Rotate=org.owasp.csrfguard.action.Rotate&lt;br&gt;&lt;br&gt;org.owasp.csrfguard.TokenName=OWASP_CSRFTOKEN&lt;br&gt;org.owasp.csrfguard.SessionKey=OWASP_CSRFTOKEN&lt;br&gt;org.owasp.csrfguard.TokenLength=32&lt;br&gt;org.owasp.csrfguard.PRNG=SHA1PRNG&lt;br&gt;&lt;br&gt;And&nbsp;JavaScriptServlet&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&lt;servlet&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;JavaScriptServlet&lt;/servlet-name&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-class&gt;org.owasp.csrfguard.servlet.JavaScriptServlet&lt;/servlet-class&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;source-file&lt;/param-name&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;WEB-INF/Owasp.CsrfGuard.js&lt;/param-value&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;inject-into-forms&lt;/param-name&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;true&lt;/param-value&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;inject-into-attributes&lt;/param-name&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;true&lt;/param-value&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;domain-strict&lt;/param-name&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;false&lt;/param-value&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-name&gt;referer-pattern&lt;/param-name&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;param-value&gt;.*localhost.*&lt;/param-value&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/init-param&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/servlet&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-mapping&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;servlet-name&gt;JavaScriptServlet&lt;/servlet-name&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;url-pattern&gt;/JavaScriptServlet&lt;/url-pattern&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/servlet-mapping&gt;&lt;br&gt;&lt;br&gt;Elextra/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
