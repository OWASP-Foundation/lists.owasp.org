<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;Hello,&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&#39;m&nbsp;integrating&nbsp;CSRF&nbsp;Guard&nbsp;in&nbsp;a&nbsp;DSpace&nbsp;repository&nbsp;implementation&nbsp;(&lt;a&nbsp;href=&quot;http://www.dspace.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.dspace.org/&lt;/a&gt;)&nbsp;for&nbsp;one&nbsp;of&nbsp;our&nbsp;customer&nbsp;and&nbsp;using&nbsp;JavaScript&nbsp;token&nbsp;injection&nbsp;to&nbsp;inject&nbsp;token&nbsp;in&nbsp;html&nbsp;forms.&nbsp;I&#39;ve&nbsp;noticed&nbsp;the&nbsp;following&nbsp;issue&nbsp;in&nbsp;csrfguard.js&nbsp;code.&lt;br&gt;&lt;br&gt;In&nbsp;a&nbsp;particular&nbsp;page&nbsp;there&nbsp;are&nbsp;30&nbsp;form&nbsp;elements&nbsp;and&nbsp;there&nbsp;are&nbsp;total&nbsp;452&nbsp;elements&nbsp;in&nbsp;the&nbsp;DOM&nbsp;initially.&nbsp;Few&nbsp;form&nbsp;elements&nbsp;are&nbsp;towards&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;DOM&nbsp;e.g.&nbsp;440th&nbsp;and&nbsp;446th&nbsp;element.&nbsp;As&nbsp;injectTokenForm()&nbsp;is&nbsp;injecting&nbsp;hidden&nbsp;elements&nbsp;in&nbsp;the&nbsp;DOM,&nbsp;the&nbsp;form&nbsp;elements&nbsp;are&nbsp;also&nbsp;shifted&nbsp;downward&nbsp;in&nbsp;DOM&nbsp;e.g.&nbsp;when&nbsp;hidden&nbsp;element&nbsp;is&nbsp;added&nbsp;for&nbsp;the&nbsp;first&nbsp;28&nbsp;forms,&nbsp;the&nbsp;new&nbsp;position&nbsp;of&nbsp;440th&nbsp;and&nbsp;446th&nbsp;form&nbsp;elements&nbsp;in&nbsp;the&nbsp;DOM&nbsp;are&nbsp;468&nbsp;and&nbsp;474&nbsp;respectively.&nbsp;But&nbsp;the&nbsp;for&nbsp;loop&nbsp;at&nbsp;[1]&nbsp;iterates&nbsp;452&nbsp;times&nbsp;only&nbsp;and&nbsp;hence&nbsp;the&nbsp;last&nbsp;two&nbsp;forms&nbsp;are&nbsp;left.&lt;br&gt;&lt;br&gt;I&#39;ve&nbsp;fixed&nbsp;this&nbsp;issue&nbsp;locally&nbsp;by&nbsp;incrementing&nbsp;the&nbsp;&quot;len&quot;&nbsp;variable&nbsp;by&nbsp;1&nbsp;when&nbsp;injectTokenForm()&nbsp;add&nbsp;a&nbsp;new&nbsp;element&nbsp;in&nbsp;DOM.&lt;br&gt;&lt;br&gt;Please&nbsp;let&nbsp;me&nbsp;know&nbsp;whether&nbsp;I&nbsp;should&nbsp;open&nbsp;as&nbsp;issue&nbsp;for&nbsp;this.&lt;br&gt;&lt;br&gt;Thanks&nbsp;&amp;&nbsp;Regards,&lt;br&gt;Pralaypati&nbsp;Ta&lt;br&gt;&lt;br&gt;[1]&nbsp;&lt;a&nbsp;href=&quot;https://github.com/aramrami/OWASP-CSRFGuard/blob/master/csrfguard/src/main/resources/csrfguard.js#L348&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/aramrami/&lt;wbr&gt;OWASP-CSRFGuard/blob/master/&lt;wbr&gt;csrfguard/src/main/resources/&lt;wbr&gt;csrfguard.js#L348&lt;/a&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
