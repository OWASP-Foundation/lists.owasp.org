<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;Hello,&lt;/span&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;I&nbsp;have&nbsp;implemented&nbsp;the&nbsp;OWASP&nbsp;CSRF&nbsp;guard&nbsp;solution,&nbsp;all&nbsp;work&nbsp;properly&nbsp;like&nbsp;i&nbsp;expect,&nbsp;but&nbsp;on&nbsp;other&nbsp;side,&nbsp;i&nbsp;got&nbsp;an&nbsp;exception&nbsp;in&nbsp;the&nbsp;logs: &lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;div&gt;INFO&nbsp; &nbsp;|&nbsp;jvm&nbsp;1&nbsp; &nbsp; |&nbsp;main&nbsp; &nbsp; |&nbsp;2013/11/01&nbsp;16:44:02.760&nbsp;|&nbsp;nov.&nbsp;01,&nbsp;2013&nbsp;4:44:02&nbsp;PM&nbsp;org.apache.catalina.core.StandardWrapperValve&nbsp;invoke&lt;/div&gt;<br>
&lt;div&gt;INFO&nbsp; &nbsp;|&nbsp;jvm&nbsp;1&nbsp; &nbsp; |&nbsp;main&nbsp; &nbsp; |&nbsp;2013/11/01&nbsp;16:44:02.803&nbsp;|&nbsp;SEVERE:&nbsp;&quot;Servlet.service()&quot;&nbsp;pour&nbsp;la&nbsp;servlet&nbsp;JavaScriptServlet&nbsp;a&nbsp;généré&nbsp;une&nbsp;exception&lt;/div&gt;&lt;div&gt;INFO&nbsp; &nbsp;|&nbsp;jvm&nbsp;1&nbsp; &nbsp; |&nbsp;main&nbsp; &nbsp; |&nbsp;2013/11/01&nbsp;16:44:02.857&nbsp;|&nbsp;java.lang.IllegalStateException&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;After&nbsp;debugging,&nbsp;i&nbsp;found&nbsp;that&nbsp;the&nbsp;root&nbsp;exception&nbsp;happen&nbsp;in&nbsp;the&nbsp;method&nbsp;writeJavaScript()&nbsp;when&nbsp;it&nbsp;try&nbsp;to&nbsp;close&nbsp;the&nbsp;outputStream&nbsp;(Streams.close(output);):&nbsp;java.io.IOException:&nbsp;This&nbsp;output&nbsp;stream&nbsp;has&nbsp;already&nbsp;been&nbsp;closed&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;i&nbsp;would&nbsp;override&nbsp;this&nbsp;servlet&nbsp;to&nbsp;catch&nbsp;this&nbsp;exception,&nbsp;but&nbsp;it&nbsp;is&nbsp;a&nbsp;final&nbsp;class.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;Anyone&nbsp;had&nbsp;an&nbsp;idea&nbsp;how&nbsp;to&nbsp;fix&nbsp;this&nbsp;?&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;Best&nbsp;regards.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;<br>
--&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;Quoulali&nbsp;Younes&lt;/div&gt;&lt;/div&gt;<br>

</tt>
