<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;12&nbsp;(filtered&nbsp;medium)&quot;&gt;<br>
&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Wingdings;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:5&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0&nbsp;0;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:&quot;Cambria&nbsp;Math&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;4&nbsp;5&nbsp;3&nbsp;5&nbsp;4&nbsp;6&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Calibri;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{font-family:Consolas;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;panose-1:2&nbsp;11&nbsp;6&nbsp;9&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:blue;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:99;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:purple;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-decoration:underline;}<br>
p.MsoListParagraph,&nbsp;li.MsoListParagraph,&nbsp;div.MsoListParagraph<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-priority:34;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-top:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-right:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-left:.5in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin-bottom:.0001pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-size:11.0pt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
span.EmailStyle17<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:personal-compose;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;color:windowtext;}<br>
.MsoChpDefault<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-style-type:export-only;}<br>
@page&nbsp;WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{size:8.5in&nbsp;11.0in;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;margin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{page:WordSection1;}<br>
/*&nbsp;List&nbsp;Definitions&nbsp;*/<br>
@list&nbsp;l0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-list-id:1386828501;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-list-type:hybrid;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-list-template-ids:1517738330&nbsp;67698703&nbsp;67698713&nbsp;67698715&nbsp;67698703&nbsp;67698713&nbsp;67698715&nbsp;67698703&nbsp;67698713&nbsp;67698715;}<br>
@list&nbsp;l0:level1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{mso-level-tab-stop:none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mso-level-number-position:left;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-indent:-.25in;}<br>
ol<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
ul<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{margin-bottom:0in;}<br>
--&gt;&lt;/style&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapedefaults&nbsp;v:ext=&quot;edit&quot;&nbsp;spidmax=&quot;1026&quot;&nbsp;/&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapelayout&nbsp;v:ext=&quot;edit&quot;&gt;<br>
&lt;o:idmap&nbsp;v:ext=&quot;edit&quot;&nbsp;data=&quot;1&quot;&nbsp;/&gt;<br>
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;lang=&quot;EN-US&quot;&nbsp;link=&quot;blue&quot;&nbsp;vlink=&quot;purple&quot;&gt;<br>
&lt;div&nbsp;class=&quot;WordSection1&quot;&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;I&nbsp;added&nbsp;some&nbsp;enhancements&nbsp;to&nbsp;csrfguard,&nbsp;and&nbsp;would&nbsp;like&nbsp;it&nbsp;to&nbsp;be&nbsp;merged&nbsp;in&nbsp;to&nbsp;the&nbsp;main&nbsp;source&nbsp;branch.&nbsp;&nbsp;I&nbsp;sent&nbsp;a&nbsp;pull&nbsp;request&nbsp;to&nbsp;aramrami&nbsp;and&nbsp;justinedelson.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;a&nbsp;href=&quot;https://github.com/mchyzer/OWASP-CSRFGuard&quot;&gt;https://github.com/mchyzer/OWASP-CSRFGuard&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;In&nbsp;general&nbsp;my&nbsp;changes&nbsp;are&nbsp;backward&nbsp;compatible&nbsp;I&nbsp;believe.&nbsp;&nbsp;Im&nbsp;happy&nbsp;to&nbsp;tweak&nbsp;anything&nbsp;to&nbsp;make&nbsp;it&nbsp;acceptable&nbsp;for&nbsp;people.&nbsp;&nbsp;Maybe&nbsp;we&nbsp;should&nbsp;setup&nbsp;a&nbsp;conference&nbsp;call&nbsp;to&nbsp;discuss&nbsp;these?&nbsp;<br>
&lt;span&nbsp;style=&quot;font-family:Wingdings&quot;&gt;J&lt;/span&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;1.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Took&nbsp;out&nbsp;the&nbsp;gpg&nbsp;maven&nbsp;plugin.&nbsp;&nbsp;I&nbsp;just&nbsp;run&nbsp;a&nbsp;build&nbsp;from&nbsp;eclipse&nbsp;by&nbsp;right&nbsp;clicking,&nbsp;and&nbsp;it&nbsp;gives&nbsp;an&nbsp;error.&nbsp;&nbsp;If&nbsp;someone&nbsp;can&nbsp;please&nbsp;tell&nbsp;me&nbsp;how&nbsp;to&nbsp;address&nbsp;the&nbsp;error&nbsp;(add&nbsp;gpg&nbsp;secret&nbsp;somewhere?),&nbsp;then&nbsp;I&nbsp;can&nbsp;add&nbsp;back&nbsp;in<br>
&lt;span&nbsp;style=&quot;font-family:Wingdings&quot;&gt;J&lt;/span&gt;&nbsp;&nbsp;we&nbsp;should&nbsp;document&nbsp;this&nbsp;with&nbsp;a&nbsp;comment&nbsp;in&nbsp;the&nbsp;pom&nbsp;or&nbsp;somewhere&nbsp;else?&nbsp;&nbsp;Sorry,&nbsp;didn&#8217;t&nbsp;see&nbsp;answer&nbsp;and&nbsp;didn&#8217;t&nbsp;have&nbsp;internet&nbsp;to&nbsp;discuss&nbsp;this&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;2.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;In&nbsp;pom&nbsp;I&nbsp;added&nbsp;the&nbsp;config&nbsp;file&nbsp;in&nbsp;the&nbsp;META-INF,&nbsp;this&nbsp;is&nbsp;so&nbsp;the&nbsp;default&nbsp;config&nbsp;is&nbsp;shipped&nbsp;with&nbsp;the&nbsp;jar,&nbsp;and&nbsp;also,&nbsp;if&nbsp;the&nbsp;Owasp.CsrfGuard.properties&nbsp;is&nbsp;not&nbsp;present,&nbsp;it&nbsp;can&nbsp;just&nbsp;use&nbsp;defaults&nbsp;from&nbsp;the&nbsp;jar&nbsp;(see&nbsp;config&nbsp;overlays&nbsp;below)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;3.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;I&nbsp;have&nbsp;the&nbsp;changes&nbsp;based&nbsp;on&nbsp;code&nbsp;from&nbsp;&nbsp;Justin&nbsp;Edelson&nbsp;for&nbsp;a&nbsp;configuration&nbsp;provider.&nbsp;&nbsp;You&nbsp;can&nbsp;specify&nbsp;which&nbsp;configuration&nbsp;type&nbsp;you&nbsp;want,&nbsp;and&nbsp;it&nbsp;will&nbsp;use&nbsp;that&nbsp;instead&nbsp;of&nbsp;simple&nbsp;properties&nbsp;file.&nbsp;&nbsp;Note,&nbsp;you&nbsp;specify&nbsp;this&nbsp;in&nbsp;the&nbsp;properties<br>
&nbsp;file&nbsp;to&nbsp;bootstrap&nbsp;it&nbsp;&lt;span&nbsp;style=&quot;font-family:Wingdings&quot;&gt;J&lt;/span&gt;.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;also&nbsp;a&nbsp;configuration&nbsp;factory&nbsp;so&nbsp;the&nbsp;configuration&nbsp;can&nbsp;be&nbsp;cached&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;4.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;I&nbsp;added&nbsp;a&nbsp;configuration&nbsp;provider&nbsp;for&nbsp;properties&nbsp;files&nbsp;overlays.&nbsp;&nbsp;The&nbsp;goal&nbsp;here&nbsp;is&nbsp;that&nbsp;there&nbsp;can&nbsp;be&nbsp;a&nbsp;default&nbsp;config&nbsp;file&nbsp;(Owasp.CsrfGuard.properties),&nbsp;which&nbsp;is&nbsp;shipped&nbsp;with&nbsp;csrfguard,&nbsp;and&nbsp;an&nbsp;overlay:&nbsp;Owasp.CsrfGuard.overlay.properties<br>
&nbsp;which&nbsp;overrides&nbsp;properties&nbsp;in&nbsp;the&nbsp;default.&nbsp;&nbsp;Another&nbsp;feature&nbsp;is&nbsp;it&nbsp;will&nbsp;reload&nbsp;the&nbsp;properties&nbsp;if&nbsp;any&nbsp;change,&nbsp;so&nbsp;you&nbsp;can&nbsp;change&nbsp;the&nbsp;config&nbsp;without&nbsp;bouncing&nbsp;the&nbsp;app.&nbsp;&nbsp;Note,&nbsp;you&nbsp;can&nbsp;have&nbsp;multiple&nbsp;overlays&nbsp;(one&nbsp;for&nbsp;the&nbsp;app&nbsp;and&nbsp;one&nbsp;for&nbsp;the&nbsp;env&nbsp;the&nbsp;app&nbsp;is&nbsp;running<br>
&nbsp;in?),&nbsp;and&nbsp;they&nbsp;can&nbsp;live&nbsp;in&nbsp;the&nbsp;classpath&nbsp;or&nbsp;filesystem.&nbsp;&nbsp;I&nbsp;want&nbsp;to&nbsp;distribute&nbsp;csrfguard&nbsp;with&nbsp;my&nbsp;webapp&nbsp;application,&nbsp;and&nbsp;I&nbsp;don&#8217;t&nbsp;want&nbsp;deployers&nbsp;to&nbsp;worry&nbsp;about&nbsp;what&nbsp;is&nbsp;the&nbsp;default&nbsp;csrfguard&nbsp;config,&nbsp;and&nbsp;what&nbsp;I&nbsp;specified.&nbsp;&nbsp;So&nbsp;basically&nbsp;I&nbsp;have&nbsp;a&nbsp;Owasp.CsrfGuard.overlay.properties<br>
&nbsp;that&nbsp;has&nbsp;these&nbsp;contents&nbsp;and&nbsp;that&#8217;s&nbsp;all&nbsp;the&nbsp;app&nbsp;needs:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.Logger=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;org.openTwoFactor.server.log.CsrfGuardLogger&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.UnprotectedMethods=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;GET&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.TokenPerPage=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;false&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.Rotate=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;false&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.action.Redirect.Page=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;%servletContext%/assets/html/csrfError.html&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.configuration.provider.factory=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;org.owasp.csrfguard.config.overlay.ConfigurationOverlayProviderFactory&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Here&nbsp;is&nbsp;the&nbsp;config&nbsp;in&nbsp;the&nbsp;default&nbsp;config&nbsp;(Owasp.CsrfGuard.properties)&nbsp;to&nbsp;specify&nbsp;the&nbsp;configuration&nbsp;provider&nbsp;factory&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;###########################&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;##&nbsp;Config&nbsp;overlay&nbsp;settings&nbsp;if&nbsp;you&nbsp;have&nbsp;the&nbsp;provider&nbsp;above&nbsp;set&nbsp;to&nbsp;ConfigurationOverlayProvider&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;##&nbsp;This&nbsp;CSRF&nbsp;config&nbsp;provider&nbsp;uses&nbsp;Internet2&nbsp;Configuration&nbsp;Overlays&nbsp;(documented&nbsp;on&nbsp;Internet2&nbsp;wiki)&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;##&nbsp;By&nbsp;default&nbsp;the&nbsp;configuration&nbsp;is&nbsp;read&nbsp;from&nbsp;the&nbsp;Owasp.CsrfGuard.properties&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;##&nbsp;(which&nbsp;should&nbsp;not&nbsp;be&nbsp;edited),&nbsp;and&nbsp;the&nbsp;Owasp.CsrfGuard.overlay.properties&nbsp;overlays&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;##&nbsp;the&nbsp;base&nbsp;settings.&nbsp;&nbsp;See&nbsp;the&nbsp;Owasp.CsrfGuard.properties&nbsp;for&nbsp;the&nbsp;possible&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;##&nbsp;settings&nbsp;that&nbsp;can&nbsp;be&nbsp;applied&nbsp;to&nbsp;the&nbsp;Owasp.CsrfGuard.overlay.properties&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;###########################&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;comma&nbsp;separated&nbsp;config&nbsp;files&nbsp;that&nbsp;override&nbsp;each&nbsp;other&nbsp;(files&nbsp;on&nbsp;the&nbsp;right&nbsp;override&nbsp;the&nbsp;left)&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;each&nbsp;should&nbsp;start&nbsp;with&nbsp;file:&nbsp;or&nbsp;classpath:&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;e.g.&nbsp;classpath:Owasp.CsrfGuard.properties,&nbsp;file:c:/temp/myFile.properties&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.configOverlay.hierarchy&nbsp;=<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;classpath:Owasp.CsrfGuard.properties,&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;classpath:Owasp.CsrfGuard.overlay.properties&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;seconds&nbsp;between&nbsp;checking&nbsp;to&nbsp;see&nbsp;if&nbsp;the&nbsp;config&nbsp;files&nbsp;are&nbsp;updated&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.configOverlay.secondsBetweenUpdateChecks&nbsp;=<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;60&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Note:&nbsp;the&nbsp;factory&nbsp;is&nbsp;a&nbsp;simple&nbsp;interface:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;/**&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;*&nbsp;implement&nbsp;this&nbsp;interface&nbsp;to&nbsp;provide&nbsp;the&nbsp;configuration&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;*/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#7F0055&quot;&gt;public&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;<br>
&lt;/span&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#7F0055&quot;&gt;interface&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;<br>
&lt;span&nbsp;style=&quot;background:silver;mso-highlight:silver&quot;&gt;ConfigurationProviderFactory&lt;/span&gt;&nbsp;{&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;/**&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;called&nbsp;when&nbsp;retrieving&nbsp;the&nbsp;configuration&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
&lt;/span&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#7F9FBF&quot;&gt;@param&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;&nbsp;properties&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*<br>
&lt;/span&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#7F9FBF&quot;&gt;@return&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;&nbsp;the&nbsp;configuration&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F5FBF&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#7F0055&quot;&gt;public&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;ConfigurationProvider&nbsp;retrieveConfiguration(Properties&nbsp;properties);&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;}&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;The&nbsp;ConfigurationProvider&nbsp;is&nbsp;a&nbsp;little&nbsp;more&nbsp;complicated&nbsp;(see&nbsp;github&nbsp;for&nbsp;interface)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;a&nbsp;href=&quot;https://github.com/mchyzer/OWASP-CSRFGuard/blob/master/csrfguard/src/main/java/org/owasp/csrfguard/config/ConfigurationProvider.java&quot;&gt;https://github.com/mchyzer/OWASP-CSRFGuard/blob/master/csrfguard/src/main/java/org/owasp/csrfguard/config/ConfigurationProvider.java&lt;/a&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;5.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;Note,&nbsp;to&nbsp;specify&nbsp;the&nbsp;configuration&nbsp;provider&nbsp;factory,&nbsp;the&nbsp;default&nbsp;is&nbsp;an&nbsp;automatic&nbsp;picker,&nbsp;which&nbsp;sees&nbsp;if&nbsp;there&nbsp;is&nbsp;an&nbsp;overlay,&nbsp;if&nbsp;so,&nbsp;see&nbsp;if&nbsp;the&nbsp;provider&nbsp;factory&nbsp;is&nbsp;specified,&nbsp;and&nbsp;if&nbsp;so,&nbsp;use&nbsp;it.&nbsp;&nbsp;This&nbsp;way&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;overlay&nbsp;config&nbsp;file,<br>
&nbsp;then&nbsp;the&nbsp;default&nbsp;is&nbsp;the&nbsp;provider&nbsp;from&nbsp;before,&nbsp;simple&nbsp;properties.&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;an&nbsp;overlay,&nbsp;and&nbsp;it&nbsp;changes&nbsp;the&nbsp;provider,&nbsp;then&nbsp;you&nbsp;don&#8217;t&nbsp;have&nbsp;to&nbsp;change&nbsp;the&nbsp;base&nbsp;config&nbsp;which&nbsp;is&nbsp;shipped&nbsp;with&nbsp;csrfguard&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;6.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;I&nbsp;have&nbsp;options&nbsp;in&nbsp;the&nbsp;config&nbsp;file&nbsp;for&nbsp;all&nbsp;the&nbsp;configs&nbsp;in&nbsp;the&nbsp;web.xml.&nbsp;&nbsp;I&nbsp;don&#8217;t&nbsp;think&nbsp;the&nbsp;web.xml&nbsp;is&nbsp;a&nbsp;good&nbsp;place&nbsp;for&nbsp;configuration,&nbsp;and&nbsp;it&nbsp;obviously&nbsp;wont&nbsp;work&nbsp;with&nbsp;the&nbsp;new&nbsp;overlay&nbsp;concept.&nbsp;&nbsp;So&nbsp;if&nbsp;you&nbsp;configure&nbsp;in&nbsp;the&nbsp;web.xml&nbsp;(legacy),<br>
&nbsp;that&nbsp;will&nbsp;take&nbsp;precedence,&nbsp;but&nbsp;if&nbsp;you&nbsp;don&#8217;t,&nbsp;then&nbsp;it&nbsp;will&nbsp;be&nbsp;read&nbsp;from&nbsp;the&nbsp;properties&nbsp;file.&nbsp;&nbsp;E.g.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Boolean&nbsp;value&nbsp;that&nbsp;determines&nbsp;whether&nbsp;or&nbsp;not&nbsp;the&nbsp;dynamic&nbsp;JavaScript&nbsp;code&nbsp;should&nbsp;be&nbsp;strict<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;with&nbsp;regards&nbsp;to&nbsp;what&nbsp;links&nbsp;it&nbsp;should&nbsp;inject&nbsp;the&nbsp;CSRF&nbsp;prevention&nbsp;token.&nbsp;With&nbsp;a&nbsp;value&nbsp;of&nbsp;true,<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;the&nbsp;JavaScript&nbsp;code&nbsp;will&nbsp;only&nbsp;place&nbsp;the&nbsp;token&nbsp;in&nbsp;links&nbsp;that&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;exact&nbsp;domain<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;from&nbsp;which&nbsp;the&nbsp;HTML&nbsp;originated.&nbsp;With&nbsp;a&nbsp;value&nbsp;of&nbsp;false,&nbsp;the&nbsp;JavaScript&nbsp;code&nbsp;will&nbsp;place&nbsp;the<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;token&nbsp;in&nbsp;links&nbsp;that&nbsp;not&nbsp;only&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;exact&nbsp;domain&nbsp;from&nbsp;which&nbsp;the&nbsp;HTML&nbsp;originated,<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;but&nbsp;sub-domains&nbsp;as&nbsp;well.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.JavascriptServlet.domainStrict&nbsp;=<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;true&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Allows&nbsp;the&nbsp;developer&nbsp;to&nbsp;specify&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;Cache-Control&nbsp;header&nbsp;in&nbsp;the&nbsp;HTTP&nbsp;response<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;when&nbsp;serving&nbsp;the&nbsp;dynamic&nbsp;JavaScript&nbsp;file.&nbsp;The&nbsp;default&nbsp;value&nbsp;is&nbsp;private,&nbsp;maxage=28800.<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Caching&nbsp;of&nbsp;the&nbsp;dynamic&nbsp;JavaScript&nbsp;file&nbsp;is&nbsp;intended&nbsp;to&nbsp;minimize&nbsp;traffic&nbsp;and&nbsp;improve&nbsp;performance.<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Note&nbsp;that&nbsp;the&nbsp;Cache-Control&nbsp;header&nbsp;is&nbsp;always&nbsp;set&nbsp;to&nbsp;&quot;no-store&quot;&nbsp;when&nbsp;either&nbsp;the&nbsp;&quot;Rotate&quot;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;&quot;TokenPerPage&quot;&nbsp;options&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;in&nbsp;Owasp.CsrfGuard.properties.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.JavascriptServlet.cacheControl&nbsp;=<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;private,&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;maxage=28800&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Then&nbsp;all&nbsp;you&nbsp;need&nbsp;in&nbsp;your&nbsp;web.xml&nbsp;is&nbsp;something&nbsp;like&nbsp;this:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.CsrfGuardServletContextListener&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.CsrfGuardHttpSessionListener&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;listener&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;OwaspJavaScriptServlet&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.servlet.JavaScriptServlet&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-mapping&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;OwaspJavaScriptServlet&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;url-pattern&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;/OwaspJavaScriptServlet&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;url-pattern&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;servlet-mapping&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;CSRFGuard&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.CsrfGuardFilter&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-class&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-mapping&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;CSRFGuard&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-name&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;url-pattern&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;/*&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;url-pattern&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&lt;/&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F7F&quot;&gt;filter-mapping&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:teal&quot;&gt;&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;&nbsp;<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;7.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;It&nbsp;is&nbsp;*&lt;b&gt;very&lt;/b&gt;*&nbsp;inconvenient&nbsp;to&nbsp;hardcode&nbsp;the&nbsp;servlet&nbsp;context&nbsp;(app&nbsp;name)&nbsp;in&nbsp;the&nbsp;configuration.&nbsp;&nbsp;Differente&nbsp;envs&nbsp;could&nbsp;have&nbsp;different&nbsp;app&nbsp;names&nbsp;for&nbsp;the&nbsp;same&nbsp;app.&nbsp;&nbsp;So&nbsp;I&nbsp;added&nbsp;a&nbsp;variable&nbsp;that&nbsp;can&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;config&nbsp;to&nbsp;represent&nbsp;the<br>
&nbsp;context&nbsp;root.&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;doc&nbsp;and&nbsp;examples&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Common&nbsp;substitutions&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;%servletContext%&nbsp;&nbsp;is&nbsp;the&nbsp;servlet&nbsp;context&nbsp;(e.g.&nbsp;the&nbsp;configured&nbsp;app&nbsp;prefix&nbsp;or&nbsp;war&nbsp;file&nbsp;name,&nbsp;or&nbsp;blank.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;e.g.&nbsp;if&nbsp;you&nbsp;deploy&nbsp;a&nbsp;default&nbsp;warfile&nbsp;as&nbsp;someApp.war,&nbsp;then&nbsp;%servletContext%&nbsp;will&nbsp;be&nbsp;/someApp&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;if&nbsp;there&nbsp;isnt&nbsp;a&nbsp;context&nbsp;it&nbsp;will&nbsp;be&nbsp;the&nbsp;empty&nbsp;string.&nbsp;&nbsp;So&nbsp;to&nbsp;use&nbsp;this&nbsp;in&nbsp;the&nbsp;configuration,&nbsp;use&nbsp;e.g.&nbsp;%servletContext%/something.html&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;which&nbsp;will&nbsp;translate&nbsp;to&nbsp;e.g.&nbsp;/someApp/something.html&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.unprotected.Ajax=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;%servletContext%/ajax.html&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.unprotected.Error=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;%servletContext%/error.html&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.unprotected.Index=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;%servletContext%/index.html&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.unprotected.JavaScript=&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;%servletContext%/javascript.html&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;8.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;I&nbsp;took&nbsp;the&nbsp;concept&nbsp;from&nbsp;Victor&nbsp;Yushenko&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;have&nbsp;protected&nbsp;or&nbsp;unprotected&nbsp;pages&nbsp;by&nbsp;regex.&nbsp;&nbsp;My&nbsp;implementation&nbsp;is&nbsp;a&nbsp;little&nbsp;different&nbsp;since&nbsp;it&nbsp;is&nbsp;backwards&nbsp;compatible&nbsp;with&nbsp;the&nbsp;existing&nbsp;configuration.&nbsp;&nbsp;Here&nbsp;is&nbsp;the&nbsp;config&nbsp;and&nbsp;example&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Case&nbsp;1:&nbsp;exact&nbsp;match&nbsp;between&nbsp;request&nbsp;uri&nbsp;and&nbsp;unprotected&nbsp;page&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Case&nbsp;2:&nbsp;longest&nbsp;path&nbsp;prefix&nbsp;match,&nbsp;beginning&nbsp;/&nbsp;and&nbsp;ending&nbsp;/*&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Case&nbsp;3:&nbsp;extension&nbsp;match,&nbsp;beginning&nbsp;*.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Case&nbsp;4:&nbsp;if&nbsp;the&nbsp;value&nbsp;starts&nbsp;with&nbsp;^&nbsp;and&nbsp;ends&nbsp;with&nbsp;$,&nbsp;it&nbsp;will&nbsp;be&nbsp;evaulated&nbsp;as&nbsp;a&nbsp;regex.&nbsp;&nbsp;Note&nbsp;that&nbsp;before&nbsp;the&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;&nbsp;&nbsp;regex&nbsp;is&nbsp;compiled,&nbsp;any&nbsp;common&nbsp;variables&nbsp;will&nbsp;be&nbsp;substituted&nbsp;(e.g.&nbsp;%servletContext%)&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Default:&nbsp;requested&nbsp;resource&nbsp;must&nbsp;be&nbsp;validated&nbsp;by&nbsp;CSRFGuard&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;regex&nbsp;example&nbsp;starts&nbsp;with&nbsp;^&nbsp;and&nbsp;ends&nbsp;with&nbsp;$,&nbsp;and&nbsp;the&nbsp;%servletContext%&nbsp;is&nbsp;evaluated&nbsp;before&nbsp;the&nbsp;regex&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;org.owasp.csrfguard.unprotected.PublicServlet=^%servletContext%/.*Public\.do$&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;9.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;There&nbsp;are&nbsp;a&nbsp;handful&nbsp;of&nbsp;cases&nbsp;where&nbsp;String.replaceAll()&nbsp;is&nbsp;used&nbsp;when&nbsp;String.replace()&nbsp;should&nbsp;be&nbsp;used.&nbsp;&nbsp;I&nbsp;fixed&nbsp;those.&nbsp;&nbsp;Note,&nbsp;in&nbsp;some&nbsp;cases&nbsp;in&nbsp;the&nbsp;source&nbsp;String.replaceAll()&nbsp;was&nbsp;correct,&nbsp;and&nbsp;I&nbsp;left&nbsp;those&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;10.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;I&nbsp;feel&nbsp;like&nbsp;in&nbsp;security&nbsp;you&nbsp;should&nbsp;deny&nbsp;all&nbsp;and&nbsp;pick&nbsp;what&nbsp;you&nbsp;want&nbsp;to&nbsp;allow.&nbsp;&nbsp;But&nbsp;in&nbsp;the&nbsp;HTTP&nbsp;methods,&nbsp;it&nbsp;is&nbsp;opposite.&nbsp;&nbsp;I&nbsp;added&nbsp;a&nbsp;way&nbsp;to&nbsp;allow&nbsp;methods&nbsp;you&nbsp;want&nbsp;to&nbsp;allow&nbsp;the&nbsp;ones&nbsp;you&nbsp;want&nbsp;and&nbsp;deny&nbsp;the&nbsp;rest.&nbsp;&nbsp;It&nbsp;is&nbsp;backwards&nbsp;compatible&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;only&nbsp;available&nbsp;by&nbsp;POST&nbsp;requests&nbsp;when&nbsp;in&nbsp;fact&nbsp;some&nbsp;are&nbsp;available&nbsp;via&nbsp;GET&nbsp;requests.&nbsp;If&nbsp;the&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;user&nbsp;has&nbsp;excluded&nbsp;GET&nbsp;requests&nbsp;from&nbsp;the&nbsp;list&nbsp;then&nbsp;they&nbsp;have&nbsp;introduced&nbsp;a&nbsp;vulnerability.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;The&nbsp;following&nbsp;configuration&nbsp;snippet&nbsp;instructs&nbsp;OWASP&nbsp;CSRFGuard&nbsp;to&nbsp;protect&nbsp;only&nbsp;the&nbsp;POST,&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;PUT,&nbsp;and&nbsp;DELETE&nbsp;HTTP&nbsp;methods.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;org.owasp.csrfguard.ProtectedMethods=POST,PUT,DELETE&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;or&nbsp;you&nbsp;can&nbsp;configure&nbsp;all&nbsp;to&nbsp;be&nbsp;protected,&nbsp;and&nbsp;specify&nbsp;which&nbsp;is&nbsp;unprotected.&nbsp;&nbsp;This&nbsp;is&nbsp;the&nbsp;preferred&nbsp;approach&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;org.owasp.csrfguard.UnprotectedMethods=GET&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;11.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;The&nbsp;javascript&nbsp;servlet&nbsp;does&nbsp;a&nbsp;GET,&nbsp;then&nbsp;the&nbsp;JS&nbsp;posts&nbsp;to&nbsp;itself&nbsp;again,&nbsp;and&nbsp;it&nbsp;doesn&#8217;t&nbsp;send&nbsp;a&nbsp;token,&nbsp;and&nbsp;this&nbsp;is&nbsp;inconvenient&nbsp;if&nbsp;you&nbsp;just&nbsp;want&nbsp;to&nbsp;allow&nbsp;GET,&nbsp;you&nbsp;shouldn&#8217;t&nbsp;have&nbsp;to&nbsp;whitelist&nbsp;the&nbsp;Javascript&nbsp;servlet.&nbsp;&nbsp;So&nbsp;now&nbsp;automatically<br>
&nbsp;after&nbsp;the&nbsp;first&nbsp;GET,&nbsp;the&nbsp;Javascript&nbsp;servlet&nbsp;is&nbsp;whitelisted&nbsp;so&nbsp;you&nbsp;don&#8217;t&nbsp;have&nbsp;to&nbsp;add&nbsp;it&nbsp;to&nbsp;the&nbsp;unprotected&nbsp;page&nbsp;list&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;12.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;If&nbsp;the&nbsp;config&nbsp;file&nbsp;name&nbsp;is&nbsp;not&nbsp;mentioned&nbsp;in&nbsp;the&nbsp;web.xml,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;get&nbsp;configuration&nbsp;from&nbsp;the&nbsp;classpath:Owasp.CsrfGuard.properties&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;13.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;You&nbsp;can&nbsp;log&nbsp;the&nbsp;HTTP&nbsp;method&nbsp;when&nbsp;logging&nbsp;CSRF&nbsp;problems,&nbsp;and&nbsp;it&nbsp;does&nbsp;this&nbsp;by&nbsp;default.&nbsp;&nbsp;Also&nbsp;it&nbsp;looks&nbsp;in&nbsp;more&nbsp;places&nbsp;for&nbsp;the&nbsp;user&nbsp;using&nbsp;the&nbsp;app&nbsp;(e.g.&nbsp;REMOTE_USER&nbsp;request&nbsp;attribute)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoListParagraph&quot;&nbsp;style=&quot;text-indent:-.25in;mso-list:l0&nbsp;level1&nbsp;lfo1&quot;&gt;&lt;![if&nbsp;!supportLists]&gt;&lt;span&nbsp;style=&quot;mso-list:Ignore&quot;&gt;14.&lt;span&nbsp;style=&quot;font:7.0pt&nbsp;&quot;Times&nbsp;New&nbsp;Roman&quot;&quot;&gt;&nbsp;&nbsp;<br>
&lt;/span&gt;&lt;/span&gt;&lt;![endif]&gt;In&nbsp;the&nbsp;javascript&nbsp;referrer&nbsp;checking,&nbsp;there&nbsp;is&nbsp;an&nbsp;option&nbsp;to&nbsp;simply&nbsp;check&nbsp;to&nbsp;see&nbsp;that&nbsp;the&nbsp;referrer&nbsp;is&nbsp;the&nbsp;same&nbsp;domain&nbsp;as&nbsp;the&nbsp;javascript&nbsp;request.&nbsp;&nbsp;This&nbsp;is&nbsp;easier&nbsp;for&nbsp;people&nbsp;to&nbsp;configure&nbsp;and&nbsp;should&nbsp;do&nbsp;the&nbsp;trick.&nbsp;&nbsp;It&nbsp;defaults&nbsp;to&nbsp;on.&nbsp;&nbsp;Note,<br>
&nbsp;if&nbsp;the&nbsp;referrer&nbsp;is&nbsp;missing,&nbsp;it&nbsp;wont&nbsp;cause&nbsp;a&nbsp;problem&nbsp;(just&nbsp;like&nbsp;the&nbsp;regex&nbsp;option)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;Similar&nbsp;to&nbsp;javascript&nbsp;servlet&nbsp;referer&nbsp;pattern,&nbsp;but&nbsp;this&nbsp;will&nbsp;make&nbsp;sure&nbsp;the&nbsp;referer&nbsp;of&nbsp;the<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;javascript&nbsp;servlet&nbsp;matches&nbsp;the&nbsp;domain&nbsp;of&nbsp;the&nbsp;request.&nbsp;&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;referer&nbsp;(proxy&nbsp;strips&nbsp;it?)&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#3F7F5F&quot;&gt;#&nbsp;then&nbsp;it&nbsp;will&nbsp;not&nbsp;fail.&nbsp;&nbsp;Generally&nbsp;this&nbsp;is&nbsp;a&nbsp;good&nbsp;idea&nbsp;to&nbsp;be&nbsp;true.&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;text-autospace:none&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:black&quot;&gt;org.owasp.csrfguard.JavascriptServlet.refererMatchDomain&nbsp;=<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas;color:#2A00FF&quot;&gt;true&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:10.0pt;font-family:Consolas&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Thanks,&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;Chris&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&gt;&lt;o:p&gt;&nbsp;&lt;/o:p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
