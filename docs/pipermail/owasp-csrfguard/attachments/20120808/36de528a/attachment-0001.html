<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;color:;&nbsp;background-color:;&nbsp;font-family:times&nbsp;new&nbsp;roman,&nbsp;new&nbsp;york,&nbsp;times,&nbsp;serif;font-size:12pt&quot;&gt;&lt;div&gt;I&nbsp;had&nbsp;to&nbsp;create&nbsp;a&nbsp;global&nbsp;variable&nbsp;with&nbsp;the&nbsp;token&nbsp;so&nbsp;I&nbsp;could&nbsp;include&nbsp;it&nbsp;in&nbsp;my&nbsp;custom&nbsp;JS&nbsp;code&nbsp;that&nbsp;opened&nbsp;new&nbsp;browser&nbsp;windows.&nbsp;&nbsp;&nbsp;I&nbsp;didn't&nbsp;like&nbsp;the&nbsp;idea&nbsp;of&nbsp;this&nbsp;at&nbsp;first,&nbsp;but&nbsp;based&nbsp;on&nbsp;my&nbsp;research&nbsp;I&nbsp;couldn't&nbsp;find&nbsp;a&nbsp;reason&nbsp;why&nbsp;this&nbsp;would&nbsp;be&nbsp;any&nbsp;less&nbsp;secure.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;var&nbsp;OWASPToken;&nbsp;&nbsp;&nbsp;//outside&nbsp;the&nbsp;private&nbsp;function&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;//inside&nbsp;the&nbsp;csrfguard.js<br>
&nbsp;after&nbsp;it&nbsp;checks&nbsp;the&nbsp;isValidDomain&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;OWASPToken&nbsp;=&nbsp;{&quot;name&quot;:&quot;%TOKEN_NAME%&quot;,&nbsp;&quot;value&quot;:&quot;%TOKEN_VALUE%&quot;};&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;I&nbsp;tried&nbsp;accessing&nbsp;this&nbsp;global&nbsp;from&nbsp;another&nbsp;JS&nbsp;file&nbsp;in&nbsp;a&nbsp;different&nbsp;domain&nbsp;and&nbsp;it&nbsp;wasn't&nbsp;able&nbsp;to&nbsp;access&nbsp;it,&nbsp;so&nbsp;I&nbsp;believe&nbsp;the&nbsp;browser&nbsp;same&nbsp;origin&nbsp;policy&nbsp;protects&nbsp;this.&nbsp;&nbsp;So,&nbsp;again&nbsp;I&nbsp;believe&nbsp;this&nbsp;is&nbsp;no&nbsp;less&nbsp;secure.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:<br>
&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;The&nbsp;other&nbsp;option,&nbsp;but&nbsp;more&nbsp;intrusive&nbsp;to&nbsp;your&nbsp;app&nbsp;maybe&nbsp;would&nbsp;be&nbsp;to&nbsp;use&nbsp;the&nbsp;JavaScriptServlet&nbsp;to&nbsp;return&nbsp;your&nbsp;own&nbsp;JS&nbsp;files&nbsp;and&nbsp;it&nbsp;will&nbsp;replace&nbsp;the&nbsp;%TOKEN_VALUE%&nbsp;values&nbsp;in&nbsp;your&nbsp;own&nbsp;code.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;I'm&nbsp;not&nbsp;an&nbsp;authority&nbsp;on&nbsp;this&nbsp;and&nbsp;still&nbsp;figuring&nbsp;out&nbsp;the&nbsp;best&nbsp;way,&nbsp;but&nbsp;these&nbsp;are&nbsp;my&nbsp;two&nbsp;cents.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,<br>
&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;Thanks,&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;times&nbsp;new&nbsp;roman,new&nbsp;york,times,serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;Smitty&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
