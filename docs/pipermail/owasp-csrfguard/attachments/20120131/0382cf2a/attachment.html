<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;br&gt;&lt;br&gt;I&nbsp;implemented&nbsp;OWASP&nbsp;CSRF&nbsp;Gurad&nbsp;with&nbsp;my&nbsp;application,&nbsp;I&nbsp;have&nbsp;some&nbsp;queries,&nbsp;can&nbsp;you&nbsp;please&nbsp;answer&nbsp;the&nbsp;following.&lt;br&gt;&lt;br&gt;1)&nbsp;I&nbsp;am&nbsp;disabling&nbsp;the&nbsp;Rotate&nbsp;feature&nbsp;so&nbsp;that&nbsp;the&nbsp;tokens&nbsp;wont&nbsp;be&nbsp;refreshed&nbsp;in&nbsp;session.&nbsp;Is&nbsp;it&nbsp;correct&nbsp;and&nbsp;will&nbsp;it&nbsp;not&nbsp;add&nbsp;any&nbsp;vulnerability&nbsp;?&lt;br&gt;<br>
2)&nbsp;As&nbsp;per&nbsp;the&nbsp;application&nbsp;we&nbsp;need&nbsp;to&nbsp;use&nbsp;the&nbsp;wild&nbsp;cards&nbsp;in&nbsp;our&nbsp;unprotected&nbsp;pages&nbsp;list,&nbsp;so&nbsp;I&nbsp;made&nbsp;some&nbsp;changes&nbsp;to&nbsp;isUriMatched()&nbsp;method.&lt;br&gt;   &nbsp;I&nbsp;added&nbsp;the&nbsp;following&nbsp;piece&nbsp;of&nbsp;code&nbsp;in&nbsp;this&nbsp;method.&nbsp;Please&nbsp;verify&nbsp;and&nbsp;if&nbsp;it&nbsp;is&nbsp;correct&nbsp;then&nbsp;can&nbsp;this&nbsp;piece&nbsp;of&nbsp;code&nbsp;can&nbsp;be&nbsp;added&nbsp;to&nbsp;the&nbsp;CSRF&nbsp;Api&nbsp;in&nbsp;the &nbsp;&lt;br&gt;<br>
   &nbsp;coming&nbsp;version.&lt;br&gt;   &nbsp;&lt;br&gt; e.g.&lt;br&gt;/mobile-server/xhtml/user/*/slogin.xhtml&lt;br&gt;&lt;br&gt;The&nbsp;page&nbsp;slogin.xhtml&nbsp;can&nbsp;be&nbsp;called&nbsp;in&nbsp;either&nbsp;way,&nbsp;but&nbsp;behind&nbsp;the&nbsp;scene&nbsp;same&nbsp;jsp&nbsp;is&nbsp;called.&lt;br&gt;Following&nbsp;two&nbsp;different&nbsp;calls&nbsp;will&nbsp;invoke&nbsp;the&nbsp;same&nbsp;jsp.&lt;br&gt;<br>
&lt;br&gt;/s1mobile-server/xhtml/user/EP/slogin.xhtml&lt;br&gt;/s1mobile-server/xhtml/user/CID/slogin.xhtml&lt;br&gt;&lt;br&gt;Where&nbsp;EP&nbsp;and&nbsp;CID&nbsp;are&nbsp;branding&nbsp;group&nbsp;code&nbsp;which&nbsp;will&nbsp;be&nbsp;decided&nbsp;by&nbsp;the&nbsp;client.&lt;br&gt;To&nbsp;handle&nbsp;this&nbsp;I&nbsp;added&nbsp;the&nbsp;following&nbsp;code.&lt;br&gt;<br>
/*&lt;br&gt;     &nbsp;Case&nbsp;0:&nbsp;Generic&nbsp;match&nbsp;using&nbsp;wild&nbsp;cards&lt;br&gt;     &nbsp;*/&lt;br&gt;     &nbsp;if(testPath.contains(&quot;/*/&quot;))&lt;br&gt;     &nbsp;{&lt;br&gt;        &nbsp;//&nbsp;Use&nbsp;of&nbsp;wild&nbsp;card&nbsp;to&nbsp;define&nbsp;a&nbsp;directory&nbsp;of&nbsp;any&nbsp;name&lt;br&gt;        &nbsp;int&nbsp;index&nbsp;=&nbsp;testPath.indexOf(&quot;/*/&quot;);&lt;br&gt;<br>
        &nbsp;String&nbsp;exactInitialTestPath&nbsp;=&nbsp;testPath.substring(0,index+1);&lt;br&gt;        &nbsp;String&nbsp;newTestPath&nbsp;=&nbsp;testPath.substring(index+2);&lt;br&gt;        &nbsp;if(index+1&gt;requestPath.length())&lt;br&gt;        &nbsp;{&lt;br&gt;           &nbsp;return&nbsp;false;&lt;br&gt;<br>
        &nbsp;}&lt;br&gt;        &nbsp;String&nbsp;exactInitialRequestPath&nbsp;=&nbsp;requestPath.substring(0,index+1);&lt;br&gt;        &nbsp;/*&lt;br&gt;         &nbsp;*&nbsp;Condition:&nbsp;In&nbsp;case&nbsp;if&nbsp;directory&nbsp;name&nbsp;is&nbsp;valid.&lt;br&gt;         &nbsp;*&nbsp;Check&nbsp;of&nbsp;initial&nbsp;part&nbsp;matching.&nbsp;&lt;br&gt;         &nbsp;*/&lt;br&gt;<br>
        &nbsp;if(!exactInitialTestPath.equals(exactInitialRequestPath))&lt;br&gt;        &nbsp;{&lt;br&gt;           &nbsp;return&nbsp;false;&lt;br&gt;        &nbsp;}&lt;br&gt;        &nbsp;&lt;br&gt;        &nbsp;String&nbsp;remainingRequestPath&nbsp;=&nbsp;requestPath.substring(index+1);&lt;br&gt;        &nbsp;&lt;br&gt;<br>
        &nbsp;/*&lt;br&gt;         &nbsp;*&nbsp;Allowing&nbsp;the&nbsp;case&nbsp;/*&lt;br&gt;         &nbsp;*/&lt;br&gt;        &nbsp;if(remainingRequestPath.length()==1&nbsp;&amp;&amp;&nbsp;remainingRequestPath.equals(&quot;*&quot;))&lt;br&gt;        &nbsp;{&lt;br&gt;           &nbsp;return&nbsp;true;&lt;br&gt;        &nbsp;}&lt;br&gt;<br>
        &nbsp;&lt;br&gt;        &nbsp;int&nbsp;dirIindex&nbsp;=&nbsp;remainingRequestPath.indexOf(&quot;/&quot;);&lt;br&gt;        &nbsp;/*&lt;br&gt;         &nbsp;*&nbsp;If&nbsp;no&nbsp;valid&nbsp;directory&lt;br&gt;         &nbsp;*/&lt;br&gt;        &nbsp;if(dirIindex==-1)&lt;br&gt;        &nbsp;{&lt;br&gt;           &nbsp;return&nbsp;false;&lt;br&gt;<br>
        &nbsp;}&lt;br&gt;        &nbsp;String&nbsp;dirName&nbsp;=&nbsp;remainingRequestPath.substring(0,dirIindex);&lt;br&gt;        &nbsp;if(dirIindex&gt;remainingRequestPath.length())&lt;br&gt;        &nbsp;{&lt;br&gt;           &nbsp;return&nbsp;false;&lt;br&gt;        &nbsp;}&lt;br&gt;        &nbsp;String&nbsp;newRequestPath&nbsp;=&nbsp;remainingRequestPath.substring(dirIindex);&lt;br&gt;<br>
        &nbsp;&lt;br&gt;        &nbsp;/*&lt;br&gt;         &nbsp;*&nbsp;Condition:&nbsp;Check&nbsp;for&nbsp;valid&nbsp;characters&nbsp;for&nbsp;a&nbsp;directory&nbsp;name&lt;br&gt;         &nbsp;*/&lt;br&gt;        &nbsp;if(dirName.contains(&quot;/&quot;)&lt;br&gt;              &nbsp;||dirName.contains(&quot;:&quot;)||dirName.contains(&quot;*&quot;)&lt;br&gt;<br>
              &nbsp;||dirName.contains(&quot;?&quot;)||dirName.contains(&quot;\&quot;&quot;)&lt;br&gt;              &nbsp;||dirName.contains(&quot;&lt;&quot;)||dirName.contains(&quot;&gt;&quot;)&lt;br&gt;              &nbsp;||dirName.contains(&quot;|&quot;)||dirName.contains(&quot;&amp;&quot;)&lt;br&gt;<br>
              &nbsp;||dirName.contains(&quot;\\&quot;))&lt;br&gt;        &nbsp;{&lt;br&gt;           &nbsp;return&nbsp;false;&lt;br&gt;        &nbsp;}&lt;br&gt;        &nbsp;&lt;br&gt;        &nbsp;&lt;br&gt;        &nbsp;&lt;br&gt;        &nbsp;/*&lt;br&gt;         &nbsp;*&nbsp;Call&nbsp;this&nbsp;method&nbsp;again&nbsp;for&nbsp;checking&nbsp;the&nbsp;remaining&nbsp;part&nbsp;of&nbsp;the&nbsp;request&nbsp;path.&lt;br&gt;<br>
         &nbsp;*/&lt;br&gt;        &nbsp;return&nbsp;isUriMatch(newTestPath,&nbsp;newRequestPath);&lt;br&gt;     &nbsp;}&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;-------------------------&lt;br&gt;Thanks&nbsp;&amp;&nbsp;Regards&lt;br&gt;Manish&nbsp;Kumar&lt;br&gt;|&nbsp;Mob:&nbsp;+27-742650187&nbsp;|&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:manish2aug@gmail.com&quot;&gt;manish2aug@gmail.com&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;/div&gt;<br>

</tt>
