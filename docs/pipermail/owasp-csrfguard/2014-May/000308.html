<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] ajax not sending token sometimes?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20ajax%20not%20sending%20token%20sometimes%3F&In-Reply-To=%3C04BE669BEE19E54BBDC2A9A2585BB68885493E75%40exch-mbx02.exchange.upenn.edu%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000307.html">
   <LINK REL="Next"  HREF="000309.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] ajax not sending token sometimes?</H1>
    <B>Chris Hyzer</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20ajax%20not%20sending%20token%20sometimes%3F&In-Reply-To=%3C04BE669BEE19E54BBDC2A9A2585BB68885493E75%40exch-mbx02.exchange.upenn.edu%3E"
       TITLE="[Owasp-csrfguard] ajax not sending token sometimes?">mchyzer at isc.upenn.edu
       </A><BR>
    <I>Sat May 17 14:19:09 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000307.html">[Owasp-csrfguard] cache control on error page?
</A></li>
        <LI>Next message: <A HREF="000309.html">[Owasp-csrfguard] cache control default for javascript file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#308">[ date ]</a>
              <a href="thread.html#308">[ thread ]</a>
              <a href="subject.html#308">[ subject ]</a>
              <a href="author.html#308">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am seeing weird behavior where ajax will send the token from a page most of the time, but some links it doesn't.  Has anyone ever experienced this?  I was trying to debug the javascript to figure out why, and it wasn't obvious so I just decided in my framework to set the token in the header on ajax also, so now sometimes it is there twice, sometimes once.  But on the server side the header has the token twice (comma separated).  Anyways, I made a patch to make that work on the server side (if comma separated token that doesn't match the session token, then try the prefix before the comma).  Now it is working again.  I made a pull request for this.  This will not affect people not having this problem.

Thanks,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140517/e27232df/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140517/e27232df/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000307.html">[Owasp-csrfguard] cache control on error page?
</A></li>
	<LI>Next message: <A HREF="000309.html">[Owasp-csrfguard] cache control default for javascript file
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#308">[ date ]</a>
              <a href="thread.html#308">[ thread ]</a>
              <a href="subject.html#308">[ subject ]</a>
              <a href="author.html#308">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
