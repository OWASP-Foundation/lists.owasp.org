<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] Issue with Token PerPage
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Issue%20with%20Token%20PerPage&In-Reply-To=%3CCALygucx8Q0v2i5v_nLvgZt86M9nakOkBDq7_x2SBtN87suMRVg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] Issue with Token PerPage</H1>
    <B>Ahmed Tayeh</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Issue%20with%20Token%20PerPage&In-Reply-To=%3CCALygucx8Q0v2i5v_nLvgZt86M9nakOkBDq7_x2SBtN87suMRVg%40mail.gmail.com%3E"
       TITLE="[Owasp-csrfguard] Issue with Token PerPage">hamadatayeh at gmail.com
       </A><BR>
    <I>Fri May  4 07:42:08 UTC 2018</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#350">[ date ]</a>
              <a href="thread.html#350">[ thread ]</a>
              <a href="subject.html#350">[ subject ]</a>
              <a href="author.html#350">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,



I&#8217;m using OWASP CSRFGUARD in our Java project (Java 8, Spring, WebLogic
Server, Spring MVC).  Our project target is an EAR file that is deployed in
WebLogic server (12.1.3)



I have configured the project as described in the different guidelines and
manuals (see more details below). We wanted to generate a token per page in
which we put

org.owasp.csrfguard.TokenPerPage=true

org.owasp.csrfguard.TokenPerPagePrecreate=false



Nonetheless, the token is always the same per session.



My configuration is the same as the example in this repo:
<A HREF="https://github.com/aramrami/OWASP-CSRFGuard">https://github.com/aramrami/OWASP-CSRFGuard</A>



Our configuration for the project can be summed up:

1.  We add the dependency to the projects 3.1.0

2.  When we build the EAR we remove   csrfguard.js and csrfguard.properties
from the  csrfguard-3.1.0. The reason behind that is that we need our
configuration to be the only part that is loaded.

&lt;include&gt;META-INF\csrfguard.js&lt;/include&gt;

&lt;include&gt;META-INF\csrfguard.properties&lt;/include&gt;

3.  Csrfguard.js is added to our presentation layer (in Resources) without
any modification

4.  Crsfguard.properties and csrfguard.overlay.properties are added to the
same folder (Resources)

5.  Csrfguard.js is added again in WEB-INF

6.  Some configuration

org.owasp.csrfguard.Enabled = true

org.owasp.csrfguard.Logger=
eu.europa.ec.efp.util.csrguard.logging.SLF4JLogger

org.owasp.csrfguard.Ajax=true

org.owasp.csrfguard.JavascriptServlet.sourceFile =
WEB-INF/Owasp.CsrfGuard.js

org.owasp.csrfguard.JavascriptServlet.domainStrict = false

org.owasp.csrfguard.JavascriptServlet.refererMatchDomain = true

org.owasp.csrfguard.JavascriptServlet.injectIntoForms = true

org.owasp.csrfguard.JavascriptServlet.injectGetForms = true

org.owasp.csrfguard.JavascriptServlet.injectFormAttributes = true





An important thing to note, we tested without doing step 2 (We kept the
files in the csrfguard-3.1.0 project, but we still have a token per session
and not per page.





We thought that the behaviour of the project might be different in EAR that
WAR. We will be grateful for any help or suggestion to get a token per page.



Thanks in advance,
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20180504/d1b7b31e/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20180504/d1b7b31e/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#350">[ date ]</a>
              <a href="thread.html#350">[ thread ]</a>
              <a href="subject.html#350">[ subject ]</a>
              <a href="author.html#350">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
