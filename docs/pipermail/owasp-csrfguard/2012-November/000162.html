<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] Possible bug in	InterceptRedirectResponse	class
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Possible%20bug%20in%0A%09InterceptRedirectResponse%09class&In-Reply-To=%3COF15B36AC1.9E690CA6-ON86257AAD.004C0792-86257AAD.004C2368%40securian.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000161.html">
   <LINK REL="Next"  HREF="000163.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] Possible bug in	InterceptRedirectResponse	class</H1>
    <B>Jason.Lindquist at securian.com</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Possible%20bug%20in%0A%09InterceptRedirectResponse%09class&In-Reply-To=%3COF15B36AC1.9E690CA6-ON86257AAD.004C0792-86257AAD.004C2368%40securian.com%3E"
       TITLE="[Owasp-csrfguard] Possible bug in	InterceptRedirectResponse	class">Jason.Lindquist at securian.com
       </A><BR>
    <I>Mon Nov  5 13:51:38 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000161.html">[Owasp-csrfguard] Possible bug in InterceptRedirectResponse	class
</A></li>
        <LI>Next message: <A HREF="000163.html">[Owasp-csrfguard] Possible bug in InterceptRedirectResponse	class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#162">[ date ]</a>
              <a href="thread.html#162">[ thread ]</a>
              <a href="subject.html#162">[ subject ]</a>
              <a href="author.html#162">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>See the following pull request which fixes this issue: 
<A HREF="https://github.com/esheri3/OWASP-CSRFGuard/pull/30">https://github.com/esheri3/OWASP-CSRFGuard/pull/30</A> 



Jason C Lindquist
Sr. Analyst, Development Support, Information Technology  ?  Securian 
Financial Group
400 Robert Street North  ?  St. Paul, MN 55101-2098
651-665-5771
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">jason.lindquist at securian.com</A>  ?  www.securian.com

Securian Financial Group ? Financial security for the long run &#174;


This email transmission and any file attachments may contain confidential 
information intended solely for the use of the individual or entity to 
whom it is addressed. If you have received this email message in error, 
please notify the sender and delete this email from your system. If you 
are not the intended recipient, you may not disclose, copy, or distribute 
the contents of this email. 



From:   Eric Sheridan &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">eric.sheridan at owasp.org</A>&gt;
To:     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>
Date:   11/05/2012 07:27 AM
Subject:        Re: [Owasp-csrfguard] Possible bug in 
InterceptRedirectResponse       class
Sent by:        <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard-bounces at lists.owasp.org</A>



I think you understand it correctly. Care to submit a patch/pull request?

Sincerely,
Eric Sheridan
(twitter) @eric_sheridan
(blog) <A HREF="http://ericsheridan.blogspot.com">http://ericsheridan.blogspot.com</A>

On 11/5/12 7:47 AM, Gaurav Katiyar wrote:
&gt;<i> Hi All,
</I>&gt;<i> 
</I>&gt;<i> I am using the CSRF Guard project in a web application and I think
</I>&gt;<i> there is a bug in the latest code.
</I>&gt;<i> 
</I>&gt;<i> 
</I><A HREF="https://github.com/esheri3/OWASP-CSRFGuard/blame/master/Owasp.CsrfGuard/src/org/owasp/csrfguard/http/InterceptRedirectResponse.java">https://github.com/esheri3/OWASP-CSRFGuard/blame/master/Owasp.CsrfGuard/src/org/owasp/csrfguard/http/InterceptRedirectResponse.java</A>

&gt;<i> 
</I>&gt;<i> The class InterceptRedirectResponse on line 21 has the following
</I>&gt;<i> 
</I>&gt;<i> if (!location.contains(&quot;://&quot;) &amp;&amp; (csrfGuard.isProtectedPage(location)
</I>&gt;<i> || csrfGuard.isUnprotectedMethod(&quot;GET&quot;))) {
</I>&gt;<i> 
</I>&gt;<i> // code to add the token to the redirected URL
</I>&gt;<i> 
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> which says if redirect is to same domain and if page is protected or
</I>&gt;<i> GET is not protected then add the token to the URL
</I>&gt;<i> 
</I>&gt;<i> but I think it should be
</I>&gt;<i> 
</I>&gt;<i> if redirect is to same domain and if the page is protected and GET is
</I>&gt;<i> protected then add the csrf token.
</I>&gt;<i> 
</I>&gt;<i> if (!location.contains(&quot;://&quot;) &amp;&amp; csrfGuard.isProtectedPage(location)
</I>&gt;<i> &amp;&amp; !csrfGuard.isUnprotectedMethod(&quot;GET&quot;)) {
</I>&gt;<i> 
</I>&gt;<i> // code to add the token to the redirected URL
</I>&gt;<i> 
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> Have I understood this incorrectly?
</I>&gt;<i> 
</I>&gt;<i> Please help.
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Gaurav
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-csrfguard mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i> 
</I>_______________________________________________
Owasp-csrfguard mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20121105/0a807104/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20121105/0a807104/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000161.html">[Owasp-csrfguard] Possible bug in InterceptRedirectResponse	class
</A></li>
	<LI>Next message: <A HREF="000163.html">[Owasp-csrfguard] Possible bug in InterceptRedirectResponse	class
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#162">[ date ]</a>
              <a href="thread.html#162">[ thread ]</a>
              <a href="subject.html#162">[ subject ]</a>
              <a href="author.html#162">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
