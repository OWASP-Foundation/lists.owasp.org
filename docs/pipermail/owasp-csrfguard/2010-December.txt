From sumitgupta27 at gmail.com  Thu Dec  2 08:30:02 2010
From: sumitgupta27 at gmail.com (sumit gupta)
Date: Thu, 2 Dec 2010 19:00:02 +0530
Subject: [Owasp-csrfguard] CSRF Guard issue
Message-ID: <AANLkTimMQqSymHg7iz9zBgySnX_-AzvRaCn0ZrUqFMvo@mail.gmail.com>

Hi,

I am trying to configure it for my project but facing issues in configuring
it.Please see my attached csrfguard.properties file and already
entered correct mappings in web.xml and included the required csrfguard.jar
but when i send first login request to my application its getting blanked
and mutable http response have no parameter of CSRFtoken.Please help.

Thanks
Sumit
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101202/fa405746/attachment.html 

From eric.sheridan at owasp.org  Thu Dec  2 09:51:58 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Thu, 2 Dec 2010 09:51:58 -0500
Subject: [Owasp-csrfguard] CSRF Guard issue
In-Reply-To: <AANLkTimMQqSymHg7iz9zBgySnX_-AzvRaCn0ZrUqFMvo@mail.gmail.com>
References: <AANLkTimMQqSymHg7iz9zBgySnX_-AzvRaCn0ZrUqFMvo@mail.gmail.com>
Message-ID: <AANLkTi=ofhQO-O+=akeXDyTuwBbGh70j_woTaKusVC0_@mail.gmail.com>

I don't see your attachments. Can you try sending again?

-Eric

On Thu, Dec 2, 2010 at 8:30 AM, sumit gupta <sumitgupta27 at gmail.com> wrote:

>  Hi,
>
> I am trying to configure it for my project but facing issues in configuring
> it.Please see my attached csrfguard.properties file and already
> entered correct mappings in web.xml and included the required csrfguard.jar
> but when i send first login request to my application its getting blanked
> and mutable http response have no parameter of CSRFtoken.Please help.
>
> Thanks
> Sumit
>
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101202/61070075/attachment.html 

From eric.sheridan at owasp.org  Thu Dec  2 09:55:05 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Thu, 2 Dec 2010 09:55:05 -0500
Subject: [Owasp-csrfguard] Call for OWASP CSRFGuard v3 Testers!
Message-ID: <AANLkTimNhWXSN=TKCbVQaQYjTJEgRQEQ4=BcALvj6S5c@mail.gmail.com>

Team,

I have beta quality code ready to go for OWASP CSRFGuard v3. This release
has some significant updates in terms of how the CSRF token is injected in
the response. Furthermore, it has enhanced support for Ajax and implements
other capabilities such as referrer checking, token rotation, etc. While I
am still currently in the process of capturing user documentation on the
OWASP Wiki (hoping to finish up within the next week), I currently need
volunteers to test CSRFGuard v3 against their applications. Is there anyone
who would like to help test CSRFGuard v3? I can include attribution as you'd
like for your help - perhaps establishing the "OWASP CSRFGuard Testing
Team"?

-Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101202/f7eee0e1/attachment.html 

From sumitgupta27 at gmail.com  Mon Dec  6 02:46:10 2010
From: sumitgupta27 at gmail.com (sumit gupta)
Date: Mon, 6 Dec 2010 13:16:10 +0530
Subject: [Owasp-csrfguard] CSRF Guard issue
In-Reply-To: <AANLkTinxhecB2_2fpzWVw4nsNq3cmgdd=oxrD2P54-YD@mail.gmail.com>
References: <AANLkTinxhecB2_2fpzWVw4nsNq3cmgdd=oxrD2P54-YD@mail.gmail.com>
Message-ID: <AANLkTinCJOq4=QENs446VyPE4ubVUuqG3vZ_6kWm5VzY@mail.gmail.com>

Hi,

I am trying to configure it for my project but facing issues in configuring
it.Please see my attached csrfguard.properties file and already entered
correct mappings in web.xml and included the required csrfguard.jar but when
i send first login request to my application its getting blanked
and mutable http response have no parameter of CSRFtoken.Please help.

Thanks
Sumit
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101206/14a887b8/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CSRFGuard.properties
Type: application/octet-stream
Size: 3052 bytes
Desc: not available
Url : https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101206/14a887b8/attachment.obj 

From sumitgupta27 at gmail.com  Mon Dec  6 02:48:08 2010
From: sumitgupta27 at gmail.com (sumit gupta)
Date: Mon, 6 Dec 2010 13:18:08 +0530
Subject: [Owasp-csrfguard] CSRF Guard issue
Message-ID: <AANLkTimzwaXgHu0G8MSAkJWPRCC1V_z+P+iEFPfsR5dS@mail.gmail.com>

Hi,

I am trying to configure it for my project but facing issues in configuring
it.Please see my attached csrfguard.properties file and already entered
correct mappings in web.xml and included the required csrfguard.jar but when
i send first login request to my application its getting blanked
and mutable http response have no parameter of CSRFtoken.Please help.

Thanks
Sumit
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101206/0dec8a39/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: CSRFGuard.properties
Type: application/octet-stream
Size: 3052 bytes
Desc: not available
Url : https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101206/0dec8a39/attachment.obj 

From eric.sheridan at owasp.org  Mon Dec  6 11:27:06 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Mon, 6 Dec 2010 11:27:06 -0500
Subject: [Owasp-csrfguard] CSRFGuard Documentation Updated!
Message-ID: <AANLkTinnsOk09ckuO_Q-Ue17Tc3BVd1tNWsJdXnSZTAe@mail.gmail.com>

Team,

I've updated a significant amount of Wiki documentation around the OWASP
CSRFGuard project (
http://www.owasp.org/index.php/Category:OWASP_CSRFGuard_Project). What I am
most interested in is your feedback regarding the direction of the v3
release. The current status is most evident by the user manual at
http://www.owasp.org/index.php/CSRFGuard_3_User_Manual.

Some highlights worthy of discussion:

1. No longer intercepting responses
2. Token injection happens via tag library and JavaScript
3. Implemented referrer and Ajax support via the X-Requested-With header.
4. Implemented pseudo-per-request token rotation (rotates once previous
token is used up).

-Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101206/edded14a/attachment.html 

From eric.sheridan at owasp.org  Mon Dec  6 11:30:35 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Mon, 6 Dec 2010 11:30:35 -0500
Subject: [Owasp-csrfguard] CSRF Guard issue
In-Reply-To: <AANLkTimzwaXgHu0G8MSAkJWPRCC1V_z+P+iEFPfsR5dS@mail.gmail.com>
References: <AANLkTimzwaXgHu0G8MSAkJWPRCC1V_z+P+iEFPfsR5dS@mail.gmail.com>
Message-ID: <AANLkTin44uEfZWys1zM+iQEMBQs=K1tsn0FxWa0x7cWM@mail.gmail.com>

Ensure you define a value for the org.owasp.csrfguard.NewTokenRedirectPage
property. This is the page the user is redirected to after the CSRF token is
created. You can probably set this property to the URI of your login page.
Note that you'll still get CSRFException errors if your login page is also
protected by CSRFGuard as the redirect to the NewTokenRedirectPage will not
contain the CSRF parameter. Either redirect to another unprotected landing
page or do not protect the login page, either by not mapping the filter to
its uri or adding the login uri as an unprotected page in
csrfguard.properties.

-Eric

On Mon, Dec 6, 2010 at 2:48 AM, sumit gupta <sumitgupta27 at gmail.com> wrote:

> Hi,
>
> I am trying to configure it for my project but facing issues in configuring
> it.Please see my attached csrfguard.properties file and already entered
> correct mappings in web.xml and included the required csrfguard.jar but when
> i send first login request to my application its getting blanked
> and mutable http response have no parameter of CSRFtoken.Please help.
>
> Thanks
> Sumit
>
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101206/3a8e15da/attachment.html 

From roherale at yahoo.com.mx  Thu Dec  9 13:24:27 2010
From: roherale at yahoo.com.mx (Alejandro Rojas)
Date: Thu, 9 Dec 2010 12:24:27 -0600
Subject: [Owasp-csrfguard] PHP version of CSRF Guard.
Message-ID: <14A82DFA-CFAA-45AF-9DE6-BF752479F4C3@yahoo.com.mx>

Hello everybody.

I'm very interested on using a PHP version of this project, but I just can not find it anywhere within the owasp repositories on Google code. Am I looking on the wrong place?, Can you help me find the code?

Thanks.

Alejandro Rojas Hern?ndez.

From jim.manico at owasp.org  Thu Dec  9 14:45:02 2010
From: jim.manico at owasp.org (Jim Manico)
Date: Thu, 9 Dec 2010 09:45:02 -1000
Subject: [Owasp-csrfguard] PHP version of CSRF Guard.
In-Reply-To: <14A82DFA-CFAA-45AF-9DE6-BF752479F4C3@yahoo.com.mx>
References: <14A82DFA-CFAA-45AF-9DE6-BF752479F4C3@yahoo.com.mx>
Message-ID: <4d0131d2.c151df0a.34a1.4ee9@mx.google.com>

There is not a PHP port of CSRFGuard 3.0, but luckily the project is largely
a JavaScript library now - it will be a lot easier to port in the future.

- Jim

-----Original Message-----
From: owasp-csrfguard-bounces at lists.owasp.org
[mailto:owasp-csrfguard-bounces at lists.owasp.org] On Behalf Of Alejandro
Rojas
Sent: Thursday, December 09, 2010 8:24 AM
To: owasp-csrfguard at lists.owasp.org
Subject: [Owasp-csrfguard] PHP version of CSRF Guard.

Hello everybody.

I'm very interested on using a PHP version of this project, but I just can
not find it anywhere within the owasp repositories on Google code. Am I
looking on the wrong place?, Can you help me find the code?

Thanks.

Alejandro Rojas Hern?ndez.
_______________________________________________
Owasp-csrfguard mailing list
Owasp-csrfguard at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-csrfguard


From almalki at isd.net.sa  Sun Dec 12 04:47:31 2010
From: almalki at isd.net.sa (Abdul-Aziz Al-Malki)
Date: Sun, 12 Dec 2010 12:47:31 +0300
Subject: [Owasp-csrfguard] Greetings
Message-ID: <AANLkTinfY4+17rSNxTabaZ1bsO0UNtSVDUK4Hyb2_7h4@mail.gmail.com>

Hi guys,

This is my first message to this list.
I am trying to apply owasp-csrfguard to a production system, but after a
quick PoC, it have noticed few bugs. I raised 2 defects in project website.
esheri fixed 1 of them(the defect status is still NEW) but the other is
still there. The problem is that there is a total of 10 defects and its
statuses wasn't changed, which means these defects are still applicable.
I thought about taking a snapshot of the code and maintain it in my side,
but I am willing to contribute my fixes and changes back to the project. I
noticed Mr. esheri is actively rewriting the code and fixing it, but we need
to update the status of these defects so we can know the whole status of the
project.. I hope to hear back from you soon.

Thanks...**
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101212/a008b98f/attachment.html 

From eric.sheridan at owasp.org  Sun Dec 12 21:37:40 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Sun, 12 Dec 2010 21:37:40 -0500
Subject: [Owasp-csrfguard] Greetings
In-Reply-To: <AANLkTinfY4+17rSNxTabaZ1bsO0UNtSVDUK4Hyb2_7h4@mail.gmail.com>
References: <AANLkTinfY4+17rSNxTabaZ1bsO0UNtSVDUK4Hyb2_7h4@mail.gmail.com>
Message-ID: <AANLkTi=ygVRai+SQwTy1Z8EVDoAeniMKjLYBRS02xgP=@mail.gmail.com>

Abdul,

esheri is me - Eric Sheridan, project lead. Just because the defects are not
marked fixed doesn't mean they're still applicable. On the contrary, all the
'defects' listed at google should be addressed by now. I just have not been
doing a good job of closing them. I'll be updating the defects at google
right after this email. I would encourage you to not fork as you'll loose
out on the constant security updates that I am applying. I am pushing a new
ALPHA release hopefully later this week that you can use for review/testing.
If you have any patches, etc., please send them my way and I will integrate
them. If you see a defect incorrectly marked, please let me know the
specific number and I will address.

-Eric

On Sun, Dec 12, 2010 at 4:47 AM, Abdul-Aziz Al-Malki <almalki at isd.net.sa>wrote:

> Hi guys,
>
> This is my first message to this list.
> I am trying to apply owasp-csrfguard to a production system, but after a
> quick PoC, it have noticed few bugs. I raised 2 defects in project website.
> esheri fixed 1 of them(the defect status is still NEW) but the other is
> still there. The problem is that there is a total of 10 defects and its
> statuses wasn't changed, which means these defects are still applicable.
> I thought about taking a snapshot of the code and maintain it in my side,
> but I am willing to contribute my fixes and changes back to the project. I
> noticed Mr. esheri is actively rewriting the code and fixing it, but we need
> to update the status of these defects so we can know the whole status of the
> project.. I hope to hear back from you soon.
>
> Thanks...**
>
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101212/fc96b62d/attachment.html 

From sumitgupta27 at gmail.com  Tue Dec 14 09:17:26 2010
From: sumitgupta27 at gmail.com (sumit gupta)
Date: Tue, 14 Dec 2010 19:47:26 +0530
Subject: [Owasp-csrfguard] CSRF Guard issue
In-Reply-To: <AANLkTin44uEfZWys1zM+iQEMBQs=K1tsn0FxWa0x7cWM@mail.gmail.com>
References: <AANLkTimzwaXgHu0G8MSAkJWPRCC1V_z+P+iEFPfsR5dS@mail.gmail.com>
	<AANLkTin44uEfZWys1zM+iQEMBQs=K1tsn0FxWa0x7cWM@mail.gmail.com>
Message-ID: <AANLkTinD6A45u1yah5cSifw23LFXcsjjyN87T9hEKQCd@mail.gmail.com>

HI Eric,

I am not sure but there is problem with csrfGuard.properties file instead of
using
org.owasp.csrfguard.handler.JavaScriptHandler=org.owasp.csrfguard.handlers.JavaScriptHandler

we have to use
org.owasp.csrfguard.ResponseHandler=org.owasp.csrfguard.handlers.JavaScriptHandler
to use different handler otherwise it always use DefaultHandler.

Please correct me if this a wrong configuration and even after making that
change i am able to use JavaScriptHandler but my html pages getting
deformed.Is this a know issue or my configuration is not correct.

Thanks
Sumit


On Mon, Dec 6, 2010 at 10:00 PM, eric sheridan <eric.sheridan at owasp.org>wrote:

> Ensure you define a value for the org.owasp.csrfguard.NewTokenRedirectPage
> property. This is the page the user is redirected to after the CSRF token is
> created. You can probably set this property to the URI of your login page.
> Note that you'll still get CSRFException errors if your login page is also
> protected by CSRFGuard as the redirect to the NewTokenRedirectPage will not
> contain the CSRF parameter. Either redirect to another unprotected landing
> page or do not protect the login page, either by not mapping the filter to
> its uri or adding the login uri as an unprotected page in
> csrfguard.properties.
>
> -Eric
>
> On Mon, Dec 6, 2010 at 2:48 AM, sumit gupta <sumitgupta27 at gmail.com>wrote:
>
>> Hi,
>>
>> I am trying to configure it for my project but facing issues in
>> configuring it.Please see my attached csrfguard.properties file and
>> already entered correct mappings in web.xml and included the required
>> csrfguard.jar but when i send first login request to my application its
>> getting blanked and mutable http response have no parameter of
>> CSRFtoken.Please help.
>>
>> Thanks
>> Sumit
>>
>> _______________________________________________
>> Owasp-csrfguard mailing list
>> Owasp-csrfguard at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101214/98fcf3c6/attachment.html 

From sumitgupta27 at gmail.com  Wed Dec 15 08:10:17 2010
From: sumitgupta27 at gmail.com (sumit gupta)
Date: Wed, 15 Dec 2010 18:40:17 +0530
Subject: [Owasp-csrfguard] CSRF Guard issue
In-Reply-To: <AANLkTinD6A45u1yah5cSifw23LFXcsjjyN87T9hEKQCd@mail.gmail.com>
References: <AANLkTimzwaXgHu0G8MSAkJWPRCC1V_z+P+iEFPfsR5dS@mail.gmail.com>
	<AANLkTin44uEfZWys1zM+iQEMBQs=K1tsn0FxWa0x7cWM@mail.gmail.com>
	<AANLkTinD6A45u1yah5cSifw23LFXcsjjyN87T9hEKQCd@mail.gmail.com>
Message-ID: <AANLkTin71-FxAX+QsK1BdA9SX-CxLphzxdPAYOo0vXf8@mail.gmail.com>

Can anybody helps.

Thanks
Sumit

On Tue, Dec 14, 2010 at 7:47 PM, sumit gupta <sumitgupta27 at gmail.com> wrote:

> HI Eric,
>
> I am not sure but there is problem with csrfGuard.properties file instead
> of using
>
> org.owasp.csrfguard.handler.JavaScriptHandler=org.owasp.csrfguard.handlers.JavaScriptHandler
>
> we have to use
>
> org.owasp.csrfguard.ResponseHandler=org.owasp.csrfguard.handlers.JavaScriptHandler
> to use different handler otherwise it always use DefaultHandler.
>
> Please correct me if this a wrong configuration and even after making that
> change i am able to use JavaScriptHandler but my html pages getting
> deformed.Is this a know issue or my configuration is not correct.
>
> Thanks
> Sumit
>
>
> On Mon, Dec 6, 2010 at 10:00 PM, eric sheridan <eric.sheridan at owasp.org>wrote:
>
>> Ensure you define a value for the org.owasp.csrfguard.NewTokenRedirectPage
>> property. This is the page the user is redirected to after the CSRF token is
>> created. You can probably set this property to the URI of your login page.
>> Note that you'll still get CSRFException errors if your login page is also
>> protected by CSRFGuard as the redirect to the NewTokenRedirectPage will not
>> contain the CSRF parameter. Either redirect to another unprotected landing
>> page or do not protect the login page, either by not mapping the filter to
>> its uri or adding the login uri as an unprotected page in
>> csrfguard.properties.
>>
>> -Eric
>>
>> On Mon, Dec 6, 2010 at 2:48 AM, sumit gupta <sumitgupta27 at gmail.com>wrote:
>>
>>> Hi,
>>>
>>> I am trying to configure it for my project but facing issues in
>>> configuring it.Please see my attached csrfguard.properties file and
>>> already entered correct mappings in web.xml and included the required
>>> csrfguard.jar but when i send first login request to my application its
>>> getting blanked and mutable http response have no parameter of
>>> CSRFtoken.Please help.
>>>
>>> Thanks
>>> Sumit
>>>
>>> _______________________________________________
>>> Owasp-csrfguard mailing list
>>> Owasp-csrfguard at lists.owasp.org
>>> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>>>
>>>
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101215/8a5e127c/attachment.html 

From eric.sheridan at owasp.org  Wed Dec 15 20:10:01 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Wed, 15 Dec 2010 20:10:01 -0500
Subject: [Owasp-csrfguard] OWASP CSRFGuard 3.0.0.336 (ALPHA) Released!
Message-ID: <AANLkTikAVBNzMaQMWH_66P_phSm=-F=HhO1fMQ6Zz+07@mail.gmail.com>

It is with great pride that I announce the release of OWASP CSRFGuard
3.0.0.336 (ALPHA)! This is a development release of the v3 series that is in
need of peer review, testing, and general feedback in preparation for BETA.
There are several significant new features that are in need of testing in
the enterprise development environments. Please contact me for support if
you are interested in testing the latest release. Of course, I am always
open to questions, comments, or feature requests! Please check out the
project home page (
http://www.owasp.org/index.php/Category:OWASP_CSRFGuard_Project) and User
Manual (http://www.owasp.org/index.php/CSRFGuard_3_User_Manual) for more
information about how to install, configure, and deploy the OWASP CSRFGuard
library.

OWASP CSRFGuard has been completely rewritten to address the various feature
requests and bug fixes submitted to me over the past couple years. No longer
will CSRFGuard be referred to as just a "reference implementation". By
addressing the performance and scalability issues plaguing older releases,
OWASP CSRFGuard v3 is intended to serve as the de-facto standard prevention
mechanism against CSRF attacks for JavaEE web applications. The following is
a bulleted summary of the significant changes associated with the v3
release:

* OWASP CSRFGuard is now available under the much more liberal BSD license
* Owasp.CsrfGuard.properties file can be loaded from classpath, web context
directory, or current directory
* Developers can implement a custom logger to be consumed by the library
* Experimental support for the rotation of CSRF tokens once the previous
token is expired
* Experimental support for creating and verifying unique CSRF tokens per
page
* Experimental support for Ajax through the verification of headers
dynamically injected by CSRFGuard JavaScript
* Configurable actions including Log, Invalidate, Redirect, Forward,
RequestAttribute, and SessionAttribute
* Unprotected pages can be captured using same syntax used by the JavaEE
container in web.xml
* Library no longer intercepts HTTP responses produced by the web
application
* Developers can manually inject CSRF prevention tokens using the JSP tag
library
* Developers can automate injection of CSRF prevention tokens using dynamic
JavaScript DOM Manipulation
* Tokens are only injected into HTML elements that submit requests to the
current origin (planned for XHR)
* JavaScript token injection can be configured to inject into links, forms,
and XMLHttpRequests

Please check out the following resources for more information regarding
recent project updates:

Project Page -
http://www.owasp.org/index.php/Category:OWASP_CSRFGuard_Project
User Manual - http://www.owasp.org/index.php/CSRFGuard_3_User_Manual
Code Repository - http://code.google.com/p/owaspcsrfguard/
Blog - http://ericsheridan.blogspot.com/

-Eric
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20101215/e845a172/attachment.html 

From eric.sheridan at owasp.org  Thu Dec 23 12:44:13 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Thu, 23 Dec 2010 12:44:13 -0500
Subject: [Owasp-csrfguard] How CSRFGuard Protects Ajax
Message-ID: <AANLkTikvf0aL--rv0LdCsRP4rgK_Hw7QuwpSXH2+CZru@mail.gmail.com>

OWASP CSRFGuard List,

There have been several discussions on web application security
mailing lists and blogs about the best strategy to protect Ajax
interfaces from Cross-Site Request Forgery (CSRF) attacks. Most of
these discussions center around verification of the X-Requested-With
header or adoption and subsequent verification of the Origin header. I
thought now would be a good time to talk about how OWASP CSRFGuard v3
protects Ajax interfaces from CSRF attacks. CSRFGuard makes use of
JavaScript function hijacking to inject custom headers into valid
requests sent by the XMLHttpRequest object. These headers include
X-Requested-With and a custom header name value pair containing the
per-session CSRF prevention token. More technical details of that
strategy including a discussion of the Origin header can be found at
http://ericsheridan.blogspot.com/2010/12/how-csrfguard-protects-ajax.html.

My big driver here is to encourage people to review, test, and provide
feedback on the current status of OWASP CSRFGuard v3. Please let me
know what you think!

-Eric

From jim.manico at owasp.org  Thu Dec 23 14:35:17 2010
From: jim.manico at owasp.org (Jim Manico)
Date: Thu, 23 Dec 2010 09:35:17 -1000
Subject: [Owasp-csrfguard] How CSRFGuard Protects Ajax
In-Reply-To: <AANLkTikvf0aL--rv0LdCsRP4rgK_Hw7QuwpSXH2+CZru@mail.gmail.com>
References: <AANLkTikvf0aL--rv0LdCsRP4rgK_Hw7QuwpSXH2+CZru@mail.gmail.com>
Message-ID: <AEAC8F95-879B-40D8-9BFC-117F5FCBC705@owasp.org>

I think the choice to add entropy to Ajax requests, and not depend on same-origin was a very wise idea. Nice, Eric!

Eric, may I ask what your opinion is on the double-cookie submit CSRF defense method? I've heard a lot of chatter about it lately...

-Jim Manico
http://manico.net

On Dec 23, 2010, at 7:44 AM, eric sheridan <eric.sheridan at owasp.org> wrote:

> OWASP CSRFGuard List,
> 
> There have been several discussions on web application security
> mailing lists and blogs about the best strategy to protect Ajax
> interfaces from Cross-Site Request Forgery (CSRF) attacks. Most of
> these discussions center around verification of the X-Requested-With
> header or adoption and subsequent verification of the Origin header. I
> thought now would be a good time to talk about how OWASP CSRFGuard v3
> protects Ajax interfaces from CSRF attacks. CSRFGuard makes use of
> JavaScript function hijacking to inject custom headers into valid
> requests sent by the XMLHttpRequest object. These headers include
> X-Requested-With and a custom header name value pair containing the
> per-session CSRF prevention token. More technical details of that
> strategy including a discussion of the Origin header can be found at
> http://ericsheridan.blogspot.com/2010/12/how-csrfguard-protects-ajax.html.
> 
> My big driver here is to encourage people to review, test, and provide
> feedback on the current status of OWASP CSRFGuard v3. Please let me
> know what you think!
> 
> -Eric
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard

From eric.sheridan at owasp.org  Wed Dec 29 11:05:09 2010
From: eric.sheridan at owasp.org (eric sheridan)
Date: Wed, 29 Dec 2010 11:05:09 -0500
Subject: [Owasp-csrfguard] How CSRFGuard Protects Ajax
In-Reply-To: <AEAC8F95-879B-40D8-9BFC-117F5FCBC705@owasp.org>
References: <AANLkTikvf0aL--rv0LdCsRP4rgK_Hw7QuwpSXH2+CZru@mail.gmail.com>
	<AEAC8F95-879B-40D8-9BFC-117F5FCBC705@owasp.org>
Message-ID: <AANLkTikWqe4ObiQQ3+9tHP9nRQpBKuFL+AXquoEsY96S@mail.gmail.com>

I'm not crazy about the double-cookie submit strategy, actually. While
there is technical merit to this approach, it increases the general
risk of session identifier exposure. Placing the session identifier in
HTML via JavaScript or server-side processing will cause problems with
the HTTPOnly defense. Implementations will either have to a) insert
the identifier via JavaScript (i.e. disable HTTPOnly) or b) insert the
identifier when the HTML is produced (i.e. negate the benefit of
HTTPOnly). An XSS vulnerability in either condition would greatly
increase the risk of session hijacking. Let's not put all of our eggs
in one basket - the session identifier already plays enough of a role.
I would encourage the use of a separate token with a more targeted
responsibility - i.e. prevent CSRF. If that token is exposed in some
way, then we are subject to CSRF attacks which is likely less of a
risk to an application than a successful session hijacking attack. The
strategy works, but the exposure of the 'token' has a greater negative
impact in double-submit cookie as opposed to the CSRFGuard-style
synchronizer token pattern.

-Eric

On Thu, Dec 23, 2010 at 2:35 PM, Jim Manico <jim.manico at owasp.org> wrote:
> I think the choice to add entropy to Ajax requests, and not depend on same-origin was a very wise idea. Nice, Eric!
>
> Eric, may I ask what your opinion is on the double-cookie submit CSRF defense method? I've heard a lot of chatter about it lately...
>
> -Jim Manico
> http://manico.net
>
> On Dec 23, 2010, at 7:44 AM, eric sheridan <eric.sheridan at owasp.org> wrote:
>
>> OWASP CSRFGuard List,
>>
>> There have been several discussions on web application security
>> mailing lists and blogs about the best strategy to protect Ajax
>> interfaces from Cross-Site Request Forgery (CSRF) attacks. Most of
>> these discussions center around verification of the X-Requested-With
>> header or adoption and subsequent verification of the Origin header. I
>> thought now would be a good time to talk about how OWASP CSRFGuard v3
>> protects Ajax interfaces from CSRF attacks. CSRFGuard makes use of
>> JavaScript function hijacking to inject custom headers into valid
>> requests sent by the XMLHttpRequest object. These headers include
>> X-Requested-With and a custom header name value pair containing the
>> per-session CSRF prevention token. More technical details of that
>> strategy including a discussion of the Origin header can be found at
>> http://ericsheridan.blogspot.com/2010/12/how-csrfguard-protects-ajax.html.
>>
>> My big driver here is to encourage people to review, test, and provide
>> feedback on the current status of OWASP CSRFGuard v3. Please let me
>> know what you think!
>>
>> -Eric
>> _______________________________________________
>> Owasp-csrfguard mailing list
>> Owasp-csrfguard at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard
>

