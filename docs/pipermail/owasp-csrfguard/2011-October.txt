From uhnonuhmes at gmail.com  Mon Oct 17 13:07:14 2011
From: uhnonuhmes at gmail.com (uh nonuhmes)
Date: Mon, 17 Oct 2011 10:07:14 -0700
Subject: [Owasp-csrfguard] question about per-page prevention tokens
Message-ID: <CAO2MNj3TCnuaOTK2nXVaP3X3gfozic7iVh-P7dpOdAexmsD05g@mail.gmail.com>

hi,

i could be wrong, but it is my understanding that a unique per page token
will only be generated based on the page name (eg, foo.htm, bar.jsp,
yada.aspx, etc) but not on the page+params (eg, foo.htm?p1=1&p2=blah
or foo.htm?p1=1&p2=blahblah).  the way i see it, a "unique page" is unique
when page+params are not equal (ie, current uri vs previous uri), not just
page.

or maybe this topic has already been discussed, and i missed it in my
searches.  if so, forgive me as i am new to this list.

-- norm
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20111017/35719f0e/attachment.html 

From pradtke at stanford.edu  Wed Oct 19 18:33:59 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Wed, 19 Oct 2011 15:33:59 -0700
Subject: [Owasp-csrfguard] question about per-page prevention tokens
In-Reply-To: <CAO2MNj3TCnuaOTK2nXVaP3X3gfozic7iVh-P7dpOdAexmsD05g@mail.gmail.com>
References: <CAO2MNj3TCnuaOTK2nXVaP3X3gfozic7iVh-P7dpOdAexmsD05g@mail.gmail.com>
Message-ID: <4E9F5057.9080102@stanford.edu>

It is based on URI. The URI is the same regardless of query parameters.

On 10/17/11 10:07 AM, uh nonuhmes wrote:
> hi,
>
> i could be wrong, but it is my understanding that a unique per page 
> token will only be generated based on the page name (eg, foo.htm, 
> bar.jsp, yada.aspx, etc) but not on the page+params (eg, 
> foo.htm?p1=1&p2=blah or foo.htm?p1=1&p2=blahblah).  the way i see it, 
> a "unique page" is unique when page+params are not equal (ie, current 
> uri vs previous uri), not just page.
>
> or maybe this topic has already been discussed, and i missed it in my 
> searches.  if so, forgive me as i am new to this list.
>
> -- norm
>
>
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard

-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20111019/36fa7f28/attachment.html 

From xray316 at hotmail.com  Tue Oct 25 08:17:29 2011
From: xray316 at hotmail.com (Sam Theman)
Date: Tue, 25 Oct 2011 08:17:29 -0400
Subject: [Owasp-csrfguard] Help with test application
Message-ID: <BLU148-W134791EB6E802CD2408BC6E9EC0@phx.gbl>


Hello,
I have installed the test application on weblogic, and it seems to load fine, and I can bring up the index page and then the "JavaScript Token Injection"  test page....  But I am not sure what I should be seeing.... it seems like everything comes up  "thwarted", like the below, unless I put it in the unprotected list:
[Tue Oct 25 08:13:17 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/index.html[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/javascript.html[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/HelloServlet[Tue Oct 25 08:13:20 EDT 2011] [Error] potential cross-site request forgery (CSRF) attack thwarted (user:<anonymous>, ip:129.6.84.222, uri:/Owasp.CsrfGuard.Test/HelloServlet, error:required token is missing from the request)[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/JavaScriptServlet[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/JavaScriptServlet[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/error.html[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/JavaScriptServlet[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/HelloServlet[Tue Oct 25 08:13:20 EDT 2011] [Info] CsrfGuard analyzing request /Owasp.CsrfGuard.Test/JavaScriptServlet
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20111025/957f4e8e/attachment.html 

From xray316 at hotmail.com  Fri Oct 28 12:23:39 2011
From: xray316 at hotmail.com (Sam Theman)
Date: Fri, 28 Oct 2011 12:23:39 -0400
Subject: [Owasp-csrfguard] csfrguard doesn't seem to work with my frames
In-Reply-To: <BLU148-W134791EB6E802CD2408BC6E9EC0@phx.gbl>
References: <BLU148-W134791EB6E802CD2408BC6E9EC0@phx.gbl>
Message-ID: <BLU148-W3115D0F76A2D9E8B5E060AE9D30@phx.gbl>


Hello,
PLEASE HELP!
I have CSRFGuard working for my application, EXCEPT if I use frames. 
See the below sequence. I have an iframe in the frames.jsp, but is says it is missing the token... see below code also... can anyone help????
[Fri Oct 28 12:20:35 EDT 2011] [Info] CsrfGuard analyzing request /crs/frames.jsp[Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request /crs/JavaScriptServlet[Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request /crs/HelloServlet (in my iframe)[Fri Oct 28 12:20:38 EDT 2011] [Error] potential cross-site request forgery (CSRF) attack thwarted (user:<anonymous>, ip:129.6.84.222, uri:/crs/HelloServlet, error:required token is missing from the request)[Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request /crs/error.html[Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request /crs/HelloServlet[Fri Oct 28 12:20:38 EDT 2011] [Error] potential cross-site request forgery (CSRF) attack thwarted (user:<anonymous>, ip:129.6.84.222, uri:/crs/HelloServlet, error:request token does not match session token)[Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request /crs/error.html


frames.jsp ::::
<html><head>        <title>Main screen</title></head><script src="/crs/JavaScriptServlet"></script>
<iframe src="/crs/HelloServlet"></iframe></html>
 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20111028/93b68bdb/attachment.html 

From pradtke at stanford.edu  Fri Oct 28 12:50:23 2011
From: pradtke at stanford.edu (Patrick Radtke)
Date: Fri, 28 Oct 2011 09:50:23 -0700
Subject: [Owasp-csrfguard] csfrguard doesn't seem to work with my frames
In-Reply-To: <BLU148-W3115D0F76A2D9E8B5E060AE9D30@phx.gbl>
References: <BLU148-W134791EB6E802CD2408BC6E9EC0@phx.gbl>
	<BLU148-W3115D0F76A2D9E8B5E060AE9D30@phx.gbl>
Message-ID: <4EAADD4F.60703@stanford.edu>

You can add the urls that you don't want protected to a list of 
unprotected_pages.

https://www.owasp.org/index.php/CSRFGuard_3_Configuration#Unprotected_Pages

On 10/28/11 9:23 AM, Sam Theman wrote:
> Hello,
>
> PLEASE HELP!
>
> I have CSRFGuard working for my application, EXCEPT if I use frames.
>
> See the below sequence. I have an iframe in the frames.jsp, but is says
> it is missing the token... see below code also... can anyone help????
>
> [Fri Oct 28 12:20:35 EDT 2011] [Info] CsrfGuard analyzing request
> /crs/frames.jsp
> [Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request
> /crs/JavaScriptServlet
> [Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request
> /crs/HelloServlet (in my iframe)
> [Fri Oct 28 12:20:38 EDT 2011] [Error] potential cross-site request
> forgery (CSRF) attack thwarted (user:<anonymous>, ip:129.6.84.222,
> uri:/crs/HelloServlet, error:required token is missing from the request)
> [Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request
> /crs/error.html
> [Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request
> /crs/HelloServlet
> [Fri Oct 28 12:20:38 EDT 2011] [Error] potential cross-site request
> forgery (CSRF) attack thwarted (user:<anonymous>, ip:129.6.84.222,
> uri:/crs/HelloServlet, error:request token does not match session token)
> [Fri Oct 28 12:20:38 EDT 2011] [Info] CsrfGuard analyzing request
> /crs/error.html
>
>
>
> frames.jsp ::::
>
> <html>
> <head>
> <title>Main screen</title>
> </head>
> <script src="/crs/JavaScriptServlet"></script>
>
> <iframe src="/crs/HelloServlet"></iframe>
> </html>
>
>
>
> _______________________________________________
> Owasp-csrfguard mailing list
> Owasp-csrfguard at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-csrfguard


From xray316 at hotmail.com  Mon Oct 31 09:25:58 2011
From: xray316 at hotmail.com (Sam Theman)
Date: Mon, 31 Oct 2011 09:25:58 -0400
Subject: [Owasp-csrfguard] Bug in csfguard ??
Message-ID: <BLU148-W32D2C2E873911A44C4FCFCE9D60@phx.gbl>


Hello,
I have an html table that is a list of people, and the last column of the table is a field of links (delete, update). CSRFGuard correctly attaches the the token at the end of the query string in all the links except the very last link in the last row. I think the problem is in the 'for' loop of the java script, --it is stopping one short when it iterates...

 		 	   		  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20111031/ec3297be/attachment.html 

