<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] CSRFGuard problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20CSRFGuard%20problem&In-Reply-To=%3CA0FDB8D63716494EA24A037FDE02C136252C9E07%40SBACMX003.exchad.jpmchase.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000219.html">
   <LINK REL="Next"  HREF="000221.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] CSRFGuard problem</H1>
    <B>Barber, Thomas X</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20CSRFGuard%20problem&In-Reply-To=%3CA0FDB8D63716494EA24A037FDE02C136252C9E07%40SBACMX003.exchad.jpmchase.net%3E"
       TITLE="[Owasp-csrfguard] CSRFGuard problem">thomas.x.barber at jpmorgan.com
       </A><BR>
    <I>Tue Jul 23 08:29:25 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000219.html">[Owasp-csrfguard] CSRFGuard problem
</A></li>
        <LI>Next message: <A HREF="000221.html">[Owasp-csrfguard] CSRFGuard problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#220">[ date ]</a>
              <a href="thread.html#220">[ thread ]</a>
              <a href="subject.html#220">[ subject ]</a>
              <a href="author.html#220">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I&#8217;m not very familiar with the issue you are facing, but is it possible that on an exception the seam error handling tries to redirect to a page that isn&#8217;t defined as being &#8220;unprotected&#8221; which would cause CSRFGuard verification to fail constantly in a loop? If you are redirecting to a page in seam can you try defining it as being unprotected?

Thanks

Tom

Tom Barber | Application Developer GFS - Technology | Corporate &amp; Investment Bank (CIB) | J.P. Morgan, Chaseside - Hampshire Building, Floor 2, Bournemouth BH7 7DA, United Kingdom | T:+44 (0)1202 320097 |  <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">thomas.X.barber at jpmorgan.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">thomas.x.barber at jpmorgan.com</A>&gt;

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard-bounces at lists.owasp.org</A>] On Behalf Of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">ray at allthisisthat.com</A>
Sent: 23 July 2013 00:52
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>
Subject: [Owasp-csrfguard] CSRFGuard problem


I have added CSRFGuard to an existing project which is based on JSF using Seam 2.2.  My initial testing was very positive, until I started testing use cases which generated exceptions.  What I am finding is that Seam (or JSF) error handling is being interfered with by CSRFGuard.  As a result, I can get into a situation where the app is frozen, and you can't even call up the app from a new tab with the login url.  I have to restart the server in order to get any pages to work.  The only thing I have found which allows me to proceed is to invalidate the session when any potential CSRF attack is detected, by using the configuration option: &quot;org.owasp.csrfguard.action.Invalidate=org.owasp.csrfguard.action.Invalidate&quot;.  Of course, this is extremely unfriendly, as the user is suddenly returned to the login page with no warning or message about why.

I tried to configure an error page to redirect to by using:

org.owasp.csrfguard.action.Redirect=org.owasp.csrfguard.action.Redirect
org.owasp.csrfguard.action.Redirect.Page=/CSRFError.html

but even this doesn't work as the conflict between Seam and CSRFGuard prevents the redirect from being processed.  Basically, Seam is stuck in error mode, and there is nothing I have been able to do about it.

Does anyone have any suggestions?  Has anyone else had a similar problem?  I'm sure that there could equally well be conflicts with other frameworks besides JSF with Seam.   I am about to remove CSRFGuard and use Seam's s:token tag to protect the POST requests - which, of course, leaves GET unprotected.  I'd really rather not get into that, if there is some clever configuration I could use which would enable me to continue to use CSRFGuard.

Thanks in advance,

Ray Clough




This email is confidential and subject to important disclaimers and conditions including on offers for the purchase or sale of securities, accuracy and completeness of information, viruses, confidentiality, legal privilege, and legal entity disclaimers, available at <A HREF="http://www.jpmorgan.com/pages/disclosures/email.">http://www.jpmorgan.com/pages/disclosures/email.</A>  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20130723/96eb25c6/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20130723/96eb25c6/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000219.html">[Owasp-csrfguard] CSRFGuard problem
</A></li>
	<LI>Next message: <A HREF="000221.html">[Owasp-csrfguard] CSRFGuard problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#220">[ date ]</a>
              <a href="thread.html#220">[ thread ]</a>
              <a href="subject.html#220">[ subject ]</a>
              <a href="author.html#220">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
