<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] CSRFGuard problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20CSRFGuard%20problem&In-Reply-To=%3Cb63f2a3abd51952673bb3104de65303e.squirrel%40mail.allthisisthat.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000220.html">
   <LINK REL="Next"  HREF="000222.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] CSRFGuard problem</H1>
    <B>ray at allthisisthat.com</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20CSRFGuard%20problem&In-Reply-To=%3Cb63f2a3abd51952673bb3104de65303e.squirrel%40mail.allthisisthat.com%3E"
       TITLE="[Owasp-csrfguard] CSRFGuard problem">ray at allthisisthat.com
       </A><BR>
    <I>Tue Jul 23 23:43:58 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000220.html">[Owasp-csrfguard] CSRFGuard problem
</A></li>
        <LI>Next message: <A HREF="000222.html">[Owasp-csrfguard] Owasp-csrfguard Digest, Vol 35, Issue 11
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#221">[ date ]</a>
              <a href="thread.html#221">[ thread ]</a>
              <a href="subject.html#221">[ subject ]</a>
              <a href="author.html#221">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>


Thanks, Tom.&#160; The only solution I could get to work was to make the page a static html page instead of a jsf facelet.&#160; There was just a lot of conflict between the CSRFGuard redirect mechanism and the JSF (Seam) redirect mechanism.&#160; I also had to specify the error page as not
CSRFGuard protected (as you suggested), and had to specify it as &quot;/myapp/CSRFError.html&quot;, which puts the context root into the configuration file, which is undesireable, of course.&#160; Eventually, this will be replaced with a token for replacement during the build process.
Thanks
for your help,
Ray Clough
&#160;

---------------------------- Original Message ----------------------------

Subject: RE: [Owasp-csrfguard] CSRFGuard problem

From: &quot;Barber, Thomas X&quot; 

Date: Tue, July 23, 2013 1:29 am

To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">ray at allthisisthat.com</A>&quot; 

&quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>&quot; 

--------------------------------------------------------------------------



&lt;style type=&quot;text/css&quot;&gt;
-&gt;&lt;/style&gt;




&#160;

	

	
		

		I&rsquo;m not very familiar with the issue you are facing, but is it possible that on an exception the seam error handling tries to redirect to a page that isn&rsquo;t

		defined as being &ldquo;unprotected&rdquo; which would cause CSRFGuard verification to fail constantly in a loop? If you are redirecting to a page in seam can you try defining it as being unprotected?&#160;Thanks&#160;Tom&#160;Tom Barber
		| Application Developer

		GFS - Technology | Corporate &amp; Investment Bank (CIB) |

		J.P. Morgan,

		Chaseside - Hampshire Building, Floor 2, Bournemouth BH7 7DA, United Kingdom | T:+44 (0)1202 320097 |&#160;

		<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">thomas.X.barber at jpmorgan.com</A>&#160;		
			

			From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard-bounces at lists.owasp.org</A>
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard-bounces at lists.owasp.org</A>]
			On Behalf Of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">ray at allthisisthat.com</A>

			Sent: 23 July 2013 00:52

			To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>

			Subject: [Owasp-csrfguard] CSRFGuard problem
		

		&#160;
I have added CSRFGuard to an existing project which is based on JSF using Seam 2.2.&#160; My initial testing was very positive, until I started testing use cases which generated exceptions.&#160; What I am finding is that Seam (or JSF) error handling is being
interfered
		with by CSRFGuard.&#160; As a result, I can get into a situation where the app is frozen, and you can't even call up the app from a new tab with the login url.&#160; I have to restart the server in order to get any pages to work.&#160; The only thing I have found which allows

		me to proceed is to invalidate the session when any potential CSRF attack is detected, by using the configuration option: &quot;org.owasp.csrfguard.action.Invalidate=org.owasp.csrfguard.action.Invalidate&quot;.&#160; Of course, this is extremely unfriendly, as the user is

		suddenly returned to the login page with no warning or message about why.
I tried to configure an error page to redirect to by using:
org.owasp.csrfguard.action.Redirect=org.owasp.csrfguard.action.Redirect

		org.owasp.csrfguard.action.Redirect.Page=/CSRFError.html
but even this doesn't work as the conflict between Seam and CSRFGuard prevents the redirect from being processed.&#160; Basically, Seam is stuck in error mode, and there is nothing I have been able to do about it.
Does anyone
have any suggestions?&#160; Has anyone else had a similar problem?&#160; I'm sure that there could equally well be conflicts with other frameworks besides JSF with Seam. &#160; I am about to remove CSRFGuard and use Seam's s:token tag to protect the POST requests
		- which, of course, leaves GET unprotected.&#160; I'd really rather not get into that, if there is some clever configuration I could use which would enable me to continue to use CSRFGuard.
Thanks in advance,
Ray Clough

		&#160;
&#160;
	

	


	This email is confidential and subject to important disclaimers and conditions including on offers for the purchase or sale of securities, accuracy and completeness of information, viruses, confidentiality, legal privilege, and legal entity
disclaimers, available at <A HREF="http://www.jpmorgan.com/pages/disclosures/email.">http://www.jpmorgan.com/pages/disclosures/email.</A> 






&#160;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20130723/0ff355c6/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20130723/0ff355c6/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000220.html">[Owasp-csrfguard] CSRFGuard problem
</A></li>
	<LI>Next message: <A HREF="000222.html">[Owasp-csrfguard] Owasp-csrfguard Digest, Vol 35, Issue 11
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#221">[ date ]</a>
              <a href="thread.html#221">[ thread ]</a>
              <a href="subject.html#221">[ subject ]</a>
              <a href="author.html#221">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
