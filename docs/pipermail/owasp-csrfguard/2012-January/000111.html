<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] Please Suggest; Is disabling the Rotate feature correct? How to pass wild cards in unprotected page list?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Please%20Suggest%3B%0A%20Is%20disabling%20the%20Rotate%20feature%20correct%3F%20How%20to%20pass%20wild%20cards%20in%0A%20unprotected%20page%20list%3F&In-Reply-To=%3CCA%2BMvjsLEKkv_OD_8YX_APy0tcWvQXZhwe%2BefXeRK_vqAtpn6ww%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000110.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] Please Suggest; Is disabling the Rotate feature correct? How to pass wild cards in unprotected page list?</H1>
    <B>Manish Sharma</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Please%20Suggest%3B%0A%20Is%20disabling%20the%20Rotate%20feature%20correct%3F%20How%20to%20pass%20wild%20cards%20in%0A%20unprotected%20page%20list%3F&In-Reply-To=%3CCA%2BMvjsLEKkv_OD_8YX_APy0tcWvQXZhwe%2BefXeRK_vqAtpn6ww%40mail.gmail.com%3E"
       TITLE="[Owasp-csrfguard] Please Suggest; Is disabling the Rotate feature correct? How to pass wild cards in unprotected page list?">manish2aug at gmail.com
       </A><BR>
    <I>Tue Jan 31 21:44:19 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000110.html">[Owasp-csrfguard] Owasp-csrfguard Digest, Vol 19, Issue 6
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111">[ date ]</a>
              <a href="thread.html#111">[ thread ]</a>
              <a href="subject.html#111">[ subject ]</a>
              <a href="author.html#111">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I implemented OWASP CSRF Gurad with my application, I have some queries,
can you please answer the following.

1) I am disabling the Rotate feature so that the tokens wont be refreshed
in session. Is it correct and will it not add any vulnerability ?
2) As per the application we need to use the wild cards in our unprotected
pages list, so I made some changes to isUriMatched() method.
    I added the following piece of code in this method. Please verify and
if it is correct then can this piece of code can be added to the CSRF Api
in the
    coming version.

 e.g.
/mobile-server/xhtml/user/*/slogin.xhtml

The page slogin.xhtml can be called in either way, but behind the scene
same jsp is called.
Following two different calls will invoke the same jsp.

/s1mobile-server/xhtml/user/EP/slogin.xhtml
/s1mobile-server/xhtml/user/CID/slogin.xhtml

Where EP and CID are branding group code which will be decided by the
client.
To handle this I added the following code.
/*
      Case 0: Generic match using wild cards
      */
      if(testPath.contains(&quot;/*/&quot;))
      {
         // Use of wild card to define a directory of any name
         int index = testPath.indexOf(&quot;/*/&quot;);
         String exactInitialTestPath = testPath.substring(0,index+1);
         String newTestPath = testPath.substring(index+2);
         if(index+1&gt;requestPath.length())
         {
            return false;
         }
         String exactInitialRequestPath = requestPath.substring(0,index+1);
         /*
          * Condition: In case if directory name is valid.
          * Check of initial part matching.
          */
         if(!exactInitialTestPath.equals(exactInitialRequestPath))
         {
            return false;
         }

         String remainingRequestPath = requestPath.substring(index+1);

         /*
          * Allowing the case /*
          */
         if(remainingRequestPath.length()==1 &amp;&amp;
remainingRequestPath.equals(&quot;*&quot;))
         {
            return true;
         }

         int dirIindex = remainingRequestPath.indexOf(&quot;/&quot;);
         /*
          * If no valid directory
          */
         if(dirIindex==-1)
         {
            return false;
         }
         String dirName = remainingRequestPath.substring(0,dirIindex);
         if(dirIindex&gt;remainingRequestPath.length())
         {
            return false;
         }
         String newRequestPath = remainingRequestPath.substring(dirIindex);

         /*
          * Condition: Check for valid characters for a directory name
          */
         if(dirName.contains(&quot;/&quot;)
               ||dirName.contains(&quot;:&quot;)||dirName.contains(&quot;*&quot;)
               ||dirName.contains(&quot;?&quot;)||dirName.contains(&quot;\&quot;&quot;)
               ||dirName.contains(&quot;&lt;&quot;)||dirName.contains(&quot;&gt;&quot;)
               ||dirName.contains(&quot;|&quot;)||dirName.contains(&quot;&amp;&quot;)
               ||dirName.contains(&quot;\\&quot;))
         {
            return false;
         }



         /*
          * Call this method again for checking the remaining part of the
request path.
          */
         return isUriMatch(newTestPath, newRequestPath);
      }



-------------------------
Thanks &amp; Regards
Manish Kumar
|<i> Mob: +27-742650187 |
</I><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manish2aug at gmail.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20120131/0382cf2a/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20120131/0382cf2a/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000110.html">[Owasp-csrfguard] Owasp-csrfguard Digest, Vol 19, Issue 6
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#111">[ date ]</a>
              <a href="thread.html#111">[ thread ]</a>
              <a href="subject.html#111">[ subject ]</a>
              <a href="author.html#111">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
