<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] How CSRFGuard Protects Ajax
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20How%20CSRFGuard%20Protects%20Ajax&In-Reply-To=AEAC8F95-879B-40D8-9BFC-117F5FCBC705%40owasp.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000030.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] How CSRFGuard Protects Ajax</H1>
    <B>eric sheridan</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20How%20CSRFGuard%20Protects%20Ajax&In-Reply-To=AEAC8F95-879B-40D8-9BFC-117F5FCBC705%40owasp.org"
       TITLE="[Owasp-csrfguard] How CSRFGuard Protects Ajax">eric.sheridan at owasp.org
       </A><BR>
    <I>Wed Dec 29 11:05:09 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000030.html">[Owasp-csrfguard] How CSRFGuard Protects Ajax
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31">[ date ]</a>
              <a href="thread.html#31">[ thread ]</a>
              <a href="subject.html#31">[ subject ]</a>
              <a href="author.html#31">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm not crazy about the double-cookie submit strategy, actually. While
there is technical merit to this approach, it increases the general
risk of session identifier exposure. Placing the session identifier in
HTML via JavaScript or server-side processing will cause problems with
the HTTPOnly defense. Implementations will either have to a) insert
the identifier via JavaScript (i.e. disable HTTPOnly) or b) insert the
identifier when the HTML is produced (i.e. negate the benefit of
HTTPOnly). An XSS vulnerability in either condition would greatly
increase the risk of session hijacking. Let's not put all of our eggs
in one basket - the session identifier already plays enough of a role.
I would encourage the use of a separate token with a more targeted
responsibility - i.e. prevent CSRF. If that token is exposed in some
way, then we are subject to CSRF attacks which is likely less of a
risk to an application than a successful session hijacking attack. The
strategy works, but the exposure of the 'token' has a greater negative
impact in double-submit cookie as opposed to the CSRFGuard-style
synchronizer token pattern.

-Eric

On Thu, Dec 23, 2010 at 2:35 PM, Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">jim.manico at owasp.org</A>&gt; wrote:
&gt;<i> I think the choice to add entropy to Ajax requests, and not depend on same-origin was a very wise idea. Nice, Eric!
</I>&gt;<i>
</I>&gt;<i> Eric, may I ask what your opinion is on the double-cookie submit CSRF defense method? I've heard a lot of chatter about it lately...
</I>&gt;<i>
</I>&gt;<i> -Jim Manico
</I>&gt;<i> <A HREF="http://manico.net">http://manico.net</A>
</I>&gt;<i>
</I>&gt;<i> On Dec 23, 2010, at 7:44 AM, eric sheridan &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">eric.sheridan at owasp.org</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> OWASP CSRFGuard List,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> There have been several discussions on web application security
</I>&gt;&gt;<i> mailing lists and blogs about the best strategy to protect Ajax
</I>&gt;&gt;<i> interfaces from Cross-Site Request Forgery (CSRF) attacks. Most of
</I>&gt;&gt;<i> these discussions center around verification of the X-Requested-With
</I>&gt;&gt;<i> header or adoption and subsequent verification of the Origin header. I
</I>&gt;&gt;<i> thought now would be a good time to talk about how OWASP CSRFGuard v3
</I>&gt;&gt;<i> protects Ajax interfaces from CSRF attacks. CSRFGuard makes use of
</I>&gt;&gt;<i> JavaScript function hijacking to inject custom headers into valid
</I>&gt;&gt;<i> requests sent by the XMLHttpRequest object. These headers include
</I>&gt;&gt;<i> X-Requested-With and a custom header name value pair containing the
</I>&gt;&gt;<i> per-session CSRF prevention token. More technical details of that
</I>&gt;&gt;<i> strategy including a discussion of the Origin header can be found at
</I>&gt;&gt;<i> <A HREF="http://ericsheridan.blogspot.com/2010/12/how-csrfguard-protects-ajax.html.">http://ericsheridan.blogspot.com/2010/12/how-csrfguard-protects-ajax.html.</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> My big driver here is to encourage people to review, test, and provide
</I>&gt;&gt;<i> feedback on the current status of OWASP CSRFGuard v3. Please let me
</I>&gt;&gt;<i> know what you think!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Eric
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-csrfguard mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000030.html">[Owasp-csrfguard] How CSRFGuard Protects Ajax
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31">[ date ]</a>
              <a href="thread.html#31">[ thread ]</a>
              <a href="subject.html#31">[ subject ]</a>
              <a href="author.html#31">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
