<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] CSRFGuard and protecting links of pages sent	out in emails
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20CSRFGuard%20and%20protecting%20links%20of%20pages%20sent%0A%09out%20in%20emails&In-Reply-To=%3C1378988982.66157.YahooMailNeo%40web162605.mail.bf1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000244.html">
   <LINK REL="Next"  HREF="000246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] CSRFGuard and protecting links of pages sent	out in emails</H1>
    <B>P Manchanda</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20CSRFGuard%20and%20protecting%20links%20of%20pages%20sent%0A%09out%20in%20emails&In-Reply-To=%3C1378988982.66157.YahooMailNeo%40web162605.mail.bf1.yahoo.com%3E"
       TITLE="[Owasp-csrfguard] CSRFGuard and protecting links of pages sent	out in emails">manchandap at yahoo.com
       </A><BR>
    <I>Thu Sep 12 12:29:42 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000244.html">[Owasp-csrfguard] CSRFGuard and protecting links of pages sent out in emails
</A></li>
        <LI>Next message: <A HREF="000246.html">[Owasp-csrfguard] ava.lang.ClassNotFoundException: org.owasp.csrfguard.CsrfGuardListener
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#245">[ date ]</a>
              <a href="thread.html#245">[ thread ]</a>
              <a href="subject.html#245">[ subject ]</a>
              <a href="author.html#245">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Shane,

It is the Scenario B that I am looking to handle:


Scenario B:

/path/to/file.jsp?action=protected - Requires protection from CSRF attacks.
/path/to/file.jsp?action=report - Does not require protection from CSRF attacks.


&#160;
___________________ 
Thks &amp; brgds 
P Manchanda
Mobile: +91-9811210374 



________________________________
 From: Shane Argo &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">shane at shaneargo.net</A>&gt;
To: Tom Barber &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">tom.a.barber at gmail.com</A>&gt; 
Cc: P Manchanda &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manchandap at yahoo.com</A>&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A> 
Sent: Thursday, 12 September 2013, 16:42
Subject: Re: [Owasp-csrfguard] CSRFGuard and protecting links of pages sent out in emails
 


Hi,

Am I understanding correctly that the path to the .jsp file which serves the request you want to be unprotected also serves requests you do want protected (perhaps, with different request parameters)? Perhaps an example will clarify my question:


Scenario A:

/path/to/protected.jsp - Requires protection from CSRF attacks.

/path/to/reoprt.jsp - Does not require protection from CSRF attacks.


Scenario B:

/path/to/file.jsp?action=protected - Requires protection from CSRF attacks.

/path/to/file.jsp?action=report - Does not require protection from CSRF attacks.


Scenario C: (Tom's interpretation - I think)

The resource is the same resource, but sometimes you want it unprotected.



If you are dealing with scenario A, then you can use a property in the csrfguard.properties file to exclude that path from the filter. For an example see the &quot;org.owasp.csrfguard.unprotected&quot; properties in the csrfguard.properties file in test project:
<A HREF="https://github.com/esheri3/OWASP-CSRFGuard/blob/master/csrfguard-test/src/main/webapp/WEB-INF/csrfguard.properties">https://github.com/esheri3/OWASP-CSRFGuard/blob/master/csrfguard-test/src/main/webapp/WEB-INF/csrfguard.properties</A>


With scenario B, you will not be so lucky. I don't think there is a way to achieve this, but I am pretty new to the project myself so perhaps I am mistaken.


Scenario C, is not and cannot be possible. How you would you know when it is to be protected and when it's not? And if there is any way to forge a request that is unprotected, this is what an attacker would do.


Please let us know if you have any further questions. I'd be interested to hear which scenario you are dealing with.


Cheers,
Shane Argo.








On Thu, Sep 12, 2013 at 7:19 PM, Tom Barber &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">tom.a.barber at gmail.com</A>&gt; wrote:

Hi, as far as I know this isn't possible. If your could do this it would be equally possible to perform a csrf attack. Csrfguard is designed to only allow requests that originate from the app to be allowed. You could unprotect specific resources assuming safe to do so. 
&gt;<i>Thanks. 
</I>&gt;<i>Tom 
</I>&gt;<i>On 12 Sep 2013 08:31, &quot;P Manchanda&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manchandap at yahoo.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>We implemented OWASP's CSRFGuard to protect our pages in the 
</I>web application. For example */myCsrfProtected.jsp. We have injected 
CSRF token at all occurrences of */myCsrfProtected.jsp within the 
application. Everything works fine.
&gt;&gt;<i>However, we have other use case where the link to this protected page is sent out to users in an email. Think about a link to a report. Now 
</I>when user clicks on this link, the token is missing or invalid and hence the CSRFGuard filter blocks the request assuming this to be a CSRF 
attack. (this is what filter has been implemented for :-) )
&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Is there any way to handle this use case and allow access to CSRF protected page from outside the application. 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>Ideally the GET request should not be protected but being an old application, GET requests are also used to change the server state.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>___________________ 
</I>&gt;&gt;<i>Thks &amp; brgds 
</I>&gt;&gt;<i>P Manchanda
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Owasp-csrfguard mailing list
</I>&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-csrfguard mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20130912/5e56c139/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20130912/5e56c139/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000244.html">[Owasp-csrfguard] CSRFGuard and protecting links of pages sent out in emails
</A></li>
	<LI>Next message: <A HREF="000246.html">[Owasp-csrfguard] ava.lang.ClassNotFoundException: org.owasp.csrfguard.CsrfGuardListener
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#245">[ date ]</a>
              <a href="thread.html#245">[ thread ]</a>
              <a href="subject.html#245">[ subject ]</a>
              <a href="author.html#245">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
