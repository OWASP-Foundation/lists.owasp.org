From jasminsabina at yahoo.com  Fri May  9 01:21:19 2014
From: jasminsabina at yahoo.com (Jasmin Amidzic)
Date: Thu, 8 May 2014 18:21:19 -0700 (PDT)
Subject: [Owasp-csrfguard] Location of the configuration files
Message-ID: <1399598479.29297.YahooMailNeo@web162302.mail.bf1.yahoo.com>

Hi, 
??? I would like to read configuration files,? Owasp.CsrfGuard.properties and? Owasp.CsrfGuard.overlay.properties,? from a location on a application server instead of reading them from the classpath. Ideally, the information about location of the files would come from a JNDI entry on the app server.
I did some search 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140508/0cb679b9/attachment.html>

From mchyzer at isc.upenn.edu  Fri May  9 02:09:28 2014
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Fri, 9 May 2014 02:09:28 +0000
Subject: [Owasp-csrfguard] Location of the configuration files
In-Reply-To: <1399598479.29297.YahooMailNeo@web162302.mail.bf1.yahoo.com>
References: <1399598479.29297.YahooMailNeo@web162302.mail.bf1.yahoo.com>
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB68885485CE7@exch-mbx02.exchange.upenn.edu>

It doesn't cover that use case (from JNDI), but you can have a file on the filesystem not on the classpath:

Have the Owasp.CsrfGuard.properties that has all the defaults in the classpath.  Then have the Owasp.CsrfGuard.overlay.properties on the classpath that has an entry that says which files to look at in which order.  First the Owasp.CsrfGuard.properties on the classpath, then some file on the file system file:/opt/whatever/csrfguard/conf/Owasp.CsrfGuard.server.properties, something like that.

You can configure as many overlays as you want.  i.e. you can have a base config, an overlay for the application, and another overlay for the environment of the application.   However you want to organize it.

Thanks,
Chris


From: owasp-csrfguard-bounces at lists.owasp.org [mailto:owasp-csrfguard-bounces at lists.owasp.org] On Behalf Of Jasmin Amidzic
Sent: Thursday, May 08, 2014 9:21 PM
To: owasp-csrfguard at lists.owasp.org
Subject: [Owasp-csrfguard] Location of the configuration files

Hi,
    I would like to read configuration files,  Owasp.CsrfGuard.properties and  Owasp.CsrfGuard.overlay.properties,  from a location on a application server instead of reading them from the classpath. Ideally, the information about location of the files would come from a JNDI entry on the app server.
I did some search



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140509/67432f84/attachment.html>

From jasminsabina at yahoo.com  Fri May  9 02:30:08 2014
From: jasminsabina at yahoo.com (Jasmin Amidzic)
Date: Thu, 8 May 2014 19:30:08 -0700 (PDT)
Subject: [Owasp-csrfguard] Location of the configuration files
In-Reply-To: <04BE669BEE19E54BBDC2A9A2585BB68885485CE7@exch-mbx02.exchange.upenn.edu>
References: <1399598479.29297.YahooMailNeo@web162302.mail.bf1.yahoo.com>
	<04BE669BEE19E54BBDC2A9A2585BB68885485CE7@exch-mbx02.exchange.upenn.edu>
Message-ID: <1399602608.79326.YahooMailNeo@web162301.mail.bf1.yahoo.com>

Thanks Chris.?
??? Just looking at the source? code. What do you think, should it be possible to extend ConfigurationOverlayProvider and create ConfigurationOverlayJNDIProvider, which obtainins location, path to the configuration file from a JNDI property?


Thanks Jasmin


? 
On Friday, 9 May 2014 12:09 PM, Chris Hyzer <mchyzer at isc.upenn.edu> wrote:
 
It doesn?t cover that use case (from JNDI), but you can have a file on the filesystem not on the classpath:
?
Have the Owasp.CsrfGuard.properties that has all the defaults in the classpath.? Then have the Owasp.CsrfGuard.overlay.properties on the classpath that has an entry that says which files to look at in which order.? First the Owasp.CsrfGuard.properties on the classpath, then some file on the file system file:/opt/whatever/csrfguard/conf/Owasp.CsrfGuard.server.properties, something like that.
?
You can configure as many overlays as you want.? i.e. you can have a base config, an overlay for the application, and another overlay for the environment of the application.?? However you want to organize it. 
?
Thanks,
Chris
?
?
From:owasp-csrfguard-bounces at lists.owasp.org [mailto:owasp-csrfguard-bounces at lists.owasp.org] On Behalf Of Jasmin Amidzic
Sent: Thursday, May 08, 2014 9:21 PM
To: owasp-csrfguard at lists.owasp.org
Subject: [Owasp-csrfguard] Location of the configuration files
?
Hi, 
??? I would like to read configuration files,? Owasp.CsrfGuard.properties and? Owasp.CsrfGuard.overlay.properties,? from a location on a application server instead of reading them from the classpath. Ideally, the information about location of the files would come from a JNDI entry on the app server.
I did some search 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140508/43ead181/attachment.html>

From mchyzer at isc.upenn.edu  Thu May 15 15:02:01 2014
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Thu, 15 May 2014 15:02:01 +0000
Subject: [Owasp-csrfguard] cache control on error page?
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB688854907E1@exch-mbx02.exchange.upenn.edu>

If csrf guard sends the user to the no token or bad token page, should it set headers about not caching the response?

// Set standard HTTP/1.1 no-cache headers.
response.setHeader("Cache-Control", "private, no-store, no-cache, must-revalidate");

// Set standard HTTP/1.0 no-cache header.
response.setHeader("Pragma", "no-cache");

and maybe expires to 0?

Maybe this is only a problem where something was not whitelisted, then you allow it, and browser might have it cached...

Thanks,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140515/0580cddd/attachment.html>

From mchyzer at isc.upenn.edu  Sat May 17 14:19:09 2014
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Sat, 17 May 2014 14:19:09 +0000
Subject: [Owasp-csrfguard] ajax not sending token sometimes?
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB68885493E75@exch-mbx02.exchange.upenn.edu>

I am seeing weird behavior where ajax will send the token from a page most of the time, but some links it doesn't.  Has anyone ever experienced this?  I was trying to debug the javascript to figure out why, and it wasn't obvious so I just decided in my framework to set the token in the header on ajax also, so now sometimes it is there twice, sometimes once.  But on the server side the header has the token twice (comma separated).  Anyways, I made a patch to make that work on the server side (if comma separated token that doesn't match the session token, then try the prefix before the comma).  Now it is working again.  I made a pull request for this.  This will not affect people not having this problem.

Thanks,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140517/e27232df/attachment.html>

From mchyzer at isc.upenn.edu  Wed May 21 03:09:09 2014
From: mchyzer at isc.upenn.edu (Chris Hyzer)
Date: Wed, 21 May 2014 03:09:09 +0000
Subject: [Owasp-csrfguard] cache control default for javascript file
Message-ID: <04BE669BEE19E54BBDC2A9A2585BB688854958CC@exch-mbx02.exchange.upenn.edu>

This is the default for the cache control for the javascript file:

# Allows the developer to specify the value of the Cache-Control header in the HTTP response
# when serving the dynamic JavaScript file. The default value is private, maxage=28800.
# Caching of the dynamic JavaScript file is intended to minimize traffic and improve performance.
# Note that the Cache-Control header is always set to "no-store" when either the "Rotate"
# "TokenPerPage" options is set to true in Owasp.CsrfGuard.properties.
org.owasp.csrfguard.JavascriptServlet.cacheControl = private, maxage=28800


Does this mean that if sessions are invalid after 60 minutes, then if the user who has been inactive for some time between 60 minutes and 8 hours tries the app again they will get a CSRF error since the token is from the previous session?  I think a more sensible default would be 30 minutes (1800 value) since it is a common (on the low side) session inactivity period that should not cause undo load on the server...

Thoughts?

Thanks,
Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20140521/fd8c5f5c/attachment.html>

