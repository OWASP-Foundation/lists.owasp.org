<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] When there are large number of forms in a page, csrfguard.js misses injecting token in few last forms.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20When%20there%20are%20large%20number%20of%20forms%20in%20a%20page%2C%0A%20csrfguard.js%20misses%20injecting%20token%20in%20few%20last%20forms.&In-Reply-To=%3CCABZ%2Bdgd48EENLCY-4nggXGefEYVgnNTzqnx-FNCcQ64a3s7ggg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000342.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] When there are large number of forms in a page, csrfguard.js misses injecting token in few last forms.</H1>
    <B>Pralaypati Ta</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20When%20there%20are%20large%20number%20of%20forms%20in%20a%20page%2C%0A%20csrfguard.js%20misses%20injecting%20token%20in%20few%20last%20forms.&In-Reply-To=%3CCABZ%2Bdgd48EENLCY-4nggXGefEYVgnNTzqnx-FNCcQ64a3s7ggg%40mail.gmail.com%3E"
       TITLE="[Owasp-csrfguard] When there are large number of forms in a page, csrfguard.js misses injecting token in few last forms.">pralay at gmail.com
       </A><BR>
    <I>Wed Oct 19 11:46:13 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="000342.html">[Owasp-csrfguard] Fwd: CSRFGuard not working for jquery.filedownload
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#343">[ date ]</a>
              <a href="thread.html#343">[ thread ]</a>
              <a href="subject.html#343">[ subject ]</a>
              <a href="author.html#343">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,
I'm integrating CSRF Guard in a DSpace repository implementation (
<A HREF="http://www.dspace.org/">http://www.dspace.org/</A>) for one of our customer and using JavaScript token
injection to inject token in html forms. I've noticed the following issue
in csrfguard.js code.

In a particular page there are 30 form elements and there are total 452
elements in the DOM initially. Few form elements are towards the end of the
DOM e.g. 440th and 446th element. As injectTokenForm() is injecting hidden
elements in the DOM, the form elements are also shifted downward in DOM
e.g. when hidden element is added for the first 28 forms, the new position
of 440th and 446th form elements in the DOM are 468 and 474 respectively.
But the for loop at [1] iterates 452 times only and hence the last two
forms are left.

I've fixed this issue locally by incrementing the &quot;len&quot; variable by 1 when
injectTokenForm() add a new element in DOM.

Please let me know whether I should open as issue for this.

Thanks &amp; Regards,
Pralaypati Ta

[1] <A HREF="https://github.com/aramrami/OWASP-CSRFGuard/blob/master/">https://github.com/aramrami/OWASP-CSRFGuard/blob/master/</A>
csrfguard/src/main/resources/csrfguard.js#L348
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20161019/a91c9f69/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20161019/a91c9f69/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000342.html">[Owasp-csrfguard] Fwd: CSRFGuard not working for jquery.filedownload
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#343">[ date ]</a>
              <a href="thread.html#343">[ thread ]</a>
              <a href="subject.html#343">[ subject ]</a>
              <a href="author.html#343">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
