<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] difference between session tokens and csrf	tokens
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20difference%20between%20session%20tokens%20and%20csrf%0A%09tokens&In-Reply-To=010f01cc3823%2436c06110%24a4412330%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000060.html">
   <LINK REL="Next"  HREF="000062.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] difference between session tokens and csrf	tokens</H1>
    <B>Thomas Biege</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=%5BOwasp-csrfguard%5D%20difference%20between%20session%20tokens%20and%20csrf%0A%09tokens&In-Reply-To=010f01cc3823%2436c06110%24a4412330%24%40com"
       TITLE="[Owasp-csrfguard] difference between session tokens and csrf	tokens">thomas at suse.de
       </A><BR>
    <I>Mon Jul  4 09:56:02 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000060.html">[Owasp-csrfguard] difference between session tokens and csrf tokens
</A></li>
        <LI>Next message: <A HREF="000062.html">[Owasp-csrfguard] Redirect with token not working when query parameters present and TokenPerPage=true
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61">[ date ]</a>
              <a href="thread.html#61">[ thread ]</a>
              <a href="subject.html#61">[ subject ]</a>
              <a href="author.html#61">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Am Freitag, 1. Juli 2011, 21:15:00 schrieb Normando Macaraeg:
&gt;<i> Please forgive me if this is a silly question, but unfortunately I could
</I>&gt;<i> not give my team a clean answer to this question.  The question was &quot;What
</I>&gt;<i> is the difference between a session token and a CSRF token (as generated
</I>&gt;<i> by CSRFGuard)?&quot;
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> My understanding is that a session token is unique per user connection.
</I>&gt;<i> 
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> On the other hand, CSRFGuard tokens are injected into all HTML forms, all
</I>&gt;<i> src and href attributes in each page presented to the user.  Additionally,
</I>&gt;<i> a CSRF prevention token can be generated per session, if configured to do
</I>&gt;<i> so.  Isn't this CSRF session token basically the same as the web app
</I>&gt;<i> session token?  Or am I comparing apples to oranges?
</I>
The difference is in the technical details.
Today the session token is a session cookie or part of it. The browser
sends the session cookie automatically when it sends a HTTP request to a
side it has a cached cookie for. That is why CSRF attacks work for
restricted sites.
The CSRF token is used to protect POST requests and is not automatically
send but only with some user interaction. Example:
1.) admin goes to CreateUser page
2.) web-app puts a hidden field in CreateUser page that contains
    the random csrf token
3.) admin inserts user info and clicks submit
4.) the form fields and a hidden field containing the csrf token
    are send to the CreatUserSubmit page
5.) CreateUserSubmit verifies the correctness of the csrf token

An attacker would try to call CreateUserSubmit directly providing
the fom fields to create a new backdoor account and trick the admin
in &quot;executing&quot; this POST request.
This will not work anymore because the attacker does not know the random
csrf token and the CreateUSerSubmit page will reject the request therefore.

HTH
Thomas


-- 
Thomas Biege &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">thomas at suse.de</A>&gt;, SUSE LINUX, Security Support &amp; Auditing
SUSE LINUX GmbH, GF: Jeff Hawn, Jennifer Guild, Felix Imend&#246;rffer, HRB 21284 (AG N&#252;rnberg
--
  Wer aufhoert besser werden zu wollen, hoert auf gut zu sein.
                            -- Marie von Ebner-Eschenbach
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000060.html">[Owasp-csrfguard] difference between session tokens and csrf tokens
</A></li>
	<LI>Next message: <A HREF="000062.html">[Owasp-csrfguard] Redirect with token not working when query parameters present and TokenPerPage=true
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#61">[ date ]</a>
              <a href="thread.html#61">[ thread ]</a>
              <a href="subject.html#61">[ subject ]</a>
              <a href="author.html#61">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
