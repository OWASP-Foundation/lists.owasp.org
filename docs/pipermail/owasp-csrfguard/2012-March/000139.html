<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] Question about secure REST request for csrf
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Question%20about%20secure%20REST%20request%20for%20csrf&In-Reply-To=%3CCAESEMBw-YqLjybd8vw_aDn5g0X82v1wwsvaMC6JQHFwHBp_pZw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000138.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] Question about secure REST request for csrf</H1>
    <B>Andreas Schnapp</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Question%20about%20secure%20REST%20request%20for%20csrf&In-Reply-To=%3CCAESEMBw-YqLjybd8vw_aDn5g0X82v1wwsvaMC6JQHFwHBp_pZw%40mail.gmail.com%3E"
       TITLE="[Owasp-csrfguard] Question about secure REST request for csrf">mail2snap at googlemail.com
       </A><BR>
    <I>Fri Mar 23 12:11:48 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000138.html">[Owasp-csrfguard] configuration of javascript solution
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#139">[ date ]</a>
              <a href="thread.html#139">[ thread ]</a>
              <a href="subject.html#139">[ subject ]</a>
              <a href="author.html#139">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hi together,

i hope my question is not out of scope. I haven't found a generell
owasp mailing group for csrf related discussion/questions.

i want to secure REST requests for csrf attacks and have searched for
possible solutions. i'm not sure if your framework is a little bit
over sized for my needs.

i have found on wikipedia the following prevention: (
<A HREF="http://en.wikipedia.org/wiki/Cross-site_request_forgery">http://en.wikipedia.org/wiki/Cross-site_request_forgery</A> )
&quot;
A variation on this approach is to double submit cookies for users who
use JavaScript. If an authentication cookie is read using JavaScript
before the post is made, JavaScript's stricter (and more correct)
cross-domain rules will be applied. If the server requires requests to
contain the value of the authentication cookie in the body of POST
requests or the URL of dangerous GET requests, then the request must
have come from a trusted domain, since other domains are unable to
read cookies from the trusting domain.
&quot;

i think some modification of this will work for me perfectly:
- before the client send the ajax request(which should be csrf
secure), a one time use random token is generated (if this is not
secure on client side this can be get from backend by an pre-REST
request to the server).
- this token will be put to cookie from js
- this token will also be added per GET for the ajax request
- the server will compare the both values
- after the rest is successfull the client remove the value from the cookie

for me this method seems really secure. the token will only be used
once. and an atacker can't set cookies for my domain on there side.
Also this can be used for not REST requests if some JS magic will be
adding the token to cookie and GET paramter before the submit action
is invoced.



can someone please tell me if i have missed an important aspect?

i'm sorry if this is the wrong place for the question. i someone give
me a hint i will post it on some other topic.

thanks for reading and best regards
Andreas Schnapp
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000138.html">[Owasp-csrfguard] configuration of javascript solution
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#139">[ date ]</a>
              <a href="thread.html#139">[ thread ]</a>
              <a href="subject.html#139">[ subject ]</a>
              <a href="author.html#139">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
