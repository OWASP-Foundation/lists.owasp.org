From douxc at voila.fr  Fri Mar 13 15:43:12 2015
From: douxc at voila.fr (douxc at voila.fr)
Date: Fri, 13 Mar 2015 16:43:12 +0100 (CET)
Subject: [Owasp-csrfguard] Configuration properties for JSF Primefaces
Message-ID: <31629511.81801426261392139.JavaMail.www@wwinf7112>

Hello,
i'm trying to configure my project with csfguard, but the first page of my site redirect directly with the error page configured in the prioperties file. The technology used for the GUI is JSF Primefaces 5. 
My config is :

org.owasp.csrfguard.Logger=org.owasp.csrfguard.log.ConsoleLogger
#org.owasp.csrfguard.NewTokenLandingPage=
org.owasp.csrfguard.ValidateWhenNoSessionExists = true

org.owasp.csrfguard.TokenPerPage=true
org.owasp.csrfguard.Rotate=false
org.owasp.csrfguard.Ajax=true
org.owasp.csrfguard.action.class.Redirect=org.owasp.csrfguard.actions.Redirect
org.owasp.csrfguard.action.Redirect.ErrorPage=/error.html
org.owasp.csrfguard.SessionKey=OWASP_CSRFTOKEN
org.owaorg.owasp.csrfguard.TokenLength=32
org.owasp.csrfguard.PRNG=SHA1PRNG
org.owasp.csrfguard.unprotected.Index=/RootContext/index.xhtml
org.owasp.csrfguard.unprotected.Default=/RootContext/

I tried several options but did'nt manage yet to prevent the application from redirecting to error page. The technology uses Ajax and javascript and JSF 2 servlet.

Could someone help me ?

Thanks a lot,

best regards

___________________________________________________________
Mode, hifi, maison,? J'ach?te malin. Je compare les prix avec Voila.fr http://shopping.voila.fr/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20150313/75b6a5d8/attachment.html>

From veramine at cisco.com  Thu Mar 19 10:05:34 2015
From: veramine at cisco.com (Veeraswami Ramineni (veramine))
Date: Thu, 19 Mar 2015 10:05:34 +0000
Subject: [Owasp-csrfguard] CSRFGuard treats non-ajax request as ajax request
Message-ID: <3C0108E72D71554C979FFBEC7539950E2916EFB8@xmb-rcd-x03.cisco.com>

Hi,

Issue:
CSRFGuard treats non-ajax request as ajax request when there is "X-Requested-With" header present in the request.

https://github.com/aramrami/OWASP-CSRFGuard/issues/1
We are also facing same issue in a different scenario.

Scenario:
In chrome recent versions, "X-Requested-With"  header is added to the requests which are sent from flash/ flex related code.
CSRFGuard misidentifying this as ajax request and treating request as invalid as security token is not present in header.

Setup:
CSRFGuard 3.0.0.503
Java based web application.

Is there any workaround available for above mentioned issue?
Please let me know your suggestions.

Thanks in advance.
-Veera

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20150319/59cfd7fd/attachment.html>

From patrick.smith at hp.com  Thu Mar 19 13:32:58 2015
From: patrick.smith at hp.com (Smith, Patrick (Detroit, MI))
Date: Thu, 19 Mar 2015 13:32:58 +0000
Subject: [Owasp-csrfguard] How to use CSRFGuard3 with JSF
Message-ID: <36D650AD2A0E594EBCC0A099214F3D1F290A5A35@G5W2727.americas.hpqcorp.net>

I'm looking for an example of how to include CSRFGuard into a JSF application,  in particular what you need to add to the XHTML files.  I've got the CSRFGuard JAR deployed, the web.xml configured and the CSRFGuard properties set.   The CSRFGuard is protecting our app at runtime.

I'm trying to do the final piece;  to have our web pages include and send the CSRF token.  Our app is not using Javascript and we're using Mojarra JSF in Java v1.6.

I've added this to our template.xhtml page:

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:mapir="http://java.sun.com/jsf/composite/control"
      xmlns:csrf="http://www.owasp.org/index.php/Category:OWASP_CSRFGuard_Project/Owasp.CsrfGuard.tld">

It doesn't look right to me but that's the only example I could find on the internet.

I then added a <csrf-form> tag into the template.xhtml as a test as follows :

        <csrf:form>
                <h:outputLabel value="Test label:" />
                <h:inputText value="default input" />
                <h:button>Test Button</h:button>
        </csrf:form>

When looking at the web page source the csrf-form tag is not being converted into an HTML.  I see this in the web page source:

<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:csrf="http://www.owasp.org/index.php/Category:OWASP_CSRFGuard_Project/Owasp.CsrfGuard.tld"><head>
.
.
.
        <csrf:form>
                <label>
Test label:</label><input type="text" name="j_idt14" value="default input" /><input type="button" onclick="window.location.href='/mapir-public/common/dashboard.jsf'; return false;" value="" />Test Button
        </csrf:form>

The csrf:form tag is not translated.

What am I doing wrong here?  Is there a complete simple example of how to use CSRFGuard3, JSF (Mojarra) without using Javascript?

Sincerely,


Pat
PATRICK L. SMITH
Technical Consulting
Application Development Services
HP Enterprise Services
Mobile +1 248.941.5451
PC Phone +1 404.648.7363
Email patrick.smith at hp.com<mailto:patrick.smith at hp.com>

 [cid:image006.gif at 01CB49D2.5164A020] <http://www.hp.com/>



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20150319/7666417c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Picture (Device Independent Bitmap) 1.jpg
Type: image/jpeg
Size: 1145 bytes
Desc: Picture (Device Independent Bitmap) 1.jpg
URL: <http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20150319/7666417c/attachment.jpg>

