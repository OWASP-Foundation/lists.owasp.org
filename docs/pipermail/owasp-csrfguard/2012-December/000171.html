<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Error%20while%20using%20Owasp.CsrfGuard.jar&In-Reply-To=%3CCAEymBnFA2AEeURaPRRUxNPvKFgKFto%2B2kZ1y5ucBqPRbibSAMA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000172.html">
   <LINK REL="Next"  HREF="000173.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar</H1>
    <B>Paul Volpe - QV0CD-C</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Error%20while%20using%20Owasp.CsrfGuard.jar&In-Reply-To=%3CCAEymBnFA2AEeURaPRRUxNPvKFgKFto%2B2kZ1y5ucBqPRbibSAMA%40mail.gmail.com%3E"
       TITLE="[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar">paul.volpe at gsa.gov
       </A><BR>
    <I>Wed Dec 12 16:11:57 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000172.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
        <LI>Next message: <A HREF="000173.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#171">[ date ]</a>
              <a href="thread.html#171">[ thread ]</a>
              <a href="subject.html#171">[ subject ]</a>
              <a href="author.html#171">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ok.  That helps and makes sense.  In other words, the pattern *.** is not
really a good idea -- instead, it should be mapped to some value used by
your application to indicate JavaScript and AJAX calls.

On Wed, Dec 12, 2012 at 11:08 AM, P Manchanda &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manchandap at yahoo.com</A>&gt; wrote:

&gt;<i> Hi Paul,
</I>&gt;<i>
</I>&gt;<i> Not sure about your exact query but here is the details of the parameter
</I>&gt;<i> from OWASP's page:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://www.owasp.org/index.php/CSRFGuard_3_Token_Injection">https://www.owasp.org/index.php/CSRFGuard_3_Token_Injection</A>
</I>&gt;<i>
</I>&gt;<i> Allows the developer to specify a regular expression describing the
</I>&gt;<i> required value of the Referer header. Any attempts to access the servlet
</I>&gt;<i> with a Referer header that does not match the captured expression is
</I>&gt;<i> discarded. Inclusion of referer header checking is to help minimize the
</I>&gt;<i> risk of JavaScript Hijacking attacks that attempt to steal tokens from the
</I>&gt;<i> dynamically generated JavaScript. While the primary defenses against
</I>&gt;<i> JavaScript Hijacking attacks are implemented within the dynamic JavaScript
</I>&gt;<i> itself, referer header checking is implemented to achieve defense in depth.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ___________________
</I>&gt;<i> Thks &amp; brgds
</I>&gt;<i> P Manchanda
</I>&gt;<i> Mobile: +91-9811210374 &lt;<A HREF="http://geocities.com/manchandap/">http://geocities.com/manchandap/</A>&gt;
</I>&gt;<i>
</I>&gt;<i>   ------------------------------
</I>&gt;<i> *From:* Paul Volpe - QV0CD-C &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">paul.volpe at gsa.gov</A>&gt;
</I>&gt;<i> *To:* P Manchanda &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manchandap at yahoo.com</A>&gt;
</I>&gt;<i> *Cc:* sravani chukka &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">sravs63 at gmail.com</A>&gt;; &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>&quot;
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>&gt;
</I>&gt;<i> *Sent:* Wednesday, 12 December 2012, 21:23
</I>&gt;<i> *Subject:* Re: [Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</I>&gt;<i>
</I>&gt;<i>         &lt;init-param&gt;
</I>&gt;<i>           &lt;param-name&gt;referer-pattern&lt;/param-name&gt;
</I>&gt;<i>           &lt;param-value&gt;.*&lt;/param-value&gt;
</I>&gt;<i>         &lt;/init-param&gt;
</I>&gt;<i>
</I>&gt;<i> Quick question on the referer-pattern value...
</I>&gt;<i> This is used by the JavascriptServlet to do what?  The value you have here
</I>&gt;<i> as an example is very encompassing, so I would like to understand it a bit
</I>&gt;<i> better.
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> - Paul
</I>&gt;<i>
</I>&gt;<i> On Tue, Dec 11, 2012 at 10:50 AM, P Manchanda &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manchandap at yahoo.com</A>&gt;wrote:
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Please check your web.xml for the entries related to JavascriptServlet.
</I>&gt;<i> Probably you are missing a init parameter. The entries should look like
</I>&gt;<i> this:
</I>&gt;<i>
</I>&gt;<i>  &lt;servlet&gt;
</I>&gt;<i>       &lt;servlet-name&gt;JavaScriptServlet&lt;/servlet-name&gt;
</I>&gt;<i>
</I>&gt;<i> &lt;servlet-class&gt;org.owasp.csrfguard.servlet.JavaScriptServlet&lt;/servlet-class&gt;
</I>&gt;<i>         &lt;init-param&gt;
</I>&gt;<i>           &lt;param-name&gt;source-file&lt;/param-name&gt;
</I>&gt;<i>           &lt;param-value&gt;WEB-INF/Owasp.CsrfGuard.js&lt;/param-value&gt;
</I>&gt;<i>         &lt;/init-param&gt;
</I>&gt;<i>         &lt;init-param&gt;
</I>&gt;<i>           &lt;param-name&gt;inject-into-forms&lt;/param-name&gt;
</I>&gt;<i>           &lt;param-value&gt;true&lt;/param-value&gt;
</I>&gt;<i>         &lt;/init-param&gt;
</I>&gt;<i>         &lt;init-param&gt;
</I>&gt;<i>           &lt;param-name&gt;inject-into-attributes&lt;/param-name&gt;
</I>&gt;<i>           &lt;param-value&gt;true&lt;/param-value&gt;
</I>&gt;<i>         &lt;/init-param&gt;
</I>&gt;<i>         &lt;init-param&gt;
</I>&gt;<i>           &lt;param-name&gt;domain-strict&lt;/param-name&gt;
</I>&gt;<i>           &lt;param-value&gt;true&lt;/param-value&gt;
</I>&gt;<i>         &lt;/init-param&gt;
</I>&gt;<i>         &lt;init-param&gt;
</I>&gt;<i>           &lt;param-name&gt;referer-pattern&lt;/param-name&gt;
</I>&gt;<i>           &lt;param-value&gt;.*&lt;/param-value&gt;
</I>&gt;<i>         &lt;/init-param&gt;
</I>&gt;<i>         &lt;init-param&gt;
</I>&gt;<i>           &lt;param-name&gt;x-requested-with&lt;/param-name&gt;
</I>&gt;<i>           &lt;param-value&gt;OWASP CSRFGuard Project&lt;/param-value&gt;
</I>&gt;<i>         &lt;/init-param&gt;
</I>&gt;<i>      &lt;/servlet&gt;
</I>&gt;<i>
</I>&gt;<i> ___________________
</I>&gt;<i> Thks &amp; brgds
</I>&gt;<i> P Manchanda
</I>&gt;<i> Mobile: +91-9811210374 &lt;<A HREF="http://geocities.com/manchandap/">http://geocities.com/manchandap/</A>&gt;
</I>&gt;<i>
</I>&gt;<i>   ------------------------------
</I>&gt;<i> *From:* sravani chukka &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">sravs63 at gmail.com</A>&gt;
</I>&gt;<i> *To:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i> *Sent:* Tuesday, 11 December 2012, 18:19
</I>&gt;<i> *Subject:* [Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I have small problem using your jar and require some help using it. I was
</I>&gt;<i> actually trying to deploy my EAR in jboss and when i host my weblauncher
</I>&gt;<i> following exceptions are thrown showing these errors in
</I>&gt;<i> Owasp.CsrfGuard.jar.Below is the error
</I>&gt;<i>
</I>&gt;<i> 15:11:16,407 *INFO* [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:16
</I>&gt;<i> IST 2012] [Info] CsrfGuard analyzing request /pf-weblauncher/loginRealm.jsp
</I>&gt;<i>
</I>&gt;<i> 15:11:16,498 *ERROR*[org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/pf-system]]
</I>&gt;<i> (http-/0.0.0.0:8081-2) StandardWrapper.Throwable:
</I>&gt;<i> *java.lang.RuntimeException*: missing required parameter referer-pattern
</I>&gt;<i> at org.owasp.csrfguard.servlet.JavaScriptServlet.getRequiredInitParameter(
</I>&gt;<i> *JavaScriptServlet.java:206*) [Owasp.CsrfGuard.jar:]
</I>&gt;<i> at org.owasp.csrfguard.servlet.JavaScriptServlet.init(
</I>&gt;<i> *JavaScriptServlet.java:85*) [Owasp.CsrfGuard.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardWrapper.loadServlet(
</I>&gt;<i> *StandardWrapper.java:1202*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardWrapper.allocate(
</I>&gt;<i> *StandardWrapper.java:952*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardWrapperValve.invoke(
</I>&gt;<i> *StandardWrapperValve.java:188*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardContextValve.invoke(
</I>&gt;<i> *StandardContextValve.java:161*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.authenticator.AuthenticatorBase.invoke(
</I>&gt;<i> *AuthenticatorBase.java:397*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(
</I>&gt;<i> *SecurityContextAssociationValve.java:153*)
</I>&gt;<i> [jboss-as-web-7.1.2.Final-redhat-1.jar:7.1.2.Final-redhat-1]
</I>&gt;<i> at org.apache.catalina.core.StandardHostValve.invoke(
</I>&gt;<i> *StandardHostValve.java:155*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.valves.ErrorReportValve.invoke(
</I>&gt;<i> *ErrorReportValve.java:102*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardEngineValve.invoke(
</I>&gt;<i> *StandardEngineValve.java:109*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.connector.CoyoteAdapter.service(
</I>&gt;<i> *CoyoteAdapter.java:368*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.coyote.http11.Http11Processor.process(
</I>&gt;<i> *Http11Processor.java:877*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(
</I>&gt;<i> *Http11Protocol.java:679*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(
</I>&gt;<i> *JIoEndpoint.java:931*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0_04]
</I>&gt;<i> 15:11:16,500* ERROR*[org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/pf-system].[JavaScriptServlet]]
</I>&gt;<i> (http-/0.0.0.0:8081-2) Allocate exception for servlet JavaScriptServlet:
</I>&gt;<i> *java.lang.RuntimeException*: missing required parameter referer-pattern
</I>&gt;<i> at org.owasp.csrfguard.servlet.JavaScriptServlet.getRequiredInitParameter(
</I>&gt;<i> *JavaScriptServlet.java:206*) [Owasp.CsrfGuard.jar:]
</I>&gt;<i> at org.owasp.csrfguard.servlet.JavaScriptServlet.init(
</I>&gt;<i> *JavaScriptServlet.java:85*) [Owasp.CsrfGuard.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardWrapper.loadServlet(
</I>&gt;<i> *StandardWrapper.java:1202*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardWrapper.allocate(
</I>&gt;<i> *StandardWrapper.java:952*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardWrapperValve.invoke(
</I>&gt;<i> *StandardWrapperValve.java:188*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardContextValve.invoke(
</I>&gt;<i> *StandardContextValve.java:161*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.authenticator.AuthenticatorBase.invoke(
</I>&gt;<i> *AuthenticatorBase.java:397*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(
</I>&gt;<i> *SecurityContextAssociationValve.java:153*)
</I>&gt;<i> [jboss-as-web-7.1.2.Final-redhat-1.jar:7.1.2.Final-redhat-1]
</I>&gt;<i> at org.apache.catalina.core.StandardHostValve.invoke(
</I>&gt;<i> *StandardHostValve.java:155*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.valves.ErrorReportValve.invoke(
</I>&gt;<i> *ErrorReportValve.java:102*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.core.StandardEngineValve.invoke(
</I>&gt;<i> *StandardEngineValve.java:109*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.catalina.connector.CoyoteAdapter.service(
</I>&gt;<i> *CoyoteAdapter.java:368*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.coyote.http11.Http11Processor.process(
</I>&gt;<i> *Http11Processor.java:877*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(
</I>&gt;<i> *Http11Protocol.java:679*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(
</I>&gt;<i> *JIoEndpoint.java:931*) [jbossweb-7.0.16.Final-redhat-1.jar:]
</I>&gt;<i> at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0_04]
</I>&gt;<i> 15:11:22,714 INFO [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:22
</I>&gt;<i> IST 2012] [Info] CsrfGuard analyzing request /pf-weblauncher/webLauncher.do
</I>&gt;<i> 15:11:37,659 INFO [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:37
</I>&gt;<i> IST 2012] [Info] CsrfGuard analyzing request /pf-system/styles/styles.css
</I>&gt;<i> 15:11:37,662 INFO [stdout] (http-/0.0.0.0:8081-4) [Tue Dec 11 15:11:37
</I>&gt;<i> IST 2012] [Info] CsrfGuard analyzing request
</I>&gt;<i> /pf-system/styles/button_style.css
</I>&gt;<i> 15:11:37,707 INFO [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:37
</I>&gt;<i> IST 2012] [Info] CsrfGuard analyzing request /pf-weblauncher/webLauncher.do
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> and the above INFO logs continue to be printed forever. Can you please
</I>&gt;<i> suggest about the cause of the error  and required workaround ?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> sravs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-csrfguard mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-csrfguard mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> - Paul F. Volpe
</I>&gt;<i> *OCMS Team Lead*
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">paul.volpe at gsa.gov</A>
</I>&gt;<i> 703-605-2617 (w)
</I>&gt;<i> 585-214-9862 (c)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
- Paul F. Volpe
*OCMS Team Lead*
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">paul.volpe at gsa.gov</A>
703-605-2617 (w)
585-214-9862 (c)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20121212/93a8e952/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20121212/93a8e952/attachment-0001.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000172.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
	<LI>Next message: <A HREF="000173.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#171">[ date ]</a>
              <a href="thread.html#171">[ thread ]</a>
              <a href="subject.html#171">[ subject ]</a>
              <a href="author.html#171">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
