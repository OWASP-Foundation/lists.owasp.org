<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Error%20while%20using%20Owasp.CsrfGuard.jar&In-Reply-To=%3C1355328520.20260.YahooMailNeo%40web162605.mail.bf1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000170.html">
   <LINK REL="Next"  HREF="000171.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar</H1>
    <B>P Manchanda</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Error%20while%20using%20Owasp.CsrfGuard.jar&In-Reply-To=%3C1355328520.20260.YahooMailNeo%40web162605.mail.bf1.yahoo.com%3E"
       TITLE="[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar">manchandap at yahoo.com
       </A><BR>
    <I>Wed Dec 12 16:08:40 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000170.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
        <LI>Next message: <A HREF="000171.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#172">[ date ]</a>
              <a href="thread.html#172">[ thread ]</a>
              <a href="subject.html#172">[ subject ]</a>
              <a href="author.html#172">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Paul,

Not sure about your exact query but here is the details of the parameter from OWASP's page:

<A HREF="https://www.owasp.org/index.php/CSRFGuard_3_Token_Injection">https://www.owasp.org/index.php/CSRFGuard_3_Token_Injection</A>


Allows the developer to specify a regular expression describing the 
required value of the Referer header. Any attempts to access the servlet
 with a Referer header that does not match the captured expression is 
discarded. Inclusion of referer header checking is to help minimize the 
risk of JavaScript Hijacking attacks that attempt to steal tokens from 
the dynamically generated JavaScript. While the primary defenses against
 JavaScript Hijacking attacks are implemented within the dynamic 
JavaScript itself, referer header checking is implemented to achieve 
defense in depth. 



&#160;
___________________ 
Thks &amp; brgds 
P Manchanda
Mobile: +91-9811210374 



________________________________
 From: Paul Volpe - QV0CD-C &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">paul.volpe at gsa.gov</A>&gt;
To: P Manchanda &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manchandap at yahoo.com</A>&gt; 
Cc: sravani chukka &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">sravs63 at gmail.com</A>&gt;; &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A>&gt; 
Sent: Wednesday, 12 December 2012, 21:23
Subject: Re: [Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
 

&#160; &#160; &#160; &#160; &lt;init-param&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;referer-pattern&lt;/param-name&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;.*&lt;/param-value&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;
Quick question on the referer-pattern value...
This is used by the JavascriptServlet to do what? &#160;The value you have here as an example is very encompassing, so I would like to understand it a bit better.

Thanks,

- Paul


On Tue, Dec 11, 2012 at 10:50 AM, P Manchanda &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">manchandap at yahoo.com</A>&gt; wrote:

Hi,
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Please check your web.xml for the entries related to JavascriptServlet. Probably you are missing a init parameter. The entries should look like this:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>&#160;&lt;servlet&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160; &lt;servlet-name&gt;JavaScriptServlet&lt;/servlet-name&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160; &lt;servlet-class&gt;org.owasp.csrfguard.servlet.JavaScriptServlet&lt;/servlet-class&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;source-file&lt;/param-name&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;WEB-INF/Owasp.CsrfGuard.js&lt;/param-value&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;inject-into-forms&lt;/param-name&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
</I> &lt;param-value&gt;true&lt;/param-value&gt;
&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;inject-into-attributes&lt;/param-name&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;true&lt;/param-value&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;domain-strict&lt;/param-name&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;true&lt;/param-value&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
</I> &lt;param-name&gt;referer-pattern&lt;/param-name&gt;
&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;.*&lt;/param-value&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-name&gt;x-requested-with&lt;/param-name&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;param-value&gt;OWASP CSRFGuard Project&lt;/param-value&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;/init-param&gt;
</I>&gt;<i>&#160;&#160;&#160;&#160; &lt;/servlet&gt;
</I>&gt;<i>&#160;
</I>&gt;<i>___________________ 
</I>&gt;<i>Thks &amp; brgds 
</I>&gt;<i>P Manchanda
</I>&gt;<i>Mobile: +91-9811210374 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>________________________________
</I>&gt;<i> From: sravani chukka &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">sravs63 at gmail.com</A>&gt;
</I>&gt;<i>To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">owasp-csrfguard at lists.owasp.org</A> 
</I>&gt;<i>Sent: Tuesday, 11 December 2012, 18:19
</I>&gt;<i>Subject: [Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</I>&gt;<i> 
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Hi,
</I>&gt;<i>&#160;
</I>&gt;<i>I have small problem using your jar and require some help using it. I was actually trying to deploy my EAR in jboss and when i host my weblauncher following exceptions are thrown showing these errors in 
</I>&gt;<i>Owasp.CsrfGuard.jar.Below is the error 
</I>&gt;<i>&#160;15:11:16,407 INFO [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:16 IST 2012] [Info] CsrfGuard analyzing request /pf-weblauncher/loginRealm.jsp
</I>&gt;<i>&#160;
</I>&gt;<i>15:11:16,498 ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/pf-system]] (http-/0.0.0.0:8081-2) StandardWrapper.Throwable: java.lang.RuntimeException: missing required parameter referer-pattern 
</I>&gt;<i>at org.owasp.csrfguard.servlet.JavaScriptServlet.getRequiredInitParameter(JavaScriptServlet.java:206) [Owasp.CsrfGuard.jar:] 
</I>&gt;<i>at org.owasp.csrfguard.servlet.JavaScriptServlet.init(JavaScriptServlet.java:85) [Owasp.CsrfGuard.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1202) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:952) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:188) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:397) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.2.Final-redhat-1.jar:7.1.2.Final-redhat-1] 
</I>&gt;<i>at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:679) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:931) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0_04]
</I>&gt;<i>15:11:16,500ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/pf-system].[JavaScriptServlet]] (http-/0.0.0.0:8081-2) Allocate exception for servlet JavaScriptServlet: java.lang.RuntimeException: missing required parameter referer-pattern 
</I>&gt;<i>at org.owasp.csrfguard.servlet.JavaScriptServlet.getRequiredInitParameter(JavaScriptServlet.java:206) [Owasp.CsrfGuard.jar:] 
</I>&gt;<i>at org.owasp.csrfguard.servlet.JavaScriptServlet.init(JavaScriptServlet.java:85) [Owasp.CsrfGuard.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1202) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardWrapper.allocate(StandardWrapper.java:952) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:188) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:397) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:153) [jboss-as-web-7.1.2.Final-redhat-1.jar:7.1.2.Final-redhat-1] 
</I>&gt;<i>at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:679) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:931) [jbossweb-7.0.16.Final-redhat-1.jar:] 
</I>&gt;<i>at java.lang.Thread.run(Unknown Source) [rt.jar:1.7.0_04]
</I>&gt;<i>15:11:22,714 INFO [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:22 IST 2012] [Info] CsrfGuard analyzing request /pf-weblauncher/webLauncher.do
</I>&gt;<i>15:11:37,659 INFO [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:37 IST 2012] [Info] CsrfGuard analyzing request /pf-system/styles/styles.css
</I>&gt;<i>15:11:37,662 INFO [stdout] (http-/0.0.0.0:8081-4) [Tue Dec 11 15:11:37 IST 2012] [Info] CsrfGuard analyzing request /pf-system/styles/button_style.css
</I>&gt;<i>15:11:37,707 INFO [stdout] (http-/0.0.0.0:8081-1) [Tue Dec 11 15:11:37 IST 2012] [Info] CsrfGuard analyzing request /pf-weblauncher/webLauncher.do
</I>&gt;<i>&#160;
</I>&gt;<i>&#160;
</I>&gt;<i>&#160;
</I>&gt;<i>and the above INFO logs continue to be printed forever. Can you please suggest about the cause of the error&#160; and required workaround ?
</I>&gt;<i>&#160;
</I>&gt;<i>&#160;
</I>&gt;<i>&#160;
</I>&gt;<i>Thanks,
</I>&gt;<i>sravs
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-csrfguard mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-csrfguard mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">Owasp-csrfguard at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">https://lists.owasp.org/mailman/listinfo/owasp-csrfguard</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 

- Paul F. Volpe
OCMS Team Lead
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">paul.volpe at gsa.gov</A>
703-605-2617 (w)
585-214-9862 (c)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20121212/5af47223/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20121212/5af47223/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000170.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
	<LI>Next message: <A HREF="000171.html">[Owasp-csrfguard] Error while using Owasp.CsrfGuard.jar
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#172">[ date ]</a>
              <a href="thread.html#172">[ thread ]</a>
              <a href="subject.html#172">[ subject ]</a>
              <a href="author.html#172">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
