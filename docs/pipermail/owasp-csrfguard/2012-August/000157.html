<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfguard] Javascript generated links
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Javascript%20generated%20links&In-Reply-To=%3C1344489616.63947.YahooMailNeo%40web110509.mail.gq1.yahoo.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000156.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfguard] Javascript generated links</H1>
    <B>Smitty</B> 
    <A HREF="mailto:owasp-csrfguard%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfguard%5D%20Javascript%20generated%20links&In-Reply-To=%3C1344489616.63947.YahooMailNeo%40web110509.mail.gq1.yahoo.com%3E"
       TITLE="[Owasp-csrfguard] Javascript generated links">smitty_in_vancouver at yahoo.com
       </A><BR>
    <I>Thu Aug  9 05:20:16 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000156.html">[Owasp-csrfguard] Browser sends request before token injection
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#157">[ date ]</a>
              <a href="thread.html#157">[ thread ]</a>
              <a href="subject.html#157">[ subject ]</a>
              <a href="author.html#157">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I had to create a global variable with the token so I could include it in my custom JS code that opened new browser windows.&#160;&#160; I didn't like the idea of this at first, but based on my research I couldn't find a reason why this would be any less secure.

var OWASPToken;&#160;&#160; //outside the private function

//inside the csrfguard.js after it checks the isValidDomain

OWASPToken = {&quot;name&quot;:&quot;%TOKEN_NAME%&quot;, &quot;value&quot;:&quot;%TOKEN_VALUE%&quot;};

I tried accessing this global from another JS file in a different domain and it wasn't able to access it, so I believe the browser same origin policy protects this.&#160; So, again I believe this is no less secure.


The other option, but more intrusive to your app maybe would be to use the JavaScriptServlet to return your own JS files and it will replace the %TOKEN_VALUE% values in your own code.

I'm not an authority on this and still figuring out the best way, but these are my two cents.

Thanks,
Smitty
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20120808/36de528a/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfguard/attachments/20120808/36de528a/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000156.html">[Owasp-csrfguard] Browser sends request before token injection
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#157">[ date ]</a>
              <a href="thread.html#157">[ thread ]</a>
              <a href="subject.html#157">[ subject ]</a>
              <a href="author.html#157">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfguard">More information about the Owasp-csrfguard
mailing list</a><br>
</body></html>
