<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Fw: &quot;Broken Access Control&quot; v/s &quot;Insecure	Direct	Object Reference&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Fw%3A%20%22Broken%20Access%20Control%22%20v/s%20%22Insecure%0A%09Direct%09Object%20Reference%22&In-Reply-To=1248691180.S.3103.61558.f5mail-237-141.rediffmail.com.old.1249466268.6813%40webmail.rediffmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000560.html">
   <LINK REL="Next"  HREF="000561.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Fw: &quot;Broken Access Control&quot; v/s &quot;Insecure	Direct	Object Reference&quot;</H1>
    <B>amar wakharkar</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Fw%3A%20%22Broken%20Access%20Control%22%20v/s%20%22Insecure%0A%09Direct%09Object%20Reference%22&In-Reply-To=1248691180.S.3103.61558.f5mail-237-141.rediffmail.com.old.1249466268.6813%40webmail.rediffmail.com"
       TITLE="[Owasp-delhi] Fw: &quot;Broken Access Control&quot; v/s &quot;Insecure	Direct	Object Reference&quot;">amarsuhas at hotmail.com
       </A><BR>
    <I>Wed Aug  5 17:12:32 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000560.html">[Owasp-delhi] Fw: &quot;Broken Access Control&quot; v/s &quot;Insecure Direct	Object Reference&quot;
</A></li>
        <LI>Next message: <A HREF="000561.html">[Owasp-delhi] Need Code for sanitizing inputs in PHP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#563">[ date ]</a>
              <a href="thread.html#563">[ thread ]</a>
              <a href="subject.html#563">[ subject ]</a>
              <a href="author.html#563">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Dear Suresh,

1) Direct Object Reference Attack works as, 

Most Of the web Applications often refer data stored on the web server using some kind of ID, it might be database key, Some Objet String, many times even included in hidden fields values,  File name Of Might some other kind of Object Referrer ID which they expose to users in web page, ( for example accid, DocID,referID -- www.acme.com/account?cartid=123) 

You can use Tamper Data Or proxies like Burp to find and replace the values.  

Now the attacker will locate these values and try to brutforce it to see can he penetrate into other accounts or can access other data.

For example,

User 1 = www.acme.com/account?cartid=123

Attacker = www.acme.com/account?cartid=125

So if the attacker change his id from 125 to 123 he can access the User 1 Account and the attack will get successful. Now this is just one example there are many other ways to do it.

The main reason is because there no real access control check on those ID's . and the solution is very simple, is Never expose this ID's to users,

For example,

Instead Of www.acme.com/account?cartid=123 just use www.acme.com/account?askdjlk23423kjasjl 

So You need to replace the ID's with the Indirect reference to that object and on the server side you need some kind of mapping which will map it with the stored ID of Authenticated user. Only the server application should now the mapping.


2) Broken Access Control 

It is about how a web application grants access to content and functions to some
users and not others. These checks are performed after authentication,
and govern what &#8216;authorized&#8217; users are allowed to do. example forcefull browesing, Access without any rights, Access to critical data without Authorization, etc...

So in simple terms - Authorization - What I Can Do ?

Authentication - Who M I ?

Broken Access Control is one of the reason for Direct Object reference Attack.

And Patching is simple just Implement Good Access Control 




Date: Wed, 5 Aug 2009 09:57:48 +0000
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">sureshtiwary at rediffmail.com</A>
Subject: [Owasp-delhi] Fw: &quot;Broken Access Control&quot; v/s &quot;Insecure Direct	Object Reference&quot;

Dear OWASP Delhi,



Anyone who could clear highlight the differences and similarities between Broken Access Control and Insecure Direct Object Reference with good examples.



Thanks &amp; regards,

Suresh



Note: Forwarded message attached



-- Original Message --



From: &quot;sureshtiwary&quot; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">sureshtiwary at rediffmail.com</A>

To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>

Subject: &quot;Broken Access Control&quot; v/s &quot;Insecure Direct Object Reference&quot;


--Forwarded Message Attachment--
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Subject: &quot;Broken Access Control&quot; v/s &quot;Insecure Direct Object Reference&quot;
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">sureshtiwary at rediffmail.com</A>

Issue: &quot;Broken Access Control&quot; v/s &quot;Insecure Direct Object Reference&quot;



Dear OWASP Delhi,



Thank you all for the overwhelming response to my queries and doubts.



&quot;Broken Access Control&quot; v/s &quot;Insecure Direct Object Reference&quot;



OWASP 2007 version does not have Broken Access Control, so how do we go about if there are broken access control issues in a site ? how do we report it ? Also the basic difference between broken access control and insecure direct object reference. sometimes, it appears that there is a very thin line between them. Pls clarify.



thanks &amp; regards,

Suresh

_________________________________________________________________
Sports, news, fashion and entertainment. Pick it all up in a package called MSN India
<A HREF="http://in.msn.com">http://in.msn.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090805/26e241c1/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090805/26e241c1/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000560.html">[Owasp-delhi] Fw: &quot;Broken Access Control&quot; v/s &quot;Insecure Direct	Object Reference&quot;
</A></li>
	<LI>Next message: <A HREF="000561.html">[Owasp-delhi] Need Code for sanitizing inputs in PHP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#563">[ date ]</a>
              <a href="thread.html#563">[ thread ]</a>
              <a href="subject.html#563">[ subject ]</a>
              <a href="author.html#563">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
