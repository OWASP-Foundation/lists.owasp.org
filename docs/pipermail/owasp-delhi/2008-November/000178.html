<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] XSS in IRCTC.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20XSS%20in%20IRCTC.&In-Reply-To=OFF259A332.72E375EA-ON6525750F.0026348A-6525750F.00289BD6%40tcs.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000177.html">
   <LINK REL="Next"  HREF="000169.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] XSS in IRCTC.</H1>
    <B>Soi, Dhruv</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20XSS%20in%20IRCTC.&In-Reply-To=OFF259A332.72E375EA-ON6525750F.0026348A-6525750F.00289BD6%40tcs.com"
       TITLE="[Owasp-delhi] XSS in IRCTC.">dhruv.soi at owasp.org
       </A><BR>
    <I>Fri Nov 28 03:29:10 EST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000177.html">[Owasp-delhi] XSS in IRCTC.
</A></li>
        <LI>Next message: <A HREF="000169.html">[Owasp-delhi] Final call for chapter meeting...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#178">[ date ]</a>
              <a href="thread.html#178">[ thread ]</a>
              <a href="subject.html#178">[ subject ]</a>
              <a href="author.html#178">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>That's funny! A redirection to malicious website to download some browser
exploit and then launching a pharming attack would have helped the script
kiddie to gain much more out of it ;-) I am not sure, if it is already the
case.

 

No learning from 9/11, no compliance enforcement by govt., neither in the
industry nor in the country! Oops! We apologize but this is the very first
time, we have faced such attacks in our country! And the end customers,
clients and civilians are left to suffer for their sins of being here! Was
it sarcastic though? It was intended to be! Lol.

 

  _____  

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On Behalf Of Karthik
Muthukrishnan
Sent: Friday, November 28, 2008 12:54 PM
To: Puneet Mehta
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>; Karthik Muthukrishnan
Subject: Re: [Owasp-delhi] XSS in IRCTC.

 


I had to book another ticket, and now, given what I observed, I feel that it
is infact an XSS exploitation done by a script kiddie. I didnt do any
technical analysis, since I get to the XSSd page only after booking a
ticket. 

This is one of the scenarios, where even though I knew it to be very unsafe,
I had to provide my credit card details to the site knowing full well that
it could be going to the wrong hands. 

One consolation is the Verified by Visa stuff. My card's payment gateway
will ask me for a password during online transactions. And Stan Chart's
payment gateway is using an SSL cert by Verisign which has expired years
ago. This is a serious issue for me and am going to return the Manhattan
card.   Since the Verified by Visa is asking for a password in a separate
site, I guess IRCTC's vulnerabilities cannot read that passcode. However I
am aware that using the card info provided at the site, duplicate physical
cards may be created thus bypassing the Verified by Visa. 

Just my thoughts. 

Puneet, the security pen test might have been done by the lowest bidder! 






&quot;Puneet Mehta&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">puneet.mehta at owasp.org</A>&gt; 

11/27/2008 09:34 PM 


To

<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A> 


cc

&quot;Karthik Muthukrishnan&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">karthik.muthukrishnan at tcs.com</A>&gt;, &quot;Plash Chowdhary&quot;
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">plash.chowdhary at tcs.com</A>&gt;, <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A> 


Subject

Re: [Owasp-delhi] XSS in IRCTC.

 


 

 




I am sure, they have people hired to ensure security of thier critical
application. The question is are these so called security professionals
competent to perform the job that they are hired for...???? Or is it a
quarterly automated pen test performed last time that apparently missed to
catch the jewel crown &quot;XSS&quot;..:-) 
  



On Thu, Nov 27, 2008 at 9:13 PM, Soi, Dhruv &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>&gt; wrote: 
If you think they would understand XSS, go ahead and report this issue. And
if you think otherwise, even the confirmation won't be of any use :-)

Be generic, call it a bug and report the issue without being worried about
software bug or XSS. If they offer some remuneration then no harm in going
ahead to confirm this one or may be finding more juicy stuff. I would prefer
to confirm vulnerabilities for our clients or some software products rather
offering free consulting services to irresponsible companies those deploy
insecure software and make their customers suffer...If you find any
vulnerability on the wild, no doubt report it in ethical way! But no reason
to spend time over it, where you don't have any personal or professional
interest! 


-----Original Message-----
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A> 
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On Behalf Of Karthik
Muthukrishnan
Sent: Tuesday, November 25, 2008 11:07 AM
To: Plash Chowdhary
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Subject: Re: [Owasp-delhi] XSS in IRCTC.

Thanks for pointing out Plash.

It *seems* to be an exploitation.  I didnt have enough time to analyze it,
so I was hoping that someone from owasp delhi would confirm whether it is
an exploitation or not. &quot;Print this page&quot; link didnt work - it just showed
an alert box.  I would prefer to be reasonably sure that it is not a
programming issue.

What do other guys in the mailing list say? Report it right away or confirm
the issue and report it?




           Plash
           Chowdhary/DEL/TCS
                                                                      To
           11/25/2008 05:20          Karthik Muthukrishnan
           AM                        &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">karthik.muthukrishnan at tcs.com</A>&gt;
                                                                      cc
                                     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>,
                                     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
                                                                 Subject
                                     Re: [Owasp-delhi] XSS in IRCTC.
                                     (Document link: Karthik
                                     Muthukrishnan)











Karthik are you going for full disclosure here without including cert
India... its a govt site dude ; )

Regards,
Plash Chowdhary
Security Consultant,
Global Consulting Practice - IRM
Tata Consultancy Services
Ph:- +91-120-4398828
Buzz:- 4120286
Mailto: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">plash.chowdhary at tcs.com</A>
Website: <A HREF="http://www.tcs.com">http://www.tcs.com</A> &lt;<A HREF="http://www.tcs.com/">http://www.tcs.com/</A>&gt; 
____________________________________________
Experience certainty.        IT Services
                     Business Solutions
                     Outsourcing
____________________________________________


Karthik Muthukrishnan
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">karthik.muthukrishnan at tcs.com</A>&gt;
Sent by: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
                                                                      To
                                                          <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at li</A>
11/23/2008 11:36 PM                                        sts.owasp.org
&lt;<A HREF="http://sts.owasp.org/">http://sts.owasp.org/</A>&gt; 
                                                                      cc

                                                                 Subject
                                                          [Owasp-delhi]
                                                          XSS in IRCTC.













IRCTC seems to have been exploited by an XSS vuln. After booking the
ticket, when you click on the print this page link, an alert (&quot;hi&quot;)
appears. This is the status today morning. I didnt hav etime to analyze as
I had to rush to office. Will see if I can spend some time from office.


&quot;Pukhraj Singh&quot;
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pukhraj.singh at vikriya.c</A>
om&gt;
Sent by:                                                               To
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at list</A>               &quot;Tarun Dua&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">tarundua at gmail.com</A>&gt;
s.owasp.org &lt;<A HREF="http://s.owasp.org/">http://s.owasp.org/</A>&gt;
cc
                                      <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
                                                                 Subject
11/22/2008 08:29 PM                    Re: [Owasp-delhi] NDTV.com
                                      classified by google search as a
                                      possible attack site serving
                                      malware














Tarun,

You are correct on that one; I missed mentioning that as the exploit seemed
too trivial for my attention.

When I went through the blog entry, my focus immediately jumped to the
subsequent iframes which were being launched (the ones mentioned after the
line: &quot;launches several iframes that launch several other attacks. very
nice. I'll let you pull down that code.&quot;) and the subsequent malware it was
trying to load. I was really keen to pull them down and see if they got
something juicy.

Loosely speaking, a shotgun attack is not bound to a definition, unlike say
buffer overflows, as you may better understand; it was just a term created
by my team at Symantec to make the life and explanations easier. This one
would still come under the shotgun category (duhh - too hard on fancy
definitions) as there were multiple exploits loaded in a sequence of nested
iframes.

Best,
Pukhraj


On Sat, Nov 22, 2008 at 12:48 PM, Tarun Dua &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">tarundua at gmail.com</A>&gt; wrote:
Hi Pukhraj,

Thanks for your explanation. As I understand that a shotgun attack is
the one where the attacking malware site attempts to exploit multiple
vulnerabilities ranging from javascript to shockwave objects ?
The url you referred lists out the type of malicious SQL injection
request that will compromise an MS-SQL server( or can it compromise
other any other database servers ) by updating the open table_cursors,
thereby injecting javascript into resultsets which are being fetched
by the web-pages which thus get written out into the webpages being
served and execute a shotgun attack on endusers computers. Is my
understanding correct.

Thanks
-Tarun





On Sat, Nov 22, 2008 at 2:48 AM, Pukhraj Singh
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pukhraj.singh at vikriya.com</A>&gt; wrote:
&gt;<i> This is the second time I have heard of NDTV being compromised. The first
</I>&gt;<i> time it was compromised with the MPack exploitation toolkit.
</I>&gt;<i>
</I>&gt;<i> The infection via d0uhunqn-dot-cn is pretty old. It seems that website
</I>&gt;<i> remained compromised for a long time. Sad! It's a typical shotgun attack,
</I>&gt;<i> although the malicious links seem to be offline now. Couple of projects
</I>have
&gt;<i> crawled through those malicious websites which have been mentioned in the
</I>&gt;<i> Google diagnostics page (CastleCops, Shadowserver, Symantec SafeWeb, et
</I>al).
&gt;<i> Some of the exploits being served are old (from the Storm Worm days):
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://carnal0wnage.blogspot.com/2008/08/cute.html">http://carnal0wnage.blogspot.com/2008/08/cute.html</A>
</I>&gt;<i>
</I>&gt;<i> Best,
</I>&gt;<i> Pukhraj
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
</I>&gt;<i> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On Behalf Of Tarun Dua
</I>&gt;<i> Sent: Friday, November 21, 2008 10:33 PM
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> Subject: [Owasp-delhi] NDTV.com classified by google search as a possible
</I>&gt;<i> attack site serving malware
</I>&gt;<i>
</I>&gt;<i> See advisory here
</I>&gt;<i>
</I><A HREF="http://www.google.com/safebrowsing/diagnostic?site=http://www.ndtv.com/conve">http://www.google.com/safebrowsing/diagnostic?site=http://www.ndtv.com/conve</A>

&gt;<i> rgence/ndtv/videos.aspx&amp;hl=en
</I>&gt;<i>
</I>&gt;<i> I couldn't see the malware sites mentioned on the advisory serving out
</I>&gt;<i> from ndtv.com &lt;<A HREF="http://ndtv.com/">http://ndtv.com/</A>&gt;  anymore on my firebug console so I
</I>figure that these
&gt;<i> vulnerabilities might have been gone from their site now. Does someone
</I>&gt;<i> has more information as to what happened here, was it their windows
</I>&gt;<i> servers that got compromised or XSS issues from the advertising or
</I>&gt;<i> user generated content served by them.
</I>&gt;<i>
</I>&gt;<i> Cheers!!
</I>&gt;<i> -Tarun
</I>&gt;<i> <A HREF="http://tarundua.net/google/ndtv/advisory">http://tarundua.net/google/ndtv/advisory</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-delhi mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i>
</I>&gt;<i>
</I>_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>

ForwardSourceID:NT000100CE
=====-----=====-----=====
Notice: The information contained in this e-mail
message and/or attachments to it may contain
confidential or privileged information. If you are
not the intended recipient, any dissemination, use,
review, distribution, printing or copying of the
information contained in this e-mail message
and/or attachments to it are strictly prohibited. If
you have received this communication in error,
please notify us by reply e-mail or telephone and
immediately and permanently delete the message
and any attachments. Thank you


_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>

ForwardSourceID:NT000019B2
ForwardSourceID:NT000101A6

=====-----=====-----=====
Notice: The information contained in this e-mail
message and/or attachments to it may contain
confidential or privileged information. If you are
not the intended recipient, any dissemination, use,
review, distribution, printing or copying of the
information contained in this e-mail message
and/or attachments to it are strictly prohibited. If
you have received this communication in error,
please notify us by reply e-mail or telephone and
immediately and permanently delete the message
and any attachments. Thank you



_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>

_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A> 



-- 
Puneet Mehta CISSP CISA CEH CPTS BS7799 LA
OWASP Delhi Board
_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>

ForwardSourceID:NT00010306     

=====-----=====-----=====
Notice: The information contained in this e-mail
message and/or attachments to it may contain 
confidential or privileged information. If you are 
not the intended recipient, any dissemination, use, 
review, distribution, printing or copying of the 
information contained in this e-mail message 
and/or attachments to it are strictly prohibited. If 
you have received this communication in error, 
please notify us by reply e-mail or telephone and 
immediately and permanently delete the message 
and any attachments. Thank you
 
 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20081128/a4accf64/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20081128/a4accf64/attachment-0001.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000177.html">[Owasp-delhi] XSS in IRCTC.
</A></li>
	<LI>Next message: <A HREF="000169.html">[Owasp-delhi] Final call for chapter meeting...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#178">[ date ]</a>
              <a href="thread.html#178">[ thread ]</a>
              <a href="subject.html#178">[ subject ]</a>
              <a href="author.html#178">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
