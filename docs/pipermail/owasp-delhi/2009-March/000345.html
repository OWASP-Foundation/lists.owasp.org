<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Regarding &quot;Gmail CSRF Flaw&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Regarding%20%22Gmail%20CSRF%20Flaw%22&In-Reply-To=f162ba540903060254i46aa525fs6665997208fb04d2%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000346.html">
   <LINK REL="Next"  HREF="000347.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Regarding &quot;Gmail CSRF Flaw&quot;</H1>
    <B>nileshkumar83 at gmail.com</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Regarding%20%22Gmail%20CSRF%20Flaw%22&In-Reply-To=f162ba540903060254i46aa525fs6665997208fb04d2%40mail.gmail.com"
       TITLE="[Owasp-delhi] Regarding &quot;Gmail CSRF Flaw&quot;">nileshkumar83 at gmail.com
       </A><BR>
    <I>Fri Mar  6 06:28:12 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000346.html">[Owasp-delhi] Regarding &quot;Gmail CSRF Flaw&quot;
</A></li>
        <LI>Next message: <A HREF="000347.html">[Owasp-delhi] Happy Holi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#345">[ date ]</a>
              <a href="thread.html#345">[ thread ]</a>
              <a href="subject.html#345">[ subject ]</a>
              <a href="author.html#345">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Parmendra,

Exactly, what you said may be right in this specific case.
 But don't you think that the implementation in itself is wrong. In general
sense, in the case of Gmail the only token to authenticate the user is a
session cookie, and this cookie is sent automatically by the browser in
every request. That is the case of possible XSRF.
It might not have happend in this case because the attacker has to guess the
correct password in order to change it but if he guesses successfully then
what? The application should have a mechanism differentiate between the
request made by user and the one made by user unknowingly on behalf the
attacker.
Gmail lacks this mechanism. That's why it has been susceptible to various
CSRF attacks in the past like, mail filter attacks.
One mild ,not harming but good example of CSRF in Gmail:
  If I mail the 'Logout' link of Gmail to anybody who is currently  logged
in his Gmail account and if he clicks it, he gets logged out of
 his account.  Why? That is simply because there's lack of anti-XSRF
mechanism(like one time tokens,nonces,hidden fileds etc).
The server should identify the logged in user's request differently with one
that come with an external link's. Here  I am not talking about security
impact, rather I am elaborating on functioning of the link. Like, if the
'Logout' link when mailed to a logged in user manages to make him log out of
his session, should not happen. The server should identify and summarily
reject the external link's request. The 'Logout' link should carry some
tokens verifying which server may come to know that this is an currently
logged in user's request not an external one, and vice-versa.
I had reported this several time to Google. This is one of them:

Chris Evans [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">cevans at google.com</A>]

Dear Chris,

   Today I came across the Gmail Change Password XSRF advisory.

<A HREF="http://seclists.org/fulldisclosure/2009/Mar/0029.html">http://seclists.org/fulldisclosure/2009/Mar/0029.html</A>

 That&#8217;s what I had wanted to draw your attention in my subsequent mails
written to you. That was in the case of Logout Link, if mailed to a logged
in user and when clicked the user can be forcefully logged out. That was
because the only token to authenticate the user is a session cookie, and
this cookie is sent automatically by the browser in every request. That was
the case of possible XSRF.

And today&#8217;s disclosure proves my point.

------

Their response:

Hi Nilesh,

The &quot;disclosure&quot; you refer to does not represent a noteworthy issue. There
are many issues and subtleties with it, but one worth noting is that the
XSRF protection token in this is the user's password. In other words, a
user's password needs to be guessed?! Accordingly, the disclosure has not
been met with any excitement :)

Cheers
Chris

------

Hi Nilesh,

Hope all is well with you. Chris here from Google's Security Team. A
colleage of mine pointed out you have reported various security issues to us
recently. Thank you very much for taking the time to do that, and I wanted
to let you know where they stand.

Logout XSRF.
We will continue to track this, but as a low priority. As this is not any
security impact but a noteworthy issue.
Logout XSRF is kind of endemic to the way the web works. For example,
there's an attack you could term &quot;cookie stuffing&quot; whereby bombarding the
victim's browser will knock out cookies for authenticated sites and
effectively log the user out.
Thank you very much.
Cheers,
Chris, Google Security Team
-------
But my assessment reamains ths same...it's not the case of security impact
but it's a case of not using the antiXSRF mechanism.
That's why Gmail has been soft target for may times for XSRF attacks.

I will continue to disagree with them on the issue.
-- 
Thanks &amp; Regards,
Nilesh Kumar,
Security Specialist | Governance Risk Compliance
www.nileshkumar83.blogspot.com
www.linkedin.com/in/nileshkumar83
Mobile- +91-9891524880
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090306/a39b397b/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090306/a39b397b/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000346.html">[Owasp-delhi] Regarding &quot;Gmail CSRF Flaw&quot;
</A></li>
	<LI>Next message: <A HREF="000347.html">[Owasp-delhi] Happy Holi
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#345">[ date ]</a>
              <a href="thread.html#345">[ thread ]</a>
              <a href="subject.html#345">[ subject ]</a>
              <a href="author.html#345">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
