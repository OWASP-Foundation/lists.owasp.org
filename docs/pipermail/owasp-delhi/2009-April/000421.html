<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Regarding CSRF Flaw
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Regarding%20CSRF%20Flaw&In-Reply-To=f162ba540904122359s4346b818pf8da47709485acaa%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000420.html">
   <LINK REL="Next"  HREF="000422.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Regarding CSRF Flaw</H1>
    <B>Nilesh Kumar (India)</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Regarding%20CSRF%20Flaw&In-Reply-To=f162ba540904122359s4346b818pf8da47709485acaa%40mail.gmail.com"
       TITLE="[Owasp-delhi] Regarding CSRF Flaw">Nilesh.Kumar at sdgc.com
       </A><BR>
    <I>Mon Apr 13 05:05:51 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000420.html">[Owasp-delhi] Securing WAP sites
</A></li>
        <LI>Next message: <A HREF="000422.html">[Owasp-delhi] XSS Issue :opinions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#421">[ date ]</a>
              <a href="thread.html#421">[ thread ]</a>
              <a href="subject.html#421">[ subject ]</a>
              <a href="author.html#421">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi  Parmendra,

 

    CSRF attack is executed on behalf of a user&#8217;s authentication in an application. If the application&#8217;s user authentication mechanism relies on sessionID only ,it can be vulnerable to CSRF attack.

For an application to not be vulnerable, it must include session-related information in the URL ,other than sessionID, in a form of unidentifiable or unpredictable by the user.

 

Referring to your scenario, if an attacker sends an HTML page in e-mail to a user and lures him to click the link, the action is performed on behalf of him.

 Or simply mails to the user 

&lt;img src=&quot;<A HREF="http://mybank.com/transferamount?toacc=26617771011&amp;amount=10000000&quot;">http://mybank.com/transferamount?toacc=26617771011&amp;amount=10000000&quot;</A>&gt;

Now whenever the page containing the above link loads it will make request to the mybank&#8217;s server and perform the request to transfer the specified amount to acc no 26617771011 on behalf of logged in user&#8217;s authentication. The attacker never comes into the picture.

For more sophisticated attacks:

&lt;img src=<A HREF="http://mybank.com/transferamount?toacc=26617771011&amp;amount=10000000">http://mybank.com/transferamount?toacc=26617771011&amp;amount=10000000</A> &lt;<A HREF="http://mybank.com/transferamount?toacc=26617771011&amp;amount=10000000">http://mybank.com/transferamount?toacc=26617771011&amp;amount=10000000</A>&gt;  height:&#8221;0&#8221; width:&#8221;0&#8221;&gt;

 

For testing purpose:

1.       Be sure that the application is relying on single token authentication mechanism.

2.       Make any HTML page containing a vulnerable link as above and send to the user.

3.       Entice the user to click it, if the request is fulfilled, the application is vulnerable to CSRF.

 

 Hope this helps&#8230;

 

For more expert comments post it to OWASP mailing list.

 

Regards,

Nilesh Kumar,

Security Specialist| SDG Corporation,

www.nileshkumar83.blogspot.com &lt;<A HREF="http://www.nileshkumar83.blogspot.com">http://www.nileshkumar83.blogspot.com</A>&gt; 

+91-9891524880

 

 

 

 

From: Parmendra Sharma [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">s.parmendra at gmail.com</A>] 
Sent: Monday, April 13, 2009 12:30 PM
To: Nilesh Kumar (India)
Subject: Regarding CSRF Flaw

 

Dear Sir,

 

May i know how do you test for the CSRF vulnerabilty manually in Web Applications. Taking the scenerio that a user gets a malicious URL within the email laced with the attack using &lt;img src&gt; tag. 

Should we have to embeed an image within the mail and point it to the target application URL. Please suggest how do we do this.

-- 
Thanks and Regards:

Parmendra Sharma
Computer Security Analyst

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090413/4a420338/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090413/4a420338/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000420.html">[Owasp-delhi] Securing WAP sites
</A></li>
	<LI>Next message: <A HREF="000422.html">[Owasp-delhi] XSS Issue :opinions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#421">[ date ]</a>
              <a href="thread.html#421">[ thread ]</a>
              <a href="subject.html#421">[ subject ]</a>
              <a href="author.html#421">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
