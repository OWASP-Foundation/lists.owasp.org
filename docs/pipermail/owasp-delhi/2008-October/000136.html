<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)	LocalFile Inclusion Vulnerability POC posted on milworm
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20doubt%20on%20MySQL%20Quick%20Admin%20%3C%3D%201.5.5%20%28COOKIE%29%0A%09LocalFile%20Inclusion%20Vulnerability%20POC%20posted%20on%20milworm&In-Reply-To=6060d75e0810192208v79db62a6pd86cd5a4b09fd2a%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000133.html">
   <LINK REL="Next"  HREF="000137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)	LocalFile Inclusion Vulnerability POC posted on milworm</H1>
    <B>Soi, Dhruv</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20doubt%20on%20MySQL%20Quick%20Admin%20%3C%3D%201.5.5%20%28COOKIE%29%0A%09LocalFile%20Inclusion%20Vulnerability%20POC%20posted%20on%20milworm&In-Reply-To=6060d75e0810192208v79db62a6pd86cd5a4b09fd2a%40mail.gmail.com"
       TITLE="[Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)	LocalFile Inclusion Vulnerability POC posted on milworm">dhruv.soi at owasp.org
       </A><BR>
    <I>Mon Oct 20 03:41:28 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000133.html">[Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)	LocalFile Inclusion Vulnerability POC posted on milworm
</A></li>
        <LI>Next message: <A HREF="000137.html">[Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)	LocalFile Inclusion Vulnerability POC posted on milworm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#136">[ date ]</a>
              <a href="thread.html#136">[ thread ]</a>
              <a href="subject.html#136">[ subject ]</a>
              <a href="author.html#136">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> 

What are Magic Quotes?

 

When on, all ' (single-quote), &quot; (double quote), \ (backslash) and NULL
characters are escaped with a backslash automatically. This is identical to
what addslashes() &lt;<A HREF="http://in2.php.net/manual/en/function.addslashes.php">http://in2.php.net/manual/en/function.addslashes.php</A>&gt;
does. 

There are three magic quote directives: 

*	magic_quotes_gpc
&lt;<A HREF="http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc">http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc</A>&gt;
Affects HTTP Request data (GET, POST, and COOKIE). Cannot be set at runtime,
and defaults to on in PHP. See also get_magic_quotes_gpc()
&lt;<A HREF="http://in2.php.net/manual/en/function.get-magic-quotes-gpc.php">http://in2.php.net/manual/en/function.get-magic-quotes-gpc.php</A>&gt; . 
*	magic_quotes_runtime
&lt;<A HREF="http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-runtim">http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-runtim</A>
e&gt;  If enabled, most functions that return data from an external source,
including databases and text files, will have quotes escaped with a
backslash. Can be set at runtime, and defaults to off in PHP. See also
set_magic_quotes_runtime()
&lt;<A HREF="http://in2.php.net/manual/en/function.set-magic-quotes-runtime.php">http://in2.php.net/manual/en/function.set-magic-quotes-runtime.php</A>&gt;  and
get_magic_quotes_runtime()
&lt;<A HREF="http://in2.php.net/manual/en/function.get-magic-quotes-runtime.php">http://in2.php.net/manual/en/function.get-magic-quotes-runtime.php</A>&gt; . 
*	magic_quotes_sybase
&lt;<A HREF="http://in2.php.net/manual/en/sybase.configuration.php#ini.magic-quotes-syba">http://in2.php.net/manual/en/sybase.configuration.php#ini.magic-quotes-syba</A>
se&gt;  If enabled, a single-quote is escaped with a single-quote instead of a
backslash. If on, it completely overrides magic_quotes_gpc
&lt;<A HREF="http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc">http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc</A>&gt; .
Having both directives enabled means only single quotes are escaped as ''.
Double quotes, backslashes and NULL's will remain untouched and unescaped.
See also ini_get() &lt;<A HREF="http://in2.php.net/manual/en/function.ini-get.php">http://in2.php.net/manual/en/function.ini-get.php</A>&gt;  for
retrieving its value. 

 

Source: <A HREF="http://in2.php.net/magic_quotes">http://in2.php.net/magic_quotes</A> 

 

 

magic_quotes_gpc

Sets the magic_quotes state for GPC (Get/Post/Cookie) operations. When
magic_quotes are on, all ' (single-quote), &quot; (double quote), \ (backslash)
and NUL's are escaped with a backslash automatically.

 

Source:
&lt;<A HREF="http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc">http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc</A>&gt;
<A HREF="http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc">http://in2.php.net/manual/en/info.configuration.php#ini.magic-quotes-gpc</A> 

 

Refer to the author's original post @  &lt;<A HREF="http://milw0rm.com/exploits/6641">http://milw0rm.com/exploits/6641</A>&gt;
<A HREF="http://milw0rm.com/exploits/6641">http://milw0rm.com/exploits/6641</A> 

 

Snip &lt; *Requirements: magic_quotes_gpc = Off &gt;

 

-Dhruv

 

  _____  

From: vaibhav aher [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">vaibhavaher at gmail.com</A>] 
Sent: Monday, October 20, 2008 10:38 AM
To: vinod sharma
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Subject: Re: [Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)
LocalFile Inclusion Vulnerability POC posted on milworm

 

Hello friends,

If magic magic_quotes_gpc is on it will only restrict ' (single quote), i
mean it will stop ' (single quote ) by \ (back slash) or by one more single
quote.



 

On Fri, Oct 17, 2008 at 2:57 PM, vinod sharma
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">vinodsharma_neo10 at yahoo.co.in</A>&gt; wrote:

Hi Dhruv,

magic_quotes_gpc is off in php.ini and i am using php 5.0.4 on fedora core
4.

i have also tried this on php with xampp, still observing the same error.

 Thanks &amp; Regards,
Vinod Sharma
ipolicynetworks
(Security Research Group)



----- Original Message ----
From: &quot;Soi, Dhruv&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>&gt;
To: vinod sharma &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">vinodsharma_neo10 at yahoo.co.in</A>&gt;;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Sent: Friday, 17 October, 2008 2:35:07 PM
Subject: RE: [Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)
LocalFile Inclusion Vulnerability POC posted on milworm

Did you check magic_quotes_gpc in /etc/php.ini? It defaults to &quot;on&quot; whereas,
it needs to be &quot;off&quot;. I hope you aren't using php 6.0.0. &lt;<A HREF="http://6.0.0./">http://6.0.0./</A>&gt; 

-Dhruv


-----Original Message-----
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On Behalf Of vinod sharma
Sent: Friday, October 17, 2008 10:44 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Subject: [Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)
LocalFile Inclusion Vulnerability POC posted on milworm

Greetings All,


I am trying to reproduce the issue, but php is reporting some error:
like: fail to open lang/../../../../../../../../../../etc/passwd%00;
path=//lang.php.

vulnerable code is:

include(&quot;lang/&quot;.$_SESSION['language'].&quot;/lang.php&quot;);

exploit is: ../../../../../../../../../../etc/passwd%00; path=/ as the value
of vulnerable paramter.

exploit link is:<A HREF="http://milw0rm.com/exploits/6641">http://milw0rm.com/exploits/6641</A>

After
observing this error i thought there must some issue with the
vulnerable application, so created a vulnerable php program whose details
are:


&lt;?php

include(&quot;lang/&quot;.$_GET[filename].&quot;/lang.php&quot;);

?&gt;


Then i send a GET a request:

GET /vulnerable
php?filename=lang/../../../../../../../../../../etc/passwd%00; path=/

still, i am observing same error.

This
is happening because inside include function, there is an additon of
/lang.php after the vulnerable parameter value in both case.

I am not able to understand how the author manage to view the contents of
/etc/passwd by this method.

please help me out.

Thanks in advance.



Thanks &amp; Regards,
Vinod Sharma
ipolicynetworks
(Security Research Group)



     Be the first one to try the new Messenger 9 Beta! Go to
<A HREF="http://in.messenger.yahoo.com/win/">http://in.messenger.yahoo.com/win/</A>
_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>


     Cricket on your mind? Visit the ultimate cricket website. Enter
<A HREF="http://beta.cricket.yahoo.com">http://beta.cricket.yahoo.com</A> &lt;<A HREF="http://beta.cricket.yahoo.com/">http://beta.cricket.yahoo.com/</A>&gt; 
_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>




-- 



-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20081020/b83b89aa/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20081020/b83b89aa/attachment-0001.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000133.html">[Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)	LocalFile Inclusion Vulnerability POC posted on milworm
</A></li>
	<LI>Next message: <A HREF="000137.html">[Owasp-delhi] doubt on MySQL Quick Admin &lt;= 1.5.5 (COOKIE)	LocalFile Inclusion Vulnerability POC posted on milworm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#136">[ date ]</a>
              <a href="thread.html#136">[ thread ]</a>
              <a href="subject.html#136">[ subject ]</a>
              <a href="author.html#136">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
