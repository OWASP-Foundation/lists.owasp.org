<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Thanks...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Thanks...&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000296.html">
   <LINK REL="Next"  HREF="000281.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Thanks...</H1>
    <B>Gunwant Singh</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Thanks...&In-Reply-To="
       TITLE="[Owasp-delhi] Thanks...">gunwant.s at gmail.com
       </A><BR>
    <I>Fri Jan 16 13:08:31 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000296.html">[Owasp-delhi] SSL Broken..
</A></li>
        <LI>Next message: <A HREF="000281.html">[Owasp-delhi] SSL Broken..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#280">[ date ]</a>
              <a href="thread.html#280">[ thread ]</a>
              <a href="subject.html#280">[ subject ]</a>
              <a href="author.html#280">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Pranav,

Thank you very much for the wealth of information :)

Regards.

On Fri, Jan 16, 2009 at 5:29 PM, Pranav Joshi &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>&gt; wrote:
Hey Gunwant,

Apologies for the delay..

I had to sift through a lot of GHTQ material to gather em.

MD5Coll - <A HREF="http://www.stachliu.com/md5coll.c">http://www.stachliu.com/md5coll.c</A>
StripWire - <A HREF="http://www.doxpara.com/stripwire-1.1.tar.gz">http://www.doxpara.com/stripwire-1.1.tar.gz</A>
ConFoo.pl &lt;<A HREF="http://www.doxpara.com/stripwire-1.1.tar.gzConFoo.pl">http://www.doxpara.com/stripwire-1.1.tar.gzConFoo.pl</A>&gt; -
<A HREF="http://www.doxpara.com/research/md5/confoo.pl">http://www.doxpara.com/research/md5/confoo.pl</A>
MD5 Deep - <A HREF="http://md5deep.sourceforge.net/">http://md5deep.sourceforge.net/</A>


All,

Since I see many people here on the mailing list who seem deeply
interested in the topic I'm sharing some notes I've compiled.

------------------------------
&gt;<i>
</I>&gt;<i> -------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> Around August of 2004 certain Researchers in China Published Research
</I>&gt;<i> documents that they could hash collisions within MD5.. This was not very
</I>&gt;<i> meaningful threat as they concentrated on creating two random blobs of
</I>&gt;<i> data with colliding hashes. The researchers did not publish the details of
</I>&gt;<i> their algorithm instead they published 'X' and 'Y' samples with colliding
</I>&gt;<i> MD5 hashes for proving their theory.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://eprint.iacr.org/2004/199.pdf">http://eprint.iacr.org/2004/199.pdf</A>
</I>&gt;<i>
</I>&gt;<i> In 2005 Dan Kaminsky created a tool called 'stripwire'which could create
</I>&gt;<i> certain perl scripts with colliding hashes,
</I>&gt;<i>
</I>&gt;<i> In early 2006 some guys figured out that they could do the same to
</I>&gt;<i> PostScript documents.
</I>&gt;<i>
</I>&gt;<i> Some time later, Dan Kaminsky came back with 'ConFoo' showing that he
</I>&gt;<i> could do it with web pages.
</I>&gt;<i>
</I>&gt;<i> 'MD5coll' is a tool you can use to create your very own 'X' and 'Y' with
</I>&gt;<i> colliding hashes.
</I>&gt;<i>
</I>&gt;<i> Researchers have known for a very long time that if 'X' is not equal to
</I>&gt;<i> 'Y' but share a hash collision then you can append 'Q' to both 'X' and 'Y'
</I>&gt;<i> and the hash collision will be preserved provided X and Y are increments
</I>&gt;<i> of 64 bytes in length.
</I>&gt;<i>
</I>&gt;<i> If one uses this information very cleverly some very interesting things
</I>&gt;<i> can be made possible. Suppose we have evil code 'P' which opens up a
</I>&gt;<i> backdoor, here we take 'X' which has a collission with 'Y', We take SHA-1
</I>&gt;<i> of 'X' (this is not an attack against SHA-1 (we're using it simply to
</I>&gt;<i> shrink it down to be able to use it as a key) to use it as an AES key to
</I>&gt;<i> encrypt 'P' the evil code thus getting 'Q' (Which is the encrypted evil
</I>&gt;<i> code 'P', encrypted using a key derived from 'X' which happens to have a
</I>&gt;<i> hash collision with 'Y').
</I>&gt;<i>
</I>&gt;<i> Now we take the encrypted evil code 'Q' and append it to 'X and 'Y'...
</I>&gt;<i>
</I>&gt;<i> Dan Kaminsky calls the derived 'X'+'Q' and 'Y'+'Q' as 'Fire' and 'Ice'.
</I>&gt;<i> Ice is completely innocuous blob of bits followed by something which is
</I>&gt;<i> encrypted, which really cant fo anything.
</I>&gt;<i> Fire, however is evil..
</I>&gt;<i>
</I>&gt;<i> To make fire work you need to do the following
</I>&gt;<i>
</I>&gt;<i> 1. Slice off the initial 'X' from 'X'+'Q'
</I>&gt;<i> 2. Generate SHA-1 of 'X'.
</I>&gt;<i> 3. Use the derived SHA-1 as the AES key to decrypt 'Q' and get 'P'
</I>&gt;<i> 4. Execute 'P'.
</I>&gt;<i>
</I>&gt;<i> This functionality is incorporated into StripWire and is called as 'Evil
</I>&gt;<i> Execution Harness'..
</I>&gt;<i> Problem: Fire has the potential to do something evil but Fire can't do
</I>&gt;<i> much without Ice as it is dependent on 'X'..
</I>&gt;<i>
</I>&gt;<i> Research suggests that MD5 collisions can be preserved by pre-pending evil
</I>&gt;<i> data:
</I>&gt;<i> <A HREF="http://www.doxpara.com/research/md5/232-md5-considered-harmful-slides.pdf">http://www.doxpara.com/research/md5/232-md5-considered-harmful-slides.pdf</A>
</I>&gt;<i>
</I>&gt;<i> If I could do pre-pending, then I could put the 'Evil execution Harness'
</I>&gt;<i> upfront which upon execution would start cryptographic function and
</I>&gt;<i> depending upon the result of the cryptographic function would start
</I>&gt;<i> branching execution either launching benign code or malicious one.
</I>&gt;<i>
</I>&gt;<i> ConFoo can demonstrate this very nicely, it works by taking two separate
</I>&gt;<i> web pages, convolving them together, adding the appropriate 'X' and 'Y',
</I>&gt;<i> adding a javascript to implement the 'execution harness' and creating
</I>&gt;<i> pages t1 and t2 with MD5 collisions.
</I>&gt;<i>
</I>&gt;<i> Bye,
</I>&gt;<i> Pranav
</I>&gt;<i>
</I>&gt;<i> &gt; Pranav,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks for the information. Would you mind sharing the name of the tools
</I>&gt;<i> &gt; for
</I>&gt;<i> &gt; MD5 cracking? I'll be thankful.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; All,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I was curious about a question on Sessions which I wanted to ask you all
</I>&gt;<i> &gt; since some time back but did not get any chance due to some reasons. I
</I>&gt;<i> &gt; have
</I>&gt;<i> &gt; asked this question on some forums as well, so excuse me if you have
</I>&gt;<i> &gt; already
</I>&gt;<i> &gt; heard of this.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; As we all know salted MD5 hashing protects the authentication credentials
</I>&gt;<i> &gt; rightly from eavesdropping on the network. SSL does the same thing.
</I>&gt;<i> &gt; However,
</I>&gt;<i> &gt; in some scenarios SSL might not be feasible. For example, causing heavy
</I>&gt;<i> &gt; load
</I>&gt;<i> &gt; on the server or may be some applications don't support it, etc.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Apparently we need to protect 2 crucial things in the HTTP header from
</I>&gt;<i> the
</I>&gt;<i> &gt; person sniffing the network traffic. &quot;Authentication Credentials and
</I>&gt;<i> &gt; Session
</I>&gt;<i> &gt; Credentials&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; We can protect the authentication credentials using salted MD5 hashing or
</I>&gt;<i> &gt; by
</I>&gt;<i> &gt; using SSL. In case SSL implementation is not feasible, salted MD5 will
</I>&gt;<i> &gt; still
</I>&gt;<i> &gt; protect the authentication credentials but not the Session Credentials.
</I>&gt;<i> In
</I>&gt;<i> &gt; order to protect the Session credentials (Session ID, tokens, cookies,
</I>&gt;<i> &gt; etc)
</I>&gt;<i> &gt; on a non-SSL channel what measures can be taken?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thoughts?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -Gunwant
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Fri, Jan 9, 2009 at 1:34 PM, Pranav Joshi &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>&gt;
</I>&gt;<i> &gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;&gt; Hi Gunwant,
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; Fyi, even SHA-1 is susceptible to collision attacks. Practically even
</I>&gt;<i> &gt;&gt; if
</I>&gt;<i> &gt;&gt; MD5
</I>&gt;<i> &gt;&gt; &gt; or SHA-1 are broken, this vulnerability still can't be readily used to
</I>&gt;<i> &gt;&gt; exploit the certificate genuinity uptil 'Now'
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Absolutely, I completely agree with your point that SHA-1 is susceptible
</I>&gt;<i> &gt;&gt; to collisions.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; The only difference between them is that colliding SHA-1 still a
</I>&gt;<i> &gt;&gt; mathematical probability of 2^63 computational cycles, So far nobody has
</I>&gt;<i> &gt;&gt; been able show a working collision for SHA-1.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; IMHO I am sure this will be exploited with a solid rationale in the
</I>&gt;<i> &gt;&gt; near
</I>&gt;<i> &gt;&gt; future.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Absolutely.. It's just a matter of biding time till someone figures out
</I>&gt;<i> &gt;&gt; a
</I>&gt;<i> &gt;&gt; way, IMHO, PS3's (Cell Based Systems) &amp; GPUs are doing a remarkably
</I>&gt;<i> &gt;&gt; praiseworthy job of shrinking the computational time-line.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Having said that, the point I wanted to make regarding MD5 specifically
</I>&gt;<i> &gt;&gt; was that POCs and tools for attacking MD5 have been available for close
</I>&gt;<i> &gt;&gt; to
</I>&gt;<i> &gt;&gt; 3 years and these attacks have been a part of GHTQ curriculum. but
</I>&gt;<i> &gt;&gt; nothing
</I>&gt;<i> &gt;&gt; was serious as this for MD5 uptil 'Now'... the metaphorical &quot;final nail
</I>&gt;<i> &gt;&gt; in
</I>&gt;<i> &gt;&gt; the coffin&quot;.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; The best bet as of now is to rely on multiple hashing algorithms for
</I>&gt;<i> &gt;&gt; critical systems; so even if one collision is generated other hashes
</I>&gt;<i> &gt;&gt; would
</I>&gt;<i> &gt;&gt; fail to match.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; NOTE: I can't recollect the names of those tools mentioned here but if
</I>&gt;<i> &gt;&gt; someone is interested in knowing them lemme know, I'd be glad to
</I>&gt;<i> &gt;&gt; re-lookup
</I>&gt;<i> &gt;&gt; the same.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Warm Regards,
</I>&gt;<i> &gt;&gt; Pranav Joshi
</I>&gt;<i> &gt;&gt; Consultant - Information Security [CISA/GHTQ/GWAS/Security+]
</I>&gt;<i> &gt;&gt; Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>
</I>&gt;<i> &gt;&gt; Phone: +91-9958967766
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt; Hi,
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Thanks for sharing the information. Just wanted to add some more to
</I>&gt;<i> &gt;&gt; this.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; As you said:
</I>&gt;<i> &gt;&gt; &gt; &quot;Since, MD5 is also used in signing certificates the browsers will
</I>&gt;<i> &gt;&gt; have
</I>&gt;<i> &gt;&gt; no
</I>&gt;<i> &gt;&gt; &gt; way of telling the difference between a genuine and a rogue website
</I>&gt;<i> &gt;&gt; unless
</I>&gt;<i> &gt;&gt; &gt; other hashing algorithms like SHA-1 are also used.&quot;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Fyi, even SHA-1 is susceptible to collision attacks. Practically even
</I>&gt;<i> &gt;&gt; if
</I>&gt;<i> &gt;&gt; MD5
</I>&gt;<i> &gt;&gt; &gt; or SHA-1 are broken, this vulnerability still can't be readily used to
</I>&gt;<i> &gt;&gt; exploit the certificate genuinity uptil 'Now'. Having said that I did
</I>&gt;<i> &gt;&gt; not
</I>&gt;<i> &gt;&gt; &gt; mean that it can't be exploited at all thereby further exposing
</I>&gt;<i> &gt;&gt; insecurity
</I>&gt;<i> &gt;&gt; &gt; on the internet. What I am saying is until some more research is done
</I>&gt;<i> &gt;&gt; on
</I>&gt;<i> &gt;&gt; how
</I>&gt;<i> &gt;&gt; &gt; to exploit this in relevance to the certificates, we can unwind and
</I>&gt;<i> &gt;&gt; count
</I>&gt;<i> &gt;&gt; &gt; on
</I>&gt;<i> &gt;&gt; &gt; atleast the certificates for now.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Some guys have come up with a PoC for the same, however not at a very
</I>&gt;<i> &gt;&gt; reasonable level.
</I>&gt;<i> &gt;&gt; &gt; May be you want to have a look at these:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; <A HREF="http://www.cryptography.com/cnews/hash.html&lt;">http://www.cryptography.com/cnews/hash.html&lt;</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> <A HREF="https://houmail.halliburton.com/OWA/redir.aspx?C=52ed613179914f85a1b0ae5a68761f71&amp;URL=http%3a%2f%2fwww.cryptography.com%2fcnews%2fhash.html">https://houmail.halliburton.com/OWA/redir.aspx?C=52ed613179914f85a1b0ae5a68761f71&amp;URL=http%3a%2f%2fwww.cryptography.com%2fcnews%2fhash.html</A>
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; <A HREF="http://www.securityfocus.com/columnists/488">http://www.securityfocus.com/columnists/488</A>
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; IMHO I am sure this will be exploited with a solid rationale in the
</I>&gt;<i> &gt;&gt; near
</I>&gt;<i> &gt;&gt; future.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; Thanks,
</I>&gt;<i> &gt;&gt; &gt; -Gunwant Singh
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; On Fri, Jan 2, 2009 at 1:46 PM, Pranav Joshi &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>&gt;
</I>&gt;<i> &gt;&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Hello Everyone.
</I>&gt;<i> &gt;&gt; &gt;&gt; It's been quite a while since security issues with MD5 algorithm
</I>&gt;<i> &gt;&gt; started
</I>&gt;<i> &gt;&gt; &gt;&gt; cropping up regarding reproducible hash collisions (a.k.a Birthday
</I>&gt;<i> &gt;&gt; Attack), this one ups the ante by driving the final nail in it's
</I>&gt;<i> &gt;&gt; coffin.
</I>&gt;<i> &gt;&gt; &gt;&gt; Since, MD5 is also used in signing certificates the browsers will
</I>&gt;<i> &gt;&gt; have
</I>&gt;<i> &gt;&gt; no
</I>&gt;<i> &gt;&gt; &gt;&gt; way of telling the difference between a genuine and a rogue website
</I>&gt;<i> &gt;&gt; unless
</I>&gt;<i> &gt;&gt; &gt;&gt; other hashing algorithms like SHA-1 are also used.
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="http://blogs.computerworld.com/md5_ca_hack_and_the_ps3">http://blogs.computerworld.com/md5_ca_hack_and_the_ps3</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; Warm Regards,
</I>&gt;<i> &gt;&gt; &gt;&gt; Pranav Joshi
</I>&gt;<i> &gt;&gt; &gt;&gt; Consultant - Information Security [CISA/GHTQ/GWAS/Security+]
</I>&gt;<i> &gt;&gt; &gt;&gt; Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; Phone: +91-9958967766
</I>&gt;<i> &gt;&gt; &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; Owasp-delhi mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt; --
</I>&gt;<i> &gt;&gt; &gt; Gunwant Singh
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; --
</I>&gt;<i> &gt; Gunwant Singh
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090116/81899248/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090116/81899248/attachment-0001.html</A> 
</PRE>











<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000296.html">[Owasp-delhi] SSL Broken..
</A></li>
	<LI>Next message: <A HREF="000281.html">[Owasp-delhi] SSL Broken..
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#280">[ date ]</a>
              <a href="thread.html#280">[ thread ]</a>
              <a href="subject.html#280">[ subject ]</a>
              <a href="author.html#280">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
