<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] SSL Broken..
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20SSL%20Broken..&In-Reply-To=44b2bd060901120841q4426daeo607e7f7839dc5bb5%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000267.html">
   <LINK REL="Next"  HREF="000261.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] SSL Broken..</H1>
    <B>Pranav Joshi</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20SSL%20Broken..&In-Reply-To=44b2bd060901120841q4426daeo607e7f7839dc5bb5%40mail.gmail.com"
       TITLE="[Owasp-delhi] SSL Broken..">pranav.joshi at kriss.in
       </A><BR>
    <I>Fri Jan 16 06:59:58 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000267.html">[Owasp-delhi] SSL Broken..
</A></li>
        <LI>Next message: <A HREF="000261.html">[Owasp-delhi] January Meeting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#277">[ date ]</a>
              <a href="thread.html#277">[ thread ]</a>
              <a href="subject.html#277">[ subject ]</a>
              <a href="author.html#277">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Gunwant,

Apologies for the delay..

I had to sift through a lot of GHTQ material to gather em.

MD5Coll - <A HREF="http://www.stachliu.com/md5coll.c">http://www.stachliu.com/md5coll.c</A>
StripWire - <A HREF="http://www.doxpara.com/stripwire-1.1.tar.gz">http://www.doxpara.com/stripwire-1.1.tar.gz</A>
ConFoo.pl - <A HREF="http://www.doxpara.com/research/md5/confoo.pl">http://www.doxpara.com/research/md5/confoo.pl</A>
MD5 Deep - <A HREF="http://md5deep.sourceforge.net/">http://md5deep.sourceforge.net/</A>


All,

Since I see many people here on the mailing list who seem deeply
interested in the topic I'm sharing some notes I've compiled.

-------------------------------------------------------------------------------------------

Around August of 2004 certain Researchers in China Published Research
documents that they could hash collisions within MD5.. This was not very
meaningful threat as they concentrated on creating two random blobs of
data with colliding hashes. The researchers did not publish the details of
their algorithm instead they published 'X' and 'Y' samples with colliding
MD5 hashes for proving their theory.

<A HREF="http://eprint.iacr.org/2004/199.pdf">http://eprint.iacr.org/2004/199.pdf</A>

In 2005 Dan Kaminsky created a tool called 'stripwire'which could create
certain perl scripts with colliding hashes,

In early 2006 some guys figured out that they could do the same to
PostScript documents.

Some time later, Dan Kaminsky came back with 'ConFoo' showing that he
could do it with web pages.

'MD5coll' is a tool you can use to create your very own 'X' and 'Y' with
colliding hashes.

Researchers have known for a very long time that if 'X' is not equal to
'Y' but share a hash collision then you can append 'Q' to both 'X' and 'Y'
and the hash collision will be preserved provided X and Y are increments
of 64 bytes in length.

If one uses this information very cleverly some very interesting things
can be made possible. Suppose we have evil code 'P' which opens up a
backdoor, here we take 'X' which has a collission with 'Y', We take SHA-1
of 'X' (this is not an attack against SHA-1 (we're using it simply to
shrink it down to be able to use it as a key) to use it as an AES key to
encrypt 'P' the evil code thus getting 'Q' (Which is the encrypted evil
code 'P', encrypted using a key derived from 'X' which happens to have a
hash collision with 'Y').

Now we take the encrypted evil code 'Q' and append it to 'X and 'Y'...

Dan Kaminsky calls the derived 'X'+'Q' and 'Y'+'Q' as 'Fire' and 'Ice'.
Ice is completely innocuous blob of bits followed by something which is
encrypted, which really cant fo anything.
Fire, however is evil..

To make fire work you need to do the following

1. Slice off the initial 'X' from 'X'+'Q'
2. Generate SHA-1 of 'X'.
3. Use the derived SHA-1 as the AES key to decrypt 'Q' and get 'P'
4. Execute 'P'.

This functionality is incorporated into StripWire and is called as 'Evil
Execution Harness'..
Problem: Fire has the potential to do something evil but Fire can't do
much without Ice as it is dependent on 'X'..

Research suggests that MD5 collisions can be preserved by pre-pending evil
data:
<A HREF="http://www.doxpara.com/research/md5/232-md5-considered-harmful-slides.pdf">http://www.doxpara.com/research/md5/232-md5-considered-harmful-slides.pdf</A>

If I could do pre-pending, then I could put the 'Evil execution Harness'
upfront which upon execution would start cryptographic function and
depending upon the result of the cryptographic function would start
branching execution either launching benign code or malicious one.

ConFoo can demonstrate this very nicely, it works by taking two separate
web pages, convolving them together, adding the appropriate 'X' and 'Y',
adding a javascript to implement the 'execution harness' and creating
pages t1 and t2 with MD5 collisions.

Bye,
Pranav

&gt;<i> Pranav,
</I>&gt;<i>
</I>&gt;<i> Thanks for the information. Would you mind sharing the name of the tools
</I>&gt;<i> for
</I>&gt;<i> MD5 cracking? I'll be thankful.
</I>&gt;<i>
</I>&gt;<i> All,
</I>&gt;<i>
</I>&gt;<i> I was curious about a question on Sessions which I wanted to ask you all
</I>&gt;<i> since some time back but did not get any chance due to some reasons. I
</I>&gt;<i> have
</I>&gt;<i> asked this question on some forums as well, so excuse me if you have
</I>&gt;<i> already
</I>&gt;<i> heard of this.
</I>&gt;<i>
</I>&gt;<i> As we all know salted MD5 hashing protects the authentication credentials
</I>&gt;<i> rightly from eavesdropping on the network. SSL does the same thing.
</I>&gt;<i> However,
</I>&gt;<i> in some scenarios SSL might not be feasible. For example, causing heavy
</I>&gt;<i> load
</I>&gt;<i> on the server or may be some applications don't support it, etc.
</I>&gt;<i>
</I>&gt;<i> Apparently we need to protect 2 crucial things in the HTTP header from the
</I>&gt;<i> person sniffing the network traffic. &quot;Authentication Credentials and
</I>&gt;<i> Session
</I>&gt;<i> Credentials&quot;
</I>&gt;<i>
</I>&gt;<i> We can protect the authentication credentials using salted MD5 hashing or
</I>&gt;<i> by
</I>&gt;<i> using SSL. In case SSL implementation is not feasible, salted MD5 will
</I>&gt;<i> still
</I>&gt;<i> protect the authentication credentials but not the Session Credentials. In
</I>&gt;<i> order to protect the Session credentials (Session ID, tokens, cookies,
</I>&gt;<i> etc)
</I>&gt;<i> on a non-SSL channel what measures can be taken?
</I>&gt;<i>
</I>&gt;<i> Thoughts?
</I>&gt;<i>
</I>&gt;<i> -Gunwant
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, Jan 9, 2009 at 1:34 PM, Pranav Joshi &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Gunwant,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Fyi, even SHA-1 is susceptible to collision attacks. Practically even
</I>&gt;&gt;<i> if
</I>&gt;&gt;<i> MD5
</I>&gt;&gt;<i> &gt; or SHA-1 are broken, this vulnerability still can't be readily used to
</I>&gt;&gt;<i> exploit the certificate genuinity uptil 'Now'
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Absolutely, I completely agree with your point that SHA-1 is susceptible
</I>&gt;&gt;<i> to collisions.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The only difference between them is that colliding SHA-1 still a
</I>&gt;&gt;<i> mathematical probability of 2^63 computational cycles, So far nobody has
</I>&gt;&gt;<i> been able show a working collision for SHA-1.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; IMHO I am sure this will be exploited with a solid rationale in the
</I>&gt;&gt;<i> near
</I>&gt;&gt;<i> future.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Absolutely.. It's just a matter of biding time till someone figures out
</I>&gt;&gt;<i> a
</I>&gt;&gt;<i> way, IMHO, PS3's (Cell Based Systems) &amp; GPUs are doing a remarkably
</I>&gt;&gt;<i> praiseworthy job of shrinking the computational time-line.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Having said that, the point I wanted to make regarding MD5 specifically
</I>&gt;&gt;<i> was that POCs and tools for attacking MD5 have been available for close
</I>&gt;&gt;<i> to
</I>&gt;&gt;<i> 3 years and these attacks have been a part of GHTQ curriculum. but
</I>&gt;&gt;<i> nothing
</I>&gt;&gt;<i> was serious as this for MD5 uptil 'Now'... the metaphorical &quot;final nail
</I>&gt;&gt;<i> in
</I>&gt;&gt;<i> the coffin&quot;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The best bet as of now is to rely on multiple hashing algorithms for
</I>&gt;&gt;<i> critical systems; so even if one collision is generated other hashes
</I>&gt;&gt;<i> would
</I>&gt;&gt;<i> fail to match.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> NOTE: I can't recollect the names of those tools mentioned here but if
</I>&gt;&gt;<i> someone is interested in knowing them lemme know, I'd be glad to
</I>&gt;&gt;<i> re-lookup
</I>&gt;&gt;<i> the same.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Warm Regards,
</I>&gt;&gt;<i> Pranav Joshi
</I>&gt;&gt;<i> Consultant - Information Security [CISA/GHTQ/GWAS/Security+]
</I>&gt;&gt;<i> Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>
</I>&gt;&gt;<i> Phone: +91-9958967766
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Hi,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks for sharing the information. Just wanted to add some more to
</I>&gt;&gt;<i> this.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; As you said:
</I>&gt;&gt;<i> &gt; &quot;Since, MD5 is also used in signing certificates the browsers will
</I>&gt;&gt;<i> have
</I>&gt;&gt;<i> no
</I>&gt;&gt;<i> &gt; way of telling the difference between a genuine and a rogue website
</I>&gt;&gt;<i> unless
</I>&gt;&gt;<i> &gt; other hashing algorithms like SHA-1 are also used.&quot;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Fyi, even SHA-1 is susceptible to collision attacks. Practically even
</I>&gt;&gt;<i> if
</I>&gt;&gt;<i> MD5
</I>&gt;&gt;<i> &gt; or SHA-1 are broken, this vulnerability still can't be readily used to
</I>&gt;&gt;<i> exploit the certificate genuinity uptil 'Now'. Having said that I did
</I>&gt;&gt;<i> not
</I>&gt;&gt;<i> &gt; mean that it can't be exploited at all thereby further exposing
</I>&gt;&gt;<i> insecurity
</I>&gt;&gt;<i> &gt; on the internet. What I am saying is until some more research is done
</I>&gt;&gt;<i> on
</I>&gt;&gt;<i> how
</I>&gt;&gt;<i> &gt; to exploit this in relevance to the certificates, we can unwind and
</I>&gt;&gt;<i> count
</I>&gt;&gt;<i> &gt; on
</I>&gt;&gt;<i> &gt; atleast the certificates for now.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Some guys have come up with a PoC for the same, however not at a very
</I>&gt;&gt;<i> reasonable level.
</I>&gt;&gt;<i> &gt; May be you want to have a look at these:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; <A HREF="http://www.cryptography.com/cnews/hash.html&lt;">http://www.cryptography.com/cnews/hash.html&lt;</A>
</I>&gt;&gt;<i> <A HREF="https://houmail.halliburton.com/OWA/redir.aspx?C=52ed613179914f85a1b0ae5a68761f71&amp;URL=http%3a%2f%2fwww.cryptography.com%2fcnews%2fhash.html">https://houmail.halliburton.com/OWA/redir.aspx?C=52ed613179914f85a1b0ae5a68761f71&amp;URL=http%3a%2f%2fwww.cryptography.com%2fcnews%2fhash.html</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> <A HREF="http://www.securityfocus.com/columnists/488">http://www.securityfocus.com/columnists/488</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; IMHO I am sure this will be exploited with a solid rationale in the
</I>&gt;&gt;<i> near
</I>&gt;&gt;<i> future.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks,
</I>&gt;&gt;<i> &gt; -Gunwant Singh
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; On Fri, Jan 2, 2009 at 1:46 PM, Pranav Joshi &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;&gt; Hello Everyone.
</I>&gt;&gt;<i> &gt;&gt; It's been quite a while since security issues with MD5 algorithm
</I>&gt;&gt;<i> started
</I>&gt;&gt;<i> &gt;&gt; cropping up regarding reproducible hash collisions (a.k.a Birthday
</I>&gt;&gt;<i> Attack), this one ups the ante by driving the final nail in it's
</I>&gt;&gt;<i> coffin.
</I>&gt;&gt;<i> &gt;&gt; Since, MD5 is also used in signing certificates the browsers will
</I>&gt;&gt;<i> have
</I>&gt;&gt;<i> no
</I>&gt;&gt;<i> &gt;&gt; way of telling the difference between a genuine and a rogue website
</I>&gt;&gt;<i> unless
</I>&gt;&gt;<i> &gt;&gt; other hashing algorithms like SHA-1 are also used.
</I>&gt;&gt;<i> &gt;&gt; <A HREF="http://blogs.computerworld.com/md5_ca_hack_and_the_ps3">http://blogs.computerworld.com/md5_ca_hack_and_the_ps3</A>
</I>&gt;&gt;<i> &gt;&gt; Warm Regards,
</I>&gt;&gt;<i> &gt;&gt; Pranav Joshi
</I>&gt;&gt;<i> &gt;&gt; Consultant - Information Security [CISA/GHTQ/GWAS/Security+]
</I>&gt;&gt;<i> &gt;&gt; Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">pranav.joshi at kriss.in</A>
</I>&gt;&gt;<i> &gt;&gt; Phone: +91-9958967766
</I>&gt;&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;&gt;<i> &gt;&gt; Owasp-delhi mailing list
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;&gt;<i> &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; --
</I>&gt;&gt;<i> &gt; Gunwant Singh
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Gunwant Singh
</I>&gt;<i>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000267.html">[Owasp-delhi] SSL Broken..
</A></li>
	<LI>Next message: <A HREF="000261.html">[Owasp-delhi] January Meeting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#277">[ date ]</a>
              <a href="thread.html#277">[ thread ]</a>
              <a href="subject.html#277">[ subject ]</a>
              <a href="author.html#277">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
