<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Session Fixation counter: Asp.Net
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Session%20Fixation%20counter%3A%20Asp.Net&In-Reply-To=CAGEo0Njn7GJVxWe0U_qvymLG%3DyGLfJDvHsjz58naYW88_4cCMQ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001661.html">
   <LINK REL="Next"  HREF="001659.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Session Fixation counter: Asp.Net</H1>
    <B>Soi, Dhruv</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Session%20Fixation%20counter%3A%20Asp.Net&In-Reply-To=CAGEo0Njn7GJVxWe0U_qvymLG%3DyGLfJDvHsjz58naYW88_4cCMQ%40mail.gmail.com"
       TITLE="[Owasp-delhi] Session Fixation counter: Asp.Net">dhruv.soi at torridnetworks.com
       </A><BR>
    <I>Sun Dec  4 00:10:18 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001661.html">[Owasp-delhi] Configuring SSL on Tomcat 6
</A></li>
        <LI>Next message: <A HREF="001659.html">[Owasp-delhi] Returned mail: Data format error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1652">[ date ]</a>
              <a href="thread.html#1652">[ thread ]</a>
              <a href="subject.html#1652">[ subject ]</a>
              <a href="author.html#1652">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>And the funny part is, the solution contains the same code which i mentioned with comments &quot;destroy the session&quot;.

Many Thanks,
Dhruv

Sent from my iPad

On Dec 3, 2011, at 10:27 PM, Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">mr.p.upadhyay at gmail.com</A>&gt; wrote:

&gt;<i> Your link contains the same solution which Dhruv had suggested - abandoning the current cookie and adding a new cookie in the response. 
</I>&gt;<i> 
</I>&gt;<i> And this won't redirect to a login page, as code itself will delete the cookie, generate a new cookie and allow the user to log into the application by redirecting/forwarding to the page which should come after login. 
</I>&gt;<i> 
</I>&gt;<i> You can create a POC and demo them the same. 
</I>&gt;<i> 
</I>&gt;<i> On Sat, Dec 3, 2011 at 9:37 PM, Vaibhav Gupta &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">vaibhav12jan at gmail.com</A>&gt; wrote:
</I>&gt;<i> Hi All,
</I>&gt;<i> 
</I>&gt;<i> Thanks for your suggestion and sorry for the late reply! :)
</I>&gt;<i> 
</I>&gt;<i> @Dhruv
</I>&gt;<i> What do you mean by destroying the cookie? Is it like adding a custom cookie and not the default ASP.NET_SesssionId?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> @Deepayan
</I>&gt;<i> I have forwarded your link to C# fix of the attack. Will update if that works.
</I>&gt;<i> 
</I>&gt;<i> @Pankaj
</I>&gt;<i> I also suggested similar solution to the developers but as per them if we'll invalidate the session and regenerate another one, the user will be redirected to login page. I tried convincing them that you need to do this at the time of login but they were quite rigid with their concept and thus did not work out with this solution.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> One solution I suggested them was: <A HREF="http://palisade.plynt.com/issues/2010Apr/secure-coding-aspdotnet-p2/">http://palisade.plynt.com/issues/2010Apr/secure-coding-aspdotnet-p2/</A>
</I>&gt;<i> 
</I>&gt;<i> Comments please!
</I>&gt;<i> 
</I>&gt;<i> Thanks
</I>&gt;<i> Vaibhav Gupta
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> LinkedIn: <A HREF="http://www.linkedin.com/in/vaibhav0">http://www.linkedin.com/in/vaibhav0</A>
</I>&gt;<i> 
</I>&gt;<i> On Fri, Nov 25, 2011 at 10:10 PM, Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">mr.p.upadhyay at gmail.com</A>&gt; wrote:
</I>&gt;<i> Vaibhav,
</I>&gt;<i> 
</I>&gt;<i> In java, we can do in following way:
</I>&gt;<i> 
</I>&gt;<i> session.invalidate();
</I>&gt;<i> session=request.getSession(true);
</I>&gt;<i> 
</I>&gt;<i> Above code will destroy the previous session and regenerate a new session id. Same 'concept' could be used in .Net. I am not sure with the code though. You may want to view the following link by MSDN as well:
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://msdn.microsoft.com/en-us/library/ms178582.aspx">http://msdn.microsoft.com/en-us/library/ms178582.aspx</A>
</I>&gt;<i> 
</I>&gt;<i> Let me know if it works! :-)
</I>&gt;<i> 
</I>&gt;<i> On Fri, Nov 25, 2011 at 1:03 PM, Deepayan (Dragon) &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">deepayan.chanda at gmail.com</A>&gt; wrote:
</I>&gt;<i> Hi
</I>&gt;<i> Not sure if this helps, sending you two links, one which very neatly demonstrates what is session fixation. and another one states about how to fix it in VB or C#,
</I>&gt;<i> <A HREF="http://shiflett.org/articles/session-fixation">http://shiflett.org/articles/session-fixation</A>
</I>&gt;<i> <A HREF="http://forums.asp.net/t/1360608.aspx">http://forums.asp.net/t/1360608.aspx</A>
</I>&gt;<i> 
</I>&gt;<i> also see this if it helps.
</I>&gt;<i> <A HREF="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet">https://www.owasp.org/index.php/Session_Management_Cheat_Sheet</A>
</I>&gt;<i> 
</I>&gt;<i> Regards
</I>&gt;<i> Deepayan 
</I>&gt;<i> 
</I>&gt;<i> On Fri, Nov 25, 2011 at 12:16 PM, Dhruv Soi &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at torridnetworks.com</A>&gt; wrote:
</I>&gt;<i> What sessionstate mode are they using? You mail suggests inproc?
</I>&gt;<i> 
</I>&gt;<i> How about abandoning the session and adding a new cookie?
</I>&gt;<i> 
</I>&gt;<i> Session.Abandon();
</I>&gt;<i> Response.Cookies.Add(....)
</I>&gt;<i> 
</I>&gt;<i> If it destroys the data, I think SQLServer mode could be a good option. 
</I>&gt;<i> 
</I>&gt;<i> Though, I am not a .Net freak, but just trying to learn by commenting. Do let me know what solution works for you.
</I>&gt;<i> 
</I>&gt;<i> Cheers!
</I>&gt;<i> Dhruv
</I>&gt;<i> 
</I>&gt;<i> On Thu, Nov 24, 2011 at 9:19 PM, Vaibhav Gupta &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">vaibhav12jan at gmail.com</A>&gt; wrote:
</I>&gt;<i> Hi Folks,
</I>&gt;<i> 
</I>&gt;<i> I am looking for the mitigation of Session fixation vulnerability on ASP .NET platform. My development team is unable to devise the solution to change the session id post-authentication. Please help me in this regard.
</I>&gt;<i> 
</I>&gt;<i> I am looking for something synonymous to PHP's session_regenerate_id() in ASP .NET. Other solutions are greatly appreciated.
</I>&gt;<i> 
</I>&gt;<i> Thanks in anticipation
</I>&gt;<i> Vaibhav Gupta
</I>&gt;<i> 
</I>&gt;<i> --------
</I>&gt;<i> LinkedIn: <A HREF="http://www.linkedin.com/in/vaibhav0">http://www.linkedin.com/in/vaibhav0</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-delhi mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-delhi mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> With Regards
</I>&gt;<i> 
</I>&gt;<i> Deepayan
</I>&gt;<i> MBA(IT), GCIA (GIAC), CEH, CHFI
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-delhi mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Thanks,
</I>&gt;<i> Pankaj Upadhyay
</I>&gt;<i> <A HREF="http://pankajupadhyay.in/">http://pankajupadhyay.in/</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Thanks,
</I>&gt;<i> Pankaj Upadhyay
</I>&gt;<i> <A HREF="http://pupadhyay.blogspot.com/">http://pupadhyay.blogspot.com/</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20111204/318b8246/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20111204/318b8246/attachment.html</A> 
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001661.html">[Owasp-delhi] Configuring SSL on Tomcat 6
</A></li>
	<LI>Next message: <A HREF="001659.html">[Owasp-delhi] Returned mail: Data format error
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1652">[ date ]</a>
              <a href="thread.html#1652">[ thread ]</a>
              <a href="subject.html#1652">[ subject ]</a>
              <a href="author.html#1652">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
