<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-Delhi] Anti-CSRF token in cookie and post form
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-Delhi%5D%20Anti-CSRF%20token%20in%20cookie%20and%20post%20form&In-Reply-To=%3CCADCpCkhdMV%2BNmYh35%3DLP26MbPbboN%3DGR3Feyp3hz1sK9DrVrvg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001870.html">
   <LINK REL="Next"  HREF="001873.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-Delhi] Anti-CSRF token in cookie and post form</H1>
    <B>Minhaz A V</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-Delhi%5D%20Anti-CSRF%20token%20in%20cookie%20and%20post%20form&In-Reply-To=%3CCADCpCkhdMV%2BNmYh35%3DLP26MbPbboN%3DGR3Feyp3hz1sK9DrVrvg%40mail.gmail.com%3E"
       TITLE="[OWASP-Delhi] Anti-CSRF token in cookie and post form">minhazav at gmail.com
       </A><BR>
    <I>Sat Jul  4 12:17:27 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001870.html">[OWASP-Delhi] Anti-CSRF token in cookie and post form
</A></li>
        <LI>Next message: <A HREF="001873.html">[OWASP-Delhi] Anti-CSRF token in cookie and post form
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1871">[ date ]</a>
              <a href="thread.html#1871">[ thread ]</a>
              <a href="subject.html#1871">[ subject ]</a>
              <a href="author.html#1871">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Not one I can think of as the whole point of using a random nonce here is
based on same origin policy of the cookie.

Also there is possiblity the validation on server side could be between
post variable and server side cookie rather than one sent by client. This
would make tampering request useless.
On 4 Jul 2015 17:29, &quot;Vaibhav Gupta&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">vaibhav12jan at gmail.com</A>&gt; wrote:

&gt;<i> Hello all,
</I>&gt;<i>
</I>&gt;<i> I recently encountered an application which was having its random
</I>&gt;<i> anti-csrf token in cookie and the same random token was sent in the POST
</I>&gt;<i> form. If I tamper the cookie and the post form anti-CSRF token with the
</I>&gt;<i> same value, server will validate my request.
</I>&gt;<i>
</I>&gt;<i> Example:
</I>&gt;<i>
</I>&gt;<i> POST /account/delete
</I>&gt;<i> HOST: XYZ
</I>&gt;<i> Cookie: CSRF_Token=123456
</I>&gt;<i>
</I>&gt;<i> account_id=10101&amp;CSRF_Token=123456
</I>&gt;<i>
</I>&gt;<i> Now the problem is that we can not manipulate cookie value with Javascript
</I>&gt;<i> and hence cannot fiddle with the anti-csrf token present in cookie. Is
</I>&gt;<i> there a way to create a working exploit?
</I>&gt;<i>
</I>&gt;<i> Apologies if I am unable to clear the scenario.
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i> Vaibhav
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> OWASP-Delhi mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">OWASP-Delhi at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i> LinkedIn Group: <A HREF="https://www.linkedin.com/groups?gid=89270">https://www.linkedin.com/groups?gid=89270</A>
</I>&gt;<i> Twitter: <A HREF="https://twitter.com/OWASPdelhi">https://twitter.com/OWASPdelhi</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-delhi/attachments/20150704/8e2aab7c/attachment.html">http://lists.owasp.org/pipermail/owasp-delhi/attachments/20150704/8e2aab7c/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001870.html">[OWASP-Delhi] Anti-CSRF token in cookie and post form
</A></li>
	<LI>Next message: <A HREF="001873.html">[OWASP-Delhi] Anti-CSRF token in cookie and post form
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1871">[ date ]</a>
              <a href="thread.html#1871">[ thread ]</a>
              <a href="subject.html#1871">[ subject ]</a>
              <a href="author.html#1871">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the OWASP-Delhi
mailing list</a><br>
</body></html>
