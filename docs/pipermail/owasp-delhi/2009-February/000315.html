<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Attack Scenerio
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Attack%20Scenerio&In-Reply-To=f162ba540902060357r133437a8v72db1dd821834dbc%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000314.html">
   <LINK REL="Next"  HREF="000317.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Attack Scenerio</H1>
    <B>Soi, Dhruv</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Attack%20Scenerio&In-Reply-To=f162ba540902060357r133437a8v72db1dd821834dbc%40mail.gmail.com"
       TITLE="[Owasp-delhi] Attack Scenerio">dhruv.soi at owasp.org
       </A><BR>
    <I>Fri Feb  6 08:04:00 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000314.html">[Owasp-delhi] Attack Scenerio
</A></li>
        <LI>Next message: <A HREF="000317.html">[Owasp-delhi] Attack Scenerio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#315">[ date ]</a>
              <a href="thread.html#315">[ thread ]</a>
              <a href="subject.html#315">[ subject ]</a>
              <a href="author.html#315">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Client makes a request --&gt;
<A HREF="http://www.fileopen.com/open.php?file=someexcel.xls">http://www.fileopen.com/open.php?file=someexcel.xls</A> towards the server. This
is incoming request and contains file name in HTTP GET, but filename won't
bring up an alert.

 

Server responds to above request by passing on the XLS file in HTTP Data
which would be outgoing traffic from server to client. XLS contents will be
parsed by IPS, signature match will happen and alert will be triggered.
Connection is for sure INCOMING but the malicious traffic would be outgoing.
IPS signature would be checking the traffic from IN to OUT in this case, I
believe. 

 

Simple way to check this would be to block incoming requests to the server
from external clients and see if outbound connections are still being made
from the server. That would clearly tell you if the triggers are due to
incoming connections made from clients or server is running some malicious
program and making outbound connections.

 

 

 

  _____  

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On Behalf Of Parmendra Sharma
Sent: Friday, February 06, 2009 5:27 PM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Subject: Re: [Owasp-delhi] Attack Scenerio

 

Sir,

 

Thanks for your answer..

 

I am worry about the OUTGOING connection that is blocked by the firewall and
If i am right then an OUTGOING connection is that for which the first
request (A SYN packet to complete the TCP three way handshaking) is sent
from from internal network to the external machine. 

 

Now if an Excel file is there on the Server then to accessing that file by
the attacker or someone else (a user) would create an INCOMING CONNECTION
with the server to exploit the vulnerability within the excel file and for
this NO OUTGOING CONNNECTION IS REQUIRED.

 

Please clarify......:-) 

On Thu, Feb 5, 2009 at 5:09 PM, Soi, Dhruv &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>&gt; wrote:

I am not really sure about the practical scenario due to no access to
server/IPS logs but just making a blind guess to your problem:

 

-&gt; What can be the possible thing that is making the oubound connection to
the malicious server.

*	Basic and stupid answer could be &quot;false positive&quot; :-) 
*	Possibility could be that there is some Excel file located in web
server path and whenever, a request is made from the client, web server
returns the excel file and IPS triggers an alert. This would be outbound
traffic for the IPS. 
*	If you can check the web server logs for the timestamp when IPS
alert was generated and you don't see any log entry where Excel file was
served to some external client then above point is ruled out. Look for other
programs making connection to external web servers and you may use
SysInternal tools to dig further

 

-&gt; If IPS is capable of detecting the abovementioned signatures for the
outgoing requests, then why it doesnot blok the same request for the
incoming request so that the attack can be blocked at the Perimeter.

I think this is not some network/web attack coming that can be launched
towards the web server as such till the time your web application doesn't
allow users to upload excel files into the application. The attack is
crafted on the top of the function HrShellOpenWithMonikerDisplayName in
hlink.dll that overflows the stack due to long URIs [Refer: CVE-2006-3086].
Such malicious excel files could infect the server/client when a user opens
the excel file and clicks on long URIs. Now, source for such excel files
could be FTP, Website, Mail, SMB Share, other media, etc. Obviously, excel
files could be embedded in Word/PPT files to fool around the users and make
the investigation more time consuming.

 

Hope helpful!

 

Many Thanks,

Dhruv

 

  _____  

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On Behalf Of Parmendra Sharma
Sent: Thursday, February 05, 2009 2:23 PM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Subject: [Owasp-delhi] Attack Scenerio

 

Hello OWASP Members,

 

Please clarify the Attack that is done by the Attacker on the WebServer in
the belowmentioned scenerio:

 

Network description:

 

Network threat protection (IPS) installed as a part of Symantec endpoint
protection on Microsoft ISA firewall.

 

Now there are certain requests that are blocked by the firewall which are
making the OUTGOING connections (which are malicious) and IPS detected those
attack signatures as &quot;[SID=21672] HTTP MS Excel Unicode HLINK BO Detected&quot;.

 

Now my question are:

-&gt; What can be the possible thing that is making the oubound connection to
the malicious server.

-&gt; If IPS is capable of detecting the abovementioned signatures for the
outgoing requests, then why it doesnot blok the same request for the
incoming request so that the attack can be blocked at the Perimeter.

 



-- 
Thanks and Regards:

Parmendra Sharma
Indian Computer Emergency Response Team (CERT-In)
Ministry of Information Technology
Government of India
6 C.G.O Complex
Lodhi Road
New Delhi




-- 
Thanks and Regards:

Parmendra Sharma
Indian Computer Emergency Response Team (CERT-In)
Ministry of Information Technology
Government of India
6 C.G.O Complex
Lodhi Road
New Delhi

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090206/a142c4ca/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090206/a142c4ca/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000314.html">[Owasp-delhi] Attack Scenerio
</A></li>
	<LI>Next message: <A HREF="000317.html">[Owasp-delhi] Attack Scenerio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#315">[ date ]</a>
              <a href="thread.html#315">[ thread ]</a>
              <a href="subject.html#315">[ subject ]</a>
              <a href="author.html#315">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
