<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Attack Scenerio
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Attack%20Scenerio&In-Reply-To=498ad00c.09876e0a.0c78.61a7%40mx.google.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000315.html">
   <LINK REL="Next"  HREF="000316.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Attack Scenerio</H1>
    <B>Praveen Darshanam</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Attack%20Scenerio&In-Reply-To=498ad00c.09876e0a.0c78.61a7%40mx.google.com"
       TITLE="[Owasp-delhi] Attack Scenerio">praveen_recker at yahoo.com
       </A><BR>
    <I>Fri Feb  6 10:34:17 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000315.html">[Owasp-delhi] Attack Scenerio
</A></li>
        <LI>Next message: <A HREF="000316.html">[Owasp-delhi] Attack Scenerio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#317">[ date ]</a>
              <a href="thread.html#317">[ thread ]</a>
              <a href="subject.html#317">[ subject ]</a>
              <a href="author.html#317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Most of the time signatures are pattern based.

In our case, 
we can stop the attack just by analyzing the *request* for malicious file based upon extension (doc,pdf etc).

In the other case we can block the malicious file based upon the file content in *response* packet.

We implicitly mention in the signature file what is the direction (inbound/outbound) that we are looking for. The direction is always relative......depending upon what we are protecting i.e are we protecting client or server?

Best Regards,
Praveen Darshanam

--- On Thu, 2/5/09, Soi, Dhruv &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>&gt; wrote:
From: Soi, Dhruv &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>&gt;
Subject: Re: [Owasp-delhi] Attack Scenerio
To: &quot;'Parmendra Sharma'&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">s.parmendra at gmail.com</A>&gt;, <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Date: Thursday, February 5, 2009, 5:09 PM




 
 

 

 

 

 

 







I am not really sure about the practical
scenario due to no access to server/IPS logs but just making a blind guess to
your problem: 

 &#160; 

-&gt; What can be the possible thing that is making the oubound connection
to the malicious server. 


 Basic
     and stupid answer could be &#8220;false positive&#8221; J  
 Possibility
     could be that there is some Excel file located in web server path and
     whenever, a request is made from the client, web server returns the excel
     file and IPS triggers an alert. This would be outbound traffic for the
     IPS.  
 If
     you can check the web server logs for the timestamp when IPS alert was
     generated and you don&#8217;t see any log entry where Excel file was
     served to some external client then above point is ruled out. Look for
     other programs making connection to external web servers and you may use
     SysInternal tools to dig further 


 &#160; 

-&gt; If IPS is capable of detecting the abovementioned signatures for
the outgoing requests, then why it doesnot blok the same request for the incoming
request so that the attack can be blocked at the Perimeter. 

I think this is not some network/web attack
coming that can be launched towards the web server as such till the time your
web application doesn&#8217;t allow users to upload excel files into the
application. The attack is crafted on the top of the function HrShellOpenWithMonikerDisplayName
in hlink.dll that overflows the stack due to long URIs [Refer: CVE-2006-3086].
Such malicious excel files could infect the server/client when a user opens the
excel file and clicks on long URIs. Now, source for such excel files could be
FTP, Website, Mail, SMB Share, other media, etc. Obviously, excel files could
be embedded in Word/PPT files to fool around the users and make the
investigation more time consuming. 

 &#160; 

Hope helpful! 

 &#160; 

Many Thanks, 

Dhruv 

 &#160; 









From:
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On
Behalf Of Parmendra Sharma

Sent: Thursday, February 05, 2009
2:23 PM

To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>

Subject: [Owasp-delhi] Attack
Scenerio 



 &#160; 



Hello OWASP Members, 





&#160; 





Please clarify the Attack that is done by the Attacker on the WebServer
in the belowmentioned scenerio: 





&#160; 





Network description: 





&#160; 





Network threat protection (IPS) installed as a part of Symantec
endpoint protection on Microsoft ISA firewall. 





&#160; 





Now there are certain&#160;requests that are blocked by the firewall
which are making the OUTGOING connections (which are malicious) and IPS detected
those attack signatures as &quot;[SID=21672] HTTP MS Excel Unicode HLINK BO
Detected&quot;. 





&#160; 





Now&#160;my question are: 





-&gt; What can be the possible thing that is making the oubound
connection to the malicious server. 





-&gt; If IPS is capable of detecting the abovementioned signatures for
the outgoing requests, then why it doesnot blok the same request for the
incoming request so that the attack can be blocked at the Perimeter. 





&#160; 









-- 

Thanks and Regards:



Parmendra Sharma

Indian Computer Emergency Response Team (CERT-In)

Ministry of Information Technology

Government of India

6 C.G.O Complex

 Lodhi Road

 New Delhi 





 

_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>



      
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090206/29b35110/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090206/29b35110/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000315.html">[Owasp-delhi] Attack Scenerio
</A></li>
	<LI>Next message: <A HREF="000316.html">[Owasp-delhi] Attack Scenerio
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#317">[ date ]</a>
              <a href="thread.html#317">[ thread ]</a>
              <a href="subject.html#317">[ subject ]</a>
              <a href="author.html#317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
