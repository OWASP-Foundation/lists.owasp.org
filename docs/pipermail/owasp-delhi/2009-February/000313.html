<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Please clarify
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Please%20clarify&In-Reply-To=498ae938.09876e0a.0c78.ffffb3a6%40mx.google.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000312.html">
   <LINK REL="Next"  HREF="000301.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Please clarify</H1>
    <B>Gunwant Singh</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Please%20clarify&In-Reply-To=498ae938.09876e0a.0c78.ffffb3a6%40mx.google.com"
       TITLE="[Owasp-delhi] Please clarify">gunwant.s at gmail.com
       </A><BR>
    <I>Thu Feb  5 12:17:30 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000312.html">[Owasp-delhi] Please clarify
</A></li>
        <LI>Next message: <A HREF="000301.html">[Owasp-delhi] [OT] $20 Laptop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#313">[ date ]</a>
              <a href="thread.html#313">[ thread ]</a>
              <a href="subject.html#313">[ subject ]</a>
              <a href="author.html#313">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the info Dhruv.

Another thing I want to add to the point is this. In my last session, a guy
(Sorry for not remembering the name, my apology) put up an interesting
question.The question was that in order to exploit the CSRF attack, we know
we can craft a GET request via a URL as mentioned in Dhruv's email  But, in
cases wherein POST requests are involved. For example, the request that
changes the password, or transfers the money from a/c to the other. In such
cases *forms* are involved. How come an attacker would socially engineer a
user to fill the form to change his password to what the attacker wants :)

The answer to this is:
The attacker crafts a page which consists of the following code:

&lt;html&gt;
&lt;head&gt;
&lt;script language=&quot;JavaScript&quot;&gt;
function fnsubmit()
{
window.document.form1.submit();
return;
}
&lt;/script&gt;
&lt;/head&gt;*

*&lt;body *onload=&quot;return fnsubmit()&quot;*&gt;
&lt;form name=&quot;form1&quot; action=&quot;*changepassword.php*&quot; onload=&quot;submit&quot; /&gt;
&lt;input type=&quot;text&quot; name=&quot;username&quot; value=&quot;theusername&quot; /&gt;
&lt;input type=&quot;text&quot; name=&quot;password&quot; value=&quot;*atckrspass*&quot; /&gt;
&lt;input type=&quot;submit&quot; value=&quot;Click to Submit&quot; /&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;

So once the user clicks the link of the page containing this code, the form
gets submitted automatically with NO user intervention.

Enjoy!

-Gunwant






On Thu, Feb 5, 2009 at 6:57 PM, Soi, Dhruv &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">dhruv.soi at owasp.org</A>&gt; wrote:

&gt;<i>  CSRF is just to force a user execute some command on the server in
</I>&gt;<i> context of his already authenticated session. User must be logged into the
</I>&gt;<i> application to make the CSRF work. This simple link can make CSRF work &#224;
</I>&gt;<i> <A HREF="http://www.shopping.com/purchase.php?item=car&amp;confirmed=1">http://www.shopping.com/purchase.php?item=car&amp;confirmed=1</A>
</I>&gt;<i>
</I>&gt;<i> It doesn't work if there is new browser instance, as in that case session
</I>&gt;<i> won't be valid but it can work in browser TAB. Attendees of last meeting can
</I>&gt;<i> recall Gunwant's discussion on the same point about Chrome browser and IE 8.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Whereas, till the time you don't want to steal client's session data, XSS
</I>&gt;<i> doesn't really rely on active session to do the trick. Payload would be
</I>&gt;<i> entirely different in this case, like &#224; <A HREF="http://www.shopping.com/purchase.php?item=&lt;script">http://www.shopping.com/purchase.php?item=&lt;script</A>&gt;alert(&quot;Mess
</I>&gt;<i> with the best, die like the rest&quot;);&lt;/script&gt;&amp;confirmed=0&lt;<A HREF="http://www.shopping.com/purchase.php?item=%3cscript%3ealert%28%E2%80%9CMess%20with%20the%20best,%20die%20like%20the%20rest%E2%80%9D%29%3c/script%3e&amp;confirmed=0">http://www.shopping.com/purchase.php?item=%3cscript%3ealert%28%E2%80%9CMess%20with%20the%20best,%20die%20like%20the%20rest%E2%80%9D%29%3c/script%3e&amp;confirmed=0</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> CSRF has nothing to do with XSS but when CSRF is launched with XSS it can
</I>&gt;<i> make a difference.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> If someone hasn't already read about MySpace Samy story, visit this link &#224;
</I>&gt;<i> <A HREF="http://namb.la/popular/">http://namb.la/popular/</A>  (No CSRF in the link) J
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Many Thanks,
</I>&gt;<i>
</I>&gt;<i> Dhruv
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  ------------------------------
</I>&gt;<i>
</I>&gt;<i> *From:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A> [mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] *On Behalf Of *Gunwant Singh
</I>&gt;<i> *Sent:* Thursday, February 05, 2009 11:34 AM
</I>&gt;<i> *To:* Bipin Upadhyay
</I>&gt;<i> *Cc:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> *Subject:* Re: [Owasp-delhi] Please clarify
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> No, I do not agree with that.
</I>&gt;<i>
</I>&gt;<i> On Wed, Feb 4, 2009 at 11:54 PM, Bipin Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">muxical.geek at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> Gunwant Singh wrote:
</I>&gt;<i>
</I>&gt;<i> Both are independent of each other. An application may be vulnerable to one
</I>&gt;<i> of the attacks but not the other at the same time.
</I>&gt;<i>
</I>&gt;<i> I think there's a slight mistake here. An app vulnerable to XSS is
</I>&gt;<i> automatically vulnerable to CSRF.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> For a CSRF attack, an application does not need to be susceptible to XSS
</I>&gt;<i> attack. Often, to execute an XSS attack, one needs to include a script in
</I>&gt;<i> the context of the application. So if you can incorporate some scripting you
</I>&gt;<i> can execute XSS. Although there are many variations to this, which is
</I>&gt;<i> another story. For CSRF, one needs to execute code (not necessarily a
</I>&gt;<i> script)  in the authentication context of the user that changes the state of
</I>&gt;<i> the application. For example: Changing password, transfering money from his
</I>&gt;<i> a/c to the attackers, etc.
</I>&gt;<i>
</I>&gt;<i> Hope that helps. Let me know if any further clarification is required.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Gunwant
</I>&gt;<i>
</I>&gt;<i> On Mon, Feb 2, 2009 at 4:35 PM, Parmendra Sharma &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">s.parmendra at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> Hello All,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Please clarify the belowmentioned point:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &quot;XSS flaws is susceptible to CSRF because a CSRF attack can exploit the XSS
</I>&gt;<i> flaw to steal any non-automatically submitted credential that might be in
</I>&gt;<i> place to protect against a CSRF attack&quot;
</I>&gt;<i>
</I>&gt;<i> Please mention the scenerio where both the vulnerabilities are in
</I>&gt;<i> action....
</I>&gt;<i> --
</I>&gt;<i> Thanks and Regards:
</I>&gt;<i>
</I>&gt;<i> Parmendra Sharma
</I>&gt;<i> Indian Computer Emergency Response Team (CERT-In)
</I>&gt;<i> Ministry of Information Technology
</I>&gt;<i> Government of India
</I>&gt;<i> 6 C.G.O Complex
</I>&gt;<i> Lodhi Road
</I>&gt;<i> New Delhi
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-delhi mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Gunwant Singh
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i>
</I>&gt;<i> Owasp-delhi mailing list
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --Bipin Upadhyay.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Gunwant Singh
</I>&gt;<i>
</I>


-- 
Gunwant Singh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090205/8dba6ed6/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090205/8dba6ed6/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000312.html">[Owasp-delhi] Please clarify
</A></li>
	<LI>Next message: <A HREF="000301.html">[Owasp-delhi] [OT] $20 Laptop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#313">[ date ]</a>
              <a href="thread.html#313">[ thread ]</a>
              <a href="subject.html#313">[ subject ]</a>
              <a href="author.html#313">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
