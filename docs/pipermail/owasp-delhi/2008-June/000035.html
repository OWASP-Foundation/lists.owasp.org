<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Reg. CSRF
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Reg.%20CSRF&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000033.html">
   <LINK REL="Next"  HREF="000037.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Reg. CSRF</H1>
    <B>Singh, Gunwant [OS-IE]</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Reg.%20CSRF&In-Reply-To="
       TITLE="[Owasp-delhi] Reg. CSRF">GUNWANT.SINGH at saic.com
       </A><BR>
    <I>Tue Jun 24 13:03:55 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000033.html">[Owasp-delhi] Reg. CSRF
</A></li>
        <LI>Next message: <A HREF="000037.html">[Owasp-delhi] Reg. CSRF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35">[ date ]</a>
              <a href="thread.html#35">[ thread ]</a>
              <a href="subject.html#35">[ subject ]</a>
              <a href="author.html#35">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hi,

Thanks for your opinion but that did not answer my question.
I know how it works, I have tested dozen applications but what I wanted to know in the first place in short is that if an application is vulnerable to CSRF which has already been tested via. different tab of the same browser - Is there a way I can show that the application is also vulnerable by using different browser and not the same instance of the same browser.

Regards.

-----Original Message-----
From: Bishan Singh [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">c70n3r at gmail.com</A>]
Sent: Tue 24/06/2008 13:54
To: Singh, Gunwant [OS-IE]
Subject: Re: [Owasp-delhi] Reg. CSRF
 
CSRF (also known as one-click attack) relies on user's logged on credentials.

This is how it works:

1. Victim logs on to his online banking website. Assume he used Firefox for this

2. There is a malicious website which when opened in browser
automatically transfers money from victim's account to attacker's
account.

3. Victim opens the malicious link in the same Firefox instance, as a
new tab (or may be even a new firefox window. Haven't tested this one
so far). WHEN THE MALICIOUS WEBSITE INVOKES THE BANK URL FOR MONEY
TRANSFER, BROWSER AUTOMATICALLY SENDS VICTIM'S COOKIES. The attack
works!

or

3. Victim opens the malicious link in IE. WHEN THE MALICIOUS WEBSITE
INVOKES THE BANK URL FOR MONEY TRANSFER, BROWSER HAS NO COOKIES TO
SEND FOR BANK TO AUTHENTICATE THE VICTIM. The attack fails!

If you wish to understand this in more detail download and try Hackme
Casino from Foundstone website. I'm posting a video on CSRF soon on my
Blog, you can keep an RSS feed with you for update.

Hope this helps!


On 6/24/08, Singh, Gunwant [OS-IE] &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">GUNWANT.SINGH at saic.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi All,
</I>&gt;<i>
</I>&gt;<i> I was testing one of the application last night. The issue I am going to
</I>&gt;<i> describe is nothing new to me but I was concerned about this for a long time
</I>&gt;<i> and I did not get any chance to ask this before.
</I>&gt;<i>
</I>&gt;<i> While testing the application against CSRF attack, I noticed that it is
</I>&gt;<i> vulnerable to CSRF attack only if it is tested via. another tab of the same
</I>&gt;<i> browser. However, if I test the application via.  different browser it does
</I>&gt;<i> not work.
</I>&gt;<i>
</I>&gt;<i> This is how I tested:
</I>&gt;<i> I logged in to the application. I coded an html page with an image tag with
</I>&gt;<i> source as the logout URL. (&lt;img src=&quot;www.application.com/logout.php&quot;&gt;). I
</I>&gt;<i> sent this link to my email (just to make the scenario look real). I clicked
</I>&gt;<i> on the link, it opened in the same browser in a different tab and I   got
</I>&gt;<i> logged out of the application. However, if I use another browser window to
</I>&gt;<i> open the URL, it did not work.
</I>&gt;<i>
</I>&gt;<i> So, I wanted to know that how high is this risk and is there any way I can
</I>&gt;<i> show that the application is also vulnerable by using different browser. Any
</I>&gt;<i> suggestions/opinions will be highly appreciated.
</I>&gt;<i>
</I>&gt;<i> Thank you.
</I>&gt;<i> Gunwant Singh.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-delhi mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Bishan
--
GNET, CISSP
<A HREF="http://apps3c.blogspot.com">http://apps3c.blogspot.com</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20080624/3e62f43b/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20080624/3e62f43b/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000033.html">[Owasp-delhi] Reg. CSRF
</A></li>
	<LI>Next message: <A HREF="000037.html">[Owasp-delhi] Reg. CSRF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#35">[ date ]</a>
              <a href="thread.html#35">[ thread ]</a>
              <a href="subject.html#35">[ subject ]</a>
              <a href="author.html#35">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
