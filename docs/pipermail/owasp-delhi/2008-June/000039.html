<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] Reg. CSRF
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Reg.%20CSRF&In-Reply-To=eee174420806242002k395cb721md8e0608ee46a4b69%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000038.html">
   <LINK REL="Next"  HREF="000036.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] Reg. CSRF</H1>
    <B>Harish</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20Reg.%20CSRF&In-Reply-To=eee174420806242002k395cb721md8e0608ee46a4b69%40mail.gmail.com"
       TITLE="[Owasp-delhi] Reg. CSRF">harish_s_s at yahoo.com
       </A><BR>
    <I>Wed Jun 25 00:37:50 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000038.html">[Owasp-delhi] Reg. CSRF
</A></li>
        <LI>Next message: <A HREF="000036.html">[Owasp-delhi] Reg. CSRF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39">[ date ]</a>
              <a href="thread.html#39">[ thread ]</a>
              <a href="subject.html#39">[ subject ]</a>
              <a href="author.html#39">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Gunwant,

As far as my knowledge goes, the cookies of one browser instance are available to another instance of the same browser. For example, if you login to your yahoo mail account from once browser instance, say Firefox and then attempt to browse to mail.yahoo.com from another instance, not tab, of Firefox, you'll notice that you are automatically logged in to your account (if the session is still active).

Therefore, i feel that if you are able to exploit CSRF through a tab, you'll be able to achieve the same through another instance of the same browser as well. Further, regarding the risk of CSRF, i'm sure you know that it depends on the context and the exploit vector. If the greatest damage you can do through this is just logging a user out of this session then it's not such a big risk, although it would be a security issue. On the other hand, if you are able to modify/update his details or perform some key action on his behalf, then that would be a risk to worry about.

I hope i've answered your question.

Regards
Harish

--- On Wed, 25/6/08, Bishan Singh &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">c70n3r at gmail.com</A>&gt; wrote:
From: Bishan Singh &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">c70n3r at gmail.com</A>&gt;
Subject: Re: [Owasp-delhi] Reg. CSRF
To: &quot;Singh, Gunwant [OS-IE]&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">GUNWANT.SINGH at saic.com</A>&gt;
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
Date: Wednesday, 25 June, 2008, 8:32 AM

I guess NO. Unless the browser has your valid cookies CSRF will fail.
That would be the case with DIFFERENT browser. SAME browser I have not
tested yet.

The attack success would depend on usage pattern of the victim. It
nevertheless is a high risk issue. From my experience folks use tabs a
lot these days.

Hope I answered your question this time

On 6/24/08, Singh, Gunwant [OS-IE] &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">GUNWANT.SINGH at saic.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> Thanks for your opinion but that did not answer my question.
</I>&gt;<i> I know how it works, I have tested dozen applications but what I wanted to
</I>&gt;<i> know in the first place in short is that if an application is vulnerable
</I>to
&gt;<i> CSRF which has already been tested via. different tab of the same browser
</I>-
&gt;<i> Is there a way I can show that the application is also vulnerable by using
</I>&gt;<i> different browser and not the same instance of the same browser.
</I>&gt;<i>
</I>&gt;<i> Regards.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Bishan Singh [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">c70n3r at gmail.com</A>]
</I>&gt;<i> Sent: Tue 24/06/2008 13:54
</I>&gt;<i> To: Singh, Gunwant [OS-IE]
</I>&gt;<i> Subject: Re: [Owasp-delhi] Reg. CSRF
</I>&gt;<i>
</I>&gt;<i> CSRF (also known as one-click attack) relies on user's logged on
</I>&gt;<i> credentials.
</I>&gt;<i>
</I>&gt;<i> This is how it works:
</I>&gt;<i>
</I>&gt;<i> 1. Victim logs on to his online banking website. Assume he used Firefox
</I>for
&gt;<i> this
</I>&gt;<i>
</I>&gt;<i> 2. There is a malicious website which when opened in browser
</I>&gt;<i> automatically transfers money from victim's account to attacker's
</I>&gt;<i> account.
</I>&gt;<i>
</I>&gt;<i> 3. Victim opens the malicious link in the same Firefox instance, as a
</I>&gt;<i> new tab (or may be even a new firefox window. Haven't tested this one
</I>&gt;<i> so far). WHEN THE MALICIOUS WEBSITE INVOKES THE BANK URL FOR MONEY
</I>&gt;<i> TRANSFER, BROWSER AUTOMATICALLY SENDS VICTIM'S COOKIES. The attack
</I>&gt;<i> works!
</I>&gt;<i>
</I>&gt;<i> or
</I>&gt;<i>
</I>&gt;<i> 3. Victim opens the malicious link in IE. WHEN THE MALICIOUS WEBSITE
</I>&gt;<i> INVOKES THE BANK URL FOR MONEY TRANSFER, BROWSER HAS NO COOKIES TO
</I>&gt;<i> SEND FOR BANK TO AUTHENTICATE THE VICTIM. The attack fails!
</I>&gt;<i>
</I>&gt;<i> If you wish to understand this in more detail download and try Hackme
</I>&gt;<i> Casino from Foundstone website. I'm posting a video on CSRF soon on my
</I>&gt;<i> Blog, you can keep an RSS feed with you for update.
</I>&gt;<i>
</I>&gt;<i> Hope this helps!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 6/24/08, Singh, Gunwant [OS-IE] &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">GUNWANT.SINGH at saic.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hi All,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I was testing one of the application last night. The issue I am going
</I>to
&gt;<i> &gt; describe is nothing new to me but I was concerned about this for a
</I>long
&gt;<i> time
</I>&gt;<i> &gt; and I did not get any chance to ask this before.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; While testing the application against CSRF attack, I noticed that it
</I>is
&gt;<i> &gt; vulnerable to CSRF attack only if it is tested via. another tab of
</I>the
&gt;<i> same
</I>&gt;<i> &gt; browser. However, if I test the application via.  different browser
</I>it
&gt;<i> does
</I>&gt;<i> &gt; not work.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This is how I tested:
</I>&gt;<i> &gt; I logged in to the application. I coded an html page with an image
</I>tag
&gt;<i> with
</I>&gt;<i> &gt; source as the logout URL. (&lt;img
</I>src=&quot;www.application.com/logout.php&quot;&gt;). I
&gt;<i> &gt; sent this link to my email (just to make the scenario look real). I
</I>&gt;<i> clicked
</I>&gt;<i> &gt; on the link, it opened in the same browser in a different tab and I  
</I>got
&gt;<i> &gt; logged out of the application. However, if I use another browser
</I>window to
&gt;<i> &gt; open the URL, it did not work.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So, I wanted to know that how high is this risk and is there any way
</I>I can
&gt;<i> &gt; show that the application is also vulnerable by using different
</I>browser.
&gt;<i> Any
</I>&gt;<i> &gt; suggestions/opinions will be highly appreciated.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thank you.
</I>&gt;<i> &gt; Gunwant Singh.
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-delhi mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Bishan
</I>&gt;<i> --
</I>&gt;<i> GNET, CISSP
</I>&gt;<i> <A HREF="http://apps3c.blogspot.com">http://apps3c.blogspot.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Bishan Singh [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">c70n3r at gmail.com</A>]
</I>&gt;<i> Sent: Tue 24/06/2008 13:54
</I>&gt;<i> To: Singh, Gunwant [OS-IE]
</I>&gt;<i> Subject: Re: [Owasp-delhi] Reg. CSRF
</I>&gt;<i>
</I>&gt;<i> CSRF (also known as one-click attack) relies on user's logged on
</I>&gt;<i> credentials.
</I>&gt;<i>
</I>&gt;<i> This is how it works:
</I>&gt;<i>
</I>&gt;<i> 1. Victim logs on to his online banking website. Assume he used Firefox
</I>for
&gt;<i> this
</I>&gt;<i>
</I>&gt;<i> 2. There is a malicious website which when opened in browser
</I>&gt;<i> automatically transfers money from victim's account to attacker's
</I>&gt;<i> account.
</I>&gt;<i>
</I>&gt;<i> 3. Victim opens the malicious link in the same Firefox instance, as a
</I>&gt;<i> new tab (or may be even a new firefox window. Haven't tested this one
</I>&gt;<i> so far). WHEN THE MALICIOUS WEBSITE INVOKES THE BANK URL FOR MONEY
</I>&gt;<i> TRANSFER, BROWSER AUTOMATICALLY SENDS VICTIM'S COOKIES. The attack
</I>&gt;<i> works!
</I>&gt;<i>
</I>&gt;<i> or
</I>&gt;<i>
</I>&gt;<i> 3. Victim opens the malicious link in IE. WHEN THE MALICIOUS WEBSITE
</I>&gt;<i> INVOKES THE BANK URL FOR MONEY TRANSFER, BROWSER HAS NO COOKIES TO
</I>&gt;<i> SEND FOR BANK TO AUTHENTICATE THE VICTIM. The attack fails!
</I>&gt;<i>
</I>&gt;<i> If you wish to understand this in more detail download and try Hackme
</I>&gt;<i> Casino from Foundstone website. I'm posting a video on CSRF soon on my
</I>&gt;<i> Blog, you can keep an RSS feed with you for update.
</I>&gt;<i>
</I>&gt;<i> Hope this helps!
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 6/24/08, Singh, Gunwant [OS-IE] &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">GUNWANT.SINGH at saic.com</A>&gt; wrote:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Hi All,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I was testing one of the application last night. The issue I am going
</I>to
&gt;<i> &gt; describe is nothing new to me but I was concerned about this for a
</I>long
&gt;<i> time
</I>&gt;<i> &gt; and I did not get any chance to ask this before.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; While testing the application against CSRF attack, I noticed that it
</I>is
&gt;<i> &gt; vulnerable to CSRF attack only if it is tested via. another tab of
</I>the
&gt;<i> same
</I>&gt;<i> &gt; browser. However, if I test the application via.  different browser
</I>it
&gt;<i> does
</I>&gt;<i> &gt; not work.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; This is how I tested:
</I>&gt;<i> &gt; I logged in to the application. I coded an html page with an image
</I>tag
&gt;<i> with
</I>&gt;<i> &gt; source as the logout URL. (&lt;img
</I>src=&quot;www.application.com/logout.php&quot;&gt;). I
&gt;<i> &gt; sent this link to my email (just to make the scenario look real). I
</I>&gt;<i> clicked
</I>&gt;<i> &gt; on the link, it opened in the same browser in a different tab and I  
</I>got
&gt;<i> &gt; logged out of the application. However, if I use another browser
</I>window to
&gt;<i> &gt; open the URL, it did not work.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; So, I wanted to know that how high is this risk and is there any way
</I>I can
&gt;<i> &gt; show that the application is also vulnerable by using different
</I>browser.
&gt;<i> Any
</I>&gt;<i> &gt; suggestions/opinions will be highly appreciated.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thank you.
</I>&gt;<i> &gt; Gunwant Singh.
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-delhi mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Bishan
</I>&gt;<i> --
</I>&gt;<i> GNET, CISSP
</I>&gt;<i> <A HREF="http://apps3c.blogspot.com">http://apps3c.blogspot.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Bishan
--
GNET, CISSP
<A HREF="http://apps3c.blogspot.com">http://apps3c.blogspot.com</A>
_______________________________________________
Owasp-delhi mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">Owasp-delhi at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">https://lists.owasp.org/mailman/listinfo/owasp-delhi</A>


      Unlimited freedom, unlimited storage. Get it now, on <A HREF="http://help.yahoo.com/l/in/yahoo/mail/yahoomail/tools/tools-08.html/">http://help.yahoo.com/l/in/yahoo/mail/yahoomail/tools/tools-08.html/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20080624/ee8f9e6b/attachment.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20080624/ee8f9e6b/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000038.html">[Owasp-delhi] Reg. CSRF
</A></li>
	<LI>Next message: <A HREF="000036.html">[Owasp-delhi] Reg. CSRF
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39">[ date ]</a>
              <a href="thread.html#39">[ thread ]</a>
              <a href="subject.html#39">[ subject ]</a>
              <a href="author.html#39">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
