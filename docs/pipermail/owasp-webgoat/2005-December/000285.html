<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-WEBGOAT]WebGoat 3.7: bug in StoredXss (on Windows at least), bug in build.xml, can't solve Predictable Session Identifier, missing lesson plans
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DWebGoat%203.7%3A%20bug%20in%20StoredXss%20%28on%20Windows%20at%20least%29%2C%0A%20bug%20in%20build.xml%2C%20can%27t%20solve%20Predictable%20Session%20Identifier%2C%20missing%20lesson%0A%20plans&In-Reply-To=4391B897.6060004%40xebia.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000284.html">
   <LINK REL="Next"  HREF="000289.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-WEBGOAT]WebGoat 3.7: bug in StoredXss (on Windows at least), bug in build.xml, can't solve Predictable Session Identifier, missing lesson plans</H1>
    <B>Rogan Dawes</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DWebGoat%203.7%3A%20bug%20in%20StoredXss%20%28on%20Windows%20at%20least%29%2C%0A%20bug%20in%20build.xml%2C%20can%27t%20solve%20Predictable%20Session%20Identifier%2C%20missing%20lesson%0A%20plans&In-Reply-To=4391B897.6060004%40xebia.com"
       TITLE="[OWASP-WEBGOAT]WebGoat 3.7: bug in StoredXss (on Windows at least), bug in build.xml, can't solve Predictable Session Identifier, missing lesson plans">lists at dawes.za.net
       </A><BR>
    <I>Sun Dec  4 03:03:39 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000284.html">[OWASP-WEBGOAT]WebGoat 3.7: bug in StoredXss (on Windows at least), bug in build.xml, can't solve Predictable Session Identifier, missing lesson plans
</A></li>
        <LI>Next message: <A HREF="000289.html">[OWASP-WEBGOAT]Problem with &quot;Perform a blind SQL Injection&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#285">[ date ]</a>
              <a href="thread.html#285">[ thread ]</a>
              <a href="subject.html#285">[ subject ]</a>
              <a href="author.html#285">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Vincent Partington wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>[snip]

&gt;<i> 2. I couldn't solve the Predictable Session Identifier lesson. I used
</I>&gt;<i> WebScarab (nice tool too!) to plot the session identified and although a
</I>&gt;<i> weakness seems to be there, I wasn't able to exploit it. Is this lesson
</I>&gt;<i> a lot harder than the other ones?
</I>&gt;<i>
</I>Well, it may be a bit harder than some of the others, but it is a fairly 
advanced topic.

The idea is that you should look at the pattern that the generated 
WEAKID's follows. The key thing to notice is that there is a sequential 
component, and a time-based component.

The sequential component simply increments by one for each WEAKID 
generated. Periodically, you will see that the WEAKID skips an increment 
(i.e. increases by 2). The idea is that &quot;someone else&quot; has requested a 
session at the same time, and so you can see exactly what the sequence 
number for that WEAKID is (since you have the WEAKID's on either side!)

The objective of the lesson is to brute force the time-based component 
of the WEAKID, and gain access to the actual session that the other 
&quot;user&quot; received. You can identify a successful compromise by the fact 
that you will not be prompted to logon.

To assist you in brute forcing the time-based component, there is a 
pre-written script distributed with WebScarab in the scripts directory, 
which does the necessary prompting.

Take a loot at the script, try it out, and see if you get any results.

Once you have identified the actual WEAKID, you can add it to the 
&quot;Shared Cookies&quot; in WebScarab, and (under the Proxy -&gt; Miscellaneous 
tab) enable &quot;Inject known cookies in requests&quot;, which will enable you to 
view the session in your browser (if you reload the page). This is a 
generic technique for hijacking sessions, if you would like to access 
them using the browser, rather than hacking them manually ;-)

&gt;<i>
</I>&gt;<i> Well, I hope these remarks are helpful. If you have any more questions,
</I>&gt;<i> please let me know.
</I>&gt;<i>
</I>&gt;<i> Thanks for a great tool!
</I>&gt;<i>
</I>&gt;<i> Regards, Vincent Partington.
</I>
I hope my explanation was helpful. Glad you like the Web* tools

Rogan


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000284.html">[OWASP-WEBGOAT]WebGoat 3.7: bug in StoredXss (on Windows at least), bug in build.xml, can't solve Predictable Session Identifier, missing lesson plans
</A></li>
	<LI>Next message: <A HREF="000289.html">[OWASP-WEBGOAT]Problem with &quot;Perform a blind SQL Injection&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#285">[ date ]</a>
              <a href="thread.html#285">[ thread ]</a>
              <a href="subject.html#285">[ subject ]</a>
              <a href="author.html#285">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
