<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-webgoat] Assistance with WebGoat v5: &quot;How to hijack a session&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20Assistance%20with%20WebGoat%20v5%3A%20%22How%20to%20hijack%20a%0A%20session%22&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000394.html">
   <LINK REL="Next"  HREF="000389.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-webgoat] Assistance with WebGoat v5: &quot;How to hijack a session&quot;</H1>
    <B>Anand Iyer</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20Assistance%20with%20WebGoat%20v5%3A%20%22How%20to%20hijack%20a%0A%20session%22&In-Reply-To="
       TITLE="[Owasp-webgoat] Assistance with WebGoat v5: &quot;How to hijack a session&quot;">ace_mobius at hotmail.com
       </A><BR>
    <I>Thu Mar 29 08:52:18 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000394.html">[Owasp-webgoat] Wikto and Google API key problem
</A></li>
        <LI>Next message: <A HREF="000389.html">[Owasp-webgoat] Assistance with WebGoat v5: &quot;How to hijack a session&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#385">[ date ]</a>
              <a href="thread.html#385">[ thread ]</a>
              <a href="subject.html#385">[ subject ]</a>
              <a href="author.html#385">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello All,
 
I have been able to identify the skip in the WEAKID (I guess this occurs after every 29 steps). However I am still unable to brute-force the time component of the WEAKID. I carried out the following steps in WebScarab:
 
1. Using the SessionID Analysis Tab, I collected around 100 SessionIDs.
 
2. In the Analysis sub-tab, I found out the initial sequence part which was used by another user as given below

Thu Mar 29 17:21:32 IST 2007 15514-1175169092796 572796 40109
Thu Mar 29 17:21:32 IST 2007 15516-1175169092906 652906 80110
3. Then I used the script mentioned by Rogan in the previous mail with the following parameters:

Request Template: I gave any random number (As I did not understand the question &quot;Which request is the template?&quot;)
Enter Sequence Number: I gave the initial sequence number of the ID which was skipped (Say 15515)
Start Time: 1175169092796
End Time: 1175169092906 (As I want to find out the match between these two times; I hope I am right here)
4. The script starts brute-forcing and after some &quot;Trying...&quot; comes up with &quot;Success with conversation xyz&quot;. 
The exact conversation snippet is given below:

Trying WEAKID=15515-1175169092904; WEAKID=15395-1175168390796Trying WEAKID=15515-1175169092905; WEAKID=15395-1175168390796Success with conversation 378Success with conversation 379
5. I then tried a few of the WEAKID combinations with 15515-1175169092906 and sequentially increasing the time-component, but I am still unable to get the right one. 
 
Please let me know where I am going wrong. Also I would like to mention that I am not a programmer; don't know if that would make any difference :)
 
Regards,
Anant Iyer
P.S. Apologies for the long mail.



&gt;<i> Date: Mon, 19 Mar 2007 14:40:32 +0100&gt; From: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">lists at dawes.za.net</A>&gt; To: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">webapps3c at gmail.com</A>&gt; CC: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">owasp-webgoat at lists.owasp.org</A>&gt; Subject: Re: [Owasp-webgoat] Assistance with WebGoat v5: &quot;How to hijack a session&quot;&gt; &gt; cgi phantom wrote:&gt; &gt; HI All&gt; &gt; &gt; &gt; I need a little assistance regarding the 'How to hijack a session'. I'm &gt; &gt; a little stuck in understanding the millisecond part of the WeakID. I &gt; &gt; have identified a session ID which is used by another user:&gt; &gt; &gt; &gt; WeakID: 11616-1174050351671&gt; &gt; WeakID: 11619-1174050351718&gt; &gt; &gt; &gt; So I can assume that 11617-XXXXXXXXXXXXX is the &quot;other users&quot; session ID.&gt; &gt; &gt; &gt; My question is, instead of manually guessing &amp; submitting 47 differences &gt; &gt; in the milliseconds, how can I use the 'Scripted' section of Webscarab &gt; &gt; to help automate this process ? and is there an automated way to &gt; &gt; determine the milliseconds automatically. I read your email before which &gt; &gt; you sent to the OWASP-WebGoat list but I don't quite understand what you &gt; &gt; mean. Can you please clarify ? English is not my first language.&gt; &gt; &gt; &gt; Thanks in advance.&gt; &gt; &gt; &gt; r/&gt; &gt; &gt; &gt; CGI Phantom&gt; &gt; Hi,&gt; &gt; First off, in your example, you cannot be sure that 11617-XXX is the &gt; start of the other user's session ID. Note that your two possibilities &gt; are ..16 and ..19. The odds are good that you received one of ..17 or &gt; ..18 out of order, so just make sure that you are working on the right one.&gt; &gt; Next, there is a script in the ./scripts directory of a standard &gt; installation, that can be used to brute force the time component. It is &gt; called &quot;webgoat-session-brute.bsh&quot;. If you are not using the -installer &gt; version of WebScarab, you can see the script online at:&gt; &gt; &lt;<A HREF="http://dawes.za.net/gitweb.cgi?p=dawes.za.net/rogan/webscarab/webscarab.git;a=blob;f=scripts/webgoat-session-brute.bsh;h=8970bc5f5c162ac56ce71a793fa3845064646697;hb=HEAD">http://dawes.za.net/gitweb.cgi?p=dawes.za.net/rogan/webscarab/webscarab.git;a=blob;f=scripts/webgoat-session-brute.bsh;h=8970bc5f5c162ac56ce71a793fa3845064646697;hb=HEAD</A>&gt;&gt; &gt; or (without the line numbers):&gt; &gt; &lt;<A HREF="http://dawes.za.net/gitweb.cgi?p=dawes.za.net/rogan/webscarab/webscarab.git;a=blob_plain;f=scripts/webgoat-session-brute.bsh;h=8970bc5f5c162ac56ce71a793fa3845064646697">http://dawes.za.net/gitweb.cgi?p=dawes.za.net/rogan/webscarab/webscarab.git;a=blob_plain;f=scripts/webgoat-session-brute.bsh;h=8970bc5f5c162ac56ce71a793fa3845064646697</A>&gt;&gt; &gt; Hope this helps.&gt; &gt; Rogan&gt; &gt; _______________________________________________&gt; Owasp-webgoat mailing list&gt; <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">Owasp-webgoat at lists.owasp.org</A>&gt; <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">http://lists.owasp.org/mailman/listinfo/owasp-webgoat</A>
</I>_________________________________________________________________
Check out some new online services at Windows Live Ideas&#8212;so new they haven&#8217;t even been officially released yet.
<A HREF="http://www.msnspecials.in/windowslive/">http://www.msnspecials.in/windowslive/</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20070329/fd349698/attachment.html">http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20070329/fd349698/attachment.html</A> 
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000394.html">[Owasp-webgoat] Wikto and Google API key problem
</A></li>
	<LI>Next message: <A HREF="000389.html">[Owasp-webgoat] Assistance with WebGoat v5: &quot;How to hijack a session&quot;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#385">[ date ]</a>
              <a href="thread.html#385">[ thread ]</a>
              <a href="subject.html#385">[ subject ]</a>
              <a href="author.html#385">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
