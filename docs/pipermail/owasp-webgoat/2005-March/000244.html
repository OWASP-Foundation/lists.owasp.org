<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-WEBGOAT]Weak Session ID lesson
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DWeak%20Session%20ID%20lesson&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000241.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-WEBGOAT]Weak Session ID lesson</H1>
    <B>lists at dawes.za.net</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DWeak%20Session%20ID%20lesson&In-Reply-To="
       TITLE="[OWASP-WEBGOAT]Weak Session ID lesson">lists at dawes.za.net
       </A><BR>
    <I>Wed Mar 30 17:45:55 EST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000241.html">[OWASP-WEBGOAT]startup script
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#244">[ date ]</a>
              <a href="thread.html#244">[ thread ]</a>
              <a href="subject.html#244">[ subject ]</a>
              <a href="author.html#244">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi folks,

Here is my first stab at the lesson. It show up as &quot;Predictable Session
Identifier&quot; under &quot;Broken Authentication and Session Management&quot;.

Using WebScarab to sample cookies should show you a pattern of

WG_SESSIONID=(ddddd)(ddddddddddd)

where the two parts increment independently

The first part is a 5 digit sequence number, incremented by 1 each time a
cookie
is requested. The second part is the time in milliseconds divided by 10.

Every now and then, you should see the first sequence skip a number. This
indicates that &quot;someone else&quot; has logged in, and was allocated that sequence
number. Now the only variable is the time.

We know that the time is purely increasing. So the target time value is
somewhere between the value in the cookie we received before, and the cookie we
received afterwards. If we are using WebScarab to sample cookies, the time
range
will be pretty small (about 10-20 possible values), particularly if the server
is local.

You can then either use the proxy manual intercept method to insert the values
one after the other (tedious), or you can use the &quot;Scripted&quot; plugin to test
them automatically.

A successful guess will not include the string &quot;Please sign in to your
account&quot;,
and can be tested quite easily.

Please let me know what you think.

Regards,

Rogan
-------------- next part --------------
A non-text attachment was scrubbed...
Name: WeakSessionID.java
Type: text/x-java
Size: 8218 bytes
Desc: not available
Url : <A HREF="http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20050330/611179dc/attachment.bin">http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20050330/611179dc/attachment.bin</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000241.html">[OWASP-WEBGOAT]startup script
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#244">[ date ]</a>
              <a href="thread.html#244">[ thread ]</a>
              <a href="subject.html#244">[ subject ]</a>
              <a href="author.html#244">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
