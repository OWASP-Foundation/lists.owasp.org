<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-WEBGOAT]Predictable cookie lesson
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DPredictable%20cookie%20lesson&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000240.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-WEBGOAT]Predictable cookie lesson</H1>
    <B>Rogan Dawes</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DPredictable%20cookie%20lesson&In-Reply-To="
       TITLE="[OWASP-WEBGOAT]Predictable cookie lesson">lists at dawes.za.net
       </A><BR>
    <I>Tue Mar 29 09:37:33 EST 2005</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000240.html">[OWASP-WEBGOAT]Creating lessons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#243">[ date ]</a>
              <a href="thread.html#243">[ thread ]</a>
              <a href="subject.html#243">[ subject ]</a>
              <a href="author.html#243">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi folks,

I am wanting to demonstrate brute forcing a weak session cookie in 
webscarab.

My idea is to have webgoat &quot;reserve&quot; every n'th cookie (where n is a 
preselected number, e.g. 29), and respond with a &quot;Congratulations&quot; page.

i.e. the user requests the lesson page, without a cookie. Webgoat issues 
a cookie based on a simple algorithm, e.g. incrementing a counter, and 
using the time in 10th's of a second, base64 encoded. The page itself 
looks like a login screen.

i.e.

Cookie1 = Base64Enc(Seq++ + &quot;:&quot; + time)
Cookie2 = Base64Enc(Seq++ + &quot;:&quot; + time)

BUT, if seq mod n == 0 increment seq (to provide a target)

Then, if the user requests a page with a (ANY) cookie, simply reshow the 
login screen, UNLESS:

The (cookie sequence number mod n)== 0 AND (cookie time mod n) == 0. If 
so, then show the user a &quot;SUCCESS&quot; page.

The idea is that the user will sample the cookies with WebScarab's 
sessionid plugin, graph the results, and see a pattern of incrementing 
values. Looking at the parts separately, they should see that there are 
two independent &quot;counters&quot;. One increments for each request, one 
increments based on the time between requests. Every n'th request 
results in a skip, where &quot;another user&quot; has accessed the site.

Identifying the missing value in the simple counter indicates a 
sessionID that has been allocated to a &quot;different user&quot;. Brute forcing 
the time value in the space using the webscarab &quot;scripted&quot; plugin gets 
the user access to the &quot;different user&quot;.

The reason I am using a simple &quot;mod n&quot; approach is to eliminate having 
to actually store valid session identifiers somewhere. This can lead to 
multiple values matching in a time interval, if the time mod n value is 
greater than the gap between known cookies. This is probably not really 
significant. More of a problem would be if the time gap is too small, 
that the time mod n does not fall within the gap allowed.

This could be improved if we actually record the sessionid's &quot;allocated&quot; 
as targets. I have no idea if this is possible, given the stateless 
nature of a web app? The list of allocated id's could be expired every 5 
minutes, or limited to 100 or so long, or similar.

What do you think? How difficult would this be to implement?

Rogan

P.S. Please include me in your replies, as I am not subscribed to this list.
-- 
Rogan Dawes

*ALL* messages to <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">discard at dawes.za.net</A> will be dropped, and added
to my blacklist. Please respond to &quot;lists AT dawes DOT za DOT net&quot;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000240.html">[OWASP-WEBGOAT]Creating lessons
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#243">[ date ]</a>
              <a href="thread.html#243">[ thread ]</a>
              <a href="subject.html#243">[ subject ]</a>
              <a href="author.html#243">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
