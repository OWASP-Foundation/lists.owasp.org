From radioon49 at hotmail.com  Tue Dec  4 05:18:50 2007
From: radioon49 at hotmail.com (ChoiPrisca)
Date: Tue, 4 Dec 2007 19:18:50 +0900
Subject: [Owasp-webgoat] Can Web Application Firewalls detect "parameter
	elimination"?
Message-ID: <BAY122-W8668746284A74F5535DC4B26D0@phx.gbl>


Is it possible to detect "parameter elimination" by WAF?
 
I tested a WAF to see if the WAF detects when I deleted the password parameter of request.
It didn't detect and the engineer of the WAF said it's not possible to detect because web application sent 200 OK sign to the WAF.
 
The web application that I used was Webgoat 5.0.
(Improper Error Handling -> How to Bypass a Fail Open Authentication Scheme)
 
Can anybody help?
 
Thank you
 
Prisca
_________________________________________________________________
MSN ???? ??? ??, Windows Live Messenger!
http://windowslive.msn.co.kr/wlm/messenger/

From lists at dawes.za.net  Tue Dec  4 05:23:23 2007
From: lists at dawes.za.net (Rogan Dawes)
Date: Tue, 04 Dec 2007 02:23:23 -0800
Subject: [Owasp-webgoat] Can Web Application Firewalls detect "parameter
 elimination"?
In-Reply-To: <BAY122-W8668746284A74F5535DC4B26D0@phx.gbl>
References: <BAY122-W8668746284A74F5535DC4B26D0@phx.gbl>
Message-ID: <47552A9B.3040708@dawes.za.net>

ChoiPrisca wrote:
> Is it possible to detect "parameter elimination" by WAF?
>  
> I tested a WAF to see if the WAF detects when I deleted the password parameter of request.
> It didn't detect and the engineer of the WAF said it's not possible to detect because web application sent 200 OK sign to the WAF.
>  
> The web application that I used was Webgoat 5.0.
> (Improper Error Handling -> How to Bypass a Fail Open Authentication Scheme)
>  
> Can anybody help?
>  
> Thank you
>  
> Prisca

If the WAF is relying on the application sending an error code to the
user, and only intercepting that, the WAF is entirely worthless!

At this stage, the app has already been compromised!

In order to be effective, the WAF needs to proactively verify that the
parameters do not contain any attacks *BEFORE* passing the request on to
the application, not afterwards.

Given sufficient configuration, there is no reason that a WAF should not
detect missing parameters. For example, given a rule that a POST to a
particular login URL should have a username and password parameter, the
WAF can easily check to ensure that those parameters are in fact there.

To be quite honest, I'd fire your WAF vendor in a hurry if this is how
it operates!

Rogan

From radioon49 at hotmail.com  Tue Dec  4 06:18:44 2007
From: radioon49 at hotmail.com (ChoiPrisca)
Date: Tue, 4 Dec 2007 20:18:44 +0900
Subject: [Owasp-webgoat] Can Web Application Firewalls detect "parameter
 elimination"?
In-Reply-To: <47552A9B.3040708@dawes.za.net>
References: <BAY122-W8668746284A74F5535DC4B26D0@phx.gbl>
	<47552A9B.3040708@dawes.za.net>
Message-ID: <BAY122-W16AE49941F811C40FB8B0FB26D0@phx.gbl>


Sorry I forgot to tell one more thing
 
The address of that web application is like this :
 http://TESTSITE/WebGoat/attack?Screen=49&menu=710
 
Is it possible to detect "parameter elimination" when the address is like above?
 
 
Thank you, Rogan and everyone
 
> Date: Tue, 4 Dec 2007 02:23:23 -0800> From: lists at dawes.za.net> To: radioon49 at hotmail.com> CC: owasp-webgoat at lists.owasp.org> Subject: Re: [Owasp-webgoat] Can Web Application Firewalls detect "parameter elimination"?> > ChoiPrisca wrote:> > Is it possible to detect "parameter elimination" by WAF?> > > > I tested a WAF to see if the WAF detects when I deleted the password parameter of request.> > It didn't detect and the engineer of the WAF said it's not possible to detect because web application sent 200 OK sign to the WAF.> > > > The web application that I used was Webgoat 5.0.> > (Improper Error Handling -> How to Bypass a Fail Open Authentication Scheme)> > > > Can anybody help?> > > > Thank you> > > > Prisca> > If the WAF is relying on the application sending an error code to the> user, and only intercepting that, the WAF is entirely worthless!> > At this stage, the app has already been compromised!> > In order to be effective, the WAF needs to proactively verify that the> parameters do not contain any attacks *BEFORE* passing the request on to> the application, not afterwards.> > Given sufficient configuration, there is no reason that a WAF should not> detect missing parameters. For example, given a rule that a POST to a> particular login URL should have a username and password parameter, the> WAF can easily check to ensure that those parameters are in fact there.> > To be quite honest, I'd fire your WAF vendor in a hurry if this is how> it operates!> > Rogan
_________________________________________________________________
???? ??? ??? ?? ??, Live Search!
http://search.live.com

From lists at dawes.za.net  Tue Dec  4 06:25:34 2007
From: lists at dawes.za.net (Rogan Dawes)
Date: Tue, 04 Dec 2007 03:25:34 -0800
Subject: [Owasp-webgoat] Can Web Application Firewalls detect "parameter
 elimination"?
In-Reply-To: <BAY122-W16AE49941F811C40FB8B0FB26D0@phx.gbl>
References: <BAY122-W8668746284A74F5535DC4B26D0@phx.gbl>	<47552A9B.3040708@dawes.za.net>
	<BAY122-W16AE49941F811C40FB8B0FB26D0@phx.gbl>
Message-ID: <4755392E.90909@dawes.za.net>

ChoiPrisca wrote:
> Sorry I forgot to tell one more thing
>  
> The address of that web application is like this :
>  http://TESTSITE/WebGoat/attack?Screen=49&menu=710
>  
> Is it possible to detect "parameter elimination" when the address is like above?
>  
>  
> Thank you, Rogan and everyone

Yes, of course.

It should make no difference whether the parameters are in the URL, a
cookie (or other header) or in the POST body, if the WAF has been
suitably configured, it should be able to verify existence of the
combination of parameters.

Rogan

