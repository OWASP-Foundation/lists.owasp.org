<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-webgoat] stealthy client-side DOM-based	cross-site	scripting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20stealthy%20client-side%20DOM-based%0A%09cross-site%09scripting&In-Reply-To=930fd0230904150256v28e1d211u980b7b31c9c8531a%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000573.html">
   <LINK REL="Next"  HREF="000575.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-webgoat] stealthy client-side DOM-based	cross-site	scripting</H1>
    <B>gregory at is.naist.jp</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20stealthy%20client-side%20DOM-based%0A%09cross-site%09scripting&In-Reply-To=930fd0230904150256v28e1d211u980b7b31c9c8531a%40mail.gmail.com"
       TITLE="[Owasp-webgoat] stealthy client-side DOM-based	cross-site	scripting">gregory at is.naist.jp
       </A><BR>
    <I>Wed Apr 15 08:36:41 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000573.html">[Owasp-webgoat] stealthy client-side DOM-based cross-site	scripting
</A></li>
        <LI>Next message: <A HREF="000575.html">[Owasp-webgoat] stealthy client-side	DOM-basedcross-site	scripting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#574">[ date ]</a>
              <a href="thread.html#574">[ thread ]</a>
              <a href="subject.html#574">[ subject ]</a>
              <a href="author.html#574">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Stephan,

I actually I read the paper of Ryan Barnett published at BH-DC09 on your work. It was
very inspiring for me as I am researching on the subject. Actually, I understand the fact
that it is difficult to provide a realistic environment and that is why I try as much as possible
creating attack websites with links that a victim would click in order to carry out  attacks on
WebGoat. 

However, my point here is that the incriminated lesson (AJAX security/Lab: DOM-based Cross-site
scripting) might be difficult to understand. The whole idea of DOM-based XSS is summarized
as an user inputting malicious payload to own herself. That is why one can get confused.
And it confuses me because it suggests that DOM-based is ultimately stealthy as it never
reaches the server. Is it true? I have never encountered such flavor though you can
find some circumvention techniques that would truncate some of the payload (usually the most
characteristic part) using characters such as #. 
(see <A HREF="http://www.thespanner.co.uk/2008/12/01/location-based-xss-attacks/">http://www.thespanner.co.uk/2008/12/01/location-based-xss-attacks/</A> )

IMHO, if there were outside such stealthy DOM-based XSS attacks, there will be no way to mitigate
these on the server side or using a WAF. Maybe someone can enlighten me with some knowledge
I definitely do not have at the moment and that may have gone undetected to my research so far.

Sorry also for the length of my emails, it made these really difficult to understand. Next time I will
make it shorter.

Regards,

Gregory

----- Original Message -----
From: Stephen Craig Evans &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">stephencraig.evans at gmail.com</A>&gt;
Date: Wednesday, April 15, 2009 6:56 pm
Subject: Re: [Owasp-webgoat] stealthy client-side DOM-based cross-site	scripting

&gt;<i> Hi Gregory,
</I>&gt;<i> 
</I>&gt;<i> You might check the WebGoat section of my project,  Securing WebGoat
</I>&gt;<i> using ModSecurity, at:
</I>&gt;<i> <A HREF="http://www.owasp.org/index.php/OWASP_Securing_WebGoat_using_ModSecurity_Project.">http://www.owasp.org/index.php/OWASP_Securing_WebGoat_using_ModSecurity_Project.</A>
</I>&gt;<i> 
</I>&gt;<i> I give some detailed explanations that might supplement what you've 
</I>&gt;<i> seen so far.
</I>&gt;<i> 
</I>&gt;<i> (The project page is at:
</I>&gt;<i> <A HREF="https://www.owasp.org/index.php/Category:OWASP_Securing_WebGoat_using_ModSecurity_Project">https://www.owasp.org/index.php/Category:OWASP_Securing_WebGoat_using_ModSecurity_Project</A>)
</I>&gt;<i> 
</I>&gt;<i> Don't worry, I am not getting paid for page hits :-)
</I>&gt;<i> 
</I>&gt;<i> Off the top of my head, some of the WebGoat lessons simulate the
</I>&gt;<i> demonstration of an attack, mainly because it's necessary, and some
</I>&gt;<i> IMHO take shortcuts - which I documented. In particular, there's a
</I>&gt;<i> lesson with the solution of typing in javascript in the browser's
</I>&gt;<i> address field, which simulates a user that clicks on a malicious link
</I>&gt;<i> in the web page.
</I>&gt;<i> 
</I>&gt;<i> It's impossible for WebGoat to accommodate every browser and browser
</I>&gt;<i> version, so there are going to be some quirks and you have to
</I>&gt;<i> experiment. One good habit is to erase the WebGoat cookies when
</I>&gt;<i> re-trying a lesson, and it's always good practice to switch back and
</I>&gt;<i> forth between at least 2 browsers; e.g. the AJAX lessons worked best
</I>&gt;<i> for me on Windows XP using Opera rather than IE and Firefox.
</I>&gt;<i> 
</I>&gt;<i> Stephen
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Wed, Apr 15, 2009 at 4:16 PM,  &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">gregory at is.naist.jp</A>&gt; wrote:
</I>&gt;<i> &gt; Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I am currently using the version 5.2 of OWASP WebGoat.
</I>&gt;<i> &gt; I am particularly interested in AJAX security and one major XSS 
</I>&gt;<i> threat&gt; is the DOM-based one. However, I wanted to discuss the way 
</I>&gt;<i> the scenario
</I>&gt;<i> &gt; is presented in the lesson AJAX Security/LAB: DOM-based cross-
</I>&gt;<i> site scripting&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; First, because I do not understand the point of this lesson in 
</I>&gt;<i> the way
</I>&gt;<i> &gt; it is explained. It remains unclear how such an attack could 
</I>&gt;<i> occur given the
</I>&gt;<i> &gt; initial parsing of the webserver (removes every &lt;,&gt;,&quot; characters 
</I>&gt;<i> and some others).
</I>&gt;<i> &gt; Usually, DOM-based XSS is particularly prone to be triggered by a 
</I>&gt;<i> fished victim.
</I>&gt;<i> &gt; In this lesson, however, it seems that one should input already 
</I>&gt;<i> the JavaScript code
</I>&gt;<i> &gt; within the browser.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Second, because of that unclear scenario, a beginner may not be 
</I>&gt;<i> able to grab the idea
</I>&gt;<i> &gt; of DOM-based XSS.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Maybe, I am wrong somewhere but I was unable to provide the 
</I>&gt;<i> JavaScript payload without
</I>&gt;<i> &gt; specific characters (such as &lt;,&gt;) and was not able to inject it 
</I>&gt;<i> on the browser, preventing
</I>&gt;<i> &gt; the server side from seeing it, on top of that without the victim 
</I>&gt;<i> doing a thing.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I tried submitting a link which would get parsed by the server 
</I>&gt;<i> removing specific characters.
</I>&gt;<i> &gt; I tried embedding it in an iframe and consequently inject it 
</I>&gt;<i> using JavaScript which does
</I>&gt;<i> &gt; not work since my crafted webpage was not allowed to grab the 
</I>&gt;<i> iframe contents.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I may miss some skills. Can anyone show me a way to conduct such 
</I>&gt;<i> an attack on the WebGoat
</I>&gt;<i> &gt; server in order to illustrate the DOM-based XSS attack since even 
</I>&gt;<i> the yehg.net solution video
</I>&gt;<i> &gt; is merely copy/pasting the payload in the input field (sounds a 
</I>&gt;<i> high level of social engineering
</I>&gt;<i> &gt; for subverting the user into inputting such an obvious payload...).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Regards,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Gregory BLANC.
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-webgoat mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">Owasp-webgoat at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">https://lists.owasp.org/mailman/listinfo/owasp-webgoat</A>
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> <A HREF="http://www.linkedin.com/in/stephencraigevans">http://www.linkedin.com/in/stephencraigevans</A>
</I>&gt;<i> 
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000573.html">[Owasp-webgoat] stealthy client-side DOM-based cross-site	scripting
</A></li>
	<LI>Next message: <A HREF="000575.html">[Owasp-webgoat] stealthy client-side	DOM-basedcross-site	scripting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#574">[ date ]</a>
              <a href="thread.html#574">[ thread ]</a>
              <a href="subject.html#574">[ subject ]</a>
              <a href="author.html#574">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
