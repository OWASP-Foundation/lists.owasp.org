<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-WEBGOAT]Predictable SessionID lesson
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DPredictable%20SessionID%20lesson&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000247.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-WEBGOAT]Predictable SessionID lesson</H1>
    <B>Rogan Dawes</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DPredictable%20SessionID%20lesson&In-Reply-To="
       TITLE="[OWASP-WEBGOAT]Predictable SessionID lesson">lists at dawes.za.net
       </A><BR>
    <I>Thu Apr 14 09:22:43 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000247.html">[OWASP-WEBGOAT]database dump - lesson or admin function?
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#248">[ date ]</a>
              <a href="thread.html#248">[ thread ]</a>
              <a href="subject.html#248">[ subject ]</a>
              <a href="author.html#248">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi folks,

Here is the updated version of my &quot;predictable session id&quot; session

Basically:

Each time you visit the page without supplying a cookie named &quot;WEAKID&quot;, 
a new WEAKID cookie is generated and issued. The value is also returned 
as a hidden field in the reponse body.

Naturally, the algorithm for generating the WEAKID is predictable. It is 
basically a counter (started somewhere between 1000 and 2000) that 
increments on each WEAKID generated, concatenated with the time 
(System.getTimeMillis()). Every so often (currently every 29 requests, I 
think), the lesson generates a WEAKID and stores it in a local list. 
This makes it obvious for an attacker that &quot;someone else&quot; has obtained a 
new sessionid, since the counter skips an item.

The challenge is then for the student to identify one of the WEAKIDs 
that have been stored in the local list. Obviously, the counter value 
can be trivially deduced. And we know that the time value is in between 
the times for the WEAKID on either side of the target.

The student should then brute force the possible values of WEAKID 
(simply incrementing by 1 each time), until they get a page that does 
not have the login form, representing a session that has been 
authenticated by someone else. This concludes the lesson.

Comments are welcome.

Rogan

P.S. While using WebScarab to test and perform this lesson, I found a 
NullPointer exception in session/WebSession.java, brought on by multiple 
simultaneous requests being processed. WebScarab's scripting plugin 
makes it easy to submit parallel requests. Increasing the delay betewen 
requests to about 500ms makes the NullPointerException go away.

    /**
     *  Gets the userName attribute of the WebSession object
     *
     * @return    The userName value
     */
    public String getUserName()
    {
        //System.out.println(&quot;Request: &quot; + getRequest() );
        //System.out.println(&quot;Principal: &quot; + 
getRequest().getUserPrincipal() );
        //System.out.println(&quot;Name: &quot; + 
getRequest().getUserPrincipal().getName( ) );
        return getRequest().getUserPrincipal().getName();        // 
&lt;---- Throws NullPointerException
    }


-------------- next part --------------
An embedded and charset-unspecified text was scrubbed...
Name: WeakSessionID.java
Url: <A HREF="http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20050414/a64ea441/attachment.pl">http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20050414/a64ea441/attachment.pl</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000247.html">[OWASP-WEBGOAT]database dump - lesson or admin function?
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#248">[ date ]</a>
              <a href="thread.html#248">[ thread ]</a>
              <a href="subject.html#248">[ subject ]</a>
              <a href="author.html#248">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
