<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-WEBGOAT]WebGoat Walkthru? (May be a spoiler, so if you	 haven't completed the lessons, you may not want to look at it)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DWebGoat%20Walkthru%3F%20%28May%20be%20a%20spoiler%2C%20so%20if%20you%0A%09%20haven%27t%20completed%20the%20lessons%2C%20you%20may%20not%20want%20to%20look%20at%20it%29&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000201.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-WEBGOAT]WebGoat Walkthru? (May be a spoiler, so if you	 haven't completed the lessons, you may not want to look at it)</H1>
    <B>Dawes, Rogan (ZA - Johannesburg)</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DWebGoat%20Walkthru%3F%20%28May%20be%20a%20spoiler%2C%20so%20if%20you%0A%09%20haven%27t%20completed%20the%20lessons%2C%20you%20may%20not%20want%20to%20look%20at%20it%29&In-Reply-To="
       TITLE="[OWASP-WEBGOAT]WebGoat Walkthru? (May be a spoiler, so if you	 haven't completed the lessons, you may not want to look at it)">rdawes at deloitte.co.za
       </A><BR>
    <I>Thu Nov 20 02:59:20 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="000201.html">[OWASP-WEBGOAT]WebGoat Walkthru? (May be a spoiler, so if you haven't completed the lessons, you may not want to look at it)
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#198">[ date ]</a>
              <a href="thread.html#198">[ thread ]</a>
              <a href="subject.html#198">[ subject ]</a>
              <a href="author.html#198">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Jeremy,
 
You seem to got everything covered so far.
 
In response to a couple of your questions:
 
BUT I FOUND THIS TO BE INTERESTING:  I stopped tomcat (java crash) and
reconnected to webgoat, and look what Tomcat threw out...this was actually
kind of funny... 

&lt;snip&gt; 
Successful connection to null 
http8080-Processor4 DROP TABLE user_data 
http8080-Processor4 CREATE TABLE user_data (userid varchar(5) not null
primary key,first_name varcha 


This is done every time that WebGoat starts up, to make sure that you have a
clean database to work from. Obviously this would not happen in any kind of
production system ;-)

WEAK AUTHENTICATION COOKIE:  This one was neat, because it had a little
crypt-o-gram 
type puzzle (jeff/jeff creates the cookie ggfkggfk whereas dave/dave creates
the 
cookie fwbefwbe, they're reversed and incremented by 1 letter).  This didn't
actually 
buy us anything as far as i can tell, except the 'AuthCookie'.  I logged in
with jeff/jeff and upon logging out, I noticed that the cookie had an
'AuthCookie=ggfkggfk' so I put it in the Cookie field of PenProcy and it
worked:

 

The key to this one is that if you start up webgoat, and supply a cookie of
&quot;ggfkggfk&quot;, without ever trying to authenticate, you will be recognised as
Jeff, and fwbefwbe will get you access to Dave's account. The cookie IS
authentication, by itself.

 

Good going!

Rogan

P.S. to the WebGoat folks, perhaps you might want to mention WebScarab as a
tool that folks can use in their investigations of WebGoat?

 
 

-----Original Message-----
From: Jeremy Junginger [mailto:<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">jj at act.com</A>] 
Sent: 19 November 2003 07:33 PM
To: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">owasp-webgoat at lists.sourceforge.net</A>
Subject: [OWASP-WEBGOAT]WebGoat Walkthru? (May be a spoiler, so if you
haven't completed the lessons, you may not want to look at it)



Hey guys, this is my first post to the group.  I have been getting familiar
with WebGoat and am about to play with the challenges, but I wanted to make
sure I'm on the right track before I continue.  Thanks!

TOOLS USED: 
PenProxy (HTTP Proxy that allows modification of many fields) 
Achilles (Another HTTP Proxy that was suggested) 
HTTrack (Tool for spidering websites) 
FormScalpel (Form manipulation and more) 

WALK-THRU?!?: 

HTTP BASICS:  I looked at this one for a couple hours before I decided it is
just a 
tutorial on HTTP.  
EXPLOIT: N/A (I may have missed something here) 

FAIL OPEN AUTHENTICATION:  This one took forever....the hints led me to
removing the 
password parameter, and &quot;VIEW SOURCE&quot; gave me the author's name &quot;jeff&quot;, so I
tried 
jeff with &quot;jeff&quot; first just to see if it worked, and voila, but more
interesting is 
the fact that if you omit the password parameter completely and supply a
valid 
username (in this case, &quot;jeff&quot;) it authenticates anyways. 
EXPLOIT: 
 &lt;<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=jeff">http://127.0.0.1:8080/WebGoat/attack?Username=jeff</A>&gt;
<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=jeff">http://127.0.0.1:8080/WebGoat/attack?Username=jeff</A> 
or 
 &lt;<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=jeff&amp;Password=jeff">http://127.0.0.1:8080/WebGoat/attack?Username=jeff&amp;Password=jeff</A>&gt;
<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=jeff&amp;Password=jeff">http://127.0.0.1:8080/WebGoat/attack?Username=jeff&amp;Password=jeff</A> 

HTML CLUES:  This was pretty much a gimme.  
&lt;snip&gt; 
    FIXME admin:adminpw 
&lt;/snip&gt; 
EXPLOIT: 
 &lt;<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=admin&amp;Password=adminpw">http://127.0.0.1:8080/WebGoat/attack?Username=admin&amp;Password=adminpw</A>&gt;
<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=admin&amp;Password=adminpw">http://127.0.0.1:8080/WebGoat/attack?Username=admin&amp;Password=adminpw</A> 
which also yields: 
 &lt;<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=jblow&amp;Password=passwd1">http://127.0.0.1:8080/WebGoat/attack?Username=jblow&amp;Password=passwd1</A>&gt;
<A HREF="http://127.0.0.1:8080/WebGoat/attack?Username=jblow&amp;Password=passwd1">http://127.0.0.1:8080/WebGoat/attack?Username=jblow&amp;Password=passwd1</A> 
that also allows you to log in. 

PARAMETER INJECTION:  This one was pretty funny.  It reminded me of the
directory 
traversal/Unicode (ala NIMDA/CR/CR2) exploits.  The &amp;, &amp;&amp;, |, and || can be
used to 
run additional commands that are available in the shell. 
EXPLOIT (examples): 
 &lt;<A HREF="http://127.0.0.1:8080/WebGoat/attack?dir=&amp;ipconfig&amp;netstat">http://127.0.0.1:8080/WebGoat/attack?dir=&amp;ipconfig&amp;netstat</A>&gt;
<A HREF="http://127.0.0.1:8080/WebGoat/attack?dir=&amp;ipconfig&amp;netstat">http://127.0.0.1:8080/WebGoat/attack?dir=&amp;ipconfig&amp;netstat</A> 
or enter the following in the form: 
&amp;ipconfig&amp;netstat&amp;ping 127.0.0.1 

UNCHECKED EMAIL:  I'm not sure I get this one.  I see that you can send
malicious 
html emails, but didn't find much else.  I used: 
EXPLOIT?: 
TO:<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">test at test.xom</A> 
MESSAGE:&lt;A href=&quot;<A HREF="http://www.playboy.com/">http://www.playboy.com/</A> &lt;<A HREF="http://www.playboy.com/">http://www.playboy.com/</A>&gt;
&quot;&gt;<A HREF="http://www.google.com">http://www.google.com</A> &lt;<A HREF="http://www.google.com">http://www.google.com</A>&gt; &lt;/A&gt; 

SQL INJECTION:  This is a subject I am still pretty new at, but I took a
look at &quot;SQL 
Injection&quot; by Kevin Spett of SPI LABS, which led me to try inserting an
&quot;always true&quot; 
statement (1=1): 
EXPLOIT: 
Enter an account number:' or 1=1 
or 
Enter an account number:' or 0=0 
:<i>) 
</I>
THREAD SAFETY:  I used the hints, and saw that if you open the two browsers
(and click fast enough) one users account gets sent to both userids.  Bad
stuff there.  I wouldn't want to see that in production...heheh

WEAK AUTHENTICATION COOKIE:  This one was neat, because it had a little
crypt-o-gram 
type puzzle (jeff/jeff creates the cookie ggfkggfk whereas dave/dave creates
the 
cookie fwbefwbe, they're reversed and incremented by 1 letter).  This didn't
actually 
buy us anything as far as i can tell, except the 'AuthCookie'.  I logged in
with jeff/jeff and upon logging out, I noticed that the cookie had an
'AuthCookie=ggfkggfk' so I put it in the Cookie field of PenProcy and it
worked:

EXPLOIT: 
Using PenProxy, I added 'AuthCookie=ggfkggfk;' to the Cookie field 
BUT I FOUND THIS TO BE INTERESTING:  I stopped tomcat (java crash) and
reconnected to webgoat, and look what Tomcat threw out...this was actually
kind of funny...

&lt;snip&gt; 
Successful connection to null 
http8080-Processor4 DROP TABLE user_data 
http8080-Processor4 CREATE TABLE user_data (userid varchar(5) not null
primary key,first_name varcha 
r(20),last_name varchar(20),cc_number varchar(30),cc_type varchar(10),) 
http8080-Processor4 INSERT INTO user_data VALUES
('101','Joe','Blow','987654321','VISA') 
http8080-Processor4 INSERT INTO user_data VALUES
('101','Joe','Blow','222200001111','MC') 
http8080-Processor4 INSERT INTO user_data VALUES
('102','John','Doe','222200002222','MC') 
http8080-Processor4 INSERT INTO user_data VALUES
('102','John','Doe','222200002222','AMEX') 
http8080-Processor4 INSERT INTO user_data VALUES
('103','Jane','Plane','123456789','MC') 
http8080-Processor4 INSERT INTO user_data VALUES
('103','Jane','Plane','333300003333','AMEX') 
http8080-Processor4 DROP TABLE user_system_data 
http8080-Processor4 CREATE TABLE user_system_data (userid varchar(5) not
null primary key,user_name 
varchar(12),password varchar(10),cookie varchar(30),) 
http8080-Processor4 INSERT INTO user_system_data VALUES
('101','jblow','passwd1', '') 
http8080-Processor4 INSERT INTO user_system_data VALUES
('102','jdoe','passwd2', '') 
http8080-Processor4 INSERT INTO user_system_data VALUES
('103','jplane','passwd3', '') 
http8080-Processor4 INSERT INTO user_system_data VALUES
('104','jeff','jeff', '') 
http8080-Processor4 INSERT INTO user_system_data VALUES
('105','dave','dave', '') 
http8080-Processor4 DROP TABLE product_system_data 
http8080-Processor4 CREATE TABLE product_system_data (productid varchar(6)
not null primary key,prod 
uct_name varchar(20),price varchar(10),) 
http8080-Processor4 INSERT INTO product_system_data VALUES ('32226','Dog
Bone','$1.99') 
http8080-Processor4 INSERT INTO product_system_data VALUES ('35632','DVD
Player','$214.99') 
http8080-Processor4 INSERT INTO product_system_data VALUES ('24569','60 GB
Hard Drive','$149.99') 
http8080-Processor4 INSERT INTO product_system_data VALUES ('56970','80 GB
Hard Drive','$179.99') 
http8080-Processor4 INSERT INTO product_system_data VALUES ('14365','56 inch
HDTV','$6999.99') 
http8080-Processor4 DROP TABLE messages 
http8080-Processor4 CREATE TABLE messages (num int not null primary
key,title varchar(50),message va 
rchar(1000),) 
Success: creating tables. 
Successfully refreshed the database. 
Wed Nov 19 11:05:08 GMT-07:00 2003 | x.x.x:x.x.x.x | WelcomeScreen | 
[Username=jeff,Password=jeff] 
&lt;/snip&gt; 
(Is that cheating?  I think it may be) 

DATABASE XSS:  I just tried standard java &quot;alert&quot; messages, and found that
if you put the following in the message field and view it, it runs the code.

EXPLOIT: 
Message: &lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt;alert(&quot;Put
Malware Here&quot;);&lt;/script&gt; 
(Then click on message to view) 

HIDDEN FIELD TAMPERING:  I think I'm missing something here.  I saw that you
can just pass the price parameter as any number you want, so I just modified
the price parameter and got a television for .01, what a bargain!

EXPLOIT: 
 &lt;<A HREF="http://10.40.32.111:8080/WebGoat/attack?Price=.01">http://10.40.32.111:8080/WebGoat/attack?Price=.01</A>&gt;
<A HREF="http://10.40.32.111:8080/WebGoat/attack?Price=.01">http://10.40.32.111:8080/WebGoat/attack?Price=.01</A> 

WEAK ACCESS CONTROL (SHOULD BE DIRECTORY TRAVERSAL?): All I could find on
this one was that it allowed directory traversal.  Pretty much trial and
error on this one.  Anyone find this another way?

EXPLOIT: 
Filename:../ 
or 
Filename:../../ 
grants access to TOP SECRET stuff. 

CHALLENGES:  I am getting ready to work on these.  But I wanted to make sure
I haven't overlooked any obvious stuff in the above exercises.  Thanks for
your input on this, and have a great day!

-Jeremy 

  

This e-mail message and all attachments transmitted with it may be
confidential and are intended solely for the addressee(s). If you are not
the intended recipient or the person responsible for delivering it to the
intended recipient, you are hereby notified that any reading, dissemination,
distribution, copying, or other use of this message or its attachment(s) is
strictly prohibited.  If you receive this email in error, please immediately
notify the sender of the message or Best Software, Inc. by e-mailing
<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">postmaster at bestsoftware.com</A> and destroy all copies of this message.  Best
Software, for the protection of our internal systems and those of our
customers, does block most email attachments.


Important Notice: This email is subject to important restrictions, qualifications and disclaimers (&quot;the Disclaimer&quot;) that must be accessed and read by clicking here or by copying and pasting the following address into your Internet browser's address bar: <A HREF="http://www.Deloitte.co.za/Disc.htm.">http://www.Deloitte.co.za/Disc.htm.</A> The Disclaimer is deemed to form part of the content of this email in terms of Section 11 of the Electronic Communications and Transactions Act, 25 of 2002. If you cannot access the Disclaimer, please obtain a copy thereof from us by sending an email to <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">ClientServiceCentre at Deloitte.co.za.</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20031120/45b2ef0f/attachment.html">http://lists.owasp.org/pipermail/owasp-webgoat/attachments/20031120/45b2ef0f/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000201.html">[OWASP-WEBGOAT]WebGoat Walkthru? (May be a spoiler, so if you haven't completed the lessons, you may not want to look at it)
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#198">[ date ]</a>
              <a href="thread.html#198">[ thread ]</a>
              <a href="subject.html#198">[ subject ]</a>
              <a href="author.html#198">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
