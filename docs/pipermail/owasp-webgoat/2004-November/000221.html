<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-WEBGOAT]Re: Looking for a Web Application Vulnerable to XSS Cookie Grab
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DRe%3A%20Looking%20for%20a%20Web%20Application%20Vulnerable%20to%20XSS%20Cookie%20Grab&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-WEBGOAT]Re: Looking for a Web Application Vulnerable to XSS Cookie Grab</H1>
    <B>Jeff Williams</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOWASP-WEBGOAT%5DRe%3A%20Looking%20for%20a%20Web%20Application%20Vulnerable%20to%20XSS%20Cookie%20Grab&In-Reply-To="
       TITLE="[OWASP-WEBGOAT]Re: Looking for a Web Application Vulnerable to XSS Cookie Grab">jeff.williams at aspectsecurity.com
       </A><BR>
    <I>Sat Nov  6 17:16:06 EST 2004</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#221">[ date ]</a>
              <a href="thread.html#221">[ thread ]</a>
              <a href="subject.html#221">[ subject ]</a>
              <a href="author.html#221">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>WebGoat has lessons on both stored and reflected XSS. You can use the
reflected XSS lessons to do what you want to do simply by sending your
victim an email that has a link exploiting the vulnerable page in WebGoat.

The stored XSS lesson used to work the way you want, with all users messages
going into a single list.  But it was confusing for students who want to
test with *their* messages only.  If you'd like the multi-user behavior, you
can change StoredXss.java in the makeList method as follows...
ResultSet results = statement.executeQuery( STANDARD_QUERY + &quot; WHERE user =
'&quot; + s.getUserName() + &quot;'&quot; );

to

ResultSet results = statement.executeQuery( STANDARD_QUERY );

--Jeff

----- Original Message ----- 
From: &quot;CFW&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">cfw_security at comcast.net</A>&gt;
To: &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">webappsec at securityfocus.com</A>&gt;
Sent: Friday, November 05, 2004 4:33 PM
Subject: Looking for a Web Application Vulnerable to XSS Cookie Grab


&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i>     I am setting up a lab to learn about web application security and I
</I>&gt;<i> have been messing with WebGoat and Foundstone's HacmeBank and found them
</I>&gt;<i> to be very useful learning tools.  One thing lacking in them (from what
</I>&gt;<i> I can tell) is a multiuser, XSS Cookie Grabbing example.
</I>&gt;<i>
</I>&gt;<i>     Basically, I would like to have a little application (or part of one
</I>&gt;<i> of these applications) that one (malicious) user can log in to and post
</I>&gt;<i> a XSS cookie grabber to a forum or guestbook or something.  Then, the
</I>&gt;<i> attacker fires up a listener until another user logs in and hits the
</I>&gt;<i> script, sending the cookies to the listener.  Then, the first user can
</I>&gt;<i> change his cookies, and see clearly that the web application thinks it
</I>&gt;<i> is the second user.  Does anyone know of such an application?
</I>&gt;<i>
</I>&gt;<i>     The Foundstone Hacme Bank is almost there in that it has a &quot;Post
</I>&gt;<i> Message&quot; section that is vulnerable to XSS, but it is set up so that
</I>&gt;<i> each user sees only their own messages, so it is not possible to post a
</I>&gt;<i> malicious script to someone else.  If the Foundstone people are reading
</I>&gt;<i> this, have you considered changing this behavior?
</I>&gt;<i>
</I>&gt;<i>     While I am asking, are there any other web applications like these
</I>&gt;<i> that I should set up?  I looked at WebMaven, but it looks like that has
</I>&gt;<i> been overtaken by Hacme and Webgoat (correct me if I am wrong).  Someone
</I>&gt;<i> mentioned a while back on pen-test that you could use an old version of
</I>&gt;<i> PHP-Nuke as a vulnerable site since it has a lot of known issues.  Has
</I>&gt;<i> anyone done this and have any hints on what version is the most useful
</I>&gt;<i> in this respect (most vulnerable I guess)?
</I>&gt;<i>
</I>&gt;<i>     Thanks a bunch and have a good weekend.
</I>&gt;<i>
</I>&gt;<i> Chuck
</I>


</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#221">[ date ]</a>
              <a href="thread.html#221">[ thread ]</a>
              <a href="subject.html#221">[ subject ]</a>
              <a href="author.html#221">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
