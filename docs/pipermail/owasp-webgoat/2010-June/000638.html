<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-webgoat] O2 Platform support for WebGoat
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20O2%20Platform%20support%20for%20WebGoat&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-webgoat] O2 Platform support for WebGoat</H1>
    <B>dinis cruz</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20O2%20Platform%20support%20for%20WebGoat&In-Reply-To="
       TITLE="[Owasp-webgoat] O2 Platform support for WebGoat">dinis.cruz at owasp.org
       </A><BR>
    <I>Tue Jun 29 07:31:25 EDT 2010</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#638">[ date ]</a>
              <a href="thread.html#638">[ thread ]</a>
              <a href="subject.html#638">[ subject ]</a>
              <a href="author.html#638">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi WebGoat Crowd

I finally started adding support for WebGoat to the OWASP O2
Platform&lt;<A HREF="http://www.owasp.org/index.php/OWASP_O2_Platform">http://www.owasp.org/index.php/OWASP_O2_Platform</A>&gt; by
creating an API for Web Goat and showing how to automate a number of
WebGoat's tasks and lessons. I've started to documentat how to use it and
how it works, which you can read it (or watch the video) here:
<A HREF="http://o2platform.com/wiki/WebGoat/First_Example_of_O2_WebGoat_API">http://o2platform.com/wiki/WebGoat/First_Example_of_O2_WebGoat_API</A>

At the moment there is a first pass at an API for WebGoat (see
API_WebGoat.cs) and a number of Unit Tests (see WebGoat_BlackBox_Exploits.cs).
Both these files are available locally when you install the O2
Platform&lt;<A HREF="http://o2platform.googlecode.com/files/OWASP%20O2%20Platform%20%28v1.0%20Beta%29.msi">http://o2platform.googlecode.com/files/OWASP%20O2%20Platform%20%28v1.0%20Beta%29.msi</A>&gt;
and
the WebGoat_BlackBox_Exploits.cs can be executed by double-clicking on it or
dragging'n'dropping it into a loaded O2 instance (see video for an example)

So far the following browser-driven UnitTests/WebAutomation workflows have
been implemented:

   - Download the latest version of WebGoat (starting in the OWASP website
   and ending with the download 'save as' pop-up from Google Code)
   - Start a local copy of WebGoat
   - Open the WebGoat HomePage (with support for auto submitting the
   WebGoat's Basic Auth requirement (using guest:guest), and clicking on the
   'Start WebGoat' button)
   - Complete the Lab: &quot;Cross-Site Scripting (XSS) --&gt; LAB: Cross Site
   Scripting --&gt; Stage 1: Stored XSS &quot; using two injection points: the
   &quot;address1&quot; field (which is vulnerable to XSS) and the &quot;description&quot; field
   (which is NOT vulnerable to XSS)

The Stored XSS lesson is a good example of O2's powerful web automation
capabilities (using WatiN's engine on top of IE) since it shows how complex
web workflows can be easily created, tested and packaged:

    	    	[Test]
    	    	public string Exploit_Stage_1_Stored_XSS_OK()
    	    	{
    	     		return Exploit_Stage_1_Stored_XSS(&quot;address1&quot;);
		}

		
		[Test]
		public string Exploit_Stage_1_Stored_XSS_Fail()
		{
			return Exploit_Stage_1_Stored_XSS(&quot;description&quot;);
		}
				
		private string Exploit_Stage_1_Stored_XSS(string fieldToInsertPayload)
		{
			setup();
			var payload = &quot;&lt;a href=\&quot;\&quot;
onMouseOver=\&quot;javascript:alert('xss')\&quot;&gt;Over me to see xss&lt;/a&gt;&quot;;
			webGoat.openMainPage();
			ie.link(&quot;Cross-Site Scripting (XSS)&quot;).flash().click();
			ie.link(&quot;LAB: Cross Site Scripting&quot;).flash().click();			
			ie.link(&quot;Stage 1: Stored XSS&quot;).flash();
			ie.field(&quot;password&quot;).flash().value(&quot;larry&quot;);
			ie.button(&quot;Login&quot;).flash().click();
			ie.selectLists()[1].options()[0].select().flash();
			ie.button(&quot;ViewProfile&quot;).flash().click();
			ie.button(&quot;EditProfile&quot;).flash().click(); 			
			ie.field(fieldToInsertPayload).value(payload).flash();			
			ie.button(&quot;UpdateProfile&quot;).flash().click(); 			
			Assert.That(ie.html().contains(&quot;onmouseover=\&quot;javascript:alert('xss')\&quot;&quot;),
&quot;Payload was not inserted into page&quot;);
			return &quot;ok&quot;;
		}


The sample code above (from WebGoat_BlackBox_Exploits.cs is designed to be
easy to read and write/test (using one of O2's
development/test environments).

For example:

	*ie.link(&quot;LAB: Cross Site Scripting&quot;).flash().click();*

will:


   - in the current page, find the link called &quot;Lab: Cross Site Scripting&quot;
   - flash the link 3 times (i.e. scroll the browser to the current
page location of the link (which could be outside the user's view) and
set its background color to yellow for a couple seconds)
   - click on the link
   - wait for the linked page to load completely before continuing execution


	*ie.field(&quot;password&quot;).flash().value(&quot;larry&quot;);*

will:


   - find the field called &quot;password&quot; in the current page
   - flash it 3 times
   - set the value of the field to &quot;larry&quot;

	*ie.selectLists()[1].options()[0].select().flash();*

will:


   - get a list of 'Selection Lists' from the current page (these are
also called DropDownList/ComboBox)
   - select the 2nd SelectionList (we couldn't get the reference using
the name since its HtmlElement didn't seem to have a value that could
be used to find it)
   - get the current Options of the chosen SelectionList (this is the
list of the DropDownList options/values)
   - chose the first option and selected it
   - Flash the selected option so the user can see which one we chose



Hopefully this all makes sense, and you (webGoat community) can now
continue this from here.

Ideally we should have all WebGoat Lessons mapped using these Security
UnitTests, and once that is done, create a 'secure version of WebGoat'
that passes all those UnitTests (assuming the UnitTests are designed
to succeed when the vulnerability was exploited)

Please have a go and let me know if you have any problems or ideas on
how to improve it (see the video on
<A HREF="http://o2platform.com/wiki/WebGoat/First_Example_of_O2_WebGoat_API">http://o2platform.com/wiki/WebGoat/First_Example_of_O2_WebGoat_API</A> if
you have questions on how to use the WebGoat_BlackBox_Exploits.cs
script)

Dinis Cruz

Blog: <A HREF="http://diniscruz.blogspot.com">http://diniscruz.blogspot.com</A>
Twitter: <A HREF="http://twitter.com/DinisCruz">http://twitter.com/DinisCruz</A>
Web: <A HREF="http://www.owasp.org/index.php/O2">http://www.owasp.org/index.php/O2</A>
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#638">[ date ]</a>
              <a href="thread.html#638">[ thread ]</a>
              <a href="subject.html#638">[ subject ]</a>
              <a href="author.html#638">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
