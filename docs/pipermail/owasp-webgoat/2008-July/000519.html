<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-webgoat] WebGoat 5.2, data layer access control fix
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20WebGoat%205.2%2C%20data%20layer%20access%20control%20fix&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000518.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-webgoat] WebGoat 5.2, data layer access control fix</H1>
    <B>Zhou, Yan</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20WebGoat%205.2%2C%20data%20layer%20access%20control%20fix&In-Reply-To="
       TITLE="[Owasp-webgoat] WebGoat 5.2, data layer access control fix">yzhou at medplus.com
       </A><BR>
    <I>Tue Jul 29 09:12:50 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000518.html">[Owasp-webgoat] Java version in 5.2 standard
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#519">[ date ]</a>
              <a href="thread.html#519">[ thread ]</a>
              <a href="subject.html#519">[ subject ]</a>
              <a href="author.html#519">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there, 

 

1). The solution from WebGoat suggests the following for fixing data
layer access control. 

 

However, I thought that only one of them is sufficient,  either the
function call or the SQL access would do the job, not both. Am I missing
something?

 

                  if (isAuthorizedForEmployee(s, userId, subjectUserId))

                  {     ...

                        //String query = &quot;SELECT * FROM employee WHERE
userid = &quot; + subjectUserId;

                        String query = &quot;SELECT * FROM employee,ownership
WHERE employee.userid = ownership.employee_id and &quot; +

                                    &quot;ownership.employer_id = &quot; + userId
+ &quot; and ownership.employee_id = &quot; + subjectUserId;      // STAGE 4 - FIX

                        ...

                  }     

                  else

                  {

                        throw new UnauthorizedException();

                  }

 

2) How can I get SQL access to the data model, I was not able to find
any instructions on browsing through the database tables directly. 

 

Thanks, 

Yan Zhou

 











Confidentiality Notice: The information contained in this electronic transmission is confidential and may be legally privileged. It is intended only for the addressee(s) named above. If you are not an intended recipient, be aware that any disclosure, copying, distribution or use of the information contained in this transmission is prohibited and may be unlawful. If you have received this transmission in error, please notify us by telephone (513) 229-5500 or by email (<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">postmaster at MedPlus.com</A>). After replying, please erase it from your computer system.



</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000518.html">[Owasp-webgoat] Java version in 5.2 standard
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#519">[ date ]</a>
              <a href="thread.html#519">[ thread ]</a>
              <a href="subject.html#519">[ subject ]</a>
              <a href="author.html#519">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
