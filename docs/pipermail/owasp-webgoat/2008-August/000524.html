<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-webgoat] Screen parameter values change for every new session
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20Screen%20parameter%20values%20change%20for%20every%20new%0A%20session&In-Reply-To=48A5187F.70603%40zhaw.ch">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000523.html">
   <LINK REL="Next"  HREF="000526.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-webgoat] Screen parameter values change for every new session</H1>
    <B>Rogan Dawes</B> 
    <A HREF="mailto:owasp-webgoat%40lists.owasp.org?Subject=%5BOwasp-webgoat%5D%20Screen%20parameter%20values%20change%20for%20every%20new%0A%20session&In-Reply-To=48A5187F.70603%40zhaw.ch"
       TITLE="[Owasp-webgoat] Screen parameter values change for every new session">lists at dawes.za.net
       </A><BR>
    <I>Fri Aug 15 02:02:00 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000523.html">[Owasp-webgoat] Screen parameter values change for every new session
</A></li>
        <LI>Next message: <A HREF="000526.html">[Owasp-webgoat] Log spoofing attack in WebGoat
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#524">[ date ]</a>
              <a href="thread.html#524">[ thread ]</a>
              <a href="subject.html#524">[ subject ]</a>
              <a href="author.html#524">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Marc Rennhard wrote:
&gt;<i> Hi Stephen,
</I>&gt;<i> 
</I>&gt;<i> thanks for your comment.
</I>&gt;<i> 
</I>&gt;<i> I actually found a solution that seems to work. I &quot;fixed&quot; the developer
</I>&gt;<i> version for myself so it always uses the same Screen-IDs for different
</I>&gt;<i> sessions and users. The ID depends on a hash over the classname and is
</I>&gt;<i> therefore not dependant on the sequence the lessions are parsed (e.g. if
</I>&gt;<i> lessons are added or removed). Attached you find code:
</I>&gt;<i> 
</I>&gt;<i> public AbstractLesson()
</I>&gt;<i> {
</I>&gt;<i>     //id = new Integer(++count);
</I>&gt;<i>     /*
</I>&gt;<i>      * Create the id based on a hash over the class name so we have
</I>&gt;<i>      * always the same id in every session
</I>&gt;<i>      */
</I>&gt;<i>     try {
</I>&gt;<i>         String className = getClass().getName();
</I>&gt;<i>         byte[] classNameBytes = className.getBytes();
</I>&gt;<i>         MessageDigest md = MessageDigest.getInstance(&quot;SHA-1&quot;);
</I>&gt;<i>         byte[] sha1hash = new byte[40];
</I>&gt;<i>         md.update(classNameBytes);
</I>&gt;<i>         sha1hash = md.digest();
</I>&gt;<i> 
</I>&gt;<i>         // Set leading bit to zero and convert first 4 bytes to int
</I>&gt;<i>         sha1hash[0] &amp;= 127;
</I>&gt;<i>         id = sha1hash[0] * 256 * 256 * 256 + sha1hash[1] * 256 * 256 +
</I>&gt;<i> sha1hash[2] * 256 + sha1hash[3];
</I>&gt;<i>         //System.out.println(className + &quot;, &quot; + id);
</I>&gt;<i>     } catch (Exception e) {
</I>&gt;<i>     }
</I>&gt;<i> }
</I>&gt;<i> 
</I>&gt;<i> In theory, there's a small chance of a collision as the first four bytes
</I>&gt;<i> in the hash may be equal for two different lessons. Since it was no
</I>&gt;<i> issue with the current WebGoat release, I didn't address that.
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Marc
</I>
Not a bad solution.

Your other alternative is to make the HTML page a JSP, and get the 
lesson ID by iterating over the lessons until you find the right one, 
then calling its getID() method.

Shout if you need any help with this.

Rogan

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000523.html">[Owasp-webgoat] Screen parameter values change for every new session
</A></li>
	<LI>Next message: <A HREF="000526.html">[Owasp-webgoat] Log spoofing attack in WebGoat
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#524">[ date ]</a>
              <a href="thread.html#524">[ thread ]</a>
              <a href="subject.html#524">[ subject ]</a>
              <a href="author.html#524">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-webgoat">More information about the Owasp-webgoat
mailing list</a><br>
</body></html>
