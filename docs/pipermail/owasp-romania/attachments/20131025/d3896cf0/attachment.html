<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Intradevar&nbsp;payloadul&nbsp;reflected&nbsp;xss&nbsp;poate&nbsp;sa&nbsp;vina&nbsp;si&nbsp;din&nbsp;parametri&nbsp;post&nbsp;si&nbsp;din&nbsp;header,&nbsp;my&nbsp;mistake.&lt;div&gt;Legat&nbsp;de&nbsp;DOM&nbsp;xss&nbsp;propun&nbsp;sa&nbsp;construim&nbsp;un&nbsp;exemplu&nbsp;in&nbsp;care&nbsp;suntem&nbsp;in&nbsp;dezacord&nbsp;si&nbsp;sa&nbsp;discutam&nbsp;mai&nbsp;la&nbsp;concret.&lt;/div&gt;<br>
<br>
&lt;div&gt;Incep&nbsp;eu,&nbsp;va&nbsp;rog&nbsp;modificati&nbsp;cum&nbsp;credeti&nbsp;ca&nbsp;e&nbsp;mai&nbsp;clar&nbsp;si&nbsp;scuzati&nbsp;greselile&nbsp;de&nbsp;ortografie.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;exemplu&nbsp;1:&lt;/div&gt;&lt;div&gt;req:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://www.example.com/search?query=xxx&quot;&gt;http://www.example.com/search?query=xxx&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;search1.php:&lt;/div&gt;&lt;div&gt;&lt;html&gt;&lt;/div&gt;&lt;div&gt;&lt;body&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;&lt;?php&lt;br&gt;<br>
<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;echo &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&#39;no&nbsp;results&nbsp;for&nbsp;&#39; &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;. &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;htmlspecialchars&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;$_GET&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;[&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;]) . &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&#39;!&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;;&lt;br&gt;<br>
<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;?&gt;&lt;/span&gt;&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;/body&gt;&lt;/div&gt;&lt;div&gt;&lt;script&gt;&lt;/div&gt;&lt;div&gt;alert(&#39;&lt;span&nbsp;style=&quot;background-color:rgb(225,225,225);color:rgb(0,0,187);font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px&quot;&gt;&lt;?php &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;echo &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;$_GET&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;[&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;])&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;?&gt;&#39;);&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;/script&gt;&lt;/div&gt;&lt;div&gt;&lt;/html&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;Exemplu&nbsp;2:&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&gt;req:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://www.example.com/search?query=xxx&quot;&gt;http://www.example.com/search?query=xxx&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;search2.php:&lt;/div&gt;&lt;div&gt;&lt;html&gt;&lt;/div&gt;&lt;div&gt;&lt;body&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;&lt;?php&lt;br&gt;<br>
<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;echo &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&#39;no&nbsp;results&nbsp;for&nbsp;&lt;input&nbsp;id=q&nbsp;type=text&nbsp;value=&quot;&#39; &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;. &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;htmlspecialchars&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;$_GET&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;[&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;]) . &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&#39;&gt;&#39;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;;&lt;br&gt;<br>
<br>
&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;?&gt;&lt;/span&gt;&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;/body&gt;&lt;/div&gt;&lt;div&gt;&lt;script&gt;&lt;/div&gt;&lt;div&gt;document.getElementById(&#39;q&#39;).value=&#39;&lt;span&nbsp;style=&quot;background-color:rgb(225,225,225);color:rgb(0,0,187);font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px&quot;&gt;&lt;?php &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;echo &lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;$_GET&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;[&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(221,0,0)&quot;&gt;&quot;query&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,119,0)&quot;&gt;])&lt;/span&gt;&lt;span&nbsp;style=&quot;font-family:Consolas,&#39;Andale&nbsp;Mono&nbsp;WT&#39;,&#39;Andale&nbsp;Mono&#39;,&#39;Lucida&nbsp;Console&#39;,Monaco,&#39;Courier&nbsp;New&#39;,Courier,monospace;font-size:14px;background-color:rgb(225,225,225);color:rgb(0,0,187)&quot;&gt;?&gt;&#39;;&lt;/span&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;/script&gt;&lt;/div&gt;&lt;div&gt;&lt;/html&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;Suntem&nbsp;de&nbsp;acord&nbsp;ca&nbsp;exemplul&nbsp;1&nbsp;e&nbsp;reflected&nbsp;xss&nbsp;iar&nbsp;exemplu&nbsp;2&nbsp;e&nbsp;...&nbsp;eu&nbsp;zic&nbsp;ca&nbsp;reflected&nbsp;Dinu&nbsp;zice&nbsp;ca&nbsp;e&nbsp;dom&nbsp;xss?&lt;/div&gt;<br>
<br>
&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;Merci&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;Cristian&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
<br>
2013/10/23&nbsp;Dinu&nbsp;Smadu&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:smadudinu@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;smadudinu@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Vreau&nbsp;sa&nbsp;fac&nbsp;cateva&nbsp;precizari&nbsp;legate&nbsp;de&nbsp;ce&nbsp;spune&nbsp;Cristian.&lt;div&gt;&lt;br&gt;&lt;div&gt;Reflected&nbsp;XSS&nbsp;&lt;b&gt;nu&lt;/b&gt;&nbsp;presupune&nbsp;ca&nbsp;payloadul&nbsp;vine&nbsp;din&nbsp;URL,&nbsp;el&nbsp;poate&nbsp;fi&nbsp;injectat&nbsp;si&nbsp;intr-un&nbsp;parametru&nbsp;din&nbsp;POST,&nbsp;intr-un&nbsp;Header,&nbsp;etc.&nbsp;Atata&nbsp;timp&nbsp;cat&nbsp;serverul&nbsp;include&nbsp;acest&nbsp;payload&nbsp;in&nbsp;raspuns,&nbsp;in&nbsp;forma&nbsp;lui&nbsp;finala,&nbsp;este&nbsp;vorba&nbsp;de&nbsp;Reflected&nbsp;XSS.&lt;/div&gt;<br>
<br>
<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;DOM&nbsp;XSS:&lt;/div&gt;&lt;div&gt;DOM-ul&nbsp;este&nbsp;construit&nbsp;de&nbsp;browser&nbsp;prin&nbsp;parsarea&nbsp;HTML-ului&nbsp;primit&nbsp;de&nbsp;la&nbsp;server.&nbsp;Fiecare&nbsp;browser&nbsp;are&nbsp;un&nbsp;parser&nbsp;care&nbsp;construieste&nbsp;DOM-ul&nbsp;si&nbsp;sunt&nbsp;tratate&nbsp;aici&nbsp;si&nbsp;erori&nbsp;cum&nbsp;ar&nbsp;fi&nbsp;tag-urile&nbsp;incorecte,&nbsp;tag-uri&nbsp;uitate&nbsp;deschise,&nbsp;etc. &lt;/div&gt;<br>
<br>
<br>
<br>
&lt;div&gt;Aceasta&nbsp;vulnerabilitate&nbsp;presupune&nbsp;doua&nbsp;conditii:&lt;/div&gt;&lt;div&gt;1.&nbsp;atacatorul&nbsp;poate&nbsp;sa&nbsp;modifice&nbsp;DOM-ul&nbsp;(print-un&nbsp;Payload&nbsp;din&nbsp;URL,&nbsp;prin&nbsp;modificarea&nbsp;unui&nbsp;parametru,&nbsp;etc) &lt;/div&gt;&lt;div&gt;2.&nbsp;codul&nbsp;JavaScript&nbsp;de&nbsp;pe&nbsp;client&nbsp;foloseste&nbsp;valori&nbsp;modificate&nbsp;din&nbsp;DOM&nbsp;si&nbsp;din&nbsp;asta&nbsp;rezulta&nbsp;executia&nbsp;unui&nbsp;payload&nbsp;arbitrar.&lt;/div&gt;<br>
<br>
<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cazul&nbsp;in&nbsp;care&nbsp;Payload-ul&nbsp;nu&nbsp;ajunge&nbsp;pe&nbsp;server&nbsp;este&nbsp;unul&nbsp;particular,&nbsp;nu&nbsp;este&nbsp;o&nbsp;conditie&nbsp;obligatorie. &lt;/div&gt;&lt;/div&gt;&lt;span&nbsp;class=&quot;&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Dinu&lt;/div&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;<br>
<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
<br>
2013/10/23&nbsp;Cristian&nbsp;Serban&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:scrissti@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;scrissti@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
<br>
<br>
<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Si&nbsp;eu&nbsp;stiu&nbsp;exact&nbsp;ca&nbsp;si&nbsp;Serg,&lt;div&gt;diferenta&nbsp;intre&nbsp;cele&nbsp;doua&nbsp;este&nbsp;ca&nbsp;reflected&nbsp;ajunge&nbsp;la&nbsp;server&nbsp;si&nbsp;se&nbsp;returneaza&nbsp;in&nbsp;pahina,&nbsp;iar&nbsp;dom&nbsp;based&nbsp;xss&nbsp;nu&nbsp;ajunge&nbsp;la&nbsp;nici&nbsp;un&nbsp;server,&nbsp;este&nbsp;executat&nbsp;pur&nbsp;in&nbsp;browser.&nbsp;Deci&nbsp;da&nbsp;se&nbsp;poate&nbsp;face&nbsp;doar&nbsp;prin&nbsp;fragment&nbsp;identifiers&nbsp;pentru&nbsp;ca&nbsp;doar&nbsp;aici&nbsp;partea&nbsp;din&nbsp;url&nbsp;care&nbsp;este&nbsp;dupa&nbsp;&#39;#&#39;&nbsp;ramane&nbsp;in&nbsp;browser.&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;Problema&nbsp;mare&nbsp;cu&nbsp;dom&nbsp;xss&nbsp;inafara&nbsp;de&nbsp;faptul&nbsp;ca&nbsp;este&nbsp;un&nbsp;xss&nbsp;este&nbsp;ca&nbsp;daca&nbsp;ai&nbsp;un&nbsp;WAF&nbsp;care&nbsp;monitorizeaza&nbsp;web&nbsp;serverul&nbsp;acesta&nbsp;nu&nbsp;va&nbsp;detecta&nbsp;niciodata&nbsp;ca&nbsp;site-ul&nbsp;are&nbsp;o&nbsp;vulnerabilitate&nbsp;xss&nbsp;care&nbsp;este&nbsp;exploatata&nbsp;in&nbsp;the&nbsp;wild.&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;Eu&nbsp;consider&nbsp;ca&nbsp;din&nbsp;acest&nbsp;motiv&nbsp;se&nbsp;poate&nbsp;defini&nbsp;o&nbsp;noua&nbsp;categorie&nbsp;de&nbsp;xss. &lt;/div&gt;&lt;div&gt;In&nbsp;final&nbsp;toate&nbsp;sunt&nbsp;xss,&nbsp;dar&nbsp;fiecare&nbsp;categorie&nbsp;(stored,&nbsp;reflected,&nbsp;dom)&nbsp;trebuie&nbsp;sa&nbsp;aiba&nbsp;ceva&nbsp;specific&nbsp;si&nbsp;o&nbsp;diferenta&nbsp;importanta:&nbsp;(store=&nbsp;se&nbsp;salveaza&nbsp;in&nbsp;bd,&nbsp;reflected&nbsp;=&nbsp;payload&nbsp;trebuie&nbsp;purtat&nbsp;in&nbsp;url,&nbsp;dom&nbsp;=&nbsp;nu&nbsp;se&nbsp;trimite&nbsp;la&nbsp;server&nbsp;deloc)&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;parerea&nbsp;mea&lt;/div&gt;&lt;div&gt;Cristian&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;23&nbsp;October&nbsp;2013&nbsp;09:52,&nbsp;Petre-Cosmin&nbsp;Huruiala&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:huruiala.cosmin@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;huruiala.cosmin@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Salut,&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;div&gt;Pentru&nbsp;mine&nbsp;diferenta&nbsp;dintre&nbsp;cele&nbsp;doua&nbsp;tipuri&nbsp;de&nbsp;XSS&nbsp;(reflected&nbsp;si&nbsp;DOM)&nbsp;vine&nbsp;in&nbsp;principal&nbsp;de&nbsp;la&nbsp;modul&nbsp;cum&nbsp;se&nbsp;manifesta:&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;  &nbsp;-&nbsp;reflected&nbsp;XSS:&nbsp;prin modificarea&nbsp;continutului&nbsp;paginii&nbsp;HTML din&nbsp;cauza imputului&nbsp;nevalidat&nbsp;corespunzator.&nbsp;Asta&nbsp;se&nbsp;intampla&nbsp;pe&nbsp;server&nbsp;si&nbsp;pagina&nbsp;este&nbsp;obligatoriu&nbsp;dinamica.&lt;/div&gt;<br>
&lt;div&gt;   -&nbsp;DOM XSS:&nbsp;modificarea&nbsp;obiectelor&nbsp;DOM&nbsp;care&nbsp;nu&nbsp;sunt&nbsp;controlate&nbsp;complet&nbsp;de&nbsp;catre&nbsp;server.&nbsp;Pagina&nbsp;nu&nbsp;este&nbsp;obligatoriu&nbsp;dinamica&nbsp;si&nbsp;exploitul&nbsp;nu&nbsp;e&nbsp;obligatoriu&nbsp;sa&nbsp;ajunga&nbsp;pe&nbsp;server. Dupa&nbsp;cum&nbsp;se&nbsp;spune&nbsp;si&nbsp;pe&nbsp;pagina&nbsp;OWASP&nbsp;continutul&nbsp;HTML&nbsp;nu&nbsp;se&nbsp;schimba.&nbsp;&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt; &lt;/div&gt;&lt;div&gt;In&nbsp;consecinta&nbsp;si&nbsp;eu&nbsp;cred&nbsp;ca&nbsp;definitia&nbsp;OWASP&nbsp;este&nbsp;corecta.&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;div&gt;Cosmin&nbsp;H.&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2013/10/23&nbsp;Oana&nbsp;Cornea&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:oana.cornea@owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;oana.cornea@owasp.org&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Corect.&nbsp;Am&nbsp;trimis&nbsp;doar&nbsp;&quot;for&nbsp;the&nbsp;sake&nbsp;of&nbsp;argument&quot;&nbsp;:)&nbsp;cu&nbsp;scopul&nbsp;pur&nbsp;-&nbsp;de&nbsp;debate,&nbsp;poate&nbsp;reusesc&nbsp;sa&nbsp;stimulez&nbsp;o&nbsp;discutie&nbsp;in&nbsp;cazul&nbsp;in&nbsp;care&nbsp;poate&nbsp;nu&nbsp;toata&nbsp;lumea&nbsp;stie&nbsp;exact&nbsp;despre&nbsp;ce&nbsp;este&nbsp;vorba.&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;M-am&nbsp;gandit&nbsp;ca&nbsp;mailuri&nbsp;de&nbsp;genul&nbsp;pot&nbsp;genera&nbsp;multe&nbsp;reply-uri:&nbsp;cei&nbsp;care&nbsp;stiu&nbsp;isi&nbsp;pot&nbsp;impartasi&nbsp;cunostiintele,&nbsp;ceilalti&nbsp;se&nbsp;documenteaza&nbsp;sau&nbsp;afla&nbsp;lucruri&nbsp;noi&nbsp;si&nbsp;poate&nbsp;asa&nbsp;devenim&nbsp;mai&nbsp;activi.&lt;/div&gt;&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;Oana&lt;br&gt;&lt;/div&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Oct&nbsp;22,&nbsp;2013&nbsp;at&nbsp;5:37&nbsp;PM,&nbsp;Dinu&nbsp;Smadu&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:smadudinu@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;smadudinu@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;padding-left:1ex;border-left-color:rgb(204,204,204);border-left-width:1px;border-left-style:solid&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Buna,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;cazul&nbsp;Reflected&nbsp;XSS&nbsp;serverul&nbsp;raspunde&nbsp;cu&nbsp;o&nbsp;pagina&nbsp;HTML,&nbsp;din&nbsp;ea&nbsp;browserul&nbsp;construieste&nbsp;un&nbsp;DOM&nbsp;si&nbsp;apoi&nbsp;este&nbsp;rulat&nbsp;codul&nbsp;javascript&nbsp;arbitrar.&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;In&nbsp;cazul&nbsp;DOM&nbsp;XSS&nbsp;atacul&nbsp;consta&nbsp;in&nbsp;modificarea&nbsp;ulterioara&nbsp;a&nbsp;DOM-ului&nbsp;construit&nbsp;de&nbsp;browser&nbsp;la&nbsp;primirea&nbsp;raspunsului&nbsp;(prin&nbsp;executia&nbsp;de&nbsp;cod&nbsp;JavaScript&nbsp;vulnerabil)&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Exemplu&nbsp;de &lt;b&gt;DOM-XSS&lt;/b&gt;&nbsp;(putin&nbsp;fortat)&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;URL:&nbsp;&lt;a&nbsp;href=&quot;http://www.example.com/search.php?query=&quot;&nbsp;target=&quot;_blank&quot;&gt;www.example.com/search.php?query=&lt;/a&gt;&lt;script&gt;alert(1)&lt;script&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;raspuns:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;id=&quot;query&quot;&nbsp;value=&quot;&lt;?php&nbsp;echo &lt;span&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;htmlspecialchars(&lt;/font&gt;&lt;/span&gt;$query)?&gt;&quot;&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;color:rgb(0,0,139);line-height:18px;font-family:Consolas,Menlo,Monaco,&#39;Lucida&nbsp;Console&#39;,&#39;Liberation&nbsp;Mono&#39;,&#39;DejaVu&nbsp;Sans&nbsp;Mono&#39;,&#39;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&#39;,&#39;Courier&nbsp;New&#39;,monospace,serif;font-size:14px;vertical-align:baseline;background-color:transparent&quot;&gt; &nbsp;&lt;/span&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;helvetica,&nbsp;sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;color:rgb(0,0,139);line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt; var&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;&nbsp;decoded&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;=&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;&nbsp;$&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;(&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;color:rgb(128,0,0);line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;&quot;#element&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;).&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;html&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;($&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;(&#39;#query&#39;).val()&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;).&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;text&lt;/span&gt;&lt;span&nbsp;style=&quot;margin:0px;padding:0px;border:0px&nbsp;currentcolor;line-height:18px;vertical-align:baseline;background-color:transparent&quot;&gt;();&nbsp; &nbsp;//html&nbsp;decode&nbsp;si&nbsp;insert&nbsp;in&nbsp;pagina&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;&lt;/script&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;acest&nbsp;caz&nbsp;cred&nbsp;ca&nbsp;definitia&nbsp;e&nbsp;corecta&nbsp;in&nbsp;OWASP&nbsp;si&nbsp;DOM-XSS&nbsp;nu&nbsp;se&nbsp;limiteaza&nbsp;doar&nbsp;la &lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;fragment&nbsp;identifiers&lt;/span&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px&quot;&gt;Pot&nbsp;sa&nbsp;traduc&nbsp;daca&nbsp;ai&nbsp;nevoie&nbsp;si&nbsp;de&nbsp;un&nbsp;raspuns&nbsp;in&nbsp;engleza &lt;/span&gt;&lt;/div&gt;&lt;div&gt;Dinu &lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;On&nbsp;Tue,&nbsp;Oct&nbsp;22,&nbsp;2013&nbsp;at&nbsp;4:34&nbsp;PM,&nbsp;Oana&nbsp;Cornea&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:oana.cornea@owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;oana.cornea@owasp.org&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;padding-left:1ex;border-left-color:rgb(204,204,204);border-left-width:1px;border-left-style:solid&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hello,&lt;/div&gt;&lt;div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt;&lt;/div&gt;Voi&nbsp;ce&nbsp;parere&nbsp;aveti?&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
----------&nbsp;Forwarded&nbsp;message&nbsp;----------&lt;br&gt;<br>
<br>
From:&nbsp;&lt;b&nbsp;class=&quot;gmail_sendername&quot;&gt;Serg&lt;/b&gt;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:serg@owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;serg@owasp.org&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;<br>
<br>
Date:&nbsp;Tue,&nbsp;Oct&nbsp;22,&nbsp;2013&nbsp;at&nbsp;2:05&nbsp;PM&lt;br&gt;Subject:&nbsp;[Owasp-leaders]&nbsp;OWASP&nbsp;DOM&nbsp;based&nbsp;XSS&nbsp;definition,&nbsp;which&nbsp;looked&nbsp;a&nbsp;little&nbsp;off&lt;br&gt;To:&nbsp;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-leaders@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-leaders@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-leaders@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-leaders@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;p&gt;Hi&nbsp;All&lt;/p&gt;<br>
&lt;p&gt;I&#39;ve&nbsp;recently&nbsp;had&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;OWASP&nbsp;DOM&nbsp;based&nbsp;XSS&nbsp;definition,&nbsp;which&nbsp;looked&nbsp;a&nbsp;little&nbsp;off.&lt;/p&gt;&lt;p&gt;The&nbsp;TL;DR&nbsp;version:&nbsp;the&nbsp;DOM&nbsp;based&nbsp;XSS&nbsp;definition&nbsp;according&nbsp;to&nbsp;OWASP&nbsp;(&lt;a&nbsp;href=&quot;https://www.owasp.org/index.php/DOM_Based_XSS&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;span&gt;https://www.owasp.org/index.php/DOM_Based_XSS&lt;/span&gt;&lt;/a&gt;)&nbsp;is&nbsp;only&nbsp;50%&nbsp;correct&nbsp;(or&nbsp;the&nbsp;pessimistic&nbsp;view&nbsp;-&nbsp;50%&nbsp;wrong)&nbsp;and&nbsp;misleading.&lt;/p&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;p&gt;I&nbsp;am&nbsp;basing&nbsp;this&nbsp;on&nbsp;the&nbsp;&#39;Definition&#39;&nbsp;examples&nbsp;(&lt;a&nbsp;href=&quot;https://www.owasp.org/index.php/DOM_Based_XSS&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;span&gt;https://www.owasp.org/index.php/DOM_Based_XSS&lt;/span&gt;&lt;/a&gt;),&nbsp;not&nbsp;the&nbsp;&#39;Advanced&nbsp;Techniques&nbsp;and&nbsp;Derivatives&#39;&nbsp;section.&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/p&gt;<br>
&lt;p&gt;The&nbsp;first&nbsp;part&nbsp;of&nbsp;this&nbsp;document&nbsp;is&nbsp;incorrect. &lt;br&gt;&lt;/p&gt;<br>
&lt;p&gt;In&nbsp;layman&#39;s&nbsp;terms,&nbsp;the&nbsp;Reflected&nbsp;XSS,&nbsp;request/JS&nbsp;is&nbsp;first&nbsp;sent&nbsp;to&nbsp;the&nbsp;server,&nbsp;it&nbsp;is&nbsp;then&nbsp;reflected,&nbsp;as&nbsp;is,&nbsp;in&nbsp;the&nbsp;response,&nbsp;hence&nbsp;the&nbsp;name.&lt;br&gt;&lt;/p&gt;<br>
&lt;p&gt;Example:&lt;br&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;span&gt;&lt;a&nbsp;href=&quot;http://www.some.site/page.html?default=xss_attack_here&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.some.site/page.html?default=xss_attack_here&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;Since&nbsp;the&nbsp;query&nbsp;string&nbsp;gets&nbsp;sent&nbsp;to&nbsp;the&nbsp;server&nbsp;and&nbsp;reflected&nbsp;back,&nbsp;this&nbsp;is&nbsp;a&nbsp;Reflected&nbsp;XSS,&nbsp;not&nbsp;DOM-based.&lt;br&gt;&lt;/p&gt;<br>
&lt;p&gt;The&nbsp;&#39;xss_attack_here&#39;&nbsp;part&nbsp;is&nbsp;irrelevant&nbsp;here.&nbsp;As&nbsp;long&nbsp;as&nbsp;it&nbsp;is&nbsp;sent&nbsp;to&nbsp;the&nbsp;server&nbsp;and&nbsp;reflected&nbsp;back,&nbsp;it&#39;s&nbsp;a&nbsp;Reflected&nbsp;XSS&nbsp;vulnerability.&nbsp;Whether&nbsp;it&nbsp;runs&nbsp;in&nbsp;DOM&nbsp;or&nbsp;not&nbsp;is&nbsp;irrelevant,&nbsp;technically&nbsp;everything&nbsp;runs&nbsp;in&nbsp;DOM... &lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/p&gt;<br>
&lt;p&gt;My&nbsp;understanding&nbsp;of&nbsp;DOM&nbsp;based&nbsp;XSS,&nbsp;is:&nbsp;it&nbsp;is&nbsp;processed&nbsp;entirely&nbsp;in&nbsp;the&nbsp;web&nbsp;browser,&nbsp;the&nbsp;request&nbsp;with&nbsp;XSS&nbsp;payload&nbsp;is&nbsp;not&nbsp;sent&nbsp;to&nbsp;the&nbsp;server.&lt;br&gt;&lt;/p&gt;<br>
&lt;p&gt;As&nbsp;far&nbsp;as&nbsp;I&nbsp;know,&nbsp;the&nbsp;only&nbsp;way&nbsp;to&nbsp;achieve&nbsp;that&nbsp;is&nbsp;to&nbsp;use&nbsp;fragment&nbsp;identifiers,&nbsp;the&nbsp;part&nbsp;of&nbsp;the&nbsp;URL&nbsp;after&nbsp;the&nbsp;&#39;#&#39;&nbsp;(including&nbsp;&#39;#&#39;)&nbsp;is&nbsp;not&nbsp;sent&nbsp;to&nbsp;the&nbsp;server&nbsp;as&nbsp;part&nbsp;of&nbsp;the&nbsp;request.&lt;br&gt;&lt;/p&gt;<br>
&lt;p&gt;Based&nbsp;on&nbsp;that,&nbsp;I&nbsp;am&nbsp;fairly&nbsp;certain&nbsp;that&nbsp;the&nbsp;current&nbsp;OWASP&nbsp;definition&nbsp;(&lt;a&nbsp;href=&quot;https://www.owasp.org/index.php/DOM_Based_XSS&quot;&nbsp;target=&quot;_blank&quot;&gt;&lt;span&gt;https://www.owasp.org/index.php/DOM_Based_XSS&lt;/span&gt;&lt;/a&gt;)&nbsp;is&nbsp;wrong&nbsp;and&nbsp;misleading.&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/p&gt;<br>
&lt;p&gt;&lt;br&gt;&lt;/p&gt;<br>
&lt;p&gt;Thoughts?&lt;/p&gt;&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;Serg<br>
&lt;/font&gt;&lt;/span&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
OWASP-Leaders&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:OWASP-Leaders@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;OWASP-Leaders@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-leaders&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-leaders&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Oana&nbsp;Cornea,&nbsp;OWASP&nbsp;Romania&lt;br&gt;Tel: &lt;a&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;value=&quot;+40741050210&quot;&gt;+40741050210&lt;/a&gt;&lt;br&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
Email: &lt;a&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;href=&quot;mailto:oana.cornea@owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;oana.cornea@owasp.org&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;div&gt;OWASP&nbsp;Global: &lt;a&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;href=&quot;http://www.owasp.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.owasp.org&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;_______________________________________________&lt;br&gt;<br>
Owasp-romania&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-romania@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-romania@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-romania&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-romania&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Oana&nbsp;Cornea,&nbsp;OWASP&nbsp;Romania&lt;br&gt;Tel: &lt;a&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;value=&quot;+40741050210&quot;&gt;+40741050210&lt;/a&gt;&lt;br&gt;Email: &lt;a&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;href=&quot;mailto:oana.cornea@owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;oana.cornea@owasp.org&lt;/a&gt;&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;div&gt;OWASP&nbsp;Global: &lt;a&nbsp;style=&quot;color:rgb(17,85,204)&quot;&nbsp;href=&quot;http://www.owasp.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.owasp.org&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Owasp-romania&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-romania@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-romania@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-romania&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-romania&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;CH&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;div&gt;I&#39;m&nbsp;bad&nbsp;and&nbsp;that&#39;s&nbsp;good&nbsp;I&#39;ll&nbsp;never&nbsp;be&nbsp;good&nbsp;and&nbsp;that&#39;s&nbsp;not&nbsp;bad&lt;/div&gt;&lt;div&gt;There&#39;s&nbsp;no&nbsp;one&nbsp;I&nbsp;rather&nbsp;be&nbsp;than&nbsp;me&lt;/div&gt;<br>
<br>
<br>
<br>
<br>
<br>
<br>
&lt;/div&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Owasp-romania&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-romania@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-romania@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-romania&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-romania&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;span&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;Cristian<br>
&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Owasp-romania&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-romania@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-romania@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-romania&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-romania&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;Cristian<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
