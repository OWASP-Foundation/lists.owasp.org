<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-romania] Fwd: [Owasp-leaders] OWASP DOM based XSS definition, which looked a little off
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-romania%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-romania%5D%20Fwd%3A%20%5BOwasp-leaders%5D%20OWASP%20DOM%20based%20XSS%0A%20definition%2C%20which%20looked%20a%20little%20off&In-Reply-To=%3CCAC8fo%2Bj5zsJkLPn9qeEgYdcAwkBOdg2WR1kEMawnuYNzr-jdOg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000136.html">
   <LINK REL="Next"  HREF="000139.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-romania] Fwd: [Owasp-leaders] OWASP DOM based XSS definition, which looked a little off</H1>
    <B>Dinu Smadu</B> 
    <A HREF="mailto:owasp-romania%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-romania%5D%20Fwd%3A%20%5BOwasp-leaders%5D%20OWASP%20DOM%20based%20XSS%0A%20definition%2C%20which%20looked%20a%20little%20off&In-Reply-To=%3CCAC8fo%2Bj5zsJkLPn9qeEgYdcAwkBOdg2WR1kEMawnuYNzr-jdOg%40mail.gmail.com%3E"
       TITLE="[Owasp-romania] Fwd: [Owasp-leaders] OWASP DOM based XSS definition, which looked a little off">smadudinu at gmail.com
       </A><BR>
    <I>Wed Oct 23 10:22:20 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000136.html">[Owasp-romania] Fwd: [Owasp-leaders] OWASP DOM based XSS definition, which looked a little off
</A></li>
        <LI>Next message: <A HREF="000139.html">[Owasp-romania] Fwd: [Owasp-leaders] OWASP DOM based XSS definition, which looked a little off
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#137">[ date ]</a>
              <a href="thread.html#137">[ thread ]</a>
              <a href="subject.html#137">[ subject ]</a>
              <a href="author.html#137">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Vreau sa fac cateva precizari legate de ce spune Cristian.

Reflected XSS *nu* presupune ca payloadul vine din URL, el poate fi
injectat si intr-un parametru din POST, intr-un Header, etc. Atata timp cat
serverul include acest payload in raspuns, in forma lui finala, este vorba
de Reflected XSS.

DOM XSS:
DOM-ul este construit de browser prin parsarea HTML-ului primit de la
server. Fiecare browser are un parser care construieste DOM-ul si sunt
tratate aici si erori cum ar fi tag-urile incorecte, tag-uri uitate
deschise, etc.
Aceasta vulnerabilitate presupune doua conditii:
1. atacatorul poate sa modifice DOM-ul (print-un Payload din URL, prin
modificarea unui parametru, etc)
2. codul JavaScript de pe client foloseste valori modificate din DOM si din
asta rezulta executia unui payload arbitrar.

Cazul in care Payload-ul nu ajunge pe server este unul particular, nu este
o conditie obligatorie.

Dinu


2013/10/23 Cristian Serban &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">scrissti at gmail.com</A>&gt;

&gt;<i> Si eu stiu exact ca si Serg,
</I>&gt;<i> diferenta intre cele doua este ca reflected ajunge la server si se
</I>&gt;<i> returneaza in pahina, iar dom based xss nu ajunge la nici un server, este
</I>&gt;<i> executat pur in browser. Deci da se poate face doar prin fragment
</I>&gt;<i> identifiers pentru ca doar aici partea din url care este dupa '#' ramane in
</I>&gt;<i> browser.
</I>&gt;<i> Problema mare cu dom xss inafara de faptul ca este un xss este ca daca ai
</I>&gt;<i> un WAF care monitorizeaza web serverul acesta nu va detecta niciodata ca
</I>&gt;<i> site-ul are o vulnerabilitate xss care este exploatata in the wild.
</I>&gt;<i> Eu consider ca din acest motiv se poate defini o noua categorie de xss.
</I>&gt;<i> In final toate sunt xss, dar fiecare categorie (stored, reflected, dom)
</I>&gt;<i> trebuie sa aiba ceva specific si o diferenta importanta: (store= se
</I>&gt;<i> salveaza in bd, reflected = payload trebuie purtat in url, dom = nu se
</I>&gt;<i> trimite la server deloc)
</I>&gt;<i>
</I>&gt;<i> parerea mea
</I>&gt;<i> Cristian
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On 23 October 2013 09:52, Petre-Cosmin Huruiala &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">huruiala.cosmin at gmail.com</A>
</I>&gt;<i> &gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Salut,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Pentru mine diferenta dintre cele doua tipuri de XSS (reflected si DOM)
</I>&gt;&gt;<i> vine in principal de la modul cum se manifesta:
</I>&gt;&gt;<i>    - reflected XSS: prin modificarea continutului paginii HTML din
</I>&gt;&gt;<i> cauza imputului nevalidat corespunzator. Asta se intampla pe server si
</I>&gt;&gt;<i> pagina este obligatoriu dinamica.
</I>&gt;&gt;<i>    - DOM XSS: modificarea obiectelor DOM care nu sunt controlate complet
</I>&gt;&gt;<i> de catre server. Pagina nu este obligatoriu dinamica si exploitul nu e
</I>&gt;&gt;<i> obligatoriu sa ajunga pe server. Dupa cum se spune si pe pagina OWASP
</I>&gt;&gt;<i> continutul HTML nu se schimba.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In consecinta si eu cred ca definitia OWASP este corecta.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cosmin H.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2013/10/23 Oana Cornea &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">oana.cornea at owasp.org</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Corect. Am trimis doar &quot;for the sake of argument&quot; :) cu scopul pur - de
</I>&gt;&gt;&gt;<i> debate, poate reusesc sa stimulez o discutie in cazul in care poate nu
</I>&gt;&gt;&gt;<i> toata lumea stie exact despre ce este vorba.
</I>&gt;&gt;&gt;<i> M-am gandit ca mailuri de genul pot genera multe reply-uri: cei care
</I>&gt;&gt;&gt;<i> stiu isi pot impartasi cunostiintele, ceilalti se documenteaza sau afla
</I>&gt;&gt;&gt;<i> lucruri noi si poate asa devenim mai activi.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Oana
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Tue, Oct 22, 2013 at 5:37 PM, Dinu Smadu &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">smadudinu at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Buna,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> In cazul Reflected XSS serverul raspunde cu o pagina HTML, din ea
</I>&gt;&gt;&gt;&gt;<i> browserul construieste un DOM si apoi este rulat codul javascript arbitrar.
</I>&gt;&gt;&gt;&gt;<i> In cazul DOM XSS atacul consta in modificarea ulterioara a DOM-ului
</I>&gt;&gt;&gt;&gt;<i> construit de browser la primirea raspunsului (prin executia de cod
</I>&gt;&gt;&gt;&gt;<i> JavaScript vulnerabil)
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Exemplu de *DOM-XSS* (putin fortat)
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> URL: www.example.com/search.php?query=&lt;script&gt;alert(1)&lt;script&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> In raspuns:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &lt;input type=&quot;hidden&quot; id=&quot;query&quot; value=&quot;&lt;?php echo htmlspecialchars(
</I>&gt;&gt;&gt;&gt;<i> $query)?&gt;&quot;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &lt;script type=&quot;text/javascript&quot;&gt;
</I>&gt;&gt;&gt;&gt;<i>    var decoded = $(&quot;#element&quot;).html($('#query').val()).text();
</I>&gt;&gt;&gt;&gt;<i> //html decode si insert in pagina
</I>&gt;&gt;&gt;&gt;<i> &lt;/script&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> In acest caz cred ca definitia e corecta in OWASP si DOM-XSS nu se
</I>&gt;&gt;&gt;&gt;<i> limiteaza doar la fragment identifiers
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Pot sa traduc daca ai nevoie si de un raspuns in engleza
</I>&gt;&gt;&gt;&gt;<i> Dinu
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> On Tue, Oct 22, 2013 at 4:34 PM, Oana Cornea &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">oana.cornea at owasp.org</A>&gt;wrote:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hello,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Voi ce parere aveti?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> ---------- Forwarded message ----------
</I>&gt;&gt;&gt;&gt;&gt;<i> From: Serg &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">serg at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> Date: Tue, Oct 22, 2013 at 2:05 PM
</I>&gt;&gt;&gt;&gt;&gt;<i> Subject: [Owasp-leaders] OWASP DOM based XSS definition, which looked
</I>&gt;&gt;&gt;&gt;&gt;<i> a little off
</I>&gt;&gt;&gt;&gt;&gt;<i> To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">owasp-leaders at lists.owasp.org</A>&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">owasp-leaders at lists.owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hi All
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I've recently had a look at the OWASP DOM based XSS definition, which
</I>&gt;&gt;&gt;&gt;&gt;<i> looked a little off.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The TL;DR version: the DOM based XSS definition according to OWASP (
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/DOM_Based_XSS">https://www.owasp.org/index.php/DOM_Based_XSS</A>) is only 50% correct
</I>&gt;&gt;&gt;&gt;&gt;<i> (or the pessimistic view - 50% wrong) and misleading.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I am basing this on the 'Definition' examples (
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/DOM_Based_XSS">https://www.owasp.org/index.php/DOM_Based_XSS</A>), not the 'Advanced
</I>&gt;&gt;&gt;&gt;&gt;<i> Techniques and Derivatives' section.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The first part of this document is incorrect.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> In layman's terms, the Reflected XSS, request/JS is first sent to the
</I>&gt;&gt;&gt;&gt;&gt;<i> server, it is then reflected, as is, in the response, hence the name.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Example:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://www.some.site/page.html?default=xss_attack_here">http://www.some.site/page.html?default=xss_attack_here</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Since the query string gets sent to the server and reflected back,
</I>&gt;&gt;&gt;&gt;&gt;<i> this is a Reflected XSS, not DOM-based.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The 'xss_attack_here' part is irrelevant here. As long as it is sent
</I>&gt;&gt;&gt;&gt;&gt;<i> to the server and reflected back, it's a Reflected XSS vulnerability.
</I>&gt;&gt;&gt;&gt;&gt;<i> Whether it runs in DOM or not is irrelevant, technically everything runs in
</I>&gt;&gt;&gt;&gt;&gt;<i> DOM...
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> My understanding of DOM based XSS, is: it is processed entirely in the
</I>&gt;&gt;&gt;&gt;&gt;<i> web browser, the request with XSS payload is not sent to the server.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> As far as I know, the only way to achieve that is to use fragment
</I>&gt;&gt;&gt;&gt;&gt;<i> identifiers, the part of the URL after the '#' (including '#') is not sent
</I>&gt;&gt;&gt;&gt;&gt;<i> to the server as part of the request.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Based on that, I am fairly certain that the current OWASP definition (
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/DOM_Based_XSS">https://www.owasp.org/index.php/DOM_Based_XSS</A>) is wrong and
</I>&gt;&gt;&gt;&gt;&gt;<i> misleading.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thoughts?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;&gt;<i> Serg
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;<i> OWASP-Leaders mailing list
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">OWASP-Leaders at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-leaders">https://lists.owasp.org/mailman/listinfo/owasp-leaders</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;&gt;<i> Oana Cornea, OWASP Romania
</I>&gt;&gt;&gt;&gt;&gt;<i> Tel: +40741050210
</I>&gt;&gt;&gt;&gt;&gt;<i> Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">oana.cornea at owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> OWASP Global: <A HREF="http://www.owasp.org">http://www.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;<i> Owasp-romania mailing list
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">Owasp-romania at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">https://lists.owasp.org/mailman/listinfo/owasp-romania</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> Oana Cornea, OWASP Romania
</I>&gt;&gt;&gt;<i> Tel: +40741050210
</I>&gt;&gt;&gt;<i> Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">oana.cornea at owasp.org</A>
</I>&gt;&gt;&gt;<i> OWASP Global: <A HREF="http://www.owasp.org">http://www.owasp.org</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Owasp-romania mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">Owasp-romania at lists.owasp.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">https://lists.owasp.org/mailman/listinfo/owasp-romania</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> CH
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm bad and that's good I'll never be good and that's not bad
</I>&gt;&gt;<i> There's no one I rather be than me
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-romania mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">Owasp-romania at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">https://lists.owasp.org/mailman/listinfo/owasp-romania</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Cristian
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-romania mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">Owasp-romania at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-romania">https://lists.owasp.org/mailman/listinfo/owasp-romania</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-romania/attachments/20131023/a1850b6c/attachment.html">http://lists.owasp.org/pipermail/owasp-romania/attachments/20131023/a1850b6c/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000136.html">[Owasp-romania] Fwd: [Owasp-leaders] OWASP DOM based XSS definition, which looked a little off
</A></li>
	<LI>Next message: <A HREF="000139.html">[Owasp-romania] Fwd: [Owasp-leaders] OWASP DOM based XSS definition, which looked a little off
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#137">[ date ]</a>
              <a href="thread.html#137">[ thread ]</a>
              <a href="subject.html#137">[ subject ]</a>
              <a href="author.html#137">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-romania">More information about the Owasp-romania
mailing list</a><br>
</body></html>
