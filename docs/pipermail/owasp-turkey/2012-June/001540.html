<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] PHPInfo() Fonksiyonu Arac&#305;l&#305;&#287;&#305;yla LFI
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-turkey%5D%0A%09%3D%3Fiso-8859-9%3Fq%3FPHPInfo%3D28%3D29_Fonksiyonu_Arac%3DFDl%3F%3D%0A%09%3D%3Fiso-8859-9%3Fq%3F%3DFD%3DF0%3DFDyla_LFI%3F%3D&In-Reply-To=%3CCAOUNEDH2P_oCapMAYbf-bbGhhCT9LGngap-vWyd8xXOBHdQ-XA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001538.html">
   <LINK REL="Next"  HREF="001539.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] PHPInfo() Fonksiyonu Arac&#305;l&#305;&#287;&#305;yla LFI</H1>
    <B>Canberk BOLAT</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-turkey%5D%0A%09%3D%3Fiso-8859-9%3Fq%3FPHPInfo%3D28%3D29_Fonksiyonu_Arac%3DFDl%3F%3D%0A%09%3D%3Fiso-8859-9%3Fq%3F%3DFD%3DF0%3DFDyla_LFI%3F%3D&In-Reply-To=%3CCAOUNEDH2P_oCapMAYbf-bbGhhCT9LGngap-vWyd8xXOBHdQ-XA%40mail.gmail.com%3E"
       TITLE="[Owasp-turkey] PHPInfo() Fonksiyonu Arac&#305;l&#305;&#287;&#305;yla LFI">canberk.bolat at gmail.com
       </A><BR>
    <I>Mon Jun  4 15:40:26 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001538.html">[Owasp-turkey] PHPInfo() Fonksiyonu Arac&#305;l&#305;&#287;&#305;yla LFI
</A></li>
        <LI>Next message: <A HREF="001539.html">[Owasp-turkey] System &amp; Network Security Checklist
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1540">[ date ]</a>
              <a href="thread.html#1540">[ thread ]</a>
              <a href="subject.html#1540">[ subject ]</a>
              <a href="author.html#1540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Selamlar,
Bence local'de exploit edilebilmesi zor bir acik, internet uzerindeki bir
hedefte exploit edilebilir birkac denemeyle. Upload denemesi yapildiginda
sayfa tamamen yuklenene kadar tmp dizininde saklaniyor dosya, yani cok
hizli bir sekilde sayfanin yuklenmesi bitmeden, tmp_name'den dosyaya
ulasip, LFI etmek lazim (Bir cesit race condition). O yuzden 1000 x Thread
deneme koymuslar paylastiklari exploit kodunda. Cok agir yuklenen
sayfalarda denenebilir ama local'de zor gibi gozukuyor. Belki meshur Hash
DoS acigi ile birlikte kullanilabilir -belki-.

4 Haziran 2012 11:07 tarihinde O&#287;uzhan YILMAZ &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">aspsrc at gmail.com</A>&gt; yazd&#305;:

&gt;<i> Shared Hosting &#252;zerinde bar&#305;nd&#305;r&#305;lan siteler i&#231;in tehlikeli olur,olabilir.
</I>&gt;<i>  &quot;fileupload&quot; her zaman on olmas&#305; mecburi zaten fakat kendini yazabilmesi
</I>&gt;<i> i&#231;in GetTempFileName methodundan yararlan&#305;yor. Bunu php.ini'de ki
</I>&gt;<i> disabled_functions'a koyarsak direk kafas&#305;n&#305; kesmi&#351; oluruz ama tabi php
</I>&gt;<i> developerlar bu fonksiyonu s&#305;k kullan&#305;yorlarsa k&#305;zabilirler.
</I>&gt;<i>
</I>&gt;<i> Ek olarak upload_tmp_dir ortak olursa &#231;al&#305;&#351;&#305;yor diyorlar. Her site i&#231;in
</I>&gt;<i> ayr&#305; bir upload_tmp_dir ayar&#305; yapm&#305;&#351;t&#305;k biz ve her site i&#231;in ayr&#305; php.ini
</I>&gt;<i> m&#252;stakil olursa belki bir nevi zorla&#351;abilir.
</I>&gt;<i>
</I>&gt;<i> O&#287;uzhan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 4 Haziran 2012 00:33 tarihinde Onur Yilmaz &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">contact at onuryilmaz.info</A>&gt;yazd&#305;:
</I>&gt;<i>
</I>&gt;&gt;<i>  Selamlar,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ge&#231;enlerde
</I>&gt;&gt;<i> <A HREF="http://www.exploit-db.com/wp-content/themes/exploit/docs/17799.pdfadresindeki">http://www.exploit-db.com/wp-content/themes/exploit/docs/17799.pdfadresindeki</A> makaleyi g&#246;rd&#252;m, bu teknikten daha &#246;nce haberim yoktu.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Olay&#305; &#246;zetlersek;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> - phpInfo() fonksiyonu &#231;al&#305;&#351;an bir sayfa gerekiyor. Klasik phpinfo.php
</I>&gt;&gt;<i> sayfas&#305; gibi.
</I>&gt;&gt;<i> - LFI zafiyeti bulunan bir script gerekiyor ki bunu zaten phpInfo
</I>&gt;&gt;<i> fonksiyonunu kullanarak sisteme upload ediyoruz.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Tekni&#287;in ba&#351;ar&#305;yla uygulanmas&#305; i&#231;in de; sunucu da file_upload,
</I>&gt;&gt;<i> output-buffering vs. gibi bir ka&#231; ayar&#305;n a&#231;&#305;k olmas&#305; laz&#305;m.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> phpinfo fonksiyonu bulunan sayfa &#252;zerinden tmp dizinine LFI zafiyeti olan
</I>&gt;&gt;<i> dosya upload edilip, phpinfo &#252;zerinden bu dosya &#231;a&#287;r&#305;larak exploit edilmeye
</I>&gt;&gt;<i> &#231;al&#305;&#351;&#305;l&#305;yor gibi basit ama kompleks bir s&#252;re&#231; var.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://www.insomniasec.com/publications/phpinfolfi.py">http://www.insomniasec.com/publications/phpinfolfi.py</A> adresindeki
</I>&gt;&gt;<i> exploit ile ba&#351;ar&#305;yla exploit edildi&#287;ini s&#246;ylemi&#351;ler ama daha &#246;nce
</I>&gt;&gt;<i> deneyenler gibi ben de &#351;u
</I>&gt;&gt;<i> <A HREF="https://twitter.com/mubix/statuses/139939761329672192">https://twitter.com/mubix/statuses/139939761329672192</A> hatay&#305; ald&#305;m.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> tmp klas&#246;r&#252;n&#252; takip ediyorum (inotifywait -m -r /tmp) komutu ile. Temp
</I>&gt;&gt;<i> dosyalar olu&#351;uyor exploiti &#231;al&#305;&#351;t&#305;rd&#305;&#287;&#305;mda ama sonu&#231; alam&#305;yorum.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &#214;zetle, ben ba&#351;aramad&#305;m :) daha &#246;nce deneyen oldu ise deneyimlerini
</I>&gt;&gt;<i> bizimle payla&#351;abilir, hatta s&#252;reci anlatan, neden bu zafiyet olu&#351;uyor,
</I>&gt;&gt;<i> hangi ayarlar&#305; kapatmak laz&#305;m, ba&#351;ar&#305;yla nas&#305;l exploit edilir tarz&#305;nda ufak
</I>&gt;&gt;<i> bir makaleyi de haz&#305;rlarsa WGT blog &#252;zerinden yay&#305;nlar&#305;z.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Kolay gelsin.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-turkey mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-turkey mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
Canberk Bolat
Security Researcher
<A HREF="http://twitter.com/cnbrkbolat">http://twitter.com/cnbrkbolat</A>
<A HREF="http://cbolat.blogspot.com">http://cbolat.blogspot.com</A>
-------------- sonraki b?l?m --------------
Bir HTML eklentisi temizlendi...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-turkey/attachments/20120604/1ccfc45e/attachment-0002.html">http://lists.owasp.org/pipermail/owasp-turkey/attachments/20120604/1ccfc45e/attachment-0002.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001538.html">[Owasp-turkey] PHPInfo() Fonksiyonu Arac&#305;l&#305;&#287;&#305;yla LFI
</A></li>
	<LI>Next message: <A HREF="001539.html">[Owasp-turkey] System &amp; Network Security Checklist
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1540">[ date ]</a>
              <a href="thread.html#1540">[ thread ]</a>
              <a href="subject.html#1540">[ subject ]</a>
              <a href="author.html#1540">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
