<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%5BFwd%3A%20%5Bnetsec%5D%20WordPress%20Kritik%20Guvenlik%20Acigi%5D&In-Reply-To=BAY104-W20F5C7B3660631006806E7D6340%40phx.gbl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000106.html">
   <LINK REL="Next"  HREF="000108.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]</H1>
    <B>Ferruh Mavituna</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%5BFwd%3A%20%5Bnetsec%5D%20WordPress%20Kritik%20Guvenlik%20Acigi%5D&In-Reply-To=BAY104-W20F5C7B3660631006806E7D6340%40phx.gbl"
       TITLE="[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]">ferruh at mavituna.com
       </A><BR>
    <I>Thu May 24 09:29:09 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000106.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
        <LI>Next message: <A HREF="000108.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107">[ date ]</a>
              <a href="thread.html#107">[ thread ]</a>
              <a href="subject.html#107">[ subject ]</a>
              <a href="author.html#107">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Bence giris noktasi kontrolleri cok verimli degil. 1-2 sene kadar 10 kisilik
falan bir ekibin calistigi bir web uygulamasinda (PHP) guvenli kutuphaneler
gelistirdik. Bu gelistirmede su sekilde bir yontem uyguladik ve bayagi da
verim aldik.

Herseyden ote direk GET ve POST vs. her turlu erisimleri gelistiriciye
kapadik. Dolayisiyla kod yazarlarken isteseler de bu verilere direk
ulasamiyorlardi.

Ikinci olarakta bu verilere erisimi ana obje altinda tek bir class tan
yaptik, eger sayfa HTML e cikti gidecekse HTMLSafe gibi bir isimli property
den koyuyorlar, eger SQL e gidecekse bunu da SQLsafe gibi bir property den.
Ek olarak girdinin ozune de de bazen erismek gerekiyor onu da ek olarak
koyduk erisime ama bu erisim cok basit sekilde yazilimda gozlenebiliyordu,
dolayisiyla potansiyel olarak guvensiz olan yerler anlasiliyor.

Maalasef PHP de strong type olmamasindan dolayi bazi limitleri implemente
etmedik. Mesela aynisi .NET te cok daha verimli sekilde yapilabilir.

Aslinda dumur noktasi su, bu adamlar niye parameterized SQL ler
kullanmiyorlar ?

Ikincisi basit bir sekilde kontrollerin son noktada yapilmasi katman
karmasasindan dogan buradaki gibi sorunlari da cozuyor. Katmandan kastim
kodun geldigi yeri bilmemek. Genelde web uygulamalarinda olan bir sey. WP
deki Bir onceki SQL Injeciton acigi da bu sekilde cache sistemindeydi (
<A HREF="http://www.notsosecure.com/folder2/2007/04/03/wordpress-212-xmlrpc-security-issues/">http://www.notsosecure.com/folder2/2007/04/03/wordpress-212-xmlrpc-security-issues/</A>
).

Eger acigi kaynak koddan takip ederseniz yaklasik 4 ten fazla fonksiyondan
geciyor ve neredeyse pasif olarak cacheleme ile ilgili bir yerde SQL
Injection olusuyor. Muhtemel bir skaynak kod analizinde bile gozden
kacabilecek bir sey.



On 24/05/07, Bedirhan Urgun &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">urgunb at hotmail.com</A>&gt; wrote:
&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  Girdi denetimini stratejilerinde denetimi sunucuda nerde yapmak gerekir
</I>&gt;<i> diye bi konu var. trust boundary, choke point meseleleri.
</I>&gt;<i>
</I>&gt;<i>  Acigin kaynak koduna baktim tam egitimlik (hatta tartismalik)...
</I>&gt;<i>
</I>&gt;<i> ******************
</I>&gt;<i> function check_ajax_referer() {
</I>&gt;<i> $cookie = explode('; ', urldecode(empty($_POST['cookie']) ?  &lt;&lt;------
</I>&gt;<i> $_GET['cookie'] : $_POST['cookie'])); // AJAX scripts must pass
</I>&gt;<i> cookie=document.cookie
</I>&gt;<i> foreach ( $cookie as $tasty ) {
</I>&gt;<i> if ( false !== strpos($tasty, USER_COOKIE) )
</I>&gt;<i> $user = substr(strstr($tasty, '='), 1);
</I>&gt;<i> if ( false !== strpos($tasty, PASS_COOKIE) )
</I>&gt;<i> $pass = substr(strstr($tasty, '='), 1);
</I>&gt;<i> }
</I>&gt;<i> if ( !wp_login( $user, $pass, true ) )
</I>&gt;<i> die('-1');
</I>&gt;<i> *******************
</I>&gt;<i>
</I>&gt;<i> simdi genel bir strateji olarak girdi denetimini soyle yapilabilir; Girdi
</I>&gt;<i> uygulamaya ulastigi en yakin noktada (choke point), daha ileri gitmeden. Ama
</I>&gt;<i> yukaridaki durum boyle bir denetimi by-pass edebilir. Mesela double url
</I>&gt;<i> encoded stringler (sunucu tarafindan uygulamaya gelmeden bir kere decode
</I>&gt;<i> edilmislerdi) pozitif denetim fonksiyonlarimizi atlatabilirler (tam
</I>&gt;<i> yukaridaki durum, yani regular expressionimizda % karakterine izin
</I>&gt;<i> veriliyorsa varsa tamam).
</I>&gt;<i>
</I>&gt;<i> Cok gelistiricili bir projede choke point falan yetmeyebiliyor demek ki.
</I>&gt;<i> Daha kademeli bir anlayis lazim. Gelistiriciye &quot;(giris noktasinda) girdi
</I>&gt;<i> denetimi yap&quot; dedikten sonra uygulamasinda boyle bi hata bulmak umutsuzluga
</I>&gt;<i> dusurebilir.
</I>&gt;<i>
</I>&gt;<i>  bedirhan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i> Date: Thu, 24 May 2007 09:49:57 +0100
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ferruh at mavituna.com</A>
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverip.net</A>
</I>&gt;<i> CC: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> Subject: Re: [Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik
</I>&gt;<i> Acigi]
</I>&gt;<i>
</I>&gt;<i> Biz de iki gun once test ettik, acik ilk yayinlandiginda. Gayet guzel bir
</I>&gt;<i> sekilde calistigini onayliyabilirim.
</I>&gt;<i>
</I>&gt;<i> Ek olarak her daim WP kulanicilarinin admin kisimlarina en azindan ekstra
</I>&gt;<i> bir Basic Auth eklemesini oneriyorum. Ek olarak  patch i  uygulayana kadar
</I>&gt;<i> bu sekilde hizli ilk onlemi de almis olabilirsiniz.
</I>&gt;<i>
</I>&gt;<i> On 24/05/07, *Huzeyfe ONAL* &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverip.net</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ---------------------------- Original Message ----------------------------
</I>&gt;<i> Subject: [netsec] WordPress Kritik Guvenlik Acigi
</I>&gt;<i> From: &quot;Huzeyfe ONAL&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverip.net</A>&gt;
</I>&gt;<i> Date: Thu, May 24, 2007 10:29 am
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">netsec at huzeyfe.net</A>
</I>&gt;<i> --------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> WordPress 2.1.3 kullanicilarinin
</I>&gt;<i> dikkatine...
</I>&gt;<i>
</I>&gt;<i> Bir iki gundur bloguma gelen web isteklerindeki
</I>&gt;<i> anormallikleri incelerken iki gun oncesine ait bir WP aciginin
</I>&gt;<i> kullanildigini kesfettim.
</I>&gt;<i>
</I>&gt;<i> wp-admin/admin-ajax.php ve buna bagli olan
</I>&gt;<i> scriptlerdeki eksik kontroller yuzunden blogunuzun /wp-admin kismina
</I>&gt;<i> erisebilen kotu niyetli birisi sistemdeki wp kullanicilarina ait
</I>&gt;<i> plain md5 ciktilarini alabilir(kendi sistemimde test ettim) ve
</I>&gt;<i> otesinde bunu kullanarak sisteme admin yetkileri ile
</I>&gt;<i> baglanilabiliyor(mus)-test etmedim.
</I>&gt;<i>
</I>&gt;<i> Cesitli undergorund
</I>&gt;<i> sitelerde konu ile ilgili exploitler yayinlanmis durumda.
</I>&gt;<i>
</I>&gt;<i> Aciktan korunma icin WP tarafindan cikarilan guncellemeler (2.2)
</I>&gt;<i> gecilebilir
</I>&gt;<i>
</I>&gt;<i> Detayli Bilgi :
</I>&gt;<i> <A HREF="http://secunia.com/advisories/25345/">http://secunia.com/advisories/25345/</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Huzeyfe ONAL
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverIP.net</A>
</I>&gt;<i> <A HREF="http://www.lifeoverip.net">http://www.lifeoverip.net</A>
</I>&gt;<i>
</I>&gt;<i> Ag guvenligi listesine uye oldunuz
</I>&gt;<i> mu?
</I>&gt;<i> <A HREF="http://netsec.huzeyfe.net">http://netsec.huzeyfe.net</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-turkey mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ferruh Mavituna
</I>&gt;<i> <A HREF="http://ferruh.mavituna.com">http://ferruh.mavituna.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i> Create the ultimate e-mail address book. Import your contacts to Windows
</I>&gt;<i> Live Hotmail. Try it!&lt;<A HREF="http://www.windowslive-hotmail.com/learnmore/managemail2.html?locale=en-us&amp;ocid=RMT_TAGLM_HMWL_reten_impcont_0507">http://www.windowslive-hotmail.com/learnmore/managemail2.html?locale=en-us&amp;ocid=RMT_TAGLM_HMWL_reten_impcont_0507</A>&gt;
</I>&gt;<i>
</I>


-- 
Ferruh Mavituna
<A HREF="http://ferruh.mavituna.com">http://ferruh.mavituna.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.owasp.org/pipermail/owasp-turkey/attachments/20070524/ce01cf5f/attachment.html">http://lists.owasp.org/pipermail/owasp-turkey/attachments/20070524/ce01cf5f/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000106.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
	<LI>Next message: <A HREF="000108.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#107">[ date ]</a>
              <a href="thread.html#107">[ thread ]</a>
              <a href="subject.html#107">[ subject ]</a>
              <a href="author.html#107">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
