<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%5BFwd%3A%20%5Bnetsec%5D%20WordPress%20Kritik%20Guvenlik%20Acigi%5D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000107.html">
   <LINK REL="Next"  HREF="000109.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]</H1>
    <B>Bedirhan Urgun</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%5BFwd%3A%20%5Bnetsec%5D%20WordPress%20Kritik%20Guvenlik%20Acigi%5D&In-Reply-To="
       TITLE="[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]">urgunb at hotmail.com
       </A><BR>
    <I>Thu May 24 14:25:49 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000107.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
        <LI>Next message: <A HREF="000109.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#108">[ date ]</a>
              <a href="thread.html#108">[ thread ]</a>
              <a href="subject.html#108">[ subject ]</a>
              <a href="author.html#108">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> 
 Tabi detayli olarak gormeden bisey demek cok mantikli degil ama sanki implement ettiginiz ana obje (class), choke point (girdi bogumu) gibi geldi bana. Hicbir girdi burdan gecmeden uygulamaya girmiyor (kullanilmiyor). Bunun icin de _GET ve _POST degiskenlerine ulasimi engellemissiniz sanirim. Gelistirici direk eristigi zaman kod icinde bu durumlar acikca goruluyor ve potansiyel olarak guvensiz durumlar (tainted variables gibi yani) oluyor.
 
 Okudugum bi makalede soyle bi ana fikir vardi: pozitif girdi kontrolunu (sunucu tarafinda) kullaniciya en yakin yerde yapin ama uygulamanin icinde yeri geldiginde mantiksal girdi denetimleri de uygulayin. Mesela kredi karti numarasini uygulama girisinde kontrol edin (sadece rakamlardan olusacak), ama bu kredi karti bilgisini business object'lerde kullanacaginiz zaman, kredi karti numarasi algoritmalarini uzerinde uygulayin (mantiksal olarak bu gercekten kredi karti numarasi mi).
 
 Soylemesi kolay. Her orta capta program yazan, bunlari uygulanmanin ne kadar zor geldigini cok iyi bilir. Burda da guvenlik kutuphaneler yardima yetisebilir.
 
 


Date: Thu, 24 May 2007 14:29:09 +0100From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ferruh at mavituna.comTo</A>: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">urgunb at hotmail.comSubject</A>: Re: [Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]CC: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverip.net</A>; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey at lists.owasp.orgBence</A> giris noktasi kontrolleri cok verimli degil. 1-2 sene kadar 10 kisilik falan bir ekibin calistigi bir web uygulamasinda (PHP) guvenli kutuphaneler gelistirdik. Bu gelistirmede su sekilde bir yontem uyguladik ve bayagi da verim aldik. Herseyden ote direk GET ve POST vs. her turlu erisimleri gelistiriciye kapadik. Dolayisiyla kod yazarlarken isteseler de bu verilere direk ulasamiyorlardi. Ikinci olarakta bu verilere erisimi ana obje altinda tek bir class tan yaptik, eger sayfa HTML e cikti gidecekse HTMLSafe gibi bir isimli property den koyuyorlar, eger SQL e gidecekse bunu da SQLsafe gibi bir property den. Ek olarak girdinin ozune de de bazen erismek gerekiyor onu da ek olarak koyduk erisime ama bu erisim cok basit sekilde yazilimda gozlenebiliyordu, dolayisiyla potansiyel olarak guvensiz olan yerler anlasiliyor. Maalasef PHP de strong type olmamasindan dolayi bazi limitleri implemente etmedik. Mesela aynisi .NET te cok daha verimli sekilde yapilabilir.Aslinda dumur noktasi su, bu adamlar niye parameterized SQL ler kullanmiyorlar ? Ikincisi basit bir sekilde kontrollerin son noktada yapilmasi katman karmasasindan dogan buradaki gibi sorunlari da cozuyor. Katmandan kastim kodun geldigi yeri bilmemek. Genelde web uygulamalarinda olan bir sey. WP deki Bir onceki SQL Injeciton acigi da bu sekilde cache sistemindeydi ( <A HREF="http://www.notsosecure.com/folder2/2007/04/03/wordpress-212-xmlrpc-security-issues/">http://www.notsosecure.com/folder2/2007/04/03/wordpress-212-xmlrpc-security-issues/</A>).Eger acigi kaynak koddan takip ederseniz yaklasik 4 ten fazla fonksiyondan geciyor ve neredeyse pasif olarak cacheleme ile ilgili bir yerde SQL Injection olusuyor. Muhtemel bir skaynak kod analizinde bile gozden kacabilecek bir sey. 

On 24/05/07, Bedirhan Urgun &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">urgunb at hotmail.com</A>&gt; wrote: 

 Girdi denetimini stratejilerinde denetimi sunucuda nerde yapmak gerekir diye bi konu var. trust boundary, choke point meseleleri.  Acigin kaynak koduna baktim tam egitimlik (hatta tartismalik)... ******************function check_ajax_referer() {$cookie = explode('; ', urldecode(empty($_POST['cookie']) ?  &lt;&lt;------$_GET['cookie'] : $_POST['cookie'])); // AJAX scripts must passcookie=document.cookieforeach ( $cookie as $tasty ) { if ( false !== strpos($tasty, USER_COOKIE) )$user = substr(strstr($tasty, '='), 1);if ( false !== strpos($tasty, PASS_COOKIE) )$pass = substr(strstr($tasty, '='), 1);}if ( !wp_login( $user, $pass, true ) ) die('-1');******************* simdi genel bir strateji olarak girdi denetimini soyle yapilabilir; Girdi uygulamaya ulastigi en yakin noktada (choke point), daha ileri gitmeden. Ama yukaridaki durum boyle bir denetimi by-pass edebilir. Mesela double url encoded stringler (sunucu tarafindan uygulamaya gelmeden bir kere decode edilmislerdi) pozitif denetim fonksiyonlarimizi atlatabilirler (tam yukaridaki durum, yani regular expressionimizda % karakterine izin veriliyorsa varsa tamam).   Cok gelistiricili bir projede choke point falan yetmeyebiliyor demek ki. Daha kademeli bir anlayis lazim. Gelistiriciye &quot;(giris noktasinda) girdi denetimi yap&quot; dedikten sonra uygulamasinda boyle bi hata bulmak umutsuzluga dusurebilir.  bedirhan 


Date: Thu, 24 May 2007 09:49:57 +0100From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ferruh at mavituna.comTo</A>: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverip.netCC</A>: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey at lists.owasp.orgSubject</A>: Re: [Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi] 
Biz de iki gun once test ettik, acik ilk yayinlandiginda. Gayet guzel bir sekilde calistigini onayliyabilirim.Ek olarak her daim WP kulanicilarinin admin kisimlarina en azindan ekstra bir Basic Auth eklemesini oneriyorum. Ek olarak  patch i  uygulayana kadar bu sekilde hizli ilk onlemi de almis olabilirsiniz. 
On 24/05/07, Huzeyfe ONAL &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverip.net</A>&gt; wrote: 
---------------------------- Original Message ----------------------------Subject: [netsec] WordPress Kritik Guvenlik AcigiFrom: &quot;Huzeyfe ONAL&quot; &lt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">huzeyfe at lifeoverip.net</A>&gt;Date: Thu, May 24, 2007 10:29 amTo: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">netsec at huzeyfe.net--------------------------------------------------------------------------</A> WordPress 2.1.3 kullanicilarinindikkatine...Bir iki gundur bloguma gelen web isteklerindekianormallikleri incelerken iki gun oncesine ait bir WP acigininkullanildigini kesfettim.wp-admin/admin-ajax.php ve buna bagli olanscriptlerdeki eksik kontroller yuzunden blogunuzun /wp-admin kisminaerisebilen kotu niyetli birisi sistemdeki wp kullanicilarina aitplain md5 ciktilarini alabilir(kendi sistemimde test ettim) ve otesinde bunu kullanarak sisteme admin yetkileri ilebaglanilabiliyor(mus)-test etmedim.Cesitli undergorundsitelerde konu ile ilgili exploitler yayinlanmis durumda. Aciktan korunma icin WP tarafindan cikarilan guncellemeler ( 2.2)gecilebilir Detayli Bilgi :<A HREF="http://secunia.com/advisories/25345/--Huzeyfe">http://secunia.com/advisories/25345/--Huzeyfe</A> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ONALhuzeyfe at lifeoverIP.nethttp</A>://www.lifeoverip.netAg guvenligi listesine uye oldunuzmu?<A HREF="http://netsec.huzeyfe.net_______________________________________________">http://netsec.huzeyfe.net_______________________________________________</A> Owasp-turkey mailing <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">listOwasp-turkey at lists.owasp.org</A> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey--">https://lists.owasp.org/mailman/listinfo/owasp-turkey--</A> Ferruh <A HREF="Mavitunahttp://ferruh.mavituna.com">Mavitunahttp://ferruh.mavituna.com</A> 

Create the ultimate e-mail address book. Import your contacts to Windows Live Hotmail. Try it!-- Ferruh <A HREF="Mavitunahttp://ferruh.mavituna.com">Mavitunahttp://ferruh.mavituna.com</A> 
_________________________________________________________________
Change is good. See what&#8217;s different about Windows Live Hotmail. 
<A HREF="http://www.windowslive-hotmail.com/learnmore/default.html?locale=en-us&amp;ocid=RMT_TAGLM_HMWL_reten_changegood_0507">http://www.windowslive-hotmail.com/learnmore/default.html?locale=en-us&amp;ocid=RMT_TAGLM_HMWL_reten_changegood_0507</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.owasp.org/pipermail/owasp-turkey/attachments/20070524/df8fdb41/attachment.html">http://lists.owasp.org/pipermail/owasp-turkey/attachments/20070524/df8fdb41/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000107.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
	<LI>Next message: <A HREF="000109.html">[Owasp-turkey] [Fwd: [netsec] WordPress Kritik Guvenlik Acigi]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#108">[ date ]</a>
              <a href="thread.html#108">[ thread ]</a>
              <a href="subject.html#108">[ subject ]</a>
              <a href="author.html#108">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
