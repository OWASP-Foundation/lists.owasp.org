<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] Dom Based XSS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-turkey%5D%20Dom%20Based%20XSS&In-Reply-To=%3CCALNZ6-%2BCRAAFQxUXW_LBk_p%3DZGcvFT7ixmsemspNVNaNRgNnJA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001751.html">
   <LINK REL="Next"  HREF="001753.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] Dom Based XSS</H1>
    <B>Bedirhan Urgun</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-turkey%5D%20Dom%20Based%20XSS&In-Reply-To=%3CCALNZ6-%2BCRAAFQxUXW_LBk_p%3DZGcvFT7ixmsemspNVNaNRgNnJA%40mail.gmail.com%3E"
       TITLE="[Owasp-turkey] Dom Based XSS">bedirhanurgun at gmail.com
       </A><BR>
    <I>Wed Apr  2 09:34:20 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001751.html">[Owasp-turkey] Dom Based XSS
</A></li>
        <LI>Next message: <A HREF="001753.html">[Owasp-turkey] Dom Based XSS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1752">[ date ]</a>
              <a href="thread.html#1752">[ thread ]</a>
              <a href="subject.html#1752">[ subject ]</a>
              <a href="author.html#1752">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>ismine dom based demelerinin nedeni buyuk ihtimal sink'in javascript
API'lari olmasi (DOM'u manipule etmenin en temel yolu JS DOM API'leri
cunku). Ornegin document.write, element.setHTML gibi... Tabi ki payload
icin de bu API'lere ihtiyacimiz var ama mesele bu degil. Yani asagidaki DOM
based degil.

&lt;script&gt;
  var s = &quot;INJECTION_HERE&quot;;
&lt;/script&gt;

Ancak developer'in bilincli olarak yazdigi JSON veriyi alip, img elementi
olusturan uygulamada olusan xss'ler dom based. Cunku sink, developer'in
kullandigi JS API'ler. Bu acidan bakarsak sadece bir payload'un sunucuya
gitmeme durumunu DOM Based olarak tanimlayamiyoruz. Diger taraftan boyle
bir tanim cok daha basit ve anlasilabilir.

Bu tur zafiyetleri developer'lara anlatmamiz gerekliligini dusunursek belki
de hic DOM Based v.s olayina girmeden yani cok kafa karistirmadan
reflected/stored olarak tanimlamaliyiz. Cunku cozum belli aslinda, istemci
veya sunucu tarafinda dogru encoding'i kullanmak... Bilemiyorum tabi
siniflandirma da isi daha bir onemli gibi gostermiyor degil :)


1 Nisan 2014 16:52 tarihinde Canberk BOLAT &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">canberk.bolat at gmail.com</A>&gt; yazd&#305;:

&gt;<i> Deniz hocam,
</I>&gt;<i>
</I>&gt;<i> Bence Dom-based XSS'tir. Output encoding yapildigini varsaydigimiz icin
</I>&gt;<i> XSS DOM Level'da tetikleniyor, sadece source biraz muamma ama sink yine DOM
</I>&gt;<i> tabanli.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 1 Nisan 2014 16:27 tarihinde Deniz &#199;evik &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">deniz at biznet.com.tr</A>&gt; yazd&#305;:
</I>&gt;<i>
</I>&gt;<i> Merhaba
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Bu durumda XSS olu&#351;mas&#305;n&#305; engellemek i&#231;in encode edilerek olu&#351;turularak
</I>&gt;&gt;<i> &#252;retilen bir &#231;&#305;kt&#305;, (normalde xss olu&#351;turmayacak bir response &lt;img
</I>&gt;&gt;<i> src=1&gt; gibi) e&#287;er bir javascript k&#252;t&#252;phanesi taraf&#305;ndan (&#246;rne&#287;in jquery)
</I>&gt;&gt;<i> &#231;al&#305;&#351;t&#305;r&#305;l&#305;yor ve XSS olu&#351;mas&#305;na neden oluyor ise bu DOM based&#8217;mi dir,
</I>&gt;&gt;<i> reflected&#8217;mi dir.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> *From:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey-bounces at lists.owasp.org</A> [mailto:
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey-bounces at lists.owasp.org</A>] *On Behalf Of *Mehmet Dursun Ince
</I>&gt;&gt;<i> *Sent:* Tuesday, April 01, 2014 11:34 AM
</I>&gt;&gt;<i> *To:* OWASP-Turkey Chapter
</I>&gt;&gt;<i> *Subject:* Re: [Owasp-turkey] Dom Based XSS
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Merhaba
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Isin icerisinde JS oldugunda DOM based demek bana gore yanlis. Ornegin
</I>&gt;&gt;<i> user inputu render edilen sayfada script tagleri arasina yaziliyorsa bu
</I>&gt;&gt;<i> in-line javascript payloadi ile exploit edilebilmekte. Bu durumda da olayin
</I>&gt;&gt;<i> DOM Xss ile ifade edilmesi cok yanlis. Bu ornekledigim zafiyet Reflected
</I>&gt;&gt;<i> Xss olarak adlandirilmalidir. Bir baska ornek olarak mesela kullanicin
</I>&gt;&gt;<i> isimi javascript degiskeni olarak html sayfada kullanildiysa bu durum icin
</I>&gt;&gt;<i> Stored Xss demek daha dogrudur bence.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yani ozetle -bence- payloadin uygulamaya erisim sekline gore
</I>&gt;&gt;<i> siniflandirma yapilmalidir. Ister JS kodu icerisinde olsun isterse html tag
</I>&gt;&gt;<i> eger POST/GET talebinde donen sayfada zafiyet varsa Reflected. Herhangi bir
</I>&gt;&gt;<i> DB vb yapi uzerinde payloadin saklanma durum varsa Stored. Server side
</I>&gt;&gt;<i> tarafina hic iletilmeyen degiskenlerin oldugu durumlarda ise DOM based
</I>&gt;&gt;<i> olarak adlandirilmali.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 1 Apr 2014 11:20, &quot;Bedirhan Urgun&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">bedirhanurgun at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Merhaba,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> DOM Based XSS'i di&#287;er XSS tiplerinden ay&#305;ran &#231;ok belirgin bir farkl&#305;l&#305;k
</I>&gt;&gt;<i> var m&#305;d&#305;r? Farkl&#305;l&#305;klar&#305;n&#305; belirtmek isteniz nas&#305;l belirtirdiniz? Basit
</I>&gt;&gt;<i> &#246;rnekler ile cevaplamak isteyen olursa memnun oluruz.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi&#231; sunucu taraf&#305;na gitmeyen bir durum olas&#305;l&#305;&#287;&#305; varsa DOMBased mi
</I>&gt;&gt;<i> demeliyiz, JS'nin i&#351;in i&#231;ine bula&#351;t&#305;&#287;&#305; her xss DOMBased mi olur, yoksa
</I>&gt;&gt;<i> source/sink s&#305;n&#305;fland&#305;rmas&#305;n&#305; yap&#305;p i&#351;in c&#305;lk&#305;n&#305; m&#305; &#231;&#305;karmal&#305;y&#305;z? v.b.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> bedirhan
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-turkey mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-turkey mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Canberk Bolat
</I>&gt;<i> Security Researcher
</I>&gt;<i> <A HREF="http://twitter.com/cnbrkbolat">http://twitter.com/cnbrkbolat</A>
</I>&gt;<i> <A HREF="http://cbolat.blogspot.com">http://cbolat.blogspot.com</A>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-turkey mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 

bedirhan urgun
-------------- sonraki b&#65533;l&#65533;m --------------
Bir HTML eklentisi temizlendi...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-turkey/attachments/20140402/3b7df62f/attachment.html">http://lists.owasp.org/pipermail/owasp-turkey/attachments/20140402/3b7df62f/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001751.html">[Owasp-turkey] Dom Based XSS
</A></li>
	<LI>Next message: <A HREF="001753.html">[Owasp-turkey] Dom Based XSS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1752">[ date ]</a>
              <a href="thread.html#1752">[ thread ]</a>
              <a href="subject.html#1752">[ subject ]</a>
              <a href="author.html#1752">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
