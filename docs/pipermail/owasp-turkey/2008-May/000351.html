<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] DoS attacks using SQL Wildcards
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20DoS%20attacks%20using%20SQL%20Wildcards&In-Reply-To=6dc88c3c0805190524w48664d3bvbd57e8b6750ed386%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000350.html">
   <LINK REL="Next"  HREF="000352.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] DoS attacks using SQL Wildcards</H1>
    <B>Bedirhan Urgun</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20DoS%20attacks%20using%20SQL%20Wildcards&In-Reply-To=6dc88c3c0805190524w48664d3bvbd57e8b6750ed386%40mail.gmail.com"
       TITLE="[Owasp-turkey] DoS attacks using SQL Wildcards">urgunb at hotmail.com
       </A><BR>
    <I>Tue May 20 09:42:55 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000350.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
        <LI>Next message: <A HREF="000352.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#351">[ date ]</a>
              <a href="thread.html#351">[ thread ]</a>
              <a href="subject.html#351">[ subject ]</a>
              <a href="author.html#351">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> merhaba,tebrik ederim Ferruh. 
 
Yazidaki teknik ile alakali olarak bugun Yusuf &#199;eri ile farkettigimiz bi noktayi paylasmak istedim. Eger modsecurity ile korunan sisteminiz (veya baska bir WAF), yazida belirtilen asagidaki payloadu reddiyorsa 
 
'%_[^!_%/%a?F%_D)_(F%)_%([)({}%){()}&#163;$&amp;N%_)$*&#163;()$*R&quot;_)][%](%[x])%a][$*&quot;&#163;$-9]_%' 
 
bu saldiriya acik degiliz anlamina gelmiyor. Yukaridaki payload'un basit bir bypass teknigi uygulanmis hali;
 
'%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}&#163;$&amp;N%55_)$*&#163;()$*R&quot;_)][%55](%66[x])%ba][$*&quot;&#163;$-9]_%54'
 
Yani payloaddaki % yerine gecerli bir url encoded karakter giriliyor (ascii 32'den buyuk olmasi daha iyi cunku 0-32 [non-printables] arasi reddediliyor olarak ayarlanmis olabilir ilgili WAF'da).
Peki arkada donen ne? modsec hatirladigim kadari ile &quot;double encoding&quot; saldirilarini engellemek icin aldigi input'u bir daha decode edip, URL denetimini bir daha gercekliyor. Ve boylece mesela
 
%a -&gt; %25a -&gt; modsec -&gt; %25a (gecerli URL encoding) -&gt; %a (gecersiz URL encoding) = istek reddedilir
 
ama by-pass teknigi ile
 
%aa -&gt; %25aa -&gt; modsec -&gt; %25aa (gecerli URL encoding) -&gt; %aa (gecerli URL ending) = istek onaylanir
 
 
bedirhan
 


Date: Mon, 19 May 2008 13:24:29 +0100From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ferruh at mavituna.comTo</A>: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey at lists.owasp.orgSubject</A>: [Owasp-turkey] DoS attacks using SQL WildcardsHerkese Selamlar,Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim, burada da hem paylasmak hem de konu hakkinda fikir almak istedim. Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor, dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali gerekli.Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP Guide da bu konuda bir seyler ekleyebiliriz.Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:<A HREF="http://www.portcullis-security.com/uplds/wildcard_attacks.pdfIyi">http://www.portcullis-security.com/uplds/wildcard_attacks.pdfIyi</A> Calismalar,-- Ferruh <A HREF="Mavitunahttp://ferruh.mavituna.com">Mavitunahttp://ferruh.mavituna.com</A> 
_________________________________________________________________
E-mail for the greater good. Join the i&#8217;m Initiative from Microsoft.
<A HREF="http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_">http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_</A> GreaterGood
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/aaa8ca37/attachment.html">https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/aaa8ca37/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000350.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
	<LI>Next message: <A HREF="000352.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#351">[ date ]</a>
              <a href="thread.html#351">[ thread ]</a>
              <a href="subject.html#351">[ subject ]</a>
              <a href="author.html#351">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
