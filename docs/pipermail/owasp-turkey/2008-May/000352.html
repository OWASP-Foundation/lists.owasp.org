<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] DoS attacks using SQL Wildcards
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20DoS%20attacks%20using%20SQL%20Wildcards&In-Reply-To=BAY104-W22026B70C99FE6E76B00C7D6C40%40phx.gbl">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000351.html">
   <LINK REL="Next"  HREF="000353.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] DoS attacks using SQL Wildcards</H1>
    <B>Ferruh Mavituna</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20DoS%20attacks%20using%20SQL%20Wildcards&In-Reply-To=BAY104-W22026B70C99FE6E76B00C7D6C40%40phx.gbl"
       TITLE="[Owasp-turkey] DoS attacks using SQL Wildcards">ferruh at mavituna.com
       </A><BR>
    <I>Tue May 20 10:03:16 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000351.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
        <LI>Next message: <A HREF="000353.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#352">[ date ]</a>
              <a href="thread.html#352">[ thread ]</a>
              <a href="subject.html#352">[ subject ]</a>
              <a href="author.html#352">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Merhabalar,

Tesekkurler Bedirhan, paylastiginiz nokta ilgincmis benim modsecurity hic
aklima gelmemisti o sirada. Ek olarak payload cok daha farkli sekillerde de
yapilabilir, senin gosterdigin ve buldugunuz yontem de bunun gibi.

Mesela benim gene dokumanda verdigim basit bir ornek var : _[r/a)_ _(r/b)_
_(r-d)_

Gayet kisa ve benim testimdeki bir web forum yaziliminda 30+ sn. suruyor
calismasi :), yazilim detaylarini burada veremiyorum, kendilerine de acik
olarak bildirdim zaten ama sadece durumun vehametini ortaya koymak adina. Bu
yazilimda mesela 15 karakter gibi bir limit vardi, ama ona ragment
yukaridaki basit arama yetti.

Bu arada karsimiza geldiginde bypass edebilmek icin bu double encoding
olayini akilda tutmak lazim.

2008/5/20 Bedirhan Urgun &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">urgunb at hotmail.com</A>&gt;:

&gt;<i>
</I>&gt;<i>  merhaba,
</I>&gt;<i> tebrik ederim Ferruh.
</I>&gt;<i>
</I>&gt;<i> Yazidaki teknik ile alakali olarak bugun Yusuf &#199;eri ile farkettigimiz bi
</I>&gt;<i> noktayi paylasmak istedim. Eger modsecurity ile korunan sisteminiz (veya
</I>&gt;<i> baska bir WAF), yazida belirtilen asagidaki payloadu reddiyorsa
</I>&gt;<i>
</I>&gt;<i> '%_[^!_%/%a?F%_D)_(F%)_%([)({}%){()}&#163;$&amp;N%_)$*&#163;()$*R&quot;_)][%](%[x])%a][$*&quot;&#163;$-9]_%'
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> bu saldiriya acik degiliz anlamina gelmiyor. Yukaridaki payload'un basit
</I>&gt;<i> bir bypass teknigi uygulanmis hali;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> '%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}&#163;$&amp;N%55_)$*&#163;()$*R&quot;_)][%55](%66[x])%ba][$*&quot;&#163;$-9]_%54'
</I>&gt;<i>
</I>&gt;<i> Yani payloaddaki % yerine gecerli bir url encoded karakter giriliyor (ascii
</I>&gt;<i> 32'den buyuk olmasi daha iyi cunku 0-32 [non-printables] arasi reddediliyor
</I>&gt;<i> olarak ayarlanmis olabilir ilgili WAF'da).
</I>&gt;<i>
</I>&gt;<i> Peki arkada donen ne? modsec hatirladigim kadari ile &quot;double encoding&quot;
</I>&gt;<i> saldirilarini engellemek icin aldigi input'u bir daha decode edip, URL
</I>&gt;<i> denetimini bir daha gercekliyor. Ve boylece mesela
</I>&gt;<i>
</I>&gt;<i> %a -&gt; %25a -&gt; modsec -&gt; %25a (gecerli URL encoding) -&gt; %a (*gecersiz *URL
</I>&gt;<i> encoding) = istek reddedilir
</I>&gt;<i>
</I>&gt;<i> ama by-pass teknigi ile
</I>&gt;<i>
</I>&gt;<i> %aa -&gt; %25aa -&gt; modsec -&gt; %25aa (gecerli URL encoding) -&gt; %aa (*gecerli *URL
</I>&gt;<i> ending) = istek onaylanir
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> bedirhan
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i> Date: Mon, 19 May 2008 13:24:29 +0100
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ferruh at mavituna.com</A>
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Herkese Selamlar,
</I>&gt;<i>
</I>&gt;<i> Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim,
</I>&gt;<i> burada da hem paylasmak hem de konu hakkinda fikir almak istedim.
</I>&gt;<i>
</I>&gt;<i> Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer
</I>&gt;<i> sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.
</I>&gt;<i> Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor,
</I>&gt;<i> dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali
</I>&gt;<i> gerekli.
</I>&gt;<i>
</I>&gt;<i> Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test
</I>&gt;<i> metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP
</I>&gt;<i> Guide da bu konuda bir seyler ekleyebiliriz.
</I>&gt;<i>
</I>&gt;<i> Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.portcullis-security.com/uplds/wildcard_attacks.pdf">http://www.portcullis-security.com/uplds/wildcard_attacks.pdf</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Iyi Calismalar,
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ferruh Mavituna
</I>&gt;<i> <A HREF="http://ferruh.mavituna.com">http://ferruh.mavituna.com</A>
</I>&gt;<i>
</I>&gt;<i> ------------------------------
</I>&gt;<i> E-mail for the greater good. Join the i'm Initiative from Microsoft.&lt;<A HREF="http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_+GreaterGood">http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_+GreaterGood</A>&gt;
</I>&gt;<i>
</I>


-- 
Ferruh Mavituna
<A HREF="http://ferruh.mavituna.com">http://ferruh.mavituna.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/f6f73095/attachment.html">https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/f6f73095/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000351.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
	<LI>Next message: <A HREF="000353.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#352">[ date ]</a>
              <a href="thread.html#352">[ thread ]</a>
              <a href="subject.html#352">[ subject ]</a>
              <a href="author.html#352">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
