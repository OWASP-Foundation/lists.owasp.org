<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] DoS attacks using SQL Wildcards
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20DoS%20attacks%20using%20SQL%20Wildcards&In-Reply-To=6dc88c3c0805200703m2ced3cc4j323eb2fee97e4a48%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000352.html">
   <LINK REL="Next"  HREF="000354.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] DoS attacks using SQL Wildcards</H1>
    <B>Bedirhan Urgun</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20DoS%20attacks%20using%20SQL%20Wildcards&In-Reply-To=6dc88c3c0805200703m2ced3cc4j323eb2fee97e4a48%40mail.gmail.com"
       TITLE="[Owasp-turkey] DoS attacks using SQL Wildcards">urgunb at hotmail.com
       </A><BR>
    <I>Thu May 22 03:26:39 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000352.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
        <LI>Next message: <A HREF="000354.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#353">[ date ]</a>
              <a href="thread.html#353">[ thread ]</a>
              <a href="subject.html#353">[ subject ]</a>
              <a href="author.html#353">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Merhaba,
Dun ve bugun test ettigimiz sistemlerde, Ferruh'un makalesindeki teknikleri denedik.
Yazida da belirttigi gibi en onemli nokta &quot;denemek&quot;. Cunku her payload (sorgu bolumu) her durumda iyi sonuclar vermiyor. Yeni bi tane bulmak gerekebiliyor. Mesela bi sayfada asagidaki yeni payload tek istekte ~20sn tutuyor, character negation trick ;)
 
%n[^n]y[^j]l[^k]d[^l]h[^z]t[^k]b[^q]t[^q][^n]!%
 
Ama onemli olan bi nokta daha var. Aramanin hangi field'lar da yapildigi. Mesela metin (text, blob) sutunlarda arama yapiliyorsa yukaridaki gecerli. Sadece varchar(~50) gibi sutunlarda arama yapan yerlerde (ASP.NET-&gt;MSSQL) bu teknikleri kararli kullanamadim simdiye kadar. Hatta bu farkliliga gore bile payloadlar degistirilebilir. Belki fuzzer gibi bisey kullanmak lazim.bedirhan


Date: Tue, 20 May 2008 15:03:16 +0100From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ferruh at mavituna.comTo</A>: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">urgunb at hotmail.comSubject</A>: Re: [Owasp-turkey] DoS attacks using SQL WildcardsCC: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey at lists.owasp.orgMerhabalar</A>, Tesekkurler Bedirhan, paylastiginiz nokta ilgincmis benim modsecurity hic aklima gelmemisti o sirada. Ek olarak payload cok daha farkli sekillerde de yapilabilir, senin gosterdigin ve buldugunuz yontem de bunun gibi.Mesela benim gene dokumanda verdigim basit bir ornek var : _[r/a)_ _(r/b)_ _(r-d)_ Gayet kisa ve benim testimdeki bir web forum yaziliminda 30+ sn. suruyor calismasi :), yazilim detaylarini burada veremiyorum, kendilerine de acik olarak bildirdim zaten ama sadece durumun vehametini ortaya koymak adina. Bu yazilimda mesela 15 karakter gibi bir limit vardi, ama ona ragment yukaridaki basit arama yetti.Bu arada karsimiza geldiginde bypass edebilmek icin bu double encoding olayini akilda tutmak lazim.
2008/5/20 Bedirhan Urgun &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">urgunb at hotmail.com</A>&gt;:

 merhaba,tebrik ederim Ferruh.  Yazidaki teknik ile alakali olarak bugun Yusuf &#199;eri ile farkettigimiz bi noktayi paylasmak istedim. Eger modsecurity ile korunan sisteminiz (veya baska bir WAF), yazida belirtilen asagidaki payloadu reddiyorsa  '%_[^!_%/%a?F%_D)_(F%)_%([)({}%){()}&#163;$&amp;N%_)$*&#163;()$*R&quot;_)][%](%[x])%a][$*&quot;&#163;$-9]_%'  bu saldiriya acik degiliz anlamina gelmiyor. Yukaridaki payload'un basit bir bypass teknigi uygulanmis hali; '%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}&#163;$&amp;N%55_)$*&#163;()$*R&quot;_)][%55](%66[x])%ba][$*&quot;&#163;$-9]_%54' Yani payloaddaki % yerine gecerli bir url encoded karakter giriliyor (ascii 32'den buyuk olmasi daha iyi cunku 0-32 [non-printables] arasi reddediliyor olarak ayarlanmis olabilir ilgili WAF'da).Peki arkada donen ne? modsec hatirladigim kadari ile &quot;double encoding&quot; saldirilarini engellemek icin aldigi input'u bir daha decode edip, URL denetimini bir daha gercekliyor. Ve boylece mesela %a -&gt; %25a -&gt; modsec -&gt; %25a (gecerli URL encoding) -&gt; %a (gecersiz URL encoding) = istek reddedilir ama by-pass teknigi ile %aa -&gt; %25aa -&gt; modsec -&gt; %25aa (gecerli URL encoding) -&gt; %aa (gecerli URL ending) = istek onaylanir  bedirhan 

Date: Mon, 19 May 2008 13:24:29 +0100From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">ferruh at mavituna.comTo</A>: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey at lists.owasp.orgSubject</A>: [Owasp-turkey] DoS attacks using SQL Wildcards


Herkese Selamlar,Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim, burada da hem paylasmak hem de konu hakkinda fikir almak istedim. Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor, dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali gerekli.Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP Guide da bu konuda bir seyler ekleyebiliriz.Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:<A HREF="http://www.portcullis-security.com/uplds/wildcard_attacks.pdfIyi">http://www.portcullis-security.com/uplds/wildcard_attacks.pdfIyi</A> Calismalar,-- Ferruh <A HREF="Mavitunahttp://ferruh.mavituna.com">Mavitunahttp://ferruh.mavituna.com</A> 

E-mail for the greater good. Join the i'm Initiative from Microsoft.-- Ferruh <A HREF="Mavitunahttp://ferruh.mavituna.com">Mavitunahttp://ferruh.mavituna.com</A> 
_________________________________________________________________
Change the world with e-mail. Join the i&#8217;m Initiative from Microsoft.
<A HREF="http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_ChangeWorld">http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_ChangeWorld</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080522/d0fd8c01/attachment.html">https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080522/d0fd8c01/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000352.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
	<LI>Next message: <A HREF="000354.html">[Owasp-turkey] DoS attacks using SQL Wildcards
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#353">[ date ]</a>
              <a href="thread.html#353">[ thread ]</a>
              <a href="subject.html#353">[ subject ]</a>
              <a href="author.html#353">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
