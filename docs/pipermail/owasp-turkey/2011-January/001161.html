<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-turkey] Content-Disposition Ba&#351;l&#305;k Bilgisi &#220;zerine
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%0A%09%3D%3Futf-8%3Fq%3FContent-Disposition_Ba%3DC5%3D9Fl%3DC4%3DB1k_Bil%3F%3D%0A%09%3D%3Futf-8%3Fq%3Fgisi_%3DC3%3D9Czerine%3F%3D&In-Reply-To=000801cbb885%242727ec00%247577c400%24%40info">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001158.html">
   <LINK REL="Next"  HREF="001159.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-turkey] Content-Disposition Ba&#351;l&#305;k Bilgisi &#220;zerine</H1>
    <B>Bedirhan Urgun</B> 
    <A HREF="mailto:owasp-turkey%40lists.owasp.org?Subject=%5BOwasp-turkey%5D%0A%09%3D%3Futf-8%3Fq%3FContent-Disposition_Ba%3DC5%3D9Fl%3DC4%3DB1k_Bil%3F%3D%0A%09%3D%3Futf-8%3Fq%3Fgisi_%3DC3%3D9Czerine%3F%3D&In-Reply-To=000801cbb885%242727ec00%247577c400%24%40info"
       TITLE="[Owasp-turkey] Content-Disposition Ba&#351;l&#305;k Bilgisi &#220;zerine">bedirhanurgun at gmail.com
       </A><BR>
    <I>Thu Jan 20 07:54:08 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="001158.html">[Owasp-turkey] Content-Disposition Ba&#351;l&#305;k Bilgisi &#220;zerine
</A></li>
        <LI>Next message: <A HREF="001159.html">[Owasp-turkey] WAF Tester
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1161">[ date ]</a>
              <a href="thread.html#1161">[ thread ]</a>
              <a href="subject.html#1161">[ subject ]</a>
              <a href="author.html#1161">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://msdn.microsoft.com/en-us/library/system.net.mime.contentdisposition.filename.aspx">http://msdn.microsoft.com/en-us/library/system.net.mime.contentdisposition.filename.aspx</A>

Yukaridaki linkte soyle bir ibare geciyor (okunmasi gerekeni yer kalin
olarak isaretledim);

*&quot;The FileName property allows the sender to suggest the name to be used to
store an e-mail attachment on the recipient's computer. This name is a
suggestion only; the receiving system can ignore it. The name must not
include path information; any such information is ignored by the receiving
computer.*&quot;

Yani, ozelde ASP.NET icin konusursak,
myC*ontentDisposition.FileName*field'ini set ederken path bilgisini
cikararak kullanmak guvenli olan
yoldur. Mesela bu is icin
*System.IO.FileInfo.FullName* yerine *System.IO.FileInfo.Name *field'i
kullanilmali... veya *Path.GetFileName(myFileName) *kullanilmali.
Simdi senin test ettigin duruma donersek, developer anladigim kadari ile
kullanicidan (saldirgandan) gelen dosya ismini direk olarak
Content-Disposition'a set etmemis. Once TextReader gibi bir wrapper ile
okumus sonra bu streamden dosya ismini cikarirken fullname'i almis.
Content-Disposition meselesini bir kenara birakirsak, direk download'a izin
verilmemeli, verilecekse de dosya isimleri kontrol edilmeli.

<A HREF="http://www.owasp.org/index.php/File_System#Path_traversal">http://www.owasp.org/index.php/File_System#Path_traversal</A>


20 Ocak 2011 11:33 tarihinde Onur YILMAZ &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">contact at onuryilmaz.info</A>&gt; yazd&#196;&#177;:

&gt;<i>        Peki bu ba&#197;&#159;l&#196;&#177;kta ki dosya yolu s&#196;&#177;zmas&#196;&#177;n&#196;&#177;n
</I>&gt;<i>        sebebi uygulama m&#196;&#177; yoksa sunucunun konfig&#195;&#188;rasyonu mu?
</I>&gt;<i>
</I>&gt;<i> Uygulamadan kaynaklan&#196;&#177;yor;
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://msdn.microsoft.com/tr-tr/library/system.net.mail.attachment.contentdi">http://msdn.microsoft.com/tr-tr/library/system.net.mail.attachment.contentdi</A>
</I>&gt;<i> sposition.aspx
</I>&gt;<i>
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey-bounces at lists.owasp.org</A>
</I>&gt;<i> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">owasp-turkey-bounces at lists.owasp.org</A>] On Behalf Of Canberk BOLAT
</I>&gt;<i> Sent: Thursday, January 20, 2011 10:24 AM
</I>&gt;<i> To: OWASP-Turkey Chapter
</I>&gt;<i> Subject: Re: [Owasp-turkey] Content-Disposition Ba&#197;&#159;l&#196;&#177;k Bilgisi &#195;&#156;zerine
</I>&gt;<i>
</I>&gt;<i> Selamlar,
</I>&gt;<i> Sanirim ayni zafiyet ile teknik olarak baska bir musteri hesabininda
</I>&gt;<i> dosyalari indirilebilir (Tabi yapilandirmayada bagli olarak izinleri
</I>&gt;<i> g&#195;&#182;z &#195;&#182;n&#195;&#188;ne almak laz&#196;&#177;m). Peki bu ba&#197;&#159;l&#196;&#177;kta ki dosya yolu s&#196;&#177;zmas&#196;&#177;n&#196;&#177;n
</I>&gt;<i> sebebi uygulama m&#196;&#177; yoksa sunucunun konfig&#195;&#188;rasyonu mu?
</I>&gt;<i>
</I>&gt;<i> 20 Ocak 2011 01:02 tarihinde Onur YILMAZ &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">contact at onuryilmaz.info</A>&gt; yazd&#196;&#177;:
</I>&gt;<i> &gt; Selamlar,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ge&#195;&#167;ti&#196;&#159;imiz g&#195;&#188;nler yapt&#196;&#177;&#196;&#159;&#196;&#177;m ufak bir testte bu ba&#197;&#159;l&#196;&#177;k bilgisiyle ilk defa
</I>&gt;<i> &gt; kar&#197;&#159;&#196;&#177;la&#197;&#159;t&#196;&#177;m.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; /Download.aspx?file=test.txt gibi bir URL'e istek yapt&#196;&#177;&#196;&#159;&#196;&#177;mda, test.txt
</I>&gt;<i> &gt; isimli dosyay&#196;&#177; download ediyordu. &#196;&#176;lgili iste&#196;&#159;e d&#195;&#182;nen HTTP cevab&#196;&#177;na
</I>&gt;<i> &gt; bakt&#196;&#177;&#196;&#159;&#196;&#177;mda ise bu ba&#197;&#159;l&#196;&#177;k bilgisi a&#197;&#159;a&#196;&#159;&#196;&#177;daki &#197;&#159;ekilde yer al&#196;&#177;yordu.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Content-Disposition: attachment; filename=C:\path1\path2\path2\test.txt
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ge&#195;&#167;mi&#197;&#159;te yapt&#196;&#177;&#196;&#159;&#196;&#177;m testlerde kar&#197;&#159;&#196;&#177;la&#197;&#159;t&#196;&#177;&#196;&#159;&#196;&#177;m durumlar&#196;&#177; da d&#195;&#188;&#197;&#159;&#195;&#188;nerek bu
</I>&gt;<i> ba&#197;&#159;l&#196;&#177;k
</I>&gt;<i> &gt; bilgisi nas&#196;&#177;l k&#195;&#182;t&#195;&#188;ye kullan&#196;&#177;l&#196;&#177;r diye konu&#197;&#159;al&#196;&#177;m istedim. Benim akl&#196;&#177;ma
</I>&gt;<i> &gt; gelenlerden baz&#196;&#177;lar&#196;&#177;n&#196;&#177; yazay&#196;&#177;m;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -          &#196;&#176;lgili ba&#197;&#159;l&#196;&#177;k bilgisinde bulunan dizin, kullan&#196;&#177;c&#196;&#177;lar
</I>&gt;<i> taraf&#196;&#177;ndan
</I>&gt;<i> &gt; &#195;&#182;&#196;&#159;renilmemesi gereken kritik bilgileri i&#195;&#167;eriyor olabilir.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; o   Burada mesela akl&#196;&#177;ma gelen &#197;&#159;&#195;&#182;yle bir senaryo var; baz&#196;&#177; hosting
</I>&gt;<i> firmalar&#196;&#177;
</I>&gt;<i> &gt; klasik c:\Inetbup\vhosts\webguvenligi.org\httpdocs\ &#197;&#159;eklindeki
</I>&gt;<i> &gt; isimlendirmeler yerine \..\..\2011-22-webguvenligi-org\ &#197;&#159;eklinde
</I>&gt;<i> &gt; (Yil-MusteriNo-Domain-DomainUzantisi) isimlendirmeler yapabiliyorlar.
</I>&gt;<i> &gt; Sald&#196;&#177;rgan taraf&#196;&#177;ndan bu bilginin &#195;&#182;&#196;&#159;renilmesi kritik olabilir.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; o   Nas&#196;&#177;l kritik olacak derseniz, web sitenizin bulundu&#196;&#159;u sunucu da
</I>&gt;<i> &gt; sald&#196;&#177;rgan&#196;&#177;n sitesi olabilir ya da sald&#196;&#177;rgan bu payla&#197;&#159;&#196;&#177;ml&#196;&#177; hosting
</I>&gt;<i> hizmetinin
</I>&gt;<i> &gt; sa&#196;&#159;land&#196;&#177;&#196;&#159;&#196;&#177; sunucudan bir account sat&#196;&#177;n alabilir (ki bu T&#195;&#188;rkiye'deki
</I>&gt;<i> hacker
</I>&gt;<i> &gt; olmak isteyen gen&#195;&#167; g&#195;&#188;r&#195;&#187;hun s&#196;&#177;k ba&#197;&#159;vurdu&#196;&#159;u bir y&#195;&#182;ntem). Ya da sald&#196;&#177;rgan
</I>&gt;<i> &gt; farkl&#196;&#177; servislerden sizinle ayn&#196;&#177; sunucuda host edilen web sitelerinin
</I>&gt;<i> &gt; adresini &#195;&#182;&#196;&#159;renerek, o uygulamalardaki g&#195;&#188;venlik zafiyetlerini s&#195;&#182;m&#195;&#188;rerek
</I>&gt;<i> &gt; sunucuya zararl&#196;&#177; dosya (shell) y&#195;&#188;kleyebilir.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; o   Bu a&#197;&#159;amadan sonra kendi web sitesi / ya da eri&#197;&#159;im sa&#196;&#159;lad&#196;&#177;&#196;&#159;&#196;&#177; web
</I>&gt;<i> sitesi
</I>&gt;<i> &gt; ile sizin s&#196;&#177;zd&#196;&#177;rd&#196;&#177;&#196;&#159;&#196;&#177;n&#196;&#177;z ba&#197;&#159;l&#196;&#177;k bilgisinde dizin isimlerini
</I>&gt;<i> kar&#197;&#159;&#196;&#177;la&#197;&#159;t&#196;&#177;rarak
</I>&gt;<i> &gt; bir isimlendirme standard&#196;&#177;na eri&#197;&#159;ebilir.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; o   E&#196;&#159;er sunucuda ki izin yetkileri iyi yap&#196;&#177;land&#196;&#177;r&#196;&#177;lmam&#196;&#177;&#197;&#159;sa sizin web
</I>&gt;<i> &gt; sitenizin bulundu&#196;&#159;u dizindeki dosyalara, sunucu &#195;&#188;zerinden ula&#197;&#159;mas&#196;&#177; m&#195;&#188;mk&#195;&#188;n
</I>&gt;<i> &gt; olacakt&#196;&#177;r. (web.config ve benzeri kritik bilgiler i&#195;&#167;eren dosyalara)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; o   &#195;&#156;stteki bahsetti&#196;&#159;im madde de ki sorun bir &#195;&#167;ok hosting firmas&#196;&#177;nda
</I>&gt;<i> art&#196;&#177;k
</I>&gt;<i> &gt; olmasa da, farkl&#196;&#177; y&#195;&#182;ntemler deneyebilirler. &#195;&#150;rne&#196;&#159;in baz&#196;&#177; sunucularda ki
</I>&gt;<i> mail
</I>&gt;<i> &gt; component'lar&#196;&#177; administrator yetkisinde &#195;&#167;al&#196;&#177;&#197;&#159;makta. Yine permission'lar&#196;&#177;n
</I>&gt;<i> &gt; d&#195;&#188;zg&#195;&#188;n yap&#196;&#177;land&#196;&#177;r&#196;&#177;lmamas&#196;&#177;ndan dolay&#196;&#177;, sald&#196;&#177;rgan eri&#197;&#159;im sa&#196;&#159;lad&#196;&#177;&#196;&#159;&#196;&#177; web
</I>&gt;<i> &gt; sitesinde bir dosya olu&#197;&#159;turabilir. Bu dosyan&#196;&#177;n mail g&#195;&#182;nderme fonksiyonuna
</I>&gt;<i> &gt; sahip oldu&#196;&#159;unu d&#195;&#188;&#197;&#159;&#195;&#188;n&#195;&#188;n. Sald&#196;&#177;rgan sizin web sitenizin sunucu &#195;&#188;zerinde
</I>&gt;<i> hangi
</I>&gt;<i> &gt; dizinde oldu&#196;&#159;unu bildi&#196;&#159;inden, bu mail component'&#196;&#177; vas&#196;&#177;tas&#196;&#177; ile sizin
</I>&gt;<i> kritik
</I>&gt;<i> &gt; bilgilerinizi tuttu&#196;&#159;unuz dosyalar&#196;&#177; kendi yazd&#196;&#177;&#196;&#159;&#196;&#177; mail g&#195;&#182;nderme
</I>&gt;<i> fonksiyonuna
</I>&gt;<i> &gt; attachment olarak g&#195;&#182;nderip kendine mail att&#196;&#177;rabilir.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -          Bunun haricinde bu path bilgisinin s&#196;&#177;zmas&#196;&#177;, e&#196;&#159;er bu
</I>&gt;<i> uygulamada,
</I>&gt;<i> &gt; bu parametrede File Inclusion zafiyeti mevcut ise, kolayl&#196;&#177;kla dizin
</I>&gt;<i> &gt; atlatarak yine dosyalara eri&#197;&#159;imi m&#195;&#188;mk&#195;&#188;n k&#196;&#177;labilir.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Sizde bu perspektifte ya da kar&#197;&#159;&#196;&#177;la&#197;&#159;t&#196;&#177;&#196;&#159;&#196;&#177;n&#196;&#177;z benzeri durumlar
</I>&gt;<i> penceresinden
</I>&gt;<i> &gt; de&#196;&#159;erlendirmelerinizi payla&#197;&#159;abilirsiniz.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Kolay gelsin.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; .onur
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-turkey mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Canberk Bolat
</I>&gt;<i> Security Researcher
</I>&gt;<i> <A HREF="http://twitter.com/cnbrkbolat">http://twitter.com/cnbrkbolat</A>
</I>&gt;<i> <A HREF="http://cbolat.blogspot.com">http://cbolat.blogspot.com</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-turkey mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-turkey mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">Owasp-turkey at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
</I>&gt;<i>
</I>


-- 
Bedirhan Urgun
<A HREF="http://www.webguvenligi.org">http://www.webguvenligi.org</A>
<A HREF="http://www.owasp.org/index.php/Turkey">http://www.owasp.org/index.php/Turkey</A>

T&#195;&#188;rk&#195;&#167;e Web Uygulama G&#195;&#188;venli&#196;&#159;i E-Posta Listesine &#195;&#188;ye olmak i&#195;&#167;in:
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-turkey">https://lists.owasp.org/mailman/listinfo/owasp-turkey</A>
-------------- sonraki b&#246;l&#252;m --------------
Bir HTML eklentisi temizlendi...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-turkey/attachments/20110120/a6147c10/attachment.html">https://lists.owasp.org/pipermail/owasp-turkey/attachments/20110120/a6147c10/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001158.html">[Owasp-turkey] Content-Disposition Ba&#351;l&#305;k Bilgisi &#220;zerine
</A></li>
	<LI>Next message: <A HREF="001159.html">[Owasp-turkey] WAF Tester
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1161">[ date ]</a>
              <a href="thread.html#1161">[ thread ]</a>
              <a href="subject.html#1161">[ subject ]</a>
              <a href="author.html#1161">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-turkey">More information about the Owasp-turkey
mailing list</a><br>
</body></html>
