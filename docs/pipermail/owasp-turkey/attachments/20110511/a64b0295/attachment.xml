<?xml version="1.0" encoding="utf-8" ?>
<ObjectCollector xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <Configuration ConfigVersion="2.0.0.0">
    <ConfigPreprocessor Name="0 Type Preprocessor" Assembly="BPA.Common.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Common.TypeConfigPreprocessor" />
    <ObjectProcessor ObjectType="Group" Assembly="BPA.Common.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Common.GroupObjectProcessor" />
    <ObjectProcessor ObjectType="File" Assembly="BPA.ConfigCollector.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Extensions.FileObjectProcessor" />
    <ObjectProcessor ObjectType="If" Assembly="BPA.Common.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Common.IfObjectProcessor"/>
    <ObjectProcessor ObjectType="XML" Assembly="BPA.ConfigCollector.dll" Class="Microsoft.WindowsServerSystem.BestPracticesAnalyzer.Extensions.XmlObjectProcessor" />
    <Substitution Name="SRVNAME_SHORT">localhost</Substitution>
    <Substitution Name="FILE_PATH"></Substitution>
    </Configuration>
  <Type Name="ASP.NET Rules">
    <Object Type="File" Key1="%SRVNAME_SHORT%" Key2="%FILE_PATH%" Key3="*.config" Key4="OneLevel" Key5="Files">
      <Setting Key1="FullName" Substitution="WEBCONFIG_FULLPATH"/>
      <Object Type="XML" Key1="" Key2="%WEBCONFIG_FULLPATH%" Key3="/configuration/system.web">
        <Setting Key1="trace/@enabled">
          <Rule Name="TRACING_IS_ENABLED" Query="lower-case($.)='true'" Error="None" Sev="2" 
                Title="In &lt;trace&gt; element enabled attribute is set to false" 
                Text="The enabled attribute of trace element specifies whether tracing is enabled for an application. More information can be found at http://msdn.microsoft.com/en-us/library/6915t83k.aspx." AlwaysEvaluate="True"
                Resolution="Set enabled attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;trace enabled=&quot;false&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        <Setting Key1="customErrors/@mode">
          <Rule Name="CUSTOM_ERROR_MODE_IS_OFF" Query="$.!='' and lower-case($.)!='on'" Error="None" Sev="1" 
                Title="In &lt;customError&gt; element mode attribute is set to on" 
                Text="The mode attribute of Custom Errors element specifies whether custom errors are enabled, disabled, or shown only to remote clients. More information can be found at http://msdn.microsoft.com/en-us/library/h0hfz6fc.aspx."
                Resolution="Set mode attribute to On in the %WEBCONFIG_FULLPATH% file and use defaultRedirect attribute to redirect to a generic page that will securely log the error information while presenting a useful error message to the user that does not include any of the direct properties or method return values from the exception that caused the page to be displayed.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;customErrors mode=&quot;On&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                AlwaysEvaluate="True"/>
        </Setting>
        
         <Setting Key1="compilation/@debug">
          <Rule Name="DEBUG_IS_SET_TO_TRUE" Query="$.!='' and lower-case($.)!='false'" Error="None" Sev="1" 
                Title="In &lt;compilation&gt; element debug attribute is set to false" 
                Text="In the configuration file setting &lt;configuration&gt;&lt;system.web&gt;&lt;compilation debug=&quot;true&quot;&gt; causes extra information in the binary which is not required for normal execution of the program." AlwaysEvaluate="True"
                Resolution="Set debug attribute to false in the %WEBCONFIG_FULLPATH% file. Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;compilation debug=&quot;false&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. If debugging is required then supress this warning using SupressMessageAttribute: [assembly: System.Diagnostics.CodeAnalysis.SuppressMessage(&quot;Microsoft.WebConfigurationSecurity&quot;, &quot;CA11002:CompilationDebugEnabledRule&quot;)]"
                />
        </Setting>
        <Setting Key1="authentication/forms/@protection">
          <Rule Name="FORMS_PROTECTION_NOT_SET_TO_ALL" Query="$.!='' and lower-case($.)!='all'" Error="None" Sev="1" 
                Title="In &lt;forms&gt; element protection attribute is set to All" 
                Text="The protection attribute of forms element specifies the type of encryption, if any to use for cookies. More information can be found at http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx." AlwaysEvaluate="True"
                Resolution="Set protection attribute to All in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;authentication&gt;&lt;forms protection=&quot;All&quot; /&gt;&lt;/authorization&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        <Setting Key1="authentication/forms/@requireSSL">
          <Rule Name="FORMS_AUTH_NOT_SET_TO_REQUIRE_SSL" Query="($.!='' and lower-case($.)!='true') or count($.)=0" Error="None" Sev="2" 
                Title="In &lt;forms&gt; element requireSSL attribute is set to true" 
                Text="The requireSSL attribute value set in the configuration file for an ASP.NET application determines whether SSL (Secure Sockets Layer) is required to return the forms-authentication cookie. For more information on this attribute please check http://msdn.microsoft.com/en-us/library/system.web.security.formsauthentication.requiressl.aspx." AlwaysEvaluate="True"
                Resolution="Set requireSSL attribute to true in the %WEBCONFIG_FULLPATH% file. Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;authentication&gt;&lt;forms requireSSL=&quot;true&quot; /&gt;&lt;/authentication&gt;&lt;/system.web&gt;&lt;/configuration&gt;. If SSL cannot be used supress this warning using SupressMessageAttribute then place this in [assembly: System.Diagnostics.CodeAnalysis.SuppressMessage(&quot;Microsoft.WebConfigurationSecurity&quot;,&quot;CA11003:FormsAuthenticationRequireSSLRule&quot;)] your code."
                />
        </Setting>
        <Setting Key1="authentication/forms/@enableCrossAppRedirects">
          <Rule Name="FORMS_enableCrossAppRedirect" Query="lower-case($.)='true'" Error="None" Sev="2" 
                Title="In &lt;forms&gt; element enableCrossAppRedirects attribute is set to false" 
                Text="The enableCrossAppRedirects attribute of forms element indicates whether authenticated users are redirected to URLs in other Web applications. More information can be found at http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx." AlwaysEvaluate="True"
                Resolution="Set enableCrossAppRedirects attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;authentication&gt;&lt;forms enableCrossAppRedirect=&quot;false&quot; /&gt;&lt;/authorization&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        <Setting Key1="authentication/@mode" Substitution="WEBCONFIG_AUTHMODE" />
        <Object Type="If" Name="WinAuthTest" Key1="'%WEBCONFIG_AUTHMODE%'='Windows'">
          <Object Type="XML" Key1="" Key2="%WEBCONFIG_FULLPATH%" Key3="/configuration/system.web/authorization/deny">
            <Setting Key1="@users">

            </Setting>
            <Rule Name="NOT_DENYING_ANONYMOUS_USERS_TO_PROTECTED_PAGES" Query="count(../Instance/Setting/Value[contains(.,'?')])=0" Error="None" Sev="2" 
                    Title="When using Windows Authentication deny unauthenticated users access using &lt;deny&gt; element" 
                    Text="The users attribute of deny element denies access to the application resources. More information can be found at http://msdn.microsoft.com/en-us/library/8aeskccd.aspx." AlwaysEvaluate="True"
                    Resolution="Define the authorization deny element with users attribute set to ? in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;authorization&gt;&lt;deny users=&quot;?&quot; /&gt;&lt;/authorization&gt;&lt;/system.web&gt;&lt;/configuration&gt;."
                    />
          </Object>
        </Object>
        <Setting Key1="machineKey/@validationKey" Substitution="WEBCONFIG_VALIDKEY" />
        <Setting Key1="machineKey/@decryptionKey">
          <Rule Name="VALIDATION_KEY_AND_DECRYPTION_KEY_SAME" Query="lower-case($.)!='autogenerate,isolateapps' or lower-case('%WEBCONFIG_VALIDKEY%')!='autogenerate,isolateapps'" Error="None" Sev="2" 
                Title="In &lt;machineKey&gt; element validationKey attribute is set to AutoGenerate,IsolateApps" 
                Text="The decryption attribute of machineKey element specifies the key used to validate encrypted data. validationKey is used when enableViewStateMAC is true in order to create a message authentication code (MAC) to ensure that view state has not been tampered with. validationKey is also used to generate out-of-process, application-specific session IDs to ensure that session state variables are isolated between sessions. More information can be found at http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx." AlwaysEvaluate="True"
                Resolution="Set validationKey attribute to AutoGenerate,IsolateApps in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;machineKey validationKey=&quot;AutoGenerate,IsolateApps&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        <Setting Key1="machineKey/@validation">
          <Rule Name="VALIDATION_ALGORITHM_NOT_CORRECT" Query="$.!='' and lower-case($.)!='aes' and lower-case($.)!='sha1' and lower-case($.)!='hmacsha256' and lower-case($.)!='hmacsha384' and lower-case($.)!='hmacsha512'" Error="None" Sev="1" 
                Title="In &lt;machineKey&gt; element validation attribute is set to SHA1" 
                Text="The validation attribute of machineKey element specifies the type of encryption that is used to validate data. More information can be found at http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx." AlwaysEvaluate="True"
                Resolution="Set validation attribute to SHA1 in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;machineKey validation=&quot;SHA1&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        
        <Setting Key1="machineKey/@decryption">
          <Rule Name="DECRYPTION_ALGORITHM_NOT_CORRECT" Query="$.!='' and lower-case($.)!='aes' and lower-case($.)!='3des'" Error="None" Sev="1"
                Title="In &lt;machineKey&gt; element decryption attribute is set to 3DES or AES" 
                Text="The decryption attribute of machineKey element specifies the type of hashing algorithm that is used for decrypting data. More information can be found at http://msdn.microsoft.com/en-us/library/w8h3skw9.aspx." AlwaysEvaluate="True"
                Resolution="Set decryption attribute to Auto, 3DES or AES in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;machineKey decryption=&quot;AES&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        

        <Setting Key1="httpCookies/@requireSSL">
          <Rule Name="httpCookies_requireSSL" Query="lower-case($.)='false'" Error="None" Sev="2" 
                Title="In &lt;httpCookies&gt; element requireSSL attribute is set to true" 
                Text="The requireSSL attribute of httpCookies element sets a value indicating whether Secure Sockets Layer (SSL) communication is required. More information can be found at http://msdn.microsoft.com/en-us/library/ms228262.aspx." AlwaysEvaluate="True"
                Resolution="Set requireSSL attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;httpCookies requireSSL=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="httpCookies/@httpOnlyCookies">
          <Rule Name="ENABLE_HTTP_ONLY_COOKIES" Query="lower-case($.)='false'" Error="None" Sev="2" 
                Title="In &lt;httpCookies&gt; element httpOnly attribute is set to true" 
                Text="The httpOnlyCookies attribute of httpCookies element enables output of the HttpOnlyCookies cookie in browser. More information can be found at http://msdn.microsoft.com/en-us/library/ms228262.aspx." AlwaysEvaluate="True"
                Resolution="Set httpOnlyCookies attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;httpCookies httpOnlyCookies=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        
        <Setting Key1="httpRuntime/@maxRequestLength">
          <Rule Name="MAXREQUESTLENGTH_IS_GREATER_THAN_4096" Query="$.>4096" Error="None" Sev="2"
                Title="In &lt;httpRuntime&gt; element maxRequestLength attribute is less than or equals to 4096"
                Text="The maxRequestLength attribute of http Runtime element specifies the limit for the input stream buffering threshold, in KB. This limit can be used to prevent denial of service attacks that are caused, by users posting large files to the server.  More information can be found at http://msdn.microsoft.com/en-us/library/e1f13641.aspx." AlwaysEvaluate="True"
                Resolution="Set maxRequestLength attribute to less than or equal to 4096 in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;httpRuntime maxRequestLength=&quot;4096&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="httpRuntime/@enableHeaderChecking">
          <Rule Name="httpRuntime_enableHeaderChecking" Query="lower-case($.)='false'" Error="None" Sev="2" 
                Title="In &lt;httpRuntime&gt; element enableHeaderChecking attribute is set to true" 
                Text="The enableHeaderChecking attribute of httpRuntime element specifies whether ASP.NET should check the request header for potential injection attacks. If an attack is detected, ASP.NET responds with an error. More information can be found at http://msdn.microsoft.com/en-us/library/e1f13641.aspx." AlwaysEvaluate="True"
                Resolution="Set enableHeaderChecking attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;httpRuntime enableHeaderChecking=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="httpRuntime/@enableVersionHeader">
          <Rule Name="ENABLE_VERSION_HEADER" Query="lower-case($.)='true'" Error="None" Sev="2" 
                Title="In &lt;httpRuntime&gt; element enableVersionHeader attribute is set to false" 
                Text="The enableVersionHeader attribute of httpRuntime element specifies whether ASP.NET should output a version header. This attribute is used by Microsoft Visual Studio 2005 to determine which version of ASP.NET is in use. It is not necessary for production sites and can be disabled. More information can be found at http://msdn.microsoft.com/en-us/library/e1f13641.aspx." AlwaysEvaluate="True"
                Resolution="Set enableVersionHeader attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;httpRuntime enableVersionHeader=&quot;false&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="httpRuntime/@sendCacheControlHeader">
          <Rule Name="httpRuntime_sendCacheControlHeader" Query="lower-case($.)='false'" Error="None" Sev="2" 
                Title="In &lt;httpRuntime&gt; element sendCacheControlHeader attribute is set to true" 
                Text="The sendCacheControlHeader attribute of httpRuntime element specifies whether to send a cache control header, which is set to Private, by default. If True, client-side caching is disabled. More information can be found at http://msdn.microsoft.com/en-us/library/e1f13641.aspx." AlwaysEvaluate="True"
                Resolution="Set sendCacheControlHeader attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;httpRuntime sendCacheControlHeader=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="membership/providers/add/@maxInvalidPasswordAttempts">
          <Rule Name="MEMBERSHIP_PROVIDER_MAXINVALIDPASSWORDATTEMPTS" Query="$.&lt;5" Error="None" Sev="2" 
                Title="In &lt;membership&gt;/&lt;providers&gt;/&lt;add&gt; maxInvalidPasswordAttempts attribute is less than 6" 
                Text="The maxInvalidPasswordAttempts attribute of add element specifies the number of allowed password or password answer attempts that are not valid. The membership user is locked out when the number of not valid attempts is the configured value. More information can be found at http://msdn.microsoft.com/en-us/library/whae3t94.aspx." AlwaysEvaluate="True"
                Resolution="Set maxInvalidPasswordAttempts attribute to 5 or less in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;membership&gt;&lt;providers&gt;&lt;add maxInvalidPasswordAttempts=&quot;5&quot; /&gt;&lt;/providers&gt;&lt;/membership&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="membership/providers/add/@minRequiredNonalphanumericCharacters">
          <Rule Name="MEMBERSHIP_PROVIDER_minRequiredNonalphanumericCharacters" Query="$.&lt;1" Error="None" Sev="2" 
                Title="In &lt;membership&gt;/&lt;providers&gt;/&lt;add&gt; element minRequiredNonalphanumericCharacters attribute is set to 1 or more" 
                Text="The minRequiredNonalphanumericCharacters attribute of add element specifies the minimum number of special characters that must be present in a valid password. This attribute cannot be set to a value that is less than 0, greater than 128, or greater than the value of the minRequiredPasswordLength. More information can be found at http://msdn.microsoft.com/en-us/library/whae3t94.aspx." AlwaysEvaluate="True"
                Resolution="Set minRequiredNonalphanumericCharacters attribute to at least 1 in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;membership&gt;&lt;providers&gt;&lt;add minRequiredNonalphanumericCharacters=&quot;1&quot; /&gt;&lt;/providers&gt;&lt;/membership&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="membership/providers/add/@minRequiredPasswordLength">
          <Rule Name="MEMBERSHIP_PROVIDER_minRequiredPasswordLength" Query="$.&lt;8" Error="None" Sev="2"
                Title="In &lt;membership&gt;/&lt;providers&gt;/&lt;add&gt; element minRequiredPasswordLength attribute is set to greater than 7" 
                Text="The minRequiredPasswordLength attribute of add element specifies the minimum number of characters that are required in a password. This attribute cannot be set to a value that is less than 0 or greater than 128, which is the maximum length of an unencoded password for the SQL provider. More information can be found at http://msdn.microsoft.com/en-us/library/whae3t94.aspx." AlwaysEvaluate="True"
                Resolution="Set minRequiredPasswordLength attribute to at least 8 in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;membership&gt;&lt;providers&gt;&lt;add minRequiredPasswordLength=&quot;8&quot; /&gt;&lt;/providers&gt;&lt;/membership&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="membership/providers/add/@passwordAttemptWindow">
          <Rule Name="MEMBERSHIP_PROVIDER_passwordAttemptWindow" Query="$.&lt;30" Error="None" Sev="2" 
                Title="In &lt;membership&gt;/&lt;providers&gt;/&lt;add&gt; element passwordAttemptWindow attribute is at least 30 minutes" 
                Text="The passwordAttemptWindow attribute of Add element specifies the number of minutes during which failed attempts are tracked. The window resets each time another failure occurs. If the maximum number of valid password or password answer attempts that are not valid occurs, the membership user is locked out. More information can be found at http://msdn.microsoft.com/en-us/library/whae3t94.aspx." AlwaysEvaluate="True"
                Resolution="Set passwordAttemptWindow attribute to at least 30 minutes in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;membership&gt;&lt;providers&gt;&lt;add passwordAttemptWindow=&quot;30&quot; /&gt;&lt;/providers&gt;&lt;/membership&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="pages/@enableViewState">
          <Rule Name="PAGES_enableViewState_Rule" Query="$.='false'" Error="None" Sev="2" 
                Title="In &lt;pages&gt; element enableViewState attribute is set to true" 
                Text="The enableViewState attribute set in the configuration specifies whether view state is enabled and maintained across page requests." AlwaysEvaluate="True"
                Resolution="Set enableViewState attribute to true in the %WEBCONFIG_FULLPATH% file. Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;pages enableViewState=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="pages/@enableViewStateMac">
          <Rule Name="PAGES_enableViewStateMac" Query="$.='false'" Error="None" Sev="1" 
                Title="In &lt;pages&gt; element enableViewStateMac attribute is set to true" 
                Text="The enableViewStateMac attribute set in the configuration specifies whether ASP.NET should run a message authentication code (MAC) on the view state for the page when the page is posted back from the client. If True, the encrypted view state is checked to verify that it has not been tampered with on the client." AlwaysEvaluate="True"
                Resolution="Set enableViewStateMac attribute to true in the %WEBCONFIG_FULLPATH% file. Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;pages enableViewStateMac=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="pages/@enableEventValidation">
          <Rule Name="PAGES_enableEventValidation" Query="$.='false'" Error="None" Sev="2" 
                Title="In &lt;pages&gt; element enableEventValidation attribute is set to true" 
                Text="The enableEventValidation attribute set in the configuration specifies whether pages and controls validate postback and callback events." 
                Resolution="Set enableEventValidation attribute to true in the %WEBCONFIG_FULLPATH% file. Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;pages enableEventValidation=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. " AlwaysEvaluate="True"/>
        </Setting>

        <Setting Key1="pages/@validateRequest">
          <Rule Name="PAGES_validateRequest" Query="$.='false'" Error="None" Sev="2" 
                Title="In &lt;pages&gt; element validateRequest attribute is set to true" 
                Text="The validateRequest attribute value set in the configuration file for an ASP.NET application enables ASP.NET to examine input from the browser for dangerous values. For more information on this attribute please check http://msdn.microsoft.com/en-us/library/system.web.configuration.pagessection.validaterequest.aspx." AlwaysEvaluate="True"
                Resolution="Set validateRequest attribute to true in the %WEBCONFIG_FULLPATH% file. Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;pages validateRequest=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="pages/@viewStateEncryptionMode">
          <Rule Name="PAGES_viewStateEncryptionMode" Query="$.='Never'" Error="None" Sev="1" 
                Title="In &lt;pages&gt; element viewstateEncryptionMode attribute is set to Always" 
                Text="The viewStateEncryptionMode attribute value set in the configuration file for an ASP.NET application enables the view-state information in a Page object to be encrypted. For more information on this attribute please check http://msdn.microsoft.com/en-us/library/system.web.ui.viewstateencryptionmode.aspx." AlwaysEvaluate="True"
                Resolution="Set viewstateEncryptionMode attribute to Always in the %WEBCONFIG_FULLPATH% file. Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;pages viewstateEncryptionMode=&quot;Always&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="roleManager/@cookieProtection">
          <Rule Name="roleManager_cookieProtection" Query="$.!='All'" Error="None" Sev="1" 
                Title="In &lt;roleManager&gt; element cookieProtection attribute is set to All" 
                Text="The protection attribute of roleManager specifies one of the CookieProtection enumeration values. More information can be found at http://msdn.microsoft.com/en-us/library/ms164660.aspx." AlwaysEvaluate="True"
                Resolution="Set cookieProtection attribute to All in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;roleManager cookieProtection=&quot;All&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="roleManager/@cookieRequireSSL">
          <Rule Name="roleManager_cookieRequireSSL" Query="$.='false'" Error="None" Sev="3" 
                Title="In &lt;roleManager&gt; element cookieRequireSSL attribute is set to true" 
                Text="The cookieRequireSSL attribute of roleManager specifies whether the role names cookie requires SSL to be set to the server. For more information http://msdn.microsoft.com/en-us/library/ms164660.aspx." 
                AlwaysEvaluate="True"
                Resolution="Set cookieRequireSSL attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;roleManager cookieRequireSSL=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="roleManager/@cookieSlidingExpiration">
          <Rule Name="roleManager_cookieSlidingExpiration" Query="$.='false'" Error="None" Sev="3" 
                Title="In &lt;roleManager&gt; element cookieSlidingExpiration attribute is set to true" 
                Text="The cookieSlidingExpiration attribute of roleManager element specifies whether the expiration date/time of the role names cookie will be reset periodically. More information can be found at http://msdn.microsoft.com/en-us/library/ms164660.aspx." AlwaysEvaluate="True"
                Resolution="Set cookieSlidingExpiration attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;roleManager cookieSlidingExpiration=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="roleManager/@cookieTimeout">
          <Rule Name="roleManager_cookieTimeout" Query="$.&gt;20" Error="None" Sev="3" 
                Title="In &lt;roleManager&gt; element cookieTimeout attribute is less than or equal to 20" 
                Text="The cookieTimeout attribute of roleManager element specifies the  number of minutes before the role names cookie expires. More information can be found at http://msdn.microsoft.com/en-us/library/ms164660.aspx." AlwaysEvaluate="True"
                Resolution="Set cookieTimeout attribute to less than or equal to 20 minutes in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;roleManager cookieTimeout=&quot;20&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
        
        <Setting Key1="roleManager/@maxCachedResults">
          <Rule Name="roleManager_maxCachedResults" Query="$.&gt;200" Error="None" Sev="3" 
                Title="In &lt;roleManager&gt; element maxCachedResults attribute is less than or equal to 200" 
                Text="The maxCachedResults attribute of roleManager element specifies the maximum number of role names that are cached in the roles cookie. More information can be found at http://msdn.microsoft.com/en-us/library/ms164660.aspx." AlwaysEvaluate="True"
                Resolution="Set maxCachedResults attribute to less than or equal to 200 in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;roleManager maxCachedResults=&quot;200&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "/>
        </Setting>

        <Setting Key1="sessionState/@regenerateExpiredSessionId">
          <Rule Name="sessionState_regenerateExpiredSessionId" Query="$.='true'" Error="None" Sev="1" 
                Title="In &lt;sessionState&gt; element regenerateExpiredSessionId is set to false" 
                Text="The regenerateExpiredSessionId attribute of sessionState element specifies whether the session ID will be reissued when an expired session ID is specified by the client. By default, session IDs are reissued only for the cookieless mode when regenerateExpiredSessionId is enabled. More information can be found at http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx." AlwaysEvaluate="True"
                Resolution="Set regenerateExpiredSessionId attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;sessionState regenerateExpiredSessionId=&quot;false&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="sessionState/@cookieless">
          <Rule Name="sessionState_cookieless" Query="$.='UseUri'" Error="None" Sev="1" 
                Title="In &lt;sessionState&gt; element cookieless attribute is set to UseCookies" 
                Text="The cookieless attribute of sessionState element specifies how cookies are used for a Web application. More information can be found at http://msdn.microsoft.com/en-us/library/h6bb9cz9.aspx." AlwaysEvaluate="True"
                Resolution="Set cookieless attribute to UseCookies in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;sessionState cookieless=&quot;UseCookies&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="anonymousIdentification/@cookieless">
          <Rule Name="anonymousIdentification_cookieless" Query="$.!='UseCookies'" Error="None" Sev="1" 
                Title="In &lt;anonymousIdentification&gt; element cookieless attribute is set to UseCookies" 
                Text="The cookieless attribute of anonymousIdentification element specifies whether to use cookies for a Web application. The HttpCookieMode enumeration is used to specify the value for this attribute in the configuration section. It is used by all features that support cookieless authentication. When the AutoDetect value is specified, ASP.NET queries the browser or device to determine whether it supports cookies. If the browser or device supports cookies, cookies are used to persist user data; otherwise, an identifier is used in the query string. More information can be found at http://msdn.microsoft.com/en-us/library/91ka2e6a.aspx." 
                AlwaysEvaluate="True"
                Resolution="Set cookieless attribute to UseCookies in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;anonymousIdentification cookieless=&quot;UseCookies&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="anonymousIdentification/@cookieProtection">
          <Rule Name="anonymousIdentification_cookieProtection" Query="$.!='' and lower-case($.)!='all'" Error="None" Sev="1" 
                Title="In &lt;anonymousIdentification&gt; element cookieProtection is set to All" 
                Text="The cookieProtection attribute of anonymousIdentification element specifies the cookie protection scheme. More information can be found at http://msdn.microsoft.com/en-us/library/91ka2e6a.aspx." AlwaysEvaluate="True"
                Resolution="Set cookieProtection to All in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;anonymousIdentification cookieProtection=&quot;All&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="anonymousIdentification/@cookieRequireSSL">
          <Rule Name="anonymousIdentification_cookieRequireSSL" Query="$.!='' and lower-case($.)!='true'" Error="None" Sev="2"                            Title="In &lt;anonymousIdentification&gt; element requireSSL attribute is set to true" 
                Text="The cookieRequireSSL attribute of anonymousIdentification element specifies whether the cookie requires a Secure Sockets Layer (SSL) connection when it is transmitted to the client. Because ASP.NET sets the authentication cookie property, Secure, the client does not return the cookie unless an SSL connection is in use. More information can be found at http://msdn.microsoft.com/en-us/library/91ka2e6a.aspx." AlwaysEvaluate="True"
                Resolution="Set cookieRequireSSL attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.web&gt;&lt;anonymousIdentification cookieRequireSSL=&quot;true&quot; /&gt;&lt;/system.web&gt;&lt;/configuration&gt;. "
                />
        </Setting>
      </Object>
      <Object Type="XML" Key1="" Key2="%WEBCONFIG_FULLPATH%" Key3="/configuration/system.serviceModel">
        <Setting Key1="bindings/customBinding/binding/security/localClientSettings/@detectReplays">
          <Rule Name="DETECT_REPLAYS_ENABLED_CLIENT_SETTINGS" Query="lower-case($.)='false'" Error="None" Sev="1" 
                Title="In &lt;localClientSettings&gt; element detectReplay attribute is set to true" 
                Text="The detectReplays attribute of localClientSettings is a Boolean value that specifies whether replay attacks against the channel are detected and dealt with automatically."  AlwaysEvaluate="True"
                Resolution="Set detectReplays attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.serviceModel&gt;&lt;bindings&gt;&lt;customBinding&gt;&lt;binding&gt;&lt;security&gt;&lt;localClientSettings detectReplays=&quot;true&quot; /&gt;&lt;/security&gt;&lt;/binding&gt;&lt;/customBinding&gt;&lt;/binding&gt;&lt;/system.serviceModel&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="bindings/customBinding/binding/security/localServiceSettings/@detectReplays">
          <Rule Name="DETECT_REPLAYS_ENABLED_SERVICE_SETTINGS" Query="lower-case($.)='false'" Error="None" Sev="1" 
                Title="In &lt;localServiceSettings&gt; element detectReplay attribute is set to true" 
                Text="The detectReplays attribute of localClientSettings is a Boolean value that specifies whether replay attacks against the channel are detected and dealt with automatically."
                Resolution="Set detectReplays attribute to true in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.serviceModel&gt;&lt;bindings&gt;&lt;customBinding&gt;&lt;binding&gt;&lt;security&gt;&lt;localServiceSettings detectReplays=&quot;true&quot; /&gt;&lt;/security&gt;&lt;/binding&gt;&lt;/customBinding&gt;&lt;/binding&gt;&lt;/system.serviceModel&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="behaviors/serviceBehaviors/behavior/serviceMetadata/@httpGetEnabled">
          <Rule Name="serviceMetadata_httpGetEnabled" Query="lower-case($.)='true'" Error="None" Sev="2" 
                Title="In &lt;serviceMetadata&gt; element httpGetEnabled attribute is set to false" 
                Text="The httpGetEnabled attribute of serviceMetadata element allows the binding to be used in HTTPS GET scenarios to be specified by name. More information can be found at http://msdn.microsoft.com/en-us/library/ms731317.aspx." 
                Resolution="Set httpGetEnabled attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.serviceModel&gt;&lt;behaviors&gt;&lt;serviceBehaviors&gt;&lt;behavior&gt;&lt;serviceMetadata httpGetEnabled=&quot;false&quot; /&gt;&lt;/behavior&gt;&lt;/serviceBehaviors&gt;&lt;/behaviors&gt;&lt;/system.serviceModel&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="behaviors/serviceBehaviors/behavior/serviceMetadata/@httpsGetEnabled">
          <Rule Name="serviceMetadata_httpsGetEnabled" Query="lower-case($.)='true'" Error="None" Sev="2" 
                Title="In &lt;serviceMetadata&gt; element httpsGetEnabled attribute is set to false" 
                Text="The httpsGetEnabled attribute of serviceBehavior element specifies whether to publish service metadata for retrieval using an HTTPS/Get request. More information can be found at http://msdn.microsoft.com/en-us/library/ms731317.aspx."
                Resolution="Set httpsGetEnabled attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.serviceModel&gt;&lt;behaviors&gt;&lt;serviceBehaviors&gt;&lt;behavior&gt;&lt;serviceMetadata httpsGetEnabled=&quot;false&quot; /&gt;&lt;/behavior&gt;&lt;/serviceBehaviors&gt;&lt;/behaviors&gt;&lt;/system.serviceModel&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="behaviors/serviceBehaviors/behavior/serviceDebug/@includeExceptionDetailInFaults">
          <Rule Name="serviceMetadata_includeExceptionDetailInFaults" Query="lower-case($.)='true'" Error="None" Sev="2" 
                Title="In &lt;serviceDebug&gt; element includeExceptionDetailInFaults attribute is set to false" 
                Text="The includeExceptionDetailInFaults attribute of serviceDebug element specifies whether to include managed exception information in the detail of SOAP faults returned to the client for debugging purposes. More information can be found at http://msdn.microsoft.com/en-us/library/ms788993.aspx."
                Resolution="Set includeExceptionDetailInFaults attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.serviceModel&gt;&lt;behaviors&gt;&lt;serviceBehaviors&gt;&lt;behavior&gt;&lt;serviceDebug includeExceptionDetailInFaults=&quot;false&quot; /&gt;&lt;/behavior&gt;&lt;/serviceBehaviors&gt;&lt;/behaviors&gt;&lt;/system.serviceModel&gt;&lt;/configuration&gt;. "
                />
        </Setting>

        <Setting Key1="services/service/endpoint/@address">
        </Setting>
        <Rule Name="endpoint_address_mex" Query="count(../Instance/Setting[@Key1='services/service/endpoint/@address']/Value[contains(.,'mex')])&gt;0" Error="None" Sev="2"
      Title="In &lt;endpoint&gt; element mex address is undefined"
      Text="The address attribute of endpoint element specifies a string that contains the address of the endpoint. The address can be specified as an absolute or relative address. If a relative address is provided, the host is expected to provide a base address appropriate for the transport scheme used in the binding. More information can be found at http://msdn.microsoft.com/en-us/library/ms731320.aspx."
      Resolution="Remove the mex address from the %WEBCONFIG_FULLPATH% file." />
      </Object>
      <Object Type="XML" Key1="" Key2="%WEBCONFIG_FULLPATH%" Key3="/configuration/system.net">
        <Setting Key1="settings/httpWebRequest/@useUnsafeHeaderParsing" />
        <Rule Name="httpWebRequest_useUnsafeHeaderParsing" Query="lower-case(../Instance/Setting/Value)='true'" Error="None" Sev="2"
              Title="In &lt;httpWebRequest&gt; element useUnsafeHeaderParsing attribute is set to false"
              Text="The useUnsafeHeaderParsing attribute of httpWebRequest specifies whether unsafe header parsing is enabled. More information can be found at http://msdn.microsoft.com/en-us/library/65ha8tzh.aspx." AlwaysEvaluate="True"
              Resolution="Set the useUnsafeHeaderParsing attribute to false in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.net&gt;&lt;settings&gt;&lt;httpWebRequest useUnsafeHeaderParsing=&quot;false&quot; /&gt;&lt;/settings&gt;&lt;/system.net&gt;&lt;/configuration&gt;. "
                />
      </Object>
      <Object Type="XML" Key1="" Key2="%WEBCONFIG_FULLPATH%" Key3="/configuration/system.webServer/httpProtocol/customHeaders/add[@name='X-XSS-Protection']">
        <Setting Key1="@value" />
        <Rule Name="httpProtocol_customHeader_XSSProtection" Query="lower-case(../Instance/Setting/Value)='0'" Error="None" Sev="2"                       Title="In &lt;customHeaders&gt; element IE8 XSS protection is enabled"
                Text="The custom headers element of httpProtocol element allows application developer to add headers to enable Internet Explorer's browser based Cross Site Scripting attack protection. More information about the header can be found at http://msdn.microsoft.com/en-us/library/dd565647(VS.85).aspx." AlwaysEvaluate="True"
                Resolution="Remove the HTTP custom header which disables IE XSS Protection in the %WEBCONFIG_FULLPATH% file.  Ex: &lt;configuration&gt;&lt;system.webServer&gt;&lt;httpProtocol&gt;&lt;customHeaders&gt;&lt;add X-XSS-Protection=&quot;0&quot; /&gt;&lt;/customHeaders&gt;&lt;/httpProtocol&gt;&lt;/system.webServer&gt;&lt;/configuration&gt;. "
                />
      </Object>
    </Object>
  </Type>
</ObjectCollector>