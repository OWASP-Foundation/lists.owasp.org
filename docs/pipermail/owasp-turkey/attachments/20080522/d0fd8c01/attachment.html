<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
FONT-SIZE:&nbsp;10pt;<br>
FONT-FAMILY:Tahoma<br>
}<br>
&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;BR&gt;Merhaba,&lt;BR&gt;<br>
Dun&nbsp;ve&nbsp;bugun&nbsp;test&nbsp;ettigimiz&nbsp;sistemlerde,&nbsp;Ferruh'un&nbsp;makalesindeki&nbsp;teknikleri&nbsp;denedik.&lt;BR&gt;&lt;BR&gt;<br>
Yazida&nbsp;da&nbsp;belirttigi&nbsp;gibi&nbsp;en&nbsp;onemli&nbsp;nokta&nbsp;&quot;denemek&quot;.&nbsp;Cunku&nbsp;her&nbsp;payload&nbsp;(sorgu&nbsp;bolumu)&nbsp;her&nbsp;durumda&nbsp;iyi&nbsp;sonuclar&nbsp;vermiyor.&nbsp;Yeni&nbsp;bi&nbsp;tane&nbsp;bulmak&nbsp;gerekebiliyor.&nbsp;Mesela&nbsp;bi&nbsp;sayfada&nbsp;asagidaki&nbsp;yeni&nbsp;payload&nbsp;tek&nbsp;istekte&nbsp;~20sn&nbsp;tutuyor,&nbsp;character&nbsp;negation&nbsp;trick&nbsp;;)&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
%n[^n]y[^j]l[^k]d[^l]h[^z]t[^k]b[^q]t[^q][^n]!%&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
Ama&nbsp;onemli&nbsp;olan&nbsp;bi&nbsp;nokta&nbsp;daha&nbsp;var.&nbsp;Aramanin&nbsp;hangi&nbsp;field'lar&nbsp;da&nbsp;yapildigi.&nbsp;Mesela&nbsp;metin&nbsp;(text,&nbsp;blob)&amp;nbsp;sutunlarda&nbsp;arama&nbsp;yapiliyorsa&nbsp;yukaridaki&nbsp;gecerli.&nbsp;Sadece&nbsp;varchar(~50)&nbsp;gibi&nbsp;sutunlarda&nbsp;arama&nbsp;yapan&nbsp;yerlerde&nbsp;(ASP.NET-&amp;gt;MSSQL)&nbsp;bu&nbsp;teknikleri&amp;nbsp;kararli&nbsp;kullanamadim&nbsp;simdiye&nbsp;kadar.&nbsp;Hatta&nbsp;bu&nbsp;farkliliga&nbsp;gore&nbsp;bile&nbsp;payloadlar&nbsp;degistirilebilir.&nbsp;Belki&nbsp;fuzzer&nbsp;gibi&nbsp;bisey&nbsp;kullanmak&nbsp;lazim.&lt;BR&gt;&lt;BR&gt;bedirhan&lt;BR&gt;<br>
&lt;BLOCKQUOTE&gt;<br>
&lt;HR&nbsp;id=EC_stopSpelling&gt;<br>
Date:&nbsp;Tue,&nbsp;20&nbsp;May&nbsp;2008&nbsp;15:03:16&nbsp;+0100&lt;BR&gt;From:&nbsp;ferruh@mavituna.com&lt;BR&gt;To:&nbsp;urgunb@hotmail.com&lt;BR&gt;Subject:&nbsp;Re:&nbsp;[Owasp-turkey]&nbsp;DoS&nbsp;attacks&nbsp;using&nbsp;SQL&nbsp;Wildcards&lt;BR&gt;CC:&nbsp;owasp-turkey@lists.owasp.org&lt;BR&gt;&lt;BR&gt;Merhabalar,&nbsp;&lt;BR&gt;&lt;BR&gt;Tesekkurler&nbsp;Bedirhan,&nbsp;paylastiginiz&nbsp;nokta&nbsp;ilgincmis&nbsp;benim&nbsp;modsecurity&nbsp;hic&nbsp;aklima&nbsp;gelmemisti&nbsp;o&nbsp;sirada.&nbsp;Ek&nbsp;olarak&nbsp;payload&nbsp;cok&nbsp;daha&nbsp;farkli&nbsp;sekillerde&nbsp;de&nbsp;yapilabilir,&nbsp;senin&nbsp;gosterdigin&nbsp;ve&nbsp;buldugunuz&nbsp;yontem&nbsp;de&nbsp;bunun&nbsp;gibi.&lt;BR&gt;&lt;BR&gt;Mesela&nbsp;benim&nbsp;gene&nbsp;dokumanda&nbsp;verdigim&nbsp;basit&nbsp;bir&nbsp;ornek&nbsp;var&nbsp;:&nbsp;_[r/a)_&nbsp;_(r/b)_&nbsp;_(r-d)_&nbsp;&lt;BR&gt;&lt;BR&gt;Gayet&nbsp;kisa&nbsp;ve&nbsp;benim&nbsp;testimdeki&nbsp;bir&nbsp;web&nbsp;forum&nbsp;yaziliminda&nbsp;30+&nbsp;sn.&nbsp;suruyor&nbsp;calismasi&nbsp;:),&nbsp;yazilim&nbsp;detaylarini&nbsp;burada&nbsp;veremiyorum,&nbsp;kendilerine&nbsp;de&nbsp;acik&nbsp;olarak&nbsp;bildirdim&nbsp;zaten&nbsp;ama&nbsp;sadece&nbsp;durumun&nbsp;vehametini&nbsp;ortaya&nbsp;koymak&nbsp;adina.&nbsp;Bu&nbsp;yazilimda&nbsp;mesela&nbsp;15&nbsp;karakter&nbsp;gibi&nbsp;bir&nbsp;limit&nbsp;vardi,&nbsp;ama&nbsp;ona&nbsp;ragment&nbsp;yukaridaki&nbsp;basit&nbsp;arama&nbsp;yetti.&lt;BR&gt;&lt;BR&gt;Bu&nbsp;arada&nbsp;karsimiza&nbsp;geldiginde&nbsp;bypass&nbsp;edebilmek&nbsp;icin&nbsp;bu&nbsp;double&nbsp;encoding&nbsp;olayini&nbsp;akilda&nbsp;tutmak&nbsp;lazim.&lt;BR&gt;&lt;BR&gt;<br>
&lt;DIV&nbsp;class=EC_gmail_quote&gt;2008/5/20&nbsp;Bedirhan&nbsp;Urgun&nbsp;&amp;lt;&lt;A&nbsp;href=&quot;mailto:urgunb@hotmail.com&quot;&gt;urgunb@hotmail.com&lt;/A&gt;&amp;gt;:&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;class=EC_gmail_quote&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex&quot;&gt;<br>
&lt;DIV&gt;&lt;BR&gt;&amp;nbsp;merhaba,&lt;BR&gt;tebrik&nbsp;ederim&amp;nbsp;Ferruh.&amp;nbsp;&lt;BR&gt;&amp;nbsp;&lt;BR&gt;Yazidaki&nbsp;teknik&nbsp;ile&nbsp;alakali&nbsp;olarak&nbsp;bugun&nbsp;Yusuf&nbsp;Çeri&nbsp;ile&nbsp;farkettigimiz&nbsp;bi&nbsp;noktayi&amp;nbsp;paylasmak&nbsp;istedim.&nbsp;Eger&nbsp;modsecurity&nbsp;ile&nbsp;korunan&nbsp;sisteminiz&nbsp;(veya&nbsp;baska&nbsp;bir&nbsp;WAF),&amp;nbsp;yazida&nbsp;belirtilen&nbsp;asagidaki&nbsp;payloadu&nbsp;reddiyorsa&nbsp;&lt;BR&gt;&amp;nbsp;&lt;BR&gt;&lt;FONT&nbsp;face=&quot;&quot;&nbsp;color=#ff0000&nbsp;size=1&gt;'%_[^!_%/%a?&lt;FONT&nbsp;face=&quot;&quot;&gt;F%_D&lt;/FONT&gt;)_(F%)_%([)({}%){()}£$&amp;amp;N%_)$*£()$*R&quot;_)][%](%[x])%a][$*&quot;£$-9]_%'&nbsp;&lt;BR&gt;&lt;/FONT&gt;&amp;nbsp;&lt;BR&gt;bu&amp;nbsp;saldiriya&nbsp;acik&nbsp;degiliz&amp;nbsp;anlamina&nbsp;gelmiyor.&nbsp;Yukaridaki&nbsp;payload'un&nbsp;basit&nbsp;bir&nbsp;bypass&nbsp;teknigi&nbsp;uygulanmis&nbsp;hali;&lt;BR&gt;&amp;nbsp;&lt;BR&gt;&lt;FONT&nbsp;face=&quot;&quot;&nbsp;color=#3366ff&gt;'%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}£$&amp;amp;N%55_)$*£()$*R&quot;_)][%55](%66[x])%ba][$*&quot;£$-9]_%54'&lt;/FONT&gt;&lt;BR&gt;&amp;nbsp;&lt;BR&gt;Yani&nbsp;payloaddaki&nbsp;%&nbsp;yerine&nbsp;gecerli&nbsp;bir&nbsp;url&nbsp;encoded&nbsp;karakter&nbsp;giriliyor&nbsp;(ascii&nbsp;32'den&nbsp;buyuk&nbsp;olmasi&nbsp;daha&nbsp;iyi&nbsp;cunku&nbsp;0-32&nbsp;[non-printables]&nbsp;arasi&nbsp;reddediliyor&nbsp;olarak&nbsp;ayarlanmis&nbsp;olabilir&nbsp;ilgili&nbsp;WAF'da).&lt;BR&gt;&lt;BR&gt;Peki&nbsp;arkada&nbsp;donen&nbsp;ne?&nbsp;modsec&nbsp;hatirladigim&nbsp;kadari&nbsp;ile&nbsp;&quot;double&nbsp;encoding&quot;&nbsp;saldirilarini&nbsp;engellemek&nbsp;icin&nbsp;aldigi&nbsp;input'u&nbsp;bir&nbsp;daha&nbsp;decode&nbsp;edip,&nbsp;URL&nbsp;denetimini&nbsp;bir&nbsp;daha&nbsp;gercekliyor.&nbsp;Ve&nbsp;boylece&nbsp;mesela&lt;BR&gt;&amp;nbsp;&lt;BR&gt;%a&nbsp;-&amp;gt;&nbsp;%25a&nbsp;-&amp;gt;&nbsp;modsec&nbsp;-&amp;gt;&nbsp;%25a&nbsp;(gecerli&nbsp;URL&nbsp;encoding)&nbsp;-&amp;gt;&nbsp;%a&nbsp;(&lt;B&gt;gecersiz&nbsp;&lt;/B&gt;URL&nbsp;encoding)&nbsp;=&nbsp;istek&nbsp;reddedilir&lt;BR&gt;&amp;nbsp;&lt;BR&gt;ama&nbsp;by-pass&nbsp;teknigi&nbsp;ile&lt;BR&gt;&amp;nbsp;&lt;BR&gt;%aa&nbsp;-&amp;gt;&nbsp;%25aa&nbsp;-&amp;gt;&nbsp;modsec&nbsp;-&amp;gt;&nbsp;%25aa&nbsp;(gecerli&nbsp;URL&nbsp;encoding)&nbsp;-&amp;gt;&nbsp;%aa&nbsp;(&lt;B&gt;gecerli&nbsp;&lt;/B&gt;URL&nbsp;ending)&nbsp;=&nbsp;istek&nbsp;onaylanir&lt;BR&gt;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&lt;BR&gt;bedirhan&lt;BR&gt;&amp;nbsp;&lt;BR&gt;<br>
&lt;HR&gt;<br>
Date:&nbsp;Mon,&nbsp;19&nbsp;May&nbsp;2008&nbsp;13:24:29&nbsp;+0100&lt;BR&gt;From:&nbsp;&lt;A&nbsp;href=&quot;mailto:ferruh@mavituna.com&quot;&gt;ferruh@mavituna.com&lt;/A&gt;&lt;BR&gt;To:&nbsp;&lt;A&nbsp;href=&quot;mailto:owasp-turkey@lists.owasp.org&quot;&gt;owasp-turkey@lists.owasp.org&lt;/A&gt;&lt;BR&gt;Subject:&nbsp;[Owasp-turkey]&nbsp;DoS&nbsp;attacks&nbsp;using&nbsp;SQL&nbsp;Wildcards<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;class=EC_Wj3C7c&gt;&lt;BR&gt;&lt;BR&gt;Herkese&nbsp;Selamlar,&lt;BR&gt;&lt;BR&gt;Bir&nbsp;sure&nbsp;once&nbsp;uzerinde&nbsp;calistigim&nbsp;yazimi&nbsp;bitirdim&nbsp;ve&nbsp;yayinlayabildim,&nbsp;burada&nbsp;da&nbsp;hem&nbsp;paylasmak&nbsp;hem&nbsp;de&nbsp;konu&nbsp;hakkinda&nbsp;fikir&nbsp;almak&nbsp;istedim.&nbsp;&lt;BR&gt;&lt;BR&gt;Ozetle&nbsp;veritabanina&nbsp;sahip&nbsp;web&nbsp;uygulamalarin&nbsp;arama&nbsp;sayfalari&nbsp;ve&nbsp;benzer&nbsp;sayfalari&nbsp;kullanarak&nbsp;DoS&nbsp;saldirilari&nbsp;yapmanin&nbsp;yeni&nbsp;bir&nbsp;yolunu&nbsp;gosteriyor.&lt;BR&gt;Kritik&nbsp;nokta&nbsp;su&nbsp;ki&nbsp;inanilmaz&nbsp;sayida&nbsp;web&nbsp;uygulamasi&nbsp;bundan&nbsp;etkileniyor,&nbsp;dolayisiyla&nbsp;gelsitiricilerin&nbsp;ozellikle&nbsp;bir&nbsp;an&nbsp;once&nbsp;buna&nbsp;karsi&nbsp;onlem&nbsp;almali&nbsp;gerekli.&lt;BR&gt;&lt;BR&gt;Ikinci&nbsp;olarak&nbsp;penetration&nbsp;test&nbsp;yapan&nbsp;arkadaslarin&nbsp;da&nbsp;bu&nbsp;saldiriyi&nbsp;test&nbsp;metodolojilerine&nbsp;eklemeleri&nbsp;yerinde&nbsp;olacaktir.&nbsp;Insallah&nbsp;uzun&nbsp;vadede&nbsp;OWASP&nbsp;Guide&nbsp;da&nbsp;bu&nbsp;konuda&nbsp;bir&nbsp;seyler&nbsp;ekleyebiliriz.&lt;BR&gt;&lt;BR&gt;Maalesef&nbsp;henuz&nbsp;Turkcesi&nbsp;yok,&nbsp;yazi&nbsp;suradan&nbsp;download&nbsp;edilebilir:&lt;BR&gt;&lt;BR&gt;&lt;A&nbsp;href=&quot;http://www.portcullis-security.com/uplds/wildcard_attacks.pdf&quot;&nbsp;target=_blank&gt;http://www.portcullis-security.com/uplds/wildcard_attacks.pdf&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Iyi&nbsp;Calismalar,&lt;BR&nbsp;clear=all&gt;&lt;BR&gt;--&nbsp;&lt;BR&gt;Ferruh&nbsp;Mavituna&lt;BR&gt;&lt;A&nbsp;href=&quot;http://ferruh.mavituna.com/&quot;&nbsp;target=_blank&gt;http://ferruh.mavituna.com&lt;/A&gt;&nbsp;&lt;BR&gt;&lt;BR&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;HR&gt;<br>
E-mail&nbsp;for&nbsp;the&nbsp;greater&nbsp;good.&nbsp;&lt;A&nbsp;href=&quot;http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_+GreaterGood&quot;&nbsp;target=_blank&gt;Join&nbsp;the&nbsp;i'm&nbsp;Initiative&nbsp;from&nbsp;Microsoft.&lt;/A&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/DIV&gt;&lt;BR&gt;&lt;BR&nbsp;clear=all&gt;&lt;BR&gt;--&nbsp;&lt;BR&gt;Ferruh&nbsp;Mavituna&lt;BR&gt;&lt;A&nbsp;href=&quot;http://ferruh.mavituna.com/&quot;&nbsp;target=_blank&gt;http://ferruh.mavituna.com&lt;/A&gt;&nbsp;&lt;/BLOCKQUOTE&gt;&lt;br&nbsp;/&gt;&lt;hr&nbsp;/&gt;Change&nbsp;the&nbsp;world&nbsp;with&nbsp;e-mail.&nbsp;&lt;a&nbsp;href='http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_ChangeWorld'&nbsp;target='_new'&gt;Join&nbsp;the&nbsp;i’m&nbsp;Initiative&nbsp;from&nbsp;Microsoft.&lt;/a&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
