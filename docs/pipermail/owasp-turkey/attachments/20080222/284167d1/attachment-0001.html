<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
FONT-SIZE:&nbsp;10pt;<br>
FONT-FAMILY:Tahoma<br>
}<br>
&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;<br>
&lt;BR&gt;Bu&nbsp;image&nbsp;upload&nbsp;meselesi&nbsp;bu&nbsp;aralar&nbsp;cok&nbsp;populer.&nbsp;Listelerde&nbsp;geciyor,&nbsp;aciklar&nbsp;bulunuyor.&nbsp;Ozellikle&nbsp;1-2&nbsp;gun&nbsp;once&nbsp;pentest&nbsp;securityfocus&nbsp;mail&nbsp;listesinde&nbsp;cok&nbsp;guzel&nbsp;bi&nbsp;thread&nbsp;vardi.&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
&lt;A&nbsp;href=&quot;http://www.securityfocus.com/archive/101/488404/30/0/threaded&quot;&gt;http://www.securityfocus.com/archive/101/488404/30/0/threaded&lt;/A&gt;&lt;BR&gt;<br>
&lt;BR&gt;Bi&nbsp;de&nbsp;aslinda&nbsp;soyle&nbsp;bi&nbsp;durum&nbsp;var.&nbsp;Gecenlerde&nbsp;bi&nbsp;testte&nbsp;karsima&nbsp;cikti.&nbsp;Icine&nbsp;html/js&nbsp;gizledigim&nbsp;imaji&nbsp;upload&nbsp;edebildim&nbsp;ama&nbsp;daha&nbsp;sonra&nbsp;bu&nbsp;image'i&nbsp;istedigimde&nbsp;ASP.NET&nbsp;detayli&nbsp;hata&nbsp;mesaji&nbsp;ile&nbsp;karsilastim.&nbsp;Image'i&nbsp;direk&nbsp;isteyemiyordum&nbsp;ve&nbsp;uygulama&nbsp;Image.fromFile&nbsp;gibi&nbsp;(tam&nbsp;hatirlamiyorum&nbsp;simdi&nbsp;bundan&nbsp;farkli&nbsp;olabilir)&nbsp;bi&nbsp;API&nbsp;ile&nbsp;okuyup&nbsp;gosteriyordu.&nbsp;(bi&nbsp;kac&nbsp;trick&nbsp;denedim&nbsp;burda&nbsp;ama&nbsp;hata&nbsp;mesajlarindan&nbsp;kurtulamadim)&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
Herneyse,&nbsp;yani&nbsp;input&nbsp;kontrol'unun&nbsp;yaninda&amp;nbsp;-&nbsp;mesela&nbsp;1-2&nbsp;hafta&nbsp;kadar&nbsp;once&nbsp;diger&nbsp;kontrollerin&nbsp;yaninda&amp;nbsp;Joomla&nbsp;JCE&nbsp;editor&nbsp;kodunda&amp;nbsp;linux'ta&nbsp;&lt;STRONG&gt;file&lt;/STRONG&gt;&nbsp;komutunu&nbsp;kullandik,&nbsp;ki&amp;nbsp;bundan&nbsp;once&nbsp;joomla'ya&nbsp;html/js&nbsp;upload&nbsp;edebiliyorduk&nbsp;:)&nbsp;-,&nbsp;cikti&nbsp;kontrolu&nbsp;de&nbsp;cok&nbsp;onemli.&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
bedirhan&lt;BR&gt;<br>
&lt;BLOCKQUOTE&gt;<br>
&lt;HR&gt;<br>
From:&nbsp;mesut@h-labs.org&lt;BR&gt;To:&nbsp;vuzun@csusb.edu&lt;BR&gt;Date:&nbsp;Thu,&nbsp;21&nbsp;Feb&nbsp;2008&nbsp;22:18:39&nbsp;+0000&lt;BR&gt;CC:&nbsp;owasp-turkey@lists.owasp.org&lt;BR&gt;Subject:&nbsp;Re:&nbsp;[Owasp-turkey]&nbsp;Asp.NET&nbsp;Dosya&nbsp;Ekleme&nbsp;,&nbsp;Grafik&nbsp;Manipulasyonu&lt;BR&gt;&lt;BR&gt;<br>
&lt;META&nbsp;content=&quot;Microsoft&nbsp;SafeHTML&quot;&nbsp;name=Generator&gt;<br>
&lt;STYLE&gt;<br>
.ExternalClass&nbsp;.EC_hmmessage&nbsp;P<br>
{padding:0px;}<br>
.ExternalClass&nbsp;EC_body.hmmessage<br>
{font-size:10pt;font-family:Tahoma;}<br>
&lt;/STYLE&gt;<br>
&lt;BR&gt;&lt;BR&gt;Aklima&nbsp;geldi&nbsp;lakin&nbsp;bu&nbsp;cozumden&nbsp;tam&nbsp;emin&nbsp;degilim.&nbsp;Zira&nbsp;ornegin&nbsp;GIF&nbsp;icin&nbsp;GIF89a&nbsp;ekleyip&nbsp;bu&nbsp;atraksiyonu&nbsp;gecebiliyorduk&nbsp;diye&nbsp;hatirliyorum,&nbsp;haricinde&nbsp;tum&nbsp;grafik&nbsp;turleri&nbsp;headerlarini&nbsp;kontrol&nbsp;edip&nbsp;tum&nbsp;browserlarda&nbsp;ayni&nbsp;korumanin&nbsp;gecerli&nbsp;oldugunu&nbsp;test&nbsp;etmemiz&nbsp;gerekir&nbsp;bu&nbsp;cozume&nbsp;inanmak&nbsp;icin.&nbsp;Gerci&nbsp;baska&nbsp;turlu&nbsp;nasil&nbsp;kontrol&nbsp;yapilacak&nbsp;fikrim&nbsp;yok&nbsp;ve&nbsp;hakli&nbsp;olabilirsiniz&nbsp;aslinda&nbsp;ama&nbsp;belki&nbsp;daha&nbsp;iyi&nbsp;bir&nbsp;cozum&nbsp;olabilir.&lt;BR&gt;&lt;BR&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;&lt;FONT&nbsp;color=#0033ff&gt;Mesut&nbsp;TÝMUR&nbsp;&lt;BR&gt;&lt;A&nbsp;href=&quot;http://mail2web.com/cgi-bin/redir.asp?lid=0&amp;amp;newsite=http://www.h-labs.org&quot;&nbsp;target=_blank&gt;&lt;U&gt;&lt;FONT&nbsp;color=#0000ff&gt;http://www.h-labs.org&lt;/FONT&gt;&lt;/U&gt;&lt;/A&gt;&nbsp;&lt;BR&gt;H&nbsp;-&nbsp;Security&nbsp;Labs&nbsp;Güvenlik&nbsp;Editörü&nbsp;&lt;BR&gt;GYTE&nbsp;Bilgisayar&nbsp;Mühendisliði&lt;/FONT&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;<br>
&lt;BLOCKQUOTE&gt;<br>
&lt;HR&gt;<br>
From:&nbsp;vuzun@csusb.edu&lt;BR&gt;To:&nbsp;mesut@h-labs.org&lt;BR&gt;CC:&nbsp;owasp-turkey@lists.owasp.org&lt;BR&gt;Date:&nbsp;Thu,&nbsp;21&nbsp;Feb&nbsp;2008&nbsp;13:51:17&nbsp;-0800&lt;BR&gt;Subject:&nbsp;Re:&nbsp;[Owasp-turkey]&nbsp;Asp.NET&nbsp;Dosya&nbsp;Ekleme&nbsp;,&nbsp;Grafik&nbsp;Manipulasyonu&lt;BR&gt;&lt;BR&gt;acaba&nbsp;dosyayip&nbsp;acip&nbsp;headeri&nbsp;okumaya&nbsp;calismak&nbsp;cozum&nbsp;olabilir&nbsp;mi&lt;BR&gt;&lt;BR&gt;-----&nbsp;Original&nbsp;Message&nbsp;-----&nbsp;&lt;BR&gt;From:&nbsp;Mesut&nbsp;Timur&nbsp;&amp;lt;mesut@h-labs.org&amp;gt;&nbsp;&lt;BR&gt;Date:&nbsp;Thursday,&nbsp;February&nbsp;21,&nbsp;2008&nbsp;1:41&nbsp;pm&nbsp;&lt;BR&gt;Subject:&nbsp;[Owasp-turkey]&nbsp;Asp.NET&nbsp;Dosya&nbsp;Ekleme&nbsp;,&nbsp;Grafik&nbsp;Manipulasyonu&nbsp;&lt;BR&gt;To:&nbsp;owasp-turkey@lists.owasp.org&nbsp;&lt;BR&gt;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Merhaba;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Test&nbsp;ettigim&nbsp;bir&nbsp;web&nbsp;uygulamasinda&nbsp;bir&nbsp;fotograf&nbsp;albumu&nbsp;&lt;BR&gt;&amp;gt;&nbsp;olusturulabiliyor,&nbsp;ve&nbsp;file&nbsp;upload&nbsp;isini&nbsp;dogru&nbsp;duzgun&nbsp;sekilde&nbsp;&lt;BR&gt;&amp;gt;&nbsp;yapamamislar.Anladigim&nbsp;kadariyla&nbsp;upload&nbsp;edilen&nbsp;dosyanin&nbsp;sadece&nbsp;&lt;BR&gt;&amp;gt;&nbsp;uzantisidenetleniyor,&nbsp;sizin&nbsp;de&nbsp;tahmin&nbsp;edeceginiz&nbsp;uzere&nbsp;grafik&nbsp;&lt;BR&gt;&amp;gt;&nbsp;dosyasinin&nbsp;icine&nbsp;&lt;BR&gt;&amp;gt;&nbsp;client-side&nbsp;payload'unuzu&nbsp;yerlestirerek&nbsp;guzelce&nbsp;(en&nbsp;azindan&nbsp;IE&nbsp;&lt;BR&gt;&amp;gt;&nbsp;uzerinde)&nbsp;XSS&nbsp;yapabiliyorsunuz.&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Simdi&nbsp;sorum&nbsp;su&nbsp;:&amp;nbsp;&nbsp;Verilen&nbsp;grafik&nbsp;dosyasinin&nbsp;gercekten&nbsp;grafik&nbsp;olup&nbsp;&lt;BR&gt;&amp;gt;&nbsp;olmadigini&nbsp;denetlemek&nbsp;icin,&nbsp;Asp.NET'te&nbsp;kullandiginiz&nbsp;bir&nbsp;library&nbsp;&lt;BR&gt;&amp;gt;&nbsp;ya&nbsp;da&nbsp;&lt;BR&gt;&amp;gt;&nbsp;cozum&nbsp;var&nbsp;mi?&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Sevgiler,&nbsp;saygilar&nbsp;,&nbsp;iyi&nbsp;calismalar!&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Mesut&nbsp;TÝMUR&nbsp;&lt;BR&gt;&amp;gt;&nbsp;http://www.h-labs.org&nbsp;&lt;BR&gt;&amp;gt;&nbsp;H&nbsp;-&nbsp;Security&nbsp;Labs&nbsp;Güvenlik&nbsp;Editörü&nbsp;&lt;BR&gt;&amp;gt;&nbsp;GYTE&nbsp;Bilgisayar&nbsp;Mühendisliði&nbsp;&lt;BR&gt;&amp;gt;&nbsp;_________________________________________________________________&nbsp;&lt;BR&gt;&amp;gt;&nbsp;Helping&nbsp;your&nbsp;favorite&nbsp;cause&nbsp;is&nbsp;as&nbsp;easy&nbsp;as&nbsp;instant&nbsp;messaging.&amp;nbsp;You&nbsp;&lt;BR&gt;&amp;gt;&nbsp;IM,&nbsp;we&nbsp;give.&nbsp;&lt;BR&gt;&amp;gt;&nbsp;http://im.live.com/Messenger/IM/Home/?source=text_hotmail_join&nbsp;&lt;BR&gt;&amp;gt;&nbsp;&lt;/BLOCKQUOTE&gt;&lt;BR&gt;<br>
&lt;HR&gt;<br>
Need&nbsp;to&nbsp;know&nbsp;the&nbsp;score,&nbsp;the&nbsp;latest&nbsp;news,&nbsp;or&nbsp;you&nbsp;need&nbsp;your&nbsp;Hotmail®-get&nbsp;your&nbsp;&quot;fix&quot;.&nbsp;&lt;A&nbsp;href=&quot;http://www.msnmobilefix.com/Default.aspx&quot;&nbsp;target=_blank&gt;Check&nbsp;it&nbsp;out.&lt;/A&gt;&nbsp;&lt;/BLOCKQUOTE&gt;&lt;br&nbsp;/&gt;&lt;hr&nbsp;/&gt;Shed&nbsp;those&nbsp;extra&nbsp;pounds&nbsp;with&nbsp;MSN&nbsp;and&nbsp;The&nbsp;Biggest&nbsp;Loser!&nbsp;&lt;a&nbsp;href='http://biggestloser.msn.com/'&nbsp;target='_new'&gt;Learn&nbsp;more.&lt;/a&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
