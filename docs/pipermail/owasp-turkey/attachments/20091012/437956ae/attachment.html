<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;10pt;<br>
font-family:Verdana<br>
}<br>
--&gt;&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;<br>
&lt;BR&gt;Ben&nbsp;ilk&nbsp;gorduklerimi&nbsp;soyleyeyim&nbsp;o&nbsp;zaman.&nbsp;Javaya&nbsp;hakim&nbsp;olmadigimi&nbsp;belirterek&nbsp;baslayayim.&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
&lt;UL&gt;<br>
&lt;LI&gt;String&nbsp;filename&nbsp;=&nbsp;user.downloadDirPath&nbsp;+&nbsp;separator&nbsp;+&nbsp;request.getParameter(&quot;filename&quot;);&nbsp;&lt;BR&gt;reportLog.writeln(&quot;Download&nbsp;Request&nbsp;User:&quot;&nbsp;+&nbsp;user.userName&nbsp;+&nbsp;&quot;&nbsp;FileName:&quot;&nbsp;+&nbsp;filename);&lt;BR&gt;File&nbsp;f&nbsp;=&nbsp;new&nbsp;File(filename.trim());&lt;/LI&gt;&lt;/UL&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
Burada&nbsp;../../&nbsp;ile&nbsp;yukaridaki&nbsp;dizinlere&nbsp;cikmak&nbsp;mumkun&nbsp;gibi,&nbsp;tabi&nbsp;API&nbsp;ekstra&nbsp;bir&nbsp;guvenlik&nbsp;sunmuyorsa&nbsp;??&nbsp;O&nbsp;zaman&nbsp;sistemden&nbsp;arbitrary&nbsp;sekilde&nbsp;dosyalari&nbsp;okumak&nbsp;mumkun&nbsp;olacaktir,&nbsp;muhtemelen&nbsp;LFI&nbsp;da&nbsp;.&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
&lt;UL&gt;<br>
&lt;LI&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;response.setHeader(&quot;Content-Disposition&quot;,&nbsp;&quot;attachment;&nbsp;filename=\&quot;&quot;&nbsp;+&nbsp;request.getParameter(&quot;filename&quot;)&nbsp;+&nbsp;&quot;\&quot;&quot;);&lt;BR&gt;&lt;/LI&gt;&lt;/UL&gt;<br>
Burada&nbsp;da&nbsp;Header&nbsp;Injection&nbsp;mumkun&nbsp;gorunuyor.&nbsp;HTTP&nbsp;Response&nbsp;Splitting&nbsp;yapilabilir.&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
&lt;UL&gt;<br>
&lt;LI&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;reportLog.writeln(&quot;Download&nbsp;Request&nbsp;User:&quot;&nbsp;+&nbsp;user.userName&nbsp;+&nbsp;&quot;&nbsp;FileName:&quot;&nbsp;+&nbsp;filename);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&nbsp;reportLog.writeln(&quot;Download&nbsp;Response&nbsp;User:&quot;&nbsp;+&nbsp;user.userName&nbsp;+&nbsp;&quot;&nbsp;FileName:&quot;&nbsp;+&nbsp;filename&nbsp;+&nbsp;&quot;&nbsp;Success&nbsp;&quot;);&lt;/DIV&gt;&lt;/LI&gt;&lt;/UL&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
reportLog'a&nbsp;sahte&nbsp;kayitlar&nbsp;eklemek&nbsp;mumkun.&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
Baska&nbsp;bir&nbsp;sey&nbsp;cikartamadim.&lt;BR&gt;<br>
&lt;BR&gt;&lt;BR&gt;&lt;FONT&nbsp;color=#0033ff&gt;Mesut&nbsp;T©MUR&lt;BR&gt;&lt;/FONT&gt;&lt;FONT&nbsp;color=#0033ff&gt;&lt;A&nbsp;href=&quot;http://www.h-labs.org/&quot;&gt;&lt;U&gt;&lt;FONT&nbsp;color=#0000ff&gt;http://www.h-labs.org&lt;/FONT&gt;&lt;/U&gt;&lt;/A&gt;&amp;nbsp;&lt;BR&gt;&lt;/FONT&gt;&lt;FONT&nbsp;color=#0033ff&gt;GYTE&nbsp;Bilgisayar&nbsp;Mühendisli»i&lt;/FONT&gt;&lt;BR&gt;&lt;BR&gt;&lt;FONT&nbsp;color=#000000&gt;Türkçe&nbsp;Web&nbsp;Uygulamas¹&nbsp;Güvenli»i&nbsp;E-Posta&nbsp;Listesine&nbsp;üye&nbsp;olmak&nbsp;için:&lt;/FONT&gt;&lt;FONT&nbsp;color=#0033ff&gt;&lt;BR&gt;&lt;A&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-turkey&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-turkey&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&lt;/FONT&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&amp;nbsp;&lt;BR&gt;<br>
&lt;HR&nbsp;id=stopSpelling&gt;<br>
Date:&nbsp;Mon,&nbsp;12&nbsp;Oct&nbsp;2009&nbsp;14:42:52&nbsp;+0300&lt;BR&gt;From:&nbsp;bedirhanurgun@gmail.com&lt;BR&gt;To:&nbsp;owasp-turkey@lists.owasp.org&lt;BR&gt;Subject:&nbsp;Re:&nbsp;[Owasp-turkey]&nbsp;Ar¹zay¹&nbsp;Bul&nbsp;#1&lt;BR&gt;&lt;BR&gt;<br>
&lt;DIV&gt;:)&nbsp;ya&nbsp;cok&nbsp;kolay&nbsp;geldi&nbsp;ya&nbsp;da&nbsp;cok&nbsp;zor,&nbsp;kestiremedim.&lt;/DIV&gt;<br>
&lt;DIV&gt;Asagidaki&nbsp;parcada&nbsp;benim&nbsp;gordugum&nbsp;3&amp;nbsp;KRITIK&nbsp;guvenlik&nbsp;zafiyeti&nbsp;var.&nbsp;Java&nbsp;olduguna&nbsp;bakmayin,&nbsp;API'lar&nbsp;cok&nbsp;degismiyor.&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;bedirhan&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;class=ecxgmail_quote&gt;10&nbsp;Ekim&nbsp;2009&nbsp;15:49&nbsp;tarihinde&nbsp;Bedirhan&nbsp;Urgun&nbsp;&lt;SPAN&nbsp;dir=ltr&gt;&amp;lt;&lt;A&nbsp;href=&quot;mailto:bedirhanurgun@gmail.com&quot;&gt;bedirhanurgun@gmail.com&lt;/A&gt;&amp;gt;&lt;/SPAN&gt;&nbsp;yazd¹:&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;style=&quot;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid;&nbsp;PADDING-LEFT:&nbsp;1ex&quot;&nbsp;class=ecxgmail_quote&gt;<br>
&lt;DIV&gt;merhaba,&lt;/DIV&gt;<br>
&lt;DIV&gt;Yazilim&nbsp;kaynakli&nbsp;guvenlik&nbsp;problemleri&nbsp;hepimizin&nbsp;malumu.&nbsp;Kod&nbsp;tabanli&nbsp;guvenlik&nbsp;problemlerini&nbsp;bulup/tartisabilecegimiz&nbsp;mailler&amp;nbsp;gonderecegim&nbsp;kisa&nbsp;periyotlarla.&amp;nbsp;Asagidaki&nbsp;Java&nbsp;parcasinda&nbsp;hangi&nbsp;guvenlik&nbsp;problemi(leri)&nbsp;var&nbsp;ve&nbsp;nasil&nbsp;cozulur?&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;bedirhan&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Ar¹zay¹&nbsp;Bul&nbsp;#1&lt;/DIV&gt;<br>
&lt;DIV&gt;--------------------&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&nbsp;private&nbsp;void&nbsp;doDownload(&nbsp;HttpServletRequest&nbsp;request,&nbsp;HttpServletResponse&nbsp;response&nbsp;)&nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;try&nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;//&nbsp;get&nbsp;the&nbsp;user&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;HttpSession&nbsp;session&nbsp;=&nbsp;request.getSession();&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;User&nbsp;user&nbsp;=&nbsp;(User)&nbsp;session.getAttribute(UserConst.userAttr);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;String&nbsp;filename&nbsp;=&nbsp;user.downloadDirPath&nbsp;+&nbsp;separator&nbsp;+&nbsp;request.getParameter(&quot;filename&quot;);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;reportLog.writeln(&quot;Download&nbsp;Request&nbsp;User:&quot;&nbsp;+&nbsp;user.userName&nbsp;+&nbsp;&quot;&nbsp;FileName:&quot;&nbsp;+&nbsp;filename);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;File&nbsp;f&nbsp;=&nbsp;new&nbsp;File(filename.trim());&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;//&nbsp;get&nbsp;servlet&nbsp;output&nbsp;stream&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;ServletOutputStream&nbsp;op&nbsp;=&nbsp;response.getOutputStream();&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;response.setContentLength((int)&nbsp;f.length());&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;response.setHeader(&quot;Content-Disposition&quot;,&nbsp;&quot;attachment;&nbsp;filename=\&quot;&quot;&nbsp;+&nbsp;request.getParameter(&quot;filename&quot;)&nbsp;+&nbsp;&quot;\&quot;&quot;);&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;response.setHeader(&quot;Content-Type&quot;,&nbsp;&quot;application/octet-stream&quot;);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;byte[]&nbsp;bbuf&nbsp;=&nbsp;new&nbsp;byte[255];&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;DataInputStream&nbsp;in&nbsp;=&nbsp;new&nbsp;DataInputStream(new&nbsp;FileInputStream(f));&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;int&nbsp;length&nbsp;=&nbsp;0;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;while(&nbsp;(in&nbsp;!=&nbsp;null)&nbsp;&amp;amp;&amp;amp;&nbsp;((length&nbsp;=&nbsp;in.read(bbuf))&nbsp;!=&nbsp;-1)&nbsp;)&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;op.write(bbuf,&nbsp;0,&nbsp;length);&lt;/DIV&gt;<br>
&lt;DIV&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;in.close();&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;op.flush();&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;op.close();&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;reportLog.writeln(&quot;Download&nbsp;Response&nbsp;User:&quot;&nbsp;+&nbsp;user.userName&nbsp;+&nbsp;&quot;&nbsp;FileName:&quot;&nbsp;+&nbsp;filename&nbsp;+&nbsp;&quot;&nbsp;Success&nbsp;&quot;);&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&nbsp;&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;catch(&nbsp;Exception&nbsp;e&nbsp;)&nbsp;{&lt;BR&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;SendException(e,&nbsp;request,&nbsp;response);&lt;BR&gt;&amp;nbsp;&amp;nbsp;}&lt;BR&gt;&amp;nbsp;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;&lt;/DIV&gt;&lt;BR&gt;&lt;BR&nbsp;clear=all&gt;<br>
&lt;DIV&gt;&lt;/DIV&gt;&lt;BR&gt;--&nbsp;&lt;BR&gt;Bedirhan&nbsp;Urgun&lt;BR&gt;&lt;A&nbsp;href=&quot;http://www.webguvenligi.org/&quot;&gt;http://www.webguvenligi.org&lt;/A&gt;&lt;BR&gt;&lt;A&nbsp;href=&quot;http://www.owasp.org/index.php/Turkey&quot;&gt;http://www.owasp.org/index.php/Turkey&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;Türkçe&nbsp;Web&nbsp;Uygulama&nbsp;Güvenli»i&nbsp;E-Posta&nbsp;Listesine&nbsp;üye&nbsp;olmak&nbsp;için:&nbsp;&lt;BR&gt;&lt;A&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-turkey&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-turkey&lt;/A&gt;&lt;BR&gt;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp;&nbsp;&lt;br&nbsp;/&gt;&lt;hr&nbsp;/&gt;Your&nbsp;E-mail&nbsp;and&nbsp;More&nbsp;On-the-Go.&nbsp;Get&nbsp;Windows&nbsp;Live&nbsp;Hotmail&nbsp;Free.&nbsp;&lt;a&nbsp;href='http://clk.atdmt.com/GBL/go/171222985/direct/01/'&nbsp;target='_new'&gt;Sign&nbsp;up&nbsp;now.&lt;/a&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
