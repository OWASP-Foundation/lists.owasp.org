<tt>
Merhabalar,&nbsp;&lt;br&gt;&lt;br&gt;Tesekkurler&nbsp;Bedirhan,&nbsp;paylastiginiz&nbsp;nokta&nbsp;ilgincmis&nbsp;benim&nbsp;modsecurity&nbsp;hic&nbsp;aklima&nbsp;gelmemisti&nbsp;o&nbsp;sirada.&nbsp;Ek&nbsp;olarak&nbsp;payload&nbsp;cok&nbsp;daha&nbsp;farkli&nbsp;sekillerde&nbsp;de&nbsp;yapilabilir,&nbsp;senin&nbsp;gosterdigin&nbsp;ve&nbsp;buldugunuz&nbsp;yontem&nbsp;de&nbsp;bunun&nbsp;gibi.&lt;br&gt;<br>
&lt;br&gt;Mesela&nbsp;benim&nbsp;gene&nbsp;dokumanda&nbsp;verdigim&nbsp;basit&nbsp;bir&nbsp;ornek&nbsp;var&nbsp;:&nbsp;_[r/a)_&nbsp;_(r/b)_&nbsp;_(r-d)_&nbsp;&lt;br&gt;&lt;br&gt;Gayet&nbsp;kisa&nbsp;ve&nbsp;benim&nbsp;testimdeki&nbsp;bir&nbsp;web&nbsp;forum&nbsp;yaziliminda&nbsp;30+&nbsp;sn.&nbsp;suruyor&nbsp;calismasi&nbsp;:),&nbsp;yazilim&nbsp;detaylarini&nbsp;burada&nbsp;veremiyorum,&nbsp;kendilerine&nbsp;de&nbsp;acik&nbsp;olarak&nbsp;bildirdim&nbsp;zaten&nbsp;ama&nbsp;sadece&nbsp;durumun&nbsp;vehametini&nbsp;ortaya&nbsp;koymak&nbsp;adina.&nbsp;Bu&nbsp;yazilimda&nbsp;mesela&nbsp;15&nbsp;karakter&nbsp;gibi&nbsp;bir&nbsp;limit&nbsp;vardi,&nbsp;ama&nbsp;ona&nbsp;ragment&nbsp;yukaridaki&nbsp;basit&nbsp;arama&nbsp;yetti.&lt;br&gt;<br>
&lt;br&gt;Bu&nbsp;arada&nbsp;karsimiza&nbsp;geldiginde&nbsp;bypass&nbsp;edebilmek&nbsp;icin&nbsp;bu&nbsp;double&nbsp;encoding&nbsp;olayini&nbsp;akilda&nbsp;tutmak&nbsp;lazim.&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2008/5/20&nbsp;Bedirhan&nbsp;Urgun&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:urgunb@hotmail.com&quot;&gt;urgunb@hotmail.com&lt;/a&gt;&amp;gt;:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
<br>
&lt;div&gt;&lt;br&gt;&amp;nbsp;merhaba,&lt;br&gt;tebrik&nbsp;ederim&amp;nbsp;Ferruh.&amp;nbsp;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
Yazidaki&nbsp;teknik&nbsp;ile&nbsp;alakali&nbsp;olarak&nbsp;bugun&nbsp;Yusuf&nbsp;Çeri&nbsp;ile&nbsp;farkettigimiz&nbsp;bi&nbsp;noktayi&amp;nbsp;paylasmak&nbsp;istedim.&nbsp;Eger&nbsp;modsecurity&nbsp;ile&nbsp;korunan&nbsp;sisteminiz&nbsp;(veya&nbsp;baska&nbsp;bir&nbsp;WAF),&amp;nbsp;yazida&nbsp;belirtilen&nbsp;asagidaki&nbsp;payloadu&nbsp;reddiyorsa&nbsp;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;&lt;font&nbsp;color=&quot;#ff0000&quot;&nbsp;size=&quot;1&quot;&gt;<br>
&amp;#39;%_[^!_%/%a?&lt;font&nbsp;face=&quot;&quot;&gt;F%_D&lt;/font&gt;)_(F%)_%([)({}%){()}£$&amp;amp;N%_)$*£()$*R&amp;quot;_)][%](%[x])%a][$*&amp;quot;£$-9]_%&amp;#39;&nbsp;&lt;br&gt;<br>
&lt;/font&gt;&amp;nbsp;&lt;br&gt;<br>
bu&amp;nbsp;saldiriya&nbsp;acik&nbsp;degiliz&amp;nbsp;anlamina&nbsp;gelmiyor.&nbsp;Yukaridaki&nbsp;payload&amp;#39;un&nbsp;basit&nbsp;bir&nbsp;bypass&nbsp;teknigi&nbsp;uygulanmis&nbsp;hali;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#3366ff&quot;&gt;&amp;#39;%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}£$&amp;amp;N%55_)$*£()$*R&amp;quot;_)][%55](%66[x])%ba][$*&amp;quot;£$-9]_%54&amp;#39;&lt;/font&gt;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
Yani&nbsp;payloaddaki&nbsp;%&nbsp;yerine&nbsp;gecerli&nbsp;bir&nbsp;url&nbsp;encoded&nbsp;karakter&nbsp;giriliyor&nbsp;(ascii&nbsp;32&amp;#39;den&nbsp;buyuk&nbsp;olmasi&nbsp;daha&nbsp;iyi&nbsp;cunku&nbsp;0-32&nbsp;[non-printables]&nbsp;arasi&nbsp;reddediliyor&nbsp;olarak&nbsp;ayarlanmis&nbsp;olabilir&nbsp;ilgili&nbsp;WAF&amp;#39;da).&lt;br&gt;&lt;br&gt;<br>
Peki&nbsp;arkada&nbsp;donen&nbsp;ne?&nbsp;modsec&nbsp;hatirladigim&nbsp;kadari&nbsp;ile&nbsp;&amp;quot;double&nbsp;encoding&amp;quot;&nbsp;saldirilarini&nbsp;engellemek&nbsp;icin&nbsp;aldigi&nbsp;input&amp;#39;u&nbsp;bir&nbsp;daha&nbsp;decode&nbsp;edip,&nbsp;URL&nbsp;denetimini&nbsp;bir&nbsp;daha&nbsp;gercekliyor.&nbsp;Ve&nbsp;boylece&nbsp;mesela&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
%a&nbsp;-&amp;gt;&nbsp;%25a&nbsp;-&amp;gt;&nbsp;modsec&nbsp;-&amp;gt;&nbsp;%25a&nbsp;(gecerli&nbsp;URL&nbsp;encoding)&nbsp;-&amp;gt;&nbsp;%a&nbsp;(&lt;b&gt;gecersiz&nbsp;&lt;/b&gt;URL&nbsp;encoding)&nbsp;=&nbsp;istek&nbsp;reddedilir&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
ama&nbsp;by-pass&nbsp;teknigi&nbsp;ile&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
%aa&nbsp;-&amp;gt;&nbsp;%25aa&nbsp;-&amp;gt;&nbsp;modsec&nbsp;-&amp;gt;&nbsp;%25aa&nbsp;(gecerli&nbsp;URL&nbsp;encoding)&nbsp;-&amp;gt;&nbsp;%aa&nbsp;(&lt;b&gt;gecerli&nbsp;&lt;/b&gt;URL&nbsp;ending)&nbsp;=&nbsp;istek&nbsp;onaylanir&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
bedirhan&lt;br&gt;<br>
&amp;nbsp;&lt;br&gt;<br>
<br>
&lt;hr&gt;<br>
Date:&nbsp;Mon,&nbsp;19&nbsp;May&nbsp;2008&nbsp;13:24:29&nbsp;+0100&lt;br&gt;From:&nbsp;&lt;a&nbsp;href=&quot;mailto:ferruh@mavituna.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ferruh@mavituna.com&lt;/a&gt;&lt;br&gt;To:&nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-turkey@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-turkey@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;[Owasp-turkey]&nbsp;DoS&nbsp;attacks&nbsp;using&nbsp;SQL&nbsp;Wildcards&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;Wj3C7c&quot;&gt;&lt;br&gt;&lt;br&gt;Herkese&nbsp;Selamlar,&lt;br&gt;&lt;br&gt;Bir&nbsp;sure&nbsp;once&nbsp;uzerinde&nbsp;calistigim&nbsp;yazimi&nbsp;bitirdim&nbsp;ve&nbsp;yayinlayabildim,&nbsp;burada&nbsp;da&nbsp;hem&nbsp;paylasmak&nbsp;hem&nbsp;de&nbsp;konu&nbsp;hakkinda&nbsp;fikir&nbsp;almak&nbsp;istedim.&nbsp;&lt;br&gt;<br>
&lt;br&gt;Ozetle&nbsp;veritabanina&nbsp;sahip&nbsp;web&nbsp;uygulamalarin&nbsp;arama&nbsp;sayfalari&nbsp;ve&nbsp;benzer&nbsp;sayfalari&nbsp;kullanarak&nbsp;DoS&nbsp;saldirilari&nbsp;yapmanin&nbsp;yeni&nbsp;bir&nbsp;yolunu&nbsp;gosteriyor.&lt;br&gt;Kritik&nbsp;nokta&nbsp;su&nbsp;ki&nbsp;inanilmaz&nbsp;sayida&nbsp;web&nbsp;uygulamasi&nbsp;bundan&nbsp;etkileniyor,&nbsp;dolayisiyla&nbsp;gelsitiricilerin&nbsp;ozellikle&nbsp;bir&nbsp;an&nbsp;once&nbsp;buna&nbsp;karsi&nbsp;onlem&nbsp;almali&nbsp;gerekli.&lt;br&gt;<br>
&lt;br&gt;Ikinci&nbsp;olarak&nbsp;penetration&nbsp;test&nbsp;yapan&nbsp;arkadaslarin&nbsp;da&nbsp;bu&nbsp;saldiriyi&nbsp;test&nbsp;metodolojilerine&nbsp;eklemeleri&nbsp;yerinde&nbsp;olacaktir.&nbsp;Insallah&nbsp;uzun&nbsp;vadede&nbsp;OWASP&nbsp;Guide&nbsp;da&nbsp;bu&nbsp;konuda&nbsp;bir&nbsp;seyler&nbsp;ekleyebiliriz.&lt;br&gt;&lt;br&gt;Maalesef&nbsp;henuz&nbsp;Turkcesi&nbsp;yok,&nbsp;yazi&nbsp;suradan&nbsp;download&nbsp;edilebilir:&lt;br&gt;<br>
&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.portcullis-security.com/uplds/wildcard_attacks.pdf&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.portcullis-security.com/uplds/wildcard_attacks.pdf&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;Iyi&nbsp;Calismalar,&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Ferruh&nbsp;Mavituna&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://ferruh.mavituna.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://ferruh.mavituna.com&lt;/a&gt;&nbsp;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;hr&gt;E-mail&nbsp;for&nbsp;the&nbsp;greater&nbsp;good.&nbsp;&lt;a&nbsp;href=&quot;http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_+GreaterGood&quot;&nbsp;target=&quot;_blank&quot;&gt;Join&nbsp;the&nbsp;i'm&nbsp;Initiative&nbsp;from&nbsp;Microsoft.&lt;/a&gt;&lt;/div&gt;<br>
<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Ferruh&nbsp;Mavituna&lt;br&gt;&lt;a&nbsp;href=&quot;http://ferruh.mavituna.com&quot;&gt;http://ferruh.mavituna.com&lt;/a&gt;<br>

</tt>
