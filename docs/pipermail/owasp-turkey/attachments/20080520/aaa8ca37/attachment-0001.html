<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
FONT-SIZE:&nbsp;10pt;<br>
FONT-FAMILY:Tahoma<br>
}<br>
&lt;/style&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;BR&gt;&amp;nbsp;merhaba,&lt;BR&gt;tebrik&nbsp;ederim&amp;nbsp;Ferruh.&amp;nbsp;&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
Yazidaki&nbsp;teknik&nbsp;ile&nbsp;alakali&nbsp;olarak&nbsp;bugun&nbsp;Yusuf&nbsp;Çeri&nbsp;ile&nbsp;farkettigimiz&nbsp;bi&nbsp;noktayi&amp;nbsp;paylasmak&nbsp;istedim.&nbsp;Eger&nbsp;modsecurity&nbsp;ile&nbsp;korunan&nbsp;sisteminiz&nbsp;(veya&nbsp;baska&nbsp;bir&nbsp;WAF),&amp;nbsp;yazida&nbsp;belirtilen&nbsp;asagidaki&nbsp;payloadu&nbsp;reddiyorsa&nbsp;&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;&lt;FONT&nbsp;color=#ff0000&nbsp;size=1&gt;<br>
'%_[^!_%/%a?&lt;FONT&nbsp;face=&quot;&quot;&gt;F%_D&lt;/FONT&gt;)_(F%)_%([)({}%){()}£$&amp;amp;N%_)$*£()$*R&quot;_)][%](%[x])%a][$*&quot;£$-9]_%'&nbsp;&lt;BR&gt;<br>
&lt;/FONT&gt;&amp;nbsp;&lt;BR&gt;<br>
bu&amp;nbsp;saldiriya&nbsp;acik&nbsp;degiliz&amp;nbsp;anlamina&nbsp;gelmiyor.&nbsp;Yukaridaki&nbsp;payload'un&nbsp;basit&nbsp;bir&nbsp;bypass&nbsp;teknigi&nbsp;uygulanmis&nbsp;hali;&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
&lt;FONT&nbsp;color=#3366ff&gt;'%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}£$&amp;amp;N%55_)$*£()$*R&quot;_)][%55](%66[x])%ba][$*&quot;£$-9]_%54'&lt;/FONT&gt;&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
Yani&nbsp;payloaddaki&nbsp;%&nbsp;yerine&nbsp;gecerli&nbsp;bir&nbsp;url&nbsp;encoded&nbsp;karakter&nbsp;giriliyor&nbsp;(ascii&nbsp;32'den&nbsp;buyuk&nbsp;olmasi&nbsp;daha&nbsp;iyi&nbsp;cunku&nbsp;0-32&nbsp;[non-printables]&nbsp;arasi&nbsp;reddediliyor&nbsp;olarak&nbsp;ayarlanmis&nbsp;olabilir&nbsp;ilgili&nbsp;WAF'da).&lt;BR&gt;&lt;BR&gt;<br>
Peki&nbsp;arkada&nbsp;donen&nbsp;ne?&nbsp;modsec&nbsp;hatirladigim&nbsp;kadari&nbsp;ile&nbsp;&quot;double&nbsp;encoding&quot;&nbsp;saldirilarini&nbsp;engellemek&nbsp;icin&nbsp;aldigi&nbsp;input'u&nbsp;bir&nbsp;daha&nbsp;decode&nbsp;edip,&nbsp;URL&nbsp;denetimini&nbsp;bir&nbsp;daha&nbsp;gercekliyor.&nbsp;Ve&nbsp;boylece&nbsp;mesela&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
%a&nbsp;-&amp;gt;&nbsp;%25a&nbsp;-&amp;gt;&nbsp;modsec&nbsp;-&amp;gt;&nbsp;%25a&nbsp;(gecerli&nbsp;URL&nbsp;encoding)&nbsp;-&amp;gt;&nbsp;%a&nbsp;(&lt;STRONG&gt;gecersiz&nbsp;&lt;/STRONG&gt;URL&nbsp;encoding)&nbsp;=&nbsp;istek&nbsp;reddedilir&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
ama&nbsp;by-pass&nbsp;teknigi&nbsp;ile&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
%aa&nbsp;-&amp;gt;&nbsp;%25aa&nbsp;-&amp;gt;&nbsp;modsec&nbsp;-&amp;gt;&nbsp;%25aa&nbsp;(gecerli&nbsp;URL&nbsp;encoding)&nbsp;-&amp;gt;&nbsp;%aa&nbsp;(&lt;STRONG&gt;gecerli&nbsp;&lt;/STRONG&gt;URL&nbsp;ending)&nbsp;=&nbsp;istek&nbsp;onaylanir&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
bedirhan&lt;BR&gt;<br>
&amp;nbsp;&lt;BR&gt;<br>
<br>
&lt;HR&nbsp;id=EC_stopSpelling&gt;<br>
Date:&nbsp;Mon,&nbsp;19&nbsp;May&nbsp;2008&nbsp;13:24:29&nbsp;+0100&lt;BR&gt;From:&nbsp;ferruh@mavituna.com&lt;BR&gt;To:&nbsp;owasp-turkey@lists.owasp.org&lt;BR&gt;Subject:&nbsp;[Owasp-turkey]&nbsp;DoS&nbsp;attacks&nbsp;using&nbsp;SQL&nbsp;Wildcards&lt;BR&gt;&lt;BR&gt;Herkese&nbsp;Selamlar,&lt;BR&gt;&lt;BR&gt;Bir&nbsp;sure&nbsp;once&nbsp;uzerinde&nbsp;calistigim&nbsp;yazimi&nbsp;bitirdim&nbsp;ve&nbsp;yayinlayabildim,&nbsp;burada&nbsp;da&nbsp;hem&nbsp;paylasmak&nbsp;hem&nbsp;de&nbsp;konu&nbsp;hakkinda&nbsp;fikir&nbsp;almak&nbsp;istedim.&nbsp;&lt;BR&gt;&lt;BR&gt;Ozetle&nbsp;veritabanina&nbsp;sahip&nbsp;web&nbsp;uygulamalarin&nbsp;arama&nbsp;sayfalari&nbsp;ve&nbsp;benzer&nbsp;sayfalari&nbsp;kullanarak&nbsp;DoS&nbsp;saldirilari&nbsp;yapmanin&nbsp;yeni&nbsp;bir&nbsp;yolunu&nbsp;gosteriyor.&lt;BR&gt;Kritik&nbsp;nokta&nbsp;su&nbsp;ki&nbsp;inanilmaz&nbsp;sayida&nbsp;web&nbsp;uygulamasi&nbsp;bundan&nbsp;etkileniyor,&nbsp;dolayisiyla&nbsp;gelsitiricilerin&nbsp;ozellikle&nbsp;bir&nbsp;an&nbsp;once&nbsp;buna&nbsp;karsi&nbsp;onlem&nbsp;almali&nbsp;gerekli.&lt;BR&gt;&lt;BR&gt;Ikinci&nbsp;olarak&nbsp;penetration&nbsp;test&nbsp;yapan&nbsp;arkadaslarin&nbsp;da&nbsp;bu&nbsp;saldiriyi&nbsp;test&nbsp;metodolojilerine&nbsp;eklemeleri&nbsp;yerinde&nbsp;olacaktir.&nbsp;Insallah&nbsp;uzun&nbsp;vadede&nbsp;OWASP&nbsp;Guide&nbsp;da&nbsp;bu&nbsp;konuda&nbsp;bir&nbsp;seyler&nbsp;ekleyebiliriz.&lt;BR&gt;&lt;BR&gt;Maalesef&nbsp;henuz&nbsp;Turkcesi&nbsp;yok,&nbsp;yazi&nbsp;suradan&nbsp;download&nbsp;edilebilir:&lt;BR&gt;&lt;BR&gt;&lt;A&nbsp;href=&quot;http://www.portcullis-security.com/uplds/wildcard_attacks.pdf&quot;&nbsp;target=_blank&gt;http://www.portcullis-security.com/uplds/wildcard_attacks.pdf&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;&lt;BR&gt;Iyi&nbsp;Calismalar,&lt;BR&nbsp;clear=all&gt;&lt;BR&gt;--&nbsp;&lt;BR&gt;Ferruh&nbsp;Mavituna&lt;BR&gt;&lt;A&nbsp;href=&quot;http://ferruh.mavituna.com/&quot;&nbsp;target=_blank&gt;http://ferruh.mavituna.com&lt;/A&gt;&nbsp;&lt;BR&gt;&lt;br&nbsp;/&gt;&lt;hr&nbsp;/&gt;E-mail&nbsp;for&nbsp;the&nbsp;greater&nbsp;good.&nbsp;&lt;a&nbsp;href='http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_&nbsp;GreaterGood'&nbsp;target='_new'&gt;Join&nbsp;the&nbsp;i’m&nbsp;Initiative&nbsp;from&nbsp;Microsoft.&lt;/a&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
