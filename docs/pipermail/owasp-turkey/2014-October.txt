From mehmet at mehmetince.net  Fri Oct 17 20:02:20 2014
From: mehmet at mehmetince.net (Mehmet Dursun Ince)
Date: Fri, 17 Oct 2014 23:02:20 +0300
Subject: [Owasp-turkey] =?utf-8?q?Drupageddon_=28_CVE-2014-3704_=29_ve_Key?=
	=?utf-8?q?/Value_Pair_Payloadlar=C4=B1?=
Message-ID: <CAHtv+kk0ed5Aj2pt5BLuacWR-xcgc22BxBB-kT0KHyGyJcy-6Q@mail.gmail.com>

Merhaba

Drupal 7.x versiyonunda ??kan Sql Injection zafiyetine bakt???m?zda
payload'?n array'in indisine yerle?tirildi?ini g?rmekteyiz.

Tart??maya a?mak istedi?im konu ?udur ki; otomatize ara?lara bu t?r
testlerin implemente edilmesi gerekir mi ? Benim ki?isel g?r???me g?re
Drupal case'i olduk?a nadir olan durumlardan bir tanesi. Herhangi bir
penetration testte kar??la??lmas?n?n g?? olaca??n? d???n?yorum.

?rne?in sqlmap'te injection point olarak i?aretlenmedi?i s?rece bu test
ger?ekle?tirilmiyor. Spesifik olarak sizin * (y?ld?z) ile belirtmeniz
gerekmekte.

Te?ekk?rler.

-- 
Sr. Information Security Engineer
-------------- sonraki b?l?m --------------
Bir HTML eklentisi temizlendi...
URL: <http://lists.owasp.org/pipermail/owasp-turkey/attachments/20141017/ac660138/attachment.html>

From mesut_erol_tr at hotmail.com  Sat Oct 18 06:46:29 2014
From: mesut_erol_tr at hotmail.com (mesut_erol_tr at hotmail.com)
Date: Sat, 18 Oct 2014 06:46:29 +0000
Subject: [Owasp-turkey] =?utf-8?q?CVP=3A__Drupageddon_=28_CVE-2014-3704_?=
 =?utf-8?q?=29_ve_Key/Value_Pair_Payloadlar=C4=B1?=
Message-ID: <BLU437-SMTP65FC3FC0C5BE68E732DBDFA7A90@phx.gbl>

Art?k b?l?nd?g?ne g?re bence ?zel durum olmaktan c?kan B?r ac?k?r...

B?l?s?m uzman? mesut erol
-----Orijinal Mesaj-----
Kimden: Mehmet Dursun Ince
G?ndrln.:  17.10.2014, 23:02 
Kime: OWASP-Turkey Chapter
Konu: [Owasp-turkey] Drupageddon ( CVE-2014-3704 ) ve Key/Value Pair Payloadlar?


Merhaba

Drupal 7.x versiyonunda ??kan Sql Injection zafiyetine bakt???m?zda
payload'?n array'in indisine yerle?tirildi?ini g?rmekteyiz.

Tart??maya a?mak istedi?im konu ?udur ki; otomatize ara?lara bu t?r
testlerin implemente edilmesi gerekir mi ? Benim ki?isel g?r???me g?re
Drupal case'i olduk?a nadir olan durumlardan bir tanesi. Herhangi bir
penetration testte kar??la??lmas?n?n g?? olaca??n? d???n?yorum.

?rne?in sqlmap'te injection point olarak i?aretlenmedi?i s?rece bu test
ger?ekle?tirilmiyor. Spesifik olarak sizin * (y?ld?z) ile belirtmeniz
gerekmekte.

Te?ekk?rler.

-- 
Sr. Information Security Engineer


From mesut_erol_tr at hotmail.com  Sat Oct 18 06:46:29 2014
From: mesut_erol_tr at hotmail.com (mesut_erol_tr at hotmail.com)
Date: Sat, 18 Oct 2014 06:46:29 +0000
Subject: [Owasp-turkey] =?utf-8?q?CVP=3A__Drupageddon_=28_CVE-2014-3704_?=
 =?utf-8?q?=29_ve_Key/Value_Pair_Payloadlar=C4=B1?=
Message-ID: <BLU437-SMTP52C32CEA1923F41962266CA7A90@phx.gbl>

Art?k b?l?nd?g?ne g?re bence ?zel durum olmaktan c?kan B?r ac?k?r...

B?l?s?m uzman? mesut erol
-----Orijinal Mesaj-----
Kimden: Mehmet Dursun Ince
G?ndrln.:  17.10.2014, 23:02 
Kime: OWASP-Turkey Chapter
Konu: [Owasp-turkey] Drupageddon ( CVE-2014-3704 ) ve Key/Value Pair Payloadlar?


Merhaba

Drupal 7.x versiyonunda ??kan Sql Injection zafiyetine bakt???m?zda
payload'?n array'in indisine yerle?tirildi?ini g?rmekteyiz.

Tart??maya a?mak istedi?im konu ?udur ki; otomatize ara?lara bu t?r
testlerin implemente edilmesi gerekir mi ? Benim ki?isel g?r???me g?re
Drupal case'i olduk?a nadir olan durumlardan bir tanesi. Herhangi bir
penetration testte kar??la??lmas?n?n g?? olaca??n? d???n?yorum.

?rne?in sqlmap'te injection point olarak i?aretlenmedi?i s?rece bu test
ger?ekle?tirilmiyor. Spesifik olarak sizin * (y?ld?z) ile belirtmeniz
gerekmekte.

Te?ekk?rler.

-- 
Sr. Information Security Engineer


From bedirhanurgun at gmail.com  Sun Oct 19 13:13:38 2014
From: bedirhanurgun at gmail.com (Bedirhan Urgun)
Date: Sun, 19 Oct 2014 16:13:38 +0300
Subject: [Owasp-turkey]
	=?utf-8?q?Drupageddon_=28_CVE-2014-3704_=29_ve_Key?=
	=?utf-8?q?/Value_Pair_Payloadlar=C4=B1?=
In-Reply-To: <CAHtv+kk0ed5Aj2pt5BLuacWR-xcgc22BxBB-kT0KHyGyJcy-6Q@mail.gmail.com>
References: <CAHtv+kk0ed5Aj2pt5BLuacWR-xcgc22BxBB-kT0KHyGyJcy-6Q@mail.gmail.com>
Message-ID: <CALNZ6-LqhAgx1PWO2i=9DbYogGBNjQ55Vp9ECDXRoAzrmV+tbQ@mail.gmail.com>

Gonderdigin icin tesekkurler Mehmet.

?ok orjinal. Bir araba dolusu laf edilebilir ama prepared statement
kullan?rken b?ylesi bir zaafiyet... Ancak PHP ile yap?labilirdi herhalde :)
Demin advisory'i ve patch'i inceledim. Hem statik hem de dinamik, hem
otomatik hem de manual analiz a??lar?ndan bak?ld???nda bulunmas? zor
g?z?k?yor.

Dinamik analiz ile bulunmas? i?in a?a??daki ?rnekte array ?eklinde
parametre de?eri alan web uygulamalar?n?n nadir olmas?ni bir yana biraksak,
otomatik araclarin oncelikle parametre ismini de?i?tirip b?t?n sald?r?
vekt?rlerini denemeleri laz?m. Hatta bu yetmeyecek, injection point olarak
array index'i hedef almalari gerekecekti...

<input type="text" name="blogtitle[0]" value="xyz">
<input type="text" name="blogtitle[1]" value="def">

Ayn? ?ekilde dinamik analiz yapan pentester'in de ?rnek olarak Burp'te
yakalay?p injection point koymas? yetmeyecek ??nk? itiraf edelim genelde
parametre isimlerine pek injection point koymuyoruz. Kald? ki yine burda
index'e koymak gerekecekti....

Bir de i?in statik analiz kismi var... Drupal'e (open source olmas?ndan
dolay? daha avantajl? sanirim) statik kod analizi uygulanm??t?r diye
d???n?yorum. Ama orda da data flow analizi kolay olmuyor demek ki...

Son olarak vulnerable fonksiyondan kopyalad???m a?a??daki k?sma bakt???mda
g?rd???m ?ey e?itli?in sol taraf?nda $query ve sag tarafinda string concat
islemi. Tabi bu zafiyet aciga cikmamis olsaydi ve statik analiz surecinde
dusuk seviyede bir bulgu olarak bu karsima ciksaydi detayina ne kadar inme
azmini ve zamanini bulabilirdim bilemiyorum.

$query = preg_replace('#' . $key . '\b#', implode(', ',
array_keys($new_keys)), $query);

bedirhan

17 Ekim 2014 23:02 tarihinde Mehmet Dursun Ince <mehmet at mehmetince.net>
yazd?:

> Merhaba
>
> Drupal 7.x versiyonunda ??kan Sql Injection zafiyetine bakt???m?zda
> payload'?n array'in indisine yerle?tirildi?ini g?rmekteyiz.
>
> Tart??maya a?mak istedi?im konu ?udur ki; otomatize ara?lara bu t?r
> testlerin implemente edilmesi gerekir mi ? Benim ki?isel g?r???me g?re
> Drupal case'i olduk?a nadir olan durumlardan bir tanesi. Herhangi bir
> penetration testte kar??la??lmas?n?n g?? olaca??n? d???n?yorum.
>
> ?rne?in sqlmap'te injection point olarak i?aretlenmedi?i s?rece bu test
> ger?ekle?tirilmiyor. Spesifik olarak sizin * (y?ld?z) ile belirtmeniz
> gerekmekte.
>
> Te?ekk?rler.
>
> --
> Sr. Information Security Engineer
>
> _______________________________________________
> Owasp-turkey mailing list
> Owasp-turkey at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-turkey
>
>


-- 

bedirhan urgun
-------------- sonraki b?l?m --------------
Bir HTML eklentisi temizlendi...
URL: <http://lists.owasp.org/pipermail/owasp-turkey/attachments/20141019/fa32233b/attachment.html>

