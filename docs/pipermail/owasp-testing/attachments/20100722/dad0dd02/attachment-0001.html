<tt>
Hey&nbsp;Dave,&nbsp;you&amp;#39;re&nbsp;providing&nbsp;great&nbsp;guidance,&nbsp;but&nbsp;do&nbsp;you&nbsp;have&nbsp;a&nbsp;place&nbsp;we&nbsp;can&nbsp;point&nbsp;developers&nbsp;to&nbsp;get&nbsp;UnitTests&nbsp;to&nbsp;check&nbsp;for&nbsp;the&nbsp;correct&nbsp;implementation&nbsp;of&nbsp;these?&nbsp;(these&nbsp;unit&nbsp;tests&nbsp;should&nbsp;test&nbsp;from&nbsp;the&nbsp;browser&nbsp;point&nbsp;of&nbsp;view&nbsp;and&nbsp;the&nbsp;correct&nbsp;source-code&nbsp;implementation).&lt;br&gt;<br>
&lt;br&gt;The&nbsp;developers&nbsp;would&nbsp;customize&nbsp;these&nbsp;UnitTests&nbsp;to&nbsp;their&nbsp;app,&nbsp;but&nbsp;don&amp;#39;t&nbsp;you&nbsp;think&nbsp;that&nbsp;we&nbsp;need&nbsp;to&nbsp;show&nbsp;them&nbsp;working&nbsp;examples&nbsp;of&nbsp;these&nbsp;recomendations?&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;Dinis&nbsp;Cruz&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
On&nbsp;22&nbsp;July&nbsp;2010&nbsp;08:50,&nbsp;Dave&nbsp;van&nbsp;Stein&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:dvstein@gmail.com&quot;&gt;dvstein@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&gt;Assuming&nbsp;you&nbsp;are&nbsp;talking&nbsp;about&nbsp;some&nbsp;sort&nbsp;of&nbsp;session&nbsp;token&nbsp;in&nbsp;the&nbsp;cookie&nbsp;that&nbsp;can&nbsp;be&nbsp;reused&nbsp;on&nbsp;another&nbsp;client&nbsp;some&nbsp;other&nbsp;relevant&nbsp;tips&nbsp;from&nbsp;&lt;a&nbsp;href=&quot;http://www.owasp.org/index.php/Session_Management&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.owasp.org/index.php/Session_Management&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;li&gt;All&nbsp;session&nbsp;tokens&nbsp;in&nbsp;high&nbsp;value&nbsp;applications&nbsp;SHOULD&nbsp;be&nbsp;tied&nbsp;to&nbsp;a&nbsp;specific&nbsp;HTTP&nbsp;client&nbsp;instance&nbsp;(session&nbsp;identifier&nbsp;and&nbsp;IP&nbsp;address).&nbsp;<br>
&lt;/li&gt;&lt;li&gt;Application&nbsp;servers&nbsp;SHOULD&nbsp;use&nbsp;private&nbsp;temporary&nbsp;file&nbsp;areas&nbsp;per&nbsp;client/application&nbsp;to&nbsp;store&nbsp;session&nbsp;data.&nbsp;<br>
&lt;/li&gt;&lt;li&gt;All&nbsp;applications&nbsp;SHOULD&nbsp;use&nbsp;a&nbsp;cryptographically&nbsp;secure&nbsp;page&nbsp;or&nbsp;form&nbsp;nonce&nbsp;in&nbsp;a&nbsp;hidden&nbsp;form&nbsp;field.&nbsp;<br>
&lt;/li&gt;&lt;li&gt;Each&nbsp;form&nbsp;or&nbsp;page&nbsp;nonce&nbsp;SHOULD&nbsp;be&nbsp;removed&nbsp;from&nbsp;the&nbsp;active&nbsp;list&nbsp;as&nbsp;soon&nbsp;as&nbsp;it&nbsp;is&nbsp;submitted.&nbsp;&lt;/li&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;li&gt;Session&nbsp;tokens&nbsp;should&nbsp;be&nbsp;regenerated&nbsp;prior&nbsp;to&nbsp;any&nbsp;significant&nbsp;high&nbsp;value&nbsp;transaction.&nbsp;<br>
&lt;/li&gt;&lt;li&gt;In&nbsp;high-value&nbsp;applications,&nbsp;session&nbsp;tokens&nbsp;should&nbsp;be&nbsp;regenerated&nbsp;after&nbsp;a&nbsp;certain&nbsp;number&nbsp;of&nbsp;requests.&nbsp;<br>
&lt;/li&gt;&lt;li&gt;In&nbsp;high-value&nbsp;applications,&nbsp;session&nbsp;tokens&nbsp;should&nbsp;be&nbsp;regenerated&nbsp;after&nbsp;a&nbsp;certain&nbsp;period&nbsp;of&nbsp;time.&nbsp;&lt;/li&gt;&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;In&nbsp;general&nbsp;you&nbsp;can&nbsp;say&nbsp;the&nbsp;less&nbsp;predictable&nbsp;a&nbsp;session&nbsp;token&nbsp;is,&nbsp;the&nbsp;more&nbsp;secure&nbsp;it&nbsp;is.&lt;/div&gt;<br>
&lt;div&gt;So&nbsp;to&nbsp;make&nbsp;your&nbsp;appplication&nbsp;as&nbsp;secure&nbsp;as&nbsp;possible:&lt;/div&gt;<br>
&lt;div&gt;-&nbsp;make&nbsp;it&nbsp;difficult&nbsp;to&nbsp;predict&lt;/div&gt;<br>
&lt;div&gt;-&nbsp;link&nbsp;it&nbsp;to&nbsp;the&nbsp;client&nbsp;with&nbsp;an&nbsp;difficult&nbsp;to&nbsp;predict&nbsp;property&lt;/div&gt;<br>
&lt;div&gt;-&nbsp;reuse each&nbsp;token as&nbsp;little&nbsp;as&nbsp;possible&nbsp;and&nbsp;regenerate&nbsp;as&nbsp;often&nbsp;as&nbsp;possible&lt;/div&gt;<br>
&lt;div&gt;-&nbsp;make&nbsp;use&nbsp;of&nbsp;a&nbsp;second&nbsp;(unpredictable)&nbsp;token&nbsp;and&nbsp;validate&nbsp;and&nbsp;reissue&nbsp;that&nbsp;for&nbsp;every&nbsp;request&nbsp;(also&nbsp;helps&nbsp;against&nbsp;CSRF)&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;regards,&nbsp;Dave&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt; &lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2010/7/22&nbsp;Nam&nbsp;T.&nbsp;Nguyen&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:namn@bluemoon.com.vn&quot;&nbsp;target=&quot;_blank&quot;&gt;namn@bluemoon.com.vn&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;A&nbsp;few&nbsp;ways:&lt;br&gt;&lt;br&gt;1.&nbsp;Embed&nbsp;some&nbsp;specific&nbsp;information&nbsp;such&nbsp;as&nbsp;REMOTE_ADDRESS&nbsp;into&nbsp;the&nbsp;cookie.&lt;br&gt;<br>
&lt;br&gt;2.&nbsp;It&nbsp;is&nbsp;unclear&nbsp;whether&nbsp;the&nbsp;cookie&nbsp;stores&nbsp;username/password.&nbsp;If&nbsp;it&nbsp;does,&nbsp;DON&amp;#39;T.&lt;br&gt;<br>
&lt;br&gt;3.&nbsp;Give&nbsp;the&nbsp;cookie&nbsp;a&nbsp;shorter&nbsp;time&nbsp;out.&lt;br&gt;&lt;br&gt;Well,&nbsp;these&nbsp;don&amp;#39;t&nbsp;complete&nbsp;solve&nbsp;the&nbsp;problem.&nbsp;But&nbsp;they&nbsp;will&nbsp;help&nbsp;limit&nbsp;the&nbsp;possibilities.&lt;br&gt;&lt;br&gt;Besides,&nbsp;if&nbsp;one&nbsp;can&nbsp;obtain&nbsp;a&nbsp;cookie,&nbsp;he&nbsp;pretty&nbsp;much&nbsp;can&nbsp;do&nbsp;anything&nbsp;else.&nbsp;That&amp;#39;s&nbsp;how&nbsp;CSS&nbsp;and&nbsp;CSRF&nbsp;works,&nbsp;isn&amp;#39;t&nbsp;it?&nbsp;In&nbsp;your&nbsp;case,&nbsp;this&nbsp;requires&nbsp;access&nbsp;to&nbsp;that&nbsp;particular&nbsp;machine&nbsp;(to&nbsp;__copy&nbsp;the&nbsp;cookies__).&nbsp;You&nbsp;have&nbsp;a&nbsp;bigger&nbsp;problem&nbsp;to&nbsp;worry&nbsp;about&nbsp;then.&lt;br&gt;<br>
<br>
&lt;br&gt;Cheers&lt;br&gt;Nam&lt;br&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;On&nbsp;Jul&nbsp;22,&nbsp;2010,&nbsp;at&nbsp;10:03&nbsp;AM,&nbsp;Zaki&nbsp;Akhmad&nbsp;wrote:&lt;br&gt;&lt;br&gt;&amp;gt;&nbsp;Hello,&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;I&nbsp;found&nbsp;the&nbsp;web&nbsp;application&nbsp;that&nbsp;I&nbsp;test&nbsp;is&nbsp;vulnerable&nbsp;with&nbsp;its&lt;br&gt;&amp;gt;&nbsp;cookies.&nbsp;After&nbsp;I&nbsp;successfully&nbsp;login&nbsp;with&nbsp;userid&nbsp;and&nbsp;password&nbsp;provided,&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;I&nbsp;can&nbsp;copy&nbsp;the&nbsp;cookies&nbsp;to&nbsp;another&nbsp;browser/computer&nbsp;so&nbsp;that&nbsp;he/she&nbsp;can&lt;br&gt;&amp;gt;&nbsp;enter&nbsp;the&nbsp;web&nbsp;application&nbsp;without&nbsp;login.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;How&nbsp;do&nbsp;I&nbsp;fix&nbsp;this&nbsp;vulnerability?&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Thanks!&lt;br&gt;&amp;gt;&nbsp;--&lt;br&gt;&amp;gt;&nbsp;Zaki&nbsp;Akhmad&lt;br&gt;<br>
<br>
&amp;gt;&nbsp;_______________________________________________&lt;br&gt;&amp;gt;&nbsp;Owasp-testing&nbsp;mailing&nbsp;list&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Owasp-testing@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-testing@lists.owasp.org&lt;/a&gt;&lt;br&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-testing&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-testing&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;/div&gt;Nam&nbsp;Nguyen,&nbsp;CISA,&nbsp;CISSP,&nbsp;CSSLP&lt;br&gt;Blue&nbsp;Moon&nbsp;Consulting&nbsp;Co.,&nbsp;Ltd.&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.bluemoon.com.vn/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.bluemoon.com.vn&lt;/a&gt;&lt;br&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;_______________________________________________&lt;br&gt;Owasp-testing&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Owasp-testing@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-testing@lists.owasp.org&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-testing&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-testing&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Owasp-testing&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-testing@lists.owasp.org&quot;&gt;Owasp-testing@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-testing&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-testing&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
