<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-testing] [Owasp-codereview] [Owasp-ireland] Potential of	4.2 million credit card details stolen via cyber attack.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOwasp-testing%5D%20%5BOwasp-codereview%5D%20%5BOwasp-ireland%5D%20Potential%20of%0A%094.2%20million%20credit%20card%20details%20stolen%20via%20cyber%20attack.&In-Reply-To=47E8E1F9.9010005%40realexpayments.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001451.html">
   <LINK REL="Next"  HREF="001453.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-testing] [Owasp-codereview] [Owasp-ireland] Potential of	4.2 million credit card details stolen via cyber attack.</H1>
    <B>Andrew van der Stock</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOwasp-testing%5D%20%5BOwasp-codereview%5D%20%5BOwasp-ireland%5D%20Potential%20of%0A%094.2%20million%20credit%20card%20details%20stolen%20via%20cyber%20attack.&In-Reply-To=47E8E1F9.9010005%40realexpayments.com"
       TITLE="[Owasp-testing] [Owasp-codereview] [Owasp-ireland] Potential of	4.2 million credit card details stolen via cyber attack.">vanderaj at owasp.org
       </A><BR>
    <I>Tue Mar 25 12:03:57 EDT 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="001451.html">[Owasp-testing] Potential of 4.2 million credit card details stolen	via cyber attack.
</A></li>
        <LI>Next message: <A HREF="001453.html">[Owasp-testing] [Owasp-codereview] [Owasp-ireland] Potential of	4.2 million credit card details stolen via cyber attack.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1452">[ date ]</a>
              <a href="thread.html#1452">[ thread ]</a>
              <a href="subject.html#1452">[ subject ]</a>
              <a href="author.html#1452">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I really doubt that Hannaford was PCI DSS compliant:

* Requirement 3 - Protect Card Holder Data. Losing 4.2 million records  
requires failing Section 3.1 &quot;Keep cardholder data to a  
minimum&quot; (basically ditch the PAN and expiry as soon as you're done  
with them), and Section 3.4 &quot;Render PAN, unreadable anywhere where it  
is stored&quot;. FAIL.

* Requirement 6 - Section 6.1, keeping up with patches. I don't know  
of any site that meets PCI's 1 month deadline to install new patches  
for critical components. It would be surprising to me if Hannaford did  
this. Possible fail.

* Section 6.5 - do a Top 10 review. This is the old Top 10 2004. 6.5.8  
is &quot;Insecure storage&quot; - enough said! FAIL

* Requirement 10 - Monitor and Test Networks and Requirement 11  
Regularly Test security systems and processes. In particular section  
10.6:

&quot;Review logs for all system components at least daily. Log reviews  
must include those servers that perform security functions like  
intrusion detection system (IDS) and authentication, authorization,  
and accounting protocol (AAA) servers (for example, RADIUS).&quot;

and 11.3.2 - conduct annual application layer pen tests
and 11.4 and 11.5 which says to install network and host IDS and  
network IPS and file integrity monitoring software. These should have  
immediately notified admin staff of changes.

Hannaford didn't detect the breach for nearly three months. That  
implies a lack of effective intrusion detection and monitoring EVEN if  
they had the above items in place, operational, and logging  
successfully, and someone is monitoring them. Which I highly doubt.  
FAIL.

Arguable:

* Section 6.6 - mandates a code review or a web application firewall,  
but only AFTER JUNE 30. They can be compliant up to now with neither  
of these in place. We know that WAFs today are simply not enough to  
prevent attacks from a motivated, skilled attacker. They are great  
defense in depth and they do knock out script kiddie attacks. If  
Hannaford obtained a code review, then the assessor wasn't  
particularly good, or the firm refused to fix known issues, or both. I  
think this is the area we will see the lawyers involved with if it can  
be argued that 6.6 is REQUIRED to be complied with today. I don't  
believe so.

In my personal opinion, even given the limited information that is  
public, from the first two issues above alone, we can assume Hannaford  
were/are non-compliant.

PCI DSS makes it abundantly clear what folks must do to be safer:

Step 1.  Don't store CC numbers. Really, really, really don't store  
them. You don't need them.
Steps 2..153 However, if you want to damage your business reputation,  
destroy customer confidence, lose shareholder value, set a bunch of  
money on fire by protecting information you don't need (and shouldn't  
want), then here goes... do this wishy-washy list of items. But do it  
properly, or you'll get pwned.

Hannaford ignored #1 and got pwned even though they did *some* of the  
next 153 steps required for PCI DSS. In PCI DSS 1.2, they really  
should make it real short and sweet:

There are no valid business reasons for storing CC's. If you do, you  
fail PCI DSS compliance. This is how you use authorization numbers for  
these common business cases:

That's a one pager in my view.

thanks,
Andrew van der Stock
Lead Author, OWASP Guide and OWASP Top 10




</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001451.html">[Owasp-testing] Potential of 4.2 million credit card details stolen	via cyber attack.
</A></li>
	<LI>Next message: <A HREF="001453.html">[Owasp-testing] [Owasp-codereview] [Owasp-ireland] Potential of	4.2 million credit card details stolen via cyber attack.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1452">[ date ]</a>
              <a href="thread.html#1452">[ thread ]</a>
              <a href="subject.html#1452">[ subject ]</a>
              <a href="author.html#1452">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
