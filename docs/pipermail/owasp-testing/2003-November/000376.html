<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-TESTING] Checking in
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOWASP-TESTING%5D%20Checking%20in&In-Reply-To=E1AO04w-0000S3-00%40smtp02.mrf.mail.rcn.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000371.html">
   <LINK REL="Next"  HREF="000368.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-TESTING] Checking in</H1>
    <B>Javier Fernandez-Sanguino</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOWASP-TESTING%5D%20Checking%20in&In-Reply-To=E1AO04w-0000S3-00%40smtp02.mrf.mail.rcn.net"
       TITLE="[OWASP-TESTING] Checking in">jfernandez at germinus.com
       </A><BR>
    <I>Thu Nov 27 04:22:50 EST 2003</I>
    <P><UL>
        <LI>Previous message: <A HREF="000371.html">[OWASP-TESTING] Checking in
</A></li>
        <LI>Next message: <A HREF="000368.html">[OWASP-TESTING] Sections Posted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#376">[ date ]</a>
              <a href="thread.html#376">[ thread ]</a>
              <a href="subject.html#376">[ subject ]</a>
              <a href="author.html#376">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If you don't mind, I'll make some comments on your comments.

Mark Curphey wrote:

  &gt; Default Files
&gt;<i> 
</I>&gt;<i> 1. In the description I think it may be worth accentuating the fact that
</I>&gt;<i> there is only a security issue in default files when they have security
</I>&gt;<i> vulns. One of my pet peeves are consultants reports listing default files
</I>&gt;<i> like documentation etc where there is no security issues at all. It's a
</I>&gt;<i> housekeeping issue (I guess) but not a security one in my opinion.
</I>
Default files like documentation do disclose internal information, that 
is a low risk security issue, but a security issue after all. It's just 
like banner grabbing, it's not a direct attack, but it might disclose 
more information than you want to. I would move the documentation files 
item to the end of the list, but would keep it there.

Notice that there is another item missing in the list which I'm not 
really sure how to describe. It's related to the way Lotus Domino 
handles the webserver. In Domino, the webserver might have default 
_databases_ enabled which might disclose sensible information but are 
not really documentation 'per se'.

I developed a plugin for Nessus (quite some time ago) to check these 
database, so maybe the code speaks for itself:
<A HREF="http://cgi.nessus.org/plugins/dump.php3?id=10629">http://cgi.nessus.org/plugins/dump.php3?id=10629</A>

&gt;<i> 2. In the &quot;how to test&quot; description I think it would be worth-while
</I>&gt;<i> explaining that you are looking for the instance of the file. To do that you
</I>&gt;<i> need to see an HTTP 200 or equivalent server response and this is
</I>&gt;<i> essentially what tools like Nikto etc do. Maybe a http trace type sequence
</I>&gt;<i> might be a good visual example....That leads neatly onto ...
</I>&gt;<i> 
</I>&gt;<i> 3. IMHO tools like Nikto and Nessus are really bad at finding default files.
</I>&gt;<i> That is because they can't tell the difference between an HTTP 404 (or 400
</I>&gt;<i> series server response) from a HTTP 200 carrying an HTML 404. As an example
</I>&gt;<i> fire one of them off against OWASP.org and you'll find we have all the IIS
</I>&gt;<i> files under the sun (on a Unix box!). The commercial scanners have solved
</I>&gt;<i> this by allowing users to define a 404.
</I>
Nessus has a specific plugin (no404.nasl, see 
<A HREF="http://cgi.nessus.org/plugins/dump.php3?id=10386">http://cgi.nessus.org/plugins/dump.php3?id=10386</A>) which tries to avoid 
this by making some controled tests and determining how the server 
answers to non-existance files. From my experience it does determine 
issues better than some commercial scanners. It, however, does not make 
any assumption based on other results on whether those pages should be 
there or not (it does not say &quot;Oh, this is Apache, I will not check X 
and Y&quot;) since is that fundamentally flawed (there might be a reverse 
proxy in the middle, the banners might have been changed, etc..)

Nikto/Whisker do not attempt to do this at all. They are really more CGI 
scanners than vulnerability assesment scanners. So they do usually turn 
a lot of false positivies.

&gt;<i> 4. I am not sure white box and black box are good terms for this on
</I>&gt;<i> reflection.
</I>
I think there is a difference. The 'white box' should describe that the 
auditor should be analysing the configuration of the web server (ie. 
apache's http.conf) and the file system structure directly. Whileas the 
black box is trying to (remotely) assess with a tool or manually whether 
these files exist.

&gt;<i> 5. How about tools like IIS lockdown that look for and remove sample files ?
</I>&gt;<i> Is there an Apache equiv anyone knows about.
</I>
There is a lot of documentation, which maybe should be added to the 
references for either the document as a whole or for the references 
which are specific to vendor's implementations (such as this one)

Lotus White Paper: A Guide to Developing Secure Domino Applications' 
(december 1999)
'Apache Security Configuration Document' from Intersect Alliance, 
<A HREF="http://www.intersectalliance.com/projects/ApacheConfig/">http://www.intersectalliance.com/projects/ApacheConfig/</A>
'NTERNET INFORMATION SERVER 4.0 SECURITY Graded Security Configuration 
Document' also from from Intersect Alliance,
<A HREF="http://www.intersectalliance.com/projects/IIS4Config/index.html">http://www.intersectalliance.com/projects/IIS4Config/index.html</A>

NSA guides (available at <A HREF="http://nsa1.www.conxion.com/support/download.htm">http://nsa1.www.conxion.com/support/download.htm</A>):
Guide to the Secure Configuration and Administration of iPlanet Web 
Server, Enterprise Edition 4.1
Guide to the Secure Configuration and Administration of Microsoft 
Internet Information Server 4.0
Guide to the Secure Configuration and Administration of Microsoft 
Internet Information Server 4.0 (Checklist Format)
Secure Configuration of the Apache Web Server, Apache Server Version 
1.3.3 on Red Hat Linux 5.1

&gt;<i> 
</I>&gt;<i> Unreferenced Files
</I>
Just to add an example of a different webserver (not Apache nor IIS) it 
would be nice to add to the 'Information obtained through server 
vulnerabilities and misconfiguration' the following sample:

- Domino browsing through the ?open directive
(<A HREF="http://cgi.nessus.org/plugins/dump.php3?id=10057">http://cgi.nessus.org/plugins/dump.php3?id=10057</A>)

Also, in 'Use of publicly available information' I would include 
archive.org:

- Finally, the Internet Archive (www.archive.org) keeps images of sites 
in different epochs that are publicly accesible through their &quot;Wayback 
Machine&quot; . Older versions of sites can include references to content 
that is still available in the site but not linked from current pages, 
it can also give hints to older website structures and directories which 
might be still available.

&gt;<i> 
</I>&gt;<i> 1. This write up focuses solely on pen testing. How about comparing the
</I>&gt;<i> deployed content to the CMS or app deployment tool? This is typically what
</I>&gt;<i> happens in enterprises in my experience. Maybe we should say that this is
</I>&gt;<i> really a pen testing technique only ?
</I>
I don't think so. It should be trivial in some servers to assess from a 
&quot;white box&quot; point of view, the website structure (as perceived by, for 
example, a web robot that follows the URLs) vs. the filesystem 
structure. Any file which is not linked to, but resides in the 
filesystem would be an unreferenced file. This is more difficult to do 
in servers with dynamic content, however, but he can use real website 
logs to determine which files/applications are being accessed and which 
files are just &quot;sitting there&quot;.

In the &quot;white box&quot; testing, the auditor can determine with more accuracy 
if the page is really unreferenced or not. For example, he can also make 
use of the filesystem timestamps: he can search for files that have not 
been accessed for a year, if he knows that the system was updated in 
date X he can try to look for files that were created before that date, 
etc. I would consider adding this into the &quot;white box&quot; part.

&gt;<i> 2. Under blind guessing might be worth mentioning the HTTP / HTML 404 again.
</I>&gt;<i> Great stuff though!
</I>
I agree. It's very good stuff!

&gt;<i> 4. Might be worth showing an example of making an HTTP call to list the
</I>&gt;<i> directory contents where no default page for that dir has been specified ?
</I>
I agree. That's a very common vector to retrieve this kind of information.

Regards

Javi




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000371.html">[OWASP-TESTING] Checking in
</A></li>
	<LI>Next message: <A HREF="000368.html">[OWASP-TESTING] Sections Posted
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#376">[ date ]</a>
              <a href="thread.html#376">[ thread ]</a>
              <a href="subject.html#376">[ subject ]</a>
              <a href="author.html#376">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
