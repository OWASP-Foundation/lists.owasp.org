<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-testing] Testing for logout functionality (OTG-SESS-006)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-testing%5D%20Testing%20for%20logout%20functionality%20%28OTG-SESS-006%29&In-Reply-To=%3C566EE4B7.6040500%4031337.it%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002432.html">
   <LINK REL="Next"  HREF="002434.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-testing] Testing for logout functionality (OTG-SESS-006)</H1>
    <B>Simon</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-testing%5D%20Testing%20for%20logout%20functionality%20%28OTG-SESS-006%29&In-Reply-To=%3C566EE4B7.6040500%4031337.it%3E"
       TITLE="[Owasp-testing] Testing for logout functionality (OTG-SESS-006)">owasp at 31337.it
       </A><BR>
    <I>Mon Dec 14 15:48:07 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002432.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
        <LI>Next message: <A HREF="002434.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2433">[ date ]</a>
              <a href="thread.html#2433">[ thread ]</a>
              <a href="subject.html#2433">[ subject ]</a>
              <a href="author.html#2433">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christer,

On 14.12.2015 16:20, Christer wrote:
&gt;<i> The things you&#8217;ve listed are all valid improvements on the threat
</I>&gt;<i> vector(s). However, I would recommend to treat them as mitigations to
</I>&gt;<i> reduce the risks and not as guarantees to remove the attack vector(s).
</I>
well, I don't really see it as an attack vector, if you are not able to
steal the cookie.
Like OTG-INFO-010, being able to map the application architecture is not
a bug. If I know you use rails that's not a problem in and for itself:
it becomes a problem if the version of rails you are running has bugs
that can be exploited.
I see OTG-SESS-006 the same: IF (and only if) I can steal your cookie,
you have a problem.

&gt;<i> Did you by any chance use something like OWASP Cornucopia to show the
</I>&gt;<i> need for the safeguards you&#8217;ve listed?
</I>
No, I did not know about its existence until now. I'll have a look on it
later.

&gt;<i> I&#8217;ve worked on websites that persist the sessions in cookies, rather
</I>&gt;<i> than server-side, and this should always be treated as something that
</I>&gt;<i> comes with risks that need to be assessed and accepted/rejected. Attack
</I>&gt;<i> vectors/vulnerabilities should be treated separately from the acceptance
</I>&gt;<i> of the risks they entail. So, a company might assess the risks as
</I>&gt;<i> &#8220;acceptable&quot; and continue with solutions that don&#8217;t provide a
</I>&gt;<i> &#8220;server-side session termination&#8221;. However, having it in the testing
</I>&gt;<i> guidelines is valid since it requires the company to make a conscious
</I>&gt;<i> decision about the risk rather than not know about the vulnerability.
</I>
I agree. I would word it like this in OTG-SESS-006 to make this clear.
Using cookies only for the session is not a vulnerability in itself. It
becomes a problem if an attacker is able to steal the session cookie
(and if that becomes the case, there will be a lot of other problems in
the app as well).


I propose the following addition:
&quot;Some web application frameworks rely solely on the session cookie to
identify the logged-on user. The user's ID is embedded in the
(encrypted) cookie value. The application server does not do any
tracking on the server-side of the session. When logging out, the
session cookie is removed from the browser. However, since the
application does not do any tracking, it does not know whether a session
is logged out or not. So by reusing a session cookie it is possible to
gain access to the authenticated session. A well-known example of this
is the Forms Authentication functionality in ASP.NET.&quot;
---[snip snip]---
If this is the case, it becomes really important that the cookie is
protected against theft, and should therefore be
- transmitted over https only
- marked as httpOnly
- marked as secure
---[snip snip]---


I see the part about &quot;Testing for server-side session termination&quot; as
problematic too: &quot;If the log out function causes session cookies to be
set to a new value, restore the old value of the session cookies and
reload a page from the authenticated area of the application.&quot;
How is an attacker supposed to know the &quot;old values&quot;? If that is the
case, he could have used them prior to the &quot;real&quot; user logging out
anyway, so it user is compromised in any case if an attacker knows the
value of the session cookie.

So the real vulnerability would be the disclosure of the session cookie
- not the use of a cookie session store.

I think this should be made clear.


Regards,
Simon

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002432.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
	<LI>Next message: <A HREF="002434.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2433">[ date ]</a>
              <a href="thread.html#2433">[ thread ]</a>
              <a href="subject.html#2433">[ subject ]</a>
              <a href="author.html#2433">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
