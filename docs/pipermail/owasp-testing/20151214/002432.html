<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-testing] Testing for logout functionality (OTG-SESS-006)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-testing%5D%20Testing%20for%20logout%20functionality%20%28OTG-SESS-006%29&In-Reply-To=%3CE0B771EE-1968-4679-8CA9-AD970CE3E8D0%40swedakonsult.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002431.html">
   <LINK REL="Next"  HREF="002433.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-testing] Testing for logout functionality (OTG-SESS-006)</H1>
    <B>Christer</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-testing%5D%20Testing%20for%20logout%20functionality%20%28OTG-SESS-006%29&In-Reply-To=%3CE0B771EE-1968-4679-8CA9-AD970CE3E8D0%40swedakonsult.com%3E"
       TITLE="[Owasp-testing] Testing for logout functionality (OTG-SESS-006)">christer at swedakonsult.com
       </A><BR>
    <I>Mon Dec 14 15:20:09 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="002431.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
        <LI>Next message: <A HREF="002433.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2432">[ date ]</a>
              <a href="thread.html#2432">[ thread ]</a>
              <a href="subject.html#2432">[ subject ]</a>
              <a href="author.html#2432">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Dec 14, 2015, at 03:40, Simon &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">owasp at 31337.it</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">owasp at 31337.it</A>&gt;&gt; wrote:
&gt;<i> 
</I>&gt;<i> On  2014-09-16 10:46:01, Lode Vanstechelman wrote:
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I'm not sure if it can still be added to the TestingGuide v4, but I have
</I>&gt;&gt;<i> added a paragraph to the &quot;Testing for logout functionality (OTG-SESS-006)&quot;
</I>&gt;&gt;<i> page.
</I>&gt;&gt;<i> I find it important since the weakness described on this wiki page is
</I>&gt;&gt;<i> present in all ASP.NET &lt;<A HREF="http://asp.net/">http://asp.net/</A>&gt; versions when using Form Authentication, what is
</I>&gt;&gt;<i> commonly used in web applications.
</I>&gt;&gt;<i> Therefore I think it would be good if it could still be added to v4.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> For those interested: the weakness in ASP.NET &lt;<A HREF="http://asp.net/">http://asp.net/</A>&gt; is standard textbook: on
</I>&gt;&gt;<i> logout, the cookie in the browser is removed, but the cookie value can be
</I>&gt;&gt;<i> reused to gain access to the authenticated session. See links [1] and [2]
</I>&gt;&gt;<i> below.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Kind regards,
</I>&gt;&gt;<i> Lode
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> [1] &quot;The FormsAuthentication.SignOut method does not prevent cookie reply
</I>&gt;&gt;<i> attacks in ASP.NET &lt;<A HREF="http://asp.net/">http://asp.net/</A>&gt; applications&quot; -
</I>&gt;&gt;<i> <A HREF="http://support.microsoft.com/default.aspx?scid=kb;en-us;900111">http://support.microsoft.com/default.aspx?scid=kb;en-us;900111</A> &lt;<A HREF="http://support.microsoft.com/default.aspx?scid=kb;en-us;900111">http://support.microsoft.com/default.aspx?scid=kb;en-us;900111</A>&gt;
</I>&gt;&gt;<i> [2] &quot;Cookie replay attacks in ASP.NET when using forms authentication&quot; -
</I>&gt;&gt;<i> <A HREF="http://goo.gl/b0Le1">http://goo.gl/b0Le1</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hello Lode and testing ML,
</I>&gt;<i> 
</I>&gt;<i> The cookie replay attack described here is only possible if an attacker
</I>&gt;<i> gets a hold of the cookie in first place, which is not possible if
</I>&gt;<i> - the cookie is transmitted over TLS
</I>&gt;<i> - the cookie is marked as secure
</I>&gt;<i> - the cookie is httpOnly
</I>&gt;<i> 
</I>&gt;<i> Keeping this paragraph worded like this in the testing guide makes every
</I>&gt;<i> web application that uses only cookies as a session store &quot;insecure&quot;,
</I>&gt;<i> even when there are no vulnerabilities that would allow a theft of the
</I>&gt;<i> cookie. Using cookie-only session stores allows web application
</I>&gt;<i> developers to write highly scalable apps, and should in my opinion not
</I>&gt;<i> be ruled as insecure when they really are not.
</I>&gt;<i> 
</I>&gt;<i> I would propose to specify this at the end of this paragraph, or to
</I>&gt;<i> remove it entirely.
</I>&gt;<i> 
</I>&gt;<i> I would also propose to remove the paragraph &quot;Testing for server-side
</I>&gt;<i> session termination&quot;
</I>&gt;<i> If there is no session on the server side, it can not be terminated.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [1]<A HREF="https://www.owasp.org/index.php?title=Testing_for_logout_functionality_%28OTG-SESS-006%29&amp;diff=182424&amp;oldid=180243">https://www.owasp.org/index.php?title=Testing_for_logout_functionality_%28OTG-SESS-006%29&amp;diff=182424&amp;oldid=180243</A> &lt;<A HREF="https://www.owasp.org/index.php?title=Testing_for_logout_functionality_%28OTG-SESS-006%29&amp;diff=182424&amp;oldid=180243">https://www.owasp.org/index.php?title=Testing_for_logout_functionality_%28OTG-SESS-006%29&amp;diff=182424&amp;oldid=180243</A>&gt;
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-testing mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">Owasp-testing at lists.owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">Owasp-testing at lists.owasp.org</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">https://lists.owasp.org/mailman/listinfo/owasp-testing</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">https://lists.owasp.org/mailman/listinfo/owasp-testing</A>&gt;
</I>
Simon,

The things you&#8217;ve listed are all valid improvements on the threat vector(s). However, I would recommend to treat them as mitigations to reduce the risks and not as guarantees to remove the attack vector(s). Did you by any chance use something like OWASP Cornucopia to show the need for the safeguards you&#8217;ve listed?

I&#8217;ve worked on websites that persist the sessions in cookies, rather than server-side, and this should always be treated as something that comes with risks that need to be assessed and accepted/rejected. Attack vectors/vulnerabilities should be treated separately from the acceptance of the risks they entail. So, a company might assess the risks as &#8220;acceptable&quot; and continue with solutions that don&#8217;t provide a &#8220;server-side session termination&#8221;. However, having it in the testing guidelines is valid since it requires the company to make a conscious decision about the risk rather than not know about the vulnerability.

It can be dangerous (depending on your security requirements) to rely too heavily on TLS since there&#8217;s no clear understanding of how often it fails and there have been several zero-day vulnerabilities over the last couple of years.

Hope that all makes some sense.

Regards,

Christer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-testing/attachments/20151214/30ff20ab/attachment.html">http://lists.owasp.org/pipermail/owasp-testing/attachments/20151214/30ff20ab/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: smime.p7s
Type: application/pkcs7-signature
Size: 2422 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-testing/attachments/20151214/30ff20ab/attachment.bin">http://lists.owasp.org/pipermail/owasp-testing/attachments/20151214/30ff20ab/attachment.bin</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002431.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
	<LI>Next message: <A HREF="002433.html">[Owasp-testing] Testing for logout functionality (OTG-SESS-006)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2432">[ date ]</a>
              <a href="thread.html#2432">[ thread ]</a>
              <a href="subject.html#2432">[ subject ]</a>
              <a href="author.html#2432">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
