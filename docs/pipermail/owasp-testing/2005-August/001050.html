<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-TESTING] OWASP WAPT submission
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOWASP-TESTING%5D%20OWASP%20WAPT%20submission&In-Reply-To=9f9539350508081354590e1e81%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001048.html">
   <LINK REL="Next"  HREF="001052.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-TESTING] OWASP WAPT submission</H1>
    <B>Javier Fernandez-Sanguino</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOWASP-TESTING%5D%20OWASP%20WAPT%20submission&In-Reply-To=9f9539350508081354590e1e81%40mail.gmail.com"
       TITLE="[OWASP-TESTING] OWASP WAPT submission">jfernandez at germinus.com
       </A><BR>
    <I>Thu Aug 11 06:59:30 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001048.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
        <LI>Next message: <A HREF="001052.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1050">[ date ]</a>
              <a href="thread.html#1050">[ thread ]</a>
              <a href="subject.html#1050">[ subject ]</a>
              <a href="author.html#1050">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mauro Bregolin wrote:

&gt;<i> Daniel and all,
</I>&gt;<i> 
</I>&gt;<i> please find attached my submission.
</I>&gt;<i> Feel free to review it and send comments, particularly if you have 
</I>&gt;<i> relevant information regarding bibliographic references not mentioned in 
</I>&gt;<i> the text
</I>
With respect to the &quot;Old, backup and unrefereced (sic) files&quot;  I want 
to point out (again) that Dafydd Stuttard wrote an excellent text on 
this matter that could be reused, please check the CVS or the file 
attached.

As for the text here's some personal recommendations for improvement:

Unreferenced application files are not only dangerous because they 
provide you with internal source code but because they might be 
vulnerable! Imagine the case of a web administrator taking a file that 
has an SQL injection, making a backup copy of it, editing it to remove 
the SQL injection present and leaving. If he forgets to remove the 
backup file _And_ the backup file's extension will be executed by the 
webserver (think: original: login.jsp, backup: login.old.jsp) then you 
might think you are safe when you are actually just as vulnerable as 
before (just that people don't know that the file exists).

You also fail to mention files that do not belong in the web server 
but are typically generated by upload tools (think WS_FTP.log files). 
These files are &quot;unreferenced&quot; in the sense that they should not be 
there, and contain sensitive information (like the user that ftp's in 
the web server) that might be valuable to the user.

Finally, many people are unaware or dimiss the problems with these 
files because they think that the default index.html pages prevents 
all of them from being seen (security through obscurity), they say 
&quot;why care? only an internal user with knowledge can know about them?&quot; 
and then the next web server security bugs comes around and makes all 
the directories browsable because a module fails to load the default 
index .{asp,html} page when fed malicious input, or the web server is 
not properly configured and serves directory listings (the &quot;I expected 
everyone to go through the redirection that sends you to 
&quot;/login/login.asp&quot;, I thought nobody could access &quot;/login/&quot; directly 
and get a listing of the directory there!)


Some White box strategies for detecting files (which I believe are 
easier to implement and will produces less FP than the scripted 
methods you suggest)

- Look for files who have not been accessed in a long time, they might 
be backup or unreferenced file. Rationale: If this is a web server, 
most of the files will have their &quot;last access&quot; timestamp modified 
everytime the web server reads them in to provide them to an end-user 
or run them through an application engine. If a file has not been 
accessed in, say, a year. It should be analysed. Of course, you need 
to be using a filesystem that stores access times (most modern 
filesystem will do)

- Correlate logs of the web server with actual files. Rationale: you 
can go through the web server access logs and retrieve the list of 
files requested by clients and then compare that with the actual files 
in the server. Those files that are _not_ on web server logs (if logs 
go back sufficient time) are potential unreferenced files

In Black Box testing you are missing some useful inputs sources:

- Archive.org, better than google since it will _not_ timeout the 
pages after time so you can actually see the old files that were in 
the web server 3 years ago.

- robots.txt files. Some people believe they can &quot;hide&quot; files from 
there using that file, they don't think that the robots.txt file is 
only honored by, yes, robots.

- HTML comments. Either of active content (think server side includes 
which have been disabled) or forms that have changed their action and 
maintain (in a comment) the previous action CGI used.

I would suggest you add these, as well as review the attached text 
(the one I mentioned before) and merge many of its suggestions and 
comments in your text.

Regards

Javier
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.owasp.org/pipermail/owasp-testing/attachments/20050811/3d237fab/attachment.html">http://lists.owasp.org/pipermail/owasp-testing/attachments/20050811/3d237fab/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001048.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
	<LI>Next message: <A HREF="001052.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1050">[ date ]</a>
              <a href="thread.html#1050">[ thread ]</a>
              <a href="subject.html#1050">[ subject ]</a>
              <a href="author.html#1050">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
