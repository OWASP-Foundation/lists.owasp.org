<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-TESTING] OWASP WAPT submission
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOWASP-TESTING%5D%20OWASP%20WAPT%20submission&In-Reply-To=42FB2F92.8090001%40germinus.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001050.html">
   <LINK REL="Next"  HREF="001049.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-TESTING] OWASP WAPT submission</H1>
    <B>Roelof Temmingh</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOWASP-TESTING%5D%20OWASP%20WAPT%20submission&In-Reply-To=42FB2F92.8090001%40germinus.com"
       TITLE="[OWASP-TESTING] OWASP WAPT submission">roelof at sensepost.com
       </A><BR>
    <I>Thu Aug 11 08:22:03 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="001050.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
        <LI>Next message: <A HREF="001049.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1052">[ date ]</a>
              <a href="thread.html#1052">[ thread ]</a>
              <a href="subject.html#1052">[ subject ]</a>
              <a href="author.html#1052">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>In terms of unlinked files...just a quick comment - the BackEnd miner
inside of Wikto (<A HREF="http://www.sensepost.com/research/wikto">http://www.sensepost.com/research/wikto</A>) does a splendid
job of finding directories and files within these directories. It also
works nicely with friendly 404 (or 302s or whatever) etc etc..

Dont know if this is relevant or if you mentioned it in the doc...or if
there is a seperate tool section..

my 2c,
Roelof

PS: we have recently released a couple of other web application testing
tools - whoever is writiing section on app testing (input validation,
brute forcing, state tracking) - be nice if you speak to me (when looking
at testing tools).

=====================
Roelof Temmingh
+ 27 12 460 0880
GMT+2
=====================
On Thu, 11 Aug 2005, Javier Fernandez-Sanguino wrote:

&gt;<i> Mauro Bregolin wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Daniel and all,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; please find attached my submission.
</I>&gt;<i> &gt; Feel free to review it and send comments, particularly if you have
</I>&gt;<i> &gt; relevant information regarding bibliographic references not mentioned in
</I>&gt;<i> &gt; the text
</I>&gt;<i>
</I>&gt;<i> With respect to the &quot;Old, backup and unrefereced (sic) files&quot;  I want
</I>&gt;<i> to point out (again) that Dafydd Stuttard wrote an excellent text on
</I>&gt;<i> this matter that could be reused, please check the CVS or the file
</I>&gt;<i> attached.
</I>&gt;<i>
</I>&gt;<i> As for the text here's some personal recommendations for improvement:
</I>&gt;<i>
</I>&gt;<i> Unreferenced application files are not only dangerous because they
</I>&gt;<i> provide you with internal source code but because they might be
</I>&gt;<i> vulnerable! Imagine the case of a web administrator taking a file that
</I>&gt;<i> has an SQL injection, making a backup copy of it, editing it to remove
</I>&gt;<i> the SQL injection present and leaving. If he forgets to remove the
</I>&gt;<i> backup file _And_ the backup file's extension will be executed by the
</I>&gt;<i> webserver (think: original: login.jsp, backup: login.old.jsp) then you
</I>&gt;<i> might think you are safe when you are actually just as vulnerable as
</I>&gt;<i> before (just that people don't know that the file exists).
</I>&gt;<i>
</I>&gt;<i> You also fail to mention files that do not belong in the web server
</I>&gt;<i> but are typically generated by upload tools (think WS_FTP.log files).
</I>&gt;<i> These files are &quot;unreferenced&quot; in the sense that they should not be
</I>&gt;<i> there, and contain sensitive information (like the user that ftp's in
</I>&gt;<i> the web server) that might be valuable to the user.
</I>&gt;<i>
</I>&gt;<i> Finally, many people are unaware or dimiss the problems with these
</I>&gt;<i> files because they think that the default index.html pages prevents
</I>&gt;<i> all of them from being seen (security through obscurity), they say
</I>&gt;<i> &quot;why care? only an internal user with knowledge can know about them?&quot;
</I>&gt;<i> and then the next web server security bugs comes around and makes all
</I>&gt;<i> the directories browsable because a module fails to load the default
</I>&gt;<i> index .{asp,html} page when fed malicious input, or the web server is
</I>&gt;<i> not properly configured and serves directory listings (the &quot;I expected
</I>&gt;<i> everyone to go through the redirection that sends you to
</I>&gt;<i> &quot;/login/login.asp&quot;, I thought nobody could access &quot;/login/&quot; directly
</I>&gt;<i> and get a listing of the directory there!)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Some White box strategies for detecting files (which I believe are
</I>&gt;<i> easier to implement and will produces less FP than the scripted
</I>&gt;<i> methods you suggest)
</I>&gt;<i>
</I>&gt;<i> - Look for files who have not been accessed in a long time, they might
</I>&gt;<i> be backup or unreferenced file. Rationale: If this is a web server,
</I>&gt;<i> most of the files will have their &quot;last access&quot; timestamp modified
</I>&gt;<i> everytime the web server reads them in to provide them to an end-user
</I>&gt;<i> or run them through an application engine. If a file has not been
</I>&gt;<i> accessed in, say, a year. It should be analysed. Of course, you need
</I>&gt;<i> to be using a filesystem that stores access times (most modern
</I>&gt;<i> filesystem will do)
</I>&gt;<i>
</I>&gt;<i> - Correlate logs of the web server with actual files. Rationale: you
</I>&gt;<i> can go through the web server access logs and retrieve the list of
</I>&gt;<i> files requested by clients and then compare that with the actual files
</I>&gt;<i> in the server. Those files that are _not_ on web server logs (if logs
</I>&gt;<i> go back sufficient time) are potential unreferenced files
</I>&gt;<i>
</I>&gt;<i> In Black Box testing you are missing some useful inputs sources:
</I>&gt;<i>
</I>&gt;<i> - Archive.org, better than google since it will _not_ timeout the
</I>&gt;<i> pages after time so you can actually see the old files that were in
</I>&gt;<i> the web server 3 years ago.
</I>&gt;<i>
</I>&gt;<i> - robots.txt files. Some people believe they can &quot;hide&quot; files from
</I>&gt;<i> there using that file, they don't think that the robots.txt file is
</I>&gt;<i> only honored by, yes, robots.
</I>&gt;<i>
</I>&gt;<i> - HTML comments. Either of active content (think server side includes
</I>&gt;<i> which have been disabled) or forms that have changed their action and
</I>&gt;<i> maintain (in a comment) the previous action CGI used.
</I>&gt;<i>
</I>&gt;<i> I would suggest you add these, as well as review the attached text
</I>&gt;<i> (the one I mentioned before) and merge many of its suggestions and
</I>&gt;<i> comments in your text.
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i>
</I>&gt;<i> Javier
</I>&gt;<i>
</I>


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001050.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
	<LI>Next message: <A HREF="001049.html">[OWASP-TESTING] OWASP WAPT submission
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1052">[ date ]</a>
              <a href="thread.html#1052">[ thread ]</a>
              <a href="subject.html#1052">[ subject ]</a>
              <a href="author.html#1052">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
