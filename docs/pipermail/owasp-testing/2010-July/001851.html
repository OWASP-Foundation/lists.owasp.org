<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-testing] Copy Cookies
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOwasp-testing%5D%20Copy%20Cookies&In-Reply-To=AANLkTikZZvpXtJhFofaShtjnmMszqEjojgRc2ZkvAD8W%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001848.html">
   <LINK REL="Next"  HREF="001853.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-testing] Copy Cookies</H1>
    <B>dinis cruz</B> 
    <A HREF="mailto:owasp-testing%40lists.owasp.org?Subject=%5BOwasp-testing%5D%20Copy%20Cookies&In-Reply-To=AANLkTikZZvpXtJhFofaShtjnmMszqEjojgRc2ZkvAD8W%40mail.gmail.com"
       TITLE="[Owasp-testing] Copy Cookies">dinis.cruz at owasp.org
       </A><BR>
    <I>Thu Jul 22 04:26:15 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="001848.html">[Owasp-testing] Copy Cookies
</A></li>
        <LI>Next message: <A HREF="001853.html">[Owasp-testing] Copy Cookies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1851">[ date ]</a>
              <a href="thread.html#1851">[ thread ]</a>
              <a href="subject.html#1851">[ subject ]</a>
              <a href="author.html#1851">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Dave, you're providing great guidance, but do you have a place we can
point developers to get UnitTests to check for the correct implementation of
these? (these unit tests should test from the browser point of view and the
correct source-code implementation).

The developers would customize these UnitTests to their app, but don't you
think that we need to show them working examples of these recomendations?

Dinis Cruz


On 22 July 2010 08:50, Dave van Stein &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">dvstein at gmail.com</A>&gt; wrote:

&gt;<i> Assuming you are talking about some sort of session token in the cookie
</I>&gt;<i> that can be reused on another client some other relevant tips from
</I>&gt;<i> <A HREF="http://www.owasp.org/index.php/Session_Management">http://www.owasp.org/index.php/Session_Management</A>
</I>&gt;<i>  All session tokens in high value applications SHOULD be tied to a
</I>&gt;<i> specific HTTP client instance (session identifier and IP address).
</I>&gt;<i> Application servers SHOULD use private temporary file areas per
</I>&gt;<i> client/application to store session data.
</I>&gt;<i> All applications SHOULD use a cryptographically secure page or form nonce
</I>&gt;<i> in a hidden form field.
</I>&gt;<i> Each form or page nonce SHOULD be removed from the active list as soon as
</I>&gt;<i> it is submitted.
</I>&gt;<i>  Session tokens should be regenerated prior to any significant high value
</I>&gt;<i> transaction.
</I>&gt;<i> In high-value applications, session tokens should be regenerated after a
</I>&gt;<i> certain number of requests.
</I>&gt;<i> In high-value applications, session tokens should be regenerated after a
</I>&gt;<i> certain period of time.
</I>&gt;<i>
</I>&gt;<i> In general you can say the less predictable a session token is, the more
</I>&gt;<i> secure it is.
</I>&gt;<i> So to make your appplication as secure as possible:
</I>&gt;<i> - make it difficult to predict
</I>&gt;<i> - link it to the client with an difficult to predict property
</I>&gt;<i> - reuse each token as little as possible and regenerate as often as
</I>&gt;<i> possible
</I>&gt;<i> - make use of a second (unpredictable) token and validate and reissue that
</I>&gt;<i> for every request (also helps against CSRF)
</I>&gt;<i>
</I>&gt;<i> regards, Dave
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> 2010/7/22 Nam T. Nguyen &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">namn at bluemoon.com.vn</A>&gt;
</I>&gt;<i>
</I>&gt;<i> A few ways:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 1. Embed some specific information such as REMOTE_ADDRESS into the cookie.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 2. It is unclear whether the cookie stores username/password. If it does,
</I>&gt;&gt;<i> DON'T.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> 3. Give the cookie a shorter time out.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Well, these don't complete solve the problem. But they will help limit the
</I>&gt;&gt;<i> possibilities.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Besides, if one can obtain a cookie, he pretty much can do anything else.
</I>&gt;&gt;<i> That's how CSS and CSRF works, isn't it? In your case, this requires access
</I>&gt;&gt;<i> to that particular machine (to __copy the cookies__). You have a bigger
</I>&gt;&gt;<i> problem to worry about then.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers
</I>&gt;&gt;<i> Nam
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Jul 22, 2010, at 10:03 AM, Zaki Akhmad wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Hello,
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; I found the web application that I test is vulnerable with its
</I>&gt;&gt;<i> &gt; cookies. After I successfully login with userid and password provided,
</I>&gt;&gt;<i> &gt; I can copy the cookies to another browser/computer so that he/she can
</I>&gt;&gt;<i> &gt; enter the web application without login.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; How do I fix this vulnerability?
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; Thanks!
</I>&gt;&gt;<i> &gt; --
</I>&gt;&gt;<i> &gt; Zaki Akhmad
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Owasp-testing mailing list
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">Owasp-testing at lists.owasp.org</A>
</I>&gt;&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">https://lists.owasp.org/mailman/listinfo/owasp-testing</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Nam Nguyen, CISA, CISSP, CSSLP
</I>&gt;&gt;<i> Blue Moon Consulting Co., Ltd.
</I>&gt;&gt;<i> <A HREF="http://www.bluemoon.com.vn">http://www.bluemoon.com.vn</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-testing mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">Owasp-testing at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">https://lists.owasp.org/mailman/listinfo/owasp-testing</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-testing mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">Owasp-testing at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-testing">https://lists.owasp.org/mailman/listinfo/owasp-testing</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-testing/attachments/20100722/dad0dd02/attachment.html">https://lists.owasp.org/pipermail/owasp-testing/attachments/20100722/dad0dd02/attachment.html</A> 
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001848.html">[Owasp-testing] Copy Cookies
</A></li>
	<LI>Next message: <A HREF="001853.html">[Owasp-testing] Copy Cookies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1851">[ date ]</a>
              <a href="thread.html#1851">[ thread ]</a>
              <a href="subject.html#1851">[ subject ]</a>
              <a href="author.html#1851">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-testing">More information about the Owasp-testing
mailing list</a><br>
</body></html>
