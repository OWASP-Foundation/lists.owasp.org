<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Mod-security-developers] Possible bug in ModSec (was: Re: Error with CRS 3.0.0-rc1 &quot;error parsing actions unknown action \\&quot;)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BMod-security-developers%5D%0A%20Possible%20bug%20in%20ModSec%20%28was%3A%20Re%3A%20Error%20with%20CRS%203.0.0-rc1%20%22error%20parsing%0A%20actions%20unknown%20action%20%5C%5C%22%29&In-Reply-To=%3C6AD649C6-1940-4458-9827-5D018AD24FF7%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002174.html">
   <LINK REL="Next"  HREF="002176.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Mod-security-developers] Possible bug in ModSec (was: Re: Error with CRS 3.0.0-rc1 &quot;error parsing actions unknown action \\&quot;)</H1>
    <B>Felipe Costa</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BMod-security-developers%5D%0A%20Possible%20bug%20in%20ModSec%20%28was%3A%20Re%3A%20Error%20with%20CRS%203.0.0-rc1%20%22error%20parsing%0A%20actions%20unknown%20action%20%5C%5C%22%29&In-Reply-To=%3C6AD649C6-1940-4458-9827-5D018AD24FF7%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Mod-security-developers] Possible bug in ModSec (was: Re: Error with CRS 3.0.0-rc1 &quot;error parsing actions unknown action \\&quot;)">FCosta at trustwave.com
       </A><BR>
    <I>Tue May 31 00:34:32 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002174.html">[Owasp-modsecurity-core-rule-set] Possible bug in ModSec (was: Re: Error with CRS 3.0.0-rc1 &quot;error parsing actions unknown action \\&quot;)
</A></li>
        <LI>Next message: <A HREF="002176.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers] Possible bug in ModSec (was: Re: Error with CRS 3.0.0-rc1 &quot;error parsing actions unknown action \\&quot;)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2175">[ date ]</a>
              <a href="thread.html#2175">[ thread ]</a>
              <a href="subject.html#2175">[ subject ]</a>
              <a href="author.html#2175">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christian,

It seems to me that this problem is associated with an known Apache issue.
It is related to the utilization of the continuation lines &#8220;\\&#8221; .

For further details: <A HREF="https://bz.apache.org/bugzilla/show_bug.cgi?id=55910">https://bz.apache.org/bugzilla/show_bug.cgi?id=55910</A>

I made the comment #4 back on 2014: <A HREF="https://bz.apache.org/bugzilla/show_bug.cgi?id=55910#c4">https://bz.apache.org/bugzilla/show_bug.cgi?id=55910#c4</A>

I think it is fixed on Apache 2.4.11+.

Br.,
Felipe &#8220;Zimmerle&#8221; Costa
Security Researcher, Lead Developer ModSecurity.

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com &lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;








On 5/30/16, 5:34 PM, &quot;Christian Folini&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:

&gt;<i>David,
</I>&gt;<i>
</I>&gt;<i>Thanks for writing in. I am X-posting this to modsec-dev as well.
</I>&gt;<i>
</I>&gt;<i>Yours is a very strange problem indeed. I am running the 3.0rc1
</I>&gt;<i>ruleset in production and have been running dozens of tests without
</I>&gt;<i>any issue.
</I>&gt;<i>
</I>&gt;<i>Here is the minimal configuration, which triggered the bug in my
</I>&gt;<i>environment (Ubunt 14.04, apache 2.4.7, modsec 2.9.1)
</I>&gt;<i>
</I>&gt;<i>ServerName              localhost
</I>&gt;<i>ServerAdmin             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">root at localhost</A>
</I>&gt;<i>ServerRoot              /opt/apache-2.4.18
</I>&gt;<i>User                    www-data
</I>&gt;<i>Group                   www-data
</I>&gt;<i>PidFile                        logs/httpd.pid
</I>&gt;<i>
</I>&gt;<i>ServerTokens            Prod
</I>&gt;<i>UseCanonicalName        On
</I>&gt;<i>TraceEnable             Off
</I>&gt;<i>
</I>&gt;<i>Timeout                 300
</I>&gt;<i>MaxClients              100
</I>&gt;<i>
</I>&gt;<i>KeepAlive               On
</I>&gt;<i>KeepAliveTimeout        100ms
</I>&gt;<i>
</I>&gt;<i>Listen                  127.0.0.1:80
</I>&gt;<i>
</I>&gt;<i>LoadModule              mpm_prefork_module      modules/mod_mpm_prefork.so
</I>&gt;<i>LoadModule              unixd_module            modules/mod_unixd.so
</I>&gt;<i>LoadModule              authz_host_module       modules/mod_authz_host.so
</I>&gt;<i>LoadModule              log_config_module       modules/mod_log_config.so
</I>&gt;<i>LoadModule              logio_module            modules/mod_logio.so
</I>&gt;<i>
</I>&gt;<i>LoadModule              headers_module          modules/mod_headers.so
</I>&gt;<i>LoadModule              unique_id_module        modules/mod_unique_id.so
</I>&gt;<i>LoadModule              security2_module        modules/mod_security2.so
</I>&gt;<i>
</I>&gt;<i>LoadModule              mime_module             modules/mod_mime.so
</I>&gt;<i>LoadModule              status_module           modules/mod_status.so
</I>&gt;<i>
</I>&gt;<i>LoadModule              lbmethod_byrequests_module modules/mod_lbmethod_byrequests.so
</I>&gt;<i>
</I>&gt;<i>LogLevel                        debug core:notice
</I>&gt;<i>
</I>&gt;<i>ErrorLogFormat &quot;[%{cu}t] [%-m:%-l] %-a %-L %M&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>ErrorLog                logs/error.log
</I>&gt;<i>
</I>&gt;<i>DocumentRoot            /apache/htdocs
</I>&gt;<i>
</I>&gt;<i># === Start ModSec Configuration
</I>&gt;<i>
</I>&gt;<i>SecRuleEngine                 On
</I>&gt;<i>
</I>&gt;<i>SecRequestBodyAccess          On
</I>&gt;<i>SecRequestBodyLimit           10000000
</I>&gt;<i>SecRequestBodyNoFilesLimit    64000
</I>&gt;<i>
</I>&gt;<i>SecResponseBodyAccess         On
</I>&gt;<i>SecResponseBodyLimit          10000000
</I>&gt;<i>
</I>&gt;<i>SecTmpDir                     /tmp/
</I>&gt;<i>SecDataDir                    /tmp/
</I>&gt;<i>SecUploadDir                  /tmp/
</I>&gt;<i>
</I>&gt;<i>SecDebugLog                   /apache/logs/modsec_debug.log
</I>&gt;<i>SecDebugLogLevel              9
</I>&gt;<i>
</I>&gt;<i>SecAuditEngine                RelevantOnly
</I>&gt;<i>SecAuditLogRelevantStatus     &quot;^(?:5|4(?!04))&quot;
</I>&gt;<i>SecAuditLogParts              ABEFHIJZ
</I>&gt;<i>
</I>&gt;<i>SecAuditLogType               Concurrent
</I>&gt;<i>SecAuditLog                   /apache/logs/modsec_audit.log
</I>&gt;<i>SecAuditLogStorageDir         /apache/logs/audit/
</I>&gt;<i>
</I>&gt;<i>SecPcreMatchLimit             500000
</I>&gt;<i>SecPcreMatchLimitRecursion    500000
</I>&gt;<i>
</I>&gt;<i>SecDefaultAction              &quot;phase:2,pass,log&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>SecRule RESPONSE_BODY &quot;(?:&lt;(?:TITLE&gt;Index of.*?&lt;H|title&gt;Index of.*?&lt;h)1&gt;Index of|&gt;\[To Parent Directory\]&lt;\/[Aa]&gt;&lt;br&gt;)&quot; \
</I>&gt;<i>       &quot;phase:response,\
</I>&gt;<i>       rev:'2',\
</I>&gt;<i>       ver:'OWASP_CRS/3.0.0',\
</I>&gt;<i>       maturity:'9',\
</I>&gt;<i>       accuracy:'9',\
</I>&gt;<i>       t:none,\
</I>&gt;<i>       block,\
</I>&gt;<i>       id:'950110'&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>&lt;Directory /&gt;
</I>&gt;<i>        Options SymLinksIfOwnerMatch
</I>&gt;<i>        AllowOverride None
</I>&gt;<i>&lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i>&lt;VirtualHost *:80&gt;
</I>&gt;<i>        ServerName localhost
</I>&gt;<i>
</I>&gt;<i>        &lt;Directory /apache/htdocs&gt;
</I>&gt;<i>
</I>&gt;<i>        &lt;/Directory&gt;
</I>&gt;<i>
</I>&gt;<i>&lt;/VirtualHost&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>$&gt; ./bin/httpd -X -f conf/httpd.conf_problem_of_the_day
</I>&gt;<i>AH00526: Syntax error on line 82 of /opt/apache-2.4.18/conf/httpd.conf_problem_of_the_day
</I>&gt;<i>Error parsing actions: Unknown action: \\
</I>&gt;<i>
</I>&gt;<i>I tried this with 2.4.7 as well.
</I>&gt;<i>
</I>&gt;<i>If I take a single character out of the regex or out of the version
</I>&gt;<i>string (OWASP_CRS...), then the bug disappears.
</I>&gt;<i>
</I>&gt;<i>If I add a space in front of the backslash: bug disappears.
</I>&gt;<i>
</I>&gt;<i>Given the config above, I am quite sure there is a bug hidden somewhere.
</I>&gt;<i>Maybe I am overlooking something and somebody can point me to an
</I>&gt;<i>error. If that is not the case, then I think it is a bug.
</I>&gt;<i>
</I>&gt;<i>David: I suggest you open a bug report. Please open it against
</I>&gt;<i>ModSecurity and not against the Core Rules.
</I>&gt;<i>
</I>&gt;<i>Ahoj,
</I>&gt;<i>
</I>&gt;<i>Christian
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>On Fri, May 27, 2016 at 08:48:31PM -0500, David Angel wrote:
</I>&gt;&gt;<i> Good evening,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I originally posted this at
</I>&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5l7QuIfKA&amp;s=5&amp;u=http%3a%2f%2fstackoverflow%2ecom%2fquestions%2f37369990%2fmodsecurity-error-parsing-actions-unknown-action">http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5l7QuIfKA&amp;s=5&amp;u=http%3a%2f%2fstackoverflow%2ecom%2fquestions%2f37369990%2fmodsecurity-error-parsing-actions-unknown-action</A>
</I>&gt;&gt;<i> and it was suggested to send to this listserv as well.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm trying to get CRS 3.0.0.-rc1 working with ModSecurity 2.9.1 and Apache
</I>&gt;&gt;<i> 2.4.7 on an Ubuntu 14.04 machine.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm using all the rules in the /rules directory, and when trying to start
</I>&gt;&gt;<i> Apache I receive the following error. (Note: There is no entry in the
</I>&gt;&gt;<i> Apache error.log file for this.)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> AH00526: Syntax error on line 35 of
</I>&gt;&gt;<i> /etc/apache2/conf/crs/rules/RESPONSE-50-DATA-LEAKAGES-PHP.conf:
</I>&gt;&gt;<i> Error parsing actions: Unknown action: \\
</I>&gt;&gt;<i> Action 'configtest' failed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In my troubleshooting of the *RESPONSE-50-DATA-LEAKAGES-PHP.conf
</I>&gt;&gt;<i> *file, I combined line 35 with 34
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> capture,ctl:auditLogParts=+E,\
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> just to see if the line error would change (and make sure I was indeed
</I>&gt;&gt;<i> troubleshooting the correct file) and suddenly this error is gone, and
</I>&gt;&gt;<i> is replaced with another.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> AH00526: Syntax error on line 31 of
</I>&gt;&gt;<i> /etc/apache2/conf/crs/rules/RESPONSE-50-DATA-LEAKAGES.conf:
</I>&gt;&gt;<i> Error parsing actions: Unknown action: \\
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> which again is solved by combining with the line above it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> accuracy:'9',t:none,\
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now it starts correctly with no error.  Needless to say I'm pretty
</I>&gt;&gt;<i> confused about this error, and more confused about the &quot;fix&quot; since I
</I>&gt;&gt;<i> don't understand why removing a single line continuation would matter.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Any thoughts on this?  Or any suggestions to increase debug\troubleshooting?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> David Angel
</I>&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS50vHuBKKQ&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set">http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS50vHuBKKQ&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i><A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5h6QuYRJA&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech">http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5h6QuYRJA&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech</A>
</I>&gt;<i>twitter: @ChrFolini
</I>&gt;<i>
</I>&gt;<i>------------------------------------------------------------------------------
</I>&gt;<i>What NetFlow Analyzer can do for you? Monitors network bandwidth and traffic
</I>&gt;<i>patterns at an interface-level. Reveals which users, apps, and protocols are
</I>&gt;<i>consuming the most bandwidth. Provides multi-vendor support for NetFlow,
</I>&gt;<i>J-Flow, sFlow and other flows. Make informed decisions using capacity
</I>&gt;<i>planning reports. <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5svEuhJKA&amp;s=5&amp;u=https%3a%2f%2fad%2edoubleclick%2enet%2fddm%2fclk%2f305295220%3b132659582%3be">http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5svEuhJKA&amp;s=5&amp;u=https%3a%2f%2fad%2edoubleclick%2enet%2fddm%2fclk%2f305295220%3b132659582%3be</A>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>mod-security-developers mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-developers at lists.sourceforge.net</A>
</I>&gt;<i><A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5ksH-UfdQ&amp;s=5&amp;u=https%3a%2f%2flists%2esourceforge%2enet%2flists%2flistinfo%2fmod-security-developers">http://scanmail.trustwave.com/?c=4062&amp;d=9qPM115iL1ynPbZVTXRAV5XeKfPloSkwS5ksH-UfdQ&amp;s=5&amp;u=https%3a%2f%2flists%2esourceforge%2enet%2flists%2flistinfo%2fmod-security-developers</A>
</I>&gt;<i>ModSecurity Services from Trustwave's SpiderLabs:
</I>&gt;<i><A HREF="https://www.trustwave.com/spiderLabs.php">https://www.trustwave.com/spiderLabs.php</A>
</I>
________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002174.html">[Owasp-modsecurity-core-rule-set] Possible bug in ModSec (was: Re: Error with CRS 3.0.0-rc1 &quot;error parsing actions unknown action \\&quot;)
</A></li>
	<LI>Next message: <A HREF="002176.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers] Possible bug in ModSec (was: Re: Error with CRS 3.0.0-rc1 &quot;error parsing actions unknown action \\&quot;)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2175">[ date ]</a>
              <a href="thread.html#2175">[ thread ]</a>
              <a href="subject.html#2175">[ subject ]</a>
              <a href="author.html#2175">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
