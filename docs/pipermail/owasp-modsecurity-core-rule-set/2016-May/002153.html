<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20arg%20name%20not%20resolving%20for%0A%20large%09post%20value&In-Reply-To=%3CCO2PR18MB0012773E8818C9E7AC548F21DE770%40CO2PR18MB0012.namprd18.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002152.html">
   <LINK REL="Next"  HREF="002154.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value</H1>
    <B>Colin MacAllister</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20arg%20name%20not%20resolving%20for%0A%20large%09post%20value&In-Reply-To=%3CCO2PR18MB0012773E8818C9E7AC548F21DE770%40CO2PR18MB0012.namprd18.prod.outlook.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value">cmacallister at probono.net
       </A><BR>
    <I>Mon May 16 18:09:19 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002152.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
        <LI>Next message: <A HREF="002154.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2153">[ date ]</a>
              <a href="thread.html#2153">[ thread ]</a>
              <a href="subject.html#2153">[ subject ]</a>
              <a href="author.html#2153">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks, Christian. But which client are you referring to? Not my Firefox browser? It's my IIS server which is receiving the post -- do you mean that might be buggy?

-----Original Message-----
From: Christian Folini [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>] 
Sent: Monday, May 16, 2016 1:51 PM
To: Colin MacAllister &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;
Cc: OWASP CRS Mailing List &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] arg name not resolving for large post value

Colin,

On Mon, May 16, 2016 at 03:20:17PM +0000, Colin MacAllister wrote:
&gt;<i> (Sent my payload to Christian offline.)
</I>
Thank you for the entire payload and the audit.log.

The payload has 8833 bytes.
The Content-Length request header announces 3451 bytes.
The request body (as written to the audit log) contains 3459 bytes.

The request body starts at an arbitrary position on line 72 of your payload and runs up to the end of the payload.

I have a strong feeling that your client is buggy. The mismatch in request header and request body is troubling.

In your position, I would now unload the ModSec module and try anew for a test. If this works without ModSecurity, then you have a bug in ModSecurity for IIS. Otherwise, it's really the client.

Ahoj,

Christian




&gt;<i> 
</I>&gt;<i> One thing I should add is that for every rule ID I intend to circumvent I have a few lines line like this:
</I>&gt;<i> SecRuleUpdateTargetById 950018 &quot;!ARGS:'/text|Blurb|myxml|MailMessage|BodyField|TextEmail /'&quot;
</I>&gt;<i> ... with the 2 subsequent lines include other arguments to ignore.
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: Christian Folini [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>]
</I>&gt;<i> Sent: Friday, May 13, 2016 2:40 PM
</I>&gt;<i> To: Colin MacAllister &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;
</I>&gt;<i> Cc: OWASP CRS Mailing List 
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> Subject: Re: [Owasp-modsecurity-core-rule-set] arg name not resolving 
</I>&gt;<i> for large post value
</I>&gt;<i> 
</I>&gt;<i> On Fri, May 13, 2016 at 06:28:52PM +0000, Colin MacAllister wrote:
</I>&gt;<i> &gt; The payload is not correct. The initial payload is something like &quot;blurb=A stitch in time saves nine&quot;, but what comes through is just &quot;ime saves nine&quot;, and mod security tries to interpret that as one of  the argnames instead of &quot; blurb&quot;. I'm pretty sure this isn't by design.
</I>&gt;<i> 
</I>&gt;<i> Thanks for pointing this out, Colin. Please provide the exact and complete payload. I think it really matters in order to reproduce this issue.
</I>&gt;<i> 
</I>&gt;<i> Ahoj,
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> Every man takes the limits of his own field of vision for the
</I>&gt;<i> limits of the world.        &#160;
</I>&gt;<i> -- Arthur Schopenhauer
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list 
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002152.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
	<LI>Next message: <A HREF="002154.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2153">[ date ]</a>
              <a href="thread.html#2153">[ thread ]</a>
              <a href="subject.html#2153">[ subject ]</a>
              <a href="author.html#2153">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
