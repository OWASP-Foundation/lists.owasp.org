<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] arg name not resolving for large post value
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20arg%20name%20not%20resolving%20for%0A%20large%20post%20value&In-Reply-To=%3C20160505192029.GA11306%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002137.html">
   <LINK REL="Next"  HREF="002139.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] arg name not resolving for large post value</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20arg%20name%20not%20resolving%20for%0A%20large%20post%20value&In-Reply-To=%3C20160505192029.GA11306%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] arg name not resolving for large post value">christian.folini at netnea.com
       </A><BR>
    <I>Thu May  5 19:20:29 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002137.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
        <LI>Next message: <A HREF="002139.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2138">[ date ]</a>
              <a href="thread.html#2138">[ thread ]</a>
              <a href="subject.html#2138">[ subject ]</a>
              <a href="author.html#2138">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Colin,

This is funny, indeed.

The audit-log states, the &quot;rc+is+knoowledgeable%2C+experienced%2C...&quot;
does not have a variable name. So either
(a) your browser did not send the name (and inspector lied to you) 
(b) you discovered a bug
(c) the request body limit(s) is very low and you have processPartial
    enabled and the beginning of the argument is cut, rather then the
    end.

(c) is highly speculative and I doubt that would be the behaviour
in that particular case.

What is puzzling me is that the response body documented in the audit
log is indeed shorter (2930) then the 2975 announced in that request
headers. 

What to do?

I think you need to sniff the traffic. Try and reproduce the behaviour
in cleartext and then use wireshark / tcpdump to sniff it.

If you are not proficient with the said tools, here is how you
could dump it clientside or serverside with tcpdump:

$&gt; tcpdump -A -s0 port 80

That should give you clear proof what is happening.

Keep us posted, please!

Christian

    

On Thu, May 05, 2016 at 06:29:36PM +0000, Colin MacAllister wrote:
&gt;<i> Hi, all,
</I>&gt;<i> 
</I>&gt;<i> As I fine-tune my CMS not to bark at me for valid traffic, I&#8217;ve come upon the following problem. When a rule matches (in anomaly scoring mode, haven&#8217;t tested the other way) sometimes part of the value of the argument the will come through as the argument name, not the name itself, in this case, &#8220;Blurb.&#8221;
</I>&gt;<i> 
</I>&gt;<i> ARGS_NAMES:rc is knowledgeable, experienced, empathetic, and kind&#8230; [followed by a chunk of the rest of the arg value]
</I>&gt;<i> 
</I>&gt;<i> I checked it in the inspector, and indeed the ARG_NAME should be &#8220;Blurb&#8221;. As it is coming through, of course, it is impossible to check for, as it is variable. It might be possible to whitelist the last part of the URL path, but I&#8217;d rather not.
</I>&gt;<i> 
</I>&gt;<i> Have I found a bug? See the snippet from the audit log I attached to this email.
</I>&gt;<i> 
</I>

&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002137.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
	<LI>Next message: <A HREF="002139.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2138">[ date ]</a>
              <a href="thread.html#2138">[ thread ]</a>
              <a href="subject.html#2138">[ subject ]</a>
              <a href="author.html#2138">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
