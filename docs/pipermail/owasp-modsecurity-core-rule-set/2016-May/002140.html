<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20arg%20name%20not%20resolving%20for%0A%20large%09post%20value&In-Reply-To=%3CCO2PR18MB00121B41D41F582E5ACE7ED2DE720%40CO2PR18MB0012.namprd18.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002139.html">
   <LINK REL="Next"  HREF="002141.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value</H1>
    <B>Colin MacAllister</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20arg%20name%20not%20resolving%20for%0A%20large%09post%20value&In-Reply-To=%3CCO2PR18MB00121B41D41F582E5ACE7ED2DE720%40CO2PR18MB0012.namprd18.prod.outlook.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value">cmacallister at probono.net
       </A><BR>
    <I>Wed May 11 15:03:44 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002139.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
        <LI>Next message: <A HREF="002141.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2140">[ date ]</a>
              <a href="thread.html#2140">[ thread ]</a>
              <a href="subject.html#2140">[ subject ]</a>
              <a href="author.html#2140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I added part C (request body) to the audit log, and it also is showing truncated data. It's actually the entire form data post that is truncated so that just the last part gets through. But the entire post is received by the database.

From: Colin MacAllister
Sent: Tuesday, May 10, 2016 1:38 PM
To: OWASP List &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: RE: [Owasp-modsecurity-core-rule-set] arg name not resolving for large post value

Resurrecting this. I'm sure the arg value is being passed from the browser intact, because it show up in the database in one piece, and because Firefox reports that it is being sent in the Developer/Network view.

I've attempted switching back from anomaly scoring mode to one-strike-you're-out, and am still getting the problem. Should I being having this conversation with whoever puts out the Windows port of modsecurity?

Sent from Mail&lt;<A HREF="https://go.microsoft.com/fwlink/?LinkId=550986">https://go.microsoft.com/fwlink/?LinkId=550986</A>&gt; for Windows 10

From: Colin MacAllister&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;
Sent: Thursday, May 5, 2016 2:39 PM
To: OWASP List&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: [Owasp-modsecurity-core-rule-set] arg name not resolving for large post value

Hi, all,

As I fine-tune my CMS not to bark at me for valid traffic, I've come upon the following problem. When a rule matches (in anomaly scoring mode, haven't tested the other way) sometimes part of the value of the argument the will come through as the argument name, not the name itself, in this case, &quot;Blurb.&quot;

ARGS_NAMES:rc is knowledgeable, experienced, empathetic, and kind... [followed by a chunk of the rest of the arg value]

I checked it in the inspector, and indeed the ARG_NAME should be &quot;Blurb&quot;. As it is coming through, of course, it is impossible to check for, as it is variable. It might be possible to whitelist the last part of the URL path, but I'd rather not.

Have I found a bug? See the snippet from the audit log I attached to this email.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160511/ff65848e/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160511/ff65848e/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002139.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
	<LI>Next message: <A HREF="002141.html">[Owasp-modsecurity-core-rule-set] arg name not resolving for large	post value
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2140">[ date ]</a>
              <a href="thread.html#2140">[ thread ]</a>
              <a href="subject.html#2140">[ subject ]</a>
              <a href="author.html#2140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
