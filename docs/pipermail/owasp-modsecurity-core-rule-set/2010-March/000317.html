<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] whitelisting a parameter
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20whitelisting%20a%20parameter&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000316.html">
   <LINK REL="Next"  HREF="000318.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] whitelisting a parameter</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20whitelisting%20a%20parameter&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] whitelisting a parameter">Ryan.Barnett at breach.com
       </A><BR>
    <I>Mon Mar  1 06:48:23 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000316.html">[Owasp-modsecurity-core-rule-set] whitelisting a parameter
</A></li>
        <LI>Next message: <A HREF="000318.html">[Owasp-modsecurity-core-rule-set] Unespected behaviour of	SecDefaultAction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#317">[ date ]</a>
              <a href="thread.html#317">[ thread ]</a>
              <a href="subject.html#317">[ subject ]</a>
              <a href="author.html#317">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>This is where inspecting the previously matched TX data comes in. You should copy the example 48 local exceptions file and place it in the base_rules dir. You then create a rule that inspects the TX data to see if there was a previous match. You would want to look for the specific ARGS:name data in the TX name and optionally match on the exact false positive matched data. Take a look at the examples in the 48 file. You probably just want to correct the anomaly score rather than switch to DetectionOnly mode.

If you send an audit log example of the false positive it would help.

Ryan C. Barnett
Director of Application Security Research
Breach Security, Inc.
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at Breach.com</A>
www.Breach.com

________________________________
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Sent: Mon Mar 01 05:31:18 2010
Subject: Re: [Owasp-modsecurity-core-rule-set] whitelisting a parameter

To rephrase the question, how can I adjust the anomaly score for a specific parameter so that it essentially is put in DetectionOnly mode, i.e. an event will be created if it matches a rule, but the traffic wont be stopped if the anomaly score is high only because of that parameter.

Thanks,

Chris

On Sat, Feb 27, 2010 at 10:13 PM, Chris Datfung &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris.datfung at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris.datfung at gmail.com</A>&gt;&gt; wrote:
I'm getting a large number of false positives in various requests due to the encrypted value of the ViewState parameter. I can whitelist the false positives one by one via SecRuleRemoveById, but instead of waiting for the next false positive (I have blocking enabled) I want to put any rules that want to block due to a suspicious ViewState parameter into DetectionOnly mode and still have the rest of the request in blocking mode. Is this possible?

Thanks,
  Chris

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100301/f45d2ce7/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100301/f45d2ce7/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000316.html">[Owasp-modsecurity-core-rule-set] whitelisting a parameter
</A></li>
	<LI>Next message: <A HREF="000318.html">[Owasp-modsecurity-core-rule-set] Unespected behaviour of	SecDefaultAction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#317">[ date ]</a>
              <a href="thread.html#317">[ thread ]</a>
              <a href="subject.html#317">[ subject ]</a>
              <a href="author.html#317">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
