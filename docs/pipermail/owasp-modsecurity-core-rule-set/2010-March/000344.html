<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS 2.0.6 Optional Rules: 42, 46,	and 49
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.0.6%20Optional%20Rules%3A%2042%2C%2046%2C%0A%09and%2049&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000343.html">
   <LINK REL="Next"  HREF="000345.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS 2.0.6 Optional Rules: 42, 46,	and 49</H1>
    <B>Mark Lavi</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.0.6%20Optional%20Rules%3A%2042%2C%2046%2C%0A%09and%2049&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] CRS 2.0.6 Optional Rules: 42, 46,	and 49">mlavi at sgi.com
       </A><BR>
    <I>Wed Mar 24 21:46:59 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000343.html">[Owasp-modsecurity-core-rule-set] Documenting Attack Detection	Methods
</A></li>
        <LI>Next message: <A HREF="000345.html">[Owasp-modsecurity-core-rule-set] CRS 2.0.6 Optional Rules: 42,	46, and 49
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#344">[ date ]</a>
              <a href="thread.html#344">[ thread ]</a>
              <a href="subject.html#344">[ subject ]</a>
              <a href="author.html#344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello all,
 
I've upgraded to CRS 2.0.6 with ModSecurity 2.5.12 on my development web
server and reviewed the documentation on
<A HREF="http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_">http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_</A>
Project#tab=Documentation. I've got a few questions that I haven't see
addressed in the last two months on the mailing list.
 
For the first three below, I've created empty files and then ModSecurity
could load and execute these rules. My question boils down to, how am I
supposed to populate these data files?
 
1) optional_rules/modsecurity_crs_42_comment_spam.conf: requires a data
file &quot;optional_rules/modsecurity_42_comment_spam.data,&quot; but that doesn't
exist.
 
The documentation mentions a RBL check against SPAMHAUS, am I supposed
to provide the source IP address in this file?
 
2) optional_rules/modsecurity_crs_46_et_sql_injection.conf: requires a
data file &quot;optional_rules/modsecurity_46_et_sql_injection.data,&quot; but
that doesn't exist.
3) optional_rules/modsecurity_crs_46_et_web_rules.conf: requires a data
file &quot;optional_rules/modsecurity_46_et_web_rules.data,&quot; but that doesn't
exist.
 
I see that you're converting
<A HREF="http://www.emergingthreats.net/cgi-bin/cvsweb.cgi/rules/">http://www.emergingthreats.net/cgi-bin/cvsweb.cgi/rules/</A>
&lt;<A HREF="http://www.emergingthreats.net/cgi-bin/cvsweb.cgi/rules/">http://www.emergingthreats.net/cgi-bin/cvsweb.cgi/rules/</A>&gt;
emerging-web_server.rules and emerging-web_specific_apps.rules. Am I
supposed to pull down these Snort rule sets from their web site? I
imagine that I'm looking for your converted versions instead, is that
right?
 
4) optional_rules/modsecurity_crs_49_header_tagging.conf : Syntax error
on line 29 of optional_rules/modsecurity_crs_49_header_tagging.conf:
Invalid command 'RequestHeader', perhaps misspelled or defined by a
module not included in the server configuration.
 
I see this is an Apache directive for mod_headers
(<A HREF="http://httpd.apache.org/docs/2.2/mod/mod_headers.html">http://httpd.apache.org/docs/2.2/mod/mod_headers.html</A>), but this module
is disabled by default. It is not mentioned in mod_security's
installation documentation:
<A HREF="http://www.modsecurity.org/documentation/modsecurity-apache/2.5.12/modse">http://www.modsecurity.org/documentation/modsecurity-apache/2.5.12/modse</A>
curity2-apache-reference.html#installation. 
 
Can we add a note to configure Apache with: --enable-headers for this
optional rule?
 
Also, would it be prudent to enclose the entire file or perhaps just the
RequestHeader lines inside a &lt;IfModule mod_headers.c&gt; &lt;/IfModule&gt;
condition?  I did so and got ModSecurity to load this rule and start up.
 
Thanks,

Mark Lavi
Senior Web Producer

sgi

46600 Landing Parkway
Fremont, CA 94538
(510) 933-5234 direct
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mlavi at sgi.com</A> &lt;blocked::mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mlavi at sgi.com</A>&gt;  
www.sgi.com &lt;blocked::<A HREF="http://www.sgi.com/">http://www.sgi.com/</A>&gt; 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100324/8f6f7a65/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100324/8f6f7a65/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000343.html">[Owasp-modsecurity-core-rule-set] Documenting Attack Detection	Methods
</A></li>
	<LI>Next message: <A HREF="000345.html">[Owasp-modsecurity-core-rule-set] CRS 2.0.6 Optional Rules: 42,	46, and 49
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#344">[ date ]</a>
              <a href="thread.html#344">[ thread ]</a>
              <a href="subject.html#344">[ subject ]</a>
              <a href="author.html#344">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
