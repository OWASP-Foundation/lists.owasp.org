<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Need a help with sec rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Need%20a%20help%20with%20sec%20rule&In-Reply-To=200910131037.01631.ryan.barnett%40breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000115.html">
   <LINK REL="Next"  HREF="000117.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Need a help with sec rule</H1>
    <B>unni krishnan</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Need%20a%20help%20with%20sec%20rule&In-Reply-To=200910131037.01631.ryan.barnett%40breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Need a help with sec rule">unni at mutexes.org
       </A><BR>
    <I>Tue Oct 13 13:27:35 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000115.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
        <LI>Next message: <A HREF="000117.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#116">[ date ]</a>
              <a href="thread.html#116">[ thread ]</a>
              <a href="subject.html#116">[ subject ]</a>
              <a href="author.html#116">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ryan,

Thanks, I am just curious to know. What is the reason that the Curl
access is denied even though there is no deny rule specified in that
rule set.

On Tue, Oct 13, 2009 at 8:07 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ryan.barnett at breach.com</A>&gt; wrote:
&gt;<i> On Tuesday 13 October 2009 10:02:16 am unni krishnan wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I was going through the security rules in the server and found this :
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ---------------------------------
</I>&gt;&gt;<i> SecRule REQUEST_HEADERS:User-Agent &quot;(?:\b(?:(?:indy
</I>&gt;&gt;<i> librar|snoop)y|microsoft url control|lynx)\b|d(?:ownload
</I>&gt;&gt;<i> demon|isco)|w(?:3mirror|get)|l(?:ibwww|wp)|p(?:avuk|erl)|cu(?:sto|rl)|big
</I>&gt;&gt;<i> brother|autohttp|netants|eCatch)&quot; \
</I>&gt;&gt;<i> &quot;chain,log,auditlog,msg:'Request Indicates an automated
</I>&gt;&gt;<i> program explored the site',id:'990011',severity:'5'&quot;
</I>&gt;&gt;<i> SecRule REQUEST_HEADERS:User-Agent &quot;!^apache.*perl&quot;
</I>&gt;&gt;<i> ---------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> As per my knowledge, it just logs the message &quot;Request Indicates an
</I>&gt;&gt;<i> automated program explored the site&quot;. But actually it blocks access,
</I>&gt;&gt;<i> when accessing the URL using Curl.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ----------------------------------
</I>&gt;&gt;<i> ModSecurity: Access denied with code 406 (phase 2). Match of &quot;rx
</I>&gt;&gt;<i> ^apache.*perl&quot; against &quot;REQUEST_HEADERS:User-Agent&quot; required. [file
</I>&gt;&gt;<i> &quot;/usr/local/apache/conf/modsec2.user.conf&quot;] [line &quot;58&quot;] [id &quot;990011&quot;]
</I>&gt;&gt;<i> [msg &quot;Request Indicates an automated program explored the site&quot;]
</I>&gt;&gt;<i> [severity &quot;NOTICE&quot;] [uri &quot;/&quot;] [unique_id &quot;StSH9EPeHm4AAB3fCZgAAAAE&quot;]
</I>&gt;&gt;<i> ----------------------------------
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> What is the logic behind that ?
</I>&gt;<i>
</I>&gt;<i> These are the older CRS. I suggest that you update to the newer v2 CRS as
</I>&gt;<i> they using anomaly scoring and it is quite easy to then allow these rules to
</I>&gt;<i> slightly increase an anomaly score but to not cause a denial on their own.
</I>&gt;<i>
</I>&gt;<i> -Ryan
</I>&gt;<i>
</I>&gt;<i>
</I>


-- 
Regards,
Unni
<A HREF="http://mutexes.org/">http://mutexes.org/</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000115.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
	<LI>Next message: <A HREF="000117.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#116">[ date ]</a>
              <a href="thread.html#116">[ thread ]</a>
              <a href="subject.html#116">[ subject ]</a>
              <a href="author.html#116">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
