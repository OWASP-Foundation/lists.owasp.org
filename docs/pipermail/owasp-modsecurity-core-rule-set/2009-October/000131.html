<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] How to disable rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20to%20disable%20rule&In-Reply-To=245770850910191333v68497338w63ce8e6a0b5753e2%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000128.html">
   <LINK REL="Next"  HREF="000138.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] How to disable rule</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20to%20disable%20rule&In-Reply-To=245770850910191333v68497338w63ce8e6a0b5753e2%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] How to disable rule">Ryan.Barnett at breach.com
       </A><BR>
    <I>Mon Oct 19 16:55:48 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000128.html">[Owasp-modsecurity-core-rule-set] How to disable rule
</A></li>
        <LI>Next message: <A HREF="000138.html">[Owasp-modsecurity-core-rule-set] Typo in	modsecurity_crs_41_xss_attacks.conf (modsecurity-apache_2.5.10)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#131">[ date ]</a>
              <a href="thread.html#131">[ thread ]</a>
              <a href="subject.html#131">[ subject ]</a>
              <a href="author.html#131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You don't have to have a rule id in order to do an exception in that file.  What you do need to know is how to properly identify the TX variable and then adjust the anomaly score back down.

Look either in the audit or debug log to find out what the setvar TX variable (specifically what is the parameter name it is flagging) is and then you can create a rule.

-Ryan

________________________________
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Lucas Ferreira [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">listas at sapao.net</A>]
Sent: Monday, October 19, 2009 4:33 PM
To: Brian Rectanus
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Re: [Owasp-modsecurity-core-rule-set] How to disable rule

Hello Brian,

I've seen the examples, but I could not find an ID for the rule. I do not want to remove the COMMAND_INJECTION category. Is it normal to have a rule with no ID?

Thanks,

Lucas

On Mon, Oct 19, 2009 at 16:28, Brian Rectanus &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Brian.Rectanus at breach.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Brian.Rectanus at breach.com</A>&gt;&gt; wrote:
Lucas Ferreira wrote:
Hello,

I am getting some false positives on the rules:

SecRule ARGS_NAMES &quot;.*&quot; \
&quot;chain,phase:2,t:none,nolog,auditlog,pass,capture,setvar:'tx.arg_name_%{tx.0}=+1',msg:'Possible
HTTP Parameter Pollution Attack: Multiple Parameters with the same Name.'&quot;
        SecRule TX:/ARG_NAME_*/ &quot;@gt 1&quot;
&quot;t:none,setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+20,setvar:tx.web_attack_score=+1,setvar:tx.%{rule.id&lt;<A HREF="http://rule.id">http://rule.id</A>&gt;
&lt;<A HREF="http://rule.id">http://rule.id</A>&gt;}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%{matched_var}&quot;


The error logged is:
--83105014-H--
Message:  [file
&quot;/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_60_correlation.conf&quot;]
[line &quot;41&quot;] [msg &quot;Transactional Anomaly Score
 (score 20): Possible HTTP Parameter Pollution Attack: Multiple
Parameters with the same Name.&quot;] Warning. Operator GE matched 5 at TX:an
omaly_score.
Action: Intercepted (phase 2)
Apache-Handler: type-map
Stopwatch: 1255961504085232 72304 (15501* 70314 -)
Producer: ModSecurity for Apache/2.5.9 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>);
core ruleset/2.0.1; core ruleset/2.0.1.&lt;<A HREF="http://2.0.1.">http://2.0.1.</A>&gt; &lt;<A HREF="http://2.0.1.">http://2.0.1.</A>&gt;

Server: Apache/2.2.3 (Red Hat)

The problem is that this application uses multiple parameters with the
same name, so this behaviour must be allowed. I am using CRS 2.0.1.

As the rules have no IDs, I cannot use a SecRuleRemoveById to remove it.
I can comment them, but I would rather not make changes on the original
files, keeping my changes in separate files. Is there any other way to
disable these rules?

Take a look at the examples of how to make exceptions to anomaly scoring rules in:

base_rules/modsecurity_crs_48_local_exceptions.conf

-B

--
Brian Rectanus
Breach Security



--
If a tree falls in the forest and no one is around to see it, do the other trees make fun of it?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091019/7ebf1d38/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091019/7ebf1d38/attachment.html</A> 
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000128.html">[Owasp-modsecurity-core-rule-set] How to disable rule
</A></li>
	<LI>Next message: <A HREF="000138.html">[Owasp-modsecurity-core-rule-set] Typo in	modsecurity_crs_41_xss_attacks.conf (modsecurity-apache_2.5.10)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#131">[ date ]</a>
              <a href="thread.html#131">[ thread ]</a>
              <a href="subject.html#131">[ subject ]</a>
              <a href="author.html#131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
