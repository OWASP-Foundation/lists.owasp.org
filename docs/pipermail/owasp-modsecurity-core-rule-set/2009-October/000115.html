<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Need a help with sec rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Need%20a%20help%20with%20sec%20rule&In-Reply-To=35dfe7b70910130702k55dd1d0alb543cdc5d12eb43e%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000114.html">
   <LINK REL="Next"  HREF="000116.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Need a help with sec rule</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Need%20a%20help%20with%20sec%20rule&In-Reply-To=35dfe7b70910130702k55dd1d0alb543cdc5d12eb43e%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Need a help with sec rule">ryan.barnett at breach.com
       </A><BR>
    <I>Tue Oct 13 10:37:01 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000114.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
        <LI>Next message: <A HREF="000116.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#115">[ date ]</a>
              <a href="thread.html#115">[ thread ]</a>
              <a href="subject.html#115">[ subject ]</a>
              <a href="author.html#115">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tuesday 13 October 2009 10:02:16 am unni krishnan wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I was going through the security rules in the server and found this :
</I>&gt;<i>
</I>&gt;<i> ---------------------------------
</I>&gt;<i> SecRule REQUEST_HEADERS:User-Agent &quot;(?:\b(?:(?:indy
</I>&gt;<i> librar|snoop)y|microsoft url control|lynx)\b|d(?:ownload
</I>&gt;<i> demon|isco)|w(?:3mirror|get)|l(?:ibwww|wp)|p(?:avuk|erl)|cu(?:sto|rl)|big
</I>&gt;<i> brother|autohttp|netants|eCatch)&quot; \
</I>&gt;<i>         &quot;chain,log,auditlog,msg:'Request Indicates an automated
</I>&gt;<i> program explored the site',id:'990011',severity:'5'&quot;
</I>&gt;<i> SecRule REQUEST_HEADERS:User-Agent &quot;!^apache.*perl&quot;
</I>&gt;<i> ---------------------------------
</I>&gt;<i>
</I>&gt;<i> As per my knowledge, it just logs the message &quot;Request Indicates an
</I>&gt;<i> automated program explored the site&quot;. But actually it blocks access,
</I>&gt;<i> when accessing the URL using Curl.
</I>&gt;<i>
</I>&gt;<i> ----------------------------------
</I>&gt;<i> ModSecurity: Access denied with code 406 (phase 2). Match of &quot;rx
</I>&gt;<i> ^apache.*perl&quot; against &quot;REQUEST_HEADERS:User-Agent&quot; required. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec2.user.conf&quot;] [line &quot;58&quot;] [id &quot;990011&quot;]
</I>&gt;<i> [msg &quot;Request Indicates an automated program explored the site&quot;]
</I>&gt;<i> [severity &quot;NOTICE&quot;] [uri &quot;/&quot;] [unique_id &quot;StSH9EPeHm4AAB3fCZgAAAAE&quot;]
</I>&gt;<i> ----------------------------------
</I>&gt;<i>
</I>&gt;<i> What is the logic behind that ?
</I>
These are the older CRS.  I suggest that you update to the newer v2 CRS as 
they using anomaly scoring and it is quite easy to then allow these rules to 
slightly increase an anomaly score but to not cause a denial on their own.

-Ryan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091013/e47ef131/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091013/e47ef131/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000114.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
	<LI>Next message: <A HREF="000116.html">[Owasp-modsecurity-core-rule-set] Need a help with sec rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#115">[ date ]</a>
              <a href="thread.html#115">[ thread ]</a>
              <a href="subject.html#115">[ subject ]</a>
              <a href="author.html#115">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
