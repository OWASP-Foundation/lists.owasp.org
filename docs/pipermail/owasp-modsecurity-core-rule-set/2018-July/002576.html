<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Can't process with allowing &quot;application/x-git-upload-pack-request&quot; in CRS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Can%27t%20process%20with%20allowing%0A%20%22application/x-git-upload-pack-request%22%20in%20CRS&In-Reply-To=%3C97934822-11CE-48AE-B5A2-60C7F88D896C%40accenture.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="002577.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Can't process with allowing &quot;application/x-git-upload-pack-request&quot; in CRS</H1>
    <B>Shakitko, Ilia</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Can%27t%20process%20with%20allowing%0A%20%22application/x-git-upload-pack-request%22%20in%20CRS&In-Reply-To=%3C97934822-11CE-48AE-B5A2-60C7F88D896C%40accenture.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Can't process with allowing &quot;application/x-git-upload-pack-request&quot; in CRS">ilia.shakitko at accenture.com
       </A><BR>
    <I>Fri Jul  6 14:53:31 UTC 2018</I>
    <P><UL>
        
        <LI>Next message: <A HREF="002577.html">[Owasp-modsecurity-core-rule-set] Can't process with allowing &quot;application/x-git-upload-pack-request&quot; in CRS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2576">[ date ]</a>
              <a href="thread.html#2576">[ thread ]</a>
              <a href="subject.html#2576">[ subject ]</a>
              <a href="author.html#2576">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi ModSecurity CRS Mailing List members,

I am running into issue with CI for my GitLab. After enabling mod_security (crs-3.0.0), I&#8217;ve got few errors and latest one I am not able to resolve &#8211; it relates to the request content type (application/x-git-upload-pack-request) is not allowed by policy. I found two places where I can add exception to allow content types, but enabling this doesn&#8217;t work -&gt; please see the log below.

Files:
/usr/local/owasp-modsecurity-crs-3.0.0/crs-setup.conf
and
/usr/local/owasp-modsecurity-crs-3.0.0/rules/REQUEST-901-INITIALIZATION.conf

Result is still:

ModSecurity: Warning. Matched &quot;Operator Rx' with parameter^application/x-www-form-urlencoded|multipart/form-data|text/xml|application/xml|application/x-amf|application/json|text/plain|application/x-git-upload-pack-request'$' against variable TX:0' (Value:application/x-git-upload-pack-request' ) [file &quot;/usr/local/owasp-modsecurity-crs-3.0.0/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line &quot;911&quot;] [id &quot;920420&quot;] [rev &quot;2&quot;] [msg &quot;Request content type is not allowed by policy&quot;] [data &quot;application/x-git-upload-pack-request&quot;] [severity &quot;2&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;9&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED&quot;] [tag &quot;WASCTC/WASC-20&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/EE2&quot;] [tag &quot;PCI/12.1&quot;] [hostname &quot;23.100.14.202&quot;] [uri &quot;/ilia.shakitko/pass357.git/git-upload-pack&quot;] [unique_id &quot;153088618260.910992&quot;] [ref &quot;v0,4o0,37o0,37v232,37&quot;]
ModSecurity: Access denied with code 403 (phase 2). Matched &quot;Operator Ge' with parameter5' against variable TX:ANOMALY_SCORE' (Value:5' ) [file &quot;/usr/local/owasp-modsecurity-crs-3.0.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf&quot;] [line &quot;36&quot;] [id &quot;949110&quot;] [rev &quot;&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total Score: 5)&quot;] [data &quot;&quot;] [severity &quot;2&quot;] [ver &quot;&quot;] [maturity &quot;0&quot;] [accuracy &quot;0&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-generic&quot;] [hostname &quot;23.100.14.202&quot;] [uri &quot;/ilia.shakitko/pass357.git/git-upload-pack&quot;] [unique_id &quot;153088618260.910992&quot;] [ref &quot;&quot;]

What am I doing wrong? And how to win the challenge? Looks like the changes I mage should just work&#8230;

Thank you in advance.

Met vriendelijke groet / With kind regards,

Ilia Shakitko



________________________________

This message is for the designated recipient only and may contain privileged, proprietary, or otherwise confidential information. If you have received it in error, please notify the sender immediately and delete the original. Any other use of the e-mail by you is prohibited. Where allowed by local law, electronic communications with Accenture and its affiliates, including e-mail and instant messaging (including content), may be scanned by our systems for the purposes of information security and assessment of internal compliance with Accenture policy. Your privacy is important to us. Accenture uses your personal data only in compliance with data protection laws. For further information on how Accenture processes your personal data, please see our privacy statement at <A HREF="https://www.accenture.com/us-en/privacy-policy.">https://www.accenture.com/us-en/privacy-policy.</A>
______________________________________________________________________________________

www.accenture.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180706/ee396aa0/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180706/ee396aa0/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="002577.html">[Owasp-modsecurity-core-rule-set] Can't process with allowing &quot;application/x-git-upload-pack-request&quot; in CRS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2576">[ date ]</a>
              <a href="thread.html#2576">[ thread ]</a>
              <a href="subject.html#2576">[ subject ]</a>
              <a href="author.html#2576">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
