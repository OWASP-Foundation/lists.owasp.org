<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Modsecurity block JSON
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Modsecurity%20block%20JSON&In-Reply-To=%3CCAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9%2B%2BA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="001812.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Modsecurity block JSON</H1>
    <B>Ilyass Kaouam</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Modsecurity%20block%20JSON&In-Reply-To=%3CCAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9%2B%2BA%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Modsecurity block JSON">ilyassikai at gmail.com
       </A><BR>
    <I>Wed Sep  9 16:24:49 UTC 2015</I>
    <P><UL>
        
        <LI>Next message: <A HREF="001812.html">[Owasp-modsecurity-core-rule-set] Modsecurity block JSON
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1811">[ date ]</a>
              <a href="thread.html#1811">[ thread ]</a>
              <a href="subject.html#1811">[ subject ]</a>
              <a href="author.html#1811">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I have this request :
POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig

with this parameters :
left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
hidden : 0, collapsed : 0 }&amp;right={ mod : 'mod-surveillance-implicit',
hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :  0,
collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, { mod
:<i> 'mod-recherche', hidden :  0, collapsed : 0 }
</I>
When I execute this request modsecurity block my request.


Log :


--1354a526-A--

[09/Sep/2015:17:48:39 +0200] VfBU138AAAEAAFm8PlQAAAAk
&#8203;XXX.XXX.XXX
 53935
&#8203;XXX.XXX.XXX
 80

--1354a526-B--

POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig HTTP/1.1

Host: www.
&#8203;abc
.
&#8203;com&#8203;

User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:40.0)
Gecko/20100101 Firefox/40.0

Accept: */*

Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3

Accept-Encoding: gzip, deflate

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

X-Requested-With: XMLHttpRequest

Referer: <A HREF="http://www.">http://www.</A>
&#8203;abc
.
&#8203;com
/beta/servlet/EspaceClientServlet?plateform=new

Content-Length: 413

Cookie: JSESSIONID=6B370AFFEA03BE2B80F916C5755EEEC5;
__utma=37027576.1259853019.1435675370.1441795926.1441813263.22;
__utmz=37027576.1435675370.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);
style=null; JSESSIONID=DACE18AC3CBA86CAF59264F47E99B028; __utmc=37027576;
__utmb=37027576.3.10.1441813263

Connection: keep-alive

Pragma: no-cache

Cache-Control: no-cache


--1354a526-C--

left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
hidden : 0, collapsed : 0 }&amp;right={ mod : 'mod-surveillance-implicit',
hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, {
mod : 'mod-recherche', hidden :  0, collapsed : 0 }

--1354a526-F--

HTTP/1.1 403 Forbidden

Content-Length: 296

Connection: close

Content-Type: text/html; charset=iso-8859-1


--1354a526-E--


--1354a526-H--

Message: Access denied with code 403 (phase 2). Pattern match
&quot;([\\~\\!\\@\\#\\$\\%\\^\\&amp;\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\&quot;\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\&lt;\\&gt;].*?){4,}&quot;
at ARGS:left. [file
&quot;/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;]
[line &quot;159&quot;] [id &quot;981173&quot;] [rev &quot;2&quot;] [msg &quot;Restricted SQL Character Anomaly
Detection Alert - Total # of special characters exceeded&quot;] [data &quot;Matched
Data: - found within ARGS:left: { mod : 'mod-historique', hidden : 0,
collapsed : 0 }, { mod : 'mod-cercle-inforisk', hidden : 0, collapsed : 0
}, { mod : 'mod-graph', hidden : 0, collapsed : 0 }&quot;] [ver
&quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag
&quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;]

Action: Intercepted (phase 2)

Apache-Handler: proxy-server

Stopwatch: 1441813719351394 3237 (- - -)

Stopwatch2: 1441813719351394 3237; combined=2824, p1=202, p2=2592, p3=0,
p4=0, p5=30, sr=26, sw=0, l=0, gc=0

Response-Body-Transformed: Dechunked

Producer: ModSecurity for Apache/2.7.3 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>);
OWASP_CRS/2.2.9.

Server: Apache/2.2.15 (CentOS) DAV/2

Engine-Mode: &quot;ENABLED&quot;


--1354a526-Z--






Who can I allow like this request safety
&#8203; ?&#8203;

Thank's  &#8203;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150909/b9eb56e4/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150909/b9eb56e4/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="001812.html">[Owasp-modsecurity-core-rule-set] Modsecurity block JSON
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1811">[ date ]</a>
              <a href="thread.html#1811">[ thread ]</a>
              <a href="subject.html#1811">[ subject ]</a>
              <a href="author.html#1811">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
