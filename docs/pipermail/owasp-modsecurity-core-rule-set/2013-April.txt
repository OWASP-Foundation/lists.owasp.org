From leonardo at lbasolutions.com  Tue Apr  2 19:19:49 2013
From: leonardo at lbasolutions.com (Leonardo Bacha Abrantes)
Date: Tue, 2 Apr 2013 16:19:49 -0300
Subject: [Owasp-modsecurity-core-rule-set] complie modsec. for nginx
Message-ID: <CAG+8EEbj=a5TDS0h-Nm-rnvQaVwC4CGixyNtEhmF42PzFvcsFw@mail.gmail.com>

Hi guys,

I installed nginx for the repo and now am trying to compile modsecurity,
however, I received the message about apxs.
The machine does not have apache installed, only nginx.

#./configure --enable-standalone-module

configure: looking for Apache module support via DSO through APXS
configure: error: couldn't find APXS

is there an way to workaround ?

many thanks!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130402/1fa97329/attachment.html>

From RBarnett at trustwave.com  Tue Apr  2 19:26:29 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Tue, 2 Apr 2013 19:26:29 +0000
Subject: [Owasp-modsecurity-core-rule-set] complie modsec. for nginx
In-Reply-To: <CAG+8EEbj=a5TDS0h-Nm-rnvQaVwC4CGixyNtEhmF42PzFvcsFw@mail.gmail.com>
Message-ID: <01987910BF74B341B5890120BCCE77DF37D8D9@SKYMB1.trustwave.com>

Leonardo,
This list is for the OWASP ModSecurity CRS.  You should sign up for the ModSecurity users mail-list here -
https://lists.sourceforge.net/lists/listinfo/mod-security-users

-Ryan


From: Leonardo Bacha Abrantes <leonardo at lbasolutions.com<mailto:leonardo at lbasolutions.com>>
Date: Tuesday, April 2, 2013 3:19 PM
To: OWASP Mod Security <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] complie modsec. for nginx

Hi guys,

I installed nginx for the repo and now am trying to compile modsecurity, however, I received the message about apxs.
The machine does not have apache installed, only nginx.

#./configure --enable-standalone-module

configure: looking for Apache module support via DSO through APXS
configure: error: couldn't find APXS

is there an way to workaround ?

many thanks!
_______________________________________________ Owasp-modsecurity-core-rule-set mailing list Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130402/4128790f/attachment.html>

From shaifful at joomla.my  Wed Apr  3 04:21:36 2013
From: shaifful at joomla.my (Shaiffulnizam Mohamad)
Date: Wed, 3 Apr 2013 12:21:36 +0800
Subject: [Owasp-modsecurity-core-rule-set] complie modsec. for nginx
In-Reply-To: <01987910BF74B341B5890120BCCE77DF37D8D9@SKYMB1.trustwave.com>
References: <CAG+8EEbj=a5TDS0h-Nm-rnvQaVwC4CGixyNtEhmF42PzFvcsFw@mail.gmail.com>
	<01987910BF74B341B5890120BCCE77DF37D8D9@SKYMB1.trustwave.com>
Message-ID: <CAHc6GbHFRur8YAv_sXQRRenB1At0svybS_S8ycYChNJLbzU_Sw@mail.gmail.com>

I think you can just install httpd-devel :) and remove it after that.


On Wed, Apr 3, 2013 at 3:26 AM, Ryan Barnett <RBarnett at trustwave.com> wrote:

>  Leonardo,
> This list is for the OWASP ModSecurity CRS.  You should sign up for the
> ModSecurity users mail-list here -
> https://lists.sourceforge.net/lists/listinfo/mod-security-users
>
>  -Ryan
>
>
>   From: Leonardo Bacha Abrantes <leonardo at lbasolutions.com>
> Date: Tuesday, April 2, 2013 3:19 PM
> To: OWASP Mod Security <owasp-modsecurity-core-rule-set at lists.owasp.org>
> Subject: [Owasp-modsecurity-core-rule-set] complie modsec. for nginx
>
>  Hi guys,
>
> I installed nginx for the repo and now am trying to compile modsecurity,
> however, I received the message about apxs.
> The machine does not have apache installed, only nginx.
>
> #./configure --enable-standalone-module
>
> configure: looking for Apache module support via DSO through APXS
> configure: error: couldn't find APXS
>
> is there an way to workaround ?
>
> many thanks!
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
> ------------------------------
>
> This transmission may contain information that is privileged,
> confidential, and/or exempt from disclosure under applicable law. If you
> are not the intended recipient, you are hereby notified that any
> disclosure, copying, distribution, or use of the information contained
> herein (including any reliance thereon) is STRICTLY PROHIBITED. If you
> received this transmission in error, please immediately contact the sender
> and destroy the material in its entirety, whether in electronic or hard
> copy format.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130403/bf58815c/attachment.html>

From RBarnett at trustwave.com  Fri Apr  5 15:55:45 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Fri, 5 Apr 2013 15:55:45 +0000
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity User Survey 2013
Message-ID: <01987910BF74B341B5890120BCCE77DF3826A8@SKYMB1.trustwave.com>

The ModSecurity web application firewall project has grown a lot in the past year including, releasing versions for both Microsoft IIS and Nginx web server platforms and migrating the source code to SpiderLabs GitHub Repo<https://github.com/SpiderLabs/ModSecurity>.  We even won some community awards<http://holisticinfosec.blogspot.com/2013/02/2012-toolsmith-tool-of-year-modsecurity.html> and WAF comparison tests<http://zeroscience.mk/files/wafreport2013.pdf>.  It is good to look back on past accomplishments but it is also important to look ahead.  Where will ModSecurity go in the future?

As part of this effort, the ModSecurity Team in SpiderLabs Research has developed a new user survey for 2013.

Click here to take survey<http://www.surveymonkey.com/s/GRBN3TN>.

If you are a user of ModSecurity, I encourage you to take the Survey as it will give us a better understanding of how ModSecurity is being used and also get feedback on what we are doing well and what we need to improve.  It is only 15 questions.  As an added incentive, you can also enter your email address into a Raffle to win a copy of my new book "The Web Application Defender's Cookbook: Battling Hackers and Protecting Users<http://www.amazon.com/Web-Application-Defenders-Cookbook-Protecting/dp/1118362187>."

Thanks for using ModSecurity and for helping us to make it better!

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130405/480073de/attachment.html>

From danieljamesscott at gmail.com  Mon Apr  8 13:40:55 2013
From: danieljamesscott at gmail.com (Dan Scott)
Date: Mon, 8 Apr 2013 14:40:55 +0100
Subject: [Owasp-modsecurity-core-rule-set] 200 HTTP code returned despite
	log showing 403
Message-ID: <CANQKhh=1p5crtqowyFcLBn2+dEMTam4=U4pJkxgYutNFQ19uTw@mail.gmail.com>

Hi,

I'm running Apache 2.2.24 with mod_security 2.7.1 and CRS 2.2.6. I've
added a file to whitelist some urls, and to ignore some SQL injection
rules which are required for correct operation of our application.

I've noticed a strange issue with rule 960015, the accept header
check. If I access a page, such as index.html, on the site using curl
from the command line, then everything works correctly, and I receive
a 403 response because curl is not setting the accept header.

However, if I access the root of the site "/", then I see the correct
entry in the error_log (ModSecurity: Access denied with code 403
(phase 2). Operator EQ matched 0 at REQUEST_HEADERS.), but my access
log shows a 200 return code, and I receive the page back from the
server, despite not setting the request header.

To re-iterate, mod_security seems to be working correctly for all
pages except the root of the site. Is there something that I'm
missing? Why would mod_security still log a 403 error, but not
actually block the request?

Thanks,

Dan Scott

From RBarnett at trustwave.com  Mon Apr  8 18:31:03 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 8 Apr 2013 18:31:03 +0000
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity User Survey 2013
In-Reply-To: <01987910BF74B341B5890120BCCE77DF3826A8@SKYMB1.trustwave.com>
Message-ID: <01987910BF74B341B5890120BCCE77DF385EA0@SKYMB1.trustwave.com>

Resending to the lists.  We have over 1300 subscribers for the ModSecurity User mail-list and we have only had about 90 people complete the survey so far?

I know that everyone is busy but if you can carve out 5 mins during a coffee break or something it would be really appreciated.  We want to know what you like about ModSecurity and how we can make it better.

Thanks everyone.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

From: Ryan Barnett <rbarnett at trustwave.com<mailto:rbarnett at trustwave.com>>
Date: Friday, April 5, 2013 11:55 AM
To: "mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>" <mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>>, OWASP Mod Security <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: ModSecurity User Survey 2013


The ModSecurity web application firewall project has grown a lot in the past year including, releasing versions for both Microsoft IIS and Nginx web server platforms and migrating the source code to SpiderLabs GitHub Repo<https://github.com/SpiderLabs/ModSecurity>.  We even won some community awards<http://holisticinfosec.blogspot.com/2013/02/2012-toolsmith-tool-of-year-modsecurity.html> and WAF comparison tests<http://zeroscience.mk/files/wafreport2013.pdf>.  It is good to look back on past accomplishments but it is also important to look ahead.  Where will ModSecurity go in the future?

As part of this effort, the ModSecurity Team in SpiderLabs Research has developed a new user survey for 2013.

Click here to take survey<http://www.surveymonkey.com/s/GRBN3TN>.

If you are a user of ModSecurity, I encourage you to take the Survey as it will give us a better understanding of how ModSecurity is being used and also get feedback on what we are doing well and what we need to improve.  It is only 15 questions.  As an added incentive, you can also enter your email address into a Raffle to win a copy of my new book "The Web Application Defender's Cookbook: Battling Hackers and Protecting Users<http://www.amazon.com/Web-Application-Defenders-Cookbook-Protecting/dp/1118362187>."

Thanks for using ModSecurity and for helping us to make it better!

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130408/4f38eb5e/attachment.html>

From mike at gotroot.com  Tue Apr  9 06:30:11 2013
From: mike at gotroot.com (Michael Shinn)
Date: Tue, 9 Apr 2013 01:30:11 -0500
Subject: [Owasp-modsecurity-core-rule-set] [mod-security-users]
	ModSecurity User Survey 2013
In-Reply-To: <CAHhRxHL4+mAU3S-vuT-0K+-aFvp0-fYstQvCytKd3S7Q2qsQbg@mail.gmail.com>
References: <01987910BF74B341B5890120BCCE77DF3826A8@SKYMB1.trustwave.com>
	<01987910BF74B341B5890120BCCE77DF385EA0@SKYMB1.trustwave.com>
	<CAHhRxHL4+mAU3S-vuT-0K+-aFvp0-fYstQvCytKd3S7Q2qsQbg@mail.gmail.com>
Message-ID: <3919041F-CD27-43F1-BA34-1022F59A1255@gotroot.com>

Centos nginx 1.2.8 with modsecurity RPMs:

http://atomicorp.com/forums/viewtopic.php?f=12&t=6706


On Apr 8, 2013, at 17:20, James Ruffer <admin at unixbox.ws> wrote:

> We are looking for some help getting modsec running with Nginx on a new centos server built on Rackspace.  We are looking for someone to help us for a couple of hours to get through the build.  If there are any newer tools that could help our programmers on what rules they are breaking by syncing with our repository logs that would be amazing but right now we just need it built and running correctly. 
> 
> Thank you for your time.
> James F. Ruffer III
> C|EH
> 1.312.238.8571  Mobile
> 
> 
> 
> On Mon, Apr 8, 2013 at 1:31 PM, Ryan Barnett <RBarnett at trustwave.com> wrote:
>> Resending to the lists.  We have over 1300 subscribers for the ModSecurity User mail-list and we have only had about 90 people complete the survey so far?
>> 
>> I know that everyone is busy but if you can carve out 5 mins during a coffee break or something it would be really appreciated.  We want to know what you like about ModSecurity and how we can make it better.
>> 
>> Thanks everyone.
>> 
>> --
>> Ryan Barnett
>> Trustwave SpiderLabs
>> ModSecurity Project Leader
>> OWASP ModSecurity CRS Project Leader
>> 
>> From: Ryan Barnett <rbarnett at trustwave.com>
>> Date: Friday, April 5, 2013 11:55 AM
>> To: "mod-security-users at lists.sourceforge.net" <mod-security-users at lists.sourceforge.net>, OWASP Mod Security <owasp-modsecurity-core-rule-set at lists.owasp.org>
>> Subject: ModSecurity User Survey 2013
>> 
>> The ModSecurity web application firewall project has grown a lot in the past year including, releasing versions for both Microsoft IIS and Nginx web server platforms and migrating the source code to SpiderLabs GitHub Repo.  We even won some community awards and WAF comparison tests.  It is good to look back on past accomplishments but it is also important to look ahead.  Where will ModSecurity go in the future?
>> 
>> As part of this effort, the ModSecurity Team in SpiderLabs Research has developed a new user survey for 2013.  
>> 
>> Click here to take survey.
>> If you are a user of ModSecurity, I encourage you to take the Survey as it will give us a better understanding of how ModSecurity is being used and also get feedback on what we are doing well and what we need to improve.  It is only 15 questions.  As an added incentive, you can also enter your email address into a Raffle to win a copy of my new book "The Web Application Defender's Cookbook: Battling Hackers and Protecting Users."
>> 
>> Thanks for using ModSecurity and for helping us to make it better!
>> 
>> --
>> Ryan Barnett
>> Trustwave SpiderLabs
>> ModSecurity Project Leader
>> OWASP ModSecurity CRS Project Leader
>> 
>> 
>> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
>> 
>> ------------------------------------------------------------------------------
>> Minimize network downtime and maximize team effectiveness.
>> Reduce network management and security costs.Learn how to hire
>> the most talented Cisco Certified professionals. Visit the
>> Employer Resources Portal
>> http://www.cisco.com/web/learning/employer_resources/index.html
>> _______________________________________________
>> mod-security-users mailing list
>> mod-security-users at lists.sourceforge.net
>> https://lists.sourceforge.net/lists/listinfo/mod-security-users
>> Commercial ModSecurity Rules and Support from Trustwave's SpiderLabs:
>> http://www.modsecurity.org/projects/commercial/rules/
>> http://www.modsecurity.org/projects/commercial/support/
> 
> ------------------------------------------------------------------------------
> Minimize network downtime and maximize team effectiveness.
> Reduce network management and security costs.Learn how to hire 
> the most talented Cisco Certified professionals. Visit the 
> Employer Resources Portal
> http://www.cisco.com/web/learning/employer_resources/index.html
> _______________________________________________
> mod-security-users mailing list
> mod-security-users at lists.sourceforge.net
> https://lists.sourceforge.net/lists/listinfo/mod-security-users
> Commercial ModSecurity Rules and Support from Trustwave's SpiderLabs:
> http://www.modsecurity.org/projects/commercial/rules/
> http://www.modsecurity.org/projects/commercial/support/
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130409/176a04b3/attachment-0001.html>

From jamuse at owasp.org  Tue Apr  9 11:30:36 2013
From: jamuse at owasp.org (Josh Amishav-Zlatin)
Date: Tue, 9 Apr 2013 14:30:36 +0300
Subject: [Owasp-modsecurity-core-rule-set] 200 HTTP code returned
 despite log showing 403
In-Reply-To: <CANQKhh=1p5crtqowyFcLBn2+dEMTam4=U4pJkxgYutNFQ19uTw@mail.gmail.com>
References: <CANQKhh=1p5crtqowyFcLBn2+dEMTam4=U4pJkxgYutNFQ19uTw@mail.gmail.com>
Message-ID: <CAC+O4mHER6=ZF3-bKe7sW9Ogz9tk1hpLcyGv_UiNsvK7iFfuxw@mail.gmail.com>

On Mon, Apr 8, 2013 at 4:40 PM, Dan Scott <danieljamesscott at gmail.com>wrote:

>
> To re-iterate, mod_security seems to be working correctly for all
> pages except the root of the site. Is there something that I'm
> missing? Why would mod_security still log a 403 error, but not
> actually block the request?
>
>
Hi Dan,

Good question. Have you tried increasing the SecDebugLogLevel to 9 and look
in the debug log? Is there an audit log produced?

--
 - Josh
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130409/f7ae7b15/attachment.html>

From danieljamesscott at gmail.com  Tue Apr  9 18:14:51 2013
From: danieljamesscott at gmail.com (Dan Scott)
Date: Tue, 9 Apr 2013 19:14:51 +0100
Subject: [Owasp-modsecurity-core-rule-set] 200 HTTP code returned
 despite log showing 403
In-Reply-To: <CAC+O4mHER6=ZF3-bKe7sW9Ogz9tk1hpLcyGv_UiNsvK7iFfuxw@mail.gmail.com>
References: <CANQKhh=1p5crtqowyFcLBn2+dEMTam4=U4pJkxgYutNFQ19uTw@mail.gmail.com>
	<CAC+O4mHER6=ZF3-bKe7sW9Ogz9tk1hpLcyGv_UiNsvK7iFfuxw@mail.gmail.com>
Message-ID: <CANQKhh=yPG7PHgszgBe=KDzQek=M6Bpa4VfRsAuJvBMoHW2FgA@mail.gmail.com>

Hi,

Thanks for the reply. I have figured out the problem. I had a config
file with a locationmatch for '/'. In the config, it defined an
ErrorHandler 403 which actually ends up returning a 200 because of the
error document. So, the browser showed the correct page, and a command
line client triggered the 403 which actually ended up as a 200 because
of the ErrorHandler! The clue was that the actual page returned was
different. I only noticed this when I enabled verbose mode on the
command line.

Thanks,

Dan

On 9 April 2013 12:30, Josh Amishav-Zlatin <jamuse at owasp.org> wrote:
> On Mon, Apr 8, 2013 at 4:40 PM, Dan Scott <danieljamesscott at gmail.com>
> wrote:
>>
>>
>> To re-iterate, mod_security seems to be working correctly for all
>> pages except the root of the site. Is there something that I'm
>> missing? Why would mod_security still log a 403 error, but not
>> actually block the request?
>>
>
> Hi Dan,
>
> Good question. Have you tried increasing the SecDebugLogLevel to 9 and look
> in the debug log? Is there an audit log produced?
>
> --
>  - Josh

From RBarnett at trustwave.com  Wed Apr 10 13:39:52 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 10 Apr 2013 13:39:52 +0000
Subject: [Owasp-modsecurity-core-rule-set] Seeking College Students for
 Google Summer of Code (GSoC) to work on ModSecurity Features
Message-ID: <01987910BF74B341B5890120BCCE77DF387B92@SKYMB1.trustwave.com>

For any college students on the mail-list, or if you know of any college students who might be interested please pass this along.

OWASP has been accepted as a participating organization in the Google Summer of Code (GSoC) 2013 program - https://www.owasp.org/index.php/GSoC.  The OWASP ModSecurity Core Rule Set (CRS) is participating and we have listed many different development task ideas here - https://www.owasp.org/index.php/GSoC2013_Ideas.  These new features can then be used by the CRS to help with protections.

Please spread the word!

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130410/107e1c9a/attachment.html>

From pegalinux at gmail.com  Sun Apr 14 02:00:52 2013
From: pegalinux at gmail.com (Linu-Linu)
Date: Sun, 14 Apr 2013 10:00:52 +0800
Subject: [Owasp-modsecurity-core-rule-set] collection_retrieve_ex: Unable to
	retrieve collection
Message-ID: <CAHs0d685+GWgKGhxsfW+uzZZ41N=8+pb+misb-NzqCvejbakqg@mail.gmail.com>

Dear sir,
I newbie in Owasp


i have error messages:

--d494c82f-H--
Message: collection_retrieve_ex: Unable to retrieve collection (name
"global", key "global"). Use SecDataDir to define data directory first.
Message: collection_retrieve_ex: Unable to retrieve collection (name "ip",
key "66.249.76.221_59c3d4f2509c82627f0eeb8e0e13ae1254eb4065"). Use
SecDataDir to define data directory first.
Message: collection_store: Unable to store collection (name "ip", key
"66.249.76.221_59c3d4f2509c82627f0eeb8e0e13ae1254eb4065"). Use SecDataDir
to define data directory first.
Stopwatch: 1365903677079395 894955 (- - -)
Stopwatch2: 1365903677079395 894955; combined=259572, p1=258166, p2=1214,
p3=7, p4=91, p5=61, sr=45, sw=33, l=0, gc=0
Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
OWASP_CRS/2.2.7.
Server: Apache/2.2.24 (Unix) mod_ssl/2.2.24 OpenSSL/1.0.0-fips
mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635
Engine-Mode: "ENABLED"


how to fix it.

Regards
wayan
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130414/3580f36c/attachment.html>

From jamuse at owasp.org  Sun Apr 14 07:10:49 2013
From: jamuse at owasp.org (Josh Amishav-Zlatin)
Date: Sun, 14 Apr 2013 10:10:49 +0300
Subject: [Owasp-modsecurity-core-rule-set] collection_retrieve_ex:
 Unable to retrieve collection
In-Reply-To: <CAHs0d685+GWgKGhxsfW+uzZZ41N=8+pb+misb-NzqCvejbakqg@mail.gmail.com>
References: <CAHs0d685+GWgKGhxsfW+uzZZ41N=8+pb+misb-NzqCvejbakqg@mail.gmail.com>
Message-ID: <CAC+O4mF9ESn2fwNepgg=FO4eKE3yCCCBfUzZ9w1UokN8=WP6sg@mail.gmail.com>

On Sun, Apr 14, 2013 at 5:00 AM, Linu-Linu <pegalinux at gmail.com> wrote:

> Dear sir,
> I newbie in Owasp
>
>
> i have error messages:
>
> --d494c82f-H--
> Message: collection_retrieve_ex: Unable to retrieve collection (name
> "global", key "global"). Use SecDataDir to define data directory first.
> Message: collection_retrieve_ex: Unable to retrieve collection (name "ip",
> key "66.249.76.221_59c3d4f2509c82627f0eeb8e0e13ae1254eb4065"). Use
> SecDataDir to define data directory first.
> Message: collection_store: Unable to store collection (name "ip", key "
> 66.249.76.221_59c3d4f2509c82627f0eeb8e0e13ae1254eb4065"). Use SecDataDir
> to define data directory first.
> Stopwatch: 1365903677079395 894955 (- - -)
> Stopwatch2: 1365903677079395 894955; combined=259572, p1=258166, p2=1214,
> p3=7, p4=91, p5=61, sr=45, sw=33, l=0, gc=0
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> OWASP_CRS/2.2.7.
> Server: Apache/2.2.24 (Unix) mod_ssl/2.2.24 OpenSSL/1.0.0-fips
> mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635
> Engine-Mode: "ENABLED"
>
>
Hi Wayan,

Your missing the SecDataDir directive which is normally set in the base
configuration. For an example base configuration see:
https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-A_Recommended_Base_Configuration

--
 - Josh



> how to fix it.
>
> Regards
> wayan
>
>
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130414/dff30675/attachment.html>

From pdavicino at gmail.com  Mon Apr 15 00:31:12 2013
From: pdavicino at gmail.com (Pablo Davicino)
Date: Sun, 14 Apr 2013 21:31:12 -0300
Subject: [Owasp-modsecurity-core-rule-set] collection_retrieve_ex:
 Unable to retrieve collection
In-Reply-To: <CAC+O4mF9ESn2fwNepgg=FO4eKE3yCCCBfUzZ9w1UokN8=WP6sg@mail.gmail.com>
References: <CAHs0d685+GWgKGhxsfW+uzZZ41N=8+pb+misb-NzqCvejbakqg@mail.gmail.com>
	<CAC+O4mF9ESn2fwNepgg=FO4eKE3yCCCBfUzZ9w1UokN8=WP6sg@mail.gmail.com>
Message-ID: <CACudb-OhdGPDtbkMBbCvu61qagVWELx0JEqnk55H_GECFoRYTA@mail.gmail.com>

Hi Wayan, Josh is right.

Among other things, you have to make decisions about file system locations
of modsecurity files.
You specify the location where modsecurity will keep its data using the
SecDataDir directive. Also, you specify the location where modsecurity will
store temporary files using the SecTmpDir directive.

The configuration example uses /tmp for both. This is a personal one, but i
recommend you to put that files in a special diectory (for example,
/var/opt/modsecurity) and restrict ownership, group and file permissions
only for root and apache...  ;)

Regards,
Pablo.-


On Sun, Apr 14, 2013 at 4:10 AM, Josh Amishav-Zlatin <jamuse at owasp.org>wrote:

> On Sun, Apr 14, 2013 at 5:00 AM, Linu-Linu <pegalinux at gmail.com> wrote:
>
>> Dear sir,
>> I newbie in Owasp
>>
>>
>> i have error messages:
>>
>> --d494c82f-H--
>> Message: collection_retrieve_ex: Unable to retrieve collection (name
>> "global", key "global"). Use SecDataDir to define data directory first.
>> Message: collection_retrieve_ex: Unable to retrieve collection (name
>> "ip", key "66.249.76.221_59c3d4f2509c82627f0eeb8e0e13ae1254eb4065"). Use
>> SecDataDir to define data directory first.
>> Message: collection_store: Unable to store collection (name "ip", key "
>> 66.249.76.221_59c3d4f2509c82627f0eeb8e0e13ae1254eb4065"). Use SecDataDir
>> to define data directory first.
>> Stopwatch: 1365903677079395 894955 (- - -)
>> Stopwatch2: 1365903677079395 894955; combined=259572, p1=258166, p2=1214,
>> p3=7, p4=91, p5=61, sr=45, sw=33, l=0, gc=0
>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>> OWASP_CRS/2.2.7.
>> Server: Apache/2.2.24 (Unix) mod_ssl/2.2.24 OpenSSL/1.0.0-fips
>> mod_auth_passthrough/2.1 mod_bwlimited/1.4 FrontPage/5.0.2.2635
>> Engine-Mode: "ENABLED"
>>
>>
> Hi Wayan,
>
> Your missing the SecDataDir directive which is normally set in the base
> configuration. For an example base configuration see:
>
> https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-A_Recommended_Base_Configuration
>
> --
>  - Josh
>
>
>
>> how to fix it.
>>
>> Regards
>> wayan
>>
>>
>>
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>
>>
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130414/5993d027/attachment.html>

From colin.watson at owasp.org  Mon Apr 15 15:50:18 2013
From: colin.watson at owasp.org (Colin Watson)
Date: Mon, 15 Apr 2013 16:50:18 +0100
Subject: [Owasp-modsecurity-core-rule-set] AppSensor cross-referencing
In-Reply-To: <CD5E5239.78F1D%ryan.barnett@owasp.org>
References: <CAAxdBBnDkZcxj25ZoS0B9dZYoVvi-zfc-m5UjNrUjAJNT__5aA@mail.gmail.com>
	<CD5E5239.78F1D%ryan.barnett@owasp.org>
Message-ID: <CAAxdBBn+3Qarsm5_6GvL3B2td+5+G-=LDmEbB+E5rWAL+mR9rg@mail.gmail.com>

Sorry for the delay... noted.

Colin


On 7 March 2013 19:18, Ryan Barnett <ryan.barnett at owasp.org> wrote:

> FYI - I have updated the reference links in the CRS -
> https://github.com/SpiderLabs/owasp-modsecurity-crs/commit/40b2c758ce5f105c
> 45e8523c74c94a9d11ce1add
>
>
> -Ryan
>
> On 2/22/13 11:09 AM, "Colin Watson" <colin.watson at owasp.org> wrote:
>
> >I have updated the AppSensor Detection Point wiki page to reflect what
> >is tagged in CRS v2.2.7:
> >
> >  https://www.owasp.org/index.php/AppSensor_DetectionPoints
> >
> >Note this OWASP page now also has new IDs added like:
> >
> >   RE
> >   RE1
> >   RE2
> >   ...
> >   RP3
> >   RP4
> >
> >and so the embedded links in the CRS such as:
> >
> >
> >...tag:'OWASP_AppSensor/RP3',tag:'
> https://www.owasp.org/index.php/AppSenso
> >r_DetectionPoints#RP3:_Suspicious_Client-Side_Behavior'"
> >
> >could optionally be changed to the additional shorter code like:
> >
> >
> >...tag:'OWASP_AppSensor/RP3',tag:'
> https://www.owasp.org/index.php/AppSenso
> >r_DetectionPoints#RP3'"
> >
> >This would mean that any changes to the names of the AppSensor
> >detection points wouldn't affect the links in CRS. But there are no
> >name changes planned by me!
> >
> >Colin
> >_______________________________________________
> >Owasp-modsecurity-core-rule-set mailing list
> >Owasp-modsecurity-core-rule-set at lists.owasp.org
> >https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130415/18051c3d/attachment.html>

From saneeshc at scigenom.com  Wed Apr 17 12:32:19 2013
From: saneeshc at scigenom.com (SANEESH)
Date: Wed, 17 Apr 2013 18:02:19 +0530
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks
	Google_Analytics_Content_Experiments
Message-ID: <516E9653.2000709@scigenom.com>

Hi,
Am trying to integrate Google_Analytics_Content_Experiments to my webpages, when trying the Analytic test am getting "We encountered an error while trying to connect to the server with your web pages (HTTP status: 403)". I found this is because mod_security is blocking the request..Please check the below log for more details..I tried to add exception for "user Agent: Google_Analytics_Content_Experiments", but no luck..Please help.


Log:
[17/Apr/2013:07:26:18 --0400] wSzSgUDPmqEAABafQXYAAAAA 74.125.186.151 54656 64.207.154.161 80
--e29d6a3c-B--
GET /pro-membership2 HTTP/1.1
User-Agent: Google_Analytics_Content_Experiments (http://support.google.com/analytics/bin/answer.py?topic=1745208&answer=1665377)
Host:www.test.com
Accept-Encoding: gzip
--e29d6a3c-F--
HTTP/1.1 403 Forbidden
Last-Modified: Wed, 25 May 2011 01:34:04 GMT
ETag: "1c00603-3c2-4a40fb3273b00"
Accept-Ranges: bytes
Vary: Accept-Encoding,User-Agent
Content-Encoding: gzip
X-Powered-By: PleskLin
Content-Length: 553
Connection: close
Content-Type: text/html
--e29d6a3c-H--
Message: Access denied with code 403 (phase 2). Operator EQ matched 0 at REQUEST_HEADERS. [file "/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_21_protocol_anomalies.conf"] [line "47"] [id "960015"] [rev "2.2.5"] [msg "Request Missing an Accept Header"] [severity "CRITICAL"] [tag "PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT"] [tag "WASCTC/WASC-21"] [tag "OWASP_TOP_10/A7"] [tag "PCI/6.5.10"]
Action: Intercepted (phase 2)
Stopwatch: 1366197978059393 1535 (- - -)
Stopwatch2: 1366197978059393 1535; combined=388, p1=262, p2=86, p3=0, p4=0, p5=40, sr=99, sw=0, l=0, gc=0
Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/); OWASP_CRS/2.2.5.
Server: Apache



  Rgrds,
Saneesh C.


From RBarnett at trustwave.com  Wed Apr 17 12:50:12 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 17 Apr 2013 12:50:12 +0000
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security
	Blocks	Google_Analytics_Content_Experiments
In-Reply-To: <516E9653.2000709@scigenom.com>
References: <516E9653.2000709@scigenom.com>
Message-ID: <01987910BF74B341B5890120BCCE77DFD36A36@SKYMB1.trustwave.com>

Saneesh,
You should be able to do an exception for this.  What was your exception that you tried?

-Ryan
________________________________________
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] on behalf of SANEESH [saneeshc at scigenom.com]
Sent: Wednesday, April 17, 2013 8:32 AM
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks  Google_Analytics_Content_Experiments

Hi,
Am trying to integrate Google_Analytics_Content_Experiments to my webpages, when trying the Analytic test am getting "We encountered an error while trying to connect to the server with your web pages (HTTP status: 403)". I found this is because mod_security is blocking the request..Please check the below log for more details..I tried to add exception for "user Agent: Google_Analytics_Content_Experiments", but no luck..Please help.


Log:
[17/Apr/2013:07:26:18 --0400] wSzSgUDPmqEAABafQXYAAAAA 74.125.186.151 54656 64.207.154.161 80
--e29d6a3c-B--
GET /pro-membership2 HTTP/1.1
User-Agent: Google_Analytics_Content_Experiments (http://support.google.com/analytics/bin/answer.py?topic=1745208&answer=1665377)
Host:www.test.com
Accept-Encoding: gzip
--e29d6a3c-F--
HTTP/1.1 403 Forbidden
Last-Modified: Wed, 25 May 2011 01:34:04 GMT
ETag: "1c00603-3c2-4a40fb3273b00"
Accept-Ranges: bytes
Vary: Accept-Encoding,User-Agent
Content-Encoding: gzip
X-Powered-By: PleskLin
Content-Length: 553
Connection: close
Content-Type: text/html
--e29d6a3c-H--
Message: Access denied with code 403 (phase 2). Operator EQ matched 0 at REQUEST_HEADERS. [file "/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_21_protocol_anomalies.conf"] [line "47"] [id "960015"] [rev "2.2.5"] [msg "Request Missing an Accept Header"] [severity "CRITICAL"] [tag "PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT"] [tag "WASCTC/WASC-21"] [tag "OWASP_TOP_10/A7"] [tag "PCI/6.5.10"]
Action: Intercepted (phase 2)
Stopwatch: 1366197978059393 1535 (- - -)
Stopwatch2: 1366197978059393 1535; combined=388, p1=262, p2=86, p3=0, p4=0, p5=40, sr=99, sw=0, l=0, gc=0
Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/); OWASP_CRS/2.2.5.
Server: Apache



  Rgrds,
Saneesh C.

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From saneeshc at scigenom.com  Wed Apr 17 12:56:33 2013
From: saneeshc at scigenom.com (SANEESH)
Date: Wed, 17 Apr 2013 18:26:33 +0530
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks
	Google_Analytics_Content_Experiments
In-Reply-To: <01987910BF74B341B5890120BCCE77DFD36A36@SKYMB1.trustwave.com>
References: <516E9653.2000709@scigenom.com>
	<01987910BF74B341B5890120BCCE77DFD36A36@SKYMB1.trustwave.com>
Message-ID: <516E9C01.2010507@scigenom.com>

Hi Ryan,
Thanks, i tried the simple Secrule below,

SecRule REQUEST_HEADERS:User-Agent 
"Google_Analytics_Content_Experiments" "log,allow"

Can you refer the correct method to do it..

Saneesh.

On 17-04-2013 18:20, Ryan Barnett wrote:
> Saneesh,
> You should be able to do an exception for this.  What was your exception that you tried?
>
> -Ryan
> ________________________________________
> From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] on behalf of SANEESH [saneeshc at scigenom.com]
> Sent: Wednesday, April 17, 2013 8:32 AM
> To: owasp-modsecurity-core-rule-set at lists.owasp.org
> Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks  Google_Analytics_Content_Experiments
>
> Hi,
> Am trying to integrate Google_Analytics_Content_Experiments to my webpages, when trying the Analytic test am getting "We encountered an error while trying to connect to the server with your web pages (HTTP status: 403)". I found this is because mod_security is blocking the request..Please check the below log for more details..I tried to add exception for "user Agent: Google_Analytics_Content_Experiments", but no luck..Please help.
>
>
> Log:
> [17/Apr/2013:07:26:18 --0400] wSzSgUDPmqEAABafQXYAAAAA 74.125.186.151 54656 64.207.154.161 80
> --e29d6a3c-B--
> GET /pro-membership2 HTTP/1.1
> User-Agent: Google_Analytics_Content_Experiments (http://support.google.com/analytics/bin/answer.py?topic=1745208&answer=1665377)
> Host:www.test.com
> Accept-Encoding: gzip
> --e29d6a3c-F--
> HTTP/1.1 403 Forbidden
> Last-Modified: Wed, 25 May 2011 01:34:04 GMT
> ETag: "1c00603-3c2-4a40fb3273b00"
> Accept-Ranges: bytes
> Vary: Accept-Encoding,User-Agent
> Content-Encoding: gzip
> X-Powered-By: PleskLin
> Content-Length: 553
> Connection: close
> Content-Type: text/html
> --e29d6a3c-H--
> Message: Access denied with code 403 (phase 2). Operator EQ matched 0 at REQUEST_HEADERS. [file "/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_21_protocol_anomalies.conf"] [line "47"] [id "960015"] [rev "2.2.5"] [msg "Request Missing an Accept Header"] [severity "CRITICAL"] [tag "PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT"] [tag "WASCTC/WASC-21"] [tag "OWASP_TOP_10/A7"] [tag "PCI/6.5.10"]
> Action: Intercepted (phase 2)
> Stopwatch: 1366197978059393 1535 (- - -)
> Stopwatch2: 1366197978059393 1535; combined=388, p1=262, p2=86, p3=0, p4=0, p5=40, sr=99, sw=0, l=0, gc=0
> Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/); OWASP_CRS/2.2.5.
> Server: Apache
>
>
>
>    Rgrds,
> Saneesh C.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
> ________________________________
>
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
>
>


From RBarnett at trustwave.com  Wed Apr 17 13:05:22 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 17 Apr 2013 13:05:22 +0000
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks
 Google_Analytics_Content_Experiments
In-Reply-To: <516E9C01.2010507@scigenom.com>
References: <516E9653.2000709@scigenom.com>
	<01987910BF74B341B5890120BCCE77DFD36A36@SKYMB1.trustwave.com>,
	<516E9C01.2010507@scigenom.com>
Message-ID: <01987910BF74B341B5890120BCCE77DFD36ABE@SKYMB1.trustwave.com>

You want to do a conditional exception to disable the offending rule ID.  Put this in base_rules/modsecurity_crs_15_custom.conf so that is runs before the other CRS rules -

SecRule REQUEST_HEADERS:User-Agent "@beginsWith Google_Analytics_Content_Experiments" "id:1,phase:1,t:none,nolog,pass,ctl:ruleRemoveById=960015"

--
Ryan Barnett

________________________________________
From: SANEESH [saneeshc at scigenom.com]
Sent: Wednesday, April 17, 2013 8:56 AM
To: Ryan Barnett
Cc: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks Google_Analytics_Content_Experiments

Hi Ryan,
Thanks, i tried the simple Secrule below,

SecRule REQUEST_HEADERS:User-Agent
"Google_Analytics_Content_Experiments" "log,allow"

Can you refer the correct method to do it..

Saneesh.

On 17-04-2013 18:20, Ryan Barnett wrote:
> Saneesh,
> You should be able to do an exception for this.  What was your exception that you tried?
>
> -Ryan
> ________________________________________
> From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] on behalf of SANEESH [saneeshc at scigenom.com]
> Sent: Wednesday, April 17, 2013 8:32 AM
> To: owasp-modsecurity-core-rule-set at lists.owasp.org
> Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks  Google_Analytics_Content_Experiments
>
> Hi,
> Am trying to integrate Google_Analytics_Content_Experiments to my webpages, when trying the Analytic test am getting "We encountered an error while trying to connect to the server with your web pages (HTTP status: 403)". I found this is because mod_security is blocking the request..Please check the below log for more details..I tried to add exception for "user Agent: Google_Analytics_Content_Experiments", but no luck..Please help.
>
>
> Log:
> [17/Apr/2013:07:26:18 --0400] wSzSgUDPmqEAABafQXYAAAAA 74.125.186.151 54656 64.207.154.161 80
> --e29d6a3c-B--
> GET /pro-membership2 HTTP/1.1
> User-Agent: Google_Analytics_Content_Experiments (http://support.google.com/analytics/bin/answer.py?topic=1745208&answer=1665377)
> Host:www.test.com
> Accept-Encoding: gzip
> --e29d6a3c-F--
> HTTP/1.1 403 Forbidden
> Last-Modified: Wed, 25 May 2011 01:34:04 GMT
> ETag: "1c00603-3c2-4a40fb3273b00"
> Accept-Ranges: bytes
> Vary: Accept-Encoding,User-Agent
> Content-Encoding: gzip
> X-Powered-By: PleskLin
> Content-Length: 553
> Connection: close
> Content-Type: text/html
> --e29d6a3c-H--
> Message: Access denied with code 403 (phase 2). Operator EQ matched 0 at REQUEST_HEADERS. [file "/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_21_protocol_anomalies.conf"] [line "47"] [id "960015"] [rev "2.2.5"] [msg "Request Missing an Accept Header"] [severity "CRITICAL"] [tag "PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT"] [tag "WASCTC/WASC-21"] [tag "OWASP_TOP_10/A7"] [tag "PCI/6.5.10"]
> Action: Intercepted (phase 2)
> Stopwatch: 1366197978059393 1535 (- - -)
> Stopwatch2: 1366197978059393 1535; combined=388, p1=262, p2=86, p3=0, p4=0, p5=40, sr=99, sw=0, l=0, gc=0
> Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/); OWASP_CRS/2.2.5.
> Server: Apache
>
>
>
>    Rgrds,
> Saneesh C.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
> ________________________________
>
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
>
>



________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From saneeshc at scigenom.com  Wed Apr 17 13:14:12 2013
From: saneeshc at scigenom.com (SANEESH)
Date: Wed, 17 Apr 2013 18:44:12 +0530
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks
	Google_Analytics_Content_Experiments
In-Reply-To: <01987910BF74B341B5890120BCCE77DFD36ABE@SKYMB1.trustwave.com>
References: <516E9653.2000709@scigenom.com>
	<01987910BF74B341B5890120BCCE77DFD36A36@SKYMB1.trustwave.com>,
	<516E9C01.2010507@scigenom.com>
	<01987910BF74B341B5890120BCCE77DFD36ABE@SKYMB1.trustwave.com>
Message-ID: <516EA024.6040301@scigenom.com>

Hi Ryan,

Thanks, it worked...

Thanks a lot...

Rgrds,
Saneesh C.

On 17-04-2013 18:35, Ryan Barnett wrote:
> You want to do a conditional exception to disable the offending rule ID.  Put this in base_rules/modsecurity_crs_15_custom.conf so that is runs before the other CRS rules -
>
> SecRule REQUEST_HEADERS:User-Agent "@beginsWith Google_Analytics_Content_Experiments" "id:1,phase:1,t:none,nolog,pass,ctl:ruleRemoveById=960015"
>
> --
> Ryan Barnett
>
> ________________________________________
> From: SANEESH [saneeshc at scigenom.com]
> Sent: Wednesday, April 17, 2013 8:56 AM
> To: Ryan Barnett
> Cc: owasp-modsecurity-core-rule-set at lists.owasp.org
> Subject: Re: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks Google_Analytics_Content_Experiments
>
> Hi Ryan,
> Thanks, i tried the simple Secrule below,
>
> SecRule REQUEST_HEADERS:User-Agent
> "Google_Analytics_Content_Experiments" "log,allow"
>
> Can you refer the correct method to do it..
>
> Saneesh.
>
> On 17-04-2013 18:20, Ryan Barnett wrote:
>> Saneesh,
>> You should be able to do an exception for this.  What was your exception that you tried?
>>
>> -Ryan
>> ________________________________________
>> From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] on behalf of SANEESH [saneeshc at scigenom.com]
>> Sent: Wednesday, April 17, 2013 8:32 AM
>> To: owasp-modsecurity-core-rule-set at lists.owasp.org
>> Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks  Google_Analytics_Content_Experiments
>>
>> Hi,
>> Am trying to integrate Google_Analytics_Content_Experiments to my webpages, when trying the Analytic test am getting "We encountered an error while trying to connect to the server with your web pages (HTTP status: 403)". I found this is because mod_security is blocking the request..Please check the below log for more details..I tried to add exception for "user Agent: Google_Analytics_Content_Experiments", but no luck..Please help.
>>
>>
>> Log:
>> [17/Apr/2013:07:26:18 --0400] wSzSgUDPmqEAABafQXYAAAAA 74.125.186.151 54656 64.207.154.161 80
>> --e29d6a3c-B--
>> GET /pro-membership2 HTTP/1.1
>> User-Agent: Google_Analytics_Content_Experiments (http://support.google.com/analytics/bin/answer.py?topic=1745208&answer=1665377)
>> Host:www.test.com
>> Accept-Encoding: gzip
>> --e29d6a3c-F--
>> HTTP/1.1 403 Forbidden
>> Last-Modified: Wed, 25 May 2011 01:34:04 GMT
>> ETag: "1c00603-3c2-4a40fb3273b00"
>> Accept-Ranges: bytes
>> Vary: Accept-Encoding,User-Agent
>> Content-Encoding: gzip
>> X-Powered-By: PleskLin
>> Content-Length: 553
>> Connection: close
>> Content-Type: text/html
>> --e29d6a3c-H--
>> Message: Access denied with code 403 (phase 2). Operator EQ matched 0 at REQUEST_HEADERS. [file "/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_21_protocol_anomalies.conf"] [line "47"] [id "960015"] [rev "2.2.5"] [msg "Request Missing an Accept Header"] [severity "CRITICAL"] [tag "PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT"] [tag "WASCTC/WASC-21"] [tag "OWASP_TOP_10/A7"] [tag "PCI/6.5.10"]
>> Action: Intercepted (phase 2)
>> Stopwatch: 1366197978059393 1535 (- - -)
>> Stopwatch2: 1366197978059393 1535; combined=388, p1=262, p2=86, p3=0, p4=0, p5=40, sr=99, sw=0, l=0, gc=0
>> Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/); OWASP_CRS/2.2.5.
>> Server: Apache
>>
>>
>>
>>     Rgrds,
>> Saneesh C.
>>
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>
>>
>> ________________________________
>>
>> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
>>
>>
>
>
> ________________________________
>
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
>
>


From Pavel.Volkov at nuance.com  Thu Apr 18 20:37:57 2013
From: Pavel.Volkov at nuance.com (Volkov, Pavel)
Date: Thu, 18 Apr 2013 20:37:57 +0000
Subject: [Owasp-modsecurity-core-rule-set] unblocking blocked users
Message-ID: <C0368B68439C654081F4C4385327A716037489FA@SOM-EXCH04.nuance.com>

Hi,

I have rules setup to detect authentications failures and block user access for N number of minutes. I am utilizing user collection for this which is persisted in the database. I was wondering if it is possible to have a backdoor to unblock a user per request. I can wipe mod_security db file but I would like to avoid this if at all possible.

Thanks,
Pavel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130418/824c0243/attachment.html>

From matthieu at exultet.net  Mon Apr 29 17:19:21 2013
From: matthieu at exultet.net (=?ISO-8859-1?Q?Matthieu_Bienven=FCe?=)
Date: Mon, 29 Apr 2013 19:19:21 +0200
Subject: [Owasp-modsecurity-core-rule-set] tarball problem
Message-ID: <517EAB99.3090302@exultet.net>

Hello !

I'm updating rules using a bash script by retrieving rules at that 
adress : https://github.com/SpiderLabs/owasp-modsecurity-crs/tarball/master
(found here : 
https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project)

But the received tarball is empty (0 byte). The zip file seams to be 
fine but not the tar.gz that I'm using.
Is there a problem ?
Is the rules available at another address ?


Thanks !

Regards,

Matthieu

From RBarnett at trustwave.com  Mon Apr 29 17:24:15 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 29 Apr 2013 17:24:15 +0000
Subject: [Owasp-modsecurity-core-rule-set] tarball problem
In-Reply-To: <517EAB99.3090302@exultet.net>
Message-ID: <CDA424D9.A3A7C%ryan.barnett@owasp.org>

Yes, I have opened a Support ticket with GitHub about the problem.

I will notify the list when the issue is resolved.

-Ryan

On 4/29/13 1:19 PM, "Matthieu Bienven?e" <matthieu at exultet.net> wrote:

>Hello !
>
>I'm updating rules using a bash script by retrieving rules at that
>adress :
>https://github.com/SpiderLabs/owasp-modsecurity-crs/tarball/master
>(found here :
>https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_P
>roject)
>
>But the received tarball is empty (0 byte). The zip file seams to be
>fine but not the tar.gz that I'm using.
>Is there a problem ?
>Is the rules available at another address ?
>
>
>Thanks !
>
>Regards,
>
>Matthieu
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From darknovanick at gmail.com  Mon Apr 29 17:49:44 2013
From: darknovanick at gmail.com (Nick)
Date: Mon, 29 Apr 2013 12:49:44 -0500
Subject: [Owasp-modsecurity-core-rule-set] DoS Protection Problem
Message-ID: <CA+Qch=Lw-jPOh2UROW_8249iOxrSWFVB7EfY+f8ZO5-iDf4nVQ@mail.gmail.com>

Hello,

I've been setting up mod_security and enabled
the modsecurity_crs_11_dos_protection.conf rule. This is mod_security 2.6.8
and CRS version 2.2.5.

I have initialized the settings with:
SecAction \
  "id:'900015', \
  phase:1, \
  t:none, \
  setvar:'tx.dos_burst_time_slice=60', \
  setvar:'tx.dos_counter_threshold=300', \
  setvar:'tx.dos_block_timeout=600', \
  nolog, \
  pass"

This works and it is blocking some very aggressive bots the way it should.
But there is a problem. I have occasionally been getting lines like this in
the log:

Warning. Operator GE matched 2 at IP:dos_burst_counter. [file
"/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_11_dos_protection.conf"]
[line "44"] [id "981049"] [msg "Potential Denial of Service (DoS) Attack
from 65.55.24.236 - # of Request Bursts: 3"]

This bot was actually bingbot. I am new to mod_security, but my
understanding of my settings is that it shouldn't block until a bot has
requested 300 pages in 60 seconds.

When I check the logs I see that IP 65.55.24.236 has requested 313 pages in
1 hour. In the 60 seconds before the DoS block happening, this IP only
requested 6 pages. This block obviously shouldn't be happening.

I am grossly misunderstanding something, or what can I do to fix this?
Thanks,

Nick
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130429/f036e620/attachment.html>

From RBarnett at trustwave.com  Mon Apr 29 21:03:07 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 29 Apr 2013 21:03:07 +0000
Subject: [Owasp-modsecurity-core-rule-set] tarball problem
In-Reply-To: <517EAB99.3090302@exultet.net>
Message-ID: <CDA45839.A3BE5%rbarnett@trustwave.com>

On 4/29/13 1:19 PM, "Matthieu Bienven?e" <matthieu at exultet.net> wrote:


>Hello !
>
>I'm updating rules using a bash script by retrieving rules at that
>adress :
>https://github.com/SpiderLabs/owasp-modsecurity-crs/tarball/master
>(found here :
>https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_P
>roject)
>
>But the received tarball is empty (0 byte). The zip file seams to be
>fine but not the tar.gz that I'm using.
>Is there a problem ?
>Is the rules available at another address ?
>
>
>Thanks !
>
>Regards,
>
>Matthieu

Looks like GitHub downloads are working again.

Ryan


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From premen at vox.com.my  Tue Apr 30 02:50:04 2013
From: premen at vox.com.my (Premen)
Date: Tue, 30 Apr 2013 10:50:04 +0800
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity Error persist at
	/var/log/httpd/error_log
Message-ID: <CAKZ0SNisaP=9uOS=-W9cQo8P1ZLte8H=bMsECAsAzM0F1yJfKg@mail.gmail.com>

Hi,


I have reported to ModSecurity Team. They ask me to relate the issue to
your side.

I having issues in for the ModSecurity 2.6.6 and modsecurity-crs.2.2.5.

I getting this error at /var/log/httpd/error_log

[Mon Apr 29 11:53:07 2013] [error] [client x.x.x.x] ModSecurity: Rule
1cd7c28 [id "950901"][file
"/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"][line
"77"] - Execution error - PCRE limits exceeded (-8): (null). [hostname "
www.test.com"]  [unique_id "UX3uo9rQFyUAAGmGCT4AAAAD"]
[Mon Apr 29 11:53:07 2013] [error] [client x.x.x.x] ModSecurity: Access
denied with code 403 (phase 2). Match of "streq 0" against
"TX:MSC_PCRE_LIMITS_EXCEEDED" required. [file
"/etc/httpd/conf.d/modsecurity.conf"] [line "93"] [msg "ModSecurity
internal error flagged:

I have already added
SecPcreMatchLimit 150000
SecPcreMatchLimitRecursion 150000

and restart the httpd

Still the same.
Please help. Googling around doesn't really solve the problem


Its running Centos 6.3. Do assist me thank you




-- 

Thank you.

With Best Regards,

*Premen
012-9163739
System Engineer*
*VOX SOLUTIONS SDN. BHD*. [784358-T]
EL-11-18 Menara Melawangi,
Pusat Perdagangan Amcorp,
No. 18 Jalan Persiaran Barat,
46050 Petaling Jaya,
Selangor Darul Ehsan,
Malaysia.

Tel: 603-79552770
Fax: 603-79552710
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130430/446c5552/attachment.html>

From RBarnett at trustwave.com  Tue Apr 30 13:05:09 2013
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Tue, 30 Apr 2013 13:05:09 +0000
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity Error persist at
 /var/log/httpd/error_log
In-Reply-To: <CAKZ0SNisaP=9uOS=-W9cQo8P1ZLte8H=bMsECAsAzM0F1yJfKg@mail.gmail.com>
Message-ID: <CDA5390A.A3CC6%rbarnett@trustwave.com>



From: Premen <premen at vox.com.my<mailto:premen at vox.com.my>>
Date: Monday, April 29, 2013 10:50 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity Error persist at /var/log/httpd/error_log

Hi,


I have reported to ModSecurity Team. They ask me to relate the issue to your side.

I having issues in for the ModSecurity 2.6.6 and modsecurity-crs.2.2.5.

I getting this error at /var/log/httpd/error_log

[Mon Apr 29 11:53:07 2013] [error] [client x.x.x.x] ModSecurity: Rule 1cd7c28 [id "950901"][file "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"][line "77"] - Execution error - PCRE limits exceeded (-8): (null). [hostname "www.test.com<http://www.test.com>"]  [unique_id "UX3uo9rQFyUAAGmGCT4AAAAD"]
[Mon Apr 29 11:53:07 2013] [error] [client x.x.x.x] ModSecurity: Access denied with code 403 (phase 2). Match of "streq 0" against "TX:MSC_PCRE_LIMITS_EXCEEDED" required. [file "/etc/httpd/conf.d/modsecurity.conf"] [line "93"] [msg "ModSecurity internal error flagged:

I have already added
SecPcreMatchLimit 150000
SecPcreMatchLimitRecursion 150000

and restart the httpd

Still the same.
Please help. Googling around doesn't really solve the problem


Its running Centos 6.3. Do assist me thank you


Premen,
We have updated many regexes for greediness (which is what is typically triggering the PCRE recussion alerts).  I would suggest you upgrade your CRS to the latest version 2.2.7.  Do keep in mind, however, that 2.2.7 requires ModSecurity 2.7.x.

-Ryan

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130430/77be7f50/attachment.html>

From stephen.e.canell at jpl.nasa.gov  Tue Apr 30 22:29:18 2013
From: stephen.e.canell at jpl.nasa.gov (Canell, Stephen E (1734))
Date: Tue, 30 Apr 2013 22:29:18 +0000
Subject: [Owasp-modsecurity-core-rule-set] Apache memory attack
Message-ID: <CDA593BD.784D8%scanell@jpl.nasa.gov>

The following web site addresses an attack issue with Apache:
http://arstechnica.com/security/2013/04/admin-beware-attack-hitting-apache-websites-is-invisible-to-the-naked-eye/

Are there Modsecurity OWASP rules that protect against such an attack?

-=Steve

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130430/0f54a38b/attachment.html>

