<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule 958291 and Google Chrome PDF	viewer
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20958291%20and%20Google%20Chrome%20PDF%0A%09viewer&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000892.html">
   <LINK REL="Next"  HREF="000894.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule 958291 and Google Chrome PDF	viewer</H1>
    <B>Daniel Hall</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20958291%20and%20Google%20Chrome%20PDF%0A%09viewer&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Rule 958291 and Google Chrome PDF	viewer">daniel at danielhall.me
       </A><BR>
    <I>Mon Oct 17 22:25:08 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000892.html">[Owasp-modsecurity-core-rule-set] CRS v2.2.3 updated in SVN
</A></li>
        <LI>Next message: <A HREF="000894.html">[Owasp-modsecurity-core-rule-set]	modsecurity_crs_40_generic_attacks.conf duplicate id's
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#893">[ date ]</a>
              <a href="thread.html#893">[ thread ]</a>
              <a href="subject.html#893">[ subject ]</a>
              <a href="author.html#893">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I was looking at some issues we were having with Google Chrome users
and found that the PDF viewer built into Chrome first requests the
first 1024 bytes of the PDF before displaying it. This causes it to
trigger rule 958291 which leads to the request being blocked. I've
confirmed this on Linux and Windows versions of Chrome.

This request seems like a perfectly valid thing to do and not in clear
violation of any HTTP standards. I've setup a local override for the
rule on our systems, but you may want to reconsider including it in
the ruleset.

Here is the request made by Chrome:

GET /test.pdf HTTP/1.1
Host: test.int.danielhall.me
Connection: keep-alive
Cache-Control: max-age=0
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.1 (KHTML,
like Gecko) Chrome/14.0.835.202 Safari/535.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Range: bytes=0-1023
If-Range: &quot;9bc88-37563-4af884ec837c0&quot;

-- 
Cheers,
Daniel Hall
<A HREF="http://www.danielhall.me/">http://www.danielhall.me/</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000892.html">[Owasp-modsecurity-core-rule-set] CRS v2.2.3 updated in SVN
</A></li>
	<LI>Next message: <A HREF="000894.html">[Owasp-modsecurity-core-rule-set]	modsecurity_crs_40_generic_attacks.conf duplicate id's
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#893">[ date ]</a>
              <a href="thread.html#893">[ thread ]</a>
              <a href="subject.html#893">[ subject ]</a>
              <a href="author.html#893">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
