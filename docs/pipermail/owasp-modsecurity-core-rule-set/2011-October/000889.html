<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] false positive with rules 981243,	981244 and 981248
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20false%20positive%20with%20rules%20981243%2C%0A%09981244%20and%20981248&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000888.html">
   <LINK REL="Next"  HREF="000890.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] false positive with rules 981243,	981244 and 981248</H1>
    <B>Claude.Durocher at mcccf.gouv.qc.ca</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20false%20positive%20with%20rules%20981243%2C%0A%09981244%20and%20981248&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] false positive with rules 981243,	981244 and 981248">Claude.Durocher at mcccf.gouv.qc.ca
       </A><BR>
    <I>Wed Oct 12 16:41:59 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000888.html">[Owasp-modsecurity-core-rule-set] CRS 2.2.2 rule 971202 false	positives
</A></li>
        <LI>Next message: <A HREF="000890.html">[Owasp-modsecurity-core-rule-set] false positive with rules 981243, 981244 and 981248
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#889">[ date ]</a>
              <a href="thread.html#889">[ thread ]</a>
              <a href="subject.html#889">[ subject ]</a>
              <a href="author.html#889">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

- Avis: Ce message est confidentiel et ne s'adresse qu'aux destinataires.
Si vous le recevez par erreur, veuillez le supprimer et nous en aviser.
-
Hi,

I'm getting false positive with rules 981243, 981244 and 981248 (core rule
set 2.2.2 and mod_security 2.6). Seems like the rule don't like &quot;dIv&quot; or
&quot;div&quot; in the url.

Is there a way to use SecRuleUpdateTargetById to handle this ?


--37216702-B--
GET /uploads/tx_jcarousel/dIversite-culturelle-2_01.gif HTTP/1.1
Host: www.myhost.com
User-Agent: Mozilla/5.0 (X11; Linux i686; rv:7.0.1) Gecko/20100101
Firefox/7.0.1
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: fr,fr-fr;q=0.8,en;q=0.5,en-us;q=0.3
Accept-Encoding: gzip, deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
DNT: 1
Connection: keep-alive
Cookie: style=normal; user=678843ea0aa41; cookies=true
Cache-Control: max-age=0

--37216702-F--
HTTP/1.1 403 Forbidden
Accept-Ranges: bytes
Vary: Accept-Encoding,User-Agent
Content-Encoding: gzip
Content-Length: 576
Keep-Alive: timeout=15, max=97
Connection: Keep-Alive
Content-Type: text/html

--37216702-H--

Message: Access denied with code 403 (phase 2). Pattern match
&quot;(?i:(?:@.+=\\s*\\(\\s*select)|(?:\\d+\\s*x?or|div|like|between|and\\s*\\d+
\\s*[\\-+])|(?:\\/\\w+;?\\s+(?:having|and|x?or|div|like|between|and|
select)\\W)|(?:\\d\\s+group\\s+by.+\\()|(?:(?:;|#|--)\\s*(?:drop|alter))|
(?:(?:;|#|--)\\s*(?:update|insert)\\s
...&quot; at REQUEST_FILENAME. [file
&quot;/etc/apache2/conf.d/mod_security/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;]

[line &quot;539&quot;] [id &quot;981248&quot;] [msg &quot;Detects chained SQL injection attempts
1/2&quot;] [data &quot;dIv&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag
&quot;WEB_ATTACK/ID&quot;]

Connection: keep-alive
Cookie: style=normal; user=678843ea0aa41; cookies=true
Cache-Control: max-age=0

--37216702-F--
HTTP/1.1 403 Forbidden
Accept-Ranges: bytes
Vary: Accept-Encoding,User-Agent
Content-Encoding: gzip
Content-Length: 576
Keep-Alive: timeout=15, max=97
Connection: Keep-Alive
Content-Type: text/html

--37216702-H--

Message: Access denied with code 403 (phase 2). Pattern match
&quot;(?i:(?:@.+=\\s*\\(\\s*select)|(?:\\d+\\s*x?or|div|like|between|and\\s*\\d+
\\s*[\\-+])|(?:\\/\\w+;?\\s+(?:having|and|x?or|div|like|between|and|
select)\\W)|(?:\\d\\s+group\\s+by.+\\()|(?:(?:;|#|--)\\s*(?:drop|alter))|
(?:(?:;|#|--)\\s*(?:update|insert)\\s
...&quot; at REQUEST_FILENAME. [file
&quot;/etc/apache2/conf.d/mod_security/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;]

[line &quot;539&quot;] [id &quot;981248&quot;] [msg &quot;Detects chained SQL injection attempts
1/2&quot;] [data &quot;dIv&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag
&quot;WEB_ATTACK/ID&quot;]


Claude
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20111012/8e6648eb/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20111012/8e6648eb/attachment.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: 5A559535.jpg
Type: image/jpeg
Size: 3034 bytes
Desc: not available
Url : <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20111012/8e6648eb/attachment.jpg">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20111012/8e6648eb/attachment.jpg</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000888.html">[Owasp-modsecurity-core-rule-set] CRS 2.2.2 rule 971202 false	positives
</A></li>
	<LI>Next message: <A HREF="000890.html">[Owasp-modsecurity-core-rule-set] false positive with rules 981243, 981244 and 981248
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#889">[ date ]</a>
              <a href="thread.html#889">[ thread ]</a>
              <a href="subject.html#889">[ subject ]</a>
              <a href="author.html#889">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
