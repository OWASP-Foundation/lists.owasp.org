<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Performance issues
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Performance%20issues&In-Reply-To=CAAzXPXDLXqg2PYNHdzTWzpwu5WtViNn%3DLB0R%3D1M3G8YUJ51ibA%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000900.html">
   <LINK REL="Next"  HREF="000902.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Performance issues</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Performance%20issues&In-Reply-To=CAAzXPXDLXqg2PYNHdzTWzpwu5WtViNn%3DLB0R%3D1M3G8YUJ51ibA%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Performance issues">RBarnett at trustwave.com
       </A><BR>
    <I>Mon Oct 24 14:45:30 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000900.html">[Owasp-modsecurity-core-rule-set] Performance issues
</A></li>
        <LI>Next message: <A HREF="000902.html">[Owasp-modsecurity-core-rule-set] Missing parts in CRS commit 1854	(Watcher Cookie Checks)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#901">[ date ]</a>
              <a href="thread.html#901">[ thread ]</a>
              <a href="subject.html#901">[ subject ]</a>
              <a href="author.html#901">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>My guess is that it is related to the initcol at the end of the 10 config file. This is used to setup the IP collection for other rules to use. While this is helpful, I think it is causing these types of perf issues on high traffic sites as it is forcing ModSec to create a persistent collection for ALL request.

Try commenting out the final initcol SecRule at the end of the 10 file and see if it helps.

We will think of a better approach.

Ryan

On Oct 24, 2011, at 2:30 PM, &quot;rm4dillo D&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rm4dillo at gmail.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I recently installed ModSecurity with CRS 2.2.2 (base rules only, paranoid mode set to off and SecResponseBodyAccess to off too) on a high traffic server and the CPU usage almost reached 100% while it's usually around 2 to 5% and I have no errors.
</I>&gt;<i>
</I>&gt;<i> By disabling mod_security_crs_4[01]* rules (generic, xss, sqli) it's way better but not really useful :).
</I>&gt;<i>
</I>&gt;<i> Any clues? Does someone benchmark the rules before every release?
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i> Rm4dillo
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000900.html">[Owasp-modsecurity-core-rule-set] Performance issues
</A></li>
	<LI>Next message: <A HREF="000902.html">[Owasp-modsecurity-core-rule-set] Missing parts in CRS commit 1854	(Watcher Cookie Checks)?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#901">[ date ]</a>
              <a href="thread.html#901">[ thread ]</a>
              <a href="subject.html#901">[ subject ]</a>
              <a href="author.html#901">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
