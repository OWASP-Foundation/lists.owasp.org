<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Lua Script execution failed message
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Lua%20Script%20execution%20failed%0A%20message&In-Reply-To=%3CD1C30CED.C97B%25csanders%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001791.html">
   <LINK REL="Next"  HREF="001793.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Lua Script execution failed message</H1>
    <B>Chaim Sanders</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Lua%20Script%20execution%20failed%0A%20message&In-Reply-To=%3CD1C30CED.C97B%25csanders%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Lua Script execution failed message">CSanders at trustwave.com
       </A><BR>
    <I>Wed Jul  8 21:26:00 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001791.html">[Owasp-modsecurity-core-rule-set] Lua Script execution failed	message
</A></li>
        <LI>Next message: <A HREF="001793.html">[Owasp-modsecurity-core-rule-set] Duplicate SecAuditLogParts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1792">[ date ]</a>
              <a href="thread.html#1792">[ thread ]</a>
              <a href="subject.html#1792">[ subject ]</a>
              <a href="author.html#1792">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It seems as if you have enabled the experimental rules namely
modsecurity_crs_61_ip_forensics.conf. Without looking directly at the
code, it looks as if the particular rule is trying to do WHOIS lookup. My
advice would be that you might consider disabling the particular rules you
don&#185;t need. If you need these rules (or want them) I can certainly look
more closely at the LUA script and see where the problem might arise.

On 7/8/15, 10:49 AM, &quot;Bill Miller&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wbmilleriii at comcast.net</A>&gt; wrote:

&gt;<i>Hello,
</I>&gt;<i>I've been setting up modsecurity-crs and I've managed to eliminate all
</I>&gt;<i>the error messages save one, namely
</I>&gt;<i>
</I>&gt;<i>Message: Lua: Script execution failed:
</I>&gt;<i>/usr/share/modsecurity-crs/lua/gather_ip_data.lua:8: attempt to
</I>&gt;<i>concatenate local 'remote_addr' (a nil value)
</I>&gt;<i>
</I>&gt;<i>This message shows up in modsec_audit.log every time the
</I>&gt;<i>modsecurity_crs_60_correlation.conf rule is triggered.
</I>&gt;<i>
</I>&gt;<i>Any information on how to go about fixing this would be most
</I>&gt;<i>appreciated.  Google searching has been fruitless.
</I>&gt;<i>
</I>&gt;<i>Thanks in advance,
</I>&gt;<i>Bill
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=3L6d1Xgeb8uYenYYXLrpkJXDRrC-WD4vtd">http://scanmail.trustwave.com/?c=4062&amp;d=3L6d1Xgeb8uYenYYXLrpkJXDRrC-WD4vtd</A>
</I>&gt;<i>2MDWBwqQ&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
</I>&gt;<i>asp-modsecurity-core-rule-set
</I>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001791.html">[Owasp-modsecurity-core-rule-set] Lua Script execution failed	message
</A></li>
	<LI>Next message: <A HREF="001793.html">[Owasp-modsecurity-core-rule-set] Duplicate SecAuditLogParts?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1792">[ date ]</a>
              <a href="thread.html#1792">[ thread ]</a>
              <a href="subject.html#1792">[ subject ]</a>
              <a href="author.html#1792">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
