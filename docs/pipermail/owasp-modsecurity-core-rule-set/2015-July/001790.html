<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] modsecurity - trouble with SecRequestBodyAccess
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20modsecurity%20-%20trouble%20with%0A%20SecRequestBodyAccess&In-Reply-To=%3CD1C152BD.C177%25csanders%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001788.html">
   <LINK REL="Next"  HREF="001784.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] modsecurity - trouble with SecRequestBodyAccess</H1>
    <B>Chaim Sanders</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20modsecurity%20-%20trouble%20with%0A%20SecRequestBodyAccess&In-Reply-To=%3CD1C152BD.C177%25csanders%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] modsecurity - trouble with SecRequestBodyAccess">CSanders at trustwave.com
       </A><BR>
    <I>Tue Jul  7 14:13:07 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001788.html">[Owasp-modsecurity-core-rule-set] modsecurity - trouble with	SecRequestBodyAccess
</A></li>
        <LI>Next message: <A HREF="001784.html">[Owasp-modsecurity-core-rule-set] Update Rule Action List to make	it 'chained'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1790">[ date ]</a>
              <a href="thread.html#1790">[ thread ]</a>
              <a href="subject.html#1790">[ subject ]</a>
              <a href="author.html#1790">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So there are two questions here and I&#8217;ll try and address them independently (unfortunately they are slightly intertwined).
There is a common mistake people make when dealing with removing/modify rules  so I&#8217;ll get that out of the way first. There are two ways to do this. One can either do it with a ctl: action (<A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl</A>) such as

SecRule REQUEST_URI &quot;@beginsWith /index.php&quot; &quot;phase:1,t:none,pass, \
  nolog,ctl:ruleRemoveTargetById=981260;ARGS:user

 Or via the way I showed you previously

SecRuleUpdateTargetById 950907 !ARGS:test

The placement of these depends on which one you use. The rule version, featuring the ctl action must come BEFORE the rule in question. Anywhere really will work. In the CRS 3.0 world there is a file called REQUEST-00-LOCAL-WHITELIST.conf.example. Renaming this file to REQUEST-00-LOCAL-WHITELIST.conf and adding it there is what it was designed for. There is no reason that you can&#8217;t do this with an earlier version of OWASP too. The key being that it just needs to be loaded before the rest of the rules.
A similar file exists for SecRuleUpdateTargetById type directives. These must be places AFTER all the rules (it has to do with when these are run &#8230; at startup versus at time of rule check). CRS 3.0 also has a file just for this named RESPONSE-99-EXCEPTIONS.conf.example. This can also be renamed RESPONSE-99-EXCEPTIONS.conf and the SecRuleUpdateTargetById directive could be included there.

Now onto your second question how to upgrade to CRS 3.0. Fortunately this is the easier part. CRS is just a number of configuration files. So you can find those typically in your apache config area&#8230; depending on the OS this might be /etc/httpd/. Grep/find will be your friend in this instance. Once you&#8217;ve found all the files it is simply a matter of deleting (or moving) them. You can now download CRS 3.0 from the following URL: <A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/tree/v3.0.0-dev.">https://github.com/SpiderLabs/owasp-modsecurity-crs/tree/v3.0.0-dev.</A> Extract these and move these rules to the same area.
You will then have to find the file from where CRS was included (either httpd.conf, modsecurity.conf, sometimes if installed via yum this can be named 10-modsecurity.conf (or something like that).  In the end you are looking for something like this (which you can grep). Note, these might have a folder path in front of them:
Include modsecurity_crs_10_setup.conf
Include activated_rules/*.conf


Simply change these to reflect the new folder layout of 3.0. I.E

Include modsecurity_crs_10_setup.conf
Include rules/*.conf

 That should do it, make sure the rules load correctly and you are using 3.0. Hopefully this helps!


From: kazik &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">kazik at agape.org.pl</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">kazik at agape.org.pl</A>&gt;&gt;
Date: Tuesday, July 7, 2015 at 4:05 AM
To: Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">csanders at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">csanders at trustwave.com</A>&gt;&gt;
Cc: Adri&#225;n &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">adrianbn at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">adrianbn at gmail.com</A>&gt;&gt;, &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] modsecurity - trouble with SecRequestBodyAccess

Hello,

Thanks Chaim - your right, modsecurity works ok - I do not&#8230;

In your example I can update the rule, but where shoud I place this update,
in apache container (example &lt;Directory&gt;) or add local.conf file to activated_rules?

CRS v3 looks interesting (even beta) - maybe stupid question, but how to update CRS rules to v 3?
(now: modsecurity 2.7.7-2, crs 2.9)

Giga thanks, again ;)

Tom Kazm


Wiadomo&#347;&#263; napisana przez Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt;&gt; w dniu 4 lip 2015, o godz. 17:37:

ModSecurity will indeed will block HTML tags because they are exactly how HTML injection/XSS is introduced. Sending HTML is often indicative of these vulnerabilities being exploited, in general it is considered poor form/dev to send such content across the wire. However, you can always, easily create exceptions for rules in particular places. Just look at the particular rule that is triggering and the particular parameter that is triggering them and you can add an exception by doing something similar to the following &#8216;SecRuleUpdateTargetById 950907 !ARGS:test&#8217;. For more information see <A HREF="https://www.trustwave.com/Resources/SpiderLabs-Blog/ModSecurity-Advanced-Topic-of-the-Week--(Updated">https://www.trustwave.com/Resources/SpiderLabs-Blog/ModSecurity-Advanced-Topic-of-the-Week--(Updated</A>)-Exception-Handling/. In addition, if you are using CRS 3.0 this feature is already built in see your config file: <A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/modsecurity_crs_10_setup.conf.example#L420&lt;http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YUkDP0xdSg&amp;s=5&amp;u=https%3a%2f%2fgithub%2ecom%2fSpiderLabs%2fowasp-modsecurity-crs%2fblob%2fv3%2e0%2e0-dev%2fmodsecurity%5fcrs%5f10%5fsetup%2econf%2eexample%23L420">https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/modsecurity_crs_10_setup.conf.example#L420&lt;http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YUkDP0xdSg&amp;s=5&amp;u=https%3a%2f%2fgithub%2ecom%2fSpiderLabs%2fowasp-modsecurity-crs%2fblob%2fv3%2e0%2e0-dev%2fmodsecurity%5fcrs%5f10%5fsetup%2econf%2eexample%23L420</A>&gt;.

For more detail see the issue that someone opened yesterday about this and my reply, I think it goes into a tad more detail.<A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/235&lt;http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YU5SYEUKSg&amp;s=5&amp;u=https%3a%2f%2fgithub%2ecom%2fSpiderLabs%2fowasp-modsecurity-crs%2fissues%2f235">https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/235&lt;http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YU5SYEUKSg&amp;s=5&amp;u=https%3a%2f%2fgithub%2ecom%2fSpiderLabs%2fowasp-modsecurity-crs%2fissues%2f235</A>&gt;

Chaim Sanders
Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt; [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Adri&#225;n
Sent: Friday, July 3, 2015 5:12 AM
To: kazik; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] modsecurity - trouble with SecRequestBodyAccess

Hi Tom,
it seems to me that ModSecurity is 'rightly' detecting XSS attempts due to the HTML tags that you submit when creating blog posts. As far as I know, what you would need to do is create exceptions for the URLs and parameters you know contain HTML tags, and if possible make them specific to the tags that your site allows. This is a tedious (for a lack of a better word) work that comes with the installation of ModSecurity in front of a new application. Think that the default CRS is generic and doesn't understand the idiosyncrasy of your application, so the rules need adjusting.
Good luck!
Adrian

El vie., 3 jul. 2015 a las 9:35, kazik (&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">kazik at agape.org.pl</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">kazik at agape.org.pl</A>&gt;&gt;) escribi&#243;:
helo,

Server - Ubuntu 14 LTS | Apache/2.4.7 | modsecurity 2.7.7-2

I was enabled modsecurity in DetectionPnly mode - default configuration from Ubuntu.

On our server we have a few site, CMS (Joomla, wordpress) and own CMS.
All of them work with WYSWIG editors.

When I set SecRequestBodyAccess On and try update or create article,
there is a lot of errors, especially SQL-injecttion and XSS.

But I only update article, its no a crime :)

Look like modsecurity treats all html tags like SQL or XSS attack,
is there any special module for that or parser?

HELP ME, PLEASE :)

tom kazm

example of logs from apache2 errors



[Fri Jul 03 10:14:05.628018 2015] [:error] [pid 28133:tid 139652430276352] [client 192.168.20.129] ModSecurity: Warning. Pattern match &quot;(?i:[\\&quot;\\\\'][ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?\\\\(.*?\\\\))&lt;<A HREF="file://////">file://////</A>'][%20]*(([%5ea-z0-9~_:/'%20%5d)|(in)).+%3f/(.*%3f/))&gt;&quot; at ARGS:art_lid. [file &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;] [line &quot;506&quot;] [id &quot;973335&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack Detected.&quot;] [data &quot;Matched Data: \\x22&lt;<A HREF="file://///x22">file://///x22</A>&gt;&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0) found within ARGS:art_lid: &lt;p&gt; &lt;/p&gt; &lt;table class=\\x22contentpaneopen\\x22&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt;href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A> target=\\x22_blank\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;Wybierasz&lt;<A HREF="file://///x22%3eWybierasz">file://///x22%3eWybierasz</A>&gt; si\\xc4\\x99 za granic\\xc4\\x99?...&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;] [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;] [tag &quot;PCI/6.5.1&quot;] [hostname &#8222;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;] [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
[Fri Jul 03 10:14:05.628575 2015] [:error] [pid 28133:tid 139652430276352] [client 192.168.20.129] ModSecurity: Warning. Pattern match &quot;(?i:[\\&quot;\\\\'].*?\\\\)[ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?\\\\()&lt;<A HREF="file://////">file://////</A>'].*%3f/)%5b%20%5d*((%5b%5ea-z0-9~_:/'%20%5d)|(in)).+%3f/()&gt;&quot; at ARGS:art_lid. [file &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;] [line &quot;508&quot;] [id &quot;973334&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack Detected.&quot;] [data &quot;Matched Data: \\x22contentpaneopen\\x22&lt;<A HREF="file://///x22contentpaneopen/x22">file://///x22contentpaneopen/x22</A>&gt;&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt; href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A> target=\\x22_blank\\x22&gt;&lt;span style=\\x22color: rgb( found within ARGS:art_lid: &lt;p&gt; &lt;/p&gt; &lt;table class=\\x22contentpaneopen\\x22&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt; href=\\x22<A HREF="http://www.emigr...">http://www.emigr...</A>&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;] [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;] [tag &quot;PCI/6.5.1&quot;] [hostname &quot;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;] [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
[Fri Jul 03 10:14:05.628689 2015] [:error] [pid 28133:tid 139652430276352] [client 192.168.20.129] ModSecurity: Rule 7f036a3bc248 [id &quot;973334&quot;][file &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;][line &quot;508&quot;] - Execution error - PCRE limits exceeded (-8): (null). [hostname &quot;milujciesie.org.pl&lt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YU5VYEkOSw&amp;s=5&amp;u=http%3a%2f%2fmilujciesie%2eorg%2epl">http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YU5VYEkOSw&amp;s=5&amp;u=http%3a%2f%2fmilujciesie%2eorg%2epl</A>&gt;&quot;] [uri &quot;/admin/index.php&quot;] [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
[Fri Jul 03 10:14:05.629212 2015] [:error] [pid 28133:tid 139652430276352] [client 192.168.20.129] ModSecurity: Warning. Pattern match &quot;(?i:[\\&quot;\\\\'][ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?[.].+?=)&lt;<A HREF="file://////">file://////</A>'][%20]*(([%5ea-z0-9~_:/'%20%5d)|(in)).+%3f%5b.%5d.+%3f=)&gt;&quot; at ARGS:art_lid. [file &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;] [line &quot;510&quot;] [id &quot;973333&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack Detected.&quot;] [data &quot;Matched Data: \\x22&lt;<A HREF="file://///x22">file://///x22</A>&gt;&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt; href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=">http://www.emigracja.chrystusowcy.pl/index.php?option=</A> found within ARGS:art_lid: &lt;p&gt; &lt;/p&gt; &lt;table class=\\x22contentpaneopen\\x22&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt; href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A> target=\\x22_blank\\x22&gt;&lt;span st...&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;] [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;] [tag &quot;PCI/6.5.1&quot;] [hostname &quot;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;] [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
[Fri Jul 03 10:14:05.629414 2015] [:error] [pid 28133:tid 139652430276352] [client 192.168.20.129] ModSecurity: Warning. Pattern match &quot;(?i:[\\&quot;\\\\'][ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?[.].+?=)&lt;<A HREF="file://////">file://////</A>'][%20]*(([%5ea-z0-9~_:/'%20%5d)|(in)).+%3f%5b.%5d.+%3f=)&gt;&quot; at ARGS:art_text. [file &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;] [line &quot;510&quot;] [id &quot;973333&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack Detected.&quot;] [data &quot;Matched Data: \\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt; href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=">http://www.emigracja.chrystusowcy.pl/index.php?option=</A> found within ARGS:art_text: &lt;p&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt; href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A> target=\\x22_blank\\x22&gt;&lt;img align=\\x22left\\x22 alt=\\x22\\x22 src=\\x22<A HREF="https://milujciesie.org.pl/upload/articles/r_u_c_k_i/PL/logo_IDE.png\\x22">https://milujciesie.org.pl/upload/articles/r_u_c_k_i/PL/logo_IDE.png\\x22</A> /&gt;&lt;/a&gt;Na stronie &lt;a href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/\\x22">http://www.emigracja.chrystusowcy.pl/\\x22</A> target=\\x22_blank\\x22&gt;Instytutu Duszpasterstwa Emig...&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;] [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;] [tag &quot;PCI/6.5.1&quot;] [hostname &quot;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;] [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
[Fri Jul 03 10:14:05.631654 2015] [:error] [pid 28133:tid 139652430276352] [client 192.168.20.129] ModSecurity: Warning. Pattern match &quot;(?i:[ /+\\\\t\\&quot;\\\\'`]style[ /+\\\\t]*?=.*([:=]|(&amp;#x?0*((58)|(3A)|(61)|(3D));?)).*?([(\\\\\\\\]|(&amp;#x?0*((40)|(28)|(92)|(5C));?)))&lt;<A HREF="file://////">file://////</A>'%60]style[%20/+/t%5d*%3f=.*(%5b:=%5d|(&amp;%23x%3f0*((58)|(3A)|(61)|(3D));%3f)).*%3f(%5b(/%5d|(&amp;%23x%3f0*((40)|(28)|(92)|(5C));%3f)))&gt;&quot; at ARGS:art_lid. [file &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;] [line &quot;520&quot;] [id &quot;973316&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack Detected.&quot;] [data &quot;Matched Data:  style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a&lt;<A HREF="file://///x22%3e%3ca">file://///x22%3e%3ca</A>&gt; href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A> target=\\x22_blank\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;Wybierasz&lt;<A HREF="file://///x22%3eWybierasz">file://///x22%3eWybierasz</A>&gt; si\\xc4\\x99 za granic\\xc4\\x99?&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;br /&gt; &lt;a href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A> target=\\x22_blank\\x22&gt;Szukasz Mszy \\xc5\\x9awi\\xc4\\x99tej&lt;<A HREF="file://///xc5/x9awi/xc4/x99tej">file://///xc5/x9awi/xc4/x99tej</A>&gt; w j\\xc4\\x99zyku polskim? &lt;span style=\\x22color: rgb( found...&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;] [tag &quot;OWASP_TOP_10/A2&quot;] [tag [hostname &quot;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;] [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YUlSP01ZQw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;http://scanmail.trustwave.com/?c=4062&amp;d=joib1XwoaC3QMPIMFmFAYVrQyTAV7DV0YUlSP01ZQw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set</A>&gt;

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150707/2e31ab84/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150707/2e31ab84/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001788.html">[Owasp-modsecurity-core-rule-set] modsecurity - trouble with	SecRequestBodyAccess
</A></li>
	<LI>Next message: <A HREF="001784.html">[Owasp-modsecurity-core-rule-set] Update Rule Action List to make	it 'chained'
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1790">[ date ]</a>
              <a href="thread.html#1790">[ thread ]</a>
              <a href="subject.html#1790">[ subject ]</a>
              <a href="author.html#1790">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
