<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] modsecurity - trouble with	SecRequestBodyAccess
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20modsecurity%20-%20trouble%20with%0A%09SecRequestBodyAccess&In-Reply-To=%3CCAFDTedrz_o4dq6%2B8de_dY-%2BRRdewBsQ3_733hM%3D0ZeL41zFAcA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001783.html">
   <LINK REL="Next"  HREF="001786.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] modsecurity - trouble with	SecRequestBodyAccess</H1>
    <B>Adri&#225;n</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20modsecurity%20-%20trouble%20with%0A%09SecRequestBodyAccess&In-Reply-To=%3CCAFDTedrz_o4dq6%2B8de_dY-%2BRRdewBsQ3_733hM%3D0ZeL41zFAcA%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] modsecurity - trouble with	SecRequestBodyAccess">adrianbn at gmail.com
       </A><BR>
    <I>Fri Jul  3 09:12:09 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001783.html">[Owasp-modsecurity-core-rule-set] modsecurity - trouble with	SecRequestBodyAccess
</A></li>
        <LI>Next message: <A HREF="001786.html">[Owasp-modsecurity-core-rule-set] modsecurity - trouble	with	SecRequestBodyAccess
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1785">[ date ]</a>
              <a href="thread.html#1785">[ thread ]</a>
              <a href="subject.html#1785">[ subject ]</a>
              <a href="author.html#1785">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Tom,

it seems to me that ModSecurity is 'rightly' detecting XSS attempts due to
the HTML tags that you submit when creating blog posts. As far as I know,
what you would need to do is create exceptions for the URLs and parameters
you know contain HTML tags, and if possible make them specific to the tags
that your site allows. This is a tedious (for a lack of a better word) work
that comes with the installation of ModSecurity in front of a new
application. Think that the default CRS is generic and doesn't understand
the idiosyncrasy of your application, so the rules need adjusting.

Good luck!
Adrian

El vie., 3 jul. 2015 a las 9:35, kazik (&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">kazik at agape.org.pl</A>&gt;) escribi&#243;:

&gt;<i> helo,
</I>&gt;<i>
</I>&gt;<i> Server - *Ubuntu 14 LTS* | *Apache/2.4.7* | modsecurity *2.7.7-2*
</I>&gt;<i>
</I>&gt;<i> I was enabled modsecurity in DetectionPnly mode - default configuration
</I>&gt;<i> from Ubuntu.
</I>&gt;<i>
</I>&gt;<i> On our server we have a few site, CMS (Joomla, wordpress) and own CMS.
</I>&gt;<i> All of them work with WYSWIG editors.
</I>&gt;<i>
</I>&gt;<i> When I set *SecRequestBodyAccess On* and try update or create article,
</I>&gt;<i> there is a lot of errors, especially SQL-injecttion and XSS.
</I>&gt;<i>
</I>&gt;<i> But I only update article, its no a crime :)
</I>&gt;<i>
</I>&gt;<i> Look like modsecurity treats all html tags like SQL or XSS attack,
</I>&gt;<i> is there any special module for that or parser?
</I>&gt;<i>
</I>&gt;<i> HELP ME, PLEASE :)
</I>&gt;<i>
</I>&gt;<i> tom kazm
</I>&gt;<i>
</I>&gt;<i> example of logs from apache2 errors
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [Fri Jul 03 10:14:05.628018 2015] [:error] [pid 28133:tid 139652430276352]
</I>&gt;<i> [client 192.168.20.129] ModSecurity: Warning. Pattern match
</I>&gt;<i> &quot;(?i:[\\&quot;\\\\'][ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?\\\\(.*?\\\\))&quot; at
</I>&gt;<i> ARGS:art_lid. [file
</I>&gt;<i> &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;506&quot;] [id &quot;973335&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack
</I>&gt;<i> Detected.&quot;] [data &quot;Matched Data: \\x22&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td
</I>&gt;<i> valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span
</I>&gt;<i> style=\\x22color: rgb(128,0,0) found within ARGS:art_lid: &lt;p&gt; &lt;/p&gt; &lt;table
</I>&gt;<i> class=\\x22contentpaneopen\\x22&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td valign=\\x22top\\x22&gt; &lt;h5
</I>&gt;<i> style=\\x22text-align: center\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)
</I>&gt;<i> \\x22&gt;&lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A>
</I>&gt;<i> target=\\x22_blank\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;Wybierasz
</I>&gt;<i> si\\xc4\\x99 za granic\\xc4\\x99?...&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity
</I>&gt;<i> &quot;8&quot;] [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;]
</I>&gt;<i> [tag &quot;WASCTC/WASC-22&quot;] [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;]
</I>&gt;<i> [tag &quot;PCI/6.5.1&quot;] [hostname &#8222;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;]
</I>&gt;<i> [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
</I>&gt;<i> [Fri Jul 03 10:14:05.628575 2015] [:error] [pid 28133:tid 139652430276352]
</I>&gt;<i> [client 192.168.20.129] ModSecurity: Warning. Pattern match
</I>&gt;<i> &quot;(?i:[\\&quot;\\\\'].*?\\\\)[ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?\\\\()&quot; at
</I>&gt;<i> ARGS:art_lid. [file
</I>&gt;<i> &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;508&quot;] [id &quot;973334&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack
</I>&gt;<i> Detected.&quot;] [data &quot;Matched Data: \\x22contentpaneopen\\x22&gt; &lt;tbody&gt; &lt;tr&gt;
</I>&gt;<i> &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span
</I>&gt;<i> style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A>
</I>&gt;<i> target=\\x22_blank\\x22&gt;&lt;span style=\\x22color: rgb( found within
</I>&gt;<i> ARGS:art_lid: &lt;p&gt; &lt;/p&gt; &lt;table class=\\x22contentpaneopen\\x22&gt; &lt;tbody&gt; &lt;tr&gt;
</I>&gt;<i> &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span
</I>&gt;<i> style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a href=\\x22<A HREF="http://www.emigr...">http://www.emigr...</A>&quot;]
</I>&gt;<i> [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;]
</I>&gt;<i> [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;] [tag &quot;PCI/6.5.1&quot;]
</I>&gt;<i> [hostname &quot;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;] [unique_id
</I>&gt;<i> &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
</I>&gt;<i> [Fri Jul 03 10:14:05.628689 2015] [:error] [pid 28133:tid 139652430276352]
</I>&gt;<i> [client 192.168.20.129] ModSecurity: Rule 7f036a3bc248 [id &quot;973334&quot;][file
</I>&gt;<i> &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;][line
</I>&gt;<i> &quot;508&quot;] - Execution error - PCRE limits exceeded (-8): (null). [hostname &quot;
</I>&gt;<i> milujciesie.org.pl&quot;] [uri &quot;/admin/index.php&quot;] [unique_id
</I>&gt;<i> &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
</I>&gt;<i> [Fri Jul 03 10:14:05.629212 2015] [:error] [pid 28133:tid 139652430276352]
</I>&gt;<i> [client 192.168.20.129] ModSecurity: Warning. Pattern match
</I>&gt;<i> &quot;(?i:[\\&quot;\\\\'][ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?[.].+?=)&quot; at ARGS:art_lid.
</I>&gt;<i> [file
</I>&gt;<i> &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;510&quot;] [id &quot;973333&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack
</I>&gt;<i> Detected.&quot;] [data &quot;Matched Data: \\x22&gt; &lt;tbody&gt; &lt;tr&gt; &lt;td
</I>&gt;<i> valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span
</I>&gt;<i> style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=">http://www.emigracja.chrystusowcy.pl/index.php?option=</A> found within
</I>&gt;<i> ARGS:art_lid: &lt;p&gt; &lt;/p&gt; &lt;table class=\\x22contentpaneopen\\x22&gt; &lt;tbody&gt; &lt;tr&gt;
</I>&gt;<i> &lt;td valign=\\x22top\\x22&gt; &lt;h5 style=\\x22text-align: center\\x22&gt;&lt;span
</I>&gt;<i> style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A>
</I>&gt;<i> target=\\x22_blank\\x22&gt;&lt;span st...&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity
</I>&gt;<i> &quot;8&quot;] [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;]
</I>&gt;<i> [tag &quot;WASCTC/WASC-22&quot;] [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;]
</I>&gt;<i> [tag &quot;PCI/6.5.1&quot;] [hostname &quot;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;]
</I>&gt;<i> [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
</I>&gt;<i> [Fri Jul 03 10:14:05.629414 2015] [:error] [pid 28133:tid 139652430276352]
</I>&gt;<i> [client 192.168.20.129] ModSecurity: Warning. Pattern match
</I>&gt;<i> &quot;(?i:[\\&quot;\\\\'][ ]*(([^a-z0-9~_:\\\\' ])|(in)).+?[.].+?=)&quot; at
</I>&gt;<i> ARGS:art_text. [file
</I>&gt;<i> &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;510&quot;] [id &quot;973333&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack
</I>&gt;<i> Detected.&quot;] [data &quot;Matched Data: \\x22&gt;&lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=">http://www.emigracja.chrystusowcy.pl/index.php?option=</A> found within
</I>&gt;<i> ARGS:art_text: &lt;p&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A>
</I>&gt;<i> target=\\x22_blank\\x22&gt;&lt;img align=\\x22left\\x22 alt=\\x22\\x22 src=\\
</I>&gt;<i> x22<A HREF="https://milujciesie.org.pl/upload/articles/r_u_c_k_i/PL/logo_IDE.png\\x22">https://milujciesie.org.pl/upload/articles/r_u_c_k_i/PL/logo_IDE.png\\x22</A>
</I>&gt;<i> /&gt;&lt;/a&gt;Na stronie &lt;a href=\\x22<A HREF="http://www.emigracja.chrystusowcy.pl/\\x22">http://www.emigracja.chrystusowcy.pl/\\x22</A>
</I>&gt;<i> target=\\x22_blank\\x22&gt;Instytutu Duszpasterstwa Emig...&quot;] [ver
</I>&gt;<i> &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;]
</I>&gt;<i> [tag &quot;OWASP_TOP_10/A2&quot;] [tag &quot;OWASP_AppSensor/IE1&quot;] [tag &quot;PCI/6.5.1&quot;]
</I>&gt;<i> [hostname &quot;XXXXXXXXXXXXX&quot;] [uri &quot;/admin/index.php&quot;] [unique_id
</I>&gt;<i> &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
</I>&gt;<i> [Fri Jul 03 10:14:05.631654 2015] [:error] [pid 28133:tid 139652430276352]
</I>&gt;<i> [client 192.168.20.129] ModSecurity: Warning. Pattern match &quot;(?i:[
</I>&gt;<i> /+\\\\t\\&quot;\\\\'`]style[
</I>&gt;<i> /+\\\\t]*?=.*([:=]|(&amp;#x?0*((58)|(3A)|(61)|(3D));?)).*?([(\\\\\\\\]|(&amp;#x?0*((40)|(28)|(92)|(5C));?)))&quot;
</I>&gt;<i> at ARGS:art_lid. [file
</I>&gt;<i> &quot;/etc/modsecurity/owasp-modsecurity-crs/activated_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;520&quot;] [id &quot;973316&quot;] [rev &quot;2&quot;] [msg &quot;IE XSS Filters - Attack
</I>&gt;<i> Detected.&quot;] [data &quot;Matched Data:  style=\\x22text-align: center\\x22&gt;&lt;span
</I>&gt;<i> style=\\x22color: rgb(128,0,0)\\x22&gt;&lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A>
</I>&gt;<i> target=\\x22_blank\\x22&gt;&lt;span style=\\x22color: rgb(128,0,0)\\x22&gt;Wybierasz
</I>&gt;<i> si\\xc4\\x99 za granic\\xc4\\x99?&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;br /&gt; &lt;a href=\\
</I>&gt;<i> x22<A HREF="http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22">http://www.emigracja.chrystusowcy.pl/index.php?option=com_sobi2&amp;Itemid=74\\x22</A>
</I>&gt;<i> target=\\x22_blank\\x22&gt;Szukasz Mszy \\xc5\\x9awi\\xc4\\x99tej w
</I>&gt;<i> j\\xc4\\x99zyku polskim? &lt;span style=\\x22color: rgb( found...&quot;] [ver
</I>&gt;<i> &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;8&quot;] [accuracy &quot;8&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/WEB_ATTACK/XSS&quot;] [tag &quot;WASCTC/WASC-8&quot;] [tag &quot;WASCTC/WASC-22&quot;]
</I>&gt;<i> [tag &quot;OWASP_TOP_10/A2&quot;] [tag [hostname &quot;XXXXXXXXXXXXX&quot;] [uri
</I>&gt;<i> &quot;/admin/index.php&quot;] [unique_id &quot;VZZETQoKASsAAG3lzAAAAADL&quot;]
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150703/8efbc1d5/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150703/8efbc1d5/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001783.html">[Owasp-modsecurity-core-rule-set] modsecurity - trouble with	SecRequestBodyAccess
</A></li>
	<LI>Next message: <A HREF="001786.html">[Owasp-modsecurity-core-rule-set] modsecurity - trouble	with	SecRequestBodyAccess
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1785">[ date ]</a>
              <a href="thread.html#1785">[ thread ]</a>
              <a href="subject.html#1785">[ subject ]</a>
              <a href="author.html#1785">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
