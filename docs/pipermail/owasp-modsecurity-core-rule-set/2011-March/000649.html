<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Questions about modsecurity rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Questions%20about%20modsecurity%0A%20rules&In-Reply-To=00c801cbe340%2436ab28f0%24a4017ad0%24%40com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000648.html">
   <LINK REL="Next"  HREF="000647.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Questions about modsecurity rules</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Questions%20about%20modsecurity%0A%20rules&In-Reply-To=00c801cbe340%2436ab28f0%24a4017ad0%24%40com"
       TITLE="[Owasp-modsecurity-core-rule-set] Questions about modsecurity rules">RBarnett at trustwave.com
       </A><BR>
    <I>Tue Mar 15 14:56:05 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000648.html">[Owasp-modsecurity-core-rule-set] Questions about modsecurity rules
</A></li>
        <LI>Next message: <A HREF="000647.html">[Owasp-modsecurity-core-rule-set] Announcing ModSecurity	Documentation Wiki
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#649">[ date ]</a>
              <a href="thread.html#649">[ thread ]</a>
              <a href="subject.html#649">[ subject ]</a>
              <a href="author.html#649">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 3/15/11 2:38 PM, &quot;Abdellah Tantan&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">adtantan at paydq.com</A>&gt; wrote:

&gt;<i>
</I>&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>Although I have read mod_security book by Ivan Restic, I feel I am still
</I>&gt;<i>very new to Mod_Security.
</I>
Ivan's book is very good for understanding how ModSecurity works however
it does not covert rulesets such as the OWASP ModSecurity CRS.  Have you
read the project documentation?
<A HREF="http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Pro">http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Pro</A>
ject#tab=Documentation
&gt;<i>
</I>
I also suggest that you review the comments in the
modsecurity_crs_10_config.conf file as it outlines what each section does
and the rationale.


&gt;<i>I am wondering why sending a simple request
</I>&gt;<i>triggered all these rules (see raw data bellow)?
</I>&gt;<i>if the request was marked
</I>&gt;<i>as critical, why it was not blocked? Any help to understand this is
</I>&gt;<i>appreciated,
</I>&gt;<i>
</I>&gt;<i>This is my main configuration file
</I>&gt;<i>
</I>&gt;<i>SecComponentSignature &quot;core ruleset/2.1.1&quot;
</I>&gt;<i>SecRuleEngine On
</I>&gt;<i>SecDefaultAction &quot;phase:2,pass,nolog,auditlog&quot;
</I>&gt;<i>SecAction &quot;phase:1,t:none,nolog,pass,setvar:tx.anomaly_score_blocking=on&quot;
</I>&gt;<i>SecAction &quot;phase:1,t:none,nolog,pass, \
</I>&gt;<i>setvar:tx.critical_anomaly_score=5, \
</I>&gt;<i>setvar:tx.error_anomaly_score=4, \
</I>&gt;<i>setvar:tx.warning_anomaly_score=3, \
</I>&gt;<i>setvar:tx.notice_anomaly_score=2&quot;
</I>&gt;<i>SecAction
</I>&gt;<i>&quot;phase:1,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_level=5&quot;
</I>&gt;<i>SecAction
</I>&gt;<i>&quot;phase:1,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_level=4&quot;
</I>
In the modsecurity_crs_10_config.conf file, you have the following section
for HTTP Policy settings -

#
# -=[ HTTP Policy Settings ]=-
#
# Set the following policy settings here and they will be propagated to
the 30 rules
# file (modsecurity_crs_30_http_policy.conf) by using macro expansion.
# If you run into false positves, you can adjust the settings here.
#
SecAction &quot;phase:1,t:none,nolog,pass, \
setvar:'tx.allowed_methods=GET HEAD POST OPTIONS', \
setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded
multipart/form-data text/xml application/xml application/x-amf', \
setvar:'tx.allowed_http_versions=HTTP/0.9 HTTP/1.0 HTTP/1.1', \
setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/ .backup/ .bak/
.bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/
.dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/
.key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/
.resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/
.xsd/ .xsx/', \
setvar:'tx.restricted_headers=/Proxy-Connection/ /Lock-Token/
/Content-Range/ /Translate/ /via/ /if/'&quot;


This is where you define the proper allowed http request methods for your
site.  One this is done, the rules in the
modsecurity_crs_30_http_policy.conf file enforces it using macro expansion
to inherit the settings you set in the 10 file -

# allow request methods
#
# TODO Most applications only use GET, HEAD, and POST request
#      methods. If that is not the case with your environment, you are
advised
#      to edit the line or uncomment it.
#
SecRule REQUEST_METHOD &quot;!@within %{tx.allowed_methods}&quot;
&quot;phase:2,t:none,block,msg:'Method is not allowed by policy',
severity:'2',id:'960032',tag:'POLICY/METHOD_NOT_ALLOWED',tag:'WASCTC/WASC-1
5',tag:'OWASP_TOP_10/A6',tag:'OWASP_AppSensor/RE1',tag:'PCI/12.1',logdata:'
%{matched_var}',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.w
arning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},s
etvar:tx.%{rule.id}-POLICY/METHOD_NOT_ALLOWED-%{matched_var_name}=%{matched
_var}&quot;


In your case, since you were not using the full
modsecurity_crs_10_config.conf file, you had not defined these TX settings
and thus the 30 file rule matched.


Also - to your question about why this was not blocked, it looks like you
aren't using the modsecurity_49_inbound_blocking.conf file.

-Ryan


&gt;<i>
</I>&gt;<i>
</I>&gt;<i>raw data bellow.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>--342fe054-A--
</I>&gt;<i>[15/Mar/2011:13:23:56 --0500] iAJfIgoAygIAAGstEDsAAAAC 66.37.224.199 52567
</I>&gt;<i>10.0.202.2 80
</I>&gt;<i>--342fe054-B--
</I>&gt;<i>GET /lpandl/images/buttons/login.gif HTTP/1.1
</I>&gt;<i>Host: 98.142.93.2
</I>&gt;<i>User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.2.15)
</I>&gt;<i>Gecko/20110303 Firefox/3.6.15
</I>&gt;<i>Accept: image/png,image/*;q=0.8,*/*;q=0.5
</I>&gt;<i>Accept-Language: en-us,en;q=0.5
</I>&gt;<i>Accept-Encoding: gzip,deflate
</I>&gt;<i>Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
</I>&gt;<i>Connection: keep-alive
</I>&gt;<i>Referer:
</I>&gt;<i><A HREF="https://98.142.93.2/lpandl/Logon.do;jsessionid=2D2A0F2EC20B323DEFE7901DB48">https://98.142.93.2/lpandl/Logon.do;jsessionid=2D2A0F2EC20B323DEFE7901DB48</A>
</I>&gt;<i>00
</I>&gt;<i>52E
</I>&gt;<i>Cookie: JSESSIONID=2D2A0F2EC20B323DEFE7901DB480052E
</I>&gt;<i>X-Forwarded-For: 66.37.224.199
</I>&gt;<i>Front-End-Https: On
</I>&gt;<i>
</I>&gt;<i>--342fe054-E--
</I>&gt;<i>
</I>&gt;<i>--342fe054-F--
</I>&gt;<i>HTTP/1.1 200 OK
</I>&gt;<i>ETag: W/&quot;929-1272484876000&quot;
</I>&gt;<i>Last-Modified: Wed, 28 Apr 2010 20:01:16 GMT
</I>&gt;<i>Content-Length: 929
</I>&gt;<i>Connection: close
</I>&gt;<i>Content-Type: image/gif
</I>&gt;<i>
</I>&gt;<i>--342fe054-H--
</I>&gt;<i>Message: Warning. Match of &quot;within %{tx.allowed_methods}&quot; against
</I>&gt;<i>&quot;REQUEST_METHOD&quot; required. [file
</I>&gt;<i>&quot;/etc/httpd/conf/modsecurity/rules/base_rules/modsecurity_crs_30_http_poli
</I>&gt;<i>cy
</I>&gt;<i>.conf&quot;] [line &quot;30&quot;] [id &quot;960032&quot;] [msg &quot;Method is not allowed by policy&quot;]
</I>&gt;<i>[data &quot;GET&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;POLICY/METHOD_NOT_ALLOWED&quot;] [tag
</I>&gt;<i>&quot;WASCTC/WASC-15&quot;] [tag &quot;OWASP_TOP_10/A6&quot;] [tag &quot;OWASP_AppSensor/RE1&quot;] [tag
</I>&gt;<i>&quot;PCI/12.1&quot;]
</I>&gt;<i>Message: Warning. Match of &quot;within %{tx.allowed_http_versions}&quot; against
</I>&gt;<i>&quot;REQUEST_PROTOCOL&quot; required. [file
</I>&gt;<i>&quot;/etc/httpd/conf/modsecurity/rules/base_rules/modsecurity_crs_30_http_poli
</I>&gt;<i>cy
</I>&gt;<i>.conf&quot;] [line &quot;77&quot;] [id &quot;960034&quot;] [msg &quot;HTTP protocol version is not
</I>&gt;<i>allowed
</I>&gt;<i>by policy&quot;] [data &quot;HTTP/1.1&quot;] [severity &quot;CRITICAL&quot;] [tag
</I>&gt;<i>&quot;POLICY/PROTOCOL_NOT_ALLOWED&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag
</I>&gt;<i>&quot;OWASP_TOP_10/A6&quot;] [tag &quot;PCI/6.5.10&quot;]
</I>&gt;<i>Apache-Handler: jakarta-servlet
</I>&gt;<i>Stopwatch: 1300213436407586 8794 (450 5600 -)
</I>&gt;<i>Response-Body-Transformed: Dechunked
</I>&gt;<i>Producer: ModSecurity for Apache/2.5.12 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>).
</I>&gt;<i>Server: Apache/2.2.3 (CentOS)
</I>&gt;<i>
</I>&gt;<i>--342fe054-K--
</I>&gt;<i>SecRule &quot;REQUEST_METHOD&quot; &quot;@rx ^(?:GET|HEAD)$&quot;
</I>&gt;<i>&quot;phase:1,log,auditlog,chain,rev:2.1.1,t:none,block,msg:'GET or HEAD
</I>&gt;<i>requests
</I>&gt;<i>with
</I>&gt;<i>bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION,tag:WASCTC/WAS
</I>&gt;<i>C-
</I>&gt;<i>21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,tag:<A HREF="http://www.w3.org/Protocols/rfc2">http://www.w3.org/Protocols/rfc2</A>
</I>&gt;<i>61
</I>&gt;<i>6/rfc2616-sec4.html#sec4.3&quot;
</I>&gt;<i>SecRule &quot;REQUEST_METHOD&quot; &quot;!@rx ^OPTIONS$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,rev:2.1.1,t:none,block,msg:'Request Missing an
</I>&gt;<i>Accept
</I>&gt;<i>Header',severity:2,id:960015,tag:PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT,
</I>&gt;<i>ta
</I>&gt;<i>g:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10&quot;
</I>&gt;<i>SecRule &quot;&amp;REQUEST_HEADERS:Content-Type&quot; &quot;@eq 0&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,rev:2.1.1,t:none,block,msg:'Request Containing
</I>&gt;<i>Content, but Missing Content-Type header',id:960904,severity:5&quot;
</I>&gt;<i>SecRule &quot;REQUEST_METHOD&quot; &quot;!@within %{tx.allowed_methods}&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,t:none,block,msg:'Method is not allowed by
</I>&gt;<i>policy',severity:2,id:960032,tag:POLICY/METHOD_NOT_ALLOWED,tag:WASCTC/WASC
</I>&gt;<i>-1
</I>&gt;<i>5,tag:OWASP_TOP_10/A6,tag:OWASP_AppSensor/RE1,tag:PCI/12.1,logdata:%{match
</I>&gt;<i>ed
</I>&gt;<i>_var},setvar:tx.msg=%{rule.msg},setvar:tx.anomaly_score=+%{tx.warning_anom
</I>&gt;<i>al
</I>&gt;<i>y_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{r
</I>&gt;<i>ul
</I>&gt;<i>e.id}-POLICY/METHOD_NOT_ALLOWED-%{matched_var_name}=%{matched_var}&quot;
</I>&gt;<i>SecRule &quot;REQUEST_PROTOCOL&quot; &quot;!@within %{tx.allowed_http_versions}&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,t:none,block,msg:'HTTP protocol version is not
</I>&gt;<i>allowed
</I>&gt;<i>by
</I>&gt;<i>policy',severity:2,id:960034,tag:POLICY/PROTOCOL_NOT_ALLOWED,tag:WASCTC/WA
</I>&gt;<i>SC
</I>&gt;<i>-21,tag:OWASP_TOP_10/A6,tag:PCI/6.5.10,logdata:%{matched_var},setvar:tx.ms
</I>&gt;<i>g=
</I>&gt;<i>%{rule.msg},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx
</I>&gt;<i>.p
</I>&gt;<i>olicy_score=+%{tx.warning_anomaly_score},setvar:tx.%{rule.id}-POLICY/PROTO
</I>&gt;<i>CO
</I>&gt;<i>L_NOT_ALLOWED-%{matched_var_name}=%{matched_var}&quot;
</I>&gt;<i>SecRule &quot;REQUEST_BASENAME&quot; &quot;@rx \\.(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,capture,setvar:tx.extension=.%{tx.1}/,t:none,t
</I>&gt;:<i>u
</I>&gt;<i>rlDecodeUni,t:lowercase,block,msg:'URL file extension is restricted by
</I>&gt;<i>policy',severity:2,id:960035,tag:POLICY/EXT_RESTRICTED,tag:WASCTC/WASC-15,
</I>&gt;<i>ta
</I>&gt;<i>g:OWASP_TOP_10/A7,tag:PCI/6.5.10,logdata:%{TX.0}&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i>&quot;phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by
</I>&gt;<i>policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWE
</I>&gt;<i>D,
</I>&gt;<i>tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag
</I>&gt;:<i>O
</I>&gt;<i>WASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setv
</I>&gt;<i>ar
</I>&gt;:<i>tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i>SecRule &quot;RESPONSE_BODY&quot; &quot;!@pm iframe&quot;
</I>&gt;<i>&quot;phase:4,auditlog,rev:2.1.1,t:none,capture,t:urlDecodeUni,t:htmlEntityDeco
</I>&gt;<i>de
</I>&gt;<i>,t:lowercase,nolog,skipAfter:END_IFRAME_CHECK&quot;
</I>&gt;<i>SecRule &quot;RESPONSE_BODY&quot; &quot;!@pmFromFile modsecurity_50_outbound.data&quot;
</I>&gt;<i>&quot;phase:4,auditlog,rev:2.1.1,t:none,capture,t:urlDecodeUni,t:htmlEntityDeco
</I>&gt;<i>de
</I>&gt;<i>,nolog,skipAfter:END_OUTBOUND_CHECK&quot;
</I>&gt;<i>
</I>&gt;<i>--342fe054-Z--
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000648.html">[Owasp-modsecurity-core-rule-set] Questions about modsecurity rules
</A></li>
	<LI>Next message: <A HREF="000647.html">[Owasp-modsecurity-core-rule-set] Announcing ModSecurity	Documentation Wiki
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#649">[ date ]</a>
              <a href="thread.html#649">[ thread ]</a>
              <a href="subject.html#649">[ subject ]</a>
              <a href="author.html#649">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
