<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.1.1%20Brute%20Force%20rules%0A%20not%20blocking%20requests&In-Reply-To=AANLkTik7Li2vvntrOqNZP82q97%2BF6udFiX2jvd0E2b51%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000660.html">
   <LINK REL="Next"  HREF="000662.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests</H1>
    <B>Yonah Russ</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.1.1%20Brute%20Force%20rules%0A%20not%20blocking%20requests&In-Reply-To=AANLkTik7Li2vvntrOqNZP82q97%2BF6udFiX2jvd0E2b51%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests">owasp at yonahruss.com
       </A><BR>
    <I>Mon Mar 21 07:14:50 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000660.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
        <LI>Next message: <A HREF="000662.html">[Owasp-modsecurity-core-rule-set] [JIRA] Resolved: (CORERULES-67)	Unique Request ID
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#661">[ date ]</a>
              <a href="thread.html#661">[ thread ]</a>
              <a href="subject.html#661">[ subject ]</a>
              <a href="author.html#661">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I've done some more digging and found the following.

If I move the phase 5 rules in the brute force rule set to phase 1, then the
rules almost work.

There is an additional incompatibility with the anomaly based scoring/block
mode since the brute force rules use block instead of drop.
The dos protection rules use drop which I think is more appropriate although
a combination of both raising the anomaly level and dropping the request
might be appropriate.

What do you suggest?
Thanks,
Yonah



&gt;<i> On Mon, Mar 21, 2011 at 1:05 PM, Yonah Russ &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> (repost with zipped logs)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Hi,
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I went looking for more related log messages and at first I didn't find
</I>&gt;&gt;<i> any, so I disabled all the rule sets except the brute force rules, cleared
</I>&gt;&gt;<i> the logs,  and I see something strange.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I only made one request to the 'friendly url' /protected/url but when the
</I>&gt;&gt;<i> debug log hits the logging phase the request(?) changes to the actual file
</I>&gt;&gt;<i> name of the content engine (/engine.php):
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Recipe: Invoking rule 167a60; [file &quot;/opt/www/conf/modsecurity_
</I>&gt;&gt;<i>  crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;] [line &quot;22&quot;].
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5</A>&gt;]
</I>&gt;&gt;<i> Rule 167a60: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;&gt;<i> &quot;phase:1,log,noauditlog,chain,block,msg:'Brute Force Attack Identified from
</I>&gt;&gt;<i> %{remote_addr} (%{tx.brute_force_block_counter} hits since last
</I>&gt;&gt;<i> alert)',setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Rule returned 0.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> No match, chained -&gt; mode NEXT_CHAIN.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Recipe: Invoking rule 1699a0; [file
</I>&gt;&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
</I>&gt;&gt;<i> [line &quot;27&quot;].
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5</A>&gt;]
</I>&gt;&gt;<i> Rule 1699a0: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;&gt;<i> &quot;phase:1,noauditlog,block,nolog,setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Rule returned 0.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> No match, not chained -&gt; mode NEXT_RULE.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> PdfProtect: Not enabled here.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Second phase starting (dcfg e5e10).
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Input filter: This request does not have a body.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Time #1: 36569
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Starting phase REQUEST_BODY.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> This phase consists of 1 rule(s).
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Time #2: 36917
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Hook insert_filter: Adding PDF XSS protection output filter (r 368d68).
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Hook insert_filter: Adding output filter (r 368d68).
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Initialising logging.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Starting phase LOGGING.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> This phase consists of 7 rule(s).
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Recipe: Invoking rule 16c0f0; [file
</I>&gt;&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
</I>&gt;&gt;<i> [line &quot;37&quot;].
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5</A>&gt;]
</I>&gt;&gt;<i> Rule 16c0f0: SecRule &quot;&amp;TX:BRUTE_FORCE_PROTECTED_URLS&quot; &quot;@eq 0&quot;
</I>&gt;&gt;<i> &quot;phase:5,noauditlog,t:none,nolog,skipAfter:END_BRUTE_FORCE_PROTECTION_CHECKS&quot;
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Transformation completed in 7 usec.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Executing operator &quot;eq&quot; with param &quot;0&quot; against
</I>&gt;&gt;<i> &amp;TX:BRUTE_FORCE_PROTECTED_URLS.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Target value: &quot;1&quot;
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Operator completed in 12 usec.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Rule returned 0.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> No match, not chained -&gt; mode NEXT_RULE.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Recipe: Invoking rule 16c9f8; [file
</I>&gt;&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
</I>&gt;&gt;<i> [line &quot;38&quot;].
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5</A>&gt;]
</I>&gt;&gt;<i> Rule 16c9f8: SecRule &quot;REQUEST_FILENAME&quot; &quot;!@within
</I>&gt;&gt;<i> %{tx.brute_force_protected_urls}&quot;
</I>&gt;&gt;<i> &quot;phase:5,noauditlog,t:none,nolog,skipAfter:END_BRUTE_FORCE_PROTECTION_CHECKS&quot;
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Transformation completed in 4 usec.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Executing operator &quot;!within&quot; with param &quot;%{tx.brute_force_protected_urls}&quot;
</I>&gt;&gt;<i> against REQUEST_FILENAME.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Target value: &quot;/engine.php&quot;
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Resolved macro %{tx.brute_force_protected_urls} to: /protected/url
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Operator completed in 593 usec.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Warning. Match of &quot;within %{tx.brute_force_protected_urls}&quot; against
</I>&gt;&gt;<i> &quot;REQUEST_FILENAME&quot; required. [file
</I>&gt;&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
</I>&gt;&gt;<i> [line &quot;38&quot;]
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Rule returned 1.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Skipping after rule 16c9f8 id=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; -&gt; mode
</I>&gt;&gt;<i> SKIP_RULES.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
</I>&gt;&gt;<i> SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
</I>&gt;&gt;<i> SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
</I>&gt;&gt;<i> SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
</I>&gt;&gt;<i> SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Found rule 176a48 id=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot;.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Continuing execution after rule id=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot;.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
</I>&gt;&gt;<i> Audit log: Logging this transaction.
</I>&gt;&gt;<i> [21/Mar/2011:09:35:58 +0000] [
</I>&gt;&gt;<i> 192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
</I>&gt;&gt;<i> Audit Log: Writing 256 bytes to primary concurrent index
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I've attached the sanitized debug and audit logs for the request.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Also- here is the rewrite rule which sends friendly-url requests to the
</I>&gt;&gt;<i> content engine:
</I>&gt;&gt;<i>     RewriteCond %{REQUEST_FILENAME} !-f
</I>&gt;&gt;<i>     RewriteRule ^(.*)$ /engine.php?q=$1 [L,QSA]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> Yonah
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Sun, Mar 20, 2011 at 10:26 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The brute force rules that count the # of requests and set the block
</I>&gt;&gt;&gt;<i> variable actually run in phase 5 logging.  The section of the debug log you
</I>&gt;&gt;&gt;<i> showed was from phase 1 where it is deciding to block or not.  Please check
</I>&gt;&gt;&gt;<i> later on in the debug log to see how these rules are working.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Mar 20, 2011, at 1:40 PM, Yonah Russ &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The short answer is that there are are no directories defined - just full
</I>&gt;&gt;&gt;<i> paths.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The long answer is that there are also no actual filenames- the requests
</I>&gt;&gt;&gt;<i> are handled by a content engine doing friendly urls. The defined urls are
</I>&gt;&gt;&gt;<i> the friendly ones- so apache gets a request for &lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/protected_url">http://www.site.com/protected_url</A>&gt; www.site.com/protected_url&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/protected_url">http://www.site.com/protected_url</A>&gt; and uses mod_rewrite to send it to
</I>&gt;&gt;&gt;<i> engine.php - Does that make a difference for REQUEST_FILENAME?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Thanks,
</I>&gt;&gt;&gt;<i> Yonah
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Sun, Mar 20, 2011 at 3:56 PM, Ryan Barnett &lt;&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;&gt; wrote:
</I>&gt;&gt;&gt;<i> Are your protected URLs that you define in the 10 file setvars full paths
</I>&gt;&gt;&gt;<i> to the login page(s)?  The check in the brute force file checks these
</I>&gt;&gt;&gt;<i> variables against the REQUEST_FILENAME of the current transaction. You
</I>&gt;&gt;&gt;<i> sanitized your example configs (/protected_url) so I am not sure if you
</I>&gt;&gt;&gt;<i> defined a filename or a directory.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> An audit log entry would help.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Mar 20, 2011, at 5:51 AM, Yonah Russ &lt;&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;&lt;mailto:&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;&gt;&gt;
</I>&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm using 2.5.13 with CRS 2.1.1
</I>&gt;&gt;&gt;<i> I've configured the following:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> SecAction &quot;phase:1,t:none,nolog,pass, \
</I>&gt;&gt;&gt;<i> setvar:'tx.brute_force_protected_urls=/protected_url /protected_url2', \
</I>&gt;&gt;&gt;<i> setvar:'tx.brute_force_burst_time_slice=60', \
</I>&gt;&gt;&gt;<i> setvar:'tx.brute_force_counter_threshold=5', \
</I>&gt;&gt;&gt;<i> setvar:'tx.brute_force_block_timeout=300'&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> When I test, all the requests get through and not even a message in the
</I>&gt;&gt;&gt;<i> logs :(
</I>&gt;&gt;&gt;<i> Here is an excerpt from the debug log:
</I>&gt;&gt;&gt;<i> ...
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Setting variable: tx.brute_force_protected_urls=/protected_url
</I>&gt;&gt;&gt;<i> /protected_url2
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;&gt;&gt;<i> variable &quot;tx.brute_force_protected_urls&quot; to &quot;/protected_url
</I>&gt;&gt;&gt;<i> /protected_url2&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Setting variable: tx.brute_force_burst_time_slice=60
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;&gt;&gt;<i> variable &quot;tx.brute_force_burst_time_slice&quot; to &quot;60&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Setting variable: tx.brute_force_counter_threshold=5
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;&gt;&gt;<i> variable &quot;tx.brute_force_counter_threshold&quot; to &quot;5&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Setting variable: tx.brute_force_block_timeout=300
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;&gt;&gt;<i> variable &quot;tx.brute_force_block_timeout&quot; to &quot;300&quot;.
</I>&gt;&gt;&gt;<i> ...
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;]
</I>&gt;&gt;&gt;<i> Creating collection (name &quot;global&quot;, key &quot;global&quot;).
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Recorded original collection variable: global.UPDATE_COUNTER = &quot;0&quot;
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Added
</I>&gt;&gt;&gt;<i> collection &quot;global&quot; to the list.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Resolved macro %{remote_addr} to: 192.168.1.1
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Resolved macro %{tx.ua_hash} to: 3dcbbff145dcf13aa6287b931eb296b39b7541ee
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;__expire_KEY&quot;, value &quot;1300615158&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;KEY&quot;, value
</I>&gt;&gt;&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;TIMEOUT&quot;, value &quot;3600&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;__key&quot;, value
</I>&gt;&gt;&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;__name&quot;, value &quot;ip&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;CREATE_TIME&quot;, value &quot;1300607334&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;UPDATE_COUNTER&quot;, value &quot;75&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;dos_counter&quot;, value &quot;75&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;&gt;&gt;<i> variable: name &quot;LAST_UPDATE_TIME&quot;, value &quot;1300611558&quot;.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;]
</I>&gt;&gt;&gt;<i> Retrieved collection (name &quot;ip&quot;, key
</I>&gt;&gt;&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;).
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;]
</I>&gt;&gt;&gt;<i> Recorded original collection variable: ip.UPDATE_COUNTER = &quot;75&quot;
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Added
</I>&gt;&gt;&gt;<i> collection &quot;ip&quot; to the list.
</I>&gt;&gt;&gt;<i> ...
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B5">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B5</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;&gt;&gt;<i> 240d78: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;&gt;&gt;<i> &quot;phase:1,log,noauditlog,chain,block,msg:'Brute Force Attack Identified from
</I>&gt;&gt;&gt;<i> %{remote_addr} (%{tx.brute_force_block_counter} hits since last
</I>&gt;&gt;&gt;<i> alert)',setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;&gt;&gt;<i> returned 0.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] No
</I>&gt;&gt;&gt;<i> match, chained -&gt; mode NEXT_CHAIN.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;]
</I>&gt;&gt;&gt;<i> Recipe: Invoking rule 244cd8; [file
</I>&gt;&gt;&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
</I>&gt;&gt;&gt;<i> [line &quot;27&quot;].
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B5">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B5</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;&gt;&gt;<i> 244cd8: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;&gt;&gt;<i> &quot;phase:1,noauditlog,block,nolog,setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;&gt;&gt;<i> returned 0.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B9</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] No
</I>&gt;&gt;&gt;<i> match, not chained -&gt; mode NEXT_RULE.
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;]
</I>&gt;&gt;&gt;<i> Recipe: Invoking rule 250338; [file
</I>&gt;&gt;&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_dos_protection.conf&quot;]
</I>&gt;&gt;&gt;<i> [line &quot;11&quot;].
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B5">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B5</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;&gt;&gt;<i> 250338: SecRule &quot;IP:DOS_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;&gt;&gt;<i> &quot;phase:1,log,noauditlog,chain,drop,msg:'Denial of Service (DoS) Attack
</I>&gt;&gt;&gt;<i> Identified from %{remote_addr} (%{tx.dos_block_counter} hits since last
</I>&gt;&gt;&gt;<i> alert)',setvar:ip.dos_block_counter=+1&quot;
</I>&gt;&gt;&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;<A HREF="http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4">http://www.site.com/sid#12b7778][rid%2319211a0%5D%5B/protected_url%5D%5B4</A>&gt;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;&gt;&gt;<i> returned 0.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> &gt;From what I can see, the request never hits the section of rules which
</I>&gt;&gt;&gt;<i> should start counting the requests to the protected url. Instead, it skips
</I>&gt;&gt;&gt;<i> to the next ruleset?
</I>&gt;&gt;&gt;<i> Thanks in advance,
</I>&gt;&gt;&gt;<i> Yonah
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&lt;mailto:&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
</I>&gt;&gt;&gt;<i> &lt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________
</I>&gt;&gt;&gt;<i> This transmission may contain information that is privileged,
</I>&gt;&gt;&gt;<i> confidential, and/or exempt from disclosure under applicable law. If you are
</I>&gt;&gt;&gt;<i> not the intended recipient, you are hereby notified that any disclosure,
</I>&gt;&gt;&gt;<i> copying, distribution, or use of the information contained herein (including
</I>&gt;&gt;&gt;<i> any reliance thereon) is STRICTLY PROHIBITED. If you received this
</I>&gt;&gt;&gt;<i> transmission in error, please immediately contact the sender and destroy the
</I>&gt;&gt;&gt;<i> material in its entirety, whether in electronic or hard copy format.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> ________________________________
</I>&gt;&gt;&gt;<i> This transmission may contain information that is privileged,
</I>&gt;&gt;&gt;<i> confidential, and/or exempt from disclosure under applicable law. If you are
</I>&gt;&gt;&gt;<i> not the intended recipient, you are hereby notified that any disclosure,
</I>&gt;&gt;&gt;<i> copying, distribution, or use of the information contained herein (including
</I>&gt;&gt;&gt;<i> any reliance thereon) is STRICTLY PROHIBITED. If you received this
</I>&gt;&gt;&gt;<i> transmission in error, please immediately contact the sender and destroy the
</I>&gt;&gt;&gt;<i> material in its entirety, whether in electronic or hard copy format.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110321/58b846b2/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110321/58b846b2/attachment-0001.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000660.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
	<LI>Next message: <A HREF="000662.html">[Owasp-modsecurity-core-rule-set] [JIRA] Resolved: (CORERULES-67)	Unique Request ID
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#661">[ date ]</a>
              <a href="thread.html#661">[ thread ]</a>
              <a href="subject.html#661">[ subject ]</a>
              <a href="author.html#661">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
