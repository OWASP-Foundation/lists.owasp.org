<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.1.1%20Brute%20Force%20rules%0A%20not%20blocking%20requests&In-Reply-To=78F150E6-842C-428B-80DE-74334F8DAF88%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000658.html">
   <LINK REL="Next"  HREF="000661.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests</H1>
    <B>Yonah Russ</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.1.1%20Brute%20Force%20rules%0A%20not%20blocking%20requests&In-Reply-To=78F150E6-842C-428B-80DE-74334F8DAF88%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests">owasp at yonahruss.com
       </A><BR>
    <I>Mon Mar 21 07:05:11 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000658.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
        <LI>Next message: <A HREF="000661.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#660">[ date ]</a>
              <a href="thread.html#660">[ thread ]</a>
              <a href="subject.html#660">[ subject ]</a>
              <a href="author.html#660">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>(repost with zipped logs)
Hi,

I went looking for more related log messages and at first I didn't find any,
so I disabled all the rule sets except the brute force rules, cleared the
logs,  and I see something strange.

I only made one request to the 'friendly url' /protected/url but when the
debug log hits the logging phase the request(?) changes to the actual file
name of the content engine (/engine.php):
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Recipe: Invoking rule 167a60; [file &quot;/opt/www/conf/modsecurity_
crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;] [line &quot;22&quot;].
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5</A>&gt;]
Rule 167a60: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
&quot;phase:1,log,noauditlog,chain,block,msg:'Brute Force Attack Identified from
%{remote_addr} (%{tx.brute_force_block_counter} hits since last
alert)',setvar:ip.brute_force_block_counter=+1&quot;
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Rule returned 0.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9</A>&gt;]
No match, chained -&gt; mode NEXT_CHAIN.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Recipe: Invoking rule 1699a0; [file
&quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
[line &quot;27&quot;].
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B5</A>&gt;]
Rule 1699a0: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
&quot;phase:1,noauditlog,block,nolog,setvar:ip.brute_force_block_counter=+1&quot;
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Rule returned 0.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9</A>&gt;]
No match, not chained -&gt; mode NEXT_RULE.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
PdfProtect: Not enabled here.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Second phase starting (dcfg e5e10).
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Input filter: This request does not have a body.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Time #1: 36569
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Starting phase REQUEST_BODY.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B9</A>&gt;]
This phase consists of 1 rule(s).
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Time #2: 36917
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Hook insert_filter: Adding PDF XSS protection output filter (r 368d68).
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Hook insert_filter: Adding output filter (r 368d68).
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#368d68][/protected/url][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23368d68%5D%5B/protected/url%5D%5B4</A>&gt;]
Initialising logging.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Starting phase LOGGING.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
This phase consists of 7 rule(s).
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Recipe: Invoking rule 16c0f0; [file
&quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
[line &quot;37&quot;].
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5</A>&gt;]
Rule 16c0f0: SecRule &quot;&amp;TX:BRUTE_FORCE_PROTECTED_URLS&quot; &quot;@eq 0&quot;
&quot;phase:5,noauditlog,t:none,nolog,skipAfter:END_BRUTE_FORCE_PROTECTION_CHECKS&quot;
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Transformation completed in 7 usec.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Executing operator &quot;eq&quot; with param &quot;0&quot; against
&amp;TX:BRUTE_FORCE_PROTECTED_URLS.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Target value: &quot;1&quot;
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Operator completed in 12 usec.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Rule returned 0.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
No match, not chained -&gt; mode NEXT_RULE.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Recipe: Invoking rule 16c9f8; [file
&quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
[line &quot;38&quot;].
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][5&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B5</A>&gt;]
Rule 16c9f8: SecRule &quot;REQUEST_FILENAME&quot; &quot;!@within
%{tx.brute_force_protected_urls}&quot;
&quot;phase:5,noauditlog,t:none,nolog,skipAfter:END_BRUTE_FORCE_PROTECTION_CHECKS&quot;
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Transformation completed in 4 usec.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Executing operator &quot;!within&quot; with param &quot;%{tx.brute_force_protected_urls}&quot;
against REQUEST_FILENAME.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Target value: &quot;/engine.php&quot;
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Resolved macro %{tx.brute_force_protected_urls} to: /protected/url
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Operator completed in 593 usec.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Warning. Match of &quot;within %{tx.brute_force_protected_urls}&quot; against
&quot;REQUEST_FILENAME&quot; required. [file
&quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
[line &quot;38&quot;]
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Rule returned 1.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Skipping after rule 16c9f8 id=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; -&gt; mode
SKIP_RULES.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Current rule is id=&quot;(null)&quot; [chained 0] is trying to find the
SecMarker=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot; [stater 0]
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Found rule 176a48 id=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot;.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Continuing execution after rule id=&quot;END_BRUTE_FORCE_PROTECTION_CHECKS&quot;.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][4&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B4</A>&gt;]
Audit log: Logging this transaction.
[21/Mar/2011:09:35:58 +0000] [
192.168.1.10/sid#1cc6e0][rid#382e88][/engine.php][9&lt;<A HREF="http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9">http://192.168.1.10/sid#1cc6e0][rid%23382e88%5D%5B/engine.php%5D%5B9</A>&gt;]
Audit Log: Writing 256 bytes to primary concurrent index


I've attached the sanitized debug and audit logs for the request.

Also- here is the rewrite rule which sends friendly-url requests to the
content engine:
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ /engine.php?q=$1 [L,QSA]

Thanks,
Yonah


On Sun, Mar 20, 2011 at 10:26 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;wrote:

&gt;<i> The brute force rules that count the # of requests and set the block
</I>&gt;<i> variable actually run in phase 5 logging.  The section of the debug log you
</I>&gt;<i> showed was from phase 1 where it is deciding to block or not.  Please check
</I>&gt;<i> later on in the debug log to see how these rules are working.
</I>&gt;<i>
</I>&gt;<i> On Mar 20, 2011, at 1:40 PM, Yonah Russ &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> The short answer is that there are are no directories defined - just full
</I>&gt;<i> paths.
</I>&gt;<i>
</I>&gt;<i> The long answer is that there are also no actual filenames- the requests
</I>&gt;<i> are handled by a content engine doing friendly urls. The defined urls are
</I>&gt;<i> the friendly ones- so apache gets a request for &lt;
</I>&gt;<i> <A HREF="http://www.site.com/protected_url">http://www.site.com/protected_url</A>&gt; www.site.com/protected_url&lt;
</I>&gt;<i> <A HREF="http://www.site.com/protected_url">http://www.site.com/protected_url</A>&gt; and uses mod_rewrite to send it to
</I>&gt;<i> engine.php - Does that make a difference for REQUEST_FILENAME?
</I>&gt;<i>
</I>&gt;<i> Thanks,
</I>&gt;<i> Yonah
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Sun, Mar 20, 2011 at 3:56 PM, Ryan Barnett &lt;&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;&gt; wrote:
</I>&gt;<i> Are your protected URLs that you define in the 10 file setvars full paths
</I>&gt;<i> to the login page(s)?  The check in the brute force file checks these
</I>&gt;<i> variables against the REQUEST_FILENAME of the current transaction. You
</I>&gt;<i> sanitized your example configs (/protected_url) so I am not sure if you
</I>&gt;<i> defined a filename or a directory.
</I>&gt;<i>
</I>&gt;<i> An audit log entry would help.
</I>&gt;<i>
</I>&gt;<i> On Mar 20, 2011, at 5:51 AM, Yonah Russ &lt;&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;&lt;mailto:&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;&gt;&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm using 2.5.13 with CRS 2.1.1
</I>&gt;<i> I've configured the following:
</I>&gt;<i>
</I>&gt;<i> SecAction &quot;phase:1,t:none,nolog,pass, \
</I>&gt;<i> setvar:'tx.brute_force_protected_urls=/protected_url /protected_url2', \
</I>&gt;<i> setvar:'tx.brute_force_burst_time_slice=60', \
</I>&gt;<i> setvar:'tx.brute_force_counter_threshold=5', \
</I>&gt;<i> setvar:'tx.brute_force_block_timeout=300'&quot;
</I>&gt;<i>
</I>&gt;<i> When I test, all the requests get through and not even a message in the
</I>&gt;<i> logs :(
</I>&gt;<i> Here is an excerpt from the debug log:
</I>&gt;<i> ...
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_protected_urls=/protected_url /protected_url2
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_protected_urls&quot; to &quot;/protected_url
</I>&gt;<i> /protected_url2&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_burst_time_slice=60
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_burst_time_slice&quot; to &quot;60&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_counter_threshold=5
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_counter_threshold&quot; to &quot;5&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_block_timeout=300
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_block_timeout&quot; to &quot;300&quot;.
</I>&gt;<i> ...
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Creating
</I>&gt;<i> collection (name &quot;global&quot;, key &quot;global&quot;).
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Recorded
</I>&gt;<i> original collection variable: global.UPDATE_COUNTER = &quot;0&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Added
</I>&gt;<i> collection &quot;global&quot; to the list.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Resolved
</I>&gt;<i> macro %{remote_addr} to: 192.168.1.1
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Resolved
</I>&gt;<i> macro %{tx.ua_hash} to: 3dcbbff145dcf13aa6287b931eb296b39b7541ee
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;__expire_KEY&quot;, value &quot;1300615158&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;KEY&quot;, value
</I>&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;TIMEOUT&quot;, value &quot;3600&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;__key&quot;, value
</I>&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;__name&quot;, value &quot;ip&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;CREATE_TIME&quot;, value &quot;1300607334&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;UPDATE_COUNTER&quot;, value &quot;75&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;dos_counter&quot;, value &quot;75&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;LAST_UPDATE_TIME&quot;, value &quot;1300611558&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;]
</I>&gt;<i> Retrieved collection (name &quot;ip&quot;, key
</I>&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;).
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Recorded
</I>&gt;<i> original collection variable: ip.UPDATE_COUNTER = &quot;75&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Added
</I>&gt;<i> collection &quot;ip&quot; to the list.
</I>&gt;<i> ...
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;<i> 240d78: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:1,log,noauditlog,chain,block,msg:'Brute Force Attack Identified from
</I>&gt;<i> %{remote_addr} (%{tx.brute_force_block_counter} hits since last
</I>&gt;<i> alert)',setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;<i> returned 0.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] No
</I>&gt;<i> match, chained -&gt; mode NEXT_CHAIN.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Recipe:
</I>&gt;<i> Invoking rule 244cd8; [file
</I>&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
</I>&gt;<i> [line &quot;27&quot;].
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;<i> 244cd8: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:1,noauditlog,block,nolog,setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;<i> returned 0.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] No
</I>&gt;<i> match, not chained -&gt; mode NEXT_RULE.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Recipe:
</I>&gt;<i> Invoking rule 250338; [file
</I>&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_dos_protection.conf&quot;]
</I>&gt;<i> [line &quot;11&quot;].
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;<i> 250338: SecRule &quot;IP:DOS_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:1,log,noauditlog,chain,drop,msg:'Denial of Service (DoS) Attack
</I>&gt;<i> Identified from %{remote_addr} (%{tx.dos_block_counter} hits since last
</I>&gt;<i> alert)',setvar:ip.dos_block_counter=+1&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;&lt;&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;<i> returned 0.
</I>&gt;<i>
</I>&gt;<i> &gt;From what I can see, the request never hits the section of rules which
</I>&gt;<i> should start counting the requests to the protected url. Instead, it skips
</I>&gt;<i> to the next ruleset?
</I>&gt;<i> Thanks in advance,
</I>&gt;<i> Yonah
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&lt;mailto:&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i> This transmission may contain information that is privileged, confidential,
</I>&gt;<i> and/or exempt from disclosure under applicable law. If you are not the
</I>&gt;<i> intended recipient, you are hereby notified that any disclosure, copying,
</I>&gt;<i> distribution, or use of the information contained herein (including any
</I>&gt;<i> reliance thereon) is STRICTLY PROHIBITED. If you received this transmission
</I>&gt;<i> in error, please immediately contact the sender and destroy the material in
</I>&gt;<i> its entirety, whether in electronic or hard copy format.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i> This transmission may contain information that is privileged, confidential,
</I>&gt;<i> and/or exempt from disclosure under applicable law. If you are not the
</I>&gt;<i> intended recipient, you are hereby notified that any disclosure, copying,
</I>&gt;<i> distribution, or use of the information contained herein (including any
</I>&gt;<i> reliance thereon) is STRICTLY PROHIBITED. If you received this transmission
</I>&gt;<i> in error, please immediately contact the sender and destroy the material in
</I>&gt;<i> its entirety, whether in electronic or hard copy format.
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110321/d3489ebe/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110321/d3489ebe/attachment-0001.html</A> 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: logs.zip
Type: application/zip
Size: 4502 bytes
Desc: not available
Url : <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110321/d3489ebe/attachment-0001.zip">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110321/d3489ebe/attachment-0001.zip</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000658.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
	<LI>Next message: <A HREF="000661.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#660">[ date ]</a>
              <a href="thread.html#660">[ thread ]</a>
              <a href="subject.html#660">[ subject ]</a>
              <a href="author.html#660">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
