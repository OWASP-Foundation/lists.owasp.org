<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.1.1%20Brute%20Force%20rules%0A%20not%20blocking%20requests&In-Reply-To=D2DE2415-CDD2-4B24-8E22-C5EE345C8115%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000656.html">
   <LINK REL="Next"  HREF="000658.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests</H1>
    <B>Yonah Russ</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%202.1.1%20Brute%20Force%20rules%0A%20not%20blocking%20requests&In-Reply-To=D2DE2415-CDD2-4B24-8E22-C5EE345C8115%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests">owasp at yonahruss.com
       </A><BR>
    <I>Sun Mar 20 13:40:57 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000656.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
        <LI>Next message: <A HREF="000658.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#657">[ date ]</a>
              <a href="thread.html#657">[ thread ]</a>
              <a href="subject.html#657">[ subject ]</a>
              <a href="author.html#657">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

The short answer is that there are are no directories defined - just full
paths.

The long answer is that there are also no actual filenames- the requests are
handled by a content engine doing friendly urls. The defined urls are the
friendly ones- so apache gets a request for www.site.com/protected_url and
uses mod_rewrite to send it to engine.php - Does that make a difference for
REQUEST_FILENAME?

Thanks,
Yonah


On Sun, Mar 20, 2011 at 3:56 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;wrote:

&gt;<i> Are your protected URLs that you define in the 10 file setvars full paths
</I>&gt;<i> to the login page(s)?  The check in the brute force file checks these
</I>&gt;<i> variables against the REQUEST_FILENAME of the current transaction. You
</I>&gt;<i> sanitized your example configs (/protected_url) so I am not sure if you
</I>&gt;<i> defined a filename or a directory.
</I>&gt;<i>
</I>&gt;<i> An audit log entry would help.
</I>&gt;<i>
</I>&gt;<i> On Mar 20, 2011, at 5:51 AM, Yonah Russ &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at yonahruss.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm using 2.5.13 with CRS 2.1.1
</I>&gt;<i> I've configured the following:
</I>&gt;<i>
</I>&gt;<i> SecAction &quot;phase:1,t:none,nolog,pass, \
</I>&gt;<i> setvar:'tx.brute_force_protected_urls=/protected_url /protected_url2', \
</I>&gt;<i> setvar:'tx.brute_force_burst_time_slice=60', \
</I>&gt;<i> setvar:'tx.brute_force_counter_threshold=5', \
</I>&gt;<i> setvar:'tx.brute_force_block_timeout=300'&quot;
</I>&gt;<i>
</I>&gt;<i> When I test, all the requests get through and not even a message in the
</I>&gt;<i> logs :(
</I>&gt;<i> Here is an excerpt from the debug log:
</I>&gt;<i> ...
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_protected_urls=/protected_url /protected_url2
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_protected_urls&quot; to &quot;/protected_url
</I>&gt;<i> /protected_url2&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_burst_time_slice=60
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_burst_time_slice&quot; to &quot;60&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_counter_threshold=5
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_counter_threshold&quot; to &quot;5&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Setting
</I>&gt;<i> variable: tx.brute_force_block_timeout=300
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Set
</I>&gt;<i> variable &quot;tx.brute_force_block_timeout&quot; to &quot;300&quot;.
</I>&gt;<i> ...
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Creating
</I>&gt;<i> collection (name &quot;global&quot;, key &quot;global&quot;).
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Recorded
</I>&gt;<i> original collection variable: global.UPDATE_COUNTER = &quot;0&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Added
</I>&gt;<i> collection &quot;global&quot; to the list.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Resolved
</I>&gt;<i> macro %{remote_addr} to: 192.168.1.1
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Resolved
</I>&gt;<i> macro %{tx.ua_hash} to: 3dcbbff145dcf13aa6287b931eb296b39b7541ee
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;__expire_KEY&quot;, value &quot;1300615158&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;KEY&quot;, value
</I>&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;TIMEOUT&quot;, value &quot;3600&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;__key&quot;, value
</I>&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;__name&quot;, value &quot;ip&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;CREATE_TIME&quot;, value &quot;1300607334&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;UPDATE_COUNTER&quot;, value &quot;75&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;dos_counter&quot;, value &quot;75&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Read
</I>&gt;<i> variable: name &quot;LAST_UPDATE_TIME&quot;, value &quot;1300611558&quot;.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;]
</I>&gt;<i> Retrieved collection (name &quot;ip&quot;, key
</I>&gt;<i> &quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&quot;).
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] Recorded
</I>&gt;<i> original collection variable: ip.UPDATE_COUNTER = &quot;75&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Added
</I>&gt;<i> collection &quot;ip&quot; to the list.
</I>&gt;<i> ...
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;<i> 240d78: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:1,log,noauditlog,chain,block,msg:'Brute Force Attack Identified from
</I>&gt;<i> %{remote_addr} (%{tx.brute_force_block_counter} hits since last
</I>&gt;<i> alert)',setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;<i> returned 0.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] No
</I>&gt;<i> match, chained -&gt; mode NEXT_CHAIN.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Recipe:
</I>&gt;<i> Invoking rule 244cd8; [file
</I>&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&quot;]
</I>&gt;<i> [line &quot;27&quot;].
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;<i> 244cd8: SecRule &quot;IP:BRUTE_FORCE_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:1,noauditlog,block,nolog,setvar:ip.brute_force_block_counter=+1&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;<i> returned 0.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9</A>&gt;] No
</I>&gt;<i> match, not chained -&gt; mode NEXT_RULE.
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Recipe:
</I>&gt;<i> Invoking rule 250338; [file
</I>&gt;<i> &quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_dos_protection.conf&quot;]
</I>&gt;<i> [line &quot;11&quot;].
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5</A>&gt;] Rule
</I>&gt;<i> 250338: SecRule &quot;IP:DOS_BLOCK&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:1,log,noauditlog,chain,drop,msg:'Denial of Service (DoS) Attack
</I>&gt;<i> Identified from %{remote_addr} (%{tx.dos_block_counter} hits since last
</I>&gt;<i> alert)',setvar:ip.dos_block_counter=+1&quot;
</I>&gt;<i> [20/Mar/2011:09:15:56 +0000] [&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;
</I>&gt;<i> www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;
</I>&gt;<i> <A HREF="http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4">http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4</A>&gt;] Rule
</I>&gt;<i> returned 0.
</I>&gt;<i>
</I>&gt;<i> From what I can see, the request never hits the section of rules which
</I>&gt;<i> should start counting the requests to the protected url. Instead, it skips
</I>&gt;<i> to the next ruleset?
</I>&gt;<i> Thanks in advance,
</I>&gt;<i> Yonah
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i> This transmission may contain information that is privileged, confidential,
</I>&gt;<i> and/or exempt from disclosure under applicable law. If you are not the
</I>&gt;<i> intended recipient, you are hereby notified that any disclosure, copying,
</I>&gt;<i> distribution, or use of the information contained herein (including any
</I>&gt;<i> reliance thereon) is STRICTLY PROHIBITED. If you received this transmission
</I>&gt;<i> in error, please immediately contact the sender and destroy the material in
</I>&gt;<i> its entirety, whether in electronic or hard copy format.
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110320/8a6274b0/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110320/8a6274b0/attachment-0001.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000656.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
	<LI>Next message: <A HREF="000658.html">[Owasp-modsecurity-core-rule-set] CRS 2.1.1 Brute Force rules not blocking requests
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#657">[ date ]</a>
              <a href="thread.html#657">[ thread ]</a>
              <a href="subject.html#657">[ subject ]</a>
              <a href="author.html#657">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
