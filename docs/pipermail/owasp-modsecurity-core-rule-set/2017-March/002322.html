<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule 951100 is corrupted
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20951100%20is%20corrupted&In-Reply-To=%3C20170307213659.dz3b7qrfvb3xlifg%40leander%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002321.html">
   <LINK REL="Next"  HREF="002323.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule 951100 is corrupted</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20951100%20is%20corrupted&In-Reply-To=%3C20170307213659.dz3b7qrfvb3xlifg%40leander%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Rule 951100 is corrupted">christian.folini at netnea.com
       </A><BR>
    <I>Tue Mar  7 21:36:59 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002321.html">[Owasp-modsecurity-core-rule-set] Rule 951100 is corrupted
</A></li>
        <LI>Next message: <A HREF="002323.html">[Owasp-modsecurity-core-rule-set] News from the Core Rules	(2017-03-10)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2322">[ date ]</a>
              <a href="thread.html#2322">[ thread ]</a>
              <a href="subject.html#2322">[ subject ]</a>
              <a href="author.html#2322">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ehsan,

On Tue, Mar 07, 2017 at 09:43:39PM +0330, Ehsan Mahdavi wrote:
&gt;<i> It does nothing
</I>&gt;<i> It doesn't increment any inbound scores
</I>&gt;<i> So if you use anomaly mechanism nothing will happen.
</I>
No, that is not correct.

If you examine it, you will notice that the rule 951100
sets the variable sql_error_match. The remaining rules in
the 951xxx group use this variable and link it to an information
about the DBMS used by the backend.

&gt;<i> On the other hand,  sql-error.data file contains general terms like &quot;error&quot;
</I>&gt;<i> and &quot;warning&quot;. If the rule works, it will generate tons of false positives.
</I>
Again, this has to be seen in the light of the following rules.
&quot;Error&quot; is not enough. It takes &quot;Error&quot; in combination with a string
like &quot;JET Database Engine&quot;. And if you have &quot;Error&quot; in combination
with a DB engine, then I think it is a real positive and the
response should be blocked.

Did I convince you? If not, please explain where I make a mistake
in my thinking. An example response with an error ignored by CRS
(-&gt; false negative) or a false positive would really help.

Ahoj,

Christian



&gt;<i> 
</I>&gt;<i> On Tuesday, March 7, 2017, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Hi there,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ooops. What is the problem? Here is the rule in question?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; SecRule RESPONSE_BODY &quot;@pmFromFile sql-errors.data&quot; \
</I>&gt;<i> &gt;         &quot;phase:response,\
</I>&gt;<i> &gt;         id:951100,\
</I>&gt;<i> &gt;         rev:'5',\
</I>&gt;<i> &gt;         ver:'OWASP_CRS/3.0.0',\
</I>&gt;<i> &gt;         pass,\
</I>&gt;<i> &gt;         nolog,\
</I>&gt;<i> &gt;         tag:'application-multi',\
</I>&gt;<i> &gt;         tag:'language-multi',\
</I>&gt;<i> &gt;         tag:'platform-multi',\
</I>&gt;<i> &gt;         tag:'attack-disclosure',\
</I>&gt;<i> &gt;         setvar:tx.sql_error_match=1,\
</I>&gt;<i> &gt;         t:none&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Is there something wrong with the mechanism or have you found an
</I>&gt;<i> &gt; sql-error not being listed in the data file? The latter is very well
</I>&gt;<i> &gt; possible and we would welcome submissions of additional error strings.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Ahoj,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Christian
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Tue, Mar 07, 2017 at 06:57:29PM +0330, Ehsan Mahdavi wrote:
</I>&gt;<i> &gt; &gt; Hi All
</I>&gt;<i> &gt; &gt; Rule 951100 in CRS 3 is not working.
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; be careful with that.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A> &lt;javascript:;&gt;
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A> &lt;javascript:;&gt;
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> &gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i>                     regards
</I>&gt;<i>                  Ehsan.Mahdavi
</I>&gt;<i> PhD candidated for Computer Engineering
</I>&gt;<i>     by Isfahan University of Technology
</I>&gt;<i>         <A HREF="http://emahdavi.ece.iut.ac.ir/">http://emahdavi.ece.iut.ac.ir/</A>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002321.html">[Owasp-modsecurity-core-rule-set] Rule 951100 is corrupted
</A></li>
	<LI>Next message: <A HREF="002323.html">[Owasp-modsecurity-core-rule-set] News from the Core Rules	(2017-03-10)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2322">[ date ]</a>
              <a href="thread.html#2322">[ thread ]</a>
              <a href="subject.html#2322">[ subject ]</a>
              <a href="author.html#2322">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
