<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BBUGFIX%5D%0A%20%22modsecurity_crs_41_xss_attacks.conf%22%20performance%20optimization%20test%20not%0A%20working&In-Reply-To=%3CCAAzXPXByRw5C8NHfAAWh4nCYxwdEE0gKfRaG2QSzzsGwUdmV8Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="001238.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working</H1>
    <B>rm4dillo D</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BBUGFIX%5D%0A%20%22modsecurity_crs_41_xss_attacks.conf%22%20performance%20optimization%20test%20not%0A%20working&In-Reply-To=%3CCAAzXPXByRw5C8NHfAAWh4nCYxwdEE0gKfRaG2QSzzsGwUdmV8Q%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working">rm4dillo at gmail.com
       </A><BR>
    <I>Fri Nov  9 14:13:43 UTC 2012</I>
    <P><UL>
        
        <LI>Next message: <A HREF="001238.html">[Owasp-modsecurity-core-rule-set] patch for 2.2.5 CRS	modsecurity_crs_16_session_hijacking.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1237">[ date ]</a>
              <a href="thread.html#1237">[ thread ]</a>
              <a href="subject.html#1237">[ subject ]</a>
              <a href="author.html#1237">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

The &quot;base_rules/modsecurity_crs_41_xss_attacks.conf&quot; rules file starts with
a smart rule that checks the presence of some keywords (Ex. script
javascript...) and depending on the result, it decides to run deeper rules
or just skip them. The problem is that the conditional &quot;skip&quot; never works
because it tests the &quot;pm_xss_score&quot; variable which is not initialized.

    SecRule TX:PM_XSS_SCORE &quot;@eq 0&quot;
&quot;phase:2,id:'981018',t:none,pass,skipAfter:END_XSS_CHECK,nolog&quot;

To fix this, I just directive this at the beginning of the file:

    SecAction
&quot;phase:2,rev:'2.2.5',t:none,pass,nolog,setvar:tx.pm_xss_score=0&quot;

It would be nice to fix this in the next core rule set release.

Thank you in advance.

Rm4dillo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121109/23d11620/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121109/23d11620/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="001238.html">[Owasp-modsecurity-core-rule-set] patch for 2.2.5 CRS	modsecurity_crs_16_session_hijacking.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1237">[ date ]</a>
              <a href="thread.html#1237">[ thread ]</a>
              <a href="subject.html#1237">[ subject ]</a>
              <a href="author.html#1237">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
