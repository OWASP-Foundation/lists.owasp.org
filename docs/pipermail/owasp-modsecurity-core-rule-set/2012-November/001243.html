<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Anomaly%20Scoring%20logging&In-Reply-To=%3C2DA840B3-6408-4042-BF8C-421B2C04C71A%40greensmoke.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001242.html">
   <LINK REL="Next"  HREF="001244.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging</H1>
    <B>Avi Rosenblatt</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Anomaly%20Scoring%20logging&In-Reply-To=%3C2DA840B3-6408-4042-BF8C-421B2C04C71A%40greensmoke.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging">avi at greensmoke.net
       </A><BR>
    <I>Thu Nov 15 10:38:46 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001242.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
        <LI>Next message: <A HREF="001244.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1243">[ date ]</a>
              <a href="thread.html#1243">[ thread ]</a>
              <a href="subject.html#1243">[ subject ]</a>
              <a href="author.html#1243">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Perhaps I should clarify what I'm looking for.
I would like mod security to be quiet unless the anomaly score threshold is met. When met, there should be one line in the apache error log indicating such and the audit log should multiple 'Message:'s in the 'H' section describing the rules that contributed to the score.

Thanx
Avi

On 2012-11-14, at 8:38 PM, Avi Rosenblatt &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&gt; wrote:

&gt;<i> Thanx for the response.
</I>&gt;<i> I used that blog post as a guide and set SecDefaultAction to &quot;phase:2,pass,nolog,auditlog&quot; but I still get apache log messages for rule matches even though their score is below the threshold.
</I>&gt;<i> By the way I am using v2.2.5 of the owasp CSR.
</I>&gt;<i> Thanx
</I>&gt;<i> Avi
</I>&gt;<i> 
</I>&gt;<i> On 2012-11-14, at 7:09 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> Please refer to this blog post -
</I>&gt;&gt;<i> <A HREF="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v</A>
</I>&gt;&gt;<i> s-anomaly-scoring-detection-modes.html
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Specifically the section on &quot;Alert Management - Correlated Events&quot;.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Ryan Barnett
</I>&gt;&gt;<i> Lead Security Researcher
</I>&gt;&gt;<i> Trustwave - SpiderLabs
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On 11/14/12 9:41 AM, &quot;Avi Rosenblatt&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;<i> I have configured the CRS to use anomaly scoring and raised the inbound
</I>&gt;&gt;&gt;<i> score level in order to reduce false positives. I'm currently running our
</I>&gt;&gt;&gt;<i> server in detectiononly mode and I'm getting error log and audit log
</I>&gt;&gt;&gt;<i> messages for any rule match regardless of score. Is there a way to only
</I>&gt;&gt;&gt;<i> log messages when a threshold has been reached. Thanx in advance for the
</I>&gt;&gt;&gt;<i> help.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Avi
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> ________________________________
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121115/a113bbfc/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121115/a113bbfc/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001242.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
	<LI>Next message: <A HREF="001244.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1243">[ date ]</a>
              <a href="thread.html#1243">[ thread ]</a>
              <a href="subject.html#1243">[ subject ]</a>
              <a href="author.html#1243">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
