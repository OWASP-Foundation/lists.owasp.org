<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Anomaly%20Scoring%20logging&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF0922B0%40SKYMB1.trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001243.html">
   <LINK REL="Next"  HREF="001248.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Anomaly%20Scoring%20logging&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF0922B0%40SKYMB1.trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Nov 15 14:23:50 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001243.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
        <LI>Next message: <A HREF="001248.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1244">[ date ]</a>
              <a href="thread.html#1244">[ thread ]</a>
              <a href="subject.html#1244">[ subject ]</a>
              <a href="author.html#1244">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Understood.  You will want to disable rule ID 981203 in the 60 correlation file - <A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_60_correlation.conf">https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_60_correlation.conf</A>

Add a custom rule file called modsecurity_crs_99_custom.conf and add in - SecRuleRemoveById 981203

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


From: Avi Rosenblatt &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&gt;&gt;
Date: Thursday, November 15, 2012 5:38 AM
To: Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&gt;&gt;, &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging

Perhaps I should clarify what I'm looking for.
I would like mod security to be quiet unless the anomaly score threshold is met. When met, there should be one line in the apache error log indicating such and the audit log should multiple 'Message:'s in the 'H' section describing the rules that contributed to the score.

Thanx
Avi

On 2012-11-14, at 8:38 PM, Avi Rosenblatt &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&gt;&gt; wrote:

Thanx for the response.
I used that blog post as a guide and set SecDefaultAction to &quot;phase:2,pass,nolog,auditlog&quot; but I still get apache log messages for rule matches even though their score is below the threshold.
By the way I am using v2.2.5 of the owasp CSR.
Thanx
Avi

On 2012-11-14, at 7:09 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;&gt; wrote:

Please refer to this blog post -
<A HREF="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v</A>
s-anomaly-scoring-detection-modes.html

Specifically the section on &quot;Alert Management - Correlated Events&quot;.

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


On 11/14/12 9:41 AM, &quot;Avi Rosenblatt&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">avi at greensmoke.net</A>&gt;&gt; wrote:

Hi,
I have configured the CRS to use anomaly scoring and raised the inbound
score level in order to reduce false positives. I'm currently running our
server in detectiononly mode and I'm getting error log and audit log
messages for any rule match regardless of score. Is there a way to only
log messages when a threshold has been reached. Thanx in advance for the
help.

Avi
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>



________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.




________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121115/4dcac0d6/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121115/4dcac0d6/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001243.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
	<LI>Next message: <A HREF="001248.html">[Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1244">[ date ]</a>
              <a href="thread.html#1244">[ thread ]</a>
              <a href="subject.html#1244">[ subject ]</a>
              <a href="author.html#1244">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
