<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Location/LocationMatch failing to disable rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Location/LocationMatch%0A%20failing%20to%20disable%20rules&In-Reply-To=%3CCAONsccVWbiqL9Ur9MHumkebNhoA2Zaa%2Bc-JqpXnuw537AOUS2g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001485.html">
   <LINK REL="Next"  HREF="001486.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Location/LocationMatch failing to disable rules</H1>
    <B>Phill Watkins</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Location/LocationMatch%0A%20failing%20to%20disable%20rules&In-Reply-To=%3CCAONsccVWbiqL9Ur9MHumkebNhoA2Zaa%2Bc-JqpXnuw537AOUS2g%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Location/LocationMatch failing to disable rules">phill.watkins at gmail.com
       </A><BR>
    <I>Tue Nov 26 10:05:14 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001485.html">[Owasp-modsecurity-core-rule-set] Location/LocationMatch failing to disable rules
</A></li>
        <LI>Next message: <A HREF="001486.html">[Owasp-modsecurity-core-rule-set] if i have mod-security installed and owasp-modsecurity-core-rule-set, to i need to worry about vulnerability like CSRF?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1487">[ date ]</a>
              <a href="thread.html#1487">[ thread ]</a>
              <a href="subject.html#1487">[ subject ]</a>
              <a href="author.html#1487">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You might have help me with that.

Set debug to 5 and ended up with a 20000 line file after the first 403
error.

If that's what you need then I'll upload somewhere for you.

Thanks.
On 25 Nov 2013 23:28, &quot;Jose Pablo Valc&#225;rcel L&#225;zaro&quot; &lt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">pablo.valcarcel1980 at gmail.com</A>&gt; wrote:

&gt;<i> Could you post denied trace?
</I>&gt;<i> Maybe you could copyright that rule in customized, comment original rule
</I>&gt;<i> and try to edit on customized to avoid triger with client specific
</I>&gt;<i> request.
</I>&gt;<i>
</I>&gt;<i> Kind regards
</I>&gt;<i> El 25/11/2013 21:28, &quot;Phill Watkins&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">phill.watkins at gmail.com</A>&gt; escribi&#243;:
</I>&gt;<i>
</I>&gt;&gt;<i> Thanks replying.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I'm using CRS version 2.2.8 with ModSecurity 2.7.5. As far as I can tell
</I>&gt;&gt;<i> the rule has already been updated as per your example.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I tried using Directory instead of Location but it didn't work and I kind
</I>&gt;&gt;<i> of understand this since Subsonic is essentially being accessed by proxy
</I>&gt;&gt;<i> (AJP connector).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Your nesting idea will work but will have the effect of disabling the
</I>&gt;&gt;<i> rule globally if mod_jk is enabled, which I'm trying to avoid.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Rule ID 330792 is from the Atomicorp (now defunct) delayed rules. I was
</I>&gt;&gt;<i> using this as an example to show that I've successfully used Location to a
</I>&gt;&gt;<i> disable a rule for Subsonic before. Sorry for the confusion.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 25 November 2013 17:46, Jose Pablo Valc&#225;rcel L&#225;zaro &lt;
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">pablo.valcarcel1980 at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Sorry, I was wrong. You should be able to use location match as you have
</I>&gt;&gt;&gt;<i> written.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> You should be able to comment original rule 330792 but instead
</I>&gt;&gt;&gt;<i> disabling at all, copy it into a customized.conf rules and try to rewrite
</I>&gt;&gt;&gt;<i> rule to bypass what is triggering that rule, in your case:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Message: Access denied with code 403 (phase 1). Match of &quot;rx
</I>&gt;&gt;&gt;<i> ^%{tx.allowed_request_content_type}$&quot; against &quot;TX:0&quot; required. [file
</I>&gt;&gt;&gt;<i> &quot;/etc/apache2/owasp-modsecurity-crs/activated_
</I>&gt;&gt;&gt;<i> rules/modsecurity_crs_30_http_policy.conf&quot;] [line &quot;64&quot;] [id &quot;960010&quot;]
</I>&gt;&gt;&gt;<i> [rev &quot;2&quot;] [msg &quot;Request content type is not allowed by policy&quot;] [data
</I>&gt;&gt;&gt;<i> &quot;text/plain&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/2.2.8&quot;] [maturity &quot;9&quot;]
</I>&gt;&gt;&gt;<i> [accuracy &quot;9&quot;] [tag &quot;OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED&quot;] [tag
</I>&gt;&gt;&gt;<i> &quot;WASCTC/WASC-20&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/EE2&quot;] [tag
</I>&gt;&gt;&gt;<i> &quot;PCI/12.1&quot;]
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I&#180;m watching that is not 330792 rule id, instead it seems 960010 rule
</I>&gt;&gt;&gt;<i> id on /etc/apache2/owasp-modsecurity-crs/activated_
</I>&gt;&gt;&gt;<i> rules/modsecurity_crs_30_http_policy.conf and it&#180;s blocked because of Request
</I>&gt;&gt;&gt;<i> content type is not allowed by policy.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> It could be a older bug depending on mod_security rule version you are
</I>&gt;&gt;&gt;<i> using:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="http://web.archiveorange.com/archive/v/eCIWmXcpDxoRYUESRQEg">http://web.archiveorange.com/archive/v/eCIWmXcpDxoRYUESRQEg</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> There is a bug in that rule as it is missing a &quot;chain&quot; action on the 2nd
</I>&gt;&gt;&gt;<i> SecRule.  The
</I>&gt;&gt;&gt;<i> rule should be this -
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> SecRule REQUEST_METHOD &quot;!^(?:GET|HEAD|PROPFIND|OPTIONS)$&quot;
</I>&gt;&gt;&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Request content type is
</I>&gt;&gt;&gt;<i> not allowed
</I>&gt;&gt;&gt;<i> by
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> policy',id:'960010',tag:'POLICY/ENCODING_NOT_ALLOWED',tag:'WASCTC/WASC-20',tag:'OWASP_TOP_10/A1',tag:'OWASP_AppSensor/EE2',tag:'PCI/12.1',
</I>&gt;&gt;&gt;<i> severity:'4',logdata:'%{matched_var}'&quot;
</I>&gt;&gt;&gt;<i>         SecRule REQUEST_HEADERS:Content-Type &quot;^([^;\s]+)&quot; &quot;chain,capture&quot;
</I>&gt;&gt;&gt;<i>                 SecRule TX:0 &quot;!@within
</I>&gt;&gt;&gt;<i> %{tx.allowed_request_content_type}&quot;
</I>&gt;&gt;&gt;<i> &quot;t:none,setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.
</I>&gt;&gt;&gt;<i> %{rule.id}-POLICY/CONTENT_TYPE_NOT_ALLOWED-%{matched_var
</I>&gt;&gt;&gt;<i> _name}=%{matched_var}&quot;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> This issue has already been reported in JIRA
</I>&gt;&gt;&gt;<i> (<A HREF="https://www.modsecurity.org/tracker/browse/CO...">https://www.modsecurity.org/tracker/browse/CO...</A>) and fixed in CRS
</I>&gt;&gt;&gt;<i> v2.0.6.  You can
</I>&gt;&gt;&gt;<i> manually add the &quot;chain&quot; action to your rule to fix the issue now.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -Ryan
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Which mod_security rule version are you using?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Kind regards,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> 2013/11/25 Jose Pablo Valc&#225;rcel L&#225;zaro &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">pablo.valcarcel1980 at gmail.com</A>&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Or simply try to nest as follows:
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &lt;IfModule mod_jk.c&gt;
</I>&gt;&gt;&gt;&gt;<i>  JkMount /subsonic ajp13_worker
</I>&gt;&gt;&gt;&gt;<i> JkMount /subsonic/* ajp13_worker
</I>&gt;&gt;&gt;&gt;<i> &lt;IfModule mod_security2.c&gt;
</I>&gt;&gt;&gt;&gt;<i>  SecRuleRemoveById 330039
</I>&gt;&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Kind regards,
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> 2013/11/25 Jose Pablo Valc&#225;rcel L&#225;zaro &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">pablo.valcarcel1980 at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> In mod_security migration matrix table you will see features against
</I>&gt;&gt;&gt;&gt;&gt;<i> different mod_security versions:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/ModSecurity-Migration-Matrix">https://github.com/SpiderLabs/ModSecurity/wiki/ModSecurity-Migration-Matrix</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Ability to manage rules in Apache Scope locations
</I>&gt;&gt;&gt;&gt;&gt;<i> SecFilterRemove is now SecRuleRemoveById or SecRuleRemoveByMsg.
</I>&gt;&gt;&gt;&gt;&gt;<i> SecFilterImport is no longer supported.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> So following that feature, I guess location directive you just can
</I>&gt;&gt;&gt;&gt;&gt;<i> only use to disable rules.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> If you want to enable a specific rule, you should develop within
</I>&gt;&gt;&gt;&gt;&gt;<i> specific rules and disable in all domains you don&#180;t need to check it.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Kind regards,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> 2013/11/25 Jose Pablo Valc&#225;rcel L&#225;zaro &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">pablo.valcarcel1980 at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Hi.
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> I have seen rules to disabling by id as follows:
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> &lt;IfModule security2_module&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>  &lt;Directory /local/home/username/example.net&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>         SecRuleRemoveById 330039
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>  &lt;/Directory&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Have you try with  apache Directory directive?
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> Kind regards,
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i> 2013/11/25 Phill Watkins &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">phill.watkins at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>  Hi,
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> For some reason I'm struggling to to disable rules using
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> SecRuleRemoveById inside a Location or LocationMatch.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> I can disable rules globally (which isn't ideal) so I know the
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> directive works but I don't know why Apache doesn't act upon the
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Location/LocationMatch.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> One of the applications on my web server that I'm trying to disable
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> a rule for is Subsonic. Subsonic requires Tomcat and is a connected to
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Apache via the AJP connector module.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>  I have successfully disabled one of the Atomicorp delayed rules in
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> the past like this:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &lt;IfModule mod_jk.c&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> JkMount /subsonic ajp13_worker
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>  JkMount /subsonic/* ajp13_worker
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &lt;Location /subsonic/upload.view&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> SecRuleRemoveById 330792
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>  &lt;/Location&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> I am now trying to disable rule 960010 from the CRS for the entire
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> application because of too many false positives.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> I have tried &lt;Location /subsonic/&gt;  as well as multiple regular
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> expressions for days but nothing works.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Here is an example from the audit log:
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> --35e37e6c-A--
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> [12/Nov/2013:12:19:05 +0000] UoIcuX8AAQEAAAJ3AQgAAAAA hidden 45509
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> hidden 443
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> --35e37e6c-B--
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> POST
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> /subsonic/dwr/call/plaincall/nowPlayingService.getNowPlaying.dwr HTTP/1.1
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Host: hidden
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Connection: keep-alive
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Content-Length: 214
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Origin: <A HREF="https://hidden">https://hidden</A>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> (KHTML, like Gecko) Chrome/30.0.1599.114 Safari/537.36
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Content-Type: text/plain
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Accept: */*
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Referer: <A HREF="https://hidden/subsonic/right.view?">https://hidden/subsonic/right.view?</A>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Accept-Encoding: gzip,deflate,sdch
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Accept-Language: en-GB,en-US;q=0.8,en;q=0.6
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Cookie: player-656c6c6965=6; player-73727661646d=6;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> JSESSIONID=088A746CDC6B4356A388E7C1D44EEE6A.ajp13_worker;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> player-7068696c6c=9; compact_display_state=false
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> --35e37e6c-F--
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> HTTP/1.1 403 Forbidden
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Vary: Accept-Encoding
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Content-Encoding: gzip
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Content-Length: 221
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Keep-Alive: timeout=5, max=88
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Connection: Keep-Alive
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Content-Type: text/html; charset=iso-8859-1
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> --35e37e6c-H--
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Message: Access denied with code 403 (phase 1). Match of &quot;rx
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> ^%{tx.allowed_request_content_type}$&quot; against &quot;TX:0&quot; required. [file
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &quot;/etc/apache2/owasp-modsecurity-crs/activated_rules/modsecurity_crs_30_http_policy.conf&quot;]
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> [line &quot;64&quot;] [id &quot;960010&quot;] [rev &quot;2&quot;] [msg &quot;Request content type is not
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> allowed by policy&quot;] [data &quot;text/plain&quot;] [severity &quot;CRITICAL&quot;] [ver
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &quot;OWASP_CRS/2.2.8&quot;] [maturity &quot;9&quot;] [accuracy &quot;9&quot;] [tag
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &quot;OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED&quot;] [tag &quot;WASCTC/WASC-20&quot;] [tag
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/EE2&quot;] [tag &quot;PCI/12.1&quot;]
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Action: Intercepted (phase 1)
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Stopwatch: 1384258745437774 1085 (- - -)
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Stopwatch2: 1384258745437774 1085; combined=426, p1=363, p2=0, p3=0,
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> p4=0, p5=63, sr=48, sw=0, l=0, gc=0
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Producer: ModSecurity for Apache/2.7.5 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>);
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> OWASP_CRS/2.2.8.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Server: Apache
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Engine-Mode: &quot;ENABLED&quot;
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> --35e37e6c-Z--
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> I'd be grateful of any advice.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Thanks for your time.
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20131126/35148500/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20131126/35148500/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001485.html">[Owasp-modsecurity-core-rule-set] Location/LocationMatch failing to disable rules
</A></li>
	<LI>Next message: <A HREF="001486.html">[Owasp-modsecurity-core-rule-set] if i have mod-security installed and owasp-modsecurity-core-rule-set, to i need to worry about vulnerability like CSRF?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1487">[ date ]</a>
              <a href="thread.html#1487">[ thread ]</a>
              <a href="subject.html#1487">[ subject ]</a>
              <a href="author.html#1487">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
