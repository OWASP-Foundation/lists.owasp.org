<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Problems with the &quot;MASCULINE	ORDINAL INDICATOR&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problems%20with%20the%20%22MASCULINE%0A%09ORDINAL%20INDICATOR%22&In-Reply-To=%3C528A2FBF.5050606%40softjury.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001480.html">
   <LINK REL="Next"  HREF="001483.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Problems with the &quot;MASCULINE	ORDINAL INDICATOR&quot;</H1>
    <B>Jan Phillip Greimann</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problems%20with%20the%20%22MASCULINE%0A%09ORDINAL%20INDICATOR%22&In-Reply-To=%3C528A2FBF.5050606%40softjury.de%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Problems with the &quot;MASCULINE	ORDINAL INDICATOR&quot;">jg at softjury.de
       </A><BR>
    <I>Mon Nov 18 15:18:23 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001480.html">[Owasp-modsecurity-core-rule-set] Unable to remove rule 960012 with SecRuleRemoveById
</A></li>
        <LI>Next message: <A HREF="001483.html">[Owasp-modsecurity-core-rule-set] Location/LocationMatch failing to	disable rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1482">[ date ]</a>
              <a href="thread.html#1482">[ thread ]</a>
              <a href="subject.html#1482">[ subject ]</a>
              <a href="author.html#1482">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Hi there,

I've got a problem with modsecurity, modsecurity-crs and a little
nasty unicode-symbol, the &quot;MASCULINE ORDINAL INDICATOR&quot; or in short: &#186;

  <A HREF="http://codepoints.net/U+00BA?lang=en">http://codepoints.net/U+00BA?lang=en</A>

This nasty symbol causes multiple sql-injection rules:

Message: Pattern match
&quot;(?i:(?:,.*?[)\\da-f\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98][\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98](?:[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98].*?[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]|\\Z|[^\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]+))|(?:\\Wselect.+\\W*?from)|((?
...&quot; at ARGS:address[street]. [file
&quot;/etc/modsecurity/modsecurity_crs_41_sql_injection_attacks.conf&quot;]
[line &quot;209&quot;] [id &quot;981257&quot;] [msg &quot;Detects MySQL
comment-/space-obfuscated injections and backtick termination&quot;] [data
&quot;Matched Data: , n\xc2\xba 1, 1\xc2\xba - 1 found within
ARGS:address[street]: C/ Mare de D\xc3\xa9u del Corredor, n\xc2\xba 1,
1\xc2\xba - 1\xc2\xaa&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;]

Message: Pattern match
&quot;(?i:(?:union\\s*?(?:all|distinct|[(!@]*?)?\\s*?[([]*?\\s*?select\\s+)|(?:\\w+\\s+like\\s+[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98])|(?:like\\s*?[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\%)|(?:[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\s*?like\\W*?[\&quot;'`\xc2\xb4
...&quot; at ARGS:address[street]. [file
&quot;/etc/modsecurity/modsecurity_crs_41_sql_injection_attacks.conf&quot;]
[line &quot;223&quot;] [id &quot;981245&quot;] [msg &quot;Detects basic SQL authentication
bypass attempts 2/3&quot;] [data &quot;Matched Data: \xc2\xba 1, 1 found within
ARGS:address[street]: C/ Mare de D\xc3\xa9u del Corredor, n\xc2\xba 1,
1\xc2\xba - 1\xc2\xaa&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;]

Message: Pattern match
&quot;(?i:(?:[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\s*?\\*.+(?:x?or|div|like|between|and|id)\\W*?[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\d)|(?:\\^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98])|(?:^[\\w\\s\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98-]+(?&lt;=and\\s)(?&lt;=or|xor
...&quot; at ARGS:address[street]. [file
&quot;/etc/modsecurity/modsecurity_crs_41_sql_injection_attacks.conf&quot;]
[line &quot;245&quot;] [id &quot;981243&quot;] [msg &quot;Detects classic SQL injection
probings 2/2&quot;] [data &quot;Matched Data: \xc2\xba 1 found within
ARGS:address[street]: C/ Mare de D\xc3\xa9u del Corredor, n\xc2\xba 1,
1\xc2\xba - 1\xc2\xaa&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;]


I've configured

  SecUnicodeCodePage 20127
  SecUnicodeMapFile /etc/modsecurity/unicode.mapping

and the rules are using t:urlDecodeUni but there are still these
audit-events. I have no clue why, could someone help me with this?



Best regards
Jan
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.14 (GNU/Linux)
Comment: Using GnuPG with Thunderbird - <A HREF="http://www.enigmail.net/">http://www.enigmail.net/</A>

iQEcBAEBAgAGBQJSii+7AAoJENEKhqzzuxPlfnUH/ikgzlTWu4e1CeLq7iuMK/cQ
GJ9iZn4SgiX8fuiPVNaZVRxDMpYcf9fayyD/79F9K6TZpHIZnjRWqESon293svF/
Fp4yi43+TUZmfTSNROBSKAbjcJQJmUZlYeYkyibku3XTicylHXltsLEUccx/QHE/
+PlE0mfTmHKoLomh8bL3bhiF8ZjKdCy2Q9ogx6gUvcCnRnsWPgVJfQEywgLpZOw4
1rxuetEKa4E3zr9ZprXPOxCP+XlVhPw6G3NxGH74hL4iJg3wdRUoXbu9Uc7IyZiE
wsAj01fYsr3Ud/V17C9W8xldy8dhjwTLFYqJSc4EnYzICF/0W/TwvAeTV11hNZM=
=ZtYd
-----END PGP SIGNATURE-----

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001480.html">[Owasp-modsecurity-core-rule-set] Unable to remove rule 960012 with SecRuleRemoveById
</A></li>
	<LI>Next message: <A HREF="001483.html">[Owasp-modsecurity-core-rule-set] Location/LocationMatch failing to	disable rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1482">[ date ]</a>
              <a href="thread.html#1482">[ thread ]</a>
              <a href="subject.html#1482">[ subject ]</a>
              <a href="author.html#1482">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
