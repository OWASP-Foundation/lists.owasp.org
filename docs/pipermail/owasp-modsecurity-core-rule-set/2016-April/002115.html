<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] rules match despite	updated	target list
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20rules%20match%20despite%0A%09updated%09target%20list&In-Reply-To=%3CCO2PR18MB0012F3E077C7E2E21C2CE311DE630%40CO2PR18MB0012.namprd18.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002114.html">
   <LINK REL="Next"  HREF="002116.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] rules match despite	updated	target list</H1>
    <B>Colin MacAllister</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20rules%20match%20despite%0A%09updated%09target%20list&In-Reply-To=%3CCO2PR18MB0012F3E077C7E2E21C2CE311DE630%40CO2PR18MB0012.namprd18.prod.outlook.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] rules match despite	updated	target list">cmacallister at probono.net
       </A><BR>
    <I>Tue Apr 26 20:28:38 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002114.html">[Owasp-modsecurity-core-rule-set] rules match despite	updated	target list
</A></li>
        <LI>Next message: <A HREF="002116.html">[Owasp-modsecurity-core-rule-set] rules match despite	updated	target list
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2115">[ date ]</a>
              <a href="thread.html#2115">[ thread ]</a>
              <a href="subject.html#2115">[ subject ]</a>
              <a href="author.html#2115">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks for the explanation. So it&#8217;s always assumed you are talking about the REQUEST_COOKIE_NAME, and the REQUEST_COOKIES part just tells you what to ignore. Cool.

However, it&#8217;s still not working. Now I have

                SecRuleUpdateTargetById 981318 &quot;!REQUEST_COOKIES:CFAUTHORIZATION_cfadmin&quot;

The logs show everything starting up fine, and only one block &#8211; the first time it runs into that cookie.

Sent from Mail&lt;<A HREF="https://go.microsoft.com/fwlink/?LinkId=550986">https://go.microsoft.com/fwlink/?LinkId=550986</A>&gt; for Windows 10

From: Barry Pollard&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">barry_pollard at hotmail.com</A>&gt;
Sent: Tuesday, April 26, 2016 3:51 PM
To: Colin MacAllister&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;
Cc: OWASP CRS Mailing List&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] rules match despite updated target list

Understand that.

My version of the exception means &quot;exclude rule 981318 from checking the value of the cookie which has the name CFAUTH...&quot;

You're version of the rule means  &quot;exclude rule 981318 from checking the name of the cookie which has the name CFAUTH...&quot;

Both versions of the exclude config are specific to that cookie name.

The log you've shown suggests it's the cookie value (for cookie CFAUTH..) which is triggering the rule not the cookie NAME itself. This makes sense if the cookie value contains double quotes as that is basically what rule 981318 checks for.

There's rarely a need to check the cookie name, so mostly you want to check the value. However if your cookie name included an SQL word (e.g. if your cookie was called abcTRUNCATE123 for example) then you might want to exclude the cookie name from SQL injection rules.

Thanks,
Barry

On 26 Apr 2016, at 20:38, Colin MacAllister &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;&gt; wrote:


I'm trying to remove the rule when the cookie *name* is that CFAUTH... The cookie value changes with each session. What the have in common are enclosing double quotes, but I only wish to whitelist them when the cookie name is as above.

from my phone

On Apr 26, 2016 3:10 PM, Barry Pollard &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">barry_pollard at hotmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">barry_pollard at hotmail.com</A>&gt;&gt; wrote:
You are whitelisting the cookie name and not its value.

Try this:

    SecRuleUpdateTargetById 981318 &quot;!REQUEST_COOKIES:CFAUTHORIZATION_cfadmin&quot;

Thanks,
Barry

&gt;<i> On 26 Apr 2016, at 19:47, Colin MacAllister &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> SecRuleUpdateTargetById 981318 &quot;!REQUEST_COOKIES_NAMES:CFAUTHORIZATION_cfadmin&quot;
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160426/d0dce566/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160426/d0dce566/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002114.html">[Owasp-modsecurity-core-rule-set] rules match despite	updated	target list
</A></li>
	<LI>Next message: <A HREF="002116.html">[Owasp-modsecurity-core-rule-set] rules match despite	updated	target list
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2115">[ date ]</a>
              <a href="thread.html#2115">[ thread ]</a>
              <a href="subject.html#2115">[ subject ]</a>
              <a href="author.html#2115">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
