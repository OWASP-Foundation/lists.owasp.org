<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Execution error - PCRE	limits	exceeded (-8)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Execution%20error%20-%20PCRE%0A%09limits%09exceeded%20%28-8%29&In-Reply-To=%3CCO2PR18MB0012F4EAED9F1875A6532F31DE660%40CO2PR18MB0012.namprd18.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002123.html">
   <LINK REL="Next"  HREF="002133.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Execution error - PCRE	limits	exceeded (-8)</H1>
    <B>Colin MacAllister</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Execution%20error%20-%20PCRE%0A%09limits%09exceeded%20%28-8%29&In-Reply-To=%3CCO2PR18MB0012F4EAED9F1875A6532F31DE660%40CO2PR18MB0012.namprd18.prod.outlook.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Execution error - PCRE	limits	exceeded (-8)">cmacallister at probono.net
       </A><BR>
    <I>Fri Apr 29 16:13:38 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002123.html">[Owasp-modsecurity-core-rule-set] Execution error - PCRE	limits	exceeded (-8)
</A></li>
        <LI>Next message: <A HREF="002133.html">[Owasp-modsecurity-core-rule-set] Execution error - PCRE	limits	exceeded (-8)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2132">[ date ]</a>
              <a href="thread.html#2132">[ thread ]</a>
              <a href="subject.html#2132">[ subject ]</a>
              <a href="author.html#2132">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I played around some more with it and was able to get it to the point where it was no longer giving me GUID_0.00 errors. I weeded out all rules on that XML carrying field to avoid the PCRE limit problem (as well as obvious XSS rules). And now everything is working, and I'm able to keep my recursion limits to 1000. In this case it's okay, I believe, because the XML field is only viewable by admins. So the problem wasn't really solved, but I can proceed.

-----Original Message-----
From: Christian Folini [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>] 
Sent: Wednesday, April 27, 2016 11:47 PM
To: Colin MacAllister &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;
Cc: OWASP List &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] Execution error - PCRE limits exceeded (-8)

Hi Colin,

Yes, that was when the move from sourceforge to github was done. When I asked Ryan for the old history files, I never got a reply.

Ahoj,

Christian

On Wed, Apr 27, 2016 at 07:32:08PM +0000, Colin MacAllister wrote:
&gt;<i> &gt;From the Changelog it looks like this kind of work was done for version 2.2.4. However, I don&#8217;t see that tag in Git &#8211; did this use to be in SourceForge or someplace?
</I>&gt;<i> 
</I>&gt;<i> Sent from Mail&lt;<A HREF="https://go.microsoft.com/fwlink/?LinkId=550986">https://go.microsoft.com/fwlink/?LinkId=550986</A>&gt; for 
</I>&gt;<i> Windows 10
</I>&gt;<i> 
</I>&gt;<i> From: Chaim Sanders&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt;
</I>&gt;<i> Sent: Wednesday, April 27, 2016 2:14 PM
</I>&gt;<i> To: Colin MacAllister&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;; OWASP 
</I>&gt;<i> List&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> Subject: RE: [Owasp-modsecurity-core-rule-set] Execution error - PCRE 
</I>&gt;<i> limits exceeded (-8)
</I>&gt;<i> 
</I>&gt;<i> That isn&#8217;t a bad idea &#8211; Do you have a link to the old ticket/work? Additionally, we should very much consider this maybe for 3.1?
</I>&gt;<i> 
</I>&gt;<i> Chaim Sanders
</I>&gt;<i> Security Researcher
</I>&gt;<i> Trustwave | SMART SECURITY ON DEMAND
</I>&gt;<i> www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> 
</I>&gt;<i> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On 
</I>&gt;<i> Behalf Of Colin MacAllister
</I>&gt;<i> Sent: Wednesday, April 27, 2016 12:49 PM
</I>&gt;<i> To: OWASP List &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> Subject: Re: [Owasp-modsecurity-core-rule-set] Execution error - PCRE 
</I>&gt;<i> limits exceeded (-8)
</I>&gt;<i> 
</I>&gt;<i> It looks like at one point in the past the regular expressions in the ruleset were edited to reduce their greed, which resulted in fewer recursive passes over the input. Might something like this be needed here, given recently added rules?
</I>&gt;<i> 
</I>&gt;<i> Sent from 
</I>&gt;<i> Mail&lt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=k_qg14s7bHUZdVlLt3BdEb2Rv">http://scanmail.trustwave.com/?c=4062&amp;d=k_qg14s7bHUZdVlLt3BdEb2Rv</A>
</I>&gt;<i> mdZQNJ64vk1i3wVAA&amp;s=5&amp;u=https%3a%2f%2fgo%2emicrosoft%2ecom%2ffwlink%2f
</I>&gt;<i> %3fLinkId%3d550986&gt; for Windows 10
</I>&gt;<i> 
</I>&gt;<i> From: Colin MacAllister&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">cmacallister at probono.net</A>&gt;
</I>&gt;<i> Sent: Wednesday, April 27, 2016 12:43 PM
</I>&gt;<i> To: OWASP List&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> Subject: Execution error - PCRE limits exceeded (-8)
</I>&gt;<i> 
</I>&gt;<i> I&#8217;ve found references to this via Google searches, and the accepted 
</I>&gt;<i> answer seems to be to increase the PCRE limits to 150000. This seems 
</I>&gt;<i> unwise, since the limits must be there for a reason. Still, I tried 
</I>&gt;<i> it, but it didn&#8217;t help. I&#8217;m receiving 19 errors of this type, all 
</I>&gt;<i> either concerning XSS or SQL injection, for one URI. The URI in 
</I>&gt;<i> question is in this form: 
</I>&gt;<i> /base.cfm?404;/admin/framework.com.page/area.27D92FDF-4048-6285-EDC3-7
</I>&gt;<i> 8593415F962 (which has been heavily edited so as to not give away the 
</I>&gt;<i> farm.)
</I>&gt;<i> 
</I>&gt;<i> Sent from 
</I>&gt;<i> Mail&lt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=k_qg14s7bHUZdVlLt3BdEb2Rv">http://scanmail.trustwave.com/?c=4062&amp;d=k_qg14s7bHUZdVlLt3BdEb2Rv</A>
</I>&gt;<i> mdZQNJ64vk1i3wVAA&amp;s=5&amp;u=https%3a%2f%2fgo%2emicrosoft%2ecom%2ffwlink%2f
</I>&gt;<i> %3fLinkId%3d550986&gt; for Windows 10
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________
</I>&gt;<i> 
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list 
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-s">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-s</A>
</I>&gt;<i> et
</I>

--
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
<A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
twitter: @ChrFolini
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002123.html">[Owasp-modsecurity-core-rule-set] Execution error - PCRE	limits	exceeded (-8)
</A></li>
	<LI>Next message: <A HREF="002133.html">[Owasp-modsecurity-core-rule-set] Execution error - PCRE	limits	exceeded (-8)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2132">[ date ]</a>
              <a href="thread.html#2132">[ thread ]</a>
              <a href="subject.html#2132">[ subject ]</a>
              <a href="author.html#2132">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
