From ilyassikai at gmail.com  Thu Apr  2 13:59:55 2015
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Thu, 2 Apr 2015 14:59:55 +0100
Subject: [Owasp-modsecurity-core-rule-set] False positives Web services
Message-ID: <CAMmziWchM=JK5_QUPLefcJAL_bHSXHgoNLFsABiJLc2JC67iLg@mail.gmail.com>

Hi,

Wa have this  request for a web service :

http://www.mywebsite.com/webservice?request=%3Cxmlrequest%3E%3Cheader%3E%3Cutilisateur%3Exxx%3C/utilisateur%3E%3Cmotdepasse%3Exxx%3C/motdepasse%3E%3Crequete%3Esearch%3C/requete%3E%3Clangage%3EFR%3C/langage%3E%3Cpays%3Exx%3C/pays%3E%3C/header%3E%3Cbody%3E%3Cnbrparpage%3Exx%3C/nbrparpage%3E%3Cpage%3E2%3C/page%3E%3Ctyperecherche%3Exx%3C/typerecherche%3E%3C/body%3E%3C/xmlrequest%3E


?mod_security forbidden this request log :

?

Message: Access denied with code 403 (phase 2). Pattern match
"(?i:([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\b([\\d\\w]++)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)(?:(?:=|<=>|r?like|sounds\\s+like|regexp)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\2\\b|(?:!=|<=|>=|<>|<|>|\\^|is\\s+not
..." at ARGS:request. [file
"/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
[line "77"] [id "950901"] [rev "2"] [msg "SQL Injection Attack: SQL
Tautology Detected."] [data "Matched Data: utilisateur>
?xxxx
 found within ARGS:request: <xmlrequest><header><utilisateur>
?xxxx
</utilisateur><motdepasse>
?xxxx
</motdepasse><requete>search</requete><langage>
?xx
</langage><pays>
?xxx
</pays></header><body><nbrparpage>10</nbrparpage><page>2</page><typerecherche>

Action: Intercepted (phase 2)

Apache-Handler: proxy-server

Stopwatch: 1427968010902873 5141 (- - -)

Stopwatch2: 1427968010902873 5141; combined=1880, p1=97, p2=1759, p3=0,
p4=0, p5=24, sr=26, sw=0, l=0, gc=0

Response-Body-Transformed: Dechunked

Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
OWASP_CRS/2.2.9.

Server: Apache

Engine-Mode: "ENABLED"


?I tired :


<LocationMatch /webservice>

SecRuleRemoveByID 950901

</LocationMatch> ?

?But I
'm afraid?
? its not ?
Safely

How I can allow my web services Safely
? ?

Thank you.?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150402/9dea534c/attachment.html>

From jroback at gmail.com  Sat Apr  4 20:49:44 2015
From: jroback at gmail.com (Joshua Roback)
Date: Sat, 04 Apr 2015 20:49:44 +0000
Subject: [Owasp-modsecurity-core-rule-set] False positives Web services
In-Reply-To: <CAMmziWchM=JK5_QUPLefcJAL_bHSXHgoNLFsABiJLc2JC67iLg@mail.gmail.com>
References: <CAMmziWchM=JK5_QUPLefcJAL_bHSXHgoNLFsABiJLc2JC67iLg@mail.gmail.com>
Message-ID: <CAExQ=_c61MTX-m+YunvftQvhu3RkRGJ+CVvL27-4yaqoJaErxQ@mail.gmail.com>

This may be an older way to get the job done, but I typically would
whitelist that specific Argument in a rule.

SecRule REQUEST_URI "@beginsWith /webservice"
"phase:1,t:none,t:lowercase,pass,nolog,ctl:ruleRemoveTargetById=950901;ARGS:request"


On Sat, Apr 4, 2015 at 1:49 AM Ilyass Kaouam <ilyassikai at gmail.com> wrote:

> Hi,
>
> Wa have this  request for a web service :
>
>
> http://www.mywebsite.com/webservice?request=%3Cxmlrequest%3E%3Cheader%3E%3Cutilisateur%3Exxx%3C/utilisateur%3E%3Cmotdepasse%3Exxx%3C/motdepasse%3E%3Crequete%3Esearch%3C/requete%3E%3Clangage%3EFR%3C/langage%3E%3Cpays%3Exx%3C/pays%3E%3C/header%3E%3Cbody%3E%3Cnbrparpage%3Exx%3C/nbrparpage%3E%3Cpage%3E2%3C/page%3E%3Ctyperecherche%3Exx%3C/typerecherche%3E%3C/body%3E%3C/xmlrequest%3E
>
>
> ?mod_security forbidden this request log :
>
> ?
>
> Message: Access denied with code 403 (phase 2). Pattern match
> "(?i:([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\b([\\d\\w]++)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)(?:(?:=|<=>|r?like|sounds\\s+like|regexp)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\2\\b|(?:!=|<=|>=|<>|<|>|\\^|is\\s+not
> ..." at ARGS:request. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> [line "77"] [id "950901"] [rev "2"] [msg "SQL Injection Attack: SQL
> Tautology Detected."] [data "Matched Data: utilisateur>
> ?xxxx
>  found within ARGS:request: <xmlrequest><header><utilisateur>
> ?xxxx
> </utilisateur><motdepasse>
> ?xxxx
> </motdepasse><requete>search</requete><langage>
> ?xx
> </langage><pays>
> ?xxx
>
> </pays></header><body><nbrparpage>10</nbrparpage><page>2</page><typerecherche>
>
> Action: Intercepted (phase 2)
>
> Apache-Handler: proxy-server
>
> Stopwatch: 1427968010902873 5141 (- - -)
>
> Stopwatch2: 1427968010902873 5141; combined=1880, p1=97, p2=1759, p3=0,
> p4=0, p5=24, sr=26, sw=0, l=0, gc=0
>
> Response-Body-Transformed: Dechunked
>
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> OWASP_CRS/2.2.9.
>
> Server: Apache
>
> Engine-Mode: "ENABLED"
>
>
> ?I tired :
>
>
> <LocationMatch /webservice>
>
> SecRuleRemoveByID 950901
>
> </LocationMatch> ?
>
> ?But I
> 'm afraid?
> ? its not ?
> Safely
>
> How I can allow my web services Safely
> ? ?
>
> Thank you.?
>
>
>
>  _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150404/734da2ae/attachment.html>

From barry_pollard at hotmail.com  Sat Apr  4 21:13:02 2015
From: barry_pollard at hotmail.com (Barry Pollard)
Date: Sat, 4 Apr 2015 22:13:02 +0100
Subject: [Owasp-modsecurity-core-rule-set] False positives Web services
In-Reply-To: <CAExQ=_c61MTX-m+YunvftQvhu3RkRGJ+CVvL27-4yaqoJaErxQ@mail.gmail.com>
References: <CAMmziWchM=JK5_QUPLefcJAL_bHSXHgoNLFsABiJLc2JC67iLg@mail.gmail.com>,
	<CAExQ=_c61MTX-m+YunvftQvhu3RkRGJ+CVvL27-4yaqoJaErxQ@mail.gmail.com>
Message-ID: <DUB129-W44D474B97084E161D7D26882F00@phx.gbl>

I agree with Joshua that it's better to do this from within ModSecurity. This is because LocationMatch runs AFTER the phase 1 ModSecurity rules so that's the only option for adjusting phase 1 rules. Now this particular example is a phase 2 rule, however so LocationMatch should work but nice to be consistent so you don't have to worry about which phase the rule is for.

Joshua's suggestion is also better, as it only removes the request argument from the rule checking rather than turning it off completely for all arguments, cookies...etc.

Anyway, as it's a phase 2 rule, what you did should work if you wanted to do it that way. I suspect the reason it is not working in LocationMatch, is that you are removing the rule BEFORE it's been defined in the config:
https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecRuleRemoveById
"Note : This directive must be specified after the rule in which it is disabling. This should be used within local custom rule files that are processed after third party rule sets. Example file - modsecurity_crs_60_customrules.conf."
If you load the ModSecurity rules, and then do the LocationMatch it should work so check that. Still advise you do it Joshua's way though for the reasons given.?

Thanks,
Barry

________________________________
> From: jroback at gmail.com 
> Date: Sat, 4 Apr 2015 20:49:44 +0000 
> To: ilyassikai at gmail.com; owasp-modsecurity-core-rule-set at lists.owasp.org 
> Subject: Re: [Owasp-modsecurity-core-rule-set] False positives Web services 
> 
> This may be an older way to get the job done, but I typically would 
> whitelist that specific Argument in a rule. 
> 
> 
> SecRule REQUEST_URI "@beginsWith /webservice" "phase:1,t:none,t:lowercase,pass,nolog,ctl:ruleRemoveTargetById=950901;ARGS:request" 
> 
> On Sat, Apr 4, 2015 at 1:49 AM Ilyass Kaouam 
> <ilyassikai at gmail.com<mailto:ilyassikai at gmail.com>> wrote: 
> Hi, 
> 
> Wa have this request for a web service : 
> 
> http://www.mywebsite.com/webservice?request=%3Cxmlrequest%3E%3Cheader%3E%3Cutilisateur%3Exxx%3C/utilisateur%3E%3Cmotdepasse%3Exxx%3C/motdepasse%3E%3Crequete%3Esearch%3C/requete%3E%3Clangage%3EFR%3C/langage%3E%3Cpays%3Exx%3C/pays%3E%3C/header%3E%3Cbody%3E%3Cnbrparpage%3Exx%3C/nbrparpage%3E%3Cpage%3E2%3C/page%3E%3Ctyperecherche%3Exx%3C/typerecherche%3E%3C/body%3E%3C/xmlrequest%3E<http://www.mywebsite.com/webservice?request=%3cxmlrequest%3e%3cheader%3e%3cutilisateur%3exxx%3c/utilisateur%3e%3cmotdepasse%3exxx%3c/motdepasse%3e%3crequete%3esearch%3c/requete%3e%3clangage%3eFR%3c/langage%3e%3cpays%3exx%3c/pays%3e%3c/header%3e%3cbody%3e%3cnbrparpage%3exx%3c/nbrparpage%3e%3cpage%3e2%3c/page%3e%3ctyperecherche%3exx%3c/typerecherche%3e%3c/body%3e%3c/xmlrequest%3e> 
> 
> 
> ?mod_security forbidden this request log : 
> 
> ? 
> 
> Message: Access denied with code 403 (phase 2). Pattern match 
> "(?i:([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\b([\\d\\w]++)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)(?:(?:=|<=>|r?like|sounds\\s+like|regexp)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\2\\b|(?:!=|<=|>=|<>|<|>|\\^|is\\s+not 
> ..." at ARGS:request. [file 
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"] 
> [line "77"] [id "950901"] [rev "2"] [msg "SQL Injection Attack: SQL 
> Tautology Detected."] [data "Matched Data: utilisateur> 
> 
> ?xxxx 
> found within ARGS:request: <xmlrequest><header><utilisateur> 
> ?xxxx 
> </utilisateur><motdepasse> 
> ?xxxx 
> </motdepasse><requete>search</requete><langage> 
> ?xx 
> </langage><pays> 
> ?xxx 
> </pays></header><body><nbrparpage>10</nbrparpage><page>2</page><typerecherche> 
> 
> Action: Intercepted (phase 2) 
> 
> Apache-Handler: proxy-server 
> 
> Stopwatch: 1427968010902873 5141 (- - -) 
> 
> Stopwatch2: 1427968010902873 5141; combined=1880, p1=97, p2=1759, p3=0, 
> p4=0, p5=24, sr=26, sw=0, l=0, gc=0 
> 
> Response-Body-Transformed: Dechunked 
> 
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/); 
> OWASP_CRS/2.2.9.<http://2.2.9.> 
> 
> Server: Apache 
> 
> Engine-Mode: "ENABLED" 
> 
> 
> ?I tired : 
> 
> 
> <LocationMatch /webservice> 
> 
> SecRuleRemoveByID 950901 
> 
> </LocationMatch> ? 
> 
> 
> ?But I 
> 'm afraid? 
> ? its not ? 
> Safely 
> 
> How I can allow my web services Safely 
> 
> ? ? 
> 
> Thank you.? 
> 
> 
> 
> 
> _______________________________________________ 
> Owasp-modsecurity-core-rule-set mailing list 
> Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org> 
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set 
> 
> _______________________________________________ 
> Owasp-modsecurity-core-rule-set mailing list 
> Owasp-modsecurity-core-rule-set at lists.owasp.org 
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set 
 		 	   		  

From ilyassikai at gmail.com  Mon Apr  6 08:42:00 2015
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Mon, 6 Apr 2015 09:42:00 +0100
Subject: [Owasp-modsecurity-core-rule-set] False positives Web services
In-Reply-To: <DUB129-W44D474B97084E161D7D26882F00@phx.gbl>
References: <CAMmziWchM=JK5_QUPLefcJAL_bHSXHgoNLFsABiJLc2JC67iLg@mail.gmail.com>
	<CAExQ=_c61MTX-m+YunvftQvhu3RkRGJ+CVvL27-4yaqoJaErxQ@mail.gmail.com>
	<DUB129-W44D474B97084E161D7D26882F00@phx.gbl>
Message-ID: <CAMmziWcdQ6sPiV4X9d11WOeJJYDBw1asAo8LfoHhWAia63Xk3w@mail.gmail.com>

Hi Joshua,
Thank you for your reply it's clear.

Barry thank you for your comprehensive explanation :)


2015-04-04 22:13 GMT+01:00 Barry Pollard <barry_pollard at hotmail.com>:

> I agree with Joshua that it's better to do this from within ModSecurity.
> This is because LocationMatch runs AFTER the phase 1 ModSecurity rules so
> that's the only option for adjusting phase 1 rules. Now this particular
> example is a phase 2 rule, however so LocationMatch should work but nice to
> be consistent so you don't have to worry about which phase the rule is for.
>
> Joshua's suggestion is also better, as it only removes the request
> argument from the rule checking rather than turning it off completely for
> all arguments, cookies...etc.
>
> Anyway, as it's a phase 2 rule, what you did should work if you wanted to
> do it that way. I suspect the reason it is not working in LocationMatch, is
> that you are removing the rule BEFORE it's been defined in the config:
>
> https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecRuleRemoveById
> "Note : This directive must be specified after the rule in which it is
> disabling. This should be used within local custom rule files that are
> processed after third party rule sets. Example file -
> modsecurity_crs_60_customrules.conf."
> If you load the ModSecurity rules, and then do the LocationMatch it should
> work so check that. Still advise you do it Joshua's way though for the
> reasons given.
>
> Thanks,
> Barry
>
> ________________________________
> > From: jroback at gmail.com
> > Date: Sat, 4 Apr 2015 20:49:44 +0000
> > To: ilyassikai at gmail.com;
> owasp-modsecurity-core-rule-set at lists.owasp.org
> > Subject: Re: [Owasp-modsecurity-core-rule-set] False positives Web
> services
> >
> > This may be an older way to get the job done, but I typically would
> > whitelist that specific Argument in a rule.
> >
> >
> > SecRule REQUEST_URI "@beginsWith /webservice"
> "phase:1,t:none,t:lowercase,pass,nolog,ctl:ruleRemoveTargetById=950901;ARGS:request"
> >
> > On Sat, Apr 4, 2015 at 1:49 AM Ilyass Kaouam
> > <ilyassikai at gmail.com<mailto:ilyassikai at gmail.com>> wrote:
> > Hi,
> >
> > Wa have this request for a web service :
> >
> >
> http://www.mywebsite.com/webservice?request=%3Cxmlrequest%3E%3Cheader%3E%3Cutilisateur%3Exxx%3C/utilisateur%3E%3Cmotdepasse%3Exxx%3C/motdepasse%3E%3Crequete%3Esearch%3C/requete%3E%3Clangage%3EFR%3C/langage%3E%3Cpays%3Exx%3C/pays%3E%3C/header%3E%3Cbody%3E%3Cnbrparpage%3Exx%3C/nbrparpage%3E%3Cpage%3E2%3C/page%3E%3Ctyperecherche%3Exx%3C/typerecherche%3E%3C/body%3E%3C/xmlrequest%3E
> <
> http://www.mywebsite.com/webservice?request=%3cxmlrequest%3e%3cheader%3e%3cutilisateur%3exxx%3c/utilisateur%3e%3cmotdepasse%3exxx%3c/motdepasse%3e%3crequete%3esearch%3c/requete%3e%3clangage%3eFR%3c/langage%3e%3cpays%3exx%3c/pays%3e%3c/header%3e%3cbody%3e%3cnbrparpage%3exx%3c/nbrparpage%3e%3cpage%3e2%3c/page%3e%3ctyperecherche%3exx%3c/typerecherche%3e%3c/body%3e%3c/xmlrequest%3e
> >
> >
> >
> > ?mod_security forbidden this request log :
> >
> > ?
> >
> > Message: Access denied with code 403 (phase 2). Pattern match
> >
> "(?i:([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\b([\\d\\w]++)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)(?:(?:=|<=>|r?like|sounds\\s+like|regexp)([\\s'\"`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\2\\b|(?:!=|<=|>=|<>|<|>|\\^|is\\s+not
> > ..." at ARGS:request. [file
> >
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> > [line "77"] [id "950901"] [rev "2"] [msg "SQL Injection Attack: SQL
> > Tautology Detected."] [data "Matched Data: utilisateur>
> >
> > ?xxxx
> > found within ARGS:request: <xmlrequest><header><utilisateur>
> > ?xxxx
> > </utilisateur><motdepasse>
> > ?xxxx
> > </motdepasse><requete>search</requete><langage>
> > ?xx
> > </langage><pays>
> > ?xxx
> >
> </pays></header><body><nbrparpage>10</nbrparpage><page>2</page><typerecherche>
> >
> > Action: Intercepted (phase 2)
> >
> > Apache-Handler: proxy-server
> >
> > Stopwatch: 1427968010902873 5141 (- - -)
> >
> > Stopwatch2: 1427968010902873 5141; combined=1880, p1=97, p2=1759, p3=0,
> > p4=0, p5=24, sr=26, sw=0, l=0, gc=0
> >
> > Response-Body-Transformed: Dechunked
> >
> > Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> > OWASP_CRS/2.2.9.<http://2.2.9.>
> >
> > Server: Apache
> >
> > Engine-Mode: "ENABLED"
> >
> >
> > ?I tired :
> >
> >
> > <LocationMatch /webservice>
> >
> > SecRuleRemoveByID 950901
> >
> > </LocationMatch> ?
> >
> >
> > ?But I
> > 'm afraid?
> > ? its not ?
> > Safely
> >
> > How I can allow my web services Safely
> >
> > ? ?
> >
> > Thank you.?
> >
> >
> >
> >
> > _______________________________________________
> > Owasp-modsecurity-core-rule-set mailing list
> > Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:
> Owasp-modsecurity-core-rule-set at lists.owasp.org>
> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> >
> > _______________________________________________
> > Owasp-modsecurity-core-rule-set mailing list
> > Owasp-modsecurity-core-rule-set at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150406/b8bcdcce/attachment.html>

From shurup14 at gmail.com  Mon Apr 13 07:55:42 2015
From: shurup14 at gmail.com (Aleksander Gordienko)
Date: Mon, 13 Apr 2015 10:55:42 +0300
Subject: [Owasp-modsecurity-core-rule-set] Can't exclude rule on IIS
Message-ID: <CAGkXAUZ6q+woVhSEPQh00xVkJ4W+asEzAhA_OqkW-Cex4BsGnA@mail.gmail.com>

Hi,

I have installed Modsecurity 2.9 on IIS 7.5 with deafault CRS rules.
I'm getting notice:

[client 10.6.4.104:62651] ModSecurity: Warning. Operator EQ matched 0 at
REQUEST_HEADERS. [file "C:\/Program Files/ModSecurity
IIS/owasp_crs/base_rules/modsecurity_crs_21_protocol_anomalies.conf"] [line
"47"] [id "960015"] [rev "1"] [msg "Request Missing an Accept Header"]
[severity "NOTICE"] [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "9"]
[tag "OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT"] [tag
"WASCTC/WASC-21"] [tag "OWASP_TOP_10/A7"] [tag "PCI/6.5.10"] [hostname
"WVP-BSS-APP02"] [uri "/v2/toc/BSVK_color_csCrimson.xml"] [unique_id
"11240984672064243758"]

It's trusted transaction, I'm sure. And I would want to exclude this rule
completely or only for this path "/v2/toc/BSVK_color_csCrimson.xml".

I tried to add "SecRuleRemoveById 960015" to modsecurity.conf ,but it
doesn't work.
Also, I tried to create custom modsecurity_crs_21_protocol_anomalies.conf
and the same.
Could you explain me to exclude this rule?

-- 
*Best regards, Alexander *
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150413/1e6450c9/attachment.html>

From nethead at ti.com  Tue Apr 21 20:27:22 2015
From: nethead at ti.com (Patrick Hull)
Date: Tue, 21 Apr 2015 15:27:22 -0500
Subject: [Owasp-modsecurity-core-rule-set] setting permissions/ownership of
	modsec_audit.log
In-Reply-To: <A35E8187-177D-48A3-A773-20599AE0B63B@ti.com>
References: <CAMmziWczzW3iDeM_sAXP5ZSJ1irJRbUMcyGoWj0khg_43x7_eQ@mail.gmail.com>
	<A35E8187-177D-48A3-A773-20599AE0B63B@ti.com>
Message-ID: <20150421202722.GA5575@localhost>

I've included a previous post that is related to my issue.  I work with
Justin Ross who provided the answer in the thread below.  What Justin
and I are trying to figure out is if there is a way to "configure" the
permissions on the modsec_audit.log?  It seems to always get root:root
as owner:group and mode 640: 

-rw-r-----  1 root   root      21312 Apr 21 09:11 modsec_audit.log

Does anyone know of a directive or way to change this?  I haven't found one.
We would like to set the group to something other than "root" which would
allow another restricted process to read the file without elevating
permissions to root or being made part of the root group.  Any ideas?

thanks!
-pat.

On Thu, Dec 25, 2014 at 02:49:51PM +0000, Ross, Justin wrote:
> Make sure the files are owned by the apache or web or whatever user you have running apache.
> 
> Justin
> 
> On Dec 25, 2014, at 7:24 AM, "Ilyass Kaouam" <ilyassikai at gmail.com<mailto:ilyassikai at gmail.com>> wrote:
> 
> Hi,
> 
> What this message mean :
> 
> Message: collections_remove_stale: Failed to access DBM file "/var/lib/mod_security/global": Permission denied
> 
> Message: collections_remove_stale: Failed to access DBM file "/var/lib/mod_security/ip": Permission denied
> 
> How can I fix it ?
> Thank you.
> --
> Ilyass kaouam
> Systems administrator at Inforisk Group Finaccess
> European Masters in Information Technology
> Portable : (212) 6 34 57 14 36
> http://www.inforisk.ma
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


