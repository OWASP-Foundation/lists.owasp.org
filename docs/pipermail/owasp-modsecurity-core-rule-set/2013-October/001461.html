<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Can Rules drop offending cookie/arg without dropping the entire request?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Can%20Rules%20drop%20offending%0A%20cookie/arg%20without%20dropping%20the%20entire%20request%3F&In-Reply-To=%3CCAAr79n4KSkuP3dozzYGNZiedCsfihcSEi7vdKs%3DZc8mO7LB_Mw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001460.html">
   <LINK REL="Next"  HREF="001462.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Can Rules drop offending cookie/arg without dropping the entire request?</H1>
    <B>John McGowan</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Can%20Rules%20drop%20offending%0A%20cookie/arg%20without%20dropping%20the%20entire%20request%3F&In-Reply-To=%3CCAAr79n4KSkuP3dozzYGNZiedCsfihcSEi7vdKs%3DZc8mO7LB_Mw%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Can Rules drop offending cookie/arg without dropping the entire request?">john at lynch2.com
       </A><BR>
    <I>Wed Oct  2 12:33:21 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001460.html">[Owasp-modsecurity-core-rule-set] Can Rules drop offending cookie/arg without dropping the entire request?
</A></li>
        <LI>Next message: <A HREF="001462.html">[Owasp-modsecurity-core-rule-set] Can Rules drop offending cookie/arg without dropping the entire request?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1461">[ date ]</a>
              <a href="thread.html#1461">[ thread ]</a>
              <a href="subject.html#1461">[ subject ]</a>
              <a href="author.html#1461">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wed, Oct 2, 2013 at 5:08 AM, Josh Amishav-Zlatin &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jamuse at owasp.org</A>&gt; wrote:
&gt;<i> On Tue, Oct 1, 2013 at 10:56 PM, John McGowan &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">john at lynch2.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Is it possible for a mod_security rule to drop a cookie or an argument
</I>&gt;&gt;<i> from a request without dropping the entire request?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi John,
</I>&gt;<i>
</I>&gt;<i> While I would not recommend this approach, you could use mod_headers to
</I>&gt;<i> remove the cookie and the rsub action to remove POST body data from requests
</I>&gt;<i> if you know the cookie/parameter name ahead of time.
</I>
But I don't, the problem I'm dealing with is that 3rd parties set
cookies on domains.  Cookies that my application doesn't read, or even
know that they exist.  And when one of those cookies looks bad to the
CRS, the entire request is dropped.  Meaning that the application is
now broken for that user until we add an exxception.

&gt;<i> There is a good chance
</I>&gt;<i> that this will negatively affect the functionality of the web application
</I>&gt;<i> though.
</I>
I'd rather have the application continue to move forward, ignoring the
offending parameters, and log that action.   We would still have to
look at the logged &quot;dropped parameters&quot; and decide if it was a false
positive, true positive or a &quot;who cares&quot; positive.  A &quot;who cares&quot;
positive would be one where I know my application doesn't use the
offending parameter, so it's safe to just let mod_sec remove it from
the request.

&gt;<i> If your getting too many false positives for a given
</I>&gt;<i> cookie/parameter value and you know that they are not vulnerable to a given
</I>&gt;<i> attack type, have you tried disabling rules by tag name? This may be a
</I>&gt;<i> cleaner approach to solving your problem.
</I>
I'm writing exceptions for ruleid/parameter combination when they come up.

The problem is, when a NEW third party cookie appears the application
is broken, and I'd rather that things move along and have that new
cookie ignored.

/John
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001460.html">[Owasp-modsecurity-core-rule-set] Can Rules drop offending cookie/arg without dropping the entire request?
</A></li>
	<LI>Next message: <A HREF="001462.html">[Owasp-modsecurity-core-rule-set] Can Rules drop offending cookie/arg without dropping the entire request?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1461">[ date ]</a>
              <a href="thread.html#1461">[ thread ]</a>
              <a href="subject.html#1461">[ subject ]</a>
              <a href="author.html#1461">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
