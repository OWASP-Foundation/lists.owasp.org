<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] modsecurity 2.7.5 (STABLE) + nginx 1.4.1 - &quot;Header changing rules not working&quot;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20modsecurity%202.7.5%20%28STABLE%29%20%2B%0A%20nginx%201.4.1%20-%20%22Header%20changing%20rules%20not%20working%22&In-Reply-To=%3CCE82F075.BE5D8%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001468.html">
   <LINK REL="Next"  HREF="001469.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] modsecurity 2.7.5 (STABLE) + nginx 1.4.1 - &quot;Header changing rules not working&quot;</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20modsecurity%202.7.5%20%28STABLE%29%20%2B%0A%20nginx%201.4.1%20-%20%22Header%20changing%20rules%20not%20working%22&In-Reply-To=%3CCE82F075.BE5D8%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] modsecurity 2.7.5 (STABLE) + nginx 1.4.1 - &quot;Header changing rules not working&quot;">RBarnett at trustwave.com
       </A><BR>
    <I>Tue Oct 15 17:19:27 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001468.html">[Owasp-modsecurity-core-rule-set] modsecurity 2.7.5 (STABLE) +	nginx 1.4.1 - &quot;Header changing rules not working&quot;
</A></li>
        <LI>Next message: <A HREF="001469.html">[Owasp-modsecurity-core-rule-set] Welcome Felipe Costa as the new	lead Dev for ModSecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1470">[ date ]</a>
              <a href="thread.html#1470">[ thread ]</a>
              <a href="subject.html#1470">[ subject ]</a>
              <a href="author.html#1470">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>From: Filipe Bernardo &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">filipesam at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">filipesam at gmail.com</A>&gt;&gt;
Date: Tuesday, October 15, 2013 12:35 PM
To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: [Owasp-modsecurity-core-rule-set] modsecurity 2.7.5 (STABLE) + nginx 1.4.1 - &quot;Header changing rules not working&quot;

Hi all,
First let me say that i think you are doing a great job with the modsecurity, and the owasp-crs rules.

I have a setup with nginx and modsecurity, i'm using the owasp-crs rules from the repository (git clone <A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs">https://github.com/SpiderLabs/owasp-modsecurity-crs</A>)

and most rules work &quot;out-of-the-box&quot; with the apps i'm testing


i've encontered a problem using the rules that try to alter the &quot;headers&quot; i think the problem is related with the &quot;directives&quot; &quot;Header edit...&quot; and &quot;RequestHeader append...&quot;

The &quot;rule files&quot; i've found that are causing me problems are the following:
- modsecurity_crs_49_header_tagging.conf
- modsecurity_crs_55_application_defects.conf

Modsecurity was compiled from source with --enable-standalone-module
And nginx was compiled from source with --add-module=/path/to/modsecurity

Can anyone help with this?
Is there any module that i should compile on nginx to be able to &quot;edit&quot; the headers?

Thanks

Yeah, those rule files use the Apache mod_headers directives that won't work on other platforms (IIS, Nginx and Java).

For Nginx, looks like you could use - <A HREF="http://wiki.nginx.org/HttpHeadersMoreModule">http://wiki.nginx.org/HttpHeadersMoreModule</A>

-Ryan

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20131015/caa526f9/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20131015/caa526f9/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001468.html">[Owasp-modsecurity-core-rule-set] modsecurity 2.7.5 (STABLE) +	nginx 1.4.1 - &quot;Header changing rules not working&quot;
</A></li>
	<LI>Next message: <A HREF="001469.html">[Owasp-modsecurity-core-rule-set] Welcome Felipe Costa as the new	lead Dev for ModSecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1470">[ date ]</a>
              <a href="thread.html#1470">[ thread ]</a>
              <a href="subject.html#1470">[ subject ]</a>
              <a href="author.html#1470">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
