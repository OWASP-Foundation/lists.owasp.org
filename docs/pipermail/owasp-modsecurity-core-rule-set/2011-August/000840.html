<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] 981242 SQL Injection	detection false positives?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20981242%20SQL%20Injection%0A%09detection%20false%20positives%3F&In-Reply-To=CAPrE0SYFrFRfGrCmiCV2vfYYPUatkMJJiMH1d%3DF4dpg-dFY63g%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000846.html">
   <LINK REL="Next"  HREF="000839.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] 981242 SQL Injection	detection false positives?</H1>
    <B>kwenu</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20981242%20SQL%20Injection%0A%09detection%20false%20positives%3F&In-Reply-To=CAPrE0SYFrFRfGrCmiCV2vfYYPUatkMJJiMH1d%3DF4dpg-dFY63g%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] 981242 SQL Injection	detection false positives?">uzoka_a at yahoo.co.uk
       </A><BR>
    <I>Wed Aug 17 11:28:56 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000846.html">[Owasp-modsecurity-core-rule-set] 981242 SQL Injection detection false positives?
</A></li>
        <LI>Next message: <A HREF="000839.html">[Owasp-modsecurity-core-rule-set] Problem with package signature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#840">[ date ]</a>
              <a href="thread.html#840">[ thread ]</a>
              <a href="subject.html#840">[ subject ]</a>
              <a href="author.html#840">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You could exclude checking of those cookies by putting the following in 
modsecurity_crs_15_customrules.conf

SecRule REQUEST_HEADERS:Host &quot;!@rx (^$)&quot; \
    
&quot;phase:2,t:none,nolog,pass,ctl:ruleUpdateTargetById=981242;!REQUEST_COOKIES:test&quot; 


Ive had the same problem with these rules in that they are very 
sensitive indeed by necessary
The above rule works well in that rule 981242 is not disabled entirely 
but simply ignores inspection of the named cookie.

On 17/08/11 04:34, Paul McGarry wrote:
&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I am seeing quite a lot of false positives on SQL injection errors.
</I>&gt;<i>
</I>&gt;<i> On of them is rule 981242 which is objecting to a cookie:
</I>&gt;<i> test=asfnsdh2fub9tl6gt0mand504
</I>&gt;<i> with the regex:
</I>&gt;<i> (\&quot;|'|`|&#180;|&#8217;|&#8216;)\s*x?or|div|like|between|and\s*(\&quot;|'|`|&#180;|&#8217;|&#8216;)?\d
</I>&gt;<i> matching on &quot;and5&quot;
</I>&gt;<i>
</I>&gt;<i> 1) Is the regex missing some grouping?
</I>&gt;<i> As written it seems that (x)or is being treated differently than
</I>&gt;<i> div/like/between/and, ie the (x)or case requires one of the quote
</I>&gt;<i> characters before it while the others don't.
</I>&gt;<i> Should that part of the regex be:
</I>&gt;<i> (\&quot;|'|`|&#180;|&#8217;|&#8216;)\s*(?:x?or|div|like|between|and)\s*(\&quot;|'|`|&#180;|&#8217;|&#8216;)?\d
</I>&gt;<i>
</I>&gt;<i> 2) Should &quot;and&quot; being followed directly by a number, without space or
</I>&gt;<i> a quote, be a match?
</I>&gt;<i> On my SQL server (Postgres) I think &quot;and5&quot; would be a syntax error (as
</I>&gt;<i> opposed to &quot;and'5&quot; or &quot;and 5&quot;
</I>&gt;<i> Would:
</I>&gt;<i> (\&quot;|'|`|&#180;|&#8217;|&#8216;)\s*(?:x?or|div|like|between|and)(?:(\&quot;|'|`|&#180;|&#8217;|&#8216;)|\s+(\&quot;|'|`|&#180;|&#8217;|&#8216;)?)\d
</I>&gt;<i> be a tighter match?
</I>&gt;<i>
</I>&gt;<i> Paul
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110817/1836bd81/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110817/1836bd81/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000846.html">[Owasp-modsecurity-core-rule-set] 981242 SQL Injection detection false positives?
</A></li>
	<LI>Next message: <A HREF="000839.html">[Owasp-modsecurity-core-rule-set] Problem with package signature
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#840">[ date ]</a>
              <a href="thread.html#840">[ thread ]</a>
              <a href="subject.html#840">[ subject ]</a>
              <a href="author.html#840">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
