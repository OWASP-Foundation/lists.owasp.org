<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Possible false positive for 981244
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Possible%20false%20positive%20for%20981244&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000817.html">
   <LINK REL="Next"  HREF="000819.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Possible false positive for 981244</H1>
    <B>chris derham</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Possible%20false%20positive%20for%20981244&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Possible false positive for 981244">chris at derham.me.uk
       </A><BR>
    <I>Thu Aug  4 08:46:36 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000817.html">[Owasp-modsecurity-core-rule-set] New Blog Post - Detecting Malice	with ModSecurity: HoneyTraps
</A></li>
        <LI>Next message: <A HREF="000819.html">[Owasp-modsecurity-core-rule-set] Possible false positive for	981244
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#818">[ date ]</a>
              <a href="thread.html#818">[ thread ]</a>
              <a href="subject.html#818">[ subject ]</a>
              <a href="author.html#818">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>All,

Not sure if this is the correct way to report false positives, but we are
testing our app works following upgrade to mod_security and to core ruleset
2.2.1. We are now hitting a false positive on rule 981244. I believe the
relevant section of the logs is shown below. Our app needs to login via a
http call, and it appears that the rule is rejecting the call as it contains
a parameter &quot;j_username&quot;. We have turned the rule off for this particular
url using a location match shown below which seems to overcome the issue. Is
this the correct way, or is this really a false positive? Rule says it is
trying to catch SQL login attempts

    &lt;LocationMatch &quot;/secure*&quot;&gt;
        SecRuleRemoveById 981244
    &lt;/LocationMatch&gt;

Thanks for any pointers

Chris

--23480000-B--
POST /secure/j_acegi_security_check
HTTP/1.1
Host: &lt;host name&gt;
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:5.0) Gecko/20100101
Firefox/5.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-gb,en;q=0.5
Accept-Encoding: gzip, deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Connection: keep-alive
Referer: <A HREF="http://&lt;host">http://&lt;host</A> name&gt;/internet/shop
Cookie: JSESSIONID=872EE0D25BB05A9D8376C67A9808AB18
Content-Type: application/x-www-form-urlencoded
Content-Length: 62

--23480000-C--
j_username=&lt;username&gt;&amp;j_password=&lt;password&gt;

--23480000-F--
HTTP/1.1 412 Precondition Failed
Last-Modified: Tue, 25 Jan 2011 18:00:46 GMT
ETag: &quot;100000002f836-18e-49aaf7eea50aa&quot;
Accept-Ranges: bytes
Vary:Accept-Encoding
Content-Encoding: gzip
Content-Length: 262
Keep-Alive: timeout=15, max=100
Connection: Keep-Alive
Content-Type: text/html

--23480000-H-- Message: Access denied with code 412 (phase 2). Pattern match
&quot;(?i:(?:\\d(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)\\s+(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)\\s+\\d)|(?:^admin\\s*(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)|(\\/\\*)+(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)+\\s?(?:--|#|\\/\\*|{)?)|(?:(\&quot;|'|
...&quot; at ARGS:j_username. [file
&quot;D:/apps/Apache2.2/conf/modsecurity2/modsecurity-crs_2.2.1/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;]
[line &quot;560&quot;] [id &quot;981244&quot;] [msg &quot;Detects basic SQL authentication bypass
attempts 1/3&quot;] [data &quot;like&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;]
[tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]
Action: Intercepted (phase 2)
Stopwatch: 1312456696272672 15001 (- - -)
Stopwatch2: 1312456696272672 15001; combined=14001, p1=2001, p2=8000, p3=0,
p4=0, p5=2000, sr=2001, sw=0, l=0, gc=2000
Producer: ModSecurity for Apache/2.6.1 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); core
ruleset/2.2.1.
Server: Apache
WebApp-Info: &quot;rbge&quot; &quot;-&quot; &quot;-&quot; /); core ruleset/2.1.2. Server: Apache
WebApp-Info: &quot;rbge&quot; &quot;-&quot; &quot;-&quot;
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110804/9ff096dc/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110804/9ff096dc/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000817.html">[Owasp-modsecurity-core-rule-set] New Blog Post - Detecting Malice	with ModSecurity: HoneyTraps
</A></li>
	<LI>Next message: <A HREF="000819.html">[Owasp-modsecurity-core-rule-set] Possible false positive for	981244
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#818">[ date ]</a>
              <a href="thread.html#818">[ thread ]</a>
              <a href="subject.html#818">[ subject ]</a>
              <a href="author.html#818">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
