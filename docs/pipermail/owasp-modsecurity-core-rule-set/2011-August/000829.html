<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] allow:request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20allow%3Arequest&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000827.html">
   <LINK REL="Next"  HREF="000830.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] allow:request</H1>
    <B>David Sinclair</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20allow%3Arequest&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] allow:request">dbsinclair at multiservice.com
       </A><BR>
    <I>Tue Aug  9 17:37:12 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000827.html">[Owasp-modsecurity-core-rule-set] help with preventing entries to audit log
</A></li>
        <LI>Next message: <A HREF="000830.html">[Owasp-modsecurity-core-rule-set] allow:request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#829">[ date ]</a>
              <a href="thread.html#829">[ thread ]</a>
              <a href="subject.html#829">[ subject ]</a>
              <a href="author.html#829">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I am rather new to modsecurity rules and am having trouble understanding the
functionality of allow:request.  From this debug log snippet, I have written
a custom rule, modsecurity_crs_15_custom_rules.conf,  that is designed to
allow the GET of a .dtd and skip the remainder of request phase processing
with allow:request.  However, this log shows that the processing of the
rules in the request phases continues with crs_20 that I am trying to
avoid.  Is there something that I have missed?



 Warning. Operator EQ matched 0 at TX. [file
&quot;/etc/httpd/conf/modsecurity_crs/modsecurity_crs_10_config.conf&quot;] [line
&quot;309&quot;] [id &quot;98

 Rule returned
1.


 Match -&gt; mode
NEXT_RULE.


 Recipe: Invoking rule 2ad8c7cf62e0; [file
&quot;/etc/httpd/conf/modsecurity_crs/base_rules/modsecurity_crs_15_custom_rules.conf&quot;]
[line

 Rule 2ad8c7cf62e0: SecRule &quot;REQUEST_METHOD&quot; &quot;@rx ^GET$&quot;
&quot;phase:1,chain,nolog,t:none,severity:6,rev:1.0.0,allow:request,msg:'Allow

 Transformation completed in 1
usec.


 Executing operator &quot;rx&quot; with param &quot;^GET$&quot; against
REQUEST_METHOD.


 Target value:
&quot;GET&quot;


 Operator completed in 2 usec.


 Rule returned
1.


 Match -&gt; mode NEXT_RULE.


 Recipe: Invoking rule 2ad8c7cf6ea0; [file
&quot;/etc/httpd/conf/modsecurity_crs/base_rules/modsecurity_crs_15_custom_rules.conf&quot;]
[line

 Rule 2ad8c7cf6ea0: SecRule &quot;REQUEST_FILENAME&quot; &quot;@rx ^/dtd/.*[.]dtd$&quot;
&quot;t:none&quot;

 Transformation completed in 1
usec.


 Executing operator &quot;rx&quot; with param &quot;^/dtd/.*[.]dtd$&quot; against
REQUEST_FILENAME.

 Target value:
&quot;/dtd/BCSSRequest-v1.1.dtd&quot;


 Operator completed in 3 usec.


 Warning. Pattern match &quot;^/dtd/.*[.]dtd$&quot; at REQUEST_FILENAME. [file
&quot;/etc/httpd/conf/modsecurity_crs/base_rules/modsecurity_crs_15

 Rule returned
1.


 Match -&gt; mode
NEXT_RULE.


 Recipe: Invoking rule 2ad8c7cf9ef8; [file
&quot;/etc/httpd/conf/modsecurity_crs/base_rules/modsecurity_crs_20_protocol_violations.conf&quot;

 Rule 2ad8c7cf9ef8: SecRule &quot;REQUEST_LINE&quot; &quot;!@rx
^(?:(?:[a-z]{3,10}\\s+(?:\\w{3,7}?://[\\w\\-\\./]*(?::\\d+)?)?/[^?#]*(?:\\?[^#\\s]

 T (0) lowercase: &quot;get /dtd/bcssrequest-v1.1.dtd
http/1.0&quot;


 Transformation completed in 9
usec.


 Executing operator &quot;!rx&quot; with param
&quot;^(?:(?:[a-z]{3,10}\\s+(?:\\w{3,7}?://[\\w\\-\\./]*(?::\\d+)?)?/[^?#]*(?:\\?[^#\\s]*)?(?:#[\\S

 Target value: &quot;get /dtd/bcssrequest-v1.1.dtd
http/1.0&quot;


 Operator completed in 8
usec.


 Rule returned
0.


 No match, not chained -&gt; mode
NEXT_RULE.



David B. Sinclair

Security Manager

Email:   <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dbsinclair at multiservice.com</A>


---------------------------------------------------------------------------------------
This email is intended solely for the use of the addressee and may
contain information that is confidential, proprietary, or both.
If you receive this email in error please immediately notify the
sender and delete the email.
---------------------------------------------------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110809/eb9225f8/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110809/eb9225f8/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000827.html">[Owasp-modsecurity-core-rule-set] help with preventing entries to audit log
</A></li>
	<LI>Next message: <A HREF="000830.html">[Owasp-modsecurity-core-rule-set] allow:request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#829">[ date ]</a>
              <a href="thread.html#829">[ thread ]</a>
              <a href="subject.html#829">[ subject ]</a>
              <a href="author.html#829">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
