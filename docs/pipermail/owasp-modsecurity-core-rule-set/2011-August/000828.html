<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Google Analytics cookie __utmz often trigger mod_security
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Google%20Analytics%20cookie%0A%20__utmz%20often%20trigger%20mod_security&In-Reply-To=4E3F9894.1080308%40agenda.si">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000824.html">
   <LINK REL="Next"  HREF="000825.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Google Analytics cookie __utmz often trigger mod_security</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Google%20Analytics%20cookie%0A%20__utmz%20often%20trigger%20mod_security&In-Reply-To=4E3F9894.1080308%40agenda.si"
       TITLE="[Owasp-modsecurity-core-rule-set] Google Analytics cookie __utmz often trigger mod_security">RBarnett at trustwave.com
       </A><BR>
    <I>Tue Aug  9 12:55:38 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000824.html">[Owasp-modsecurity-core-rule-set] Google Analytics cookie __utmz	often trigger mod_security
</A></li>
        <LI>Next message: <A HREF="000825.html">[Owasp-modsecurity-core-rule-set] help with preventing entries to audit log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#828">[ date ]</a>
              <a href="thread.html#828">[ thread ]</a>
              <a href="subject.html#828">[ subject ]</a>
              <a href="author.html#828">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I suggest that you add in the following SecRuleUpdateTargetById directive
(<A HREF="http://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Referen">http://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Referen</A>
ce_Manual#SecRuleUpdateTargetById) to a local
modsecurity_crs_60_customrules.conf file -

SecRuleUpdateTargetById 981172 !REQUEST_COOKIES:'/^__utm/'

This will create an exception so that the existing rule will not inspect
the Google Analytics Cookie data.

-Ryan




On 8/8/11 4:04 AM, &quot;Danilo Godec&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">danilo.godec at agenda.si</A>&gt; wrote:

&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>I'm very new to mod_security - installed it on one of my server a couple
</I>&gt;<i>of days ago along with core rules 2.2.1.
</I>&gt;<i>
</I>&gt;<i>I had to create a couple of exceptions as some common Slovene words
</I>&gt;<i>contain strings that trigger some SQL injection rules. For example - the
</I>&gt;<i>word 'slike' (meaning 'pictures') obviously contains 'like' which
</I>&gt;<i>triggers one or more of the rules in
</I>&gt;<i>modsecurity_crs_41_sql_injection_attacks.conf.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Anyway, I also noticed that Google Analytics cookie __utmz often
</I>&gt;<i>triggers these rules as it sometimes (quite often, actually) contains
</I>&gt;<i>things like 'n=(n' - for example:
</I>&gt;<i>
</I>&gt;<i>__utmz=42207527.1312789542.1.1.utmgclid=CIvzq5Gav6oCFZQm3wodY1mF5w|utmccn=
</I>&gt;<i>(not+set)|utmcmd=(not+set)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>What's a recommended practice to handle thinks like that?
</I>&gt;<i>
</I>&gt;<i>  Danilo
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000824.html">[Owasp-modsecurity-core-rule-set] Google Analytics cookie __utmz	often trigger mod_security
</A></li>
	<LI>Next message: <A HREF="000825.html">[Owasp-modsecurity-core-rule-set] help with preventing entries to audit log
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#828">[ date ]</a>
              <a href="thread.html#828">[ thread ]</a>
              <a href="subject.html#828">[ subject ]</a>
              <a href="author.html#828">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
