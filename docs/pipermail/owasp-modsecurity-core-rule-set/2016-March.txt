From mail at noelzindel.org  Tue Mar  1 06:43:15 2016
From: mail at noelzindel.org (=?utf-8?Q?No=C3=ABl_Zindel?=)
Date: Tue, 1 Mar 2016 07:43:15 +0100
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders
In-Reply-To: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
References: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
Message-ID: <2F613AD0-E56C-45B2-9AFB-99D8E3798229@noelzindel.org>

Congratulation to both of you Walter, Christian. And thanks Chaim, not only for leading the pack, but giving recognition to those who have earned it. This is not always granted.
From a somewhat outside perspective it?s good to see this kind of interaction and activity from all participants.

> On 29 Feb 2016, at 18:24, Chaim Sanders <CSanders at trustwave.com> wrote:
> 
> In general the Core Rule Set project has been moving along at a much faster pace in the past few months thanks to increased community involvement. In general I wanted to call out two individuals specifically, although there are MANY others involved and their help is also greatly valued; not only by me but by everyone in the community. As many of you know both Christian Folini (Dune73) and Walter Hop (Lifeforms) have been working extremely hard organizing and committing to various aspects of the upcoming OWASP CRS-3.0.0-RC1 release. In recognition of their support and hard work, I would like to announce that they have been given write-access to the OWASP-CRS GitHub. While we don?t have official titles, I bestow the unofficial title of ?Core Contributor/Developer? upon you both. I?d like to take this opportunity to congratulate both of these gentlemen and thank them for their diligent work. Thank you.
> 
> 
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org <mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set <https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160301/c2c580a1/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160301/c2c580a1/attachment-0001.pgp>

From Manuel.LeosRivas at gemalto.com  Tue Mar  1 09:03:34 2016
From: Manuel.LeosRivas at gemalto.com (Leos Rivas Manuel)
Date: Tue, 1 Mar 2016 09:03:34 +0000
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders
In-Reply-To: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
References: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
Message-ID: <E2C9913D99137A42A2A9646B1E82B8DB010D462FDB@A1GTOEMBXV001.gto.a3c.atos.net>

I agree, it is a pleasure to see the community getting involved ?

From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Chaim Sanders
Sent: lundi 29 f?vrier 2016 18:24
To: owasp-modsecurity-core-rule-set at lists.owasp.org; Christian Folini; Walter Hop
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders

In general the Core Rule Set project has been moving along at a much faster pace in the past few months thanks to increased community involvement. In general I wanted to call out two individuals specifically, although there are MANY others involved and their help is also greatly valued; not only by me but by everyone in the community. As many of you know both Christian Folini (Dune73) and Walter Hop (Lifeforms) have been working extremely hard organizing and committing to various aspects of the upcoming OWASP CRS-3.0.0-RC1 release. In recognition of their support and hard work, I would like to announce that they have been given write-access to the OWASP-CRS GitHub. While we don?t have official titles, I bestow the unofficial title of ?Core Contributor/Developer? upon you both. I?d like to take this opportunity to congratulate both of these gentlemen and thank them for their diligent work. Thank you.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160301/115fd0db/attachment.html>

From avi.fatal at gmail.com  Tue Mar  1 19:06:56 2016
From: avi.fatal at gmail.com (Avi Fatal)
Date: Tue, 1 Mar 2016 21:06:56 +0200
Subject: [Owasp-modsecurity-core-rule-set] Handling mod security as a
	firewall for all kind of web sites
Message-ID: <CAFk_mWs9Auj0ZjQhgeecrKpj+bhrtY-8pG9awnPaydpRZ8zghg@mail.gmail.com>

Hi,
We are 200 of websites / webapps for our clients.
>From wordpress to .net apps, java and more.

We want to provide a united waf solution for all of them.
going to cloud will be very expensive.

I have built for this an Apache proxy with mod security and owasp rules.
the mod security is not blocking, just logging.
I took 10 websites and and pass the traffic via this proxy.
after 5 minutes I opened the log and saw 150 different types of security
issues.

Its more of a conceptual question...
How can I manage a solution for 200 of webapps? does it makes sense?
I can understand controlling on five websites, but 200 ? its sounds like 24
hours we need to go over rules and suspend them on every usecase....

Ill be glad to hear from people who has an experience with that.

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160301/893a2c37/attachment.html>

From CSanders at trustwave.com  Wed Mar  2 01:26:34 2016
From: CSanders at trustwave.com (Chaim Sanders)
Date: Wed, 2 Mar 2016 01:26:34 +0000
Subject: [Owasp-modsecurity-core-rule-set] Handling mod security as a
 firewall for all kind of web sites
In-Reply-To: <CAFk_mWs9Auj0ZjQhgeecrKpj+bhrtY-8pG9awnPaydpRZ8zghg@mail.gmail.com>
References: <CAFk_mWs9Auj0ZjQhgeecrKpj+bhrtY-8pG9awnPaydpRZ8zghg@mail.gmail.com>
Message-ID: <D2FBAA0F.1AECF%csanders@trustwave.com>

In general some of these problems may be due to very general issues present across a number of specific platforms. In general observing common vulnerabilities across a few of these should allow you to identify rules that are prone to false positives (which is the whole reasoning behind the paranoid mode) hopefully when this project is finished it will provide a bit of relief.  But for the mean time I recommend identifying the common false positives and possible relaxing them or turning those rules off even

From: <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>> on behalf of Avi Fatal <avi.fatal at gmail.com<mailto:avi.fatal at gmail.com>>
Date: Tuesday, March 1, 2016 at 2:06 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] Handling mod security as a firewall for all kind of web sites


Hi,
We are 200 of websites / webapps for our clients.
>From wordpress to .net apps, java and more.

We want to provide a united waf solution for all of them.
going to cloud will be very expensive.

I have built for this an Apache proxy with mod security and owasp rules. the mod security is not blocking, just logging.
I took 10 websites and and pass the traffic via this proxy.
after 5 minutes I opened the log and saw 150 different types of security issues.

Its more of a conceptual question...
How can I manage a solution for 200 of webapps? does it makes sense?
I can understand controlling on five websites, but 200 ? its sounds like 24 hours we need to go over rules and suspend them on every usecase....

Ill be glad to hear from people who has an experience with that.

Thanks

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160302/f54a8c12/attachment.html>

From Manuel.LeosRivas at gemalto.com  Wed Mar  2 06:52:53 2016
From: Manuel.LeosRivas at gemalto.com (Leos Rivas Manuel)
Date: Wed, 2 Mar 2016 06:52:53 +0000
Subject: [Owasp-modsecurity-core-rule-set] Handling mod security as a
 firewall for all kind of web sites
In-Reply-To: <D2FBAA0F.1AECF%csanders@trustwave.com>
References: <CAFk_mWs9Auj0ZjQhgeecrKpj+bhrtY-8pG9awnPaydpRZ8zghg@mail.gmail.com>,
	<D2FBAA0F.1AECF%csanders@trustwave.com>
Message-ID: <0b9ejth6oqjhl8h3jn66uw0e.1456901568180@email.android.com>

Hi,

I will recommend to
- use separate logs per website,
- group them by type and create a configurationfile for it
- use includes with all common rules to disable and include it on the website conf so you can change one file and impact the whole group
- have a super set of conf rules at server context level for all rule adjustments that apply to every website
- apply crs on vhosts basis
- start with a relaxed policy and work the conf to be more strict as you get to know better your traffic

Regards,
Manuel



Envoy? de mon Galaxy S5 4G+ Orange


-------- Original message --------
From: Chaim Sanders <CSanders at trustwave.com>
Date: 02/03/2016 02:36 (GMT+01:00)
To: Avi Fatal <avi.fatal at gmail.com>, owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: [Owasp-modsecurity-core-rule-set] Handling mod security as a firewall for all kind of web sites

In general some of these problems may be due to very general issues present across a number of specific platforms. In general observing common vulnerabilities across a few of these should allow you to identify rules that are prone to false positives (which is the whole reasoning behind the paranoid mode) hopefully when this project is finished it will provide a bit of relief.  But for the mean time I recommend identifying the common false positives and possible relaxing them or turning those rules off even

From: <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>> on behalf of Avi Fatal <avi.fatal at gmail.com<mailto:avi.fatal at gmail.com>>
Date: Tuesday, March 1, 2016 at 2:06 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] Handling mod security as a firewall for all kind of web sites


Hi,
We are 200 of websites / webapps for our clients.
>From wordpress to .net apps, java and more.

We want to provide a united waf solution for all of them.
going to cloud will be very expensive.

I have built for this an Apache proxy with mod security and owasp rules. the mod security is not blocking, just logging.
I took 10 websites and and pass the traffic via this proxy.
after 5 minutes I opened the log and saw 150 different types of security issues.

Its more of a conceptual question...
How can I manage a solution for 200 of webapps? does it makes sense?
I can understand controlling on five websites, but 200 ? its sounds like 24 hours we need to go over rules and suspend them on every usecase....

Ill be glad to hear from people who has an experience with that.

Thanks

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160302/311419fb/attachment-0001.html>

From christian.folini at netnea.com  Wed Mar  2 07:40:25 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Wed, 2 Mar 2016 08:40:25 +0100
Subject: [Owasp-modsecurity-core-rule-set] Handling mod security as a
 firewall for all kind of web sites
In-Reply-To: <CAFk_mWs9Auj0ZjQhgeecrKpj+bhrtY-8pG9awnPaydpRZ8zghg@mail.gmail.com>
References: <CAFk_mWs9Auj0ZjQhgeecrKpj+bhrtY-8pG9awnPaydpRZ8zghg@mail.gmail.com>
Message-ID: <20160302074024.GA28380@elias>

Avi,


On Tue, Mar 01, 2016 at 09:06:56PM +0200, Avi Fatal wrote:
> We are 200 of websites / webapps for our clients.
> From wordpress to .net apps, java and more.
> 
> We want to provide a united waf solution for all of them.
>
> ...
>
> Its more of a conceptual question...
> How can I manage a solution for 200 of webapps? does it makes sense?

Your problem is my day job.

It is a very hard problem and there is no easy solution.

The Core Rules are generic in nature. They try to achieve a high
level of security via a broad set of rules. But applications are
very diverse, developers are crazy and users are insane. This makes
for an explosive mixture which results in the amount of false
positives you have already witnessed.

You can not defend 200 websites on day 1. You need to go step by
step.

There is a latin motto, which I do not know if it is used among
English speakers: It's "Divide et Impera!" -> "Divide and Rule".

In your context, it means to group your services and prioritize them.
Personally, I would suggest to give every service a security target
and tag it with the software running. Like:
Service 001: medium security, wordpress
Service 002: low security, wordpress
Service 003: high security, custom java software
Service 004: high security, joomla
...

Then I suggest you pick a group in the highest security class, which
shares the same software. If you have several high security wordpress
installations, these are going to be your pilot services.

You need to work with a pilot to grow your knowledge. Then follow some
of the suggestions of Manuel. They are right on target. It all depends
on your setup and how you manage rules and the tuning. You need to
develop a ModSec rule and tuning setup that fits your environment
and work mode. There is no silver bullet and I still experiment with
this depending on my customer.

My personal approach is to always use anomaly scoring and starting
in blocking mode with an anomaly limit >1000. And then tuning your way
down to 20, 10, 5.
Running in logging mode will drown you in false positives and you will
never switch to blocking.
Running in blocking mode without anomaly scoring will have the false
positives kill your services (and possibly your job too).

It is only with an anomaly scoring blocking mode and a limit of 20
or lower that you will see an impact on the attackers. So this will
take time. A lot of time. It works via multiple iterations of tuning
sessions. Typically 5-10 iterations.

As Chaim pointed out, the new paranoia settings will allow you to start
with less false positives than with the 2.2.X series of the core rules.
In fact, if you start out now, I suggest to start with 3.0.0rc1 as this
saves the transition from 2.2.X to 3.0 next year. If you do start with
3.0.0rc1, I would be very interested to stay in contact as your
experience could be very valuable for the community.

Under the line: This is going to be very hard. And it will take a lot
of time. Not 24h a day, but it will keep a single person occupied
full working time for 1-2-3 years, I guess. It's still way cheaper than
commercial offerings (for 200 sites!) - outside of those commercial
offerings that to a bit of cleansing and fancy reports, but there is
no real blocking of attackers behind.

Good luck!

Christian


-- 
People demand freedom of speech as a compensation for the freedom 
of thought which they seldom use.
-- Soren Kierkegaard


From bridavis at cisco.com  Fri Mar  4 07:54:47 2016
From: bridavis at cisco.com (Brian Davis (bridavis))
Date: Fri, 4 Mar 2016 07:54:47 +0000
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For
Message-ID: <D2FE7F4F.22D24%bridavis@cisco.com>

Hello,

I have ModSecurity running as a reverse proxy behind an haproxy LB. Because we're behind HAProxy, we're getting LB IP addresses for REMOTE_ADDR.

I have a large number of IPs that I have to whitelist, and would therefore really take advantage of the ipMatch and ipMatchFromFile functions. However, those can only be used on REMOTE_ADDR.

Does anyone have a creative way of taking the X-Forwarded-For value and somehow setting REMOTE_ADDR to that, and then using ipMatch on the result?

Thanks,
Brian

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160304/d9c18056/attachment.html>

From Manuel.LeosRivas at gemalto.com  Fri Mar  4 08:33:06 2016
From: Manuel.LeosRivas at gemalto.com (Leos Rivas Manuel)
Date: Fri, 4 Mar 2016 08:33:06 +0000
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For
In-Reply-To: <D2FE7F4F.22D24%bridavis@cisco.com>
References: <D2FE7F4F.22D24%bridavis@cisco.com>
Message-ID: <E2C9913D99137A42A2A9646B1E82B8DB010D464A1B@A1GTOEMBXV001.gto.a3c.atos.net>

You don't need to modify the remote_address, simply use header:x-forwarded-for instead and deny if it matches.

From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Brian Davis (bridavis)
Sent: vendredi 4 mars 2016 08:55
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For

Hello,

I have ModSecurity running as a reverse proxy behind an haproxy LB. Because we're behind HAProxy, we're getting LB IP addresses for REMOTE_ADDR.

I have a large number of IPs that I have to whitelist, and would therefore really take advantage of the ipMatch and ipMatchFromFile functions. However, those can only be used on REMOTE_ADDR.

Does anyone have a creative way of taking the X-Forwarded-For value and somehow setting REMOTE_ADDR to that, and then using ipMatch on the result?

Thanks,
Brian

________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160304/b8148a39/attachment.html>

From bridavis at cisco.com  Fri Mar  4 08:36:30 2016
From: bridavis at cisco.com (Brian Davis (bridavis))
Date: Fri, 4 Mar 2016 08:36:30 +0000
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For
In-Reply-To: <E2C9913D99137A42A2A9646B1E82B8DB010D464A1B@A1GTOEMBXV001.gto.a3c.atos.net>
References: <D2FE7F4F.22D24%bridavis@cisco.com>
	<E2C9913D99137A42A2A9646B1E82B8DB010D464A1B@A1GTOEMBXV001.gto.a3c.atos.net>
Message-ID: <D2FE88CD.22D7C%bridavis@cisco.com>

Can I use "@ipMatchFromFile <file>" against REQUEST_HEADER:X-Forwarded-For? I didn't think this was possible.

From: Leos Rivas Manuel <Manuel.LeosRivas at gemalto.com<mailto:Manuel.LeosRivas at gemalto.com>>
Date: Friday, March 4, 2016 at 12:33 AM
To: "Brian A. Davis" <bridavis at cisco.com<mailto:bridavis at cisco.com>>, "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: RE: ipMatch and X-Forwarded-For

You don't need to modify the remote_address, simply use header:x-forwarded-for instead and deny if it matches.

From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org> [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Brian Davis (bridavis)
Sent: vendredi 4 mars 2016 08:55
To: owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For

Hello,

I have ModSecurity running as a reverse proxy behind an haproxy LB. Because we're behind HAProxy, we're getting LB IP addresses for REMOTE_ADDR.

I have a large number of IPs that I have to whitelist, and would therefore really take advantage of the ipMatch and ipMatchFromFile functions. However, those can only be used on REMOTE_ADDR.

Does anyone have a creative way of taking the X-Forwarded-For value and somehow setting REMOTE_ADDR to that, and then using ipMatch on the result?

Thanks,
Brian

________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160304/f4a5bcbf/attachment-0001.html>

From Manuel.LeosRivas at gemalto.com  Fri Mar  4 12:21:44 2016
From: Manuel.LeosRivas at gemalto.com (Leos Rivas Manuel)
Date: Fri, 4 Mar 2016 12:21:44 +0000
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For
In-Reply-To: <D2FE88CD.22D7C%bridavis@cisco.com>
References: <D2FE7F4F.22D24%bridavis@cisco.com>
	<E2C9913D99137A42A2A9646B1E82B8DB010D464A1B@A1GTOEMBXV001.gto.a3c.atos.net>
	<D2FE88CD.22D7C%bridavis@cisco.com>
Message-ID: <E2C9913D99137A42A2A9646B1E82B8DB010D464EA2@A1GTOEMBXV001.gto.a3c.atos.net>

Hi David,

Yes you can, you used modsec documentation example I supposed as it is it explain the rule not the directive itself:
SecRule REMOTE_ADDR "@ipMatchFromFile ips.txt" "id:163"

This is the modified rule that will match the X-Forwarded-for header
SecRule REQUEST_HEADERS:X-Forwarded-for "@ipMatchFromFile ips.txt" "id:163"

I don't know what use you will give it but headers just like any other element on the request is user modifiable so unless you are the one setting that up and you established a trusted connection to the other end don't use it for security but should be good for marketing or log purposes.

Also notice that the header if you are chaining multiple proxies along the way is supposed to include more than one value like ip1,ip2,ip3.

Regards,
Manuel

From: Brian Davis (bridavis) [mailto:bridavis at cisco.com]
Sent: vendredi 4 mars 2016 09:37
To: Leos Rivas Manuel; owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: ipMatch and X-Forwarded-For

Can I use "@ipMatchFromFile <file>" against REQUEST_HEADER:X-Forwarded-For? I didn't think this was possible.

From: Leos Rivas Manuel <Manuel.LeosRivas at gemalto.com<mailto:Manuel.LeosRivas at gemalto.com>>
Date: Friday, March 4, 2016 at 12:33 AM
To: "Brian A. Davis" <bridavis at cisco.com<mailto:bridavis at cisco.com>>, "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: RE: ipMatch and X-Forwarded-For

You don't need to modify the remote_address, simply use header:x-forwarded-for instead and deny if it matches.

From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org> [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Brian Davis (bridavis)
Sent: vendredi 4 mars 2016 08:55
To: owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For

Hello,

I have ModSecurity running as a reverse proxy behind an haproxy LB. Because we're behind HAProxy, we're getting LB IP addresses for REMOTE_ADDR.

I have a large number of IPs that I have to whitelist, and would therefore really take advantage of the ipMatch and ipMatchFromFile functions. However, those can only be used on REMOTE_ADDR.

Does anyone have a creative way of taking the X-Forwarded-For value and somehow setting REMOTE_ADDR to that, and then using ipMatch on the result?

Thanks,
Brian

________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160304/9afca954/attachment.html>

From twells at nexcess.net  Fri Mar  4 13:50:32 2016
From: twells at nexcess.net (Ted Wells)
Date: Fri, 4 Mar 2016 08:50:32 -0500
Subject: [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For
In-Reply-To: <E2C9913D99137A42A2A9646B1E82B8DB010D464EA2@A1GTOEMBXV001.gto.a3c.atos.net>
References: <D2FE7F4F.22D24%bridavis@cisco.com>
	<E2C9913D99137A42A2A9646B1E82B8DB010D464A1B@A1GTOEMBXV001.gto.a3c.atos.net>
	<D2FE88CD.22D7C%bridavis@cisco.com>
	<E2C9913D99137A42A2A9646B1E82B8DB010D464EA2@A1GTOEMBXV001.gto.a3c.atos.net>
Message-ID: <CAPJPg04+hvazO1KJVzhsgk+nTUGyhP5TAQqoroyGiOw0QUe00A@mail.gmail.com>

Keep in mind you can also use the TX:REAL_IP collection. This will either
contain the direct IP of the node connecting to your server, or the value
of x-forwarded-for if that header is present and contains an IP address:

https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/modsecurity_crs_10_setup.conf.example#L407

On Fri, Mar 4, 2016 at 7:21 AM, Leos Rivas Manuel <
Manuel.LeosRivas at gemalto.com> wrote:

> Hi David,
>
>
>
> Yes you can, you used modsec documentation example I supposed as it is it
> explain the rule not the directive itself:
>
> SecRule REMOTE_ADDR "@ipMatchFromFile ips.txt" "id:163"
>
>
>
> This is the modified rule that will match the X-Forwarded-for header
>
> SecRule REQUEST_HEADERS:X-Forwarded-for "@ipMatchFromFile ips.txt" "id:163"
>
>
>
> I don?t know what use you will give it but headers just like any other
> element on the request is *user modifiable* so unless you are the one
> setting that up and you established a trusted connection to the other end
> don?t use it for security but should be good for marketing or log purposes.
>
>
>
> Also notice that the header if you are chaining multiple proxies along the
> way is supposed to include more than one value like ip1,ip2,ip3.
>
>
>
> Regards,
>
> Manuel
>
>
>
> *From:* Brian Davis (bridavis) [mailto:bridavis at cisco.com]
> *Sent:* vendredi 4 mars 2016 09:37
> *To:* Leos Rivas Manuel; owasp-modsecurity-core-rule-set at lists.owasp.org
> *Subject:* Re: ipMatch and X-Forwarded-For
>
>
>
> Can I use "@ipMatchFromFile <file>" against
> REQUEST_HEADER:X-Forwarded-For? I didn?t think this was possible.
>
>
>
> *From: *Leos Rivas Manuel <Manuel.LeosRivas at gemalto.com>
> *Date: *Friday, March 4, 2016 at 12:33 AM
> *To: *"Brian A. Davis" <bridavis at cisco.com>, "
> owasp-modsecurity-core-rule-set at lists.owasp.org" <
> owasp-modsecurity-core-rule-set at lists.owasp.org>
> *Subject: *RE: ipMatch and X-Forwarded-For
>
>
>
> You don?t need to modify the remote_address, simply use
> header:x-forwarded-for instead and deny if it matches.
>
>
>
> *From:* owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [
> mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
> <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>] *On Behalf Of *Brian
> Davis (bridavis)
> *Sent:* vendredi 4 mars 2016 08:55
> *To:* owasp-modsecurity-core-rule-set at lists.owasp.org
> *Subject:* [Owasp-modsecurity-core-rule-set] ipMatch and X-Forwarded-For
>
>
>
> Hello,
>
>
>
> I have ModSecurity running as a reverse proxy behind an haproxy LB.
> Because we?re behind HAProxy, we?re getting LB IP addresses for REMOTE_ADDR.
>
>
>
> I have a large number of IPs that I have to whitelist, and would therefore
> really take advantage of the ipMatch and ipMatchFromFile functions.
> However, those can only be used on REMOTE_ADDR.
>
>
>
> Does anyone have a creative way of taking the X-Forwarded-For value and
> somehow setting REMOTE_ADDR to that, and then using ipMatch on the result?
>
>
>
> Thanks,
>
> Brian
>
>
> ------------------------------
>
>
>
> *This message and any attachments are intended solely for the addressees
> and may contain confidential information. Any unauthorized use or
> disclosure, either whole or partial, is prohibited. E-mails are susceptible
> to alteration. Our company shall not be liable for the message if altered,
> changed or falsified. If you are not the intended recipient of this
> message, please delete it and notify the sender. Although all reasonable
> efforts have been made to keep this transmission free from viruses, the
> sender will not be liable for damages caused by a transmitted virus.*
> ------------------------------
> This message and any attachments are intended solely for the addressees
> and may contain confidential information. Any unauthorized use or
> disclosure, either whole or partial, is prohibited.
> E-mails are susceptible to alteration. Our company shall not be liable for
> the message if altered, changed or falsified. If you are not the intended
> recipient of this message, please delete it and notify the sender.
> Although all reasonable efforts have been made to keep this transmission
> free from viruses, the sender will not be liable for damages caused by a
> transmitted virus.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>


-- 

Ted Wells
Nexcess - Beyond Hosting
21700 Melrose Ave.
Southfield, MI  48075
Phone: +1.866.639.2377
Fax:   +1.248.281.0473http://twitter.com/nexcess
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160304/d1f4114b/attachment-0001.html>

From Hiranmayi.Palanki at aexp.com  Fri Mar  4 17:53:32 2016
From: Hiranmayi.Palanki at aexp.com (Hiranmayi Palanki)
Date: Fri, 4 Mar 2016 17:53:32 +0000
Subject: [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and
	ModSecurity CRS rules for XSS
Message-ID: <f7868c723bdf4d0fb746979bd252d505@BY1PR93MB0086.024d.mgd.msft.net>

Hello,

I'm specifically interested in enabling just the XSS CRS rules from ModSecurity. However, I have ESAPI HTTP whitelist validation rules already running. I have the following questions:


1.      Can ModSecurity XSS CRS rules operate in parallel with ESAPI HTTP whitelist validation?

2.      Is it overkill to enable both ESAPI HTTP whitelist validation and ModSecurity XSS blacklist regex patterns?

3.      Does it make sense to split some parts of the HTTP request to go through the ESAPI canonicalize and HTTP validation rules and split some parts of the HTTP request (e.g. query string) to traverse through ModSecurity?

4.      Has anybody implemented both whitelist (through ESAPI HTTP validation) and blacklist regular expression pattern matching at the same time? If so, do you have an opinion on this combined approach?

Thank you in advance.

Hiranmayi Palanki.





American Express made the following annotations
******************************************************************************
"This message and any attachments are solely for the intended recipient and may contain confidential or privileged information. If you are not the intended recipient, any disclosure, copying, use, or distribution of the information included in this message and any attachments is prohibited. If you have received this communication in error, please notify us by reply e-mail and immediately and permanently delete this message and any attachments. Thank you."

American Express a ajout? le commentaire suivant le Ce courrier et toute pi?ce jointe qu'il contient sont r?serv?s au seul destinataire indiqu? et peuvent renfermer des 
renseignements confidentiels et privil?gi?s. Si vous n'?tes pas le destinataire pr?vu, toute divulgation, duplication, utilisation ou distribution du courrier ou de toute pi?ce jointe est interdite. Si vous avez re?u cette communication par erreur, veuillez nous en aviser par courrier et d?truire imm?diatement le courrier et les pi?ces jointes. Merci.

******************************************************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160304/779629d9/attachment.html>

From christian.folini at netnea.com  Fri Mar  4 20:26:42 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Fri, 4 Mar 2016 21:26:42 +0100
Subject: [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation
 and ModSecurity CRS rules for XSS
In-Reply-To: <f7868c723bdf4d0fb746979bd252d505@BY1PR93MB0086.024d.mgd.msft.net>
References: <f7868c723bdf4d0fb746979bd252d505@BY1PR93MB0086.024d.mgd.msft.net>
Message-ID: <20160304202642.GA27081@elias>

Dear Hiranmayi Palanki,

I am not familiar with the ESAPI HTTP whitelisting, but I do know it's a
helpful security layer. Combining ModSec with other defense methods
makes a lot of sense with regards to security in depth etc.

The price is certainly the complexity and the additional source for
false positives. So it depends on your security needs. I have
sympathies for the double approach.

On Fri, Mar 04, 2016 at 05:53:32PM +0000, Hiranmayi Palanki wrote:
> 2.      Is it overkill to enable both ESAPI HTTP whitelist validation and ModSecurity XSS blacklist regex patterns?

I do combine CRS with whitelisting at times. I include the CRS first,
perform the anomaly score checking for the incoming request and if 
everything looks good, the whitelisting takes a closer look at every
detail of the http request.

> 3.      Does it make sense to split some parts of the HTTP request to go through the ESAPI canonicalize and HTTP validation rules and split some parts of the HTTP request (e.g. query string) to traverse through ModSecurity?

That sounds quite crazy and bloody complicated. I do not see the
benefit, honestly. However, the craziness of the idea intrigues me.
Should you manage to pull this off, would you care to share the
recipe with us?

> 4.      Has anybody implemented both whitelist (through ESAPI HTTP validation) and blacklist regular expression pattern matching at the same time? If so, do you have an opinion on this combined approach?

Not me, sorry.

Best,

Christian

-- 
The greatest obstacle to being heroic is the doubt whether one may not
be going to prove one's self a fool; the truest heroism is, to resist
the doubt; and the profoundest wisdom, to know when it ought to be
resisted, and when to be obeyed.
-- Nathaniel Hawthorne

From Hiranmayi.Palanki at aexp.com  Fri Mar  4 22:33:05 2016
From: Hiranmayi.Palanki at aexp.com (Hiranmayi Palanki)
Date: Fri, 4 Mar 2016 22:33:05 +0000
Subject: [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation
 and ModSecurity CRS rules for XSS
In-Reply-To: <20160304202642.GA27081@elias>
References: <f7868c723bdf4d0fb746979bd252d505@BY1PR93MB0086.024d.mgd.msft.net>
	<20160304202642.GA27081@elias>
Message-ID: <6131a70de069414090a0085b77eade1e@BY1PR93MB0086.024d.mgd.msft.net>

Hello Christian,

Thank you for your response. I will indeed share the recipe, if at all this route is pursued.

The ESAPI HTTP white list validation is an open source library from OWASP. It provides white list input validation and output encoding amongst many of its features. 

The challenge is that developers are hesitant to remove this OWASP ESAPI library, given that it is offering white list HTTP request input validation. I'm interested in plugging-in ModSecurity XSS rules, and therefore the combined approach is coming into play.

Based on your response, I'm deriving that sending all parts of the HTTP request (header, cookie, query string..etc) in its entirety through either a whitelist or a blacklist is ok. But, it does not make sense to validate the HTTP request header, cookie, query string with a blacklist and the HTTP scheme, uri path, context path etc. through a whitelist.

Thanks. Hiranmayi Palanki.

-----Original Message-----
From: Christian Folini [mailto:christian.folini at netnea.com] 
Sent: Friday, March 04, 2016 3:27 PM
To: Hiranmayi Palanki
Cc: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS

Dear Hiranmayi Palanki,

I am not familiar with the ESAPI HTTP whitelisting, but I do know it's a helpful security layer. Combining ModSec with other defense methods makes a lot of sense with regards to security in depth etc.

The price is certainly the complexity and the additional source for false positives. So it depends on your security needs. I have sympathies for the double approach.

On Fri, Mar 04, 2016 at 05:53:32PM +0000, Hiranmayi Palanki wrote:
> 2.      Is it overkill to enable both ESAPI HTTP whitelist validation and ModSecurity XSS blacklist regex patterns?

I do combine CRS with whitelisting at times. I include the CRS first, perform the anomaly score checking for the incoming request and if everything looks good, the whitelisting takes a closer look at every detail of the http request.

> 3.      Does it make sense to split some parts of the HTTP request to go through the ESAPI canonicalize and HTTP validation rules and split some parts of the HTTP request (e.g. query string) to traverse through ModSecurity?

That sounds quite crazy and bloody complicated. I do not see the benefit, honestly. However, the craziness of the idea intrigues me.
Should you manage to pull this off, would you care to share the recipe with us?

> 4.      Has anybody implemented both whitelist (through ESAPI HTTP validation) and blacklist regular expression pattern matching at the same time? If so, do you have an opinion on this combined approach?

Not me, sorry.

Best,

Christian

--
The greatest obstacle to being heroic is the doubt whether one may not be going to prove one's self a fool; the truest heroism is, to resist the doubt; and the profoundest wisdom, to know when it ought to be resisted, and when to be obeyed.
-- Nathaniel Hawthorne


American Express made the following annotations
******************************************************************************
"This message and any attachments are solely for the intended recipient and may contain confidential or privileged information. If you are not the intended recipient, any disclosure, copying, use, or distribution of the information included in this message and any attachments is prohibited. If you have received this communication in error, please notify us by reply e-mail and immediately and permanently delete this message and any attachments. Thank you."

American Express a ajout? le commentaire suivant le Ce courrier et toute pi?ce jointe qu'il contient sont r?serv?s au seul destinataire indiqu? et peuvent renfermer des 
renseignements confidentiels et privil?gi?s. Si vous n'?tes pas le destinataire pr?vu, toute divulgation, duplication, utilisation ou distribution du courrier ou de toute pi?ce jointe est interdite. Si vous avez re?u cette communication par erreur, veuillez nous en aviser par courrier et d?truire imm?diatement le courrier et les pi?ces jointes. Merci.

******************************************************************************

From christian.folini at netnea.com  Sat Mar  5 05:01:52 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sat, 5 Mar 2016 06:01:52 +0100
Subject: [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation
 and ModSecurity CRS rules for XSS
In-Reply-To: <6131a70de069414090a0085b77eade1e@BY1PR93MB0086.024d.mgd.msft.net>
References: <f7868c723bdf4d0fb746979bd252d505@BY1PR93MB0086.024d.mgd.msft.net>
	<20160304202642.GA27081@elias>
	<6131a70de069414090a0085b77eade1e@BY1PR93MB0086.024d.mgd.msft.net>
Message-ID: <20160305050152.GA4718@elias>

Hello,

On Fri, Mar 04, 2016 at 10:33:05PM +0000, Hiranmayi Palanki wrote:
> Thank you for your response. I will indeed share the recipe, if at all this route is pursued.

Great. We could put it into the OWASP wiki.

> Based on your response, I'm deriving that sending all parts of the
> HTTP request (header, cookie, query string..etc) in its entirety
> through either a whitelist or a blacklist is ok. But, it does not make
> sense to validate the HTTP request header, cookie, query string with a
> blacklist and the HTTP scheme, uri path, context path etc. through a
> whitelist.

I'd say to send it all through a blacklist first _and_ through a
whitelist afterwards works fine. I'm doing it for a couple of sites
and it works nicely.

Ahoj,

Christian


> 
> Thanks. Hiranmayi Palanki.
> 
> -----Original Message----- From: Christian Folini
> [mailto:christian.folini at netnea.com] Sent: Friday, March 04, 2016 3:27
> PM To: Hiranmayi Palanki Cc:
> owasp-modsecurity-core-rule-set at lists.owasp.org Subject: Re:
> [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and
> ModSecurity CRS rules for XSS
> 
> Dear Hiranmayi Palanki,
> 
> I am not familiar with the ESAPI HTTP whitelisting, but I do know it's
> a helpful security layer. Combining ModSec with other defense methods
> makes a lot of sense with regards to security in depth etc.
> 
> The price is certainly the complexity and the additional source for
> false positives. So it depends on your security needs. I have
> sympathies for the double approach.
> 
> On Fri, Mar 04, 2016 at 05:53:32PM +0000, Hiranmayi Palanki wrote:
> > 2.      Is it overkill to enable both ESAPI HTTP whitelist
> > validation and ModSecurity XSS blacklist regex patterns?
> 
> I do combine CRS with whitelisting at times. I include the CRS first,
> perform the anomaly score checking for the incoming request and if
> everything looks good, the whitelisting takes a closer look at every
> detail of the http request.
> 
> > 3.      Does it make sense to split some parts of the HTTP request
> > to go through the ESAPI canonicalize and HTTP validation rules and
> > split some parts of the HTTP request (e.g. query string) to traverse
> > through ModSecurity?
> 
> That sounds quite crazy and bloody complicated. I do not see the
> benefit, honestly. However, the craziness of the idea intrigues me.
> Should you manage to pull this off, would you care to share the recipe
> with us?
> 
> > 4.      Has anybody implemented both whitelist (through ESAPI HTTP
> > validation) and blacklist regular expression pattern matching at the
> > same time? If so, do you have an opinion on this combined approach?
> 
> Not me, sorry.
> 
> Best,
> 
> Christian
> 
> -- The greatest obstacle to being heroic is the doubt whether one may
> not be going to prove one's self a fool; the truest heroism is, to
> resist the doubt; and the profoundest wisdom, to know when it ought to
> be resisted, and when to be obeyed.  -- Nathaniel Hawthorne
> 
> 
> American Express made the following annotations
> ******************************************************************************
> "This message and any attachments are solely for the intended
> recipient and may contain confidential or privileged information. If
> you are not the intended recipient, any disclosure, copying, use, or
> distribution of the information included in this message and any
> attachments is prohibited. If you have received this communication in
> error, please notify us by reply e-mail and immediately and
> permanently delete this message and any attachments. Thank you."
> 
> American Express a ajout? le commentaire suivant le Ce courrier et
> toute pi?ce jointe qu'il contient sont r?serv?s au seul destinataire
> indiqu? et peuvent renfermer des renseignements confidentiels et
> privil?gi?s. Si vous n'?tes pas le destinataire pr?vu, toute
> divulgation, duplication, utilisation ou distribution du courrier ou
> de toute pi?ce jointe est interdite. Si vous avez re?u cette
> communication par erreur, veuillez nous en aviser par courrier et
> d?truire imm?diatement le courrier et les pi?ces jointes. Merci.
> 
> ******************************************************************************
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

From modsec at spam.lifeforms.nl  Sat Mar  5 21:28:44 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sat, 5 Mar 2016 22:28:44 +0100
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders
In-Reply-To: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
References: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
Message-ID: <96635892-7474-4E83-9A55-B0F7C49E6EA1@spam.lifeforms.nl>

Thanks for the trust Chaim! :)

The best work is yet to come!

Though we can commit now, I propose for now to work in separate branches and request a code review from another person before merging to the master branch. So ideal workflow: Github issue -> discuss -> pull request -> code review -> merge to master.

I?ll start writing tests for the rules I will be changing. Until we can use the Official QA Tool, I?ll use my httpcheck format, and I will convert it to the chosen format later.

I see that Christian has already started tackling some reported issues on Github, which is awesome! At some point we should make an effort to go over the old issues too. Lots of them are about old CRS rules which are now gone in CRS v3. After the paranoid project has settled down, we?ll know for sure which rules are staying. I assume that CRS v2 will no longer get updates unless in exceptional cases? If so, we can communicate that. So I?ll keep this as a todo for after the paranoid rules are known.

Cheers!
WH


> On 29 Feb 2016, at 18:24, Chaim Sanders <CSanders at trustwave.com> wrote:
> 
> In general the Core Rule Set project has been moving along at a much faster pace in the past few months thanks to increased community involvement. In general I wanted to call out two individuals specifically, although there are MANY others involved and their help is also greatly valued; not only by me but by everyone in the community. As many of you know both Christian Folini (Dune73) and Walter Hop (Lifeforms) have been working extremely hard organizing and committing to various aspects of the upcoming OWASP CRS-3.0.0-RC1 release. In recognition of their support and hard work, I would like to announce that they have been given write-access to the OWASP-CRS GitHub. While we don?t have official titles, I bestow the unofficial title of ?Core Contributor/Developer? upon you both. I?d like to take this opportunity to congratulate both of these gentlemen and thank them for their diligent work. Thank you.
> 
> 
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

-- 
Walter Hop | PGP key: https://lifeforms.nl/pgp

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160305/a730d254/attachment.html>

From bridavis at cisco.com  Sat Mar  5 22:44:52 2016
From: bridavis at cisco.com (Brian Davis (bridavis))
Date: Sat, 5 Mar 2016 22:44:52 +0000
Subject: [Owasp-modsecurity-core-rule-set] ARGS working against PUT?
Message-ID: <D300CB93.23236%bridavis@cisco.com>

We're testing ModSecurity against some easy XSS tests. We have a PUT REST Call in which we embed <script>alert(document.cookie)</script> into a text dialog box, which should be easily picked up by RuleID:973336, but for some reason it's not. debug_cache log says no match.

Does ARGS work on PUTs in addition to POST? Reference documentation only seems to mention POST.

Additionally, I tried to use the FULL_REQUEST target to see if that would help, but I'm getting an error: Error creating rule: Unknown variable: FULL_REQUEST, but SecRequestBodyAccess On is in mod_security.conf.

This seems to be a very simple test in which mod_security should catch this, but not such luck.

Any thoughts?

Thanks,
Brian
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160305/86671a7c/attachment.html>

From modsec at spam.lifeforms.nl  Sun Mar  6 05:27:29 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 6 Mar 2016 06:27:29 +0100
Subject: [Owasp-modsecurity-core-rule-set] ARGS working against PUT?
In-Reply-To: <D300CB93.23236%bridavis@cisco.com>
References: <D300CB93.23236%bridavis@cisco.com>
Message-ID: <9E49377C-5365-45A5-B142-6E8D2962607B@spam.lifeforms.nl>

ARGS should be working on PUT. I wasn?t able to reproduce this problem myself. Would it be possible for you to post the request headers to the mailinglist?

I?m thinking maybe the client is not sending a "Content-Type: application/x-www-form-urlencoded? header, so ModSecurity might not be parsing the request body for arguments. But this is just a guess.

Cheers!
WH

> On 05 Mar 2016, at 23:44, Brian Davis (bridavis) <bridavis at cisco.com> wrote:
> 
> We?re testing ModSecurity against some easy XSS tests. We have a PUT REST Call in which we embed <script>alert(document.cookie)</script> into a text dialog box, which should be easily picked up by RuleID:973336, but for some reason it?s not. debug_cache log says no match.
> 
> Does ARGS work on PUTs in addition to POST? Reference documentation only seems to mention POST.
> 
> Additionally, I tried to use the FULL_REQUEST target to see if that would help, but I?m getting an error: Error creating rule: Unknown variable: FULL_REQUEST, but SecRequestBodyAccess On is in mod_security.conf.
> 
> This seems to be a very simple test in which mod_security should catch this, but not such luck.
> 
> Any thoughts?
> 
> Thanks,
> Brian
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-- 
Walter Hop | PGP key: https://lifeforms.nl/pgp

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/5a5c5160/attachment.html>

From christian.folini at netnea.com  Sun Mar  6 06:28:56 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 6 Mar 2016 07:28:56 +0100
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders
In-Reply-To: <96635892-7474-4E83-9A55-B0F7C49E6EA1@spam.lifeforms.nl>
References: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
	<96635892-7474-4E83-9A55-B0F7C49E6EA1@spam.lifeforms.nl>
Message-ID: <20160306062856.GA27157@elias>

Hi there,

On Sat, Mar 05, 2016 at 10:28:44PM +0100, Walter Hop wrote:
> Though we can commit now, I propose for now to work in separate branches and request a code review from another person before merging to the master branch. So ideal workflow: Github issue -> discuss -> pull request -> code review -> merge to master.

I like that as a best practice. Let's put this into the OWASP
wiki as development guideline. I would not make it a formal requirement
though, but something like 90% of commits should go that way.
(There are always reasons to shortcut a process and barring that
path takes away flexibility. We just have to make sure there
are actually good reasons in these cases).

> I see that Christian has already started tackling some reported issues on Github, which is awesome! At some point we should make an effort to go over the old issues too. 

I closed one or two of the old ones. It would be nice if we could 
make this a community effort.

Everybody can go out and look at the open issues.
https://github.com/SpiderLabs/owasp-modsecurity-crs/issues

Many of them are really simple like misinterpretations of what the
core rules are or lack of knowledge by the reporter to make a false 
positive disappear. Anybody can give the necessary infos to the
reporter. If you want to have the issue closed afterwards, just
drop me or Chaim or Walter a line.

Other issues are harder and demand a bit of testing or adjustment
of rules. If anybody has suggestions or ideas, adding to the
conversation on github and reporting here on the ML seems like
a good practice. We can then examine the proposed solution.

In the end, I think a community should keep a low number of
open issues. It looks much more welcoming that way. 

> Lots of them are about old CRS rules which are now gone in CRS v3. After the paranoid project has settled down, we?ll know for sure which rules are staying. I assume that CRS v2 will no longer get updates unless in exceptional cases? If so, we can communicate that. So I?ll keep this as a todo for after the paranoid rules are known.

Yep.

Cheers,

Christian


-- 
Ultimately, motivation gets us started, 
but discipline and habit are what enable us to finish.
-- Matthew Helmke

From avi.fatal at gmail.com  Sun Mar  6 07:48:28 2016
From: avi.fatal at gmail.com (Avi Fatal)
Date: Sun, 6 Mar 2016 09:48:28 +0200
Subject: [Owasp-modsecurity-core-rule-set] Parsing the log error
Message-ID: <CAFk_mWuLMV01E8enFF_wuhe5tLSPDcRbMsE4VZVk7_smFhyX9Q@mail.gmail.com>

Hi,
I want to trigger a daily email with aggregated data from modsecurity to
sites owners.
So I want to read the log, put in mysql/mongodb and trigger a job to send
the report to site owners.

I thought to read the apache log error because it is more structured than
audit log.
Do you know any good php parser that can read the log and put it in a
decent array?

Thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/c4584ab4/attachment.html>

From avi.fatal at gmail.com  Sun Mar  6 07:58:52 2016
From: avi.fatal at gmail.com (Avi Fatal)
Date: Sun, 6 Mar 2016 09:58:52 +0200
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders
In-Reply-To: <20160306062856.GA27157@elias>
References: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
	<96635892-7474-4E83-9A55-B0F7C49E6EA1@spam.lifeforms.nl>
	<20160306062856.GA27157@elias>
Message-ID: <CAFk_mWsNeoFtoemitXr+WHT2jvNqZrjP3Q22mqTC_fCRR3tdEA@mail.gmail.com>

Thank you all for your answers.
I will keep you updated.
Thanks!

On Sun, Mar 6, 2016 at 8:28 AM, Christian Folini <
christian.folini at netnea.com> wrote:

> Hi there,
>
> On Sat, Mar 05, 2016 at 10:28:44PM +0100, Walter Hop wrote:
> > Though we can commit now, I propose for now to work in separate branches
> and request a code review from another person before merging to the master
> branch. So ideal workflow: Github issue -> discuss -> pull request -> code
> review -> merge to master.
>
> I like that as a best practice. Let's put this into the OWASP
> wiki as development guideline. I would not make it a formal requirement
> though, but something like 90% of commits should go that way.
> (There are always reasons to shortcut a process and barring that
> path takes away flexibility. We just have to make sure there
> are actually good reasons in these cases).
>
> > I see that Christian has already started tackling some reported issues
> on Github, which is awesome! At some point we should make an effort to go
> over the old issues too.
>
> I closed one or two of the old ones. It would be nice if we could
> make this a community effort.
>
> Everybody can go out and look at the open issues.
> https://github.com/SpiderLabs/owasp-modsecurity-crs/issues
>
> Many of them are really simple like misinterpretations of what the
> core rules are or lack of knowledge by the reporter to make a false
> positive disappear. Anybody can give the necessary infos to the
> reporter. If you want to have the issue closed afterwards, just
> drop me or Chaim or Walter a line.
>
> Other issues are harder and demand a bit of testing or adjustment
> of rules. If anybody has suggestions or ideas, adding to the
> conversation on github and reporting here on the ML seems like
> a good practice. We can then examine the proposed solution.
>
> In the end, I think a community should keep a low number of
> open issues. It looks much more welcoming that way.
>
> > Lots of them are about old CRS rules which are now gone in CRS v3. After
> the paranoid project has settled down, we?ll know for sure which rules are
> staying. I assume that CRS v2 will no longer get updates unless in
> exceptional cases? If so, we can communicate that. So I?ll keep this as a
> todo for after the paranoid rules are known.
>
> Yep.
>
> Cheers,
>
> Christian
>
>
> --
> Ultimately, motivation gets us started,
> but discipline and habit are what enable us to finish.
> -- Matthew Helmke
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/b6c9d899/attachment.html>

From mail at noelzindel.org  Sun Mar  6 08:29:23 2016
From: mail at noelzindel.org (=?utf-8?Q?No=C3=ABl_Zindel?=)
Date: Sun, 6 Mar 2016 09:29:23 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Mode Status
In-Reply-To: <20160303092234.GA3778@elias>
References: <20160303092234.GA3778@elias>
Message-ID: <FEC75094-DB64-4B95-84BC-898E660569DD@noelzindel.org>

Hi everyone,

I probably missed this information somewhen during our conversation.

Two things. Do we have a paranoia-level assignment for each candidate?
And what about the rule IDs for rules that were initially dropped but later assigned to paranoia mode?

Thanks for feedback.

Cheers,
No?l

> On 03 Mar 2016, at 10:22, Christian Folini <christian.folini at netnea.com> wrote:
> 
> Hi there,
> 
> Chaim merged our first pull request yesterday morning GMT.
> For me, this is the formal blessing of our plans, even more so as
> Ryan named Chaim his successor as project lead last week. Chaim
> gave me write access to the CRS repository and I plan to use that
> for the subsequent pull requests.
> 
> What is left to do?
> Pull Request #2: Move 3.0.0 candidate rules to paranoia mode
> With this milestone reached, we can invite people to run
> the new ruleset (and see a difference with false positives)
> Pull Request #3: Add 2.2.X rules to paranoia mode
> Pull Request #4: Add stricter siblings
> 
> No?l volunteered to do pull request #2. It is a simple job. You
> only need to move the rules around (and tag them accordingly).
> 
> Would somebody among you like to do pull request #3 and #4?
> That would be nice as it would allow you to feature in the
> CHANGES file and underline the community character of the
> paranoia mode. Just drop me a line.
> 
> Pull request. Here is what I did
> (CAVEAT: I am not a very experienced git user. This worked
> for me, but maybe you guys have improvements for the procedure.)
> 
> Fork spiderlabs/crs online at github
> Clone with:
>  $> git clone https://github.com/dune73/owasp-modsecurity-crs.git paranoia
> Add the remote:
>  $> git remote add upstream https://github.com/SpiderLabs/owasp-modsecurity-crs.git
> Check:
>  $> git remote -v
>  origin  https://github.com/dune73/owasp-modsecurity-crs.git (fetch)
>  origin  https://github.com/dune73/owasp-modsecurity-crs.git (push)
>  upstream        https://github.com/SpiderLabs/owasp-modsecurity-crs.git (fetch)
>  upstream        https://github.com/SpiderLabs/owasp-modsecurity-crs.git (push)
> Fetch upstream branches list
>  $> git fetch upstream
> 	* [new branch]      gh-pages   -> upstream/gh-pages
> 	* [new branch]      master     -> upstream/master
> 	* [new branch]      owasp-honeypots -> upstream/owasp-honeypots
> 	* [new branch]      trunk      -> upstream/trunk
> 	* [new branch]      v3.0.0-dev -> upstream/v3.0.0-dev
> 	* [new branch]      v3.0.0-rc1 -> upstream/v3.0.0-rc1
> Checkout 3.0.0rc1 branch
>  $> git checkout remotes/upstream/v3.0.0-rc1
> Start new personal branch
>  $> git checkout -b paranoia-mode
> Do your update
> ...
> status
>  $> git status
> ...
> Add changes
>  $> git add ...
> Commit changes
>  $> git commit -m "blabla..."
> Push changes to personal branch on git
>  $> git push
> 
> Go online and create pull request
> 
> @No?l: Does this make sense to you? If not, just ask.
> 
> Ideally, you could do this in the next two days and I can test and
> merge on the weekend or early next week.
> 
> Franziska has two open questions which need to be sorted out before
> the pull request #4. We agreed she will post these two the
> mailinglist.
> 
> Cheers,
> 
> Christian
> 
> 
> 
> --
> One can acquire everything in solitude - except character.
> -- Stendhal

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/cd91298f/attachment.pgp>

From christian.folini at netnea.com  Sun Mar  6 08:57:20 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 6 Mar 2016 09:57:20 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Mode Status
In-Reply-To: <FEC75094-DB64-4B95-84BC-898E660569DD@noelzindel.org>
References: <20160303092234.GA3778@elias>
	<FEC75094-DB64-4B95-84BC-898E660569DD@noelzindel.org>
Message-ID: <20160306085720.GA30892@elias>

Good morning No?l,

On Sun, Mar 06, 2016 at 09:29:23AM +0100, No?l Zindel wrote:
> I probably missed this information somewhen during our conversation.

It was more implicit, I guess.

> Two things. Do we have a paranoia-level assignment for each candidate?

I think we should start with paranoia level 20. If somebody sees good
reasons for an individual rule getting an even higher setting, then
it's a separate discussion and get done any time.

> And what about the rule IDs for rules that were initially dropped but
> later assigned to paranoia mode?

Technically, this is going to be pull request #3, is not it? I'd like to
keep this separate from #2.

But then, I think we should just move the formerly dropped 2.2.X rules
into the respective files and continue with the numbers in steps of 10
of the individual files. It is important to add them to 
https://github.com/SpiderLabs/owasp-modsecurity-crs/tree/v3.0.0-rc1/id_renumbering
as well.

Ahoj,

Christian

P.S. You quote a private paranoia-level message in your mailinglist
message without making this clear (-> this could puzzle people who did
not get that message). And some people do not like their private
messages shared on mailinglists without asking first.
No hard feelings from my side. Just saying.


-- 
History repeats itself, first as tragedy, second as XML.
--- Comment found on slashdot
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 181 bytes
Desc: Digital signature
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/e3da7f10/attachment.pgp>

From franziska.buehler.schmocker at gmail.com  Sun Mar  6 08:57:45 2016
From: franziska.buehler.schmocker at gmail.com (Franziska Buehler)
Date: Sun, 6 Mar 2016 09:57:45 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Numbering scheme
	for stricter siblings
Message-ID: <CALrdzm+utJm_vqqw3dF_XC+A=e-h5bS97st1k5AhD6CFfZ9gbQ@mail.gmail.com>

Hello,

We already have some stricter siblings for existing rules.
But we don?t have a numbering scheme for these new rules yet.
My suggestion would be as follows:

The RuleIDs in CRS 3.0.0 count up in steps of 10. An obvious
possibility is to use the last digit.
Subsequent stricter clones of a main rule will be assigned the id of
the main rule plus the last digit incremented.

For example, we produce a stricter sibling of the rule 920270. The new
stricter clone gets the id 920271. If we produce an even stricter
sibling, this rule will get the rule id 920272 and so on.

We will not produce more than 5 different clones, because we defined
the paranoia levels from 0 to 4. So we have enough space.

What are your thougts about this proposal?

Regards,
Franziska

From franziska.buehler.schmocker at gmail.com  Sun Mar  6 09:00:08 2016
From: franziska.buehler.schmocker at gmail.com (Franziska Buehler)
Date: Sun, 6 Mar 2016 10:00:08 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Multiple log
	entries of stricter siblings
Message-ID: <CALrdzmJ5pJQdoU2jU7qntKqbMmBP2L9e=4nYOwNLu33ihPmpcw@mail.gmail.com>

Hi,

We have some proposals for stricter siblings of existing rules.
When cloning rules to stricter siblings, multiple rules at different
paranoia levels could match.
Several clones of a rule should use strict limits to avoid multiple
log entries for one request.

I take Christians example to explain what I mean:
In his example, to explain the mechanics proposal, he clones the rule
981173. The main rule is suggested to be at paranoia level 2,
accompanied with two stricter siblings at level 3 and 4.

Paranoia level 2:
SecRule ARGS_NAMES|ARGS|XML:/* "([\~\!\@\#\.....\<\>].*?){5,}" \...

Paranoia level 3:
SecRule ARGS_NAMES|ARGS|XML:/* "([\~\!\@\#\.....\<\>].*?){3,}" \...

Paranoia level 4:
SecRule ARGS_NAMES|ARGS|XML:/* "[\~\!\@\#\.....\<\>]" \...

In this example, requests with more than 5 special characters, and a
chosen paranoia level of 4, will create three distinct log entries in
turn.
Example with stricter limits at paranoia level 3:
SecRule ARGS_NAMES|ARGS|XML:/*"([\~\!\@\#\.....\<\>].*?){3,4}"\

Perhaps we want to cumulate log entries to emphasize the severity.
I don?t think like this idea, because it makes it more difficult to
read the logs.

What do you think about that?

Regards,
Franziska

From mail at noelzindel.org  Sun Mar  6 09:28:55 2016
From: mail at noelzindel.org (=?utf-8?Q?No=C3=ABl_Zindel?=)
Date: Sun, 6 Mar 2016 10:28:55 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Mode Status
In-Reply-To: <20160306085720.GA30892@elias>
References: <20160303092234.GA3778@elias>
	<FEC75094-DB64-4B95-84BC-898E660569DD@noelzindel.org>
	<20160306085720.GA30892@elias>
Message-ID: <4EF7B1FA-5782-49DD-89D3-8D67749BCB4C@noelzindel.org>

Christian,

> On 06 Mar 2016, at 09:57, Christian Folini <christian.folini at netnea.com> wrote:
> 
>> Two things. Do we have a paranoia-level assignment for each candidate?
> 
> I think we should start with paranoia level 20. If somebody sees good
> reasons for an individual rule getting an even higher setting, then
> it's a separate discussion and get done any time.

I guess this should be ?paranoia level 2?, since we agreed on using level 0 to 4, right?

>> And what about the rule IDs for rules that were initially dropped but
>> later assigned to paranoia mode?
> 
> Technically, this is going to be pull request #3, is not it? I'd like to
> keep this separate from #2.

Right, got it.

> It is important to add them to
> https://github.com/SpiderLabs/owasp-modsecurity-crs/tree/v3.0.0-rc1/id_renumbering
> as well.

I understand this will be part of #3 as well.

> P.S. You quote a private paranoia-level message in your mailinglist
> message without making this clear (-> this could puzzle people who did
> not get that message). And some people do not like their private
> messages shared on mailinglists without asking first.
> No hard feelings from my side. Just saying.

Thanks for noting. This was careless acting on my side - sorry for that.
Will keep this in mind.

Cheers,
No?l


-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/8e771e31/attachment.pgp>

From christian.folini at netnea.com  Sun Mar  6 09:46:29 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 6 Mar 2016 10:46:29 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Mode Status
In-Reply-To: <4EF7B1FA-5782-49DD-89D3-8D67749BCB4C@noelzindel.org>
References: <20160303092234.GA3778@elias>
	<FEC75094-DB64-4B95-84BC-898E660569DD@noelzindel.org>
	<20160306085720.GA30892@elias>
	<4EF7B1FA-5782-49DD-89D3-8D67749BCB4C@noelzindel.org>
Message-ID: <20160306094629.GA31972@elias>

On Sun, Mar 06, 2016 at 10:28:55AM +0100, No?l Zindel wrote:
> I guess this should be ?paranoia level 2?, since we agreed on using level 0 to 4, right?

Oh absolutely. Sorry.

> I understand this will be part of #3 as well.

yep

> Thanks for noting. This was careless acting on my side - sorry for that.
> Will keep this in mind.

No worries.

Christian


-- 
Knowing that two plus two always equals four can be a pretty 
powerful concept.
-- Joel Greenblatt
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 181 bytes
Desc: Digital signature
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/364f21a0/attachment.pgp>

From modsec at spam.lifeforms.nl  Sun Mar  6 13:47:56 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 6 Mar 2016 14:47:56 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Numbering
	scheme for stricter siblings
In-Reply-To: <CALrdzm+utJm_vqqw3dF_XC+A=e-h5bS97st1k5AhD6CFfZ9gbQ@mail.gmail.com>
References: <CALrdzm+utJm_vqqw3dF_XC+A=e-h5bS97st1k5AhD6CFfZ9gbQ@mail.gmail.com>
Message-ID: <77E1272B-2E99-4B54-ADBF-16CBD1EC1CEA@spam.lifeforms.nl>

Sounds great!

> On 06 Mar 2016, at 09:57, Franziska Buehler <franziska.buehler.schmocker at gmail.com> wrote:
> 
> Hello,
> 
> We already have some stricter siblings for existing rules.
> But we don?t have a numbering scheme for these new rules yet.
> My suggestion would be as follows:
> 
> The RuleIDs in CRS 3.0.0 count up in steps of 10. An obvious
> possibility is to use the last digit.
> Subsequent stricter clones of a main rule will be assigned the id of
> the main rule plus the last digit incremented.
> 
> For example, we produce a stricter sibling of the rule 920270. The new
> stricter clone gets the id 920271. If we produce an even stricter
> sibling, this rule will get the rule id 920272 and so on.
> 
> We will not produce more than 5 different clones, because we defined
> the paranoia levels from 0 to 4. So we have enough space.
> 
> What are your thougts about this proposal?
> 
> Regards,
> Franziska
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


From modsec at spam.lifeforms.nl  Sun Mar  6 14:11:51 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 6 Mar 2016 15:11:51 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Multiple log
	entries of stricter siblings
In-Reply-To: <CALrdzmJ5pJQdoU2jU7qntKqbMmBP2L9e=4nYOwNLu33ihPmpcw@mail.gmail.com>
References: <CALrdzmJ5pJQdoU2jU7qntKqbMmBP2L9e=4nYOwNLu33ihPmpcw@mail.gmail.com>
Message-ID: <F9848279-85AC-4A18-A7B1-DD7065568AD0@spam.lifeforms.nl>

> On 06 Mar 2016, at 10:00, Franziska Buehler <franziska.buehler.schmocker at gmail.com> wrote:
> 
> Hi,
> 
> We have some proposals for stricter siblings of existing rules.
> When cloning rules to stricter siblings, multiple rules at different
> paranoia levels could match.
> Several clones of a rule should use strict limits to avoid multiple
> log entries for one request.

I also think that 'stricter siblings? should not cause rule matches for all siblings.

Having multiple log lines in the audit entry for one violation will be confusing to users and waste space.

Your message also makes me remember another possible problem: the anomaly score being increased multiple times. (I don?t recall if this was already decided on earlier, in any case I can?t find it in the list archives)

For instance, if a user runs at paranoia level 4, we don?t want the following to happen:

> Paranoia level 2:
> SecRule ARGS_NAMES|ARGS|XML:/* "([\~\!\@\#\.....\<\>].*?){5,}" \?

anomaly +5

> Paranoia level 3:
> SecRule ARGS_NAMES|ARGS|XML:/* "([\~\!\@\#\.....\<\>].*?){3,}" \?

anomaly +5

> Paranoia level 4:
> SecRule ARGS_NAMES|ARGS|XML:/* "[\~\!\@\#\.....\<\>]" \?

anomaly +5

?which gives the user an anomaly score of 15 for a single character sequence.

It seems counter-intuitive to me that we?d accumulate the anomaly score just by the presence of a single threat heuristic (that we happen to have multiple siblings for). This would make these rules overpowered compared to the other rules.

So, I think it?s very important to prevent multiple sibling rules firing.

If we want to prevent this, we could do it with a variable. As soon as a sibling triggers, we just set a variable specific to that ?family? of siblings. The other siblings would chain on that variable and simply not trigger when it?s set by an earlier sibling. Then, as the rules are handled from top to bottom, simply the most severe sibling will be triggered and logged.

It comes with a little bit of rule complexity in handling the variables, but this will be an easy copy-pasteable recipe, we won?t have to change the paranoia mechanism, and its performance impact is low.

(Alternatively, in the rule example you?ve given, we could hand-craft the rules to only trigger in their specific instance, like:
- level 2: {5,}
- level 3: {3,4}
- level 4: {1,2}
but this has the danger that we will mistype and cause a ?hole? in the coverage. I think it?s safer for the rules to ?overlap? and prevent multiple triggers through another mechanism.)

Any thoughts or other possible solutions?

Cheers!
WH

From mail at noelzindel.org  Sun Mar  6 15:45:11 2016
From: mail at noelzindel.org (=?utf-8?Q?No=C3=ABl_Zindel?=)
Date: Sun, 6 Mar 2016 16:45:11 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
Message-ID: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>

Hey everyone,

with Christian backing me, I was able to just bring out the second pull request for our little project.
As I?m still figuring out all this Git and Github stuff, I?m not quite sure everything worked as intended.

https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/298 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/298>

Can someone please check this out and if OK, I think we are ready to test the setting.
(I only did a quick configuration check before putting this out, so this should be tested more thoroughly)

Thanks.

Cheers,
No?l
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/8111959c/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/8111959c/attachment.pgp>

From bridavis at cisco.com  Sun Mar  6 15:49:30 2016
From: bridavis at cisco.com (Brian Davis (bridavis))
Date: Sun, 6 Mar 2016 15:49:30 +0000
Subject: [Owasp-modsecurity-core-rule-set] ARGS against PUT (was Re:
 Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 8)
Message-ID: <D301B9B2.23313%bridavis@cisco.com>

(For some reason I didn?t get the direct email response.)

After doing some more research, I think it?s relates to the fact that the
<script> is in a JSON payload, and it turns out I?m not running a recent
enough version of mod security which supports JSON parsing. CentOS 7.1 is
only packaging 2.7.3, where as JSON parser comes in 2.8.

I?m working on manually upgrading and trying again to see if that helps.

Thanks,
Brian

>Date: Sun, 6 Mar 2016 06:27:29 +0100
>From: Walter Hop <modsec at spam.lifeforms.nl>
>To: "owasp-modsecurity-core-rule-set at lists.owasp.org"
>	<owasp-modsecurity-core-rule-set at lists.owasp.org>
>Subject: Re: [Owasp-modsecurity-core-rule-set] ARGS working against
>	PUT?
>Message-ID: <9E49377C-5365-45A5-B142-6E8D2962607B at spam.lifeforms.nl>
>Content-Type: text/plain; charset="utf-8"
>
>ARGS should be working on PUT. I wasn?t able to reproduce this problem
>myself. Would it be possible for you to post the request headers to the
>mailinglist?
>
>I?m thinking maybe the client is not sending a "Content-Type:
>application/x-www-form-urlencoded? header, so ModSecurity might not be
>parsing the request body for arguments. But this is just a guess.
>
>Cheers!
>WH
>
>> On 05 Mar 2016, at 23:44, Brian Davis (bridavis) <bridavis at cisco.com>
>>wrote:
>> 
>> We?re testing ModSecurity against some easy XSS tests. We have a PUT
>>REST Call in which we embed <script>alert(document.cookie)</script> into
>>a text dialog box, which should be easily picked up by RuleID:973336,
>>but for some reason it?s not. debug_cache log says no match.
>> 
>> Does ARGS work on PUTs in addition to POST? Reference documentation
>>only seems to mention POST.
>> 
>> Additionally, I tried to use the FULL_REQUEST target to see if that
>>would help, but I?m getting an error: Error creating rule: Unknown
>>variable: FULL_REQUEST, but SecRequestBodyAccess On is in
>>mod_security.conf.
>> 
>> This seems to be a very simple test in which mod_security should catch
>>this, but not such luck.
>> 
>> Any thoughts?
>> 
>> Thanks,
>> Brian
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>-- 
>Walter Hop | PGP key: https://lifeforms.nl/pgp


From christian.folini at netnea.com  Sun Mar  6 16:55:00 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 6 Mar 2016 17:55:00 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Numbering
 scheme for stricter siblings
In-Reply-To: <77E1272B-2E99-4B54-ADBF-16CBD1EC1CEA@spam.lifeforms.nl>
References: <CALrdzm+utJm_vqqw3dF_XC+A=e-h5bS97st1k5AhD6CFfZ9gbQ@mail.gmail.com>
	<77E1272B-2E99-4B54-ADBF-16CBD1EC1CEA@spam.lifeforms.nl>
Message-ID: <20160306165500.GA6312@elias>

Yes, I think so too. Chaim has done steps of 10 for a reason.

And that way, it is immediately visible that i.e. 920272 is closely
related to 920270.

Ahoj,

Christian

On Sun, Mar 06, 2016 at 02:47:56PM +0100, Walter Hop wrote:
> Sounds great!
> 
> > On 06 Mar 2016, at 09:57, Franziska Buehler <franziska.buehler.schmocker at gmail.com> wrote:
> > 
> > Hello,
> > 
> > We already have some stricter siblings for existing rules.
> > But we don?t have a numbering scheme for these new rules yet.
> > My suggestion would be as follows:
> > 
> > The RuleIDs in CRS 3.0.0 count up in steps of 10. An obvious
> > possibility is to use the last digit.
> > Subsequent stricter clones of a main rule will be assigned the id of
> > the main rule plus the last digit incremented.
> > 
> > For example, we produce a stricter sibling of the rule 920270. The new
> > stricter clone gets the id 920271. If we produce an even stricter
> > sibling, this rule will get the rule id 920272 and so on.
> > 
> > We will not produce more than 5 different clones, because we defined
> > the paranoia levels from 0 to 4. So we have enough space.
> > 
> > What are your thougts about this proposal?
> > 
> > Regards,
> > Franziska
> > _______________________________________________
> > Owasp-modsecurity-core-rule-set mailing list
> > Owasp-modsecurity-core-rule-set at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> 
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-- 
mailto:christian.folini at netnea.com
http://www.christian-folini.ch
twitter: @ChrFolini

From modsec at spam.lifeforms.nl  Sun Mar  6 17:04:51 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 6 Mar 2016 18:04:51 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
Message-ID: <70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>

Hi Noel,

Awesome work!

The pull request is huge though, it seems to contain much of the CRS history from 2013? I think it might be based on the wrong branch of spiderlabs/owasp-modsecurity-crs. It should be based off branch "v3.0.0-rc1? so it should only show your own local changes.

I think it might be possible to change this in the existing pull request using the Github GUI, but I haven?t ever done this yet, so I?m not sure. If not it might be easier to start over with a new pull request and just re-copy your changed files over.

I think I?ll start with a very small pull request today, in order to learn how to do this myself :)

Cheers!
WH

> On 06 Mar 2016, at 16:45, No?l Zindel <mail at noelzindel.org> wrote:
> 
> Hey everyone,
> 
> with Christian backing me, I was able to just bring out the second pull request for our little project.
> As I?m still figuring out all this Git and Github stuff, I?m not quite sure everything worked as intended.
> 
> https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/298 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/298>
> 
> Can someone please check this out and if OK, I think we are ready to test the setting.
> (I only did a quick configuration check before putting this out, so this should be tested more thoroughly)
> 
> Thanks.
> 
> Cheers,
> No?l
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-- 
Walter Hop | PGP key: https://lifeforms.nl/pgp

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/dfed189b/attachment-0001.html>

From christian.folini at netnea.com  Sun Mar  6 17:09:56 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 6 Mar 2016 18:09:56 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
Message-ID: <20160306170955.GB6055@elias>

Hi No?l,

Thank you for this laborious pull request. I looked at a few of the
files and they look good. So we are close AFAICT.

On Sun, Mar 06, 2016 at 04:45:11PM +0100, No?l Zindel wrote:
> As I?m still figuring out all this Git and Github stuff, I?m not quite sure everything worked as intended.

Yes, here is the issue. Your pull request goes against the master tree
(which is still 2.2.X). The idea is to provide a pull request against
v3.0.0-rc1.

Did you checkout 
$> git checkout remotes/upstream/v3.0.0-rc1 
before creating your branch?

Please save your work (= the updated files) and do a new
checkout. Then you import all your files again and then,
before you do the pull request, you run a 
$> git diff

The changeset should then show you changes in about 20 files
under ./rules. Your pull request #298 has a huge changeset, 
as it incorporates all the changes of v3.0.0-rc1 against 
master/2.2.X. Over 100 files...

Give it another shot! We're getting there.

Ahoj,

Christian


-- 
If you're going through hell, keep going.
-- Winston Churchill

From modsec at spam.lifeforms.nl  Sun Mar  6 17:43:56 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 6 Mar 2016 18:43:56 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
	<70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>
Message-ID: <9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>

Just in case anyone is interested, this is the procedure I normally follow for pull requests:
https://gist.github.com/lifeforms/c8778a05bf0385c7f391

I?ve created a pull request here just to test, though Christian may review and accept it :) I?ll need the file in there so I can easily add to it when working on the PHP rules. We?ll convert them to use Chaim?s tool when it?s ready.
https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299

Cheers!
WH

-- 
Walter Hop | PGP key: https://lifeforms.nl/pgp

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/383ffc81/attachment.html>

From christian.folini at netnea.com  Sun Mar  6 18:21:08 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 6 Mar 2016 19:21:08 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Multiple log
 entries of stricter siblings
In-Reply-To: <F9848279-85AC-4A18-A7B1-DD7065568AD0@spam.lifeforms.nl>
References: <CALrdzmJ5pJQdoU2jU7qntKqbMmBP2L9e=4nYOwNLu33ihPmpcw@mail.gmail.com>
	<F9848279-85AC-4A18-A7B1-DD7065568AD0@spam.lifeforms.nl>
Message-ID: <20160306182108.GA6761@elias>

Hello everybody,

Thanks to Franziska for bringing this up. It has to be sorted out and
we need a general policy to adhere to. The worst would be each group
of related rules (a base rule and its siblings) to behave differently.

It's a real problem.

On Sun, Mar 06, 2016 at 03:11:51PM +0100, Walter Hop wrote:
> Your message also makes me remember another possible problem: the anomaly score being increased multiple times. (I don?t recall if this was already decided on earlier, in any case I can?t find it in the list archives)

That's the other side of the same medal: Multiple alerts, raising the
anomaly score multiple times.

> For instance, if a user runs at paranoia level 4, we don?t want the following to happen:
> 
> > Paranoia level 2:
> > SecRule ARGS_NAMES|ARGS|XML:/* "([\~\!\@\#\.....\<\>].*?){5,}" \?
> 
> anomaly +5
> 
> > Paranoia level 3:
> > SecRule ARGS_NAMES|ARGS|XML:/* "([\~\!\@\#\.....\<\>].*?){3,}" \?
> 
> anomaly +5
> 
> > Paranoia level 4:
> > SecRule ARGS_NAMES|ARGS|XML:/* "[\~\!\@\#\.....\<\>]" \?
> 
> anomaly +5

Thank you for that obvious example, Walter. I think this illustrates the
problem described b Franziska very plainly.

I admit this looks a bit crazy. But please give me a chance to highlight 
the advantages of this when compared to the alternatives.

At Paranoia Level 2, we get the 1 alert, score 5.
	Say rule 942380.
At Paranoia Level 3, we get the 2 alert, score 10.
	Say rule 942380, 942381.
At Paranoia Level 4, we get the 3 alert, score 15.
	Say rule 942380, 942381 and 942382.

This is very consistent behaviour. The higher you go. The more
alerts you get and the higher the score. This is what I would
expect from a paranoia setting. 

If we adopt the alternative strategy with distinct alerts, we
encounter a different behaviour. Here are the new limits:
> - level 2: {5,}
> - level 3: {3,4}       (vs. {3,} in the example above)
> - level 4: {1,2}       (vs. {1,} in the example above)

The behaviour is now:
At Paranoia Level 2, we get the 1 alert, score 5.
	Say rule 942380.
At Paranoia Level 3, we get the 1 alert, score 5.
	Say rule 942381.
At Paranoia Level 4, we get the 1 alert, score 5.
	Say rule 942382.

If you are familiar with the paranoia mode, you will realise,
that there is a relationship between the requests and this
makes sense.

Now, if you are unfamiliar, then this is strange behaviour.
You change the paranoia setting and alerts disappear and new
ones appear, but somehow the anomaly score remains the same.
That must be puzzling. The alerts are now a moving target
and changing the paranoia level does not alter the overall
anomaly score, just the composition of the alerts that result 
in the said score. Strange to understand for the uninitiated.

It would be unwise to start with a high paranoia setting and
then reduce it. But I imagine an enthusiastic newbie might set
out this way. He does some tuning (-> removed 942382) and then he 
realises he needs to lower the paranoia level for there are just
too many false positives. With this approach he will get a 
new alert for 942381. So the anomaly score will actually be 
higher with a lower paranoia setting. And that's totally crazy.

With the cumulative behaviour. He has a lot more alerts,
but whatever you tune on level 4, the level 3 will have
less alerts and a lower anomaly score.
I think that is very easy to understand even if there is an
excessive amount of alerts.

If we take the more reasonable approach and start with
paranoia setting 2, we get a single alert. We tune this away
and then when everything seems calm and cosy, so we raise
the paranoia level to 3. Now a new alerts pops up. Makes sense,
higher paranoia, new alert. You attempt to tune it and
stumble over the previous tuning rule and you realise the
alerts are siblings and with the stricter setting, you
have to tune it a second time. And then repeat for
paranoia level 4.

So I would argue, if you follow the best practice in the
soon to be written documentation, you won't be confronted
with cumulative alerts on the same parameter. You will start
with a low paranoia level and tune the false positives
before you move higher.

But of course, a real attack will trigger 3 times. And I
do not mind that. If there is a real attack then I am
very open for anomaly score to grow at great velocity. And 
in fact that is the behaviour of the 2.2.X core rules:

$> curl --data "arg1=' or 1=1" "http://localhost/index.html"

brings

981318 ARGS:arg1 SQL Injection Attack: Common Injection Testing Detected
950901 ARGS:arg1 SQL Injection Attack: SQL Tautology Detected.
959071 ARGS:arg1 SQL Injection Attack
981242 ARGS:arg1 Detects classic SQL injection probings 1/2

That's a score of 20 for a single parameter. And it's what makes
the sqli core rules so strong. If you really attempt an sql
injection right now, it will sound as if an elephant would dash 
into a china shop.

Where you do have a point though is that attack vectors for
weaknesses, where we have rules with stricter siblings, will
trigger a higher anomaly score than a different attack, where
the rules do _not_ have stricter siblings. So cumulation has
an unbalancing effect. But I do not really mind this very much.
It is in line with the core rules focusing more on certain areas
than others. We are very strong against sql injection, but
traditionally fairly weak when it comes to ldap injections.

There is more to it. If we have more complicated rules than the example,
it's more difficult to avoid the cumulation.  If you can go from {3,} to
{3,4}, that's easy. But if you need to work with more complex patterns,
it gets very hard. It makes complex rules even more complex.

I do not want to dig for a perfect example, but imagine we want to
do rules and stricter siblings for these evasion attempts:
https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/294

This means that a stricter sibling would have to cover strong evasion b
_and_ make sure it does not trigger on the simple evasion a, as evasion
a is already covered in a less strict sibling. The stricter sibling would 
thus be even more complex. And if I can chose between
annoying plain cumulation and added complexity, I will go for cumulation
any time.

Walter, you propose a variable to keep the siblings of a single
group together and then evaluate them together. I think this might
solve the problem I just pointed out. But it adds complexity
again - and the rules are no longer self contained. They will
thus be harder to read, more difficult to write and tough to update.
I like the self-contained nature of the rules we have.
There are a few chains, there are a few variables that are set
by rule a and evaluated by rule b, but all in all most rules
are self contained. That's plain and simple.

There is a 2nd issue with this variable proposal. The way the
merged mechanism works right now is that rules of paranoia level
2 are executed before level 3 and finally level 4. If we return
to the example above, 942380 has triggered before 942381 is
even evaluated. You would have to withhold the alert of 942380
in order to see if 942381 triggers before you can evaluate the
first alert. This means you need to change the behaviour of
942380 because it has a stricter sibling. This adds complexity
again. The cumulation is way simpler for the rules.
942380 works by itself. Then 942381, then 942381. Very plain.
I think that's a lot better.

Sorry for taking this long. It's time to come to an end.
When I read Franziska's message, I was ready to agree. But 
then I thought about it and I came to the conclusion, that 
alert cumulation is not ideal, but everything else is even 
worse. 

Let's keep it simple even if it brings a few more alerts.

Cheers,

Christian

-- 
mailto:christian.folini at netnea.com
http://www.christian-folini.ch
twitter: @ChrFolini

From mail at noelzindel.org  Sun Mar  6 19:18:45 2016
From: mail at noelzindel.org (=?utf-8?Q?No=C3=ABl_Zindel?=)
Date: Sun, 6 Mar 2016 20:18:45 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
	<70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>
	<9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>
Message-ID: <A7DD6614-5D1A-4C45-8130-B4E5B98F8D13@noelzindel.org>

Walter, Christian,

thanks for the assistance. I wasn?t quite sure if the 100 commits and 15k lines of changed code in my initial request were just an overall statistic ;)

As it seems, I really only forgot to base my pull request on the 3.0.0-rc1 branch. Unfortunately it?s required to create a new pull request, since there?s no way to adjust the merge target for an existing one.

My PR should be fixed now and we?re good to go: https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300>.

And thanks, Walter, for sharing your workflow.

Cheers,
No?l


> On 06 Mar 2016, at 18:43, Walter Hop <modsec at spam.lifeforms.nl> wrote:
> 
> Just in case anyone is interested, this is the procedure I normally follow for pull requests:
> https://gist.github.com/lifeforms/c8778a05bf0385c7f391 <https://gist.github.com/lifeforms/c8778a05bf0385c7f391>
> 
> I?ve created a pull request here just to test, though Christian may review and accept it :) I?ll need the file in there so I can easily add to it when working on the PHP rules. We?ll convert them to use Chaim?s tool when it?s ready.
> https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299>
> 
> Cheers!
> WH
> 
> --
> Walter Hop | PGP key: https://lifeforms.nl/pgp <https://lifeforms.nl/pgp>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/be822b50/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/be822b50/attachment-0001.pgp>

From mail at noelzindel.org  Sun Mar  6 19:27:31 2016
From: mail at noelzindel.org (=?utf-8?Q?No=C3=ABl_Zindel?=)
Date: Sun, 6 Mar 2016 20:27:31 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Numbering
	scheme for stricter siblings
In-Reply-To: <CALrdzm+utJm_vqqw3dF_XC+A=e-h5bS97st1k5AhD6CFfZ9gbQ@mail.gmail.com>
References: <CALrdzm+utJm_vqqw3dF_XC+A=e-h5bS97st1k5AhD6CFfZ9gbQ@mail.gmail.com>
Message-ID: <19F2150A-A777-4C4D-ABB0-1B4E1F0630DB@noelzindel.org>

Hi Franziska,

thanks for bringing this up. I absolutely agree with you, and the others.

Since there has been no opposition so far, I will implement the ID assignment into our wiki documentation tomorrow.
If there should come up any argumentation against it, it?s a quick change.

Cheers,
No?l

> On 06 Mar 2016, at 09:57, Franziska Buehler <franziska.buehler.schmocker at gmail.com> wrote:
> 
> Hello,
> 
> We already have some stricter siblings for existing rules.
> But we don?t have a numbering scheme for these new rules yet.
> My suggestion would be as follows:
> 
> The RuleIDs in CRS 3.0.0 count up in steps of 10. An obvious
> possibility is to use the last digit.
> Subsequent stricter clones of a main rule will be assigned the id of
> the main rule plus the last digit incremented.
> 
> For example, we produce a stricter sibling of the rule 920270. The new
> stricter clone gets the id 920271. If we produce an even stricter
> sibling, this rule will get the rule id 920272 and so on.
> 
> We will not produce more than 5 different clones, because we defined
> the paranoia levels from 0 to 4. So we have enough space.
> 
> What are your thougts about this proposal?
> 
> Regards,
> Franziska
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 801 bytes
Desc: Message signed with OpenPGP using GPGMail
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/2dbd3fde/attachment.pgp>

From christian.folini at netnea.com  Sun Mar  6 20:40:33 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 6 Mar 2016 21:40:33 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <A7DD6614-5D1A-4C45-8130-B4E5B98F8D13@noelzindel.org>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
	<70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>
	<9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>
	<A7DD6614-5D1A-4C45-8130-B4E5B98F8D13@noelzindel.org>
Message-ID: <20160306204033.GA5266@elias>

Thanks No?l, that looks better. :)

I'll check it carefully in the next days. Would be pleased if more
people could give it a spin.

Ahoj,

Christian




On Sun, Mar 06, 2016 at 08:18:45PM +0100, No?l Zindel wrote:
> Walter, Christian,
> 
> thanks for the assistance. I wasn?t quite sure if the 100 commits and 15k lines of changed code in my initial request were just an overall statistic ;)
> 
> As it seems, I really only forgot to base my pull request on the 3.0.0-rc1 branch. Unfortunately it?s required to create a new pull request, since there?s no way to adjust the merge target for an existing one.
> 
> My PR should be fixed now and we?re good to go: https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300>.
> 
> And thanks, Walter, for sharing your workflow.
> 
> Cheers,
> No?l
> 
> 
> > On 06 Mar 2016, at 18:43, Walter Hop <modsec at spam.lifeforms.nl> wrote:
> > 
> > Just in case anyone is interested, this is the procedure I normally follow for pull requests:
> > https://gist.github.com/lifeforms/c8778a05bf0385c7f391 <https://gist.github.com/lifeforms/c8778a05bf0385c7f391>
> > 
> > I?ve created a pull request here just to test, though Christian may review and accept it :) I?ll need the file in there so I can easily add to it when working on the PHP rules. We?ll convert them to use Chaim?s tool when it?s ready.
> > https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299>
> > 
> > Cheers!
> > WH
> > 
> > --
> > Walter Hop | PGP key: https://lifeforms.nl/pgp <https://lifeforms.nl/pgp>
> > _______________________________________________
> > Owasp-modsecurity-core-rule-set mailing list
> > Owasp-modsecurity-core-rule-set at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> 



> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 181 bytes
Desc: Digital signature
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/40f17029/attachment.pgp>

From modsec at spam.lifeforms.nl  Sun Mar  6 20:58:27 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 6 Mar 2016 21:58:27 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <20160306204033.GA5266@elias>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
	<70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>
	<9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>
	<A7DD6614-5D1A-4C45-8130-B4E5B98F8D13@noelzindel.org>
	<20160306204033.GA5266@elias>
Message-ID: <BCEDCCBB-7EA2-49CC-A715-59B4E8F19982@spam.lifeforms.nl>

I?ll check it out on Wednesday!

WH

> On 06 Mar 2016, at 21:40, Christian Folini <christian.folini at netnea.com> wrote:
> 
> Thanks No?l, that looks better. :)
> 
> I'll check it carefully in the next days. Would be pleased if more
> people could give it a spin.
> 
> Ahoj,
> 
> Christian
> 
> 
> 
> 
> On Sun, Mar 06, 2016 at 08:18:45PM +0100, No?l Zindel wrote:
>> Walter, Christian,
>> 
>> thanks for the assistance. I wasn?t quite sure if the 100 commits and 15k lines of changed code in my initial request were just an overall statistic ;)
>> 
>> As it seems, I really only forgot to base my pull request on the 3.0.0-rc1 branch. Unfortunately it?s required to create a new pull request, since there?s no way to adjust the merge target for an existing one.
>> 
>> My PR should be fixed now and we?re good to go: https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300>.
>> 
>> And thanks, Walter, for sharing your workflow.
>> 
>> Cheers,
>> No?l
>> 
>> 
>>> On 06 Mar 2016, at 18:43, Walter Hop <modsec at spam.lifeforms.nl> wrote:
>>> 
>>> Just in case anyone is interested, this is the procedure I normally follow for pull requests:
>>> https://gist.github.com/lifeforms/c8778a05bf0385c7f391 <https://gist.github.com/lifeforms/c8778a05bf0385c7f391>
>>> 
>>> I?ve created a pull request here just to test, though Christian may review and accept it :) I?ll need the file in there so I can easily add to it when working on the PHP rules. We?ll convert them to use Chaim?s tool when it?s ready.
>>> https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299>
>>> 
>>> Cheers!
>>> WH
>>> 
>>> --
>>> Walter Hop | PGP key: https://lifeforms.nl/pgp <https://lifeforms.nl/pgp>
>>> _______________________________________________
>>> Owasp-modsecurity-core-rule-set mailing list
>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> 
> 
> 
> 
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> 

-- 
Walter Hop | PGP key: https://lifeforms.nl/pgp

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/3de589fb/attachment.html>

From modsec at spam.lifeforms.nl  Sun Mar  6 21:48:26 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 6 Mar 2016 22:48:26 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Multiple log
	entries of stricter siblings
In-Reply-To: <20160306182108.GA6761@elias>
References: <CALrdzmJ5pJQdoU2jU7qntKqbMmBP2L9e=4nYOwNLu33ihPmpcw@mail.gmail.com>
	<F9848279-85AC-4A18-A7B1-DD7065568AD0@spam.lifeforms.nl>
	<20160306182108.GA6761@elias>
Message-ID: <09F308B7-A56E-41E8-B2A9-B578ED8BD45B@spam.lifeforms.nl>

Hi Christian,

Some very good points!

I agree with your assessment about the rule complexities. I agree that keeping rules simple is extremely important, especially given our low resources.

> But of course, a real attack will trigger 3 times. And I
> do not mind that. If there is a real attack then I am
> very open for anomaly score to grow at great velocity. And 
> in fact that is the behaviour of the 2.2.X core rules:

This is true, too. This unbalanced distribution of anomaly scores between parts of the CRS is already there since CRS v2. And it?s not that big of a problem.

If you are paranoid, you should probably use 5 as your blocking threshold anyway. In that case, a higher anomaly score has no difference on a blocking decision.

In a way, it might even be useful to an admin to get the multiple rules logged if they run at high paranoia level. They can instantly see all the relevant rule ID?s, there is no magic, and people can simply apply their whitelistings so that they also cover the lower rules.

> When I read Franziska's message, I was ready to agree. But 
> then I thought about it and I came to the conclusion, that 
> alert cumulation is not ideal, but everything else is even 
> worse. 
> 
> Let's keep it simple even if it brings a few more alerts.


Good characterization. Let?s keep it simple, the drawbacks of multiple alerts are likely not worth the added burden of reducing them.

-- 
Walter Hop | PGP key: https://lifeforms.nl/pgp

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160306/04665ed6/attachment-0001.html>

From athmane at fedoraproject.org  Sun Mar  6 21:48:25 2016
From: athmane at fedoraproject.org (Athmane Madjoudj)
Date: Sun, 6 Mar 2016 22:48:25 +0100
Subject: [Owasp-modsecurity-core-rule-set] ARGS against PUT (was Re:
 Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 8)
In-Reply-To: <D301B9B2.23313%bridavis@cisco.com>
References: <D301B9B2.23313%bridavis@cisco.com>
Message-ID: <CAOV0wtPOyr-mmufVUxPBUHo-Kqe_rxoTxq2Hegg7X7tnRTOFLQ@mail.gmail.com>

Hi Brian,

On Sun, Mar 6, 2016 at 4:49 PM, Brian Davis (bridavis)
<bridavis at cisco.com> wrote:
> (For some reason I didn?t get the direct email response.)
>
> After doing some more research, I think it?s relates to the fact that the
> <script> is in a JSON payload, and it turns out I?m not running a recent
> enough version of mod security which supports JSON parsing. CentOS 7.1 is
> only packaging 2.7.3, where as JSON parser comes in 2.8.
>
> I?m working on manually upgrading and trying again to see if that helps.

You may use this repo which is the same package version as Fedora
development branch.

https://copr.fedorainfracloud.org/coprs/athmane/mod_security/


Best regards.

- Athmane

From christian.folini at netnea.com  Mon Mar  7 19:49:37 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Mon, 7 Mar 2016 20:49:37 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <20160306204033.GA5266@elias>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
	<70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>
	<9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>
	<A7DD6614-5D1A-4C45-8130-B4E5B98F8D13@noelzindel.org>
	<20160306204033.GA5266@elias>
Message-ID: <20160307194937.GA29848@elias>

Good evening everybody,

The first runs with No?l's patch look promising. I checked the
rules and they are all there and they work correctly, as far
as I checked.

Here is a screenshot of a diff of the various alerts triggered with
paranoia level 1 and paranoia level 2. http://imgur.com/AZcCijQ (PL 2 in
pull request #2 has 20 additional rules when compared to PL 1)-

And here is a graph of anomaly scores distribution for PL 1 and PL 2. Nice
to see the peak being shifted to higher anomaly score due to additional
alerts.  http://imgur.com/xMkULKe

I am unsure about the best tag for the rules. Right now, they appear
as follows in the error-log:

[2016-03-07 17:50:31.720874] [-:error] 127.0.0.1:38796 Vt2xV38AAQEAABpA0R0AAAAW [client 127.0.0.1] ModSecurity: Warning. Pattern match "(?i:(?:,.*?[)\\\\da-f\\"'`][\\"'`](?:[\\"'`].*?[\\"'`]|\\\\Z|[^\\"'`]+))|(?:\\\\Wselect.+\\\\W*?from)|((?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\\\s*?\\\\(\\\\s*?space\\\\s*?\\\\())" at ARGS:Authorization. [file "/opt/modsecurity-core-rules-3.0rc1-paranoia/REQUEST-42-APPLICATION-ATTACK-SQLI.conf"] [line "593"] [id "942200"] [rev "2"] [msg "Detects MySQL comment-/space-obfuscated injections and backtick termination"] [data "Matched Data: , response=\\x22ae9f86d6beaa3f9ecb9a5b7e072a4138\\x22, nonce= found within ARGS:Authorization: Digest username=\\x22admin\\x22, response=\\x22ae9f86d6beaa3f9ecb9a5b7e072a4138\\x22, nonce=\\x222b089ba7985a883ab2eddcd3539a6c94\\x22, realm=\\x22adminRealm\\x22, uri=\\x22/servlet/admin\\x22"] [severity "CRITICAL"] [ver "OWASP_CRS/3.0.0"] [maturity "9"] [accuracy "8"] [tag "application-multi"] [tag "language-mutli"] [tag "platform-multi"] [tag "attack-sqli"] [tag "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"] [tag "paranoia-level/2"] [hostname "localhost"] [uri "/servlet/admin"] [unique_id "Vt2xV38AAQEAABpA0R0AAAAW"]

The tag is thus: [tag "paranoia-level/2"]

Thoughts?

Best,

Christian

On Sun, Mar 06, 2016 at 09:40:33PM +0100, Christian Folini wrote:
> Thanks No?l, that looks better. :)
> 
> I'll check it carefully in the next days. Would be pleased if more
> people could give it a spin.
> 
> Ahoj,
> 
> Christian
> 
> 
> 
> 
> On Sun, Mar 06, 2016 at 08:18:45PM +0100, No?l Zindel wrote:
> > Walter, Christian,
> > 
> > thanks for the assistance. I wasn?t quite sure if the 100 commits and 15k lines of changed code in my initial request were just an overall statistic ;)
> > 
> > As it seems, I really only forgot to base my pull request on the 3.0.0-rc1 branch. Unfortunately it?s required to create a new pull request, since there?s no way to adjust the merge target for an existing one.
> > 
> > My PR should be fixed now and we?re good to go: https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300>.
> > 
> > And thanks, Walter, for sharing your workflow.
> > 
> > Cheers,
> > No?l
> > 
> > 
> > > On 06 Mar 2016, at 18:43, Walter Hop <modsec at spam.lifeforms.nl> wrote:
> > > 
> > > Just in case anyone is interested, this is the procedure I normally follow for pull requests:
> > > https://gist.github.com/lifeforms/c8778a05bf0385c7f391 <https://gist.github.com/lifeforms/c8778a05bf0385c7f391>
> > > 
> > > I?ve created a pull request here just to test, though Christian may review and accept it :) I?ll need the file in there so I can easily add to it when working on the PHP rules. We?ll convert them to use Chaim?s tool when it?s ready.
> > > https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299 <https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299>
> > > 
> > > Cheers!
> > > WH
> > > 
> > > --
> > > Walter Hop | PGP key: https://lifeforms.nl/pgp <https://lifeforms.nl/pgp>
> > > _______________________________________________
> > > Owasp-modsecurity-core-rule-set mailing list
> > > Owasp-modsecurity-core-rule-set at lists.owasp.org
> > > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> > 
> 
> 
> 
> > _______________________________________________
> > Owasp-modsecurity-core-rule-set mailing list
> > Owasp-modsecurity-core-rule-set at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> 



> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 181 bytes
Desc: Digital signature
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160307/254febe1/attachment.pgp>

From bridavis at cisco.com  Mon Mar  7 22:26:06 2016
From: bridavis at cisco.com (Brian Davis (bridavis))
Date: Mon, 7 Mar 2016 22:26:06 +0000
Subject: [Owasp-modsecurity-core-rule-set] ARGS against PUT
Message-ID: <D3036842.235CE%bridavis@cisco.com>

Thanks, Athmane.

One question, what is mod_security_crs package at 2.2.6 while the Git repo
is at 2.2.9?

Thanks,
Brian

On 3/7/16, 7:00 AM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
owasp-modsecurity-core-rule-set-request at lists.owasp.org"
<owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
owasp-modsecurity-core-rule-set-request at lists.owasp.org> wrote:

>Send Owasp-modsecurity-core-rule-set mailing list submissions to
>	owasp-modsecurity-core-rule-set at lists.owasp.org
>
>To subscribe or unsubscribe via the World Wide Web, visit
>	https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>or, via email, send a message with subject or body 'help' to
>	owasp-modsecurity-core-rule-set-request at lists.owasp.org
>
>You can reach the person managing the list at
>	owasp-modsecurity-core-rule-set-owner at lists.owasp.org
>
>When replying, please edit your Subject line so it is more specific
>than "Re: Contents of Owasp-modsecurity-core-rule-set digest..."
>
>
>Today's Topics:
>
>   1. Re: ARGS against PUT (was Re: Owasp-modsecurity-core-rule-set
>      Digest, Vol 83, Issue 8) (Athmane Madjoudj)
>
>
>----------------------------------------------------------------------
>
>Message: 1
>Date: Sun, 6 Mar 2016 22:48:25 +0100
>From: Athmane Madjoudj <athmane at fedoraproject.org>
>To: "Brian Davis (bridavis)" <bridavis at cisco.com>
>Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org"
>	<owasp-modsecurity-core-rule-set at lists.owasp.org>
>Subject: Re: [Owasp-modsecurity-core-rule-set] ARGS against PUT (was
>	Re: Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 8)
>Message-ID:
>	<CAOV0wtPOyr-mmufVUxPBUHo-Kqe_rxoTxq2Hegg7X7tnRTOFLQ at mail.gmail.com>
>Content-Type: text/plain; charset=UTF-8
>
>Hi Brian,
>
>On Sun, Mar 6, 2016 at 4:49 PM, Brian Davis (bridavis)
><bridavis at cisco.com> wrote:
>> (For some reason I didn?t get the direct email response.)
>>
>> After doing some more research, I think it?s relates to the fact that
>>the
>> <script> is in a JSON payload, and it turns out I?m not running a recent
>> enough version of mod security which supports JSON parsing. CentOS 7.1
>>is
>> only packaging 2.7.3, where as JSON parser comes in 2.8.
>>
>> I?m working on manually upgrading and trying again to see if that helps.
>
>You may use this repo which is the same package version as Fedora
>development branch.
>
>https://copr.fedorainfracloud.org/coprs/athmane/mod_security/
>
>
>Best regards.
>
>- Athmane
>
>
>------------------------------
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
>End of Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 14
>***************************************************************


From CSanders at trustwave.com  Tue Mar  8 05:14:28 2016
From: CSanders at trustwave.com (Chaim Sanders)
Date: Tue, 8 Mar 2016 05:14:28 +0000
Subject: [Owasp-modsecurity-core-rule-set] ARGS against PUT
Message-ID: <D303C944.1B06B%csanders@trustwave.com>

The CRS project has always been in a somewhat continuos development model.
In general this becomes very problematic as the team does not package the
software for different distro?s. If you would like to see CRS updated in
your distro, please do encourage the packager to upgrade. As a rule of
thumb starting with 3.0 (Which is forthcoming) we will try to provide more
solid versioning.

On 3/7/16, 5:26 PM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
Brian Davis (bridavis)"
<owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
bridavis at cisco.com> wrote:

>Thanks, Athmane.
>
>One question, what is mod_security_crs package at 2.2.6 while the Git repo
>is at 2.2.9?
>
>Thanks,
>Brian
>
>On 3/7/16, 7:00 AM,
>"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
>owasp-modsecurity-core-rule-set-request at lists.owasp.org"
><owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
>owasp-modsecurity-core-rule-set-request at lists.owasp.org> wrote:
>
>>Send Owasp-modsecurity-core-rule-set mailing list submissions to
>>      owasp-modsecurity-core-rule-set at lists.owasp.org
>>
>>To subscribe or unsubscribe via the World Wide Web, visit
>>      http://scanmail.trustwave.com/?c=4062&d=44be1sNUaV9vNA9G3yRDc8FWV2nKlV1_
>>N__ov2DZFA&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2
>>fowasp-modsecurity-core-rule-set
>>
>>or, via email, send a message with subject or body 'help' to
>>      owasp-modsecurity-core-rule-set-request at lists.owasp.org
>>
>>You can reach the person managing the list at
>>      owasp-modsecurity-core-rule-set-owner at lists.owasp.org
>>
>>When replying, please edit your Subject line so it is more specific
>>than "Re: Contents of Owasp-modsecurity-core-rule-set digest..."
>>
>>
>>Today's Topics:
>>
>>   1. Re: ARGS against PUT (was Re: Owasp-modsecurity-core-rule-set
>>      Digest, Vol 83, Issue 8) (Athmane Madjoudj)
>>
>>
>>----------------------------------------------------------------------
>>
>>Message: 1
>>Date: Sun, 6 Mar 2016 22:48:25 +0100
>>From: Athmane Madjoudj <athmane at fedoraproject.org>
>>To: "Brian Davis (bridavis)" <bridavis at cisco.com>
>>Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org"
>>      <owasp-modsecurity-core-rule-set at lists.owasp.org>
>>Subject: Re: [Owasp-modsecurity-core-rule-set] ARGS against PUT (was
>>      Re: Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 8)
>>Message-ID:
>>      <CAOV0wtPOyr-mmufVUxPBUHo-Kqe_rxoTxq2Hegg7X7tnRTOFLQ at mail.gmail.com>
>>Content-Type: text/plain; charset=UTF-8
>>
>>Hi Brian,
>>
>>On Sun, Mar 6, 2016 at 4:49 PM, Brian Davis (bridavis)
>><bridavis at cisco.com> wrote:
>>> (For some reason I didn?t get the direct email response.)
>>>
>>> After doing some more research, I think it?s relates to the fact that
>>>the
>>> <script> is in a JSON payload, and it turns out I?m not running a
>>>recent
>>> enough version of mod security which supports JSON parsing. CentOS 7.1
>>>is
>>> only packaging 2.7.3, where as JSON parser comes in 2.8.
>>>
>>> I?m working on manually upgrading and trying again to see if that
>>>helps.
>>
>>You may use this repo which is the same package version as Fedora
>>development branch.
>>
>>http://scanmail.trustwave.com/?c=4062&d=44be1sNUaV9vNA9G3yRDc8FWV2nKlV1_N
>>_2-t2mMGg&s=5&u=https%3a%2f%2fcopr%2efedorainfracloud%2eorg%2fcoprs%2fath
>>mane%2fmod%5fsecurity%2f
>>
>>
>>Best regards.
>>
>>- Athmane
>>
>>
>>------------------------------
>>
>>_______________________________________________
>>Owasp-modsecurity-core-rule-set mailing list
>>Owasp-modsecurity-core-rule-set at lists.owasp.org
>>http://scanmail.trustwave.com/?c=4062&d=44be1sNUaV9vNA9G3yRDc8FWV2nKlV1_N
>>__ov2DZFA&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2f
>>owasp-modsecurity-core-rule-set
>>
>>
>>End of Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 14
>>***************************************************************
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>http://scanmail.trustwave.com/?c=4062&d=44be1sNUaV9vNA9G3yRDc8FWV2nKlV1_N_
>_ov2DZFA&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
>asp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From christian.folini at netnea.com  Tue Mar  8 05:45:16 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Tue, 8 Mar 2016 06:45:16 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
In-Reply-To: <9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>
References: <50A3112E-E562-481C-B43A-D80A0B53634A@noelzindel.org>
	<70538FAC-6707-4EE5-9879-7C08B18B9E0E@spam.lifeforms.nl>
	<9B6E634C-2D9E-4BC1-940A-4C1AE3B47339@spam.lifeforms.nl>
Message-ID: <20160308054516.GA10244@elias>

Walter,

On Sun, Mar 06, 2016 at 06:43:56PM +0100, Walter Hop wrote:
> Just in case anyone is interested, this is the procedure I normally follow for pull requests:
> https://gist.github.com/lifeforms/c8778a05bf0385c7f391

This is perfect and might be of general use for the CRS project.

I have added it to our paranoia mode wiki page at:
https://www.owasp.org/index.php/OWASP_ModSec_CRS_Paranoia_Mode#How_to_Perform_Pull_Request_to_a_Branch_of_Master

> I?ve created a pull request here just to test, though Christian may review and accept it :) I?ll need the file in there so I can easily add to it when working on the PHP rules. We?ll convert them to use Chaim?s tool when it?s ready.
> https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299

Reviewed and merged.

Ahoj,

Christian


-- 
The whole problem with the world is that fools and fanatics are always
so certain of themselves, but wiser people so full of doubts.
-- Bertrand Russel

From CSanders at trustwave.com  Tue Mar  8 06:03:07 2016
From: CSanders at trustwave.com (Chaim Sanders)
Date: Tue, 8 Mar 2016 06:03:07 +0000
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Numbering
 scheme for stricter siblings
In-Reply-To: <19F2150A-A777-4C4D-ABB0-1B4E1F0630DB@noelzindel.org>
References: <CALrdzm+utJm_vqqw3dF_XC+A=e-h5bS97st1k5AhD6CFfZ9gbQ@mail.gmail.com>
	<19F2150A-A777-4C4D-ABB0-1B4E1F0630DB@noelzindel.org>
Message-ID: <D303D52F.1B0B0%csanders@trustwave.com>

I will add it to my todo list to update the rule ID documentation file. I
think this makes lots of sense :)

On 3/6/16, 2:27 PM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of No?l
Zindel" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf
of mail at noelzindel.org> wrote:

>Hi Franziska,
>
>thanks for bringing this up. I absolutely agree with you, and the others.
>
>Since there has been no opposition so far, I will implement the ID
>assignment into our wiki documentation tomorrow.
>If there should come up any argumentation against it, it?s a quick change.
>
>Cheers,
>No?l
>
>> On 06 Mar 2016, at 09:57, Franziska Buehler
>><franziska.buehler.schmocker at gmail.com> wrote:
>>
>> Hello,
>>
>> We already have some stricter siblings for existing rules.
>> But we don?t have a numbering scheme for these new rules yet.
>> My suggestion would be as follows:
>>
>> The RuleIDs in CRS 3.0.0 count up in steps of 10. An obvious
>> possibility is to use the last digit.
>> Subsequent stricter clones of a main rule will be assigned the id of
>> the main rule plus the last digit incremented.
>>
>> For example, we produce a stricter sibling of the rule 920270. The new
>> stricter clone gets the id 920271. If we produce an even stricter
>> sibling, this rule will get the rule id 920272 and so on.
>>
>> We will not produce more than 5 different clones, because we defined
>> the paranoia levels from 0 to 4. So we have enough space.
>>
>> What are your thougts about this proposal?
>>
>> Regards,
>> Franziska
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>
>>http://scanmail.trustwave.com/?c=4062&d=_Inc1hn7VdCEOQEjBDkdbbfAqmS8_XRmR
>>4XmpGaEqA&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2f
>>owasp-modsecurity-core-rule-set
>


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From CSanders at trustwave.com  Tue Mar  8 06:07:17 2016
From: CSanders at trustwave.com (Chaim Sanders)
Date: Tue, 8 Mar 2016 06:07:17 +0000
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders
In-Reply-To: <20160306062856.GA27157@elias>
References: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
	<96635892-7474-4E83-9A55-B0F7C49E6EA1@spam.lifeforms.nl>
	<20160306062856.GA27157@elias>
Message-ID: <D303D618.1B0B3%csanders@trustwave.com>

I?ll update the documentation for CRS 3.0 to outline that this is the
preferred but not required way to do development - that is to say I?ll
make a section on how to use git to add pull requests :)

On 3/6/16, 1:28 AM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
Christian Folini" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
on behalf of christian.folini at netnea.com> wrote:

>Though we can commit now, I propose for now to work in separate branches
>and request a code review from another person before merging to the
>master branch. So ideal workflow: Github issue -> discuss -> pull request
>-> code review -> merge to master.


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From christian.folini at netnea.com  Tue Mar  8 06:08:20 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Tue, 8 Mar 2016 07:08:20 +0100
Subject: [Owasp-modsecurity-core-rule-set] New Community Leaders
In-Reply-To: <D303D618.1B0B3%csanders@trustwave.com>
References: <DM2PR0701MB12950BFBD3A11AF870D9E919DBBA0@DM2PR0701MB1295.namprd07.prod.outlook.com>
	<96635892-7474-4E83-9A55-B0F7C49E6EA1@spam.lifeforms.nl>
	<20160306062856.GA27157@elias>
	<D303D618.1B0B3%csanders@trustwave.com>
Message-ID: <20160308060820.GA11342@elias>

Good plan. Thanks.

On Tue, Mar 08, 2016 at 06:07:17AM +0000, Chaim Sanders wrote:
> I?ll update the documentation for CRS 3.0 to outline that this is the
> preferred but not required way to do development - that is to say I?ll
> make a section on how to use git to add pull requests :)
> 
> On 3/6/16, 1:28 AM,
> "owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
> Christian Folini" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
> on behalf of christian.folini at netnea.com> wrote:
> 
> >Though we can commit now, I propose for now to work in separate branches
> >and request a code review from another person before merging to the
> >master branch. So ideal workflow: Github issue -> discuss -> pull request
> >-> code review -> merge to master.
> 
> 
> ________________________________
> 
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From CSanders at trustwave.com  Tue Mar  8 06:09:17 2016
From: CSanders at trustwave.com (Chaim Sanders)
Date: Tue, 8 Mar 2016 06:09:17 +0000
Subject: [Owasp-modsecurity-core-rule-set] Parsing the log error
In-Reply-To: <CAFk_mWuLMV01E8enFF_wuhe5tLSPDcRbMsE4VZVk7_smFhyX9Q@mail.gmail.com>
References: <CAFk_mWuLMV01E8enFF_wuhe5tLSPDcRbMsE4VZVk7_smFhyX9Q@mail.gmail.com>
Message-ID: <D303D6AE.1B0B6%csanders@trustwave.com>

Hey Avi,
Check out the recent blog post I made on a very similar topic ;)
https://www.trustwave.com/Resources/SpiderLabs-Blog/Sending-ModSecurity-Logs-to-MySQL/?page=1&year=0&month=0

From: <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>> on behalf of Avi Fatal <avi.fatal at gmail.com<mailto:avi.fatal at gmail.com>>
Date: Sunday, March 6, 2016 at 2:48 AM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] Parsing the log error

Hi,
I want to trigger a daily email with aggregated data from modsecurity to sites owners.
So I want to read the log, put in mysql/mongodb and trigger a job to send the report to site owners.

I thought to read the apache log error because it is more structured than audit log.
Do you know any good php parser that can read the log and put it in a decent array?

Thanks

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160308/d38443ff/attachment.html>

From franziska.buehler.schmocker at gmail.com  Tue Mar  8 07:50:43 2016
From: franziska.buehler.schmocker at gmail.com (Franziska Buehler)
Date: Tue, 8 Mar 2016 08:50:43 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Multiple log
 entries of stricter siblings
In-Reply-To: <09F308B7-A56E-41E8-B2A9-B578ED8BD45B@spam.lifeforms.nl>
References: <CALrdzmJ5pJQdoU2jU7qntKqbMmBP2L9e=4nYOwNLu33ihPmpcw@mail.gmail.com>
	<F9848279-85AC-4A18-A7B1-DD7065568AD0@spam.lifeforms.nl>
	<20160306182108.GA6761@elias>
	<09F308B7-A56E-41E8-B2A9-B578ED8BD45B@spam.lifeforms.nl>
Message-ID: <CALrdzmKuiwooynUA269OqO+hQNQ9yCJryNpL2aU3jfZhWypFbg@mail.gmail.com>

When I started reading Christian?s answer I was sure, I will defend my
point of view and we absolutely have to limit the firing sibling rules
to only one per request.
But when I continued reading I have to admit, that Christian has a point.

Confusing people by adding new rules, apparently at random, by
changing the paranoia level, is really not nice. That?s true.

On this point I don?t entirely agree with you, Christian:
?The higher you go. The more alerts you get and the higher the score.
This is what I would expect from a paranoia setting.?
We already have a stricter rule on a higher level. We don?t also need
a higher score, triggered by more matching rules.
I don?t like the fact, that with a higher paranoia level you get a
higher score, caused by these stricter siblings. You also don?t. That
is what you described with: ?So cumulation has an unbalancing effect.?
That could mislead to raise the anomaly threshold at a higher paranoia
level. That?s dangerous.
But I also agree, that if someone chooses a higher paranoia level, he
knows what he does and will instead tune the rules.
And your approach to choose a low paranoia level, then tune and choose
a higher level also makes sense.

With our numbering scheme (incrementing last digit) we always see at a
glance which rules belong together: 9xxxx0, 9xxxx1, 9xxxx2.
That should simplify the log?s readability and If someone is familiar
with these stricter siblings he immediately understands the system and
identifies why a request was blocked.

At the end I agree with both of you. Let?s keep it simple and avoid
unnecessary complexity!

Regards,
Franziska


2016-03-06 22:48 GMT+01:00 Walter Hop <modsec at spam.lifeforms.nl>:
> Hi Christian,
>
> Some very good points!
>
> I agree with your assessment about the rule complexities. I agree that
> keeping rules simple is extremely important, especially given our low
> resources.
>
> But of course, a real attack will trigger 3 times. And I
> do not mind that. If there is a real attack then I am
> very open for anomaly score to grow at great velocity. And
> in fact that is the behaviour of the 2.2.X core rules:
>
>
> This is true, too. This unbalanced distribution of anomaly scores between
> parts of the CRS is already there since CRS v2. And it?s not that big of a
> problem.
>
> If you are paranoid, you should probably use 5 as your blocking threshold
> anyway. In that case, a higher anomaly score has no difference on a blocking
> decision.
>
> In a way, it might even be useful to an admin to get the multiple rules
> logged if they run at high paranoia level. They can instantly see all the
> relevant rule ID?s, there is no magic, and people can simply apply their
> whitelistings so that they also cover the lower rules.
>
> When I read Franziska's message, I was ready to agree. But
> then I thought about it and I came to the conclusion, that
> alert cumulation is not ideal, but everything else is even
> worse.
>
> Let's keep it simple even if it brings a few more alerts.
>
>
> Good characterization. Let?s keep it simple, the drawbacks of multiple
> alerts are likely not worth the added burden of reducing them.
>
> --
> Walter Hop | PGP key: https://lifeforms.nl/pgp
>
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>

From christian.folini at netnea.com  Tue Mar  8 10:03:36 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Tue, 8 Mar 2016 11:03:36 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Level: Multiple log
 entries of stricter siblings
In-Reply-To: <CALrdzmKuiwooynUA269OqO+hQNQ9yCJryNpL2aU3jfZhWypFbg@mail.gmail.com>
References: <CALrdzmJ5pJQdoU2jU7qntKqbMmBP2L9e=4nYOwNLu33ihPmpcw@mail.gmail.com>
	<F9848279-85AC-4A18-A7B1-DD7065568AD0@spam.lifeforms.nl>
	<20160306182108.GA6761@elias>
	<09F308B7-A56E-41E8-B2A9-B578ED8BD45B@spam.lifeforms.nl>
	<CALrdzmKuiwooynUA269OqO+hQNQ9yCJryNpL2aU3jfZhWypFbg@mail.gmail.com>
Message-ID: <20160308100336.GB17574@elias>

Franziska,

Thanks for chiming in.

On Tue, Mar 08, 2016 at 08:50:43AM +0100, Franziska Buehler wrote:
> I don?t like the fact, that with a higher paranoia level you get a
> higher score, caused by these stricter siblings. You also don?t. That
> is what you described with: ?So cumulation has an unbalancing effect.?
> That could mislead to raise the anomaly threshold at a higher paranoia
> level. That?s dangerous.

That is a troubling thought, I admit.

A few weeks back, I wrote down a setting quadrant for anomaly limits
and paranoia level. It went like this:

high anomaly limit / low paranoia: | high anomaly limit / high paranoia
-> untuned system                  | -> you are nuts
-----------------------------------|-----------------------------------
low anomaly limit / low paranoia:  | low anomaly limit / high paranoia
-> tuned system with standard      | -> tuned system with high security
security standard                  | standard

Something like this has to go into the documentation.

> And your approach to choose a low paranoia level, then tune and choose
> a higher level also makes sense.

Yes, I think so. Glad you agree.

> That should simplify the log?s readability and If someone is familiar
> with these stricter siblings he immediately understands the system and
> identifies why a request was blocked.

Exactly. That's what makes your proposal a good one.

> At the end I agree with both of you. Let?s keep it simple and avoid
> unnecessary complexity!

Thanks.

Ahoj,

Christian


-- 
Learn this lesson, that to be self-contented is to be vile and
ignorant, and that to aspire is better than to be blindly and
impotently happy. 
-- Edwin Abbott Abbott

From athmane at fedoraproject.org  Tue Mar  8 21:53:39 2016
From: athmane at fedoraproject.org (Athmane Madjoudj)
Date: Tue, 8 Mar 2016 22:53:39 +0100
Subject: [Owasp-modsecurity-core-rule-set] ARGS against PUT
In-Reply-To: <D303C944.1B06B%csanders@trustwave.com>
References: <D303C944.1B06B%csanders@trustwave.com>
Message-ID: <CAOV0wtN20mG_uaQHykNxsnyZ-gzns9Y-Vu0ZV=EWFmWm0u=atQ@mail.gmail.com>

On Tue, Mar 8, 2016 at 6:14 AM, Chaim Sanders <CSanders at trustwave.com> wrote:
> The CRS project has always been in a somewhat continuos development model.
[... SNIP ...]
>
>>Thanks, Athmane.
>>
>>One question, what is mod_security_crs package at 2.2.6 while the Git repo
>>is at 2.2.9?
>>


@Brian, I've updated Fedora devel branch (official) and the copr repo,
it should have now:

mod_security 2.9.1-0.1.rc1
mod_security_crs 2.2.9.20160219git

@Chain: Could you confirm that CRS git master branch will be always
stable ? if Yes, I could watch the repo for commits and update the
package on regular basis.


Best regards.

- Athmane

From csanders at trustwave.com  Wed Mar  9 00:24:53 2016
From: csanders at trustwave.com (Chaim Sanders)
Date: Tue, 8 Mar 2016 19:24:53 -0500
Subject: [Owasp-modsecurity-core-rule-set] ARGS against PUT
In-Reply-To: <CAOV0wtN20mG_uaQHykNxsnyZ-gzns9Y-Vu0ZV=EWFmWm0u=atQ@mail.gmail.com>
References: <D303C944.1B06B%csanders@trustwave.com>
	<CAOV0wtN20mG_uaQHykNxsnyZ-gzns9Y-Vu0ZV=EWFmWm0u=atQ@mail.gmail.com>
Message-ID: <56DF6D55.6090301@trustwave.com>

Hey Athmane,
Yes, this is the model we are shooting for - same as ModSecurity :). In
general once we get RC1 for v3.0.0 out this is the model we'll stick to :)

On 03/08/2016 04:53 PM, Athmane Madjoudj wrote:
> On Tue, Mar 8, 2016 at 6:14 AM, Chaim Sanders <CSanders at trustwave.com> wrote:
>> The CRS project has always been in a somewhat continuos development model.
> [... SNIP ...]
>>> Thanks, Athmane.
>>>
>>> One question, what is mod_security_crs package at 2.2.6 while the Git repo
>>> is at 2.2.9?
>>>
>
> @Brian, I've updated Fedora devel branch (official) and the copr repo,
> it should have now:
>
> mod_security 2.9.1-0.1.rc1
> mod_security_crs 2.2.9.20160219git
>
> @Chain: Could you confirm that CRS git master branch will be always
> stable ? if Yes, I could watch the repo for commits and update the
> package on regular basis.
>
>
> Best regards.
>
> - Athmane


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From christian.folini at netnea.com  Thu Mar 10 08:31:49 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Thu, 10 Mar 2016 09:31:49 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Mode: Step #2 merged to
	v3.0.0-rc1
Message-ID: <20160310083149.GA14155@elias>

Hi there,

No?l's pull request (github user zinoe) for the 2nd step of the 
Paranoia Mode inclusion has been merged to v3.0.0-rc1.

20 high false positive rules have thus been moved to paranoia
level 2.

You can thus start to try this out and see the difference 
in the number of false positives between paranoia level setting 1 
and 2.

The next step / pull request #3 will bring back old rules from
2.2.X into paranoia level 2.

Cheers,

Christian

-- 
mailto:christian.folini at netnea.com
http://www.christian-folini.ch
twitter: @ChrFolini

From christian.folini at netnea.com  Thu Mar 10 08:37:14 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Thu, 10 Mar 2016 09:37:14 +0100
Subject: [Owasp-modsecurity-core-rule-set] Open Issue: LDAP Injection rules
	- Looking for knowhow
Message-ID: <20160310083714.GA14276@elias>

Hi there,

We have an open issue with weak ldap injection rules:

https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/276

A user reported this and proposed a fairly complex regex to
counter this.

I fear for a high number of false positives and we will have
to test this throughly. I try and get this sort out.

However, it would not hurt to have somebody with real ldap
knowledge to support this (the said user is a bit monosyllabic with
his responses...). So if anybody could help me with this, it
would be very nice.

Ahoj,

Christian



-- 
Reserve your right to think, for even to think wrongly 
is better than not to think at all.
--- Hypatia of Alexandria, around 400 AD

From feldan1 at gmail.com  Sat Mar 12 15:21:34 2016
From: feldan1 at gmail.com (Lorne Wanamaker)
Date: Sat, 12 Mar 2016 10:21:34 -0500
Subject: [Owasp-modsecurity-core-rule-set] Blocking Bad Bots (Semrush,
	Majestic, Slurp)
Message-ID: <CAEBAV9qnHZprbY-7Hyo66+ogiTGKYpSa1tNrJt4cMzrG8un5bQ@mail.gmail.com>

Hi All,

Having some issues with the bots listed above hammering sites on my cpanel
server. Here is a sample:

2016-03-11 18:35:12.670 [INFO] [162.158.35.73:19363] File not found
[/usr/local/apache/htdocs/show/dance-moms]

There are 1000's of these a day simply searching for stuff that does not
exist.

I do have oswap running on this server but I cannot find the way to block
these bots. In the plugin I see you can add blocked agents, but I am not
sure on the format to add to this box or if it is indeed the right place to
add to in order to block these bots.

Thanks for any help!

Regards,
Lorne
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160312/d824c4bd/attachment.html>

From modsec at spam.lifeforms.nl  Sat Mar 12 16:08:38 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sat, 12 Mar 2016 17:08:38 +0100
Subject: [Owasp-modsecurity-core-rule-set] Blocking Bad Bots (Semrush,
	Majestic, Slurp)
In-Reply-To: <CAEBAV9qnHZprbY-7Hyo66+ogiTGKYpSa1tNrJt4cMzrG8un5bQ@mail.gmail.com>
References: <CAEBAV9qnHZprbY-7Hyo66+ogiTGKYpSa1tNrJt4cMzrG8un5bQ@mail.gmail.com>
Message-ID: <C7965925-F564-4DDD-8E1B-D34C25074EBE@spam.lifeforms.nl>

Hi Lorne,

I haven?t used the cPanel interface myself, but if you are able to add to your webserver configuration (httpd.conf), you can add a statement like the following:

SecRule REQUEST_HEADERS:User-Agent "(semrush|majestic|slurp)" \
    "id:123456,phase:1,t:none,t:lowercase,block,tag:BOT,msg:'Bad bot blocked'"

This will block any requests from someone with semrush, majestic or slurp in the User-Agent header. (The rule id must be unique, I?ve used 123456 as an example.)

If you would prefer doing this from cPanel itself, it?s probably best to ask this on the cPanel forums.

Good luck!
WH

> On 12 Mar 2016, at 16:21, Lorne Wanamaker <feldan1 at gmail.com> wrote:
> 
> Hi All,
> 
> Having some issues with the bots listed above hammering sites on my cpanel server. Here is a sample:
> 
> 2016-03-11 18:35:12.670 [INFO] [162.158.35.73:19363 <http://162.158.35.73:19363/>] File not found [/usr/local/apache/htdocs/show/dance-moms]
> 
> There are 1000's of these a day simply searching for stuff that does not exist.
> 
> I do have oswap running on this server but I cannot find the way to block these bots. In the plugin I see you can add blocked agents, but I am not sure on the format to add to this box or if it is indeed the right place to add to in order to block these bots.
> 
> Thanks for any help!
> 
> Regards,
> Lorne
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160312/a7487019/attachment.html>

From franziska.buehler.schmocker at gmail.com  Sat Mar 12 21:16:42 2016
From: franziska.buehler.schmocker at gmail.com (Franziska Buehler)
Date: Sat, 12 Mar 2016 22:16:42 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Mode: Pull Request
	Number 3
Message-ID: <CALrdzmJxLWq2XdZKg=DzBfjoaCvViOQ3Qfk3GcOYerdVHnk3kw@mail.gmail.com>

Hello,

I just made the third pull request: 'Add 2.2.X rules to paranoia mode'
for our little Paranoia Mode project:
https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/308
Can someone please check if everything is fine?

Later I will open an issue on the rule 942460 (2.2.x:960024).
It's an heuristic rule and I moved it from
modsecurity_crs_40_generic_attacks.conf in 2.2.x to
REQUEST-42-APPLICATION-ATTACK-SQLI.conf because of missing generic
file in 3.0.0.
We have to discuss if we want to define a new file
REQUEST-4x-APPLICATION-ATTACK-GENERIC.conf

Regards,
Franziska

From christian.folini at netnea.com  Sun Mar 13 06:19:08 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Sun, 13 Mar 2016 07:19:08 +0100
Subject: [Owasp-modsecurity-core-rule-set] Paranoia Mode: Pull Request
 Number 3
In-Reply-To: <CALrdzmJxLWq2XdZKg=DzBfjoaCvViOQ3Qfk3GcOYerdVHnk3kw@mail.gmail.com>
References: <CALrdzmJxLWq2XdZKg=DzBfjoaCvViOQ3Qfk3GcOYerdVHnk3kw@mail.gmail.com>
Message-ID: <20160313061908.GA29166@elias>

Good morning,

Thank you for the pull.

I am going to look into this today.

On Sat, Mar 12, 2016 at 10:16:42PM +0100, Franziska Buehler wrote:
> We have to discuss if we want to define a new file
> REQUEST-4x-APPLICATION-ATTACK-GENERIC.conf

I support this idea, as we have additional rules that may fall
into this category as well.

@Chaim: Has there been a specific reasoning behind the drop of the
attack-generic file / category, which we are not aware of?

Ahoj,

Christian

-- 
If you shut your door to all errors truth will be shut out.
--- Rabindranath Tagore

From modsec at spam.lifeforms.nl  Sun Mar 13 17:35:57 2016
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 13 Mar 2016 18:35:57 +0100
Subject: [Owasp-modsecurity-core-rule-set] Running PHP rules on all URLs?
Message-ID: <10676B2B-A4B7-4B97-9506-68ACFC838998@spam.lifeforms.nl>

Hi,

I?m busy on testing the PHP rules in CRS 3 in detail. Currently the PHP rules are only activated for some extensions, e.g. .php, so it doesn?t scan ?pretty URLs". I think this is unsafe and we should change this.

I?ve just created the following issue with a fix, but it might be controversial, so I would like your opinions about it. Should we run the PHP checks on other URLs? Please comment on the issue if you can!

https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/310

Thanks!
WH

From Gary.Mansell at ricardo.com  Mon Mar 14 15:12:45 2016
From: Gary.Mansell at ricardo.com (Mansell, Gary)
Date: Mon, 14 Mar 2016 15:12:45 +0000
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity
 rules to prevent logins by specific user accounts?
Message-ID: <DB5PR07MB1480D6DC98C02CC87A9464A082880@DB5PR07MB1480.eurprd07.prod.outlook.com>

Hi,

I have an internal Web application that uses Apache Basic Authentication, checking user account logins against an internal LDAP Server for authentication.

I am now looking to present this Web Application to whitelisted IP's on the Internet, by means of a Reverse Proxy Apache Server in a DMZ with modsecurity enabled and one of the free rulesets to protect the application being abused. Both the Reverse Proxy and the Internal Apache server are configured for https only.

It occurs to me that Administrative users should never be able to login to the Web Application from the via the Reverse Proxy Apache server - I hence wonder if it is possible to use modsecurity on the Reverse Apache server to prevent specific Admin user accounts from logging in to the Web Application?

If so, please can someone point me in the direction of how I might achieve this?

Thanks

Gary



--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are
addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those
of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors
are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and
other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and
any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------

From CSanders at trustwave.com  Mon Mar 14 15:58:08 2016
From: CSanders at trustwave.com (Chaim Sanders)
Date: Mon, 14 Mar 2016 15:58:08 +0000
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use
 modsecurity rules to prevent logins by specific user accounts?
In-Reply-To: <DB5PR07MB1480D6DC98C02CC87A9464A082880@DB5PR07MB1480.eurprd07.prod.outlook.com>
References: <DB5PR07MB1480D6DC98C02CC87A9464A082880@DB5PR07MB1480.eurprd07.prod.outlook.com>
Message-ID: <DM2PR0701MB129566E2071CC1A39C5C45C8DB880@DM2PR0701MB1295.namprd07.prod.outlook.com>

Hey Gary,
This Is actually a great question and should be very easily possible. Typically Basic Authentication uses base64. So you could do something similar to the following (untested)
SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1, t:base64Decode,deny,status:403'

-----Original Message-----
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Mansell, Gary
Sent: Monday, March 14, 2016 11:13 AM
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Hi,

I have an internal Web application that uses Apache Basic Authentication, checking user account logins against an internal LDAP Server for authentication.

I am now looking to present this Web Application to whitelisted IP's on the Internet, by means of a Reverse Proxy Apache Server in a DMZ with modsecurity enabled and one of the free rulesets to protect the application being abused. Both the Reverse Proxy and the Internal Apache server are configured for https only.

It occurs to me that Administrative users should never be able to login to the Web Application from the via the Reverse Proxy Apache server - I hence wonder if it is possible to use modsecurity on the Reverse Apache server to prevent specific Admin user accounts from logging in to the Web Application?

If so, please can someone point me in the direction of how I might achieve this?

Thanks

Gary



--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list Owasp-modsecurity-core-rule-set at lists.owasp.org
http://scanmail.trustwave.com/?c=4062&d=qNrm1jzohWd6Hhew-EByzVy5SyFDlULBnh2eUagXVg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From Gary.Mansell at ricardo.com  Wed Mar 16 09:44:07 2016
From: Gary.Mansell at ricardo.com (Mansell, Gary)
Date: Wed, 16 Mar 2016 09:44:07 +0000
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use
 modsecurity rules to prevent logins by specific user accounts?
In-Reply-To: <DM2PR0701MB129566E2071CC1A39C5C45C8DB880@DM2PR0701MB1295.namprd07.prod.outlook.com>
References: <DB5PR07MB1480D6DC98C02CC87A9464A082880@DB5PR07MB1480.eurprd07.prod.outlook.com>
	<DM2PR0701MB129566E2071CC1A39C5C45C8DB880@DM2PR0701MB1295.namprd07.prod.outlook.com>
Message-ID: <DB5PR07MB1480D7BDEA96607544401DCA828A0@DB5PR07MB1480.eurprd07.prod.outlook.com>

I have had a good crack at trying to get this to work, but to no avail, unfortunately.

SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1,t:base64Decode,deny,status:403"

I tried changing the contains string to various things that may be relevant, but still no joy.

Is it perhaps because both the reverse proxy and the internal apache server are configured for https?

How do I tell whether my system is using base64 to encode the username in the header?

I have to say I am completely lost with this now, it seems like something that modsecurity should be able to do, but I don't know where to start with debugging, or testing this to get it to work?

Any ideas anyone?

Rgds

Gary


-----Original Message-----
From: Chaim Sanders [mailto:CSanders at trustwave.com]
Sent: 14 March 2016 15:58
To: Mansell, Gary <Gary.Mansell at ricardo.com>; owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: RE: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Hey Gary,
This Is actually a great question and should be very easily possible. Typically Basic Authentication uses base64. So you could do something similar to the following (untested) SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1, t:base64Decode,deny,status:403'

-----Original Message-----
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Mansell, Gary
Sent: Monday, March 14, 2016 11:13 AM
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Hi,

I have an internal Web application that uses Apache Basic Authentication, checking user account logins against an internal LDAP Server for authentication.

I am now looking to present this Web Application to whitelisted IP's on the Internet, by means of a Reverse Proxy Apache Server in a DMZ with modsecurity enabled and one of the free rulesets to protect the application being abused. Both the Reverse Proxy and the Internal Apache server are configured for https only.

It occurs to me that Administrative users should never be able to login to the Web Application from the via the Reverse Proxy Apache server - I hence wonder if it is possible to use modsecurity on the Reverse Apache server to prevent specific Admin user accounts from logging in to the Web Application?

If so, please can someone point me in the direction of how I might achieve this?

Thanks

Gary



--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list Owasp-modsecurity-core-rule-set at lists.owasp.org
http://scanmail.trustwave.com/?c=4062&d=qNrm1jzohWd6Hhew-EByzVy5SyFDlULBnh2eUagXVg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are
addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those
of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors
are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and
other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and
any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------

From leonardo.ortiz at marisolsa.com  Thu Mar 17 14:48:13 2016
From: leonardo.ortiz at marisolsa.com (Leonardo Oliveira Ortiz)
Date: Thu, 17 Mar 2016 14:48:13 +0000
Subject: [Owasp-modsecurity-core-rule-set] Mail notification for all rules
Message-ID: <59E8C16E83D82B439E20698AAC790B5F0143EE2939@ma46>

Hello guys.

How can I configure modsecurity to send na e-mail when match some rule?
I want something "global", for all rules.

Thks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160317/e0915ac2/attachment.html>

From ilyassikai at gmail.com  Fri Mar 18 12:21:27 2016
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Fri, 18 Mar 2016 12:21:27 +0000
Subject: [Owasp-modsecurity-core-rule-set]
	Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 23
In-Reply-To: <mailman.21.1458302410.23089.owasp-modsecurity-core-rule-set@lists.owasp.org>
References: <mailman.21.1458302410.23089.owasp-modsecurity-core-rule-set@lists.owasp.org>
Message-ID: <CAMmziWfa6Nky0ui6dRdsD9NvaXdvoNLDpotLTBhmNMSW5_vqBw@mail.gmail.com>

Hi,

*Sending alert emails*

As an example, suppose that we wanted to execute a script to email us an
alert message whenever an attempted SQL injection exploit was detected. To
do this, we need two things:

1. A script file that has the ability to email an alert to a specified
email address.

2. A rule that will invoke the email script when a rule match is detected.

For the script, we will use a standard shell script that invokes /bin/sh,
though we could have easily used Perl or any other scripting language. We
will email the alert to user at example.com.

Create a file named email.sh in the directory /usr/local/bin and type the
following in it:

#!/bin/sh

echo "An SQL injection attempt was blocked" | mail ?s "ModSecurity Alert"
user at example.com

echo Done.

The script invokes the mail binary to send an email with the subject
*ModSecurity
Alert *to user at example.com. The last line of the script writes the
string *Done.
*to stdout. This is so that ModSecurity will recognize that the script has
executed successfully.

We now have to make the script executable so that it can be invoked when a
rule matches:

$ chmod a+rx /usr/local/bin/email.sh

Now all that is left is to create a rule that will trigger the alert script:

SecRule ARGS "drop table" "deny,exec:/usr/local/bin/email.sh"

You can now test out this rule by attempting to access
http://yourserver/?test=drop%20table. If you've substituted your own email
address in the example above you should get an email telling you that an
SQL injection attempt has just been blocked.

Receiving such an email can be useful to quickly be alerted of any ongoing
attacks. However, what if we wanted the email to contain a little more
information on the attempted exploit; would that be possible? Yes, it's not
only possible, it's also a very good idea, since more information about an
alert can allow us to decide whether it is something to investigate more
in-depth (such as when we detect that it's not just an automated
vulnerability scanner pounding away at our server but actually a hacker
probing for weaknesses with manually crafted exploit URLs).

*Sending more detailed alert emails*

ModSecurity allows us to set environment variables via the setenv action.
By populating environment variables with suitable data we can record more
information about the request that was blocked.

Suppose we would like to gather the following data when an attempted SQL
injection is detected:

The hostname of the server where the alert occurred

The remote user's IP address and hostname

The full request URI

The values of all arguments, whether they were sent using the GET or POST
method

The unique ID for the request, so we can find this alert in the log files

We will place this information in six separate environment variables, which
we will call HOSTNAME, REMOTEIP, REMOTEHOST, REQUESTURI, ARGS, and UNIQUEID.
Our modified rule now looks like this:

SecRule ARGS "drop table" "deny,t:lowercase, ? setenv:HOSTNAME=%{SERVER_NAME},
? setenv:REMOTEIP=%{REMOTE_ADDR}, ? setenv:REQUESTURI=%{REQUEST_URI},
? setenv:ARGS=%{ARGS},
? setenv:UNIQUEID={%UNIQUE_ID}, ? exec:/usr/local/bin/email.sh"

Now all we have to do is modify the email script so that it places the
environment variables in the email body:

#!/bin/sh

echo "

An SQL injection attempt was blocked:

Server: $HOSTNAME

Attacking IP: $REMOTEIP

Attacking host: $REMOTEHOST

Request URI: $REQUESTURI

Arguments: $ARGS

Unique ID: $UNIQUEID

Time: `date '+%D %H:%M'`

" | mail ?s 'ModSecurity Alert' user at example.com

Echo Done.

As you can see, we use a multi-line echo statement to get all the
information nicely formatted. Since this is a shell script, it will
replace $HOSTNAME
and the other environment variables with the value we set the variables to
in our ModSecurity rule. The last line of the echo statement also adds a
timestamp with today's date and the current time by invoking the date command
and placing backticks (`) around it, which causes the shell to execute the
command and substitute the command's output for it. Finally, the data is
piped into the mail binary, which sends an email with the subject line
*ModSecurity
Alert *to the specified email address.

Again, at the end of the script we make sure to echo a dummy text to stdout to
make ModSecurity happy. If you test this script you should get a nicely
formatted email with all of the attacker's details.


From: ModSecurity 2.5 Securing your Apache installation and web applications

2016-03-18 12:00 GMT+00:00 <
owasp-modsecurity-core-rule-set-request at lists.owasp.org>:

> Send Owasp-modsecurity-core-rule-set mailing list submissions to
>         owasp-modsecurity-core-rule-set at lists.owasp.org
>
> To subscribe or unsubscribe via the World Wide Web, visit
>
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
> or, via email, send a message with subject or body 'help' to
>         owasp-modsecurity-core-rule-set-request at lists.owasp.org
>
> You can reach the person managing the list at
>         owasp-modsecurity-core-rule-set-owner at lists.owasp.org
>
> When replying, please edit your Subject line so it is more specific
> than "Re: Contents of Owasp-modsecurity-core-rule-set digest..."
>
>
> Today's Topics:
>
>    1. Mail notification for all rules (Leonardo Oliveira Ortiz)
>
>
> ----------------------------------------------------------------------
>
> Message: 1
> Date: Thu, 17 Mar 2016 14:48:13 +0000
> From: Leonardo Oliveira Ortiz <leonardo.ortiz at marisolsa.com>
> To: "Owasp-modsecurity-core-rule-set at lists.owasp.org"
>         <Owasp-modsecurity-core-rule-set at lists.owasp.org>
> Subject: [Owasp-modsecurity-core-rule-set] Mail notification for all
>         rules
> Message-ID: <59E8C16E83D82B439E20698AAC790B5F0143EE2939 at ma46>
> Content-Type: text/plain; charset="us-ascii"
>
> Hello guys.
>
> How can I configure modsecurity to send na e-mail when match some rule?
> I want something "global", for all rules.
>
> Thks.
> -------------- next part --------------
> An HTML attachment was scrubbed...
> URL: <
> http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160317/e0915ac2/attachment-0001.html
> >
>
> ------------------------------
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
> End of Owasp-modsecurity-core-rule-set Digest, Vol 83, Issue 23
> ***************************************************************
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160318/bf5f50f7/attachment.html>

From christian.folini at netnea.com  Mon Mar 28 04:46:49 2016
From: christian.folini at netnea.com (Christian Folini)
Date: Mon, 28 Mar 2016 06:46:49 +0200
Subject: [Owasp-modsecurity-core-rule-set] Rule evaluation framework
Message-ID: <20160328044649.GA8306@elias>

Good morning everyone,

Walter Hop has assembled a big list of ideas worth considering when
assessing a single core rule set rule. The list is one of the results of
many, many conversations around the paranoia mode and around
issues pending on github.

I invite you all to take a look and try and think of additional
considerations worth adding:
https://www.owasp.org/index.php/OWASP_ModSecurity_rule_evaluation_framework

When talking about the merits of a rule in the future, we can go
through this document like a checklist and decide on that base
afterwards. It makes all the decisions more transparent - and more
reliable.

This list is awesome!

Ahoj,

Christian

-- 
mailto:christian.folini at netnea.com
http://www.christian-folini.ch
twitter: @ChrFolini

From Gary.Mansell at ricardo.com  Thu Mar 31 16:30:53 2016
From: Gary.Mansell at ricardo.com (Mansell, Gary)
Date: Thu, 31 Mar 2016 16:30:53 +0000
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use
 modsecurity rules to prevent logins by specific user accounts?
In-Reply-To: <DM2PR0701MB129566E2071CC1A39C5C45C8DB880@DM2PR0701MB1295.namprd07.prod.outlook.com>
References: <DB5PR07MB1480D6DC98C02CC87A9464A082880@DB5PR07MB1480.eurprd07.prod.outlook.com>
	<DM2PR0701MB129566E2071CC1A39C5C45C8DB880@DM2PR0701MB1295.namprd07.prod.outlook.com>
Message-ID: <DB5PR07MB1480BEA498284204D84E855F82990@DB5PR07MB1480.eurprd07.prod.outlook.com>

Is there no one who can help me further on this, as it seems exactly the sort of thing that modsecurity should be able to do (but I am struggling with)?

All of my Web Application admin accounts end in the string "admin", and I would like to be able to use a modsecurity rule on the reverse proxy server in the DMZ to prevent any admin logins (as admins should only ever login directly via the internal apache server rather than the reverse proxy)?

It is my understanding that even though this is a https request, as this application uses basic authentication, every request via the reverse apache server includes a base64 encoded username and password in the authorisation header - I can't understand why I can't block this with a simple modsecurity rule.

The rule suggestion that I was sent by Chaim seems to make sense to me, but I just can't get it to work - it seems to be looking to deny any request with authorization Header containing the string "admin:"

SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1,t:base64Decode,deny,status:403"

Can anyone help me on this - is there just a simple typo in the rule perhaps? Do I have to choose a unique ID value other than 1 (as I had the Owasp core rule set configured too)?

Rgds

Gary




I have had a good crack at trying to get this to work, but to no avail, unfortunately.

SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1,t:base64Decode,deny,status:403"

I tried changing the contains string to various things that may be relevant, but still no joy.

Is it perhaps because both the reverse proxy and the internal apache server are configured for https?

How do I tell whether my system is using base64 to encode the username in the header?

I have to say I am completely lost with this now, it seems like something that modsecurity should be able to do, but I don't know where to start with debugging, or testing this to get it to work?

Any ideas anyone?

Rgds

Gary


-----Original Message-----
From: Chaim Sanders [mailto:CSanders at trustwave.com]
Sent: 14 March 2016 15:58
To: Mansell, Gary <Gary.Mansell at ricardo.com>; owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: RE: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Hey Gary,
This Is actually a great question and should be very easily possible. Typically Basic Authentication uses base64. So you could do something similar to the following (untested) SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1, t:base64Decode,deny,status:403'

-----Original Message-----
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Mansell, Gary
Sent: Monday, March 14, 2016 11:13 AM
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Hi,

I have an internal Web application that uses Apache Basic Authentication, checking user account logins against an internal LDAP Server for authentication.

I am now looking to present this Web Application to whitelisted IP's on the Internet, by means of a Reverse Proxy Apache Server in a DMZ with modsecurity enabled and one of the free rulesets to protect the application being abused. Both the Reverse Proxy and the Internal Apache server are configured for https only.

It occurs to me that Administrative users should never be able to login to the Web Application from the via the Reverse Proxy Apache server - I hence wonder if it is possible to use modsecurity on the Reverse Apache server to prevent specific Admin user accounts from logging in to the Web Application?

If so, please can someone point me in the direction of how I might achieve this?

Thanks

Gary



--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list Owasp-modsecurity-core-rule-set at lists.owasp.org
http://scanmail.trustwave.com/?c=4062&d=qNrm1jzohWd6Hhew-EByzVy5SyFDlULBnh2eUagXVg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are
addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those
of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors
are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and
other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and
any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are
addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those
of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors
are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and
other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and
any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------

From CSanders at trustwave.com  Thu Mar 31 16:33:09 2016
From: CSanders at trustwave.com (Chaim Sanders)
Date: Thu, 31 Mar 2016 16:33:09 +0000
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use
 modsecurity rules to prevent logins by specific user accounts?
In-Reply-To: <DB5PR07MB1480BEA498284204D84E855F82990@DB5PR07MB1480.eurprd07.prod.outlook.com>
References: <DB5PR07MB1480D6DC98C02CC87A9464A082880@DB5PR07MB1480.eurprd07.prod.outlook.com>
	<DM2PR0701MB129566E2071CC1A39C5C45C8DB880@DM2PR0701MB1295.namprd07.prod.outlook.com>
	<DB5PR07MB1480BEA498284204D84E855F82990@DB5PR07MB1480.eurprd07.prod.outlook.com>
Message-ID: <DM2PR0701MB12958A3D09F6CD8DC5D06497DB990@DM2PR0701MB1295.namprd07.prod.outlook.com>

Hey Gary,
While I'm not sure what's going wrong with your rule I suggest you check out the debug log... it will usually contain valuable information to help you debug your issues :). Maybe someone else will be able to spot the issue.

-----Original Message-----
From: Mansell, Gary [mailto:Gary.Mansell at ricardo.com]
Sent: Thursday, March 31, 2016 12:31 PM
To: Chaim Sanders <CSanders at trustwave.com>; owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Is there no one who can help me further on this, as it seems exactly the sort of thing that modsecurity should be able to do (but I am struggling with)?

All of my Web Application admin accounts end in the string "admin", and I would like to be able to use a modsecurity rule on the reverse proxy server in the DMZ to prevent any admin logins (as admins should only ever login directly via the internal apache server rather than the reverse proxy)?

It is my understanding that even though this is a https request, as this application uses basic authentication, every request via the reverse apache server includes a base64 encoded username and password in the authorisation header - I can't understand why I can't block this with a simple modsecurity rule.

The rule suggestion that I was sent by Chaim seems to make sense to me, but I just can't get it to work - it seems to be looking to deny any request with authorization Header containing the string "admin:"

SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1,t:base64Decode,deny,status:403"

Can anyone help me on this - is there just a simple typo in the rule perhaps? Do I have to choose a unique ID value other than 1 (as I had the Owasp core rule set configured too)?

Rgds

Gary




I have had a good crack at trying to get this to work, but to no avail, unfortunately.

SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1,t:base64Decode,deny,status:403"

I tried changing the contains string to various things that may be relevant, but still no joy.

Is it perhaps because both the reverse proxy and the internal apache server are configured for https?

How do I tell whether my system is using base64 to encode the username in the header?

I have to say I am completely lost with this now, it seems like something that modsecurity should be able to do, but I don't know where to start with debugging, or testing this to get it to work?

Any ideas anyone?

Rgds

Gary


-----Original Message-----
From: Chaim Sanders [mailto:CSanders at trustwave.com]
Sent: 14 March 2016 15:58
To: Mansell, Gary <Gary.Mansell at ricardo.com>; owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: RE: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Hey Gary,
This Is actually a great question and should be very easily possible. Typically Basic Authentication uses base64. So you could do something similar to the following (untested) SecRule REQUEST_HEADERS:Authorization "@contains admin:" "id:1, t:base64Decode,deny,status:403'

-----Original Message-----
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org [mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf Of Mansell, Gary
Sent: Monday, March 14, 2016 11:13 AM
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: [Owasp-modsecurity-core-rule-set] Is it possible to use modsecurity rules to prevent logins by specific user accounts?

Hi,

I have an internal Web application that uses Apache Basic Authentication, checking user account logins against an internal LDAP Server for authentication.

I am now looking to present this Web Application to whitelisted IP's on the Internet, by means of a Reverse Proxy Apache Server in a DMZ with modsecurity enabled and one of the free rulesets to protect the application being abused. Both the Reverse Proxy and the Internal Apache server are configured for https only.

It occurs to me that Administrative users should never be able to login to the Web Application from the via the Reverse Proxy Apache server - I hence wonder if it is possible to use modsecurity on the Reverse Apache server to prevent specific Admin user accounts from logging in to the Web Application?

If so, please can someone point me in the direction of how I might achieve this?

Thanks

Gary



--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list Owasp-modsecurity-core-rule-set at lists.owasp.org
http://scanmail.trustwave.com/?c=4062&d=wND91tX1TZq0UB15loWcH4RfFlxJe-IvfXYgFS8s2g&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list Owasp-modsecurity-core-rule-set at lists.owasp.org
http://scanmail.trustwave.com/?c=4062&d=wND91tX1TZq0UB15loWcH4RfFlxJe-IvfXYgFS8s2g&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set

--------------------------------------------------------------------------------------------------------------------------------------------------------------
This e-mail and any files transmitted with it are confidential and intended solely for the use of the individual or entity to whom they are addressed. If you have received this e-mail in error please notify the sender immediately and delete this e-mail from your system.
Please note that any views or opinions presented in this e-mail are solely those of the author and do not necessarily represent those of Ricardo (save for reports and other documentation formally approved and signed for release to the intended recipient). Only Directors are authorised to enter into legally binding obligations on behalf of Ricardo. Ricardo may monitor outgoing and incoming e-mails and other telecommunications systems. By replying to this e-mail you give consent to such monitoring. The recipient should check e-mail and any attachments for the presence of viruses. Ricardo accepts no liability for any damage caused by any virus transmitted by this e-mail.
"Ricardo" means Ricardo plc and its subsidiary companies.
Ricardo plc is a public limited company registered in England with registered number 00222915.
The registered office of Ricardo plc is Shoreham Technical Centre, Shoreham-by Sea, West Sussex, BN43 5FG.
--------------------------------------------------------------------------------------------------------------------------------------------------------------

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

