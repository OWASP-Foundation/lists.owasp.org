<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS Directory Format Question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20Directory%20Format%20Question&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000702.html">
   <LINK REL="Next"  HREF="000710.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS Directory Format Question</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20Directory%20Format%20Question&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] CRS Directory Format Question">RBarnett at trustwave.com
       </A><BR>
    <I>Tue Apr 12 10:57:24 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000702.html">[Owasp-modsecurity-core-rule-set] Trouble with 950901
</A></li>
        <LI>Next message: <A HREF="000710.html">[Owasp-modsecurity-core-rule-set] CRS Directory Format Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#707">[ date ]</a>
              <a href="thread.html#707">[ thread ]</a>
              <a href="subject.html#707">[ subject ]</a>
              <a href="author.html#707">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The current OWASP CRS archive has a number of directories that hold different rules -

 *   base_rules
 *   optional_rules
 *   slr_rules
 *   experimental_rules

I am thinking that most ModSecurity users want to use Apache Include wild-carding when activating rulesets -

&lt;IfModule security2_module&gt;
               Include conf/modsecurity_crs/*.conf
               Include conf/modsecurity_crs/base_rules/*.conf
&lt;/IfModule&gt;

While this is certainly convenient, this does cause a problem.  The various rules files have a numbering scheme whose purpose to to help ensure that the rules file are executed in the proper order when wild-carding with includes.  Activating these rules are challenging when separated into the different directories.

&lt;IfModule security2_module&gt;
               Include conf/modsecurity_crs/*.conf
               Include conf/modsecurity_crs/base_rules/*.conf
               Include conf/modsecurity_crs/optional_rules/*.conf

&lt;/IfModule&gt;

So, what I am thinking is that we should add an empty directory called -

 *   activated_rules

The sole purpose of this directory would be for the local Admin to copy all files that they want to run into that one directory.  When they do this, then the file name numbering scheme will work and it will allow for easier Include wild-carding -

&lt;IfModule security2_module&gt;
               Include conf/modsecurity_crs/*.conf
               Include conf/modsecurity_crs/activated_rules/*.conf
&lt;/IfModule&gt;

How does this approach sound to everyone?

-Ryan

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000702.html">[Owasp-modsecurity-core-rule-set] Trouble with 950901
</A></li>
	<LI>Next message: <A HREF="000710.html">[Owasp-modsecurity-core-rule-set] CRS Directory Format Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#707">[ date ]</a>
              <a href="thread.html#707">[ thread ]</a>
              <a href="subject.html#707">[ subject ]</a>
              <a href="author.html#707">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
