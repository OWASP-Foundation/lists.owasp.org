<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Current use of TAG data in rules and a new idea - CONFIDENCE_LEVEL
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Current%20use%20of%20TAG%20data%20in%0A%20rules%20and%20a%20new%20idea%20-%20CONFIDENCE_LEVEL&In-Reply-To=C9CDCB42.1E966%25rbarnett%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000732.html">
   <LINK REL="Next"  HREF="000743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Current use of TAG data in rules and a new idea - CONFIDENCE_LEVEL</H1>
    <B>yersinia</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Current%20use%20of%20TAG%20data%20in%0A%20rules%20and%20a%20new%20idea%20-%20CONFIDENCE_LEVEL&In-Reply-To=C9CDCB42.1E966%25rbarnett%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Current use of TAG data in rules and a new idea - CONFIDENCE_LEVEL">yersinia.spiros at gmail.com
       </A><BR>
    <I>Fri Apr 15 10:33:03 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000732.html">[Owasp-modsecurity-core-rule-set] Current use of TAG data in rules	and a new idea - CONFIDENCE_LEVEL
</A></li>
        <LI>Next message: <A HREF="000743.html">[Owasp-modsecurity-core-rule-set] Current use of TAG data in rules and a new idea - CONFIDENCE_LEVEL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#733">[ date ]</a>
              <a href="thread.html#733">[ thread ]</a>
              <a href="subject.html#733">[ subject ]</a>
              <a href="author.html#733">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Fri, Apr 15, 2011 at 4:15 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;wrote:

&gt;<i> Hey everyone,
</I>&gt;<i> I wanted give an overview of the current use of TAG data in rules (
</I>&gt;<i> <A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#tag">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#tag</A>),
</I>&gt;<i> as well as, to get some feedback on some new ideas for tag usage.
</I>&gt;<i>
</I>&gt;<i> First let's look at how TAG is currently being used today in the CRS.  Here
</I>&gt;<i> is an example SQL Injection rule -
</I>&gt;<i>
</I>&gt;<i> SecRule REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/* &quot;\bxp_cmdshell\b&quot; \
</I>&gt;<i>
</I>&gt;<i>  &quot;phase:2,rev:'2.2.0',capture,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,t:replaceComments,t:compressWhiteSpace,ctl:auditLogParts=+E,block,msg:'SQL
</I>&gt;<i> Injection
</I>&gt;<i> Attack',id:'959052',tag:'WEB_ATTACK/SQL_INJECTION',tag:'WASCTC/WASC-19',tag:'OWASP_TOP_10/A1',tag:'OWASP_AppSensor/CIE1',tag:'PCI/6.5.2',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{
</I>&gt;<i> rule.id}-WEB_ATTACK/SQL_INJECTION-%{matched_var_name}=%{tx.0}&quot;
</I>&gt;<i>
</I>&gt;<i> The TAG action is used to provide the following information:
</I>&gt;<i>
</I>&gt;<i>  1.  Attack Category &#8211; example WEB_ATTACK/SQL_INJECTION
</I>&gt;<i>  2.  Mapping to community taxonomies &#8211; such as WASC Threat Classification,
</I>&gt;<i> OWASP Top Ten and OWASP AppSensor Detection Points
</I>&gt;<i>  3.  URL links to specific reference resources &#8211; as in this converted ET
</I>&gt;<i> sql injection rule that lists a link to a SecurityFocus vuln entry
</I>&gt;<i>
</I>&gt;<i> # (2007539) SpiderLabs Research (SLR) Public Vulns: ET WEB_SPECIFIC_APPS
</I>&gt;<i> 20/20 Auto Gallery SQL Injection Attempt -- vehiclelistings.asp model UPDATE
</I>&gt;<i> SecRule REQUEST_LINE &quot;@contains /vehiclelistings.asp&quot;
</I>&gt;<i> &quot;chain,phase:2,block,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,nolog,auditlog,logdata:'%{TX.0}',severity:'2',id:2007539,rev:6,msg:'SLR:
</I>&gt;<i> ET WEB_SPECIFIC_APPS 20/20 Auto Gallery SQL Injection Attempt --
</I>&gt;<i> vehiclelistings.asp model UPDATE',tag:'web-application-attack',tag:'url,
</I>&gt;<i> www.securityfocus.com/bid/21154'&quot;
</I>&gt;<i> SecRule &amp;TX:'/WEB_ATTACK/SQL_INJECTION.*ARGS:model/' &quot;@gt 0&quot;
</I>&gt;<i> &quot;ctl:auditLogParts=+E,setvar:'tx.msg=%{tx.msg} - ET WEB_SPECIFIC_APPS 20/20
</I>&gt;<i> Auto Gallery SQL Injection Attempt -- vehiclelistings.asp model
</I>&gt;<i> UPDATE',setvar:tx.anomaly_score=+20,setvar:'tx.%{rule.id
</I>&gt;<i> }-WEB_ATTACK-%{rule.severity}-%{rule.msg}-%{matched_var_name}=%{matched_var}'&quot;
</I>&gt;<i>
</I>&gt;<i> One big idea we have for a new TAG is Confidence Level which would give a
</I>&gt;<i> general indication as to the rules accuracy level perhaps on a scale of 0-5
</I>&gt;<i> where 0 is totally experimental without much testing at all and 5 is a very
</I>&gt;<i> strong signature that has been rigorously tested and a low chance of false
</I>&gt;<i> positives.  Example &#8211; tag:'CONFIDENCE_LEVEL/5'
</I>&gt;<i>
</I>&gt;<i> The Confidence Level tag seems like it has the potential to have a very
</I>&gt;<i> positive impact to users for two reasons:
</I>&gt;<i>
</I>&gt;<i>  1.  Currently, there isn't much distinction for each rules as to its
</I>&gt;<i> accuracy level.  We do have the experimental_rules directory for brand new
</I>&gt;<i> rules however that does not mean that other rules are all of equal accuracy
</I>&gt;<i> levels.
</I>&gt;<i>  2.  With the new v2.6 enhancement which added SecRuleRemoveByTag and
</I>&gt;<i> ctl:ruleRemoveByTag (
</I>&gt;<i> <A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecRuleRemoveByTag">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecRuleRemoveByTag</A>)
</I>&gt;<i> users will then have the ability to make local customizations to disable
</I>&gt;<i> entire groups of rules based on TAG data :)  For instance, if you wanted to
</I>&gt;<i> only run CONFIDENCE_LEVEL/5 rules you could do that in a local custom rules
</I>&gt;<i> file modsecurity_crs_60_custom_rules.conf to disable all lower confidence
</I>&gt;<i> level rules &#8211;
</I>&gt;<i>
</I>&gt;<i> SecRuleRemoveByTag &quot;CONFIDENCE_LEVEL/[0-4]&quot;
</I>&gt;<i>
</I>&gt;<i> While this is a great new capability &#8211; we will need some help from the
</I>&gt;<i> community with identifying the right CONFIDENCE_LEVEL settings for each
</I>&gt;<i> rule.  I will go through each rule and estimate a CONFIDENCE_LEVEL based on
</I>&gt;<i> our intel.  This may not be enough however.  I have a feeling that most
</I>&gt;<i> ModSecurity users silently handle false positives with local exceptions and
</I>&gt;<i> they do not also report back to the community which rule IDs are causing
</I>&gt;<i> problems.  Some users do go the extra mile and actually open Jira tickets
</I>&gt;<i> for the CRS with bug reports.  That is great and it ensures that I will
</I>&gt;<i> review/update the rules.  I do think, however, that most end users would
</I>&gt;<i> prefer an easier method.  What do you all think about us creating a new
</I>&gt;<i> mail-list on SourceForge strictly for sending in false positive rule issues?
</I>&gt;<i>  We could create something like - mod&#8211;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">security-false-positives at lists.sourceforge.net.</A>
</I>&gt;<i>
</I>&gt;<i> What do you think?  If anyone has any better ideas for false positive
</I>&gt;<i> reporting, please speak up.
</I>&gt;<i>
</I>&gt;<i> I think it's a great idea. In effect having a mailing intended only for
</I>the false positives I think it's similar - but in this context with some
difference - to what the GNU project have done  the years for the bug report
:<i> having different mailing for the &quot;bug&quot;  and discussion make it more easy to
</I>obtain the result you want.

What should be standardized is what to send. For example

- Full audit log (and what level of logging) or not, only a significative
part
- what  was done in front of the false positive

disabling the rule
rewriting
with a whitelisting approach

Best Regards



&gt;<i> Ryan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i> This transmission may contain information that is privileged, confidential,
</I>&gt;<i> and/or exempt from disclosure under applicable law. If you are not the
</I>&gt;<i> intended recipient, you are hereby notified that any disclosure, copying,
</I>&gt;<i> distribution, or use of the information contained herein (including any
</I>&gt;<i> reliance thereon) is STRICTLY PROHIBITED. If you received this transmission
</I>&gt;<i> in error, please immediately contact the sender and destroy the material in
</I>&gt;<i> its entirety, whether in electronic or hard copy format.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110415/e0d2a561/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110415/e0d2a561/attachment-0001.html</A> 
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000732.html">[Owasp-modsecurity-core-rule-set] Current use of TAG data in rules	and a new idea - CONFIDENCE_LEVEL
</A></li>
	<LI>Next message: <A HREF="000743.html">[Owasp-modsecurity-core-rule-set] Current use of TAG data in rules and a new idea - CONFIDENCE_LEVEL
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#733">[ date ]</a>
              <a href="thread.html#733">[ thread ]</a>
              <a href="subject.html#733">[ subject ]</a>
              <a href="author.html#733">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
