<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS Directory Format Question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20Directory%20Format%20Question&In-Reply-To=2932C79E-C63A-4DAC-9C99-3ED807B19328%40riggs.me">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000715.html">
   <LINK REL="Next"  HREF="000717.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS Directory Format Question</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20Directory%20Format%20Question&In-Reply-To=2932C79E-C63A-4DAC-9C99-3ED807B19328%40riggs.me"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS Directory Format Question">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Apr 14 09:38:39 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000715.html">[Owasp-modsecurity-core-rule-set] CRS Directory Format Question
</A></li>
        <LI>Next message: <A HREF="000717.html">[Owasp-modsecurity-core-rule-set] CRS Directory Format Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#716">[ date ]</a>
              <a href="thread.html#716">[ thread ]</a>
              <a href="subject.html#716">[ subject ]</a>
              <a href="author.html#716">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Understood and I agree.



On 4/14/11 9:35 AM, &quot;Jim Riggs&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">apache-lists at riggs.me</A>&gt; wrote:

&gt;<i>I agree with Andreas and Klaubert.  If this is the approach we take, the
</I>&gt;<i>documentation should *strongly* recommend symlinks; otherwise, it will
</I>&gt;<i>cause a major maintenance headache for admins, breaking auto-update.  (I
</I>&gt;<i>fear the step of _copying_ the files will often get forgotten or missed.
</I>&gt;<i>Symlinks would address that issue to an extent.)
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>On Apr 14, 2011, at 8:28 AM, pfote wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> I'm using right now that
</I>&gt;&gt;<i>               Include conf/modsecurity_crs/*.conf
</I>&gt;&gt;<i>               Include conf/modsecurity_crs/base_rules/*.conf
</I>&gt;&gt;<i>               Include conf/modsecurity_crs/optional_rules/*.conf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> approach, wasn't aware of that problem (fairly new to modsecurity and
</I>&gt;&gt;<i>owasp) .. thanks for pointing out.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> However, i wouldn't copy but better symlink them, this way it's still
</I>&gt;&gt;<i>possible to have it auto-updated.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> cheers
</I>&gt;&gt;<i> Andreas
</I>&gt;&gt;&gt;<i> Yes, I think this would be helpful.  It might be worth explaining in
</I>&gt;&gt;&gt;<i> the comments why the &quot;proper order&quot; is important, and thus where to
</I>&gt;&gt;&gt;<i> put custom configuration settings and rules for each vhost/server.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Colin
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On 14 April 2011 14:00, Ryan Barnett
</I>&gt;&gt;&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;
</I>&gt;&gt;&gt;<i>  wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Any comments on this approach?  Good idea?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> -Ryan
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> From: Ryan Barnett &lt;
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&gt;
</I>&gt;&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;&gt;<i> Date: Tue, 12 Apr 2011 09:57:24 -0500
</I>&gt;&gt;&gt;&gt;<i> To: &quot;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:owasp-modsecurit
</I>&gt;&gt;&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">y-core-rule-set at lists.owasp.org</A>&gt;&quot;
</I>&gt;&gt;&gt;&gt;<i>&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:owasp-modsecuri
</I>&gt;&gt;&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ty-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;<i> &gt;
</I>&gt;&gt;&gt;&gt;<i> Subject: CRS Directory Format Question
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The current OWASP CRS archive has a number of directories that hold
</I>&gt;&gt;&gt;&gt;<i>different rules -
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  *   base_rules
</I>&gt;&gt;&gt;&gt;<i>  *   optional_rules
</I>&gt;&gt;&gt;&gt;<i>  *   slr_rules
</I>&gt;&gt;&gt;&gt;<i>  *   experimental_rules
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> I am thinking that most ModSecurity users want to use Apache Include
</I>&gt;&gt;&gt;&gt;<i>wild-carding when activating rulesets -
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &lt;IfModule security2_module&gt;
</I>&gt;&gt;&gt;&gt;<i>               Include conf/modsecurity_crs/*.conf
</I>&gt;&gt;&gt;&gt;<i>               Include conf/modsecurity_crs/base_rules/*.conf
</I>&gt;&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> While this is certainly convenient, this does cause a problem.  The
</I>&gt;&gt;&gt;&gt;<i>various rules files have a numbering scheme whose purpose to to help
</I>&gt;&gt;&gt;&gt;<i>ensure that the rules file are executed in the proper order when
</I>&gt;&gt;&gt;&gt;<i>wild-carding with includes.  Activating these rules are challenging
</I>&gt;&gt;&gt;&gt;<i>when separated into the different directories.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &lt;IfModule security2_module&gt;
</I>&gt;&gt;&gt;&gt;<i>               Include conf/modsecurity_crs/*.conf
</I>&gt;&gt;&gt;&gt;<i>               Include conf/modsecurity_crs/base_rules/*.conf
</I>&gt;&gt;&gt;&gt;<i>               Include conf/modsecurity_crs/optional_rules/*.conf
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> So, what I am thinking is that we should add an empty directory
</I>&gt;&gt;&gt;&gt;<i>called -
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>  *   activated_rules
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The sole purpose of this directory would be for the local Admin to
</I>&gt;&gt;&gt;&gt;<i>copy all files that they want to run into that one directory.  When
</I>&gt;&gt;&gt;&gt;<i>they do this, then the file name numbering scheme will work and it
</I>&gt;&gt;&gt;&gt;<i>will allow for easier Include wild-carding -
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> &lt;IfModule security2_module&gt;
</I>&gt;&gt;&gt;&gt;<i>               Include conf/modsecurity_crs/*.conf
</I>&gt;&gt;&gt;&gt;<i>               Include conf/modsecurity_crs/activated_rules/*.conf
</I>&gt;&gt;&gt;&gt;<i> &lt;/IfModule&gt;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> How does this approach sound to everyone?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> -Ryan
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> ________________________________
</I>&gt;&gt;&gt;&gt;<i> This transmission may contain information that is privileged,
</I>&gt;&gt;&gt;&gt;<i>confidential, and/or exempt from disclosure under applicable law. If
</I>&gt;&gt;&gt;&gt;<i>you are not the intended recipient, you are hereby notified that any
</I>&gt;&gt;&gt;&gt;<i>disclosure, copying, distribution, or use of the information contained
</I>&gt;&gt;&gt;&gt;<i>herein (including any reliance thereon) is STRICTLY PROHIBITED. If you
</I>&gt;&gt;&gt;&gt;<i>received this transmission in error, please immediately contact the
</I>&gt;&gt;&gt;&gt;<i>sender and destroy the material in its entirety, whether in electronic
</I>&gt;&gt;&gt;&gt;<i>or hard copy format.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-se">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-se</A>
</I>&gt;&gt;&gt;&gt;<i>t
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000715.html">[Owasp-modsecurity-core-rule-set] CRS Directory Format Question
</A></li>
	<LI>Next message: <A HREF="000717.html">[Owasp-modsecurity-core-rule-set] CRS Directory Format Question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#716">[ date ]</a>
              <a href="thread.html#716">[ thread ]</a>
              <a href="subject.html#716">[ subject ]</a>
              <a href="author.html#716">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
