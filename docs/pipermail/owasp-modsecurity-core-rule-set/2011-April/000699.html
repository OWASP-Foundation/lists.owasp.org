<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] A Recommended Base Configuration	- Audit log configuration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20A%20Recommended%20Base%20Configuration%0A%09-%20Audit%20log%20configuration&In-Reply-To=C9C4D42F.1E06E%25rbarnett%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000697.html">
   <LINK REL="Next"  HREF="000705.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] A Recommended Base Configuration	- Audit log configuration</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20A%20Recommended%20Base%20Configuration%0A%09-%20Audit%20log%20configuration&In-Reply-To=C9C4D42F.1E06E%25rbarnett%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] A Recommended Base Configuration	- Audit log configuration">RBarnett at trustwave.com
       </A><BR>
    <I>Mon Apr 11 09:39:47 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000697.html">[Owasp-modsecurity-core-rule-set] A Recommended Base Configuration	- Debug log configuration
</A></li>
        <LI>Next message: <A HREF="000705.html">[Owasp-modsecurity-core-rule-set] A Recommended Base Configuration	- SecArgumentSeparator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#699">[ date ]</a>
              <a href="thread.html#699">[ thread ]</a>
              <a href="subject.html#699">[ subject ]</a>
              <a href="author.html#699">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Reference Manual:
<A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditEngine&lt;https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecDebugLog">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditEngine&lt;https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecDebugLog</A>&gt;
<A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLogRelevantStatus">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLogRelevantStatus</A>
<A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLogParts">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLogParts</A>
<A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLogType">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLogType</A>
<A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLog">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecAuditLog</A>

Current setting:
# -- Audit log configuration -------------------------------------------------

# Log the transactions that are marked by a rule, as well as those that
# trigger a server error (determined by a 5xx or 4xx, excluding 404,
# level response status codes).
#
SecAuditEngine RelevantOnly
SecAuditLogRelevantStatus &quot;^(?:5|4(?!04))&quot;

# Log everything we know about a transaction.
SecAuditLogParts ABIJDEFHKZ

# Use a single file for logging. This is much easier to look at, but
# assumes that you will use the audit log only ocassionally.
#
SecAuditLogType Serial
SecAuditLog /var/log/modsec_audit.log

# Specify the path for concurrent audit logging.
#SecAuditLogStorageDir /opt/modsecurity/var/audit/

Rationale:
While audit logging everything is ideal from an incident response perspective, for initial deployment setting SecAuditEngine to RelevantOnly is a good idea.  The SecAuitLogRelevantStatus will log all 5xx/4xx level status code responses (except 404s).  The default audit log type is Serial.  If you want to use mlogc to send the audit logs off to a remote location then you will need to update this to use Concurrent.

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000697.html">[Owasp-modsecurity-core-rule-set] A Recommended Base Configuration	- Debug log configuration
</A></li>
	<LI>Next message: <A HREF="000705.html">[Owasp-modsecurity-core-rule-set] A Recommended Base Configuration	- SecArgumentSeparator
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#699">[ date ]</a>
              <a href="thread.html#699">[ thread ]</a>
              <a href="subject.html#699">[ subject ]</a>
              <a href="author.html#699">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
