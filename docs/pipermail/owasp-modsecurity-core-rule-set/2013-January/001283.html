<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BBUGFIX%5D%0A%20%22modsecurity_crs_41_xss_attacks.conf%22%20performance%20optimization%20test%20not%0A%20working&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF0C52AD%40SKYMB1.trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001288.html">
   <LINK REL="Next"  HREF="001284.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BBUGFIX%5D%0A%20%22modsecurity_crs_41_xss_attacks.conf%22%20performance%20optimization%20test%20not%0A%20working&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF0C52AD%40SKYMB1.trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working">RBarnett at trustwave.com
       </A><BR>
    <I>Fri Jan 18 16:47:37 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001288.html">[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
</A></li>
        <LI>Next message: <A HREF="001284.html">[Owasp-modsecurity-core-rule-set] Testing new XSS Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1283">[ date ]</a>
              <a href="thread.html#1283">[ thread ]</a>
              <a href="subject.html#1283">[ subject ]</a>
              <a href="author.html#1283">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It is now fixed in GitHub repo.

I opted to do this instead which simply looks for the existence of that TX
variable using the &amp; char.  If it not present (meaning that the @pm rule
did not find any matches), then it will initiate the skipAfter action -

SecRule &amp;TX:PM_XSS_SCORE &quot;@eq 0&quot;
&quot;phase:2,id:'981018',t:none,pass,skipAfter:END_XSS_CHECK,nolog&quot;


--
Ryan Barnett



On 1/18/13 11:39 AM, &quot;Damien Wyart&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">damien.wyart at gmail.com</A>&gt; wrote:

&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>I am also annoyed by this bug in the CRS and suprised nobody responded
</I>&gt;<i>to the two messages explaining the bug.
</I>&gt;<i>
</I>&gt;<i>Is it plan to integrate this in 2.2.7? Or is there a need for a GitHub
</I>&gt;<i>pull request (even for such a trivial fix)?
</I>&gt;<i>
</I>&gt;<i>If this is not fixed upstream, some users (including me) might need to
</I>&gt;<i>backport this manually, this is really annoying.
</I>&gt;<i>
</I>&gt;<i>Many thanks in advance,
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Damien
</I>&gt;<i>
</I>&gt;&gt;<i> Hi Ryan, are you planning to add this little fix to the 2.2.7? That
</I>&gt;&gt;<i>would really be great!
</I>&gt;<i>
</I>&gt;&gt;<i> Thank you!
</I>&gt;<i>
</I>&gt;&gt;<i> On Friday, November 9, 2012, rm4dillo D wrote:
</I>&gt;&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;&gt;<i> The &quot;base_rules/modsecurity_crs_41_xss_attacks.conf&quot; rules file starts
</I>&gt;&gt;<i>with a smart rule that checks the presence of some keywords (Ex. script
</I>&gt;&gt;<i>javascript...) and depending on the result, it decides to run deeper
</I>&gt;&gt;<i>rules or just skip them. The problem is that the conditional &quot;skip&quot;
</I>&gt;&gt;<i>never works because it tests the &quot;pm_xss_score&quot; variable which is not
</I>&gt;&gt;<i>initialized.
</I>&gt;<i>
</I>&gt;&gt;<i>     SecRule TX:PM_XSS_SCORE &quot;@eq 0&quot;
</I>&gt;&gt;<i>&quot;phase:2,id:'981018',t:none,pass,skipAfter:END_XSS_CHECK,nolog&quot;
</I>&gt;<i>
</I>&gt;&gt;<i> To fix this, I just directive this at the beginning of the file:
</I>&gt;<i>
</I>&gt;&gt;<i>     SecAction
</I>&gt;&gt;<i>&quot;phase:2,rev:'2.2.5',t:none,pass,nolog,setvar:tx.pm_xss_score=0&quot;
</I>&gt;<i>
</I>&gt;&gt;<i> It would be nice to fix this in the next core rule set release.
</I>&gt;&gt;<i> Thank you in advance.
</I>&gt;&gt;<i> Rm4dillo
</I>&gt;<i>
</I>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001288.html">[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
</A></li>
	<LI>Next message: <A HREF="001284.html">[Owasp-modsecurity-core-rule-set] Testing new XSS Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1283">[ date ]</a>
              <a href="thread.html#1283">[ thread ]</a>
              <a href="subject.html#1283">[ subject ]</a>
              <a href="author.html#1283">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
