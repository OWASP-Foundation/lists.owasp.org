<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] 'Multiple URL Encoding Detected',	id:'950109' -- am I confused?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%27Multiple%20URL%20Encoding%20Detected%27%2C%0A%09id%3A%27950109%27%20--%20am%20I%20confused%3F&In-Reply-To=%3CCD0C961B.856A%25mmitchell%40backstopsolutions.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001272.html">
   <LINK REL="Next"  HREF="001274.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] 'Multiple URL Encoding Detected',	id:'950109' -- am I confused?</H1>
    <B>Matt Mitchell</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%27Multiple%20URL%20Encoding%20Detected%27%2C%0A%09id%3A%27950109%27%20--%20am%20I%20confused%3F&In-Reply-To=%3CCD0C961B.856A%25mmitchell%40backstopsolutions.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] 'Multiple URL Encoding Detected',	id:'950109' -- am I confused?">mmitchell at backstopsolutions.com
       </A><BR>
    <I>Fri Jan  4 20:22:21 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001272.html">[Owasp-modsecurity-core-rule-set] [Mod-security-rules] modsecurity_50_outbound_malware.data not being referenced
</A></li>
        <LI>Next message: <A HREF="001274.html">[Owasp-modsecurity-core-rule-set] 'Multiple URL Encoding Detected', id:'950109' -- am I confused?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1273">[ date ]</a>
              <a href="thread.html#1273">[ thread ]</a>
              <a href="subject.html#1273">[ subject ]</a>
              <a href="author.html#1273">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi all,

Thanks in advance for any help you can provide. I'm attempting to configure mod_security and the core rule set to handle traffic for our web application and am getting stuck trying to figure out the intended behavior of rule 950107. The problem I'm running into seems to stem from the fact that a literal % is being URI-encoded inside a query string (done &quot;automagically&quot; by jQuery in my case). As I'm reading rule 950109, it looks like any encoded character will cause it to trigger, which seems like not the intent of the rule (based on the name). I'd expect the rule to fire only in the case where the encoded % (%25) were then followed by two more (or u+4 more) digits, which would result from URI-encoding a string twice. While the encoding of the % as %25 isn't strictly necessary, I don't think it is, in and of itself, necessarily a problem. Here is an example request:

GET /searchController.jsp?searchText=%25name&amp;maxResults=50

So I suppose I have a three-part question:

  1.  What, if anything, am I missing about the intent and implementation of 950109?
  2.  If its behavior is deemed to be &quot;correct&quot;, how would you suggest working around this? I have been trying to be surgical about modifying the core rules, only either whitelisting entire endpoints or by removing selected rules by ID after all had been loaded. I am sure I could re-add a modified version of 950109 that will not trigger on the particular endpoint in question, but is there a better way?
  3.  If its behavior is deemed to be incorrect, how should we (I) change it?

-m
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130104/00cbd3a9/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130104/00cbd3a9/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001272.html">[Owasp-modsecurity-core-rule-set] [Mod-security-rules] modsecurity_50_outbound_malware.data not being referenced
</A></li>
	<LI>Next message: <A HREF="001274.html">[Owasp-modsecurity-core-rule-set] 'Multiple URL Encoding Detected', id:'950109' -- am I confused?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1273">[ date ]</a>
              <a href="thread.html#1273">[ thread ]</a>
              <a href="subject.html#1273">[ subject ]</a>
              <a href="author.html#1273">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
