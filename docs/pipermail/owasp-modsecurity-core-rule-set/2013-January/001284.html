<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Testing new XSS Rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Testing%20new%20XSS%20Rules&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF0C54F0%40SKYMB1.trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001283.html">
   <LINK REL="Next"  HREF="001285.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Testing new XSS Rules</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Testing%20new%20XSS%20Rules&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF0C54F0%40SKYMB1.trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Testing new XSS Rules">RBarnett at trustwave.com
       </A><BR>
    <I>Fri Jan 18 19:05:49 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001283.html">[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
</A></li>
        <LI>Next message: <A HREF="001285.html">[Owasp-modsecurity-core-rule-set] CRS for mod_security v1.9.5?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1284">[ date ]</a>
              <a href="thread.html#1284">[ thread ]</a>
              <a href="subject.html#1284">[ subject ]</a>
              <a href="author.html#1284">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Has anyone tested the new XSS rules we recently added?

<A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_41_xss_attacks.conf">https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_41_xss_attacks.conf</A>


#
# -=[ XSS Filters - Category 1 ]=-
# script tag based XSS vectors, e.g., &lt;script&gt; alert(1)&lt;/script&gt;
#
SecRule ARGS &quot;(?i)(&lt;script[^&gt;]*&gt;[\s\S]*?&lt;\/script[^&gt;]*&gt;|&lt;script[^&gt;]*&gt;[\s\S]*?&lt;\/script[[\s\S]]*[\s\S]|&lt;script[^&gt;]*&gt;[\s\S]*?&lt;\/script[\s]*[\s]|&lt;script[^&gt;]*&gt;[\s\S]*?&lt;\/script|&lt;script[^&gt;]*&gt;[\s\S]*?)&quot; &quot;id:'973336',phase:2,rev:'1',ver:'OWASP_CRS/2.2.7',maturity:'1',accuracy:'8',t:none,t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,log,capture,msg:'XSS Filter - Category 1: Script Tag Vector',tag:'OWASP_CRS/WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;


#
# -=[ XSS Filters - Category 2 ]=-
# XSS vectors making use of event handlers like onerror, onload etc, e.g., &lt;body onload=&quot;alert(1)&quot;&gt;
#
SecRule ARGS &quot;(?i)([\s\&quot;'`;\/0-9\=]+on\w+\s*=)&quot; &quot;id:'973337',phase:2,t:none,rev:'1',ver:'OWASP_CRS/2.2.7',maturity:'1',accuracy:'8',t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,log,capture,msg:'XSS Filter - Category 2: Event Handler Vector',tag:'OWASP_CRS/WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;


#
# -=[ XSS Filters - Category 3 ]=-
# XSS vectors making use of Javascripts URIs, e.g., &lt;p style=&quot;background:url(javascript:alert(1))&quot;&gt;
#
SecRule ARGS &quot;(?i)((?:=|U\s*R\s*L\s*\()\s*[^&gt;]*\s*S\s*C\s*R\s*I\s*P\s*T\s*:|&colon;|[\s\S]allowscriptaccess[\s\S]|[\s\S]src[\s\S]|[\s\S]data:text\/html[\s\S]|[\s\S]xlink:href[\s\S]|[\s\S]base64[\s\S]|[\s\S]xmlns[\s\S]|[\s\S]xhtml[\s\S]|[\s\S]style[\s\S]|&lt;style[^&gt;]*&gt;[\s\S]*?|[\s\S]@import[\s\S]|&lt;applet[^&gt;]*&gt;[\s\S]*?|&lt;meta[^&gt;]*&gt;[\s\S]*?|&lt;object[^&gt;]*&gt;[\s\S]*?)&quot; &quot;id:'973338',phase:2,t:none,rev:'1',ver:'OWASP_CRS/2.2.7',maturity:'1',accuracy:'8',t:urlDecodeUni,t:htmlEntityDecode,t:jsDecode,t:cssDecode,log,capture,tag:'OWASP_CRS/WEB_ATTACK/XSS',tag:'WASCTC/WASC-8',tag:'WASCTC/WASC-22',tag:'OWASP_TOP_10/A2',tag:'OWASP_AppSensor/IE1',tag:'PCI/6.5.1',msg:'XSS Filter - Category 3: Javascript URI Vector',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;


Trying to confirm accuracy and if we have any false positives or not.  Please let me know if you have tried these out and how they are working.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130118/80fff4cc/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130118/80fff4cc/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001283.html">[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
</A></li>
	<LI>Next message: <A HREF="001285.html">[Owasp-modsecurity-core-rule-set] CRS for mod_security v1.9.5?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1284">[ date ]</a>
              <a href="thread.html#1284">[ thread ]</a>
              <a href="subject.html#1284">[ subject ]</a>
              <a href="author.html#1284">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
