<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BBUGFIX%5D%0A%20%22modsecurity_crs_41_xss_attacks.conf%22%20performance%20optimization%20test%20not%0A%20working&In-Reply-To=%3C20130118163931.GA26706%40brouette%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001282.html">
   <LINK REL="Next"  HREF="001283.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working</H1>
    <B>Damien Wyart</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BBUGFIX%5D%0A%20%22modsecurity_crs_41_xss_attacks.conf%22%20performance%20optimization%20test%20not%0A%20working&In-Reply-To=%3C20130118163931.GA26706%40brouette%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working">damien.wyart at gmail.com
       </A><BR>
    <I>Fri Jan 18 16:39:31 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001282.html">[Owasp-modsecurity-core-rule-set] experimental brute_force protection rule
</A></li>
        <LI>Next message: <A HREF="001283.html">[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1288">[ date ]</a>
              <a href="thread.html#1288">[ thread ]</a>
              <a href="subject.html#1288">[ subject ]</a>
              <a href="author.html#1288">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I am also annoyed by this bug in the CRS and suprised nobody responded
to the two messages explaining the bug.

Is it plan to integrate this in 2.2.7? Or is there a need for a GitHub
pull request (even for such a trivial fix)?

If this is not fixed upstream, some users (including me) might need to
backport this manually, this is really annoying.

Many thanks in advance,


Damien

&gt;<i> Hi Ryan, are you planning to add this little fix to the 2.2.7? That would really be great!
</I>
&gt;<i> Thank you!
</I>
&gt;<i> On Friday, November 9, 2012, rm4dillo D wrote:
</I>&gt;<i> Hi,
</I>
&gt;<i> The &quot;base_rules/modsecurity_crs_41_xss_attacks.conf&quot; rules file starts with a smart rule that checks the presence of some keywords (Ex. script javascript...) and depending on the result, it decides to run deeper rules or just skip them. The problem is that the conditional &quot;skip&quot; never works because it tests the &quot;pm_xss_score&quot; variable which is not initialized.
</I>
&gt;<i>     SecRule TX:PM_XSS_SCORE &quot;@eq 0&quot; &quot;phase:2,id:'981018',t:none,pass,skipAfter:END_XSS_CHECK,nolog&quot;
</I>
&gt;<i> To fix this, I just directive this at the beginning of the file:
</I>
&gt;<i>     SecAction &quot;phase:2,rev:'2.2.5',t:none,pass,nolog,setvar:tx.pm_xss_score=0&quot;
</I>
&gt;<i> It would be nice to fix this in the next core rule set release.
</I>&gt;<i> Thank you in advance.
</I>&gt;<i> Rm4dillo
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001282.html">[Owasp-modsecurity-core-rule-set] experimental brute_force protection rule
</A></li>
	<LI>Next message: <A HREF="001283.html">[Owasp-modsecurity-core-rule-set] [BUGFIX] &quot;modsecurity_crs_41_xss_attacks.conf&quot; performance optimization test not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1288">[ date ]</a>
              <a href="thread.html#1288">[ thread ]</a>
              <a href="subject.html#1288">[ subject ]</a>
              <a href="author.html#1288">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
