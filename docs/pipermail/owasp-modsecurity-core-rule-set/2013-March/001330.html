<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] SQL Injection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SQL%20Injection&In-Reply-To=%3CCD5B81EA.6528D%25scanell%40jpl.nasa.gov%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001329.html">
   <LINK REL="Next"  HREF="001331.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] SQL Injection</H1>
    <B>Canell, Stephen E (1734)</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SQL%20Injection&In-Reply-To=%3CCD5B81EA.6528D%25scanell%40jpl.nasa.gov%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] SQL Injection">stephen.e.canell at jpl.nasa.gov
       </A><BR>
    <I>Tue Mar  5 19:10:12 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001329.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
        <LI>Next message: <A HREF="001331.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1330">[ date ]</a>
              <a href="thread.html#1330">[ thread ]</a>
              <a href="subject.html#1330">[ subject ]</a>
              <a href="author.html#1330">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you Chris&#8230;

As I looked further at this I came to the same conclusion on the ARG NAME and the data field though didn't quite get the finding in the data field.
I'll have to go back and look at the previous section for the complete message.

Again,
Thank you
-=Steve
-
From: Christian Bockermann &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&gt;&gt;
Date: Tuesday, March 5, 2013 10:57 AM
To: Stephen Canell &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&gt;&gt;
Cc: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] SQL Injection

Hi Steve!

Am 05.03.2013 um 19:20 schrieb &quot;Canell, Stephen E (1734)&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&gt;&gt;:

The following in ARGS: is being identified as SQL Injection:
TAOP01U10RhvxuuKxxempg01U10monamzy1
Message: Access denied with code 403 (phase 2). Pattern match &quot;(?i:(?:(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)\\s*(x?or|div|like|
between|and)\\s*(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)?\\d)|(?:\\\\x(?:23|27|3d))|(?:^.?(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\
x98)$)|(?:(?:^[(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x ...&quot; at ARGS:TAOP01U10RhvxuuKxxempg01U10monamzy1. [file &quot;/usr/local/apache2/conf
/extra/modsecurity/modsecurity_crs_41_sql_injection_attacks.conf&quot;] [line &quot;565&quot;] [id &quot;981242&quot;] [msg &quot;Detects classic SQL injection pr
obings 1/2&quot;] [data &quot;7 Andr&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]


The &quot;TAOP01U10RhvxuuKxxempg01U10monamzy1&quot; string is NOT detected as SQL injection, but simply
the name of the PARAMETER that contains the malicious data. The data that triggers your rule
is
       &quot;7 Andr&quot;

which you can see in the   [data &quot;7 Andr&quot;]   part of the rule message.

The problem is probably, that the regex of the rule has something like

     ...|div|like|between|and)\\s*...

which says &quot;something with 'and' followed by ANY number of whitespaces&quot;. Unfortunately &quot;ANY&quot;
also includes 0. So &quot;andr&quot; matches &quot;and&quot; followed by 0 whitespaces and the &quot;r&quot; probably matches
some of the rest of the complex regex.

I hope that makes sence :-)

Best regards,
    Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130305/32f8e38b/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130305/32f8e38b/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001329.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
	<LI>Next message: <A HREF="001331.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1330">[ date ]</a>
              <a href="thread.html#1330">[ thread ]</a>
              <a href="subject.html#1330">[ subject ]</a>
              <a href="author.html#1330">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
