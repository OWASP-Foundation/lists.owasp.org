<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] SQL Injection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SQL%20Injection&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF35EE42%40SKYMB1.trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001332.html">
   <LINK REL="Next"  HREF="001334.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] SQL Injection</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SQL%20Injection&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF35EE42%40SKYMB1.trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] SQL Injection">RBarnett at trustwave.com
       </A><BR>
    <I>Tue Mar  5 23:01:16 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001332.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
        <LI>Next message: <A HREF="001334.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1333">[ date ]</a>
              <a href="thread.html#1333">[ thread ]</a>
              <a href="subject.html#1333">[ subject ]</a>
              <a href="author.html#1333">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What version of ModSecurity are you running?  You might not need to upgrade.

What other email thread are you referring to?  This one? &quot;Modsecurity and known bad IP address filter&quot;  If so, I already responded.  Perhaps you missed it.
<A HREF="http://article.gmane.org/gmane.comp.apache.mod-security.user/10051">http://article.gmane.org/gmane.comp.apache.mod-security.user/10051</A>

--
Ryan Barnett


From: &lt;Canell&gt;, &quot;Stephen E (1734)&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&gt;&gt;
Date: Tuesday, March 5, 2013 5:55 PM
To: Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&gt;&gt;, &quot;Canell, Stephen E (1734)&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&gt;&gt;
Cc: Christian Bockermann &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&gt;&gt;, &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] SQL Injection

I presume that to upgrade the CRS will probably require an upgrade to ModSecurity as well&#8230; or at least a good idea :-)

I'll have to plan a project on that one and work against our DEV box in prep to move to production.

Also Ryan, I had sent you  a question on the other group in hope you might have some perils of wisdom to share there.

Thank you
-=Steve

From: Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;&gt;
Date: Tuesday, March 5, 2013 11:25 AM
To: Stephen Canell &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&gt;&gt;
Cc: Christian Bockermann &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&gt;&gt;, Stephen Canell &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&gt;&gt;, &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] SQL Injection

Also it looks like you are running an old CRS version as the newer ones list the version in the alerts and include more data about matches.

Can you upgrade.

--
Ryan Barnett


On Mar 5, 2013, at 2:21 PM, &quot;Canell, Stephen E (1734)&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&gt;&gt; wrote:

Thank you Chris&#8230;

As I looked further at this I came to the same conclusion on the ARG NAME and the data field though didn't quite get the finding in the data field.
I'll have to go back and look at the previous section for the complete message.

Again,
Thank you
-=Steve
-
From: Christian Bockermann &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&gt;&gt;
Date: Tuesday, March 5, 2013 10:57 AM
To: Stephen Canell &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Stephen.E.Canell at jpl.nasa.gov</A>&gt;&gt;
Cc: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] SQL Injection

Hi Steve!

Am 05.03.2013 um 19:20 schrieb &quot;Canell, Stephen E (1734)&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">stephen.e.canell at jpl.nasa.gov</A>&gt;&gt;:

The following in ARGS: is being identified as SQL Injection:
TAOP01U10RhvxuuKxxempg01U10monamzy1
Message: Access denied with code 403 (phase 2). Pattern match &quot;(?i:(?:(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)\\s*(x?or|div|like|
between|and)\\s*(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\x98)?\\d)|(?:\\\\x(?:23|27|3d))|(?:^.?(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x80\
x98)$)|(?:(?:^[(\&quot;|'|`|\xc2\xb4|\xe2\x80\x99|\xe2\x ...&quot; at ARGS:TAOP01U10RhvxuuKxxempg01U10monamzy1. [file &quot;/usr/local/apache2/conf
/extra/modsecurity/modsecurity_crs_41_sql_injection_attacks.conf&quot;] [line &quot;565&quot;] [id &quot;981242&quot;] [msg &quot;Detects classic SQL injection pr
obings 1/2&quot;] [data &quot;7 Andr&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]


The &quot;TAOP01U10RhvxuuKxxempg01U10monamzy1&quot; string is NOT detected as SQL injection, but simply
the name of the PARAMETER that contains the malicious data. The data that triggers your rule
is
       &quot;7 Andr&quot;

which you can see in the   [data &quot;7 Andr&quot;]   part of the rule message.

The problem is probably, that the regex of the rule has something like

     ...|div|like|between|and)\\s*...

which says &quot;something with 'and' followed by ANY number of whitespaces&quot;. Unfortunately &quot;ANY&quot;
also includes 0. So &quot;andr&quot; matches &quot;and&quot; followed by 0 whitespaces and the &quot;r&quot; probably matches
some of the rest of the complex regex.

I hope that makes sence :-)

Best regards,
    Chris
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130305/6db435cf/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130305/6db435cf/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001332.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
	<LI>Next message: <A HREF="001334.html">[Owasp-modsecurity-core-rule-set] SQL Injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1333">[ date ]</a>
              <a href="thread.html#1333">[ thread ]</a>
              <a href="subject.html#1333">[ subject ]</a>
              <a href="author.html#1333">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
