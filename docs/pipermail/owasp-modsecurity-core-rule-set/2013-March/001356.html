<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] not running rules in phase 1	and phase 2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20not%20running%20rules%20in%20phase%201%0A%09and%20phase%202&In-Reply-To=%3CC0368B68439C654081F4C4385327A716031DA1B0%40SOM-EXCH04.nuance.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001354.html">
   <LINK REL="Next"  HREF="001357.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] not running rules in phase 1	and phase 2</H1>
    <B>Volkov, Pavel</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20not%20running%20rules%20in%20phase%201%0A%09and%20phase%202&In-Reply-To=%3CC0368B68439C654081F4C4385327A716031DA1B0%40SOM-EXCH04.nuance.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] not running rules in phase 1	and phase 2">Pavel.Volkov at nuance.com
       </A><BR>
    <I>Wed Mar 20 20:22:34 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001354.html">[Owasp-modsecurity-core-rule-set] Activating XML parsing on	multipart/related
</A></li>
        <LI>Next message: <A HREF="001357.html">[Owasp-modsecurity-core-rule-set] Tired of getting Error on Found	another rule with the same id
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1356">[ date ]</a>
              <a href="thread.html#1356">[ thread ]</a>
              <a href="subject.html#1356">[ subject ]</a>
              <a href="author.html#1356">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

From: Volkov, Pavel [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Pavel.Volkov at nuance.com</A>]
Sent: Wednesday, March 20, 2013 4:20 PM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: not running rules in phase 1 and phase 2

Hi,

I have Basic Authentication setup for Apache. I am trying to configure rules to block user after 3 consecutive unsuccessful login. The problem for me is that rules are not executed in phase1,2 unless authentication succeeds. It looks like request is being handled by Apache before it gets to mod_security. I am using Apache 2.2.3 on CentOS 5.4, mod_security version is 2.6.8. In the debug log I don't see any sign of why phase1 and 2 are skipped.

[20/Mar/2013:10:25:29 --0400] [10.1.82.164/sid#8977c10][rid#89874a8][/escription/mypage.html][4] Initialising transaction (txid -m-PDH8AAAEAAB33iMYAAAAA).
[20/Mar/2013:10:25:29 --0400] [10.1.82.164/sid#8977c10][rid#89874a8][/escription/mypage.html][4] Transaction context created (dcfg 8900888).
[20/Mar/2013:10:25:29 --0400] [10.1.82.164/sid#8977c10][rid#89874a8][/escription/mypage.html][4] Hook insert_error_filter: Adding output filter (r 89874a8).
[20/Mar/2013:10:25:29 --0400] [10.1.82.164/sid#8977c10][rid#89874a8][/escription/mypage.html][9] Output filter: Receiving output (f 8989398, r 89874a8).
[20/Mar/2013:10:25:29 --0400] [10.1.82.164/sid#8977c10][rid#89874a8][/escription/mypage.html][4] Starting phase RESPONSE_HEADERS.
[20/Mar/2013:10:25:29 --0400] [10.1.82.164/sid#8977c10][rid#89874a8][/escription/mypage.html][9] This phase consists of 7 rule(s).

Does anyone have any ideas?

Thanks,
Pavel
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130320/04466131/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130320/04466131/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001354.html">[Owasp-modsecurity-core-rule-set] Activating XML parsing on	multipart/related
</A></li>
	<LI>Next message: <A HREF="001357.html">[Owasp-modsecurity-core-rule-set] Tired of getting Error on Found	another rule with the same id
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1356">[ date ]</a>
              <a href="thread.html#1356">[ thread ]</a>
              <a href="subject.html#1356">[ subject ]</a>
              <a href="author.html#1356">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
