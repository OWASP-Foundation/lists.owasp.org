<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] impact to update modsecurity
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20impact%20to%20update%20modsecurity&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF368802%40SKYMB1.trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001343.html">
   <LINK REL="Next"  HREF="001346.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] impact to update modsecurity</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20impact%20to%20update%20modsecurity&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF368802%40SKYMB1.trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] impact to update modsecurity">RBarnett at trustwave.com
       </A><BR>
    <I>Tue Mar 12 16:13:30 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001343.html">[Owasp-modsecurity-core-rule-set] impact to update modsecurity
</A></li>
        <LI>Next message: <A HREF="001346.html">[Owasp-modsecurity-core-rule-set] impact to update modsecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1344">[ date ]</a>
              <a href="thread.html#1344">[ thread ]</a>
              <a href="subject.html#1344">[ subject ]</a>
              <a href="author.html#1344">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Comments inline below.

________________________________
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] on behalf of Leonardo Bacha Abrantes [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">leonardo at lbasolutions.com</A>]
Sent: Tuesday, March 12, 2013 8:04 AM
To: OWASP Mod Security
Subject: [Owasp-modsecurity-core-rule-set] impact to update modsecurity

Hi guys,
good morning!!

My apache server is working with modsecurity 2.7.0-rc2 and I thinking to update it to crs-2.2.7-13-g40b2c75.

Are you also able to update ModSecurity itself?  Our current stable release is v2.7.2 and we will be releasing v2.7.3 later this month.  I always recommend updating the current versions as we fix bugs and add new important features.

I created a file modsecurity_crs_15_custom_rules.conf with some rules about false positives as:


SecRule REQUEST_URI &quot;^/admin/settings/ckeditor&quot; id:30,phase:1,chain,log,t:none,allow
  SecRule REMOTE_ADDR &quot;@rx ^10\.21\.12\.150&quot; t:none,ctl:ruleEngine=off

&lt;Location &quot;/&quot;&gt;
        SecRuleRemoveById 960017
&lt;/Location&gt;

I would like to know what is the impact if I migrate to the new version of modsecurity, I mean, will the rules below work, etc ?

Updating to newer ModSecurity version should not impact your rules.  One note about doing these types of exceptions:

  1.  For your first rule - I would recommend using the @ipMatch operator as it was created specifiecally to handle IP addresses.  There are many errors that could be made when using @rx to analyze IP addresses.
  2.  For your second rule - you do not need to place this within Apache scope containers (Location).  You can just specify it on its own.  One recommendation however, when you are using these types of &quot;explicit&quot; rule removals (mean that they are not contingent upon run time data) you should move them to run *after* the normal CRS rules in a file called - modsecurity_crs_60_custom_rules.conf.  When using SecRuleRemoveById, the rule it is disabling has to have already been read at startup.  If you define the SecRuleRemoveById *before* the rule it is disabling, it will not work as the rule ID data is not yet in memory.

-&gt;&gt;  second question


SecRule REQUEST_URI &quot;^/admin/settings/ckeditor&quot; id:30,phase:1,chain,log,t:none,allow
  SecRule REMOTE_ADDR &quot;@rx ^10\.21\.12\.150&quot; t:none,ctl:ruleEngine=off

why if I replace ruleEngine=off by SecRuleRemoveById=960017, for example, it will fail ?

The reason is that SecRuleRemoveByID is a directive.  You can not include it within the SecRule action line.  You can use ctl:ruleRemoveById=960017 instead.

-Ryan

many thanks!


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130312/87315898/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130312/87315898/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001343.html">[Owasp-modsecurity-core-rule-set] impact to update modsecurity
</A></li>
	<LI>Next message: <A HREF="001346.html">[Owasp-modsecurity-core-rule-set] impact to update modsecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1344">[ date ]</a>
              <a href="thread.html#1344">[ thread ]</a>
              <a href="subject.html#1344">[ subject ]</a>
              <a href="author.html#1344">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
