<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%0A%09Mechanics%09Proposal&In-Reply-To=%3CE2C9913D99137A42A2A9646B1E82B8DB010D42BE06%40A1GTOEMBXV001.gto.a3c.atos.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001929.html">
   <LINK REL="Next"  HREF="001933.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal</H1>
    <B>Leos Rivas Manuel</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%0A%09Mechanics%09Proposal&In-Reply-To=%3CE2C9913D99137A42A2A9646B1E82B8DB010D42BE06%40A1GTOEMBXV001.gto.a3c.atos.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal">Manuel.LeosRivas at gemalto.com
       </A><BR>
    <I>Tue Feb  9 20:41:13 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001929.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics	Proposal
</A></li>
        <LI>Next message: <A HREF="001933.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1931">[ date ]</a>
              <a href="thread.html#1931">[ thread ]</a>
              <a href="subject.html#1931">[ subject ]</a>
              <a href="author.html#1931">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I agree, keeping that many different levels will be complex to maintain and difficult to understand, the idea of a table to see the difference looks good to me.

Regards,
Manuel

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Walter Hop
Sent: mardi 9 f&#233;vrier 2016 21:06
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Re: [Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal

It&#8217;s a bit of a bikeshed subject, but I think a few levels is better. I think it would be a tricky future if we'd have to say things like: &#8220;hmmm, this rule is too heavy for 10 but too light for 15, let&#8217;s put it at 13&#8221;. How would a novice user ever guess the effects? Most people will pick one number and then troubleshoot.

We are brainstorming a lot about rules and parameters but we don&#8217;t have consensus on definitions first. If we have an integer scale with so many levels it might be very hard to describe what happens at a level. If we have just a few levels, we can provide definitions. What about this:

paranoia level 0: we try blocking definite attacks with small chance of false positives (default)
paranoia level 1: we will be strict about protocol anomalies, this might cause some special clients like loadbalancers and scanners to cause false positives
paranoia level 2: we will start blocking on suspicious heuristics which aren&#8217;t indicative of a certain attack but can be suspicious (e.g. use of MANY special characters; low-value PHP keywords and OS commands)
paranoia level 3: the CRS will apply stricter heuristics (e.g. use of SOME special characters)
paranoia level 4: the CRS will be the most strict

Then, we could easily document and maintain our paranoia decisions.
We could make a table like this, so sysadmins know exactly what is happening:

ruleId

0

1

2

3

4

what would trigger?

920300

allowed

warning

warning

block

block

no Accept header

920350

allowed

warning

warning

block

block

Host is IP4 address

931130

allowed

allowed

block

block

block

/?url=<A HREF="http://example.com">http://example.com</A>

9123456

allowed

allowed

block on 40 chars

block on 10 chars

block on 1 char

/?id=%00blah


This clarity is something you lose if you can go to 40 levels.

Cheers,
WH

On 08 Feb 2016, at 22:12, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt;&gt; wrote:

Thanks Chaim and Lukas!

I got positive feedback via private messages too.

The one question, where I am still unsure (and the
feedback / criticism is also split) is the question
of the good integer range for the paranoia level.
0-4 or rather 0-40.

Still not sure.

Thoughts on this question are thus very welcome.

Ahoj,

Christian


On Mon, Feb 08, 2016 at 02:31:47PM +0000, Chaim Sanders wrote:

Good writeup Christian!

On 2/8/16, 2:59 AM,
&quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt; on behalf of
Funk, Lukas&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt; on
behalf of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Lukas.Funk at united-security-providers.ch</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Lukas.Funk at united-security-providers.ch</A>&gt;&gt; wrote:


Hi Christian and all,

I follow the discussion about the paranoia mode with great interest. I
think it could be a good starting point for ModSecurity users which do
not have the expert knowledge of the rules.

Looking at your proposed structure of the paranoia mode setup, I think
it's on a good track. The structure is easy to understand!
Unfortunately I can't comment the different rules, as I don't have much
experience with them.

Thanks to all of you putting such great effort to the CRS and I'm really
looking forward to version 3!

Cheers, Lukas



Dear all,

With the progress we are making on the rules front, it is time to talk
about
the way it could be implemented.
It's time for the show-me-the-code. He you go:


<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=tN-41hG4qCjBMKf0XEE90boFBx23NXMA">http://scanmail.trustwave.com/?c=4062&amp;d=tN-41hG4qCjBMKf0XEE90boFBx23NXMA</A>
8kit7zcE9Q&amp;s=5&amp;u=https%3a%2f%2fwww%2enetnea%2ecom%2fcms%2f2016%2f02%2f04
%2fowasp-modsecurity-core-rules-
paranoia-mode-mechanics-proposal/

Feedback welcome!

Christian


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

--
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
<A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
twitter: @ChrFolini
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

--
Walter Hop | PGP key: <A HREF="https://lifeforms.nl/pgp">https://lifeforms.nl/pgp</A>

________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160209/158f2b34/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160209/158f2b34/attachment-0001.html</A>&gt;
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001929.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics	Proposal
</A></li>
	<LI>Next message: <A HREF="001933.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1931">[ date ]</a>
              <a href="thread.html#1931">[ thread ]</a>
              <a href="subject.html#1931">[ subject ]</a>
              <a href="author.html#1931">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
