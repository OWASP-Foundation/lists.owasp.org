<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics	Proposal
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Mechanics%0A%09Proposal&In-Reply-To=%3C6C4C307E-6167-42DC-8A7C-E0C2DC464F27%40spam.lifeforms.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001926.html">
   <LINK REL="Next"  HREF="001931.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics	Proposal</H1>
    <B>Walter Hop</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Mechanics%0A%09Proposal&In-Reply-To=%3C6C4C307E-6167-42DC-8A7C-E0C2DC464F27%40spam.lifeforms.nl%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics	Proposal">modsec at spam.lifeforms.nl
       </A><BR>
    <I>Tue Feb  9 20:05:34 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001926.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal
</A></li>
        <LI>Next message: <A HREF="001931.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1929">[ date ]</a>
              <a href="thread.html#1929">[ thread ]</a>
              <a href="subject.html#1929">[ subject ]</a>
              <a href="author.html#1929">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>It&#8217;s a bit of a bikeshed subject, but I think a few levels is better. I think it would be a tricky future if we'd have to say things like: &#8220;hmmm, this rule is too heavy for 10 but too light for 15, let&#8217;s put it at 13&#8221;. How would a novice user ever guess the effects? Most people will pick one number and then troubleshoot.

We are brainstorming a lot about rules and parameters but we don&#8217;t have consensus on definitions first. If we have an integer scale with so many levels it might be very hard to describe what happens at a level. If we have just a few levels, we can provide definitions. What about this:

paranoia level 0: we try blocking definite attacks with small chance of false positives (default)
paranoia level 1: we will be strict about protocol anomalies, this might cause some special clients like loadbalancers and scanners to cause false positives
paranoia level 2: we will start blocking on suspicious heuristics which aren&#8217;t indicative of a certain attack but can be suspicious (e.g. use of MANY special characters; low-value PHP keywords and OS commands)
paranoia level 3: the CRS will apply stricter heuristics (e.g. use of SOME special characters)
paranoia level 4: the CRS will be the most strict

Then, we could easily document and maintain our paranoia decisions.
We could make a table like this, so sysadmins know exactly what is happening:

ruleId
0
1
2
3
4
what would trigger?
920300
allowed
warning
warning
block
block
no Accept header
920350
allowed
warning
warning
block
block
Host is IP4 address
931130
allowed
allowed
block
block
block
/?url=<A HREF="http://example.com">http://example.com</A>
9123456
allowed
allowed
block on 40 chars
block on 10 chars
block on 1 char
/?id=%00blah

This clarity is something you lose if you can go to 40 levels.

Cheers,
WH

&gt;<i> On 08 Feb 2016, at 22:12, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Thanks Chaim and Lukas!
</I>&gt;<i> 
</I>&gt;<i> I got positive feedback via private messages too.
</I>&gt;<i> 
</I>&gt;<i> The one question, where I am still unsure (and the
</I>&gt;<i> feedback / criticism is also split) is the question
</I>&gt;<i> of the good integer range for the paranoia level.
</I>&gt;<i> 0-4 or rather 0-40.
</I>&gt;<i> 
</I>&gt;<i> Still not sure.
</I>&gt;<i> 
</I>&gt;<i> Thoughts on this question are thus very welcome.
</I>&gt;<i> 
</I>&gt;<i> Ahoj,
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Mon, Feb 08, 2016 at 02:31:47PM +0000, Chaim Sanders wrote:
</I>&gt;&gt;<i> Good writeup Christian!
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On 2/8/16, 2:59 AM,
</I>&gt;&gt;<i> &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on behalf of
</I>&gt;&gt;<i> Funk, Lukas&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on
</I>&gt;&gt;<i> behalf of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Lukas.Funk at united-security-providers.ch</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Hi Christian and all,
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> I follow the discussion about the paranoia mode with great interest. I
</I>&gt;&gt;&gt;<i> think it could be a good starting point for ModSecurity users which do
</I>&gt;&gt;&gt;<i> not have the expert knowledge of the rules.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Looking at your proposed structure of the paranoia mode setup, I think
</I>&gt;&gt;&gt;<i> it's on a good track. The structure is easy to understand!
</I>&gt;&gt;&gt;<i> Unfortunately I can't comment the different rules, as I don't have much
</I>&gt;&gt;&gt;<i> experience with them.
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Thanks to all of you putting such great effort to the CRS and I'm really
</I>&gt;&gt;&gt;<i> looking forward to version 3!
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> Cheers, Lukas
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> Dear all,
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> With the progress we are making on the rules front, it is time to talk
</I>&gt;&gt;&gt;&gt;&gt;<i> about
</I>&gt;&gt;&gt;&gt;&gt;<i> the way it could be implemented.
</I>&gt;&gt;&gt;&gt;&gt;<i> It's time for the show-me-the-code. He you go:
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=tN-41hG4qCjBMKf0XEE90boFBx23NXMA">http://scanmail.trustwave.com/?c=4062&amp;d=tN-41hG4qCjBMKf0XEE90boFBx23NXMA</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> 8kit7zcE9Q&amp;s=5&amp;u=https%3a%2f%2fwww%2enetnea%2ecom%2fcms%2f2016%2f02%2f04
</I>&gt;&gt;&gt;&gt;&gt;<i> %2fowasp-modsecurity-core-rules-
</I>&gt;&gt;&gt;&gt;&gt;<i> paranoia-mode-mechanics-proposal/
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> Feedback welcome!
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> Christian
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> ________________________________
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> <A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
</I>&gt;<i> twitter: @ChrFolini
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
-- 
Walter Hop | PGP key: <A HREF="https://lifeforms.nl/pgp">https://lifeforms.nl/pgp</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160209/c6cab53a/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160209/c6cab53a/attachment-0001.html</A>&gt;
</PRE>



































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001926.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal
</A></li>
	<LI>Next message: <A HREF="001931.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1929">[ date ]</a>
              <a href="thread.html#1929">[ thread ]</a>
              <a href="subject.html#1929">[ subject ]</a>
              <a href="author.html#1929">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
