<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20950907%20/%20932100%20%28System%20command%20injection%29&In-Reply-To=%3C1454420603.2320941.509590058.2A72CBFA%40webmail.messagingengine.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001886.html">
   <LINK REL="Next"  HREF="001927.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)</H1>
    <B>Morris Taylor</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20950907%20/%20932100%20%28System%20command%20injection%29&In-Reply-To=%3C1454420603.2320941.509590058.2A72CBFA%40webmail.messagingengine.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)">morris at eml.cc
       </A><BR>
    <I>Tue Feb  2 13:43:23 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001886.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
</A></li>
        <LI>Next message: <A HREF="001927.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1892">[ date ]</a>
              <a href="thread.html#1892">[ thread ]</a>
              <a href="subject.html#1892">[ subject ]</a>
              <a href="author.html#1892">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Christian,

    Dividing the pm file into several parts for eliminating false
    positive sounds good for me. Should there be another rule id for
    carrying the pm file for being associated with the paranoia mode
    one? Thanks!

-- 
BR, Morris

On Tue, Feb 2, 2016, at 04:17 PM, Christian Folini wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I'd like to discuss them here one by one.
</I>&gt;<i> 
</I>&gt;<i> Controversial Paranoia Mode Candidate 950907 (2.2.X) / 932100 (3.0.0rc1)
</I>&gt;<i> msg: Sytem Command Injection
</I>&gt;<i> 
</I>&gt;<i> Rule in 2.2.9:
</I>&gt;<i> SecRule
</I>&gt;<i> REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
</I>&gt;<i> &quot;(?i:(?:[\;\|\`]\W*?\bcc|\b(wget|curl))\b|\/cc(?:[\'\&quot;\|\;\`\-\s]|$))&quot; \
</I>&gt;<i> 		&quot;phase:2,rev:'2',ver:'OWASP_CRS/2.2.9',maturity:'9',accuracy:'8',capture,t:none,t:normalisePath,ctl:auditLogParts=+E,block,msg:'System Command Injection',id:'950907',tag:'OWASP_CRS/WEB_ATTACK/COMMAND_INJECTION',tag:'WASCTC/WASC-31',tag:'OWASP_TOP_10/A1',tag:'PCI/6.5.2',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%{tx.0},skipAfter:END_COMMAND_INJECTION1&quot;
</I>&gt;<i> 
</I>&gt;<i> Rule in 3.0.0rc1:
</I>&gt;<i> SecRule
</I>&gt;<i> REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/*
</I>&gt;<i> &quot;@pmf os-commands.data&quot; \
</I>&gt;<i> 	&quot;msg:'Remote Command Execution (RCE) Attempt',\
</I>&gt;<i> 	phase:request,\
</I>&gt;<i> 	rev:'2',\
</I>&gt;<i> 	ver:'OWASP_CRS/3.0.0',\
</I>&gt;<i> 	maturity:'9',\
</I>&gt;<i> 	accuracy:'8',\
</I>&gt;<i> 	capture,\
</I>&gt;<i> 	t:none,t:normalisePath,\
</I>&gt;<i> 	ctl:auditLogParts=+E,\
</I>&gt;<i> 	block,\
</I>&gt;<i> 	id:'932100',\
</I>&gt;<i> 	tag:'application-multi',\
</I>&gt;<i> 	tag:'language-multi',\
</I>&gt;<i> 	tag:'platform-multi',\
</I>&gt;<i> 	tag:'attack-remote code execution',\
</I>&gt;<i> 	tag:'OWASP_CRS/WEB_ATTACK/COMMAND_INJECTION',\
</I>&gt;<i> 	tag:'WASCTC/WASC-31',\
</I>&gt;<i> 	tag:'OWASP_TOP_10/A1',\
</I>&gt;<i> 	tag:'PCI/6.5.2',\
</I>&gt;<i> 	logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
</I>&gt;<i> 	severity:'CRITICAL',\
</I>&gt;<i> 	chain&quot;
</I>&gt;<i> 		SecRule MATCHED_VARS &quot;@rx [`;\|&amp;\r\n].*?(\.exe)?(\s+[-/])?.+[&amp;&lt;&gt;\|]*?&quot; \
</I>&gt;<i> 			&quot;capture,\
</I>&gt;<i> 			setvar:'tx.msg=%{rule.msg}',\
</I>&gt;<i>         		setvar:tx.rce_score=+%{tx.critical_anomaly_score},\
</I>&gt;<i> 			setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},\
</I>&gt;<i>         		setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/RCE-%{matched_var_name}=%{tx.0}&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> This rule is controversial for different reasons than the one in the
</I>&gt;<i> previous post.
</I>&gt;<i> 
</I>&gt;<i> It was a simple regex in 2.2.X. For 3.0.0 it has been enriched with a
</I>&gt;<i> data file:
</I>&gt;<i> <A HREF="https://raw.githubusercontent.com/SpiderLabs/owasp-modsecurity-crs/v3.0.0-rc1/rules/os-commands.data">https://raw.githubusercontent.com/SpiderLabs/owasp-modsecurity-crs/v3.0.0-rc1/rules/os-commands.data</A>
</I>&gt;<i> 
</I>&gt;<i> In a response to my blogpost 
</I>&gt;<i> <A HREF="https://www.netnea.com/cms/2015/12/20/modsec-crs-2-2-x-vs-3-0-0-dev/">https://www.netnea.com/cms/2015/12/20/modsec-crs-2-2-x-vs-3-0-0-dev/</A>
</I>&gt;<i> Chaim conceded the 3.0.0 version is still plagued by a lot of false
</I>&gt;<i> positives. Obviously so, if you look at the commands. After all, unix
</I>&gt;<i> commands are close to natural English for a good reason.
</I>&gt;<i> 
</I>&gt;<i> Now Franziska (collaborating on the paranoia mode) and I wonder if 
</I>&gt;<i> it would not make sense to split
</I>&gt;<i> os-commands.data into two or more files. The commands with few
</I>&gt;<i> false positives would remain in the standard file, commands generating
</I>&gt;<i> lots of false positives could then be moved into
</I>&gt;<i> os-commands-paranoia.data and be referenced in a separate rule
</I>&gt;<i> copying the behaviour of the standard rule.
</I>&gt;<i> 
</I>&gt;<i> Thoughts?
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> <A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
</I>&gt;<i> twitter: @ChrFolini
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>




























<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001886.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
</A></li>
	<LI>Next message: <A HREF="001927.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1892">[ date ]</a>
              <a href="thread.html#1892">[ thread ]</a>
              <a href="subject.html#1892">[ subject ]</a>
              <a href="author.html#1892">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
