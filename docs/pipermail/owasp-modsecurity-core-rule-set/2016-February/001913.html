<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 960015 / 920300 and 960017 / 920350 (Header issues)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20960015%20/%20920300%20and%20960017%20/%20920350%20%28Header%20issues%29&In-Reply-To=%3C20160207215355.GB1148%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001912.html">
   <LINK REL="Next"  HREF="001914.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 960015 / 920300 and 960017 / 920350 (Header issues)</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20960015%20/%20920300%20and%20960017%20/%20920350%20%28Header%20issues%29&In-Reply-To=%3C20160207215355.GB1148%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 960015 / 920300 and 960017 / 920350 (Header issues)">christian.folini at netnea.com
       </A><BR>
    <I>Sun Feb  7 21:53:55 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001912.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 960015 / 920300 and 960017 / 920350 (Header issues)
</A></li>
        <LI>Next message: <A HREF="001914.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 960015 / 920300 and 960017 / 920350 (Header issues)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1913">[ date ]</a>
              <a href="thread.html#1913">[ thread ]</a>
              <a href="subject.html#1913">[ subject ]</a>
              <a href="author.html#1913">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Barry,

Thanks for chiming in. The more people, the better decisions we will
make.

On Sun, Feb 07, 2016 at 09:40:20PM +0000, Barry Pollard wrote:
&gt;<i> In my opinion there are few real world examples of people intentionally using IP address over hostname and the website owner should know them all (e.g. Load balancers, health checkers and internal system scanners). It's easy to whitelist those specific systems.
</I>
This is going to be anecdotal evidence, but I think it is not
uncommon to have
- 2 LBs (polling every 5 seconds each)
- service monitor (polling once a minute)
- 2 sysadmins configuring some kine of online
  uptime monitor privately in order to get an
  alarm ahead of time via text if something is
  amiss. (polling every then seconds)

And all via the IP address. If you have two redundant
servers, you easily get 60-70 alerts per minute.

But maybe the setups I know are just crazy.
In the end, I can live with this rule in standard mode
or in paranoia mode.

And it's not like it's hard to tune. It's just
terrifying when it happens for the first time.

Cheers,

Christian









&gt;<i> 
</I>&gt;<i> So anything else using IP address is likely a bot iterating through IP addresses and I do think they represent a threat and not just an annoyance and so the CRS should block by default.
</I>&gt;<i> 
</I>&gt;<i> I also found it eye opening the amount of scanners hitting my sites when I turned ModSecurity on for the first time. Now granted most has likely been scanning my site for years with no issues, and they can cause people to panic when they see the sheer volume for first time, but I still think enlightening none the less.
</I>&gt;<i> 
</I>&gt;<i> So I'd be more in favour of leaving this in normal mode. Perhaps adding some commented out examples of how to whitelist certain IP addresses from this (or all?) rule(s) if it really is that common a problem that people get overwhelmed by their internal systems using IP address.
</I>&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> Barry
</I>&gt;<i> 
</I>&gt;<i> P.S. Some great discussions going on. Great to see!
</I>&gt;<i> 
</I>&gt;<i> &gt; On 7 Feb 2016, at 20:32, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Hello again,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;&gt; On Sun, Feb 07, 2016 at 03:22:03PM +0100, Walter Hop wrote:
</I>&gt;<i> &gt;&gt; In my logs I only see mass scanners trying this, and there is one vendor appliance which is doing &#8220;compliance&#8221; checks on an IP address constantly. This appliance annoys me: you don&#8217;t even know my HOSTNAME and you make claims about my site actually being working and compliant? And people pay money for that? I like blocking that thing out of spite, but that&#8217;s just personal.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; It's totally true that it's an annoying practice and 
</I>&gt;<i> &gt; should be stopped. But if you look at it with the
</I>&gt;<i> &gt; eyes of a newbie ModSec user, he will see a lot of
</I>&gt;<i> &gt; FPs in this class, which block the view on the more
</I>&gt;<i> &gt; severed alerts. Not necessarily by score, but by sheer
</I>&gt;<i> &gt; number of alerts.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Moving it to paranoia mode would free the view on the
</I>&gt;<i> &gt; more important exceptions.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;&gt; Anyway, you&#8217;ve given some good cases for allowing IP addresses, it&#8217;s not too controversial.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thanks.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt;&gt; On Sun, Feb 07, 2016 at 03:30:39PM +0000, Chaim Sanders wrote:
</I>&gt;<i> &gt;&gt; It's kind of a mixed bag because we still want ModSecurity to be effective at blocking the easy rift raft (opportunistic attackers) but we want it to be easy to configure. Perhaps we make a 'domain name' configuration in the setup.conf and if it has been configured the rule comes into effect. I don't know that IF they have a domain we see too many false positives, most are things that as walter described, are just laziness. Thoughts?
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Why don't we simply move it to paranoia mode? Instead of having to
</I>&gt;<i> &gt; understand the additional &quot;domain name&quot; config, a user simply raises the
</I>&gt;<i> &gt; paranoia level and ends up with more positives and if he thinks
</I>&gt;<i> &gt; some of these requests are leggit/FPs, he will whitelist them.
</I>&gt;<i> &gt; That would have the same effect as the &quot;domain name&quot; configuration
</I>&gt;<i> &gt; but with a more generic tuning process.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Ahoj,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Christian
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; -- 
</I>&gt;<i> &gt; It must be obvious... that there is a contradiction in wanting to
</I>&gt;<i> &gt; be perfectly secure in a universe whose very nature is momentariness and
</I>&gt;<i> &gt; fluidity.       
</I>&gt;<i> &gt; -- Alan Watts
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001912.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 960015 / 920300 and 960017 / 920350 (Header issues)
</A></li>
	<LI>Next message: <A HREF="001914.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 960015 / 920300 and 960017 / 920350 (Header issues)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1913">[ date ]</a>
              <a href="thread.html#1913">[ thread ]</a>
              <a href="subject.html#1913">[ subject ]</a>
              <a href="author.html#1913">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
