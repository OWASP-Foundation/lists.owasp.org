<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950120 / 931130 (Possible RFI)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20950120%20/%20931130%20%28Possible%20RFI%29&In-Reply-To=%3C20160204090826.GA27990%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001891.html">
   <LINK REL="Next"  HREF="001897.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950120 / 931130 (Possible RFI)</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20950120%20/%20931130%20%28Possible%20RFI%29&In-Reply-To=%3C20160204090826.GA27990%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950120 / 931130 (Possible RFI)">christian.folini at netnea.com
       </A><BR>
    <I>Thu Feb  4 09:08:26 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001891.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 950120 / 931130 (Possible RFI)
</A></li>
        <LI>Next message: <A HREF="001897.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 950120 / 931130 (Possible RFI)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1893">[ date ]</a>
              <a href="thread.html#1893">[ thread ]</a>
              <a href="subject.html#1893">[ subject ]</a>
              <a href="author.html#1893">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Walter,

On Tue, Feb 02, 2016 at 02:02:13PM +0100, Walter Hop wrote:
&gt;<i> Thanks, that&#8217;s a nice torrent of mail you sent there! :) I&#8217;ll have time to look at the rules next weekend, although maybe I&#8217;ll sneak in a few replies before that.
</I>
Cool.

&gt;<i> Before making a good judgement call on SQLi and XSS related rules, I still need to know a bit more about libinjection.
</I>&gt;<i> 
</I>&gt;<i> We should recommend moving a rule into paranoia if its cost is too high relative to its benefit.
</I>&gt;<i> But, for SQLi and XSS rules, this depends on libinjection, which I haven&#8217;t really exercised yet.
</I>
Libinjection has been around for a few years. I always considered it
underdocumented and too much of a one man show. After my rant in
<A HREF="https://www.netnea.com/cms/2015/12/20/modsec-crs-2-2-x-vs-3-0-0-dev/">https://www.netnea.com/cms/2015/12/20/modsec-crs-2-2-x-vs-3-0-0-dev/</A>
I got in touch with the developer Nick Galbreath who admitted many
shortcomings and promised to clean up his project. In fact we are seeing
more activity with libinjection on github now 
<A HREF="https://github.com/client9/libinjection/pulse/monthly">https://github.com/client9/libinjection/pulse/monthly</A>
But it's still an almost exclusive and I am convinced nobody outside
Nick did a through code review. Meanwhile Chaim told me, libinjection is
included in other WAF products as well and I agree it is a great
piece of code. It's just that I feel uneasy with the state of the
project and the linking of it into my parameter parser aimed to
stop evil attackers (trying to exploit libinjection).

With that being said, the blogpost above showed me, that libinjection
is able to detect a great many sqli and xss attacks. But it is far
from complete. (See blogpost for numbers) So I think it is _one_ rule
in a set of rules aimed to stop sqli and xss. Diversity is key.

Also: A realworld sqlinjection typically triggers a variety of
anti-sqli rules. With _only_ libinject it would be a single critical
alert.

&gt;<i> If libinjection in itself already has a high sensitivity, the benefits of the regexp based rules will become lower. After all, an attack will then likely already be flagged without those rules. In that case, we could move rules from normal to paranoid mode, or dismiss currently removed rules, much more easily.
</I>
I see your point. I think that would work in strict blocking mode.
In anomaly scoring mode, it would only work with a anomaly scoring
limit of 5 or lower. Otherwise, sqlinjections would simply trigger
libinjection, but fly under the radar of the final blocking rule.

Thanks for your input and food for thought. Interesting.

Ahoj,

Christian


-- 
People demand freedom of speech as a compensation for the freedom 
of thought which they seldom use.
-- Soren Kierkegaard
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001891.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 950120 / 931130 (Possible RFI)
</A></li>
	<LI>Next message: <A HREF="001897.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial	candidate 950120 / 931130 (Possible RFI)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1893">[ date ]</a>
              <a href="thread.html#1893">[ thread ]</a>
              <a href="subject.html#1893">[ subject ]</a>
              <a href="author.html#1893">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
