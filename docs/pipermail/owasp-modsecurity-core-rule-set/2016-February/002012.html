<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Interesting into a custom SecRule	into CRS chain
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Interesting%20into%20a%20custom%0A%20SecRule%09into%20CRS%20chain&In-Reply-To=%3CE2C9913D99137A42A2A9646B1E82B8DB010D461ED3%40A1GTOEMBXV001.gto.a3c.atos.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002011.html">
   <LINK REL="Next"  HREF="002018.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Interesting into a custom SecRule	into CRS chain</H1>
    <B>Leos Rivas Manuel</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Interesting%20into%20a%20custom%0A%20SecRule%09into%20CRS%20chain&In-Reply-To=%3CE2C9913D99137A42A2A9646B1E82B8DB010D461ED3%40A1GTOEMBXV001.gto.a3c.atos.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Interesting into a custom SecRule	into CRS chain">Manuel.LeosRivas at gemalto.com
       </A><BR>
    <I>Fri Feb 26 08:27:42 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002011.html">[Owasp-modsecurity-core-rule-set] Interesting into a custom SecRule into CRS chain
</A></li>
        <LI>Next message: <A HREF="002018.html">[Owasp-modsecurity-core-rule-set] CRSv3 PHP issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2012">[ date ]</a>
              <a href="thread.html#2012">[ thread ]</a>
              <a href="subject.html#2012">[ subject ]</a>
              <a href="author.html#2012">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Brian,

Put an include file before loading the CRS rules with all of your customization, try not to work in the CRS files as you will get many problems to replicate your changes after every upgrade.

Regards,
Manuel
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Brian Davis (bridavis)
Sent: vendredi 26 f&#233;vrier 2016 05:45
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: [Owasp-modsecurity-core-rule-set] Interesting into a custom SecRule into CRS chain

Hi,

I'm trying to allow a certain domain to be exempted from the core RFI rule.

What I've done is modified the relevant rule in modsecurity_crs_40_generic_attacks.conf:

SecRule ARGS &quot;^(?:ht|f)tps?://(.*)$&quot; \
        &quot;chain,phase:2,rev:'3',ver:'OWASP_CRS/2.2.9',maturity:'9',accuracy:'9',t:none,capture,ctl:auditLogParts=+E,block,msg:'Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',id:'950120',severity:'2',tag:'OWASP_CRS/WEB_ATTACK/RFI'&quot;
        SecRule TX:1 &quot;!@contains abc&quot; &quot;chain&quot;
        SecRule TX:1 &quot;!@beginsWith %{request_headers.host}&lt;mailto:!@beginsWith%20%25%7brequest_headers.host%7d&gt;&quot; &quot;setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/RFI-%{matched_var_name}=%{tx.1}&quot;

And this works. However, an upgrade of the CRS will wipe this out and it will have to be manually added again.

How would I go about inserting a &quot;link&quot; into the chain from an external file (e.g, modsecurity_crs_61_customrules.conf)?

Thanks,
Brian
________________________________
This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160226/95a4a280/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160226/95a4a280/attachment.html</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002011.html">[Owasp-modsecurity-core-rule-set] Interesting into a custom SecRule into CRS chain
</A></li>
	<LI>Next message: <A HREF="002018.html">[Owasp-modsecurity-core-rule-set] CRSv3 PHP issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2012">[ date ]</a>
              <a href="thread.html#2012">[ thread ]</a>
              <a href="subject.html#2012">[ subject ]</a>
              <a href="author.html#2012">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
