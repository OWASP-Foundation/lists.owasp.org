<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten	controversial ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Forgotten%0A%09controversial%20...&In-Reply-To=%3CCCB13FC3-EE41-496C-9B24-574713954243%40spam.lifeforms.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002017.html">
   <LINK REL="Next"  HREF="002021.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten	controversial ...</H1>
    <B>Walter Hop</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Forgotten%0A%09controversial%20...&In-Reply-To=%3CCCB13FC3-EE41-496C-9B24-574713954243%40spam.lifeforms.nl%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten	controversial ...">modsec at spam.lifeforms.nl
       </A><BR>
    <I>Sun Feb 28 17:25:07 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002017.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
</A></li>
        <LI>Next message: <A HREF="002021.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Forgotten	controversial ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2019">[ date ]</a>
              <a href="thread.html#2019">[ thread ]</a>
              <a href="subject.html#2019">[ subject ]</a>
              <a href="author.html#2019">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Nice!

I&#8217;m fine with anything! The beauty of YAML is that it&#8217;s so easy to parse and generate that it&#8217;s trivial to change over to another format. If you like to work in Python, that might have the added advantage that it can be switched over from making HTTP requests to libmodsecurity&#8217;s Python bindings in the future. It would be most cool to run it with libmodsecurity on a ruleset, and assert that specific rules must be triggered:

    - test:
        input:
            method: 'GET'
            url: &#8216;/?id=1%20OR%20...&#8217;
        output:
            rules: [901234, 912345]
            status: 403

This functionality is present in the old regression-tests too, but I haven&#8217;t actually run it. That old testing framework also has another advantage which Christian suggested in a private mail (and which would be hard to do with the Go http client): you can really mold the complete request text, so you can generate HTTP protocol violations and other advanced things. I don&#8217;t know if the Python Requests library allows to just send a custom blurb over the socket. If so, it would be very cool to copy over the old tests from regression-tests/ too. They could take a format like:

        input:
            raw: &#8216;GET / HTTP/1.0...'

Cheers!
WH

&gt;<i> On 27 Feb 2016, at 18:56, Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Walter,
</I>&gt;<i> I Love this concept. So much so that I have started constructing my own based on a very similar concept (<A HREF="https://github.com/csanders-git/owasp-crs-regressions">https://github.com/csanders-git/owasp-crs-regressions</A>). I have expanded the idea of the yaml script such that it has input and output (so that I can support Christians content comparison). Additionally, I have started designing it so that it will be able to call both python Requests (similar as to what you've done) and output curl commands for research purposes. I'll use Christian's list as a glossary of features to add. I would have adopted it from GO but since the formats are similar, I figured it might be possible to just have an alternative GO client, and I'm not cool enough to GO :-). I'll keep developing but mine should have no problem taking a superset of yours (or being quickly adapted to taking your yaml scripts) because of the defaults. This should make them fairly interoperable. Thoughts?
</I>&gt;<i> 
</I>&gt;<i> Chaim Sanders
</I>&gt;<i> Security Researcher, SpiderLabs
</I>&gt;<i> 
</I>&gt;<i> Trustwave | SMART SECURITY ON DEMAND
</I>&gt;<i> www.trustwave.com
</I>&gt;<i> 
</I>&gt;<i> -----Original Message-----
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Christian Folini
</I>&gt;<i> Sent: Saturday, February 27, 2016 12:13 AM
</I>&gt;<i> To: Walter Hop
</I>&gt;<i> Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> Subject: Re: [Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
</I>&gt;<i> 
</I>&gt;<i> Walter,
</I>&gt;<i> 
</I>&gt;<i> This is nice. I have tested many http checkers through the years, but somehow they all sucked. Your choice of YAML looks valid to me, I might give it a go next week or so.
</I>&gt;<i> 
</I>&gt;<i> A few feature-related questions :
</I>&gt;<i> - It says it has the ability to consume cookies. Can you delete them as
</I>&gt;<i>  well?
</I>&gt;<i> - Can you load data from an external file (passwords spring to mind)?
</I>&gt;<i> - Can I extract a token from a page and use it on a subsequent request?
</I>&gt;<i> - What is the behaviour with multiple http request headers of the same
</I>&gt;<i>  name?
</I>&gt;<i> - Can you control the order of http headers?
</I>&gt;<i> - It follows redirects. But I can't check for the redirect status code?
</I>&gt;<i> - I can't test for the content of a http response header, can I?
</I>&gt;<i> - Can I test for status code _and_ content?
</I>&gt;<i> 
</I>&gt;<i> Sorry if this is just nitpicking. I know these are advanced features, but they are the reason I come back to ugly shell/curl hacks after a week with any http checker.
</I>&gt;<i> 
</I>&gt;<i> Ahoj,
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Fri, Feb 26, 2016 at 10:47:40PM +0100, Walter Hop wrote:
</I>&gt;&gt;<i> I use a little home-built thing to do these kinds of regression tests
</I>&gt;&gt;<i> on our own web services. It walks through a YAML file with tests:
</I>&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx">http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx</A>
</I>&gt;&gt;<i> vS3v2gRV6ZDw&amp;s=5&amp;u=https%3a%2f%2fgithub%2ecom%2flifeforms%2fhttpcheck
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I started to write tests for CRSv3, but I didn&#8217;t get very far, because
</I>&gt;&gt;<i> I got stuck on the PHP rules issue. Here is the start of my httpcheck
</I>&gt;&gt;<i> manifest with some SQLi tests:
</I>&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx">http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx</A>
</I>&gt;&gt;<i> vS3q3-FVzIWQ&amp;s=5&amp;u=http%3a%2f%2flf%2ems%2fcrsv3%2eyaml
</I>&gt;&gt;<i> I just do 'httpcheck -i crsv3.yaml -u <A HREF="http://localhost/">http://localhost/</A>' to run them on a server.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> It&#8217;s in Go though, because I wanted to test lots of servers
</I>&gt;&gt;<i> concurrently and I wanted it to be fast, so it was a good excuse to
</I>&gt;&gt;<i> try Go. Maybe it&#8217;s even a good excuse to learn about its C bindings
</I>&gt;&gt;<i> with libmodsecurity in the future :)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Ultimately it could be any tool, I&#8217;m not really familiar with the Python world, but I&#8217;m in favor of anything that makes it very easy to write a test. Something like just adding a simple line to a file, but with options for doing advanced stuff like POST data, cookies and custom headers. I personally hate writing correct JSON (that trailing comma&#8230;) or XML. But I find YAML pretty nice for this case.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Cheers!
</I>&gt;&gt;<i> WH
</I>&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On 22 Feb 2016, at 21:47, Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> You&#8217;ll note that I have a ticket for updating the regression tests.
</I>&gt;&gt;&gt;<i> I think that this is something that we should look into more.
</I>&gt;&gt;&gt;<i> Potentially, a framework that leverages Python&#8217;s Requests Library?
</I>&gt;&gt;&gt;<i> My strong preference is towards python in these types of things, I
</I>&gt;&gt;&gt;<i> might be convinced into using bash curl. Perl need not apply :-P thoughts?
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On 2/22/16, 3:03 PM, &quot;Christian Folini&quot;
</I>&gt;&gt;&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt;
</I>&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> On Mon, Feb 22, 2016 at 07:57:50PM +0000, Chaim Sanders wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i> Actually I&#185;m really shocked about this. But this is why we have a
</I>&gt;&gt;&gt;&gt;&gt;<i> community :).
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> We desperately need QA for the core rules.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Alternatively, we could also get hold of Walter and dump his brain
</I>&gt;&gt;&gt;&gt;<i> into an analysis engine. His familiarity with all the individual
</I>&gt;&gt;&gt;&gt;<i> rules is most exceptional.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Christian
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;<i> Croyez ceux qui cherchent la v&#233;rit&#233;, doutez de ceux qui la trouvent.
</I>&gt;&gt;&gt;&gt;<i> -- Andr&#233; Gide
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> ________________________________
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGF">http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGF</A>
</I>&gt;&gt;&gt;<i> gxvS3q32SAudAw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2fl
</I>&gt;&gt;&gt;<i> istinfo%2fowasp-modsecurity-core-rule-set
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Walter Hop | PGP key:
</I>&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx">http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx</A>
</I>&gt;&gt;<i> vS3q_1QQ3MDA&amp;s=5&amp;u=https%3a%2f%2flifeforms%2enl%2fpgp
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx">http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgx</A>
</I>&gt;&gt;<i> vS3q32SAudAw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flisti
</I>&gt;&gt;<i> nfo%2fowasp-modsecurity-core-rule-set
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> --
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgxvS3qijFA3GDg&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech">http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgxvS3qijFA3GDg&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech</A>
</I>&gt;<i> twitter: @ChrFolini
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgxvS3q32SAudAw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set">http://scanmail.trustwave.com/?c=4062&amp;d=pbbR1ldGV12U_iMDiY8XX8Z4CqGFgxvS3q32SAudAw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>&gt;<i> ________________________________
</I>&gt;<i> 
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002017.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
</A></li>
	<LI>Next message: <A HREF="002021.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Forgotten	controversial ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2019">[ date ]</a>
              <a href="thread.html#2019">[ thread ]</a>
              <a href="subject.html#2019">[ subject ]</a>
              <a href="author.html#2019">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
