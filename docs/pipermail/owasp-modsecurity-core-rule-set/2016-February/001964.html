<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20970901%20/%20950100%20%28Application%20returning%20500%29&In-Reply-To=%3C20160215201108.GB4580%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001961.html">
   <LINK REL="Next"  HREF="001890.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20970901%20/%20950100%20%28Application%20returning%20500%29&In-Reply-To=%3C20160215201108.GB4580%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)">christian.folini at netnea.com
       </A><BR>
    <I>Mon Feb 15 20:11:08 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001961.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
</A></li>
        <LI>Next message: <A HREF="001890.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 981244 / 942180 and 981248 / 942210 (More SQL stuff)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1964">[ date ]</a>
              <a href="thread.html#1964">[ thread ]</a>
              <a href="subject.html#1964">[ subject ]</a>
              <a href="author.html#1964">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Feb 15, 2016 at 04:16:51AM +0000, Chaim Sanders wrote:
&gt;<i> Honestly I am fine either way. It isn&#185;t really a &#338;paranoid&#185; issue it is
</I>&gt;<i> more of an issue with modsecurity understanding. Perhaps another reason
</I>&gt;<i> why paranoid is a bad name :-p. I do think based on this convo that moving
</I>&gt;<i> it to paranoid doesn&#185;t hurt.
</I>
Thanks Chaim. 

I still think paranoid is a good name. But I have not
forgotten the need to discuss in detail it before a final release.

Ahoj,

Christian



&gt;<i> 
</I>&gt;<i> On 2/12/16, 4:22 PM,
</I>&gt;<i> &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on behalf of
</I>&gt;<i> Christian Folini&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>
</I>&gt;<i> on behalf of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;There has not been much of a discussion here. Thinking this over once or
</I>&gt;<i> &gt;twice again, I think the idea of the paranoia mode is to make things
</I>&gt;<i> &gt;easier for the inexperienced admin.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;In this light, I think it is best to move this rule to paranoia mode.
</I>&gt;<i> &gt;This will allow for easier blind sqli attacks, but it does not cloak
</I>&gt;<i> &gt;a backend error with a 403.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Unless somebody objects with new arguments of course. If you do object,
</I>&gt;<i> &gt;please move quickly now.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Best,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Christian
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;On Tue, Feb 02, 2016 at 09:44:57AM +0100, Christian Folini wrote:
</I>&gt;<i> &gt;&gt; Hi!
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; This is a juicy one.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Rule in 2.2.9:
</I>&gt;<i> &gt;&gt; SecRule RESPONSE_STATUS &quot;^5\d{2}$&quot;
</I>&gt;<i> &gt;&gt;&quot;phase:4,rev:'2',ver:'OWASP_CRS/2.2.9',maturity:'9',accuracy:'9',t:none,c
</I>&gt;<i> &gt;&gt;apture,ctl:auditLogParts=+E,block,msg:'The application is not
</I>&gt;<i> &gt;&gt;available',logdata:'Matched Data: %{TX.0} found within
</I>&gt;<i> &gt;&gt;%{MATCHED_VAR_NAME}:
</I>&gt;<i> &gt;&gt;%{MATCHED_VAR}',id:'970901',tag:'WASCTC/WASC-13',tag:'OWASP_TOP_10/A6',ta
</I>&gt;<i> &gt;&gt;g:'PCI/6.5.6',severity:'3',setvar:'tx.msg=%{rule.msg}',setvar:tx.outbound
</I>&gt;<i> &gt;&gt;_anomaly_score=+%{tx.error_anomaly_score},setvar:tx.anomaly_score=+%{tx.e
</I>&gt;<i> &gt;&gt;rror_anomaly_score},setvar:tx.%{rule.id}-AVAILABILITY/APP_NOT_AVAIL-%{mat
</I>&gt;<i> &gt;&gt;ched_var_name}=%{tx.0}&quot;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Rule in 3.0.0rc1:
</I>&gt;<i> &gt;&gt; SecRule RESPONSE_STATUS &quot;^5\d{2}$&quot; \
</I>&gt;<i> &gt;&gt;      &quot;phase:response,\
</I>&gt;<i> &gt;&gt;      rev:'3',\
</I>&gt;<i> &gt;&gt;      ver:'OWASP_CRS/3.0.0',\
</I>&gt;<i> &gt;&gt;      maturity:'9',\
</I>&gt;<i> &gt;&gt;      accuracy:'9',\
</I>&gt;<i> &gt;&gt;      t:none,\
</I>&gt;<i> &gt;&gt;      capture,\
</I>&gt;<i> &gt;&gt;      ctl:auditLogParts=+E,\
</I>&gt;<i> &gt;&gt;      block,\
</I>&gt;<i> &gt;&gt;      msg:'The Application Returned a 500-Level Status Code',\
</I>&gt;<i> &gt;&gt;      logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}:
</I>&gt;<i> &gt;&gt;%{MATCHED_VAR}',\
</I>&gt;<i> &gt;&gt;      id:'950100',\
</I>&gt;<i> &gt;&gt;      tag:'application-multi',\
</I>&gt;<i> &gt;&gt;      tag:'language-multi',\
</I>&gt;<i> &gt;&gt;      tag:'platform-multi',\
</I>&gt;<i> &gt;&gt;      tag:'attack-information disclosure',\
</I>&gt;<i> &gt;&gt;      tag:'WASCTC/WASC-13',\
</I>&gt;<i> &gt;&gt;      tag:'OWASP_TOP_10/A6',\
</I>&gt;<i> &gt;&gt;      tag:'PCI/6.5.6',\
</I>&gt;<i> &gt;&gt;      severity:'ERROR',\
</I>&gt;<i> &gt;&gt;      setvar:'tx.msg=%{rule.msg}',\
</I>&gt;<i> &gt;&gt;      setvar:tx.outbound_anomaly_score=+%{tx.error_anomaly_score},\
</I>&gt;<i> &gt;&gt;      setvar:tx.anomaly_score=+%{tx.error_anomaly_score},\
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;      setvar:tx.%{rule.id}-AVAILABILITY/APP_NOT_AVAIL-%{matched_var_name}=%{tx
</I>&gt;<i> &gt;&gt;.0}&quot;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Obviously we check the HTTP response status code and trigger an alert
</I>&gt;<i> &gt;&gt;on
</I>&gt;<i> &gt;&gt; a status 500. It is one of the rare rules with anomaly score error (=4)
</I>&gt;<i> &gt;&gt; as opposed to critical (=5).
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Franziska thinks this is too generic and cloaks backend misbehaviour.
</I>&gt;<i> &gt;&gt; (If you have a problem with the error page, then replace it!), but let's
</I>&gt;<i> &gt;&gt; not hide the fact of the error from the client.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Now Walter thinks this rule plays a role when defending against blind
</I>&gt;<i> &gt;&gt; attacks where the difference between 403 (likely blocked by
</I>&gt;<i> &gt;&gt;ModSecurity)
</I>&gt;<i> &gt;&gt; and 500 (passed ModSecurity, but crashed on backend) gives an attacker
</I>&gt;<i> &gt;&gt; important information.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Initially, I wanted to push this rule into paranoia mode. But now I am
</I>&gt;<i> &gt;&gt; not so sure anymore for Walter does have a point.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; However, the inexperienced administrator could have a hard time
</I>&gt;<i> &gt;&gt; indentifying the 403 status as a backend failure. So maybe it is still
</I>&gt;<i> &gt;&gt; a paranoia candidate despite it's supportive role when defending against
</I>&gt;<i> &gt;&gt; blind injection attacks.
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; More brain cycles are definitely needed here!
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; Christian
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; --
</I>&gt;<i> &gt;&gt; mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c</A>
</I>&gt;<i> &gt;&gt;U_5KX4pjQ&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech
</I>&gt;<i> &gt;&gt; twitter: @ChrFolini
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c</A>
</I>&gt;<i> &gt;&gt;UqsdXhygA&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2f
</I>&gt;<i> &gt;&gt;owasp-modsecurity-core-rule-set
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;--
</I>&gt;<i> &gt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> &gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU</A>
</I>&gt;<i> &gt;_5KX4pjQ&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech
</I>&gt;<i> &gt;twitter: @ChrFolini
</I>&gt;<i> &gt;_______________________________________________
</I>&gt;<i> &gt;Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU</A>
</I>&gt;<i> &gt;qsdXhygA&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
</I>&gt;<i> &gt;asp-modsecurity-core-rule-set
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________
</I>&gt;<i> 
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>
-- 
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
<A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
twitter: @ChrFolini
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001961.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
</A></li>
	<LI>Next message: <A HREF="001890.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 981244 / 942180 and 981248 / 942210 (More SQL stuff)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1964">[ date ]</a>
              <a href="thread.html#1964">[ thread ]</a>
              <a href="subject.html#1964">[ subject ]</a>
              <a href="author.html#1964">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
