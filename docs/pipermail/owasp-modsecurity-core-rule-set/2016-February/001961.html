<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20970901%20/%20950100%20%28Application%20returning%20500%29&In-Reply-To=%3CD2E6BB0B.1A475%25csanders%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001949.html">
   <LINK REL="Next"  HREF="001964.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)</H1>
    <B>Chaim Sanders</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20970901%20/%20950100%20%28Application%20returning%20500%29&In-Reply-To=%3CD2E6BB0B.1A475%25csanders%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)">CSanders at trustwave.com
       </A><BR>
    <I>Mon Feb 15 04:16:51 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001949.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
</A></li>
        <LI>Next message: <A HREF="001964.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1961">[ date ]</a>
              <a href="thread.html#1961">[ thread ]</a>
              <a href="subject.html#1961">[ subject ]</a>
              <a href="author.html#1961">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Honestly I am fine either way. It isn&#185;t really a &#338;paranoid&#185; issue it is
more of an issue with modsecurity understanding. Perhaps another reason
why paranoid is a bad name :-p. I do think based on this convo that moving
it to paranoid doesn&#185;t hurt.

On 2/12/16, 4:22 PM,
&quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on behalf of
Christian Folini&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>
on behalf of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:

&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>There has not been much of a discussion here. Thinking this over once or
</I>&gt;<i>twice again, I think the idea of the paranoia mode is to make things
</I>&gt;<i>easier for the inexperienced admin.
</I>&gt;<i>
</I>&gt;<i>In this light, I think it is best to move this rule to paranoia mode.
</I>&gt;<i>This will allow for easier blind sqli attacks, but it does not cloak
</I>&gt;<i>a backend error with a 403.
</I>&gt;<i>
</I>&gt;<i>Unless somebody objects with new arguments of course. If you do object,
</I>&gt;<i>please move quickly now.
</I>&gt;<i>
</I>&gt;<i>Best,
</I>&gt;<i>
</I>&gt;<i>Christian
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>On Tue, Feb 02, 2016 at 09:44:57AM +0100, Christian Folini wrote:
</I>&gt;&gt;<i> Hi!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This is a juicy one.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Rule in 2.2.9:
</I>&gt;&gt;<i> SecRule RESPONSE_STATUS &quot;^5\d{2}$&quot;
</I>&gt;&gt;<i>&quot;phase:4,rev:'2',ver:'OWASP_CRS/2.2.9',maturity:'9',accuracy:'9',t:none,c
</I>&gt;&gt;<i>apture,ctl:auditLogParts=+E,block,msg:'The application is not
</I>&gt;&gt;<i>available',logdata:'Matched Data: %{TX.0} found within
</I>&gt;&gt;<i>%{MATCHED_VAR_NAME}:
</I>&gt;&gt;<i>%{MATCHED_VAR}',id:'970901',tag:'WASCTC/WASC-13',tag:'OWASP_TOP_10/A6',ta
</I>&gt;&gt;<i>g:'PCI/6.5.6',severity:'3',setvar:'tx.msg=%{rule.msg}',setvar:tx.outbound
</I>&gt;&gt;<i>_anomaly_score=+%{tx.error_anomaly_score},setvar:tx.anomaly_score=+%{tx.e
</I>&gt;&gt;<i>rror_anomaly_score},setvar:tx.%{rule.id}-AVAILABILITY/APP_NOT_AVAIL-%{mat
</I>&gt;&gt;<i>ched_var_name}=%{tx.0}&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Rule in 3.0.0rc1:
</I>&gt;&gt;<i> SecRule RESPONSE_STATUS &quot;^5\d{2}$&quot; \
</I>&gt;&gt;<i>      &quot;phase:response,\
</I>&gt;&gt;<i>      rev:'3',\
</I>&gt;&gt;<i>      ver:'OWASP_CRS/3.0.0',\
</I>&gt;&gt;<i>      maturity:'9',\
</I>&gt;&gt;<i>      accuracy:'9',\
</I>&gt;&gt;<i>      t:none,\
</I>&gt;&gt;<i>      capture,\
</I>&gt;&gt;<i>      ctl:auditLogParts=+E,\
</I>&gt;&gt;<i>      block,\
</I>&gt;&gt;<i>      msg:'The Application Returned a 500-Level Status Code',\
</I>&gt;&gt;<i>      logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}:
</I>&gt;&gt;<i>%{MATCHED_VAR}',\
</I>&gt;&gt;<i>      id:'950100',\
</I>&gt;&gt;<i>      tag:'application-multi',\
</I>&gt;&gt;<i>      tag:'language-multi',\
</I>&gt;&gt;<i>      tag:'platform-multi',\
</I>&gt;&gt;<i>      tag:'attack-information disclosure',\
</I>&gt;&gt;<i>      tag:'WASCTC/WASC-13',\
</I>&gt;&gt;<i>      tag:'OWASP_TOP_10/A6',\
</I>&gt;&gt;<i>      tag:'PCI/6.5.6',\
</I>&gt;&gt;<i>      severity:'ERROR',\
</I>&gt;&gt;<i>      setvar:'tx.msg=%{rule.msg}',\
</I>&gt;&gt;<i>      setvar:tx.outbound_anomaly_score=+%{tx.error_anomaly_score},\
</I>&gt;&gt;<i>      setvar:tx.anomaly_score=+%{tx.error_anomaly_score},\
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>      setvar:tx.%{rule.id}-AVAILABILITY/APP_NOT_AVAIL-%{matched_var_name}=%{tx
</I>&gt;&gt;<i>.0}&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Obviously we check the HTTP response status code and trigger an alert
</I>&gt;&gt;<i>on
</I>&gt;&gt;<i> a status 500. It is one of the rare rules with anomaly score error (=4)
</I>&gt;&gt;<i> as opposed to critical (=5).
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Franziska thinks this is too generic and cloaks backend misbehaviour.
</I>&gt;&gt;<i> (If you have a problem with the error page, then replace it!), but let's
</I>&gt;&gt;<i> not hide the fact of the error from the client.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Now Walter thinks this rule plays a role when defending against blind
</I>&gt;&gt;<i> attacks where the difference between 403 (likely blocked by
</I>&gt;&gt;<i>ModSecurity)
</I>&gt;&gt;<i> and 500 (passed ModSecurity, but crashed on backend) gives an attacker
</I>&gt;&gt;<i> important information.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Initially, I wanted to push this rule into paranoia mode. But now I am
</I>&gt;&gt;<i> not so sure anymore for Walter does have a point.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> However, the inexperienced administrator could have a hard time
</I>&gt;&gt;<i> indentifying the 403 status as a backend failure. So maybe it is still
</I>&gt;&gt;<i> a paranoia candidate despite it's supportive role when defending against
</I>&gt;&gt;<i> blind injection attacks.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> More brain cycles are definitely needed here!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Christian
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i><A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c</A>
</I>&gt;&gt;<i>U_5KX4pjQ&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech
</I>&gt;&gt;<i> twitter: @ChrFolini
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i><A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7c</A>
</I>&gt;&gt;<i>UqsdXhygA&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2f
</I>&gt;&gt;<i>owasp-modsecurity-core-rule-set
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i><A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU</A>
</I>&gt;<i>_5KX4pjQ&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech
</I>&gt;<i>twitter: @ChrFolini
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU">http://scanmail.trustwave.com/?c=4062&amp;d=gdO-1gRxIDHovuaeslSrBCHmlII0ZDH7cU</A>
</I>&gt;<i>qsdXhygA&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
</I>&gt;<i>asp-modsecurity-core-rule-set
</I>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>










<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001949.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
</A></li>
	<LI>Next message: <A HREF="001964.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 970901 / 950100 (Application returning 500)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1961">[ date ]</a>
              <a href="thread.html#1961">[ thread ]</a>
              <a href="subject.html#1961">[ subject ]</a>
              <a href="author.html#1961">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
