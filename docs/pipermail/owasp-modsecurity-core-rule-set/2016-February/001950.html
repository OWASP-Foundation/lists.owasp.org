<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 981244 / 942180 and 981248 / 942210 (More SQL stuff)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20981244%20/%20942180%20and%20981248%20/%20942210%20%28More%20SQL%20stuff%29&In-Reply-To=%3C20160212212421.GE32631%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001890.html">
   <LINK REL="Next"  HREF="001894.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 981244 / 942180 and 981248 / 942210 (More SQL stuff)</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20981244%20/%20942180%20and%20981248%20/%20942210%20%28More%20SQL%20stuff%29&In-Reply-To=%3C20160212212421.GE32631%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 981244 / 942180 and 981248 / 942210 (More SQL stuff)">christian.folini at netnea.com
       </A><BR>
    <I>Fri Feb 12 21:24:21 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001890.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 981244 / 942180 and 981248 / 942210 (More SQL stuff)
</A></li>
        <LI>Next message: <A HREF="001894.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1950">[ date ]</a>
              <a href="thread.html#1950">[ thread ]</a>
              <a href="subject.html#1950">[ subject ]</a>
              <a href="author.html#1950">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>And the final one:

There has not been any opposition to moving these two rules to
paranoia mode. So this is what we are going to do, until we
see a last minute intervention.

Ahoj,

Christian

On Tue, Feb 02, 2016 at 10:15:15AM +0100, Christian Folini wrote:
&gt;<i> Dear all,
</I>&gt;<i> 
</I>&gt;<i> The case with 981244 / 942180 (Detects basic SQL authentication
</I>&gt;<i> bypass attempts 1/3) and 981242 / 942210 (Detects chaines SQLI injection
</I>&gt;<i> attempts 1/2) is similar.
</I>&gt;<i> 
</I>&gt;<i> I think they warrant for frequent or very frequent false positives and
</I>&gt;<i> Walter thinks they don't.
</I>&gt;<i> 
</I>&gt;<i> Rule 2.2.X: 981244:
</I>&gt;<i> SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* &quot;(?i:(?i:\d[\&quot;'`&#180;&#8217;&#8216;]\s+[\&quot;'`&#180;&#8217;&#8216;]\s+\d)|(?:^admin\s*?[\&quot;'`&#180;&#8217;&#8216;]|(\/\*)+[\&quot;'`&#180;&#8217;&#8216;]+\s?(?:--|#|\/\*|{)?)|(?:[\&quot;'`&#180;&#8217;&#8216;]\s*?\b(x?or|div|like|between|and)\b\s*?[+&lt;&gt;=(),-]\s*?[\d\&quot;'`&#180;&#8217;&#8216;])|(?:[\&quot;'`&#180;&#8217;&#8216;]\s*?[^\w\s]?=\s*?[\&quot;'`&#180;&#8217;&#8216;])|(?:[\&quot;'`&#180;&#8217;&#8216;]\W*?[+=]+\W*?[\&quot;'`&#180;&#8217;&#8216;])|(?:[\&quot;'`&#180;&#8217;&#8216;]\s*?[!=|][\d\s!=+-]+.*?[\&quot;'`&#180;&#8217;&#8216;(].*?$)|(?:[\&quot;'`&#180;&#8217;&#8216;]\s*?[!=|][\d\s!=]+.*?\d+$)|(?:[\&quot;'`&#180;&#8217;&#8216;]\s*?like\W+[\w\&quot;'`&#180;&#8217;&#8216;(])|(?:\sis\s*?0\W)|(?:where\s[\s\w\.,-]+\s=)|(?:[\&quot;'`&#180;&#8217;&#8216;][&lt;&gt;~]+[\&quot;'`&#180;&#8217;&#8216;]))&quot; &quot;phase:2,capture,t:none,t:urlDecodeUni,block,msg:'Detects basic SQL authentication bypass attempts 1/3',id:'981244',tag:'OWASP_CRS/WEB_ATTACK/SQL_INJECTION',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',severity:'2',setvar:'tx.msg=%{rule.id}-%{rule.msg}',setvar:tx.sql_injection_score=+1,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}'&quot;
</I>&gt;<i> 
</I>&gt;<i> Rule 3.0.0rc1: 942180:
</I>&gt;<i> SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* &quot;(?i:(?i:\d[\&quot;'`]\s+[\&quot;'`]\s+\d)|(?:^admin\s*?[\&quot;'`]|(\/\*)+[\&quot;'`]+\s?(?:--|#|\/\*|{)?)|(?:[\&quot;'`]\s*?(x?or|div|like|between|and)[\w\s-]+\s*?[+&lt;&gt;=(),-]\s*?[\d\&quot;'`])|(?:[\&quot;'`]\s*?[^\w\s]?=\s*?[\&quot;'`])|(?:[\&quot;'`]\W*?[+=]+\W*?[\&quot;'`])|(?:[\&quot;'`]\s*?[!=|][\d\s!=+-]+.*?[\&quot;'`(].*?$)|(?:[\&quot;'`]\s*?[!=|][\d\s!=]+.*?\d+$)|(?:[\&quot;'`]\s*?like\W+[\w\&quot;'`(])|(?:\sis\s*?0\W)|(?:where\s[\s\w\.,-]+\s=)|(?:[\&quot;'`][&lt;&gt;~]+[\&quot;'`]))&quot; \
</I>&gt;<i> 	&quot;phase:request,\
</I>&gt;<i>         rev:'2',\
</I>&gt;<i>         ver:'OWASP_CRS/3.0.0',\
</I>&gt;<i>         maturity:'9',\
</I>&gt;<i>         accuracy:'8',\
</I>&gt;<i> 	capture,\
</I>&gt;<i> 	t:none,t:urlDecodeUni,\
</I>&gt;<i> 	block,\
</I>&gt;<i> 	msg:'Detects basic SQL authentication bypass attempts 1/3',\
</I>&gt;<i> 	id:'942180',\
</I>&gt;<i> 	tag:'application-multi',\
</I>&gt;<i> 	tag:'language-mutli',\
</I>&gt;<i> 	tag:'platform-multi',\
</I>&gt;<i> 	tag:'attack-sqli',\
</I>&gt;<i> 	tag:'OWASP_CRS/WEB_ATTACK/SQL_INJECTION',\
</I>&gt;<i> 	logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
</I>&gt;<i> 	severity:'CRITICAL',\
</I>&gt;<i> 	setvar:'tx.msg=%{rule.msg}',\
</I>&gt;<i> 	setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},\
</I>&gt;<i> 	setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},\
</I>&gt;<i> 	setvar:'tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}'&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> And here is the 2nd pair with the same issue:
</I>&gt;<i> 
</I>&gt;<i> Rule 2.2.X: 981248:
</I>&gt;<i> SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* &quot;(?i:(?:@.+=\s*?\(\s*?select)|(?:\d+\s*?(x?or|div|like|between|and)\s*?\d+\s*?[\-+])|(?:\/\w+;?\s+(?:having|and|x?or|div|like|between|and|select)\W)|(?:\d\s+group\s+by.+\()|(?:(?:;|#|--)\s*?(?:drop|alter))|(?:(?:;|#|--)\s*?(?:update|insert)\s*?\w{2,})|(?:[^\w]SET\s*?@\w+)|(?:(?:n?and|x?x?or|div|like|between|and|not |\|\||\&amp;\&amp;)[\s(]+\w+[\s)]*?[!=+]+[\s\d]*?[\&quot;'`&#180;&#8217;&#8216;=()]))&quot; &quot;phase:2,capture,t:none,t:urlDecodeUni,block,msg:'Detects chained SQL injection attempts 1/2',id:'981248',tag:'OWASP_CRS/WEB_ATTACK/SQL_INJECTION',logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',severity:'2',setvar:'tx.msg=%{rule.id}-%{rule.msg}',setvar:tx.sql_injection_score=+1,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}'&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Rule 3.0.0rc1: 942180:
</I>&gt;<i> SecRule REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* &quot;(?i:(?i:\d[\&quot;'`]\s+[\&quot;'`]\s+\d)|(?:^admin\s*?[\&quot;'`]|(\/\*)+[\&quot;'`]+\s?(?:--|#|\/\*|{)?)|(?:[\&quot;'`]\s*?(x?or|div|like|between|and)[\w\s-]+\s*?[+&lt;&gt;=(),-]\s*?[\d\&quot;'`])|(?:[\&quot;'`]\s*?[^\w\s]?=\s*?[\&quot;'`])|(?:[\&quot;'`]\W*?[+=]+\W*?[\&quot;'`])|(?:[\&quot;'`]\s*?[!=|][\d\s!=+-]+.*?[\&quot;'`(].*?$)|(?:[\&quot;'`]\s*?[!=|][\d\s!=]+.*?\d+$)|(?:[\&quot;'`]\s*?like\W+[\w\&quot;'`(])|(?:\sis\s*?0\W)|(?:where\s[\s\w\.,-]+\s=)|(?:[\&quot;'`][&lt;&gt;~]+[\&quot;'`]))&quot; \
</I>&gt;<i> 	&quot;phase:request,\
</I>&gt;<i>         rev:'2',\
</I>&gt;<i>         ver:'OWASP_CRS/3.0.0',\
</I>&gt;<i>         maturity:'9',\
</I>&gt;<i>         accuracy:'8',\
</I>&gt;<i> 	capture,\
</I>&gt;<i> 	t:none,t:urlDecodeUni,\
</I>&gt;<i> 	block,\
</I>&gt;<i> 	msg:'Detects basic SQL authentication bypass attempts 1/3',\
</I>&gt;<i> 	id:'942180',\
</I>&gt;<i> 	tag:'application-multi',\
</I>&gt;<i> 	tag:'language-mutli',\
</I>&gt;<i> 	tag:'platform-multi',\
</I>&gt;<i> 	tag:'attack-sqli',\
</I>&gt;<i> 	tag:'OWASP_CRS/WEB_ATTACK/SQL_INJECTION',\
</I>&gt;<i> 	logdata:'Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}',\
</I>&gt;<i> 	severity:'CRITICAL',\
</I>&gt;<i> 	setvar:'tx.msg=%{rule.msg}',\
</I>&gt;<i> 	setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},\
</I>&gt;<i> 	setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},\
</I>&gt;<i> 	setvar:'tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}'&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Based on my experience running many, many
</I>&gt;<i> sites with the core rules, I would rather move them into paranoia mode.
</I>&gt;<i> Even more so as the other rules in their group are clearer candidates
</I>&gt;<i> for the paranoia mode and leaving them in standard and moving their
</I>&gt;<i> siblings is a bit odd.
</I>&gt;<i> 
</I>&gt;<i> Thoughts?
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> <A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
</I>&gt;<i> twitter: @ChrFolini
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
-- 
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
<A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
twitter: @ChrFolini
</PRE>

















<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001890.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 981244 / 942180 and 981248 / 942210 (More SQL stuff)
</A></li>
	<LI>Next message: <A HREF="001894.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1950">[ date ]</a>
              <a href="thread.html#1950">[ thread ]</a>
              <a href="subject.html#1950">[ subject ]</a>
              <a href="author.html#1950">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
