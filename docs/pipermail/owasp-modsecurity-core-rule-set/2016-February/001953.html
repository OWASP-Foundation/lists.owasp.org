<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI	pattern
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Need%20suggestion%20for%20a%20SQLI%0A%09pattern&In-Reply-To=%3CE4367798-A473-4286-98E2-1D28594C06FF%40spam.lifeforms.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001944.html">
   <LINK REL="Next"  HREF="001946.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI	pattern</H1>
    <B>Walter Hop</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Need%20suggestion%20for%20a%20SQLI%0A%09pattern&In-Reply-To=%3CE4367798-A473-4286-98E2-1D28594C06FF%40spam.lifeforms.nl%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI	pattern">modsec at spam.lifeforms.nl
       </A><BR>
    <I>Sat Feb 13 20:22:12 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001944.html">[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</A></li>
        <LI>Next message: <A HREF="001946.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950120 / 931130 (Possible RFI)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1953">[ date ]</a>
              <a href="thread.html#1953">[ thread ]</a>
              <a href="subject.html#1953">[ subject ]</a>
              <a href="author.html#1953">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Richard and others,

Actually your original query (passing &#8220;select A from B&#8221;) might even be successful in some cases. For instance, in MySQL, you can have a subquery. However it must appear in parentheses.

For instance this is a valid query:
select * from user where id=(select id from user where admin=1)

So if an application developer does the following, your statement might get executed:
select * from user where id=(injected_parameter)

Now, the libinjection in ModSec 2.9 still tries to do something. It doesn&#8217;t think this is SQLi:
&quot;select id from user&#8221; (your example)
&#8220;delete from foo&quot;

But it does think the following strings are SQLi:
&quot;(select id from user)&#8221;
&quot;select id from user where admin=1&#8221;
&quot;select id from user where password is null&#8221;

It&#8217;s still bit of a black box, but I&#8217;m collecting many samples and I plan to report any possible coverage test caseas upstream. I think your example is an interesting one that may not cause too many vulnerabilities, but an application that accepts full queries is still very hazardous so in my opinion ideally libinjection should trigger on it.

Cheers!
WH

&gt;<i> On 11 Feb 2016, at 18:50, Richard Lin &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">hongpinglin at hotmail.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Thanks Chaim and Christian and I agree that it is bad that a user controls a SQL statement.  I think libinjection covered 'Where' and 'Like' clause as you mentioned.  
</I>&gt;<i> 
</I>&gt;<i> I am trying to judge if libinjection missed a category of attacking model in which the user's input is an independent SQLs which can be invoked by themselves (i.e, without prefix of &quot;1 UNION&quot;, '1 or&quot;, &quot;1 and&quot;, etc)  If that is the case, I would consider to propose a patch. But I am not sure how careless developers can directly take the input as SQL itself. That sounds too naive to be believed :)
</I>&gt;<i> 
</I>
-- 
Walter Hop | PGP key: <A HREF="https://lifeforms.nl/pgp">https://lifeforms.nl/pgp</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160213/acb7f151/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160213/acb7f151/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001944.html">[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</A></li>
	<LI>Next message: <A HREF="001946.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950120 / 931130 (Possible RFI)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1953">[ date ]</a>
              <a href="thread.html#1953">[ thread ]</a>
              <a href="subject.html#1953">[ subject ]</a>
              <a href="author.html#1953">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
