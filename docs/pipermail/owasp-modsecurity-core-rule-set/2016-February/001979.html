<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Forgotten%0A%20controversial%20...&In-Reply-To=%3CE2C9913D99137A42A2A9646B1E82B8DB010D44A9B5%40A1GTOEMBXV001.gto.a3c.atos.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001977.html">
   <LINK REL="Next"  HREF="001980.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...</H1>
    <B>Leos Rivas Manuel</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Forgotten%0A%20controversial%20...&In-Reply-To=%3CE2C9913D99137A42A2A9646B1E82B8DB010D44A9B5%40A1GTOEMBXV001.gto.a3c.atos.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...">Manuel.LeosRivas at gemalto.com
       </A><BR>
    <I>Thu Feb 18 09:56:31 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001977.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
</A></li>
        <LI>Next message: <A HREF="001980.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1979">[ date ]</a>
              <a href="thread.html#1979">[ thread ]</a>
              <a href="subject.html#1979">[ subject ]</a>
              <a href="author.html#1979">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Maybe you can have a rule before this to check &amp;variable eq 0 and skip the rule but the cost of macro expansion in your @within against that very simple regex should be very low, especially if you compare it to other rules with multiple capturing +100 long regex ;)

Regards,
Manuel

-----Original Message-----
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Christian Folini
Sent: jeudi 18 f&#233;vrier 2016 10:30
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Re: [Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...

-&gt; <A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/284">https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/284</A>

I had to fix the GeoIP blocking rule as well.
It would use @pm with macro expansion of tx.high_risk_country_codes but @pm does not perform macro expansion. Replaced with @within and placed a note in the reference manual.

So it looks like people never complained about this rule because it never blocked anything.

I also made sure that a GeoIPLookup is only performed on a defined and non-empty tx.high_risk_country_codes.
I run this test with &quot;!^$&quot;. It's the way the core rules check for empty headers as well. However, I wonder if there is not way to do this test without involving a (supposedly
costly) regex.

Feedback welcome.

Ahoj,

Christian


--
It is curious that physical courage should be so common in the world, and moral courage so rare.
-- Mark Twain
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
________________________________
 This message and any attachments are intended solely for the addressees and may contain confidential information. Any unauthorized use or disclosure, either whole or partial, is prohibited.
E-mails are susceptible to alteration. Our company shall not be liable for the message if altered, changed or falsified. If you are not the intended recipient of this message, please delete it and notify the sender.
Although all reasonable efforts have been made to keep this transmission free from viruses, the sender will not be liable for damages caused by a transmitted virus.
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001977.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
</A></li>
	<LI>Next message: <A HREF="001980.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Forgotten controversial ...
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1979">[ date ]</a>
              <a href="thread.html#1979">[ thread ]</a>
              <a href="subject.html#1979">[ subject ]</a>
              <a href="author.html#1979">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
