<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Mechanics%0A%20Proposal&In-Reply-To=%3C20160210062942.GA8002%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001931.html">
   <LINK REL="Next"  HREF="001895.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20Mode%3A%20Mechanics%0A%20Proposal&In-Reply-To=%3C20160210062942.GA8002%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia Mode: Mechanics Proposal">christian.folini at netnea.com
       </A><BR>
    <I>Wed Feb 10 06:29:42 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001931.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal
</A></li>
        <LI>Next message: <A HREF="001895.html">[Owasp-modsecurity-core-rule-set] Phase request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1933">[ date ]</a>
              <a href="thread.html#1933">[ thread ]</a>
              <a href="subject.html#1933">[ subject ]</a>
              <a href="author.html#1933">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Wow!

You won me over. Your message summarizes all my uneasiness with the 0-40
idea, which I was not quite able to express but did not go away even
after it sounded like there was growing consensus for 0-40.

Let's stick with 0-4!

And if we ever need a bigger namespace, we can easily map 
0-&gt;0
1-&gt;10
2-&gt;20
3-&gt;30
4-&gt;40
in an early rule as the spaces are distinct where it matters.

Your proposed table looks like the missing core of the whole
core rules documentation. We totally need this and hopefully
the python bindings will help us come with this in an more or
less automatic manner (I knew they would be useful as soon as
I read about them).


Definitions and default value. I agree on the need for good
criteria for the individual levels. However, I think we are not
in a position to define the criteria as strictly as you do.

I have a criteria proposal in my blogpost too, but it is less
strict. I think we should introduce and paranoia mode and then
sharpen the criteria as me grow in experience.

With that being said, I still think that &quot;1&quot; should be the default
level and 80% of the existing rules in 3.0.0rc1 should remain
on this level. For the time being that is.

I would rather have too many false positives on a standard install
then a fatal false negative on the same install. Your criteria
make it look like a lot of the existing rules would land on level
1 and 2 while the default installation would set the level at
0.

This may have to do with my preference for the anomaly scoring
mode of ModSec, while the strict-blocking mode of operation
is be more likely to block on minimal indicators of an attack.

If we start at default level 1 and most rules on that level
(outside of the ~45 candidates which we will move to level 2-4).
We can then sharpen our toolset and keep a very close eye on
the rules in level 1 and their false positive rate. If we
learn that some rules never really trigger false positives,
then let's move them to 0. If there are rules, which happen
to trigger too many FPs, then we can we can shift them to
level 2. But I think this process will take a year or two
to play out. We need experience.

Best,

Christian


On Tue, Feb 09, 2016 at 09:05:34PM +0100, Walter Hop wrote:
&gt;<i> It&#8217;s a bit of a bikeshed subject, but I think a few levels is better. I think it would be a tricky future if we'd have to say things like: &#8220;hmmm, this rule is too heavy for 10 but too light for 15, let&#8217;s put it at 13&#8221;. How would a novice user ever guess the effects? Most people will pick one number and then troubleshoot.
</I>&gt;<i> 
</I>&gt;<i> We are brainstorming a lot about rules and parameters but we don&#8217;t have consensus on definitions first. If we have an integer scale with so many levels it might be very hard to describe what happens at a level. If we have just a few levels, we can provide definitions. What about this:
</I>&gt;<i> 
</I>&gt;<i> paranoia level 0: we try blocking definite attacks with small chance of false positives (default)
</I>&gt;<i> paranoia level 1: we will be strict about protocol anomalies, this might cause some special clients like loadbalancers and scanners to cause false positives
</I>&gt;<i> paranoia level 2: we will start blocking on suspicious heuristics which aren&#8217;t indicative of a certain attack but can be suspicious (e.g. use of MANY special characters; low-value PHP keywords and OS commands)
</I>&gt;<i> paranoia level 3: the CRS will apply stricter heuristics (e.g. use of SOME special characters)
</I>&gt;<i> paranoia level 4: the CRS will be the most strict
</I>&gt;<i> 
</I>&gt;<i> Then, we could easily document and maintain our paranoia decisions.
</I>&gt;<i> We could make a table like this, so sysadmins know exactly what is happening:
</I>&gt;<i> 
</I>&gt;<i> ruleId
</I>&gt;<i> 0
</I>&gt;<i> 1
</I>&gt;<i> 2
</I>&gt;<i> 3
</I>&gt;<i> 4
</I>&gt;<i> what would trigger?
</I>&gt;<i> 920300
</I>&gt;<i> allowed
</I>&gt;<i> warning
</I>&gt;<i> warning
</I>&gt;<i> block
</I>&gt;<i> block
</I>&gt;<i> no Accept header
</I>&gt;<i> 920350
</I>&gt;<i> allowed
</I>&gt;<i> warning
</I>&gt;<i> warning
</I>&gt;<i> block
</I>&gt;<i> block
</I>&gt;<i> Host is IP4 address
</I>&gt;<i> 931130
</I>&gt;<i> allowed
</I>&gt;<i> allowed
</I>&gt;<i> block
</I>&gt;<i> block
</I>&gt;<i> block
</I>&gt;<i> /?url=<A HREF="http://example.com">http://example.com</A>
</I>&gt;<i> 9123456
</I>&gt;<i> allowed
</I>&gt;<i> allowed
</I>&gt;<i> block on 40 chars
</I>&gt;<i> block on 10 chars
</I>&gt;<i> block on 1 char
</I>&gt;<i> /?id=%00blah
</I>&gt;<i> 
</I>&gt;<i> This clarity is something you lose if you can go to 40 levels.
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> WH
</I>&gt;<i> 
</I>&gt;<i> &gt; On 08 Feb 2016, at 22:12, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thanks Chaim and Lukas!
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I got positive feedback via private messages too.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; The one question, where I am still unsure (and the
</I>&gt;<i> &gt; feedback / criticism is also split) is the question
</I>&gt;<i> &gt; of the good integer range for the paranoia level.
</I>&gt;<i> &gt; 0-4 or rather 0-40.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Still not sure.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Thoughts on this question are thus very welcome.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Ahoj,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Christian
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; On Mon, Feb 08, 2016 at 02:31:47PM +0000, Chaim Sanders wrote:
</I>&gt;<i> &gt;&gt; Good writeup Christian!
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; On 2/8/16, 2:59 AM,
</I>&gt;<i> &gt;&gt; &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on behalf of
</I>&gt;<i> &gt;&gt; Funk, Lukas&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> on
</I>&gt;<i> &gt;&gt; behalf of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Lukas.Funk at united-security-providers.ch</A>&gt; wrote:
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; Hi Christian and all,
</I>&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; I follow the discussion about the paranoia mode with great interest. I
</I>&gt;<i> &gt;&gt;&gt; think it could be a good starting point for ModSecurity users which do
</I>&gt;<i> &gt;&gt;&gt; not have the expert knowledge of the rules.
</I>&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; Looking at your proposed structure of the paranoia mode setup, I think
</I>&gt;<i> &gt;&gt;&gt; it's on a good track. The structure is easy to understand!
</I>&gt;<i> &gt;&gt;&gt; Unfortunately I can't comment the different rules, as I don't have much
</I>&gt;<i> &gt;&gt;&gt; experience with them.
</I>&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; Thanks to all of you putting such great effort to the CRS and I'm really
</I>&gt;<i> &gt;&gt;&gt; looking forward to version 3!
</I>&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; Cheers, Lukas
</I>&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; Dear all,
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; With the progress we are making on the rules front, it is time to talk
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; about
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; the way it could be implemented.
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; It's time for the show-me-the-code. He you go:
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; <A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=tN-41hG4qCjBMKf0XEE90boFBx23NXMA">http://scanmail.trustwave.com/?c=4062&amp;d=tN-41hG4qCjBMKf0XEE90boFBx23NXMA</A>
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; 8kit7zcE9Q&amp;s=5&amp;u=https%3a%2f%2fwww%2enetnea%2ecom%2fcms%2f2016%2f02%2f04
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; %2fowasp-modsecurity-core-rules-
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; paranoia-mode-mechanics-proposal/
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; Feedback welcome!
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; 
</I>&gt;<i> &gt;&gt;&gt;&gt;&gt; Christian
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; ________________________________
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; -- 
</I>&gt;<i> &gt; mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> &gt; <A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
</I>&gt;<i> &gt; twitter: @ChrFolini
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Walter Hop | PGP key: <A HREF="https://lifeforms.nl/pgp">https://lifeforms.nl/pgp</A>
</I>&gt;<i> 
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>

-- 
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
<A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
twitter: @ChrFolini
</PRE>

































<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001931.html">[Owasp-modsecurity-core-rule-set] Paranoia Mode:	Mechanics	Proposal
</A></li>
	<LI>Next message: <A HREF="001895.html">[Owasp-modsecurity-core-rule-set] Phase request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1933">[ date ]</a>
              <a href="thread.html#1933">[ thread ]</a>
              <a href="subject.html#1933">[ subject ]</a>
              <a href="author.html#1933">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
