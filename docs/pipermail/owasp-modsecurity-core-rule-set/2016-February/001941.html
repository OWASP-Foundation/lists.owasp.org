<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Need%20suggestion%20for%20a%20SQLI%0A%20pattern&In-Reply-To=%3C20160211072007.GA1505%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001940.html">
   <LINK REL="Next"  HREF="001942.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Need%20suggestion%20for%20a%20SQLI%0A%20pattern&In-Reply-To=%3C20160211072007.GA1505%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern">christian.folini at netnea.com
       </A><BR>
    <I>Thu Feb 11 07:20:07 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001940.html">[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</A></li>
        <LI>Next message: <A HREF="001942.html">[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1941">[ date ]</a>
              <a href="thread.html#1941">[ thread ]</a>
              <a href="subject.html#1941">[ subject ]</a>
              <a href="author.html#1941">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Richard,

You are on good tracks with your reasoning.

What LibInjection is doing is feeding your input string into an
sql parser and check if it results in a possible injection.

Obviously, your input string _is_ sql, which gives reason to
believe that libinjection is combining your string with 
predefined strings first. Much like you do in your message.

The problem is, that libinjection is underdocumented from a
technical viewpoint so all I am writing here is based on 
fairly highlevel presentations.

The takeaway for me is that not even libinjection is a silver
bullet. It catches a lot, but there are dark areas where
it has to be combined with regexes in a diverse approach.

Ahoj,

Christian







On Thu, Feb 11, 2016 at 06:06:35AM +0000, Richard Lin wrote:
&gt;<i> Thanks. Could you explain in more detail?
</I>&gt;<i> My understanding for SQL injection case is  that careless web developers take the web request parameters and add them to their &quot;where clause&quot;.
</I>&gt;<i> So if the input is  '1 union select a from uid2&quot; that would cause successful injection because the careless developer's SQL was modified from 
</I>&gt;<i> select * from User where id =  [ input] to select * from User where id = 1 union select a from uid2
</I>&gt;<i> In above case, the SQL statement was successfully modified with correct syntax. Thus I can accept this is a successful injection.
</I>&gt;<i> But if the input is &quot;select a from uid2&quot;, then careless developers SQL is as:
</I>&gt;<i> select * from User where id = select a from uid2
</I>&gt;<i> The above SQL statement is not correct in syntax. So this injection will not be successful. Maybe due to this consideration, the libinjection does not consider input of &quot;select a from uid2&quot; is a SQL injection although its SQL pattern is so obvious.
</I>&gt;<i> Richard
</I>&gt;<i> 
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">hongpinglin at hotmail.com</A>; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> Subject: Re: [Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</I>&gt;<i> Date: Thu, 11 Feb 2016 02:51:44 +0000
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hey Richard,
</I>&gt;<i> I&#8217;ve seen things CLOSE to this in production. Sites where they&#8217;ve attempted to use prepared statements to secure a location where the variable injected in a table name. Of course prepared statements are designed for this environment and will fail miserably.
</I>&gt;<i>  But this accounts for a situation where all of the following except the word select is true. Granted it&#8217;s unusual. 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> From: &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt; on behalf of Richard Lin &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">hongpinglin at hotmail.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> Date: Wednesday, February 10, 2016 at 7:31 PM
</I>&gt;<i> 
</I>&gt;<i> To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> Subject: [Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hi folks, I just joined the lists one day ago. And would like to seek the opinions of dealing with a SQLI pattern verdict-ed differently between regex rules and libinjection.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://test.com?id=select">http://test.com?id=select</A> a from table b.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I did not make  SQLI &quot;select a from table b&quot; as URL encoded for easier discussion here.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Basically, libinjection does not consider this string as SQLI although its SQLI pattern is so obvious. Libinjection considers the SQL injections are typically in the context of 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>          
</I>&gt;<i>             select * from table where id =%input with or without injection%
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt;From libinjection point of view,  the input of &quot;select a from table b&quot; is unable to join the above statement with correct SQL syntax. But if we just use regex rules, this input is so easy to marked as SQLI. I would
</I>&gt;<i>  like to seek the opinion in this group.  Do you think the request as &quot;<A HREF="http://test.com?id=select">http://test.com?id=select</A>
</I>&gt;<i>  a from table b.&quot; would cause really SQL injection successful in SQL syntax in any site?
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Thanks
</I>&gt;<i> Richard
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information
</I>&gt;<i>  contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;<i> 
</I>&gt;<i>  		 	   		  
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>

-- 
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
<A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>
twitter: @ChrFolini
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001940.html">[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</A></li>
	<LI>Next message: <A HREF="001942.html">[Owasp-modsecurity-core-rule-set] Need suggestion for a SQLI pattern
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1941">[ date ]</a>
              <a href="thread.html#1941">[ thread ]</a>
              <a href="subject.html#1941">[ subject ]</a>
              <a href="author.html#1941">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
