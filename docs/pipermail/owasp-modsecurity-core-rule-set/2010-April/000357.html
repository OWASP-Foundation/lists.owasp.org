<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] REQUEST_HEADERS_NAMES Problem?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20REQUEST_HEADERS_NAMES%20Problem%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000356.html">
   <LINK REL="Next"  HREF="000358.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] REQUEST_HEADERS_NAMES Problem?</H1>
    <B>Arthur Dent</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20REQUEST_HEADERS_NAMES%20Problem%3F&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] REQUEST_HEADERS_NAMES Problem?">misc.lists at blueyonder.co.uk
       </A><BR>
    <I>Wed Apr  7 16:46:59 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000356.html">[Owasp-modsecurity-core-rule-set] ModSec + Squid / SquidGuard
</A></li>
        <LI>Next message: <A HREF="000358.html">[Owasp-modsecurity-core-rule-set] REQUEST_HEADERS_NAMES Problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#357">[ date ]</a>
              <a href="thread.html#357">[ thread ]</a>
              <a href="subject.html#357">[ subject ]</a>
              <a href="author.html#357">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OK, I am really digging into my ModSec implementation now, turning over
all sorts of stones, and finding all sorts of creepy-crawlies coming
out.

My website is just a small, largely static, low-traffic, family-only
affair, but now that I am looking more closely at the logs I find that
EVERY access to the site causes a Level 3 (error) alert!

--b0f40239-H--
Message: String match within &quot;Proxy-Connection Lock-Token Content-Range Translate via if&quot; at REQUEST_HEADERS_NAMES:Connection. [file &quot;/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_30_http_policy.conf&quot;] [line &quot;99&quot;] [id &quot;960038&quot;] [msg &quot;HTTP header is restricted by policy&quot;] [data &quot;Connection&quot;] [severity &quot;WARNING&quot;] [tag &quot;POLICY/HEADER_RESTRICTED&quot;] [tag &quot;POLICY/FILES_NOT_ALLOWED&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/12.1&quot;] [tag &quot;WASCTC/WASC-15&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/12.1&quot;]
Message: Warning. Operator LT matched 20 at TX:inbound_anomaly_score. [file &quot;/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_60_correlation.conf&quot;] [line &quot;31&quot;] [msg &quot;Inbound Anomaly Score (Total Inbound Score: 10, SQLi=, XSS=): HTTP header is restricted by policy&quot;]
Stopwatch: 1270670982923327 265382 (127726 137588 -)
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.5.12 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); core ruleset/2.0.6.
Server: Apache/2.2.14 (Fedora)

Some background:
My ISP cannot provide me with a static IP address (at least not at a
price I'm prepared to pay!) so I am forced to use a DynDNS address which
points to the dynamic (numeric) IP. My actual registered domain name
points to the DynDNS address. Is this what is triggering the above rule?

Note, it actually makes no difference whether I access the site using
the registered domain name, the DynDNS name, or the IP address directly
- any method triggers the rule...

Hav I borked something somewhere?

All help gratefully received...

Thanks!

Mark

-------------- next part --------------
A non-text attachment was scrubbed...
Name: not available
Type: application/pgp-signature
Size: 197 bytes
Desc: This is a digitally signed message part
Url : <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100407/b328216b/attachment.bin">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100407/b328216b/attachment.bin</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000356.html">[Owasp-modsecurity-core-rule-set] ModSec + Squid / SquidGuard
</A></li>
	<LI>Next message: <A HREF="000358.html">[Owasp-modsecurity-core-rule-set] REQUEST_HEADERS_NAMES Problem?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#357">[ date ]</a>
              <a href="thread.html#357">[ thread ]</a>
              <a href="subject.html#357">[ subject ]</a>
              <a href="author.html#357">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
