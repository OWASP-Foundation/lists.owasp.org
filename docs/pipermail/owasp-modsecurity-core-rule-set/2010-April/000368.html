<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] &lt;Location&gt; works with one rule, but not the other
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%3CLocation%3E%20works%20with%20one%0A%20rule%2C%20but%20not%20the%20other&In-Reply-To=201004130905.44769.ryan.barnett%40breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000363.html">
   <LINK REL="Next"  HREF="000364.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] &lt;Location&gt; works with one rule, but not the other</H1>
    <B>Ryan Cowell</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%3CLocation%3E%20works%20with%20one%0A%20rule%2C%20but%20not%20the%20other&In-Reply-To=201004130905.44769.ryan.barnett%40breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] &lt;Location&gt; works with one rule, but not the other">ryan at truepath.com
       </A><BR>
    <I>Mon Apr 19 19:56:52 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000363.html">[Owasp-modsecurity-core-rule-set] &lt;Location&gt; works with one	rule, but not the other
</A></li>
        <LI>Next message: <A HREF="000364.html">[Owasp-modsecurity-core-rule-set] Hundreds of Wordpress Blogs Hit by &#8216;Networkads.net&#8217; Hack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#368">[ date ]</a>
              <a href="thread.html#368">[ thread ]</a>
              <a href="subject.html#368">[ subject ]</a>
              <a href="author.html#368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I thought I had a working rule (below) but found out today that it was 
still blocking the users from sending the form and gave the error 
message below but did not include the customized message.  Any ideas?

SecRule REQUEST_URI &quot;/contact_cgi.php&quot; \
  &quot;log,pass,ctl:ruleRemoveById=950801,msg:'RC 20100413 - contact_cgi.php'&quot;

[Mon Apr 19 10:49:24 2010] [error] [client xx.xxx.xxx.x] ModSecurity: 
Access denied with code 400 (phase 2). Invalid UTF-8 encoding: invalid 
byte value in character at ARGS:submit. [offset &quot;0&quot;] [file 
&quot;/hsphere/local/config/httpd2/modsecurity-core-rules/modsecurity_crs_20_protocol_violations.conf&quot;] 
[line &quot;67&quot;] [id &quot;950801&quot;] [msg &quot;UTF8 Encoding Abuse Attack Attempt&quot;] 
[severity &quot;WARNING&quot;] [hostname &quot;domain.org&quot;] [uri &quot;/contact_cgi.php&quot;] 
[unique_id &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">S8yXpM at eCgMAAFXLPtEAAAAC</A>&quot;]

Thanks,
Ryan

On 04/13/2010 06:05 AM, Ryan Barnett wrote:
&gt;<i> On Monday 12 April 2010 17:24:50 Ryan Cowell wrote:
</I>&gt;<i>    
</I>&gt;&gt;<i> The commented line did not work, but as far as I can tell, the syntax
</I>&gt;&gt;<i> should be correct.  Rather than disabling the rule entirely, we would
</I>&gt;&gt;<i> like to maintain a log entry while letting specific files function as
</I>&gt;&gt;<i> expected.  The second line was entered as a temporary fix and it does
</I>&gt;&gt;<i> ignore the rule for this file.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &lt;Location /contact_cgi.php&gt;
</I>&gt;&gt;<i>         #SecRuleUpdateActionById 950801 &quot;log,auditlog,pass,msg:'RC
</I>&gt;&gt;<i> 20100409 - phpBB contact_cgi.php'&quot;
</I>&gt;&gt;<i>         SecRuleRemoveById 950801
</I>&gt;&gt;<i> &lt;/Location&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks for any help.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ryan
</I>&gt;&gt;<i> __
</I>&gt;&gt;<i>      
</I>&gt;<i> Hey Ryan,
</I>&gt;<i> What CRS version are you using?  An example audit log entry would help.
</I>&gt;<i>
</I>&gt;<i> A general recommendation is that instead of using Apache scope directives (Location) you
</I>&gt;<i> can simply specify the proper URL with a standard SecRule REQUEST_URI... and then use the
</I>&gt;<i> ctl action to disable the rule.
</I>&gt;<i>
</I>&gt;<i> If you are using CRS v2+ then you can address these issues in a local 48 exceptions file
</I>&gt;<i> that can correct the anomaly score for specific URLs.
</I>&gt;<i>
</I>&gt;<i> -Ryan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>    
</I>
-- 
=================
Ryan Cowell
Truepath
(760) 480-8791
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ryan at truepath.com</A>
=================

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000363.html">[Owasp-modsecurity-core-rule-set] &lt;Location&gt; works with one	rule, but not the other
</A></li>
	<LI>Next message: <A HREF="000364.html">[Owasp-modsecurity-core-rule-set] Hundreds of Wordpress Blogs Hit by &#8216;Networkads.net&#8217; Hack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#368">[ date ]</a>
              <a href="thread.html#368">[ thread ]</a>
              <a href="subject.html#368">[ subject ]</a>
              <a href="author.html#368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
