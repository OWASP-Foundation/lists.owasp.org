<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20Negatives%20%28was%3A%20OWASP%0A%20ModSecurity%20Core%20Rule%20Set%20Community%20Summit%3A%20July%204%2C%202018%2C%20in%20London%29&In-Reply-To=%3CCAN6xG9t0YdGVJxUsTku_%3DwUrYYprD4ZkFLq6gNcTVdHisrZVFQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002549.html">
   <LINK REL="Next"  HREF="002551.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)</H1>
    <B>Manuel Spartan</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20Negatives%20%28was%3A%20OWASP%0A%20ModSecurity%20Core%20Rule%20Set%20Community%20Summit%3A%20July%204%2C%202018%2C%20in%20London%29&In-Reply-To=%3CCAN6xG9t0YdGVJxUsTku_%3DwUrYYprD4ZkFLq6gNcTVdHisrZVFQ%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)">spartantri at gmail.com
       </A><BR>
    <I>Thu Mar 22 17:30:47 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="002549.html">[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
</A></li>
        <LI>Next message: <A HREF="002551.html">[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2550">[ date ]</a>
              <a href="thread.html#2550">[ thread ]</a>
              <a href="subject.html#2550">[ subject ]</a>
              <a href="author.html#2550">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE> Hi Hiranmayi,

Do you think in implementing input validation at all in your app?

&gt;<i>* Encoded XSS attacks (stopped at PL2 as Christian said)
</I>*&gt;* <A HREF="http://localhost:8082/xss2?uid=%3Balert%281%29%3B">http://localhost:8082/xss2?uid=%3Balert%281%29%3B</A>
&lt;<A HREF="http://localhost:8082/xss2?uid=%3Balert%281%29%3B">http://localhost:8082/xss2?uid=%3Balert%281%29%3B</A>&gt;
*
&gt;<i>* SQLi
</I>*&gt;* <A HREF="http://localhost:8082/sqli2?uid=3-2">http://localhost:8082/sqli2?uid=3-2</A> &lt;<A HREF="http://localhost:8082/sqli2?uid=3-2">http://localhost:8082/sqli2?uid=3-2</A>&gt;*

If the response display the same as uid=1 you have a nice injection as the
back-end engine is evaluating the operation, however sending long
complicated payloads will be difficult in Paranoia Level 2 due to
libinjection inspections on ARGS and very hard in PL 4 as all non
alphanumeric characters will cause a blocked request but that will be
extremely annoying to implement if you use non-alphanumeric characters.

Why don't you simply make positive validation rules additional to CRS in
paranoia level 2? That will be easier, faster and more effective if your
app is not so complex but requires tailor made configurations and
application knowledge while the CRS is generic and do not require much
application knowledge.

i.e. This rule will accept only numeric values on the uid parameter on GET
requests, with this you will get rid of both issues with the least effort,
this is the kick... positive security power in action :)
SecRule ARGS:uid &quot;!@rx [0-9]+&quot; &quot;id:1,phase:1,deny,log,msg:'Bad value
received'&quot;

Notice that the phase:1 is only for GET parameters and cannot be placed
inside Apache locations or it may be silently ignored but is faster as most
CRS rules are in phase:2 it will execute earlier and save you the execution
of many rules.

You may find very useful to learn the basics on ModSecurity rule writing,
other than the netnea tutorial to deal with False Positives shared by
Christian:
Web Application Defender's Cookbook: Battling Hackers and Protecting Users
(RBarnett) for quick receipes
ModSecurity Handbook (CFolini, IRistic) for general knowledge
<A HREF="https://coreruleset.org/category/blog/">https://coreruleset.org/category/blog/</A> (CRS blog)
<A HREF="https://spartantri.com/ModSecurity/">https://spartantri.com/ModSecurity/</A> (My blog, read the whitepaper on white
listing)

Have fun!



2018-03-21 20:20 GMT+01:00 Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt;:

&gt;<i> Hey Hiranmayi,
</I>&gt;<i>
</I>&gt;<i> On Wed, Mar 21, 2018 at 02:25:32PM +0000, Hiranmayi Palanki wrote:
</I>&gt;<i> &gt; What is the recommended Paranoia Level for an enterprise Internet facing
</I>&gt;<i> &gt; application, that does not break the application functionality?
</I>&gt;<i>
</I>&gt;<i> I'd say you should put it at least on level 2. This will bring some false
</I>&gt;<i> positives and you deal with those as described in the documentation.
</I>&gt;<i>
</I>&gt;<i> &gt; Let&#8217;s say if I have the default configuration enabled, and the encoded
</I>&gt;<i> XSS
</I>&gt;<i> &gt; attacks are getting through, what is the best way to block the encoded
</I>&gt;<i> XSS
</I>&gt;<i> &gt; attacks without enabling the higher Paranoia Levels?
</I>&gt;<i>
</I>&gt;<i> If you do not want to use CRS rules, you need to write your own XSS rules
</I>&gt;<i> that do a better job than CRS. There are very good XSS documents around,
</I>&gt;<i> many of them several pages long with lots of example payloads. You need to
</I>&gt;<i> cover all these without breaking your application.
</I>&gt;<i>
</I>&gt;<i> Most people find it easier to use CRS and deal with the false positives.
</I>&gt;<i>
</I>&gt;<i> Ahoj,
</I>&gt;<i>
</I>&gt;<i> Christian
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> I have always observed that to succeed in the world one should appear
</I>&gt;<i> like a fool but be wise.
</I>&gt;<i> -- Charles de Montesquieu
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180322/597dbc28/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180322/597dbc28/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002549.html">[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
</A></li>
	<LI>Next message: <A HREF="002551.html">[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2550">[ date ]</a>
              <a href="thread.html#2550">[ thread ]</a>
              <a href="subject.html#2550">[ subject ]</a>
              <a href="author.html#2550">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
