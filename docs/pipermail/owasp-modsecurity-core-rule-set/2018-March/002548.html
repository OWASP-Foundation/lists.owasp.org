<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20Negatives%20%28was%3A%20OWASP%0A%20ModSecurity%20Core%20Rule%20Set%20Community%20Summit%3A%20July%204%2C%202018%2C%20in%20London%29&In-Reply-To=%3C5daa41504b704703bdf87a7af1dc5617%40BL2PR9302MB0003.024d.mgd.msft.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002547.html">
   <LINK REL="Next"  HREF="002549.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)</H1>
    <B>Hiranmayi Palanki</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20Negatives%20%28was%3A%20OWASP%0A%20ModSecurity%20Core%20Rule%20Set%20Community%20Summit%3A%20July%204%2C%202018%2C%20in%20London%29&In-Reply-To=%3C5daa41504b704703bdf87a7af1dc5617%40BL2PR9302MB0003.024d.mgd.msft.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)">Hiranmayi.Palanki at aexp.com
       </A><BR>
    <I>Wed Mar 21 14:25:32 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="002547.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] crs	ruleset and trace method?
</A></li>
        <LI>Next message: <A HREF="002549.html">[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2548">[ date ]</a>
              <a href="thread.html#2548">[ thread ]</a>
              <a href="subject.html#2548">[ subject ]</a>
              <a href="author.html#2548">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Christian.

What is the recommended Paranoia Level for an enterprise Internet facing application, that does not break the application functionality?

Let&#8217;s say if I have the default configuration enabled, and the encoded XSS attacks are getting through, what is the best way to block the encoded XSS attacks without enabling the higher Paranoia Levels?



From: Christian Folini [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>]
Sent: Tuesday, March 20, 2018 3:52 PM
To: Hiranmayi Palanki &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Hiranmayi.Palanki at aexp.com</A>&gt;
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Re: False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)

Hello Hiranmayi,

On Tue, Mar 20, 2018 at 02:19:50PM +0000, Hiranmayi Palanki wrote:
&gt;<i> Having recently tried out ModSecurity, it appears that lower paranoia levels (Basic, PL1, PL2, PL3) are not fully blocking all flavors of XSS and SQL injection.
</I>&gt;<i>
</I>&gt;<i> Encoded XSS attacks are bypassing the CRS rules. Example below:
</I>&gt;<i> <A HREF="http://localhost:8082/xss2?uid=%3Balert%281%29%3B">http://localhost:8082/xss2?uid=%3Balert%281%29%3B</A>
</I>
This results in a 3 rule alerts in CRS 3.0.2 for me:
942110 PL2 SQL Injection Attack: Common Injection Testing Detected
920273 PL4 Invalid character in request (outside of very strict set)
942432 PL4 Restricted SQL Character Anomaly Detection (args): # of special characters exceeded (2)

&gt;<i> Similarly for SQLi, the below pattern is getting through.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://localhost:8082/sqli2?uid=3-2">http://localhost:8082/sqli2?uid=3-2</A>
</I>
What's wrong with this parameter. &quot;3-2&quot; is by no means an SQL Injection. The
very fact that a security scanner is launching a request does not make it an
attack.

&gt;<i> When the Paranoia Level is set to PL4, the encoded XSS attack is blocked,
</I>&gt;<i> however it crashes the application.
</I>
I am not sure what you mean by &quot;crashes the application&quot;. You are probably
meaning to say that the application is no longer working properly with PL4.
That is expected behaviour at this high paranoia level. What you are facing
are false positives, that you need to tune away.

There is a tutorial dedicated to this work over at <A HREF="https://www.netnea.com&lt;https://isolate.menlosecurity.com/1/3735928037/https:/www.netnea.com">https://www.netnea.com&lt;https://isolate.menlosecurity.com/1/3735928037/https:/www.netnea.com</A>&gt;

&gt;<i> Is it possible to selectively add custom rules (for encoded XSS attacks) to
</I>&gt;<i> the basic level or other lower levels that do not adversely impact the
</I>&gt;<i> application?
</I>
One of the criterias for putting rules in the higher paranoia levels is
there tendency to cause false positives. If they were less likely to have this
effect, we would shift them to a lower PL.

With that being said: No, you can not easily move rules around even if the
false positives were a non-issue.

Ahoj,

Christian

P.S. You responded to a message about the CRS summit and quoted that subject
line. Yet your message has a completely different topic. Please start a new
message when you want to start a new subject.


--
There are two primary choices in life: (1) To accept conditions as they
exist, or (2) accept responsibility for changing them.
-- Denis Waitley


American Express made the following annotations
******************************************************************************
&quot;This message and any attachments are solely for the intended recipient and may contain confidential or privileged information. If you are not the intended recipient, any disclosure, copying, use, or distribution of the information included in this message and any attachments is prohibited. If you have received this communication in error, please notify us by reply e-mail and immediately and permanently delete this message and any attachments. Thank you.&quot;

American Express a ajout&#233; le commentaire suivant le Ce courrier et toute pi&#232;ce jointe qu'il contient sont r&#233;serv&#233;s au seul destinataire indiqu&#233; et peuvent renfermer des 
renseignements confidentiels et privil&#233;gi&#233;s. Si vous n'&#234;tes pas le destinataire pr&#233;vu, toute divulgation, duplication, utilisation ou distribution du courrier ou de toute pi&#232;ce jointe est interdite. Si vous avez re&#231;u cette communication par erreur, veuillez nous en aviser par courrier et d&#233;truire imm&#233;diatement le courrier et les pi&#232;ces jointes. Merci.

******************************************************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180321/7030d377/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180321/7030d377/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002547.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] crs	ruleset and trace method?
</A></li>
	<LI>Next message: <A HREF="002549.html">[Owasp-modsecurity-core-rule-set] False Negatives (was: OWASP ModSecurity Core Rule Set Community Summit: July 4, 2018, in London)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2548">[ date ]</a>
              <a href="thread.html#2548">[ thread ]</a>
              <a href="subject.html#2548">[ subject ]</a>
              <a href="author.html#2548">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
