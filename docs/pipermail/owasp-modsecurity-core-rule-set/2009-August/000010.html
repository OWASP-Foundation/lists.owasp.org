<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Fwd: [JIRA] Resolved:	(CORERULES-8) Filter Bypass Vulnerability
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Fwd%3A%20%5BJIRA%5D%20Resolved%3A%0A%09%28CORERULES-8%29%20Filter%20Bypass%20Vulnerability&In-Reply-To=d5dfca260908020428h3d2f1347k24d1f2b5396b7997%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000008.html">
   <LINK REL="Next"  HREF="000015.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Fwd: [JIRA] Resolved:	(CORERULES-8) Filter Bypass Vulnerability</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Fwd%3A%20%5BJIRA%5D%20Resolved%3A%0A%09%28CORERULES-8%29%20Filter%20Bypass%20Vulnerability&In-Reply-To=d5dfca260908020428h3d2f1347k24d1f2b5396b7997%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Fwd: [JIRA] Resolved:	(CORERULES-8) Filter Bypass Vulnerability">ryan.barnett at breach.com
       </A><BR>
    <I>Mon Aug  3 10:10:14 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000008.html">[Owasp-modsecurity-core-rule-set] Fwd: [JIRA] Resolved:	(CORERULES-8) Filter Bypass Vulnerability
</A></li>
        <LI>Next message: <A HREF="000015.html">[Owasp-modsecurity-core-rule-set] Fwd: [JIRA] Resolved:	(CORERULES-8) Filter Bypass Vulnerability
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10">[ date ]</a>
              <a href="thread.html#10">[ thread ]</a>
              <a href="subject.html#10">[ subject ]</a>
              <a href="author.html#10">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sunday 02 August 2009 07:28:37 am Junyong Jiang wrote:
&gt;<i> Dear Ryan,
</I>&gt;<i>
</I>&gt;<i> I have another question about this HPP rule. The definition of HPP attack
</I>&gt;<i> is that the  'arg_names' includes data segment like &quot;user=a &amp; user=d &amp;
</I>&gt;<i> user=m &amp; user=i &amp; user=n&quot;. The multi-parameter is &quot;user&quot;. But if we login a
</I>&gt;<i> user with the same username and password, this is also recognized as HPP
</I>&gt;<i> attack. For example &quot;username=admin&amp;password=admin&quot;.  The differences
</I>&gt;<i> between these two cases are: the multi-parameters are before or after &quot;=&quot;. 
</I>&gt;<i> I want to know whether need we differentiate these two cases in the HPP
</I>&gt;<i> detection rules.
</I>&gt;<i>
</I>
My understanding of HPP 
(<A HREF="http://www.owasp.org/images/b/ba/AppsecEU09_CarettoniDiPaola_v0.8.pdf">http://www.owasp.org/images/b/ba/AppsecEU09_CarettoniDiPaola_v0.8.pdf</A>) is 
that it includes adding in/injecting new parameters.  This can include adding 
in the data before the &quot;=&quot; into the parameter name section or after the &quot;=&quot; 
into the parameter payload section.  Either way, the attacker is adding in new 
parameters.

The issue, then, from the WAF/WebApp perspective is how are multiple 
parameters with the same name treated?  See my blog post here - 
<A HREF="http://tacticalwebappsec.blogspot.com/2009/05/http-parameter-pollution.html.">http://tacticalwebappsec.blogspot.com/2009/05/http-parameter-pollution.html.</A>  
The two main issues are either business-logic abuse and/or signature evasions.

In the example you gave, I am not quite sure how this relates to HPP.  Yes, 
technically, you are inserting new parameter data, however if there are no 
parameter name duplication, then you are not dealing with two issues listed 
above.

Can you explain your question a bit more clearly?

-- 
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
<A HREF="http://tacticalwebappsec.blogspot.com">http://tacticalwebappsec.blogspot.com</A>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090803/f1c4e474/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090803/f1c4e474/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000008.html">[Owasp-modsecurity-core-rule-set] Fwd: [JIRA] Resolved:	(CORERULES-8) Filter Bypass Vulnerability
</A></li>
	<LI>Next message: <A HREF="000015.html">[Owasp-modsecurity-core-rule-set] Fwd: [JIRA] Resolved:	(CORERULES-8) Filter Bypass Vulnerability
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#10">[ date ]</a>
              <a href="thread.html#10">[ thread ]</a>
              <a href="subject.html#10">[ subject ]</a>
              <a href="author.html#10">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
