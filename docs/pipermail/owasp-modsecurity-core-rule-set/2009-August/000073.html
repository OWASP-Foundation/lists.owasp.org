<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] How can we identify this type of	XSS attack
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20can%20we%20identify%20this%20type%0A%20of%09XSS%20attack&In-Reply-To=d5dfca260908272357j1719f8coe4b60c269edf7d33%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000071.html">
   <LINK REL="Next"  HREF="000075.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] How can we identify this type of	XSS attack</H1>
    <B>Brian Rectanus</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20can%20we%20identify%20this%20type%0A%20of%09XSS%20attack&In-Reply-To=d5dfca260908272357j1719f8coe4b60c269edf7d33%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] How can we identify this type of	XSS attack">Brian.Rectanus at breach.com
       </A><BR>
    <I>Fri Aug 28 12:22:18 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000071.html">[Owasp-modsecurity-core-rule-set] How can we identify this type of	XSS attack
</A></li>
        <LI>Next message: <A HREF="000075.html">[Owasp-modsecurity-core-rule-set] How can we identify this type	of XSS attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73">[ date ]</a>
              <a href="thread.html#73">[ thread ]</a>
              <a href="subject.html#73">[ subject ]</a>
              <a href="author.html#73">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Junyong Jiang wrote:
&gt;<i> Dear all,
</I>&gt;<i> I came accros the following problem than I can't use modsecurity to
</I>&gt;<i> identify such type of XSS attack:
</I>&gt;<i> <A HREF="http://192.168.3.144/product.asp?tp=67=%2a%2f%2d%2d%3e%27%22%29%3b%3e%3c%2f%49%66%52%61%4d%65%3e%3c%2f%53%43%72%69%50%74%3e%3c%2f%73%54%79%4c%65%3e%3c%2f%54%69%74%4c%65%3e%3c%2f%74%45%58%74%41%72%65%41%3e%3c%73%63%52%69%50%54%3e%61%6c%65%72%74%28%27%58%73%73%54%65%73%74%27%29%3c%2f%53%63%72%49%50%54%3e">http://192.168.3.144/product.asp?tp=67=%2a%2f%2d%2d%3e%27%22%29%3b%3e%3c%2f%49%66%52%61%4d%65%3e%3c%2f%53%43%72%69%50%74%3e%3c%2f%73%54%79%4c%65%3e%3c%2f%54%69%74%4c%65%3e%3c%2f%74%45%58%74%41%72%65%41%3e%3c%73%63%52%69%50%54%3e%61%6c%65%72%74%28%27%58%73%73%54%65%73%74%27%29%3c%2f%53%63%72%49%50%54%3e</A>
</I>&gt;<i> The decoded URL is:
</I>&gt;<i> <A HREF="http://192.168.3.144/product.asp?tp=67=*/--">http://192.168.3.144/product.asp?tp=67=*/--</A>&gt;'&quot;);&gt;&lt;/IfRaMe&gt;&lt;/SCriPt&gt;&lt;/sTyLe&gt;&lt;/TitLe&gt;&lt;/tEXtAreA&gt;&lt;scRiPT&gt;alert('XssTest')&lt;/ScrIPT
</I>&gt;<i> &lt;<A HREF="http://192.168.3.144/product.asp?tp=67=*/--">http://192.168.3.144/product.asp?tp=67=*/--</A>&gt;'&quot;);&gt;&lt;/IfRaMe&gt;&lt;/SCriPt&gt;&lt;/sTyLe&gt;&lt;/TitLe&gt;&lt;/tEXtAreA&gt;&lt;scRiPT&gt;alert('XssTest')&lt;/ScrIPT&gt;&gt;
</I>&gt;<i> Hope you have good solutions to share with all of us!
</I>&gt;<i> Thanks a lot!
</I>&gt;<i>
</I>
1) You did not specify which version of, well, anything you used.
2) Are you using the Core Rules?  What version?

I cranked up the default CRS 2.0.1 and it detected this just fine:

Message: Pattern match &quot;\balert\b\W*?\(&quot; at TX:pm_xss_data_ARGS:tp. 
[file 
&quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;] 
[line &quot;142&quot;] [id &quot;958052&quot;] [msg &quot;Cross-site Scripting (XSS) Attack&quot;] 
[data &quot;alert(&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/XSS&quot;]
Message: Pattern match &quot;\&lt; ?script\b&quot; at TX:pm_xss_data_ARGS:tp. [file 
&quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;] 
[line &quot;190&quot;] [id &quot;958051&quot;] [msg &quot;Cross-site Scripting (XSS) Attack&quot;] 
[data &quot;&lt;script&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/XSS&quot;]
Message: Pattern match 
&quot;&lt;(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|h 
...&quot; at ARGS:tp. [file 
&quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;] 
[line &quot;281&quot;] [msg &quot;XSS Attack Detected&quot;]
Message: Pattern match &quot;(fromcharcode|alert|eval)\s*\(&quot; at ARGS:tp. 
[file 
&quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;] 
[line &quot;373&quot;] [msg &quot;XSS Attack Detected&quot;]
Message: Warning. Operator GE matched 5 at TX:anomaly_score. [file 
&quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_60_correlation.conf&quot;] 
[line &quot;41&quot;] [msg &quot;Transactional Anomaly Score (score 61): XSS Attack 
Detected&quot;]
Action: Intercepted (phase 2)

-B

-- 
Brian Rectanus
Breach Security
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000071.html">[Owasp-modsecurity-core-rule-set] How can we identify this type of	XSS attack
</A></li>
	<LI>Next message: <A HREF="000075.html">[Owasp-modsecurity-core-rule-set] How can we identify this type	of XSS attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#73">[ date ]</a>
              <a href="thread.html#73">[ thread ]</a>
              <a href="subject.html#73">[ subject ]</a>
              <a href="author.html#73">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
