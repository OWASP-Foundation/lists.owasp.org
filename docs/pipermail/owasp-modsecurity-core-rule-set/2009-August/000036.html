<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] help with blocking
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20help%20with%20blocking&In-Reply-To=869a38360908121754o3d73bb3bj10d569c65d2c4a8d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000034.html">
   <LINK REL="Next"  HREF="000035.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] help with blocking</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20help%20with%20blocking&In-Reply-To=869a38360908121754o3d73bb3bj10d569c65d2c4a8d%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] help with blocking">ryan.barnett at breach.com
       </A><BR>
    <I>Thu Aug 13 11:42:23 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000034.html">[Owasp-modsecurity-core-rule-set] help with blocking
</A></li>
        <LI>Next message: <A HREF="000035.html">[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wednesday 12 August 2009 08:54:56 pm OSSEC junkie wrote:
&gt;<i> it appears this type of string is getting past ModSecurity, can you help me
</I>&gt;<i> out here?
</I>&gt;<i> %22;}eval%28%27al%27%2b%27ert%28docu%27%2b%27ment.c%27%2b%27ookie%29%27%29;
</I>&gt;<i>function%20a%28%29{var%20a=%22
</I>&gt;<i>
</I>&gt;<i> With this string put against one of our parameters, ModSecurity doesnt see
</I>&gt;<i> it.  Any advice?
</I>
I just tested with this request - 

<A HREF="http://www.example.com/cgi-">http://www.example.com/cgi-</A>
bin/printenv?foo=%22;}eval%28%27al%27%2b%27ert%28docu%27%2b%27ment.c%27%2b%27ookie%29%27%29;function%20a%28%29{var%20a=%22

and this payload is identified by a few different signatures in the 
modsecurity_crs_41_xss_attacks.conf file.  Here are some of the matches from 
the modsec_audit.log data -

Message: Pattern match &quot;(?i:[&quot;\'][ ]*(([^a-z0-9~_:\'&quot; ])|(in)).+?(([.].+?)|
([\[].*?[\]].*?))=)&quot; at ARGS:foo. [file &quot;/usr/local/apache/conf/mod
security-core-rules/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;] [line 
&quot;45&quot;] [msg &quot;IE XSS Filters - Attack Detected&quot;]
Message: Pattern match &quot;(?i:[&quot;\'][ ]*(([^a-z0-9~_:\'&quot; ])|(in)).+?\(.*?\))&quot; at 
ARGS:foo. [file &quot;/usr/local/apache/conf/modsecurity-core-rules/b
ase_rules/modsecurity_crs_41_xss_attacks.conf&quot;] [line &quot;49&quot;] [msg &quot;IE XSS 
Filters - Attack Detected&quot;]
Message: Pattern match &quot;(fromcharcode|alert|eval)\s*\(&quot; at ARGS:foo. [file 
&quot;/usr/local/apache/conf/modsecurity-core-rules/base_rules/modsecuri
ty_crs_41_xss_attacks.conf&quot;] [line &quot;414&quot;] [msg &quot;XSS Attack Detected&quot;]

A few questions -

1) Are you using the latest CRS v2.0.1?  We added these Internet Explorer (IE) 
XSS filters to the 2.0.1 version.

2) What is the exact request data?  Is this payload sent in a query_string or 
a post payload?  An audit log example would help for testing.

3) Where did this payload come from?  Are you using a particular tool?  

-- 
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
<A HREF="http://tacticalwebappsec.blogspot.com">http://tacticalwebappsec.blogspot.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090813/3e0681ce/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090813/3e0681ce/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000034.html">[Owasp-modsecurity-core-rule-set] help with blocking
</A></li>
	<LI>Next message: <A HREF="000035.html">[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#36">[ date ]</a>
              <a href="thread.html#36">[ thread ]</a>
              <a href="subject.html#36">[ subject ]</a>
              <a href="author.html#36">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
