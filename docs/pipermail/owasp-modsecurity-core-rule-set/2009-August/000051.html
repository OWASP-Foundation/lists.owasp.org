<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Change/delete a variable !
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Change/delete%20a%20variable%20%21&In-Reply-To=4A8BF46F.1080907%40mbox.dinamica.it">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000050.html">
   <LINK REL="Next"  HREF="000054.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Change/delete a variable !</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Change/delete%20a%20variable%20%21&In-Reply-To=4A8BF46F.1080907%40mbox.dinamica.it"
       TITLE="[Owasp-modsecurity-core-rule-set] Change/delete a variable !">rcbarnett at gmail.com
       </A><BR>
    <I>Wed Aug 19 09:07:24 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000050.html">[Owasp-modsecurity-core-rule-set] Change/delete a variable !
</A></li>
        <LI>Next message: <A HREF="000054.html">[Owasp-modsecurity-core-rule-set] Don't the new rules deserve an	bigger version number increase?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51">[ date ]</a>
              <a href="thread.html#51">[ thread ]</a>
              <a href="subject.html#51">[ subject ]</a>
              <a href="author.html#51">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Wednesday 19 August 2009 08:47:43 am Dr. Paolo Frizzera wrote:
&gt;<i> Hi,
</I>&gt;<i> I have a question: &quot;It's possible to change/delete a variable that come
</I>&gt;<i> in a query string or in a form?&quot;
</I>&gt;<i> Or &quot;It's possible to &quot;masquerade&quot; this variable for the rest of the rules?&quot;
</I>&gt;<i> I want to follow all the controls of the rules but not for that variable.
</I>&gt;<i>
</I>&gt;<i> If is possible, how it's possible ?
</I>&gt;<i> I tried some rules, but without success !
</I>&gt;<i>
</I>&gt;<i> TIA,
</I>&gt;<i> Paolo
</I>Hey Paolo,
Just so I understand your question, do you want to totally exclude a specific 
parameter from matching the rules?  If so, and assuming the parameter name you 
wanted to ignore was &quot;foo&quot;, you could implement a rules like this in the 
modsecurity_crs_48_local_exceptions.conf file -

SecRule TX:/ARGS:foo/ &quot;.*&quot; 
&quot;chain,phase:2,t:none,nolog,pass,setvar:tx.anomaly_score=-20&quot;
SecRule MATCHED_VAR_NAME &quot;TX\:(.*)&quot; &quot;capture,t:none,setvar:!tx.%{tx.1}&quot;

This rule will check to see if any previous rules have triggered for the foo 
parameter payload.  If so, it will decrement the anomaly score by 20 and 
expire the TX variables.

--
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
<A HREF="http://tacticalwebappsec.blogspot.com">http://tacticalwebappsec.blogspot.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090819/b41722e6/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090819/b41722e6/attachment.html</A> 
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000050.html">[Owasp-modsecurity-core-rule-set] Change/delete a variable !
</A></li>
	<LI>Next message: <A HREF="000054.html">[Owasp-modsecurity-core-rule-set] Don't the new rules deserve an	bigger version number increase?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#51">[ date ]</a>
              <a href="thread.html#51">[ thread ]</a>
              <a href="subject.html#51">[ subject ]</a>
              <a href="author.html#51">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
