<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Help with Cole Rule Set
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Help%20with%20Cole%20Rule%20Set&In-Reply-To=3143c0650908022103g1d403500u967380d182c62b41%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000009.html">
   <LINK REL="Next"  HREF="000012.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Help with Cole Rule Set</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Help%20with%20Cole%20Rule%20Set&In-Reply-To=3143c0650908022103g1d403500u967380d182c62b41%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Help with Cole Rule Set">ryan.barnett at breach.com
       </A><BR>
    <I>Mon Aug  3 10:24:23 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000009.html">[Owasp-modsecurity-core-rule-set] Help with Cole Rule Set
</A></li>
        <LI>Next message: <A HREF="000012.html">[Owasp-modsecurity-core-rule-set] Help with Cole Rule Set
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11">[ date ]</a>
              <a href="thread.html#11">[ thread ]</a>
              <a href="subject.html#11">[ subject ]</a>
              <a href="author.html#11">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Monday 03 August 2009 12:03:06 am Josue Del Valle wrote:
&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I am new to mod_security and new to Apache.  I've been asked by my employer
</I>&gt;<i> to configure and secure an Apache server that will run on Windows.  I've
</I>&gt;<i> been reading about the Core Rules and understand that initially they should
</I>&gt;<i> be set to DetectOnly mode and that I should check my logs for false
</I>&gt;<i> positives before turning them on.  What I am not sure is what I will be
</I>&gt;<i> looking for in the logs.  The type of attacks or false positives blocks,  
</I>&gt;<i> How can I identify false positives?  For how long should I run it on
</I>&gt;<i> DetectOnly mode?  Bottom line, I will really appreciate if someone can
</I>&gt;<i> point me in the right direction.  Thanks in advance for your help.
</I>&gt;<i>
</I>&gt;<i>
</I>
Welcome to ModSecurity!  As far as the SecRuleEngine goes 
(<A HREF="http://www.modsecurity.org/documentation/modsecurity-">http://www.modsecurity.org/documentation/modsecurity-</A>
apache/2.5.9/modsecurity2-apache-reference.html#N10A4F) in the older version 
of the Core Rule Set (CRS) we certainly did recommend that this be set to 
DetectionOnly.  The rationale for this was so that you would not mistakenly 
block any legitimate transactions before you had a chance to tune the rules a 
bit for your environment.  In the current CRS v2.0.0, we have changed how the 
rules work.  The SecRuleEngine is set to On (to allow blocking) however the 
rules all use the &quot;block&quot; action which reference the SecDefaultAction setting 
(which is set to pass).  

Specifically, the rules are now running in a &quot;collaborative&quot; mode and use an 
anomaly scoring system.  Each rule, if it triggers, will increase a 
transactional anomaly score.  At the end of phase:2 (the last chance to block 
the inbound request), you can set an appropriate anomaly score for your site.  
This lessens the likelihood of false positives.  Basically, I would suggest 
that you review/update the modsecurity_crs_49_enforcement.conf file and make 
sure that the anomaly scoring level is set to around 20 and that there is no 
blocking action.  This will allow your rules to generate alerts but not block.

As for the false positives,  I would suggest that you review the Data Format 
documentation (<A HREF="http://www.modsecurity.org/documentation/modsecurity-">http://www.modsecurity.org/documentation/modsecurity-</A>
apache/2.5.9/modsecurity2-data-formats.html) so that you understand what data 
is presented.  The alert data will tell you what rule matched, where in the 
transaction the match occurred and what data matched.  You can then review the 
full audit log data of the transaction to confirm if the match was correct or 
not.

By the way - the OWASP CRS project site needs to have better information to 
address your questions.  We will update it soon.

Hope this info helps.

-- 
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
<A HREF="http://tacticalwebappsec.blogspot.com">http://tacticalwebappsec.blogspot.com</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090803/df150560/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090803/df150560/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000009.html">[Owasp-modsecurity-core-rule-set] Help with Cole Rule Set
</A></li>
	<LI>Next message: <A HREF="000012.html">[Owasp-modsecurity-core-rule-set] Help with Cole Rule Set
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#11">[ date ]</a>
              <a href="thread.html#11">[ thread ]</a>
              <a href="subject.html#11">[ subject ]</a>
              <a href="author.html#11">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
