<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] How can we identify this type	of XSS attack
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20can%20we%20identify%20this%20type%0A%09of%20XSS%20attack&In-Reply-To=4A98043A.7070306%40breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000073.html">
   <LINK REL="Next"  HREF="000072.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] How can we identify this type	of XSS attack</H1>
    <B>Junyong Jiang</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20can%20we%20identify%20this%20type%0A%09of%20XSS%20attack&In-Reply-To=4A98043A.7070306%40breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] How can we identify this type	of XSS attack">dreamice.jiang at gmail.com
       </A><BR>
    <I>Fri Aug 28 12:45:03 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000073.html">[Owasp-modsecurity-core-rule-set] How can we identify this type of	XSS attack
</A></li>
        <LI>Next message: <A HREF="000072.html">[Owasp-modsecurity-core-rule-set] What does the rule ID stand for?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75">[ date ]</a>
              <a href="thread.html#75">[ thread ]</a>
              <a href="subject.html#75">[ subject ]</a>
              <a href="author.html#75">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you Brian!
I use core rule set version 1.6.

2009/8/29 Brian Rectanus &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Brian.Rectanus at breach.com</A>&gt;

&gt;<i>  Junyong Jiang wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Dear all,
</I>&gt;&gt;<i> I came accros the following problem than I can't use modsecurity to
</I>&gt;&gt;<i> identify such type of XSS attack:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="http://192.168.3.144/product.asp?tp=67=%2a%2f%2d%2d%3e%27%22%29%3b%3e%3c%2f%49%66%52%61%4d%65%3e%3c%2f%53%43%72%69%50%74%3e%3c%2f%73%54%79%4c%65%3e%3c%2f%54%69%74%4c%65%3e%3c%2f%74%45%58%74%41%72%65%41%3e%3c%73%63%52%69%50%54%3e%61%6c%65%72%74%28%27%58%73%73%54%65%73%74%27%29%3c%2f%53%63%72%49%50%54%3e">http://192.168.3.144/product.asp?tp=67=%2a%2f%2d%2d%3e%27%22%29%3b%3e%3c%2f%49%66%52%61%4d%65%3e%3c%2f%53%43%72%69%50%74%3e%3c%2f%73%54%79%4c%65%3e%3c%2f%54%69%74%4c%65%3e%3c%2f%74%45%58%74%41%72%65%41%3e%3c%73%63%52%69%50%54%3e%61%6c%65%72%74%28%27%58%73%73%54%65%73%74%27%29%3c%2f%53%63%72%49%50%54%3e</A>
</I>&gt;&gt;<i> The decoded URL is:
</I>&gt;&gt;<i> <A HREF="http://192.168.3.144/product.asp?tp=67=*/--">http://192.168.3.144/product.asp?tp=67=*/--</A>
</I>&gt;&gt;<i> &gt;'&quot;);&gt;&lt;/IfRaMe&gt;&lt;/SCriPt&gt;&lt;/sTyLe&gt;&lt;/TitLe&gt;&lt;/tEXtAreA&gt;&lt;scRiPT&gt;alert('XssTest')&lt;/ScrIPT
</I>&gt;&gt;<i> &lt;<A HREF="http://192.168.3.144/product.asp?tp=67=*/--">http://192.168.3.144/product.asp?tp=67=*/--</A>
</I>&gt;&gt;<i> &gt;'&quot;);&gt;&lt;/IfRaMe&gt;&lt;/SCriPt&gt;&lt;/sTyLe&gt;&lt;/TitLe&gt;&lt;/tEXtAreA&gt;&lt;scRiPT&gt;alert('XssTest')&lt;/ScrIPT&gt;&gt;
</I>&gt;&gt;<i> Hope you have good solutions to share with all of us!
</I>&gt;&gt;<i> Thanks a lot!
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;<i> 1) You did not specify which version of, well, anything you used.
</I>&gt;<i> 2) Are you using the Core Rules?  What version?
</I>&gt;<i>
</I>&gt;<i> I cranked up the default CRS 2.0.1 and it detected this just fine:
</I>&gt;<i>
</I>&gt;<i> Message: Pattern match &quot;\balert\b\W*?\(&quot; at TX:pm_xss_data_ARGS:tp. [file
</I>&gt;<i> &quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;142&quot;] [id &quot;958052&quot;] [msg &quot;Cross-site Scripting (XSS) Attack&quot;] [data
</I>&gt;<i> &quot;alert(&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/XSS&quot;]
</I>&gt;<i> Message: Pattern match &quot;\&lt; ?script\b&quot; at TX:pm_xss_data_ARGS:tp. [file
</I>&gt;<i> &quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;190&quot;] [id &quot;958051&quot;] [msg &quot;Cross-site Scripting (XSS) Attack&quot;] [data
</I>&gt;<i> &quot;&lt;script&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/XSS&quot;]
</I>&gt;<i> Message: Pattern match
</I>&gt;<i> &quot;&lt;(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|h
</I>&gt;<i> ...&quot; at ARGS:tp. [file
</I>&gt;<i> &quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;281&quot;] [msg &quot;XSS Attack Detected&quot;]
</I>&gt;<i> Message: Pattern match &quot;(fromcharcode|alert|eval)\s*\(&quot; at ARGS:tp. [file
</I>&gt;<i> &quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;]
</I>&gt;<i> [line &quot;373&quot;] [msg &quot;XSS Attack Detected&quot;]
</I>&gt;<i> Message: Warning. Operator GE matched 5 at TX:anomaly_score. [file
</I>&gt;<i> &quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_60_correlation.conf&quot;]
</I>&gt;<i> [line &quot;41&quot;] [msg &quot;Transactional Anomaly Score (score 61): XSS Attack
</I>&gt;<i> Detected&quot;]
</I>&gt;<i> Action: Intercepted (phase 2)
</I>&gt;<i>
</I>&gt;<i> -B
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Brian Rectanus
</I>&gt;<i> Breach Security
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090829/d5a2de92/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090829/d5a2de92/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000073.html">[Owasp-modsecurity-core-rule-set] How can we identify this type of	XSS attack
</A></li>
	<LI>Next message: <A HREF="000072.html">[Owasp-modsecurity-core-rule-set] What does the rule ID stand for?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#75">[ date ]</a>
              <a href="thread.html#75">[ thread ]</a>
              <a href="subject.html#75">[ subject ]</a>
              <a href="author.html#75">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
