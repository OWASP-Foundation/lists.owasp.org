<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] disable one rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20disable%20one%20rule&In-Reply-To=200908231508.26355.ryan.barnett%40breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000065.html">
   <LINK REL="Next"  HREF="000067.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] disable one rule</H1>
    <B>Jim Manico</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20disable%20one%20rule&In-Reply-To=200908231508.26355.ryan.barnett%40breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] disable one rule">jim.manico at owasp.org
       </A><BR>
    <I>Sun Aug 23 17:09:54 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000065.html">[Owasp-modsecurity-core-rule-set] disable one rule
</A></li>
        <LI>Next message: <A HREF="000067.html">[Owasp-modsecurity-core-rule-set] disable one rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66">[ date ]</a>
              <a href="thread.html#66">[ thread ]</a>
              <a href="subject.html#66">[ subject ]</a>
              <a href="author.html#66">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I agree the rule I suggested is weak, but I've never seen a enterprise  
application without a multiselect list, which per the HTTP standard,  
sends multiple values with the same parameter name. A multiselect list  
is one of 5 basic types of form elements, it's nothing fancy. So I'm  
suprised to see this rule in the core.

I'm curious, is this just me, or do you all avoid multiselect lists?

Jim Manico

On Aug 23, 2009, at 3:08 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ryan.barnett at breach.com</A>&gt;  
wrote:

&gt;<i> On Sunday 23 August 2009 10:27:48 am Jim Manico wrote:
</I>&gt;<i> &gt; This rule would break any app that needs to support standard
</I>&gt;<i> &gt; multiselect lists.
</I>&gt;<i>
</I>&gt;<i> True - this rule is meant for webapps that *don't* legitimately use  
</I>&gt;<i> multiple parameters with the same name.
</I>&gt;<i>
</I>&gt;<i> &gt; Now a great global rule that would not break
</I>&gt;<i> &gt; anything would be you can never have 2 form variables with the same
</I>&gt;<i> &gt; name and value.
</I>&gt;<i>
</I>&gt;<i> What would that achieve from an attacker's perspective? It would not  
</I>&gt;<i> be an HPP attack which entails multiple parameters with the same  
</I>&gt;<i> name but different payloads. In those cases either the client could  
</I>&gt;<i> screw around with back-end logic or distribute malicious payloads in  
</I>&gt;<i> the hopes that it would bypass security filters and then the back- 
</I>&gt;<i> end webapp would magically canonicalize it back into its functional,  
</I>&gt;<i> malicious format.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; <A HREF="http://localhost/example.php?test=abcde&amp;test=abcde">http://localhost/example.php?test=abcde&amp;test=abcde</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Seems like very bad code. I can't see any need to support this,  
</I>&gt;<i> unless
</I>&gt;<i> &gt; you have a multiselect list with multiple entries of the same value,
</I>&gt;<i> &gt; submitting over get. I can't think of why you would ever want to do
</I>&gt;<i> &gt; that?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Jim Manico
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; On Aug 23, 2009, at 4:23 AM, Christian Klossek &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">c.klossek at apodiscounter.de</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; &gt; wrote:
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Hello,
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; for one php-file I need to disable the rule &quot;Possible HTTP  
</I>&gt;<i> Parameter
</I>&gt;<i> &gt; &gt; Pollution Attack: Multiple Parameters with the same Name.&quot;
</I>&gt;<i> &gt; &gt; (modsecurity_crs_40_generic_attacks.conf).
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Example: <A HREF="http://localhost/example.php?test=abcde&amp;test=abcde">http://localhost/example.php?test=abcde&amp;test=abcde</A>
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; That url should be legal. And I don't want to change the core  
</I>&gt;<i> rules
</I>&gt;<i> &gt; &gt; directly. Is there a possibility to create a special rule for  
</I>&gt;<i> that url
</I>&gt;<i> &gt; &gt; and that parameter in my &quot;modsecurity_crs_15_custom_config.conf&quot;?
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; Thanks
</I>&gt;<i> &gt; &gt; Christian
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000065.html">[Owasp-modsecurity-core-rule-set] disable one rule
</A></li>
	<LI>Next message: <A HREF="000067.html">[Owasp-modsecurity-core-rule-set] disable one rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#66">[ date ]</a>
              <a href="thread.html#66">[ thread ]</a>
              <a href="subject.html#66">[ subject ]</a>
              <a href="author.html#66">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
