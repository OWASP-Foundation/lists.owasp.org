<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20About%20file%20upload%20with%20trojan%0A%09horse%20detect&In-Reply-To=d5dfca260908131842k69027010rde7fe00d6d95a8fb%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000038.html">
   <LINK REL="Next"  HREF="000042.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20About%20file%20upload%20with%20trojan%0A%09horse%20detect&In-Reply-To=d5dfca260908131842k69027010rde7fe00d6d95a8fb%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect">ryan.barnett at breach.com
       </A><BR>
    <I>Fri Aug 14 13:30:17 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000038.html">[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect
</A></li>
        <LI>Next message: <A HREF="000042.html">[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39">[ date ]</a>
              <a href="thread.html#39">[ thread ]</a>
              <a href="subject.html#39">[ subject ]</a>
              <a href="author.html#39">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thursday 13 August 2009 09:42:38 pm Junyong Jiang wrote:
&gt;<i> Ryan,
</I>&gt;<i>
</I>&gt;<i> Thanks for your reply.
</I>&gt;<i>
</I>&gt;<i> Yes, the client client uses a file upload interface to upload a file, for
</I>&gt;<i> example a.asp. Then he access a.asp and excute the code in a.asp. I do not
</I>&gt;<i> know how to prevent the attack. Can we check the upload-file's type when
</I>&gt;<i> client upload this file? sometimes, the attacker may modify the suffix of
</I>&gt;<i> the file for cheating de file-suffix checking.
</I>&gt;<i>
</I>&gt;<i> Could you give me some advice?
</I>&gt;<i>
</I>
The CRS already has backdoor access rules in the 
modsecurity_crs_45_trojans.conf file.  These rules will identify if/when a 
client tries to access a backdoor webpage.  These rules are important as users 
can possibly upload these files through non-web protocols (FTP, etc...).  In 
your case, however, you want to prevent the files from being uploaded through 
the web interface to begin with.  What you could possibly do is to take the 
trojan access rules from the 45 file and apply the same signatures to the 
REQUEST_BODY variable instead of RESPONSE_BODY.  This may work somewhat but it 
is not foolproof.  If you have some examples of the backdoor html code, you 
could create some rules based on it.

-Ryan

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090814/79531561/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090814/79531561/attachment.html</A> 
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000038.html">[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect
</A></li>
	<LI>Next message: <A HREF="000042.html">[Owasp-modsecurity-core-rule-set] About file upload with trojan	horse detect
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#39">[ date ]</a>
              <a href="thread.html#39">[ thread ]</a>
              <a href="subject.html#39">[ subject ]</a>
              <a href="author.html#39">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
