<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS	2.0.7 logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Mod_Security%202.5.12%20/%20CRS%0A%092.0.7%20logging&In-Reply-To=201006291312.32537.ryan.barnett%40breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000402.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS	2.0.7 logging</H1>
    <B>Josue Del Valle</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Mod_Security%202.5.12%20/%20CRS%0A%092.0.7%20logging&In-Reply-To=201006291312.32537.ryan.barnett%40breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS	2.0.7 logging">jodelvalle at braishfield.com
       </A><BR>
    <I>Tue Jun 29 13:18:30 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000402.html">[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS	2.0.7 logging
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#403">[ date ]</a>
              <a href="thread.html#403">[ thread ]</a>
              <a href="subject.html#403">[ subject ]</a>
              <a href="author.html#403">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>So if put all the directives in a file and call it for example, logging.conf all I have to do is to put that file with the rest of the configuration files?

Could I just copy/paste the directives from my previous email and put them in the file or is there something else I have to add to make it work?

Regards,
&#160;
Josue Del Valle

-----Original Message-----
From: Ryan Barnett [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ryan.barnett at breach.com</A>] 
Sent: Tuesday, June 29, 2010 1:13 PM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Cc: Josue Del Valle
Subject: Re: [Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS 2.0.7 logging

On Tuesday 29 June 2010 13:01:31 Josue Del Valle wrote:
&gt;<i> Hello,
</I>&gt;<i> 
</I>&gt;<i> I am a fully qualified armature on Mod_Security who is having trouble
</I>&gt;<i> configuring logging for mod_security.
</I>&gt;<i> 
</I>&gt;<i> I noticed the modsecurity_crs_10_config.conf is missing the logging
</I>&gt;<i> settings.  How can I set up logging?
</I>&gt;<i> 
</I>&gt;<i> Do I have to copy this to the modsecurity_crs_10_config.conf file?
</I>&gt;<i> 
</I>
We used to have all of these configs in the CRS 10 file however the more we thought about 
this the more we realized that mixing ModSecurity configuration and the CRS rules was not a 
good idea.  There are many directives that should be the responsibility of the Mod Admin 
and not the CRS rule writers.  So, we removed these directives from the most recent CRS. 

You should have a separate file for holding these other Mod directives (like the ones you 
listed below) so that any updates to the CRS does not overwrite them.

-Ryan

&gt;<i> ## -- Logging
</I>&gt;<i> ----------------------------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> # Whether to log requests to the ModSecurity audit log.
</I>&gt;<i> #
</I>&gt;<i> # By default, only requests that trigger a ModSecurity events (as detected
</I>&gt;<i> # by) or a serer error are logged (&quot;RelevantOnly&quot;). This is a reasonable
</I>&gt;<i> # setting. Full logging can be set by using # &quot;on&quot;. If the system is used
</I>&gt;<i> # for protection only and no logging is desired (not reccomended) logging
</I>&gt;<i> can # be turned of using &quot;off&quot;
</I>&gt;<i> #
</I>&gt;<i> # NOTE It is also possible to configure forensic logging on the
</I>&gt;<i> #      per request basis using the &quot;auditlog&quot; and &quot;noauditlog&quot; rule
</I>&gt;<i> #      actions.
</I>&gt;<i> #
</I>&gt;<i> # TODO The default rule set logs requests that generate a 404 &quot;file not
</I>&gt;<i> found&quot; #      response. These events are interesting, but may log a lot of
</I>&gt;<i> information. #      you may consider removing it by setting
</I>&gt;<i> SecAuditLogRelevantStatus #      to &quot;^(?:5|4\d[^4])&quot;.
</I>&gt;<i> #
</I>&gt;<i> SecAuditEngine RelevantOnly
</I>&gt;<i> SecAuditLogRelevantStatus &quot;^(?:5|4(?!04))&quot;
</I>&gt;<i> 
</I>&gt;<i> # Log files structure
</I>&gt;<i> #
</I>&gt;<i> # You can select to log all events to a single log file (set
</I>&gt;<i> SecAuditLogType to # &quot;Serial&quot;) or to log each request to a separate file
</I>&gt;<i> (set it to &quot;Concurrent&quot;). # The former is usually easier to use, but if
</I>&gt;<i> full logging is required or if # the protected system supports a large
</I>&gt;<i> transaction volume the later may # be a better option.
</I>&gt;<i> #
</I>&gt;<i> # TODO Set the SecAuditLog (for &quot;Serial&quot; logging) or SecAuditLogStorageDir
</I>&gt;<i> (for #      &quot;Concurrent&quot; logging).
</I>&gt;<i> #
</I>&gt;<i> # TODO If you change from &quot;Serial&quot; to &quot;Concurrent&quot; uncomment the
</I>&gt;<i> #      SecAuditLogStorageDir directive and make sure the direcory specified
</I>&gt;<i> #      exists and has write permissions for the Apache user.
</I>&gt;<i> 
</I>&gt;<i> SecAuditLogType Serial
</I>&gt;<i> SecAuditLog logs/modsec_audit.log
</I>&gt;<i> # SecAuditLogStorageDir logs/modsec_audit
</I>&gt;<i> 
</I>&gt;<i> # Select what portions of the request to log
</I>&gt;<i> #
</I>&gt;<i> # Modify the string by adding any of the letter below to it:
</I>&gt;<i> # A - audit log header (mandatory)
</I>&gt;<i> # B - request headers
</I>&gt;<i> # C - request body (present only if the request body exists and ModSecurity
</I>&gt;<i> is #     configured to intercept it)
</I>&gt;<i> # E - intermediary response body (present only if ModSecurity is configured
</I>&gt;<i> to #     intercept response bodies, and if the audit log engine is
</I>&gt;<i> configured to #     record it). Intermediary response body is the same as
</I>&gt;<i> the actual response #     body unless ModSecurity intercepts the
</I>&gt;<i> intermediary response body, in #     which case the actual response body
</I>&gt;<i> will contain the error message #     (either the Apache default error
</I>&gt;<i> message, or the ErrorDocument page). # F - final response headers
</I>&gt;<i> (excluding the Date and Server headers, which are #     always added by
</I>&gt;<i> Apache in the late stage of content delivery). # H - audit log trailer
</I>&gt;<i> # I - This part is a replacement for part C. It will log the same data as C
</I>&gt;<i> in #     all cases except when multipart/form-data encoding in used. In
</I>&gt;<i> this case #     it will log a fake application/x-www-form-urlencoded body
</I>&gt;<i> that contains #     the information about parameters but not about the
</I>&gt;<i> files. This is handy #     if you don't want to have (often large) files
</I>&gt;<i> stored in your audit logs. # Z - final boundary, signifies the end of the
</I>&gt;<i> entry (mandatory)
</I>&gt;<i> 
</I>&gt;<i> SecAuditLogParts &quot;ABIFHKZ&quot;
</I>&gt;<i> 
</I>&gt;<i> # Create a separate log to monitor performance.
</I>&gt;<i> #
</I>&gt;<i> # TODO Performance monitoring only works with Apache 2.x. You need
</I>&gt;<i> #      to add mod_unique_id and mod_logio to your configuration. Then
</I>&gt;<i> #      uncomment the following two lines.
</I>&gt;<i> #
</I>&gt;<i> # LogFormat &quot;%V %h %t %{UNIQUE_ID}e \&quot;%r\&quot; %&gt;s %X | %I %O |
</I>&gt;<i> %&lt;{mod_security-time1}n %&lt;{mod_security-time2}n %&lt;{mod_security-time3}n
</I>&gt;<i> %D&quot; mperformance # CustomLog logs/modsec_performance.log mperformance
</I>&gt;<i> 
</I>&gt;<i> # Custom application access log.
</I>&gt;<i> #
</I>&gt;<i> # TODO You should consider creating a custom access log. It could contain
</I>&gt;<i> #      the performance metrics from above, but should also record the
</I>&gt;<i> #      session ID for every request. That would make it possible to
</I>&gt;<i> #      list all requests performed as part of a session.
</I>&gt;<i> #
</I>&gt;<i> #      One custom log should be used per application but if you want
</I>&gt;<i> #      multiple applications to share one log file make sure each
</I>&gt;<i> #      line includes a unique application ID (unless the hostname is
</I>&gt;<i> #      sufficient for differentiation).
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> 
</I>&gt;<i> Josue Del Valle&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jodelvalle at braishfield.com</A>&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Coverage cannot be assumed to be bound, altered or canceled without
</I>&gt;<i> confirmation from an authorized representative of Braishfield Associates,
</I>&gt;<i> Inc.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> DISCLAIMER:
</I>&gt;<i> 
</I>&gt;<i> CONFIDENTIALITY NOTICE: Braishfield Associates, Inc. would like you to know
</I>&gt;<i> that the information contained in this communication, including
</I>&gt;<i> attachments is privileged and confidential. It is intended only for the
</I>&gt;<i> exclusive use of the addressee. If the reader of this message is not the
</I>&gt;<i> intended recipient, or the employee or agent responsible for delivering it
</I>&gt;<i> to the intended recipient, you are hereby notified that any dissemination,
</I>&gt;<i> distribution or copying of this communication is strictly prohibited.
</I>&gt;<i> Insurance coverage can not be bound, amended or changed via an e-mail
</I>&gt;<i> message without knowledge or consent from the insuring carrier. If you
</I>&gt;<i> have received this communication in error please notify us by telephone
</I>&gt;<i> immediately at (407) 825-9911 or e-mail
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">disclaimer at braishfield.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">disclaimer at braishfield.com</A>&gt;. Thank you.
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000402.html">[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS	2.0.7 logging
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#403">[ date ]</a>
              <a href="thread.html#403">[ thread ]</a>
              <a href="subject.html#403">[ subject ]</a>
              <a href="author.html#403">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
