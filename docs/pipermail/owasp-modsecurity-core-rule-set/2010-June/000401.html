<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS 2.0.7	logging
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Mod_Security%202.5.12%20/%20CRS%202.0.7%0A%09logging&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000400.html">
   <LINK REL="Next"  HREF="000402.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS 2.0.7	logging</H1>
    <B>Josue Del Valle</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Mod_Security%202.5.12%20/%20CRS%202.0.7%0A%09logging&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS 2.0.7	logging">jodelvalle at braishfield.com
       </A><BR>
    <I>Tue Jun 29 13:01:31 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000400.html">[Owasp-modsecurity-core-rule-set] text/xml;	charset=UTF-8 triggering rule 960010
</A></li>
        <LI>Next message: <A HREF="000402.html">[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS	2.0.7 logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#401">[ date ]</a>
              <a href="thread.html#401">[ thread ]</a>
              <a href="subject.html#401">[ subject ]</a>
              <a href="author.html#401">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

 

I am a fully qualified armature on Mod_Security who is having trouble
configuring logging for mod_security.

 

I noticed the modsecurity_crs_10_config.conf is missing the logging
settings.  How can I set up logging?

 

Do I have to copy this to the modsecurity_crs_10_config.conf file?

 

## -- Logging
----------------------------------------------------------------

 

# Whether to log requests to the ModSecurity audit log.

#

# By default, only requests that trigger a ModSecurity events (as
detected 

# by) or a serer error are logged (&quot;RelevantOnly&quot;). This is a reasonable


# setting. Full logging can be set by using # &quot;on&quot;. If the system is
used 

# for protection only and no logging is desired (not reccomended)
logging can 

# be turned of using &quot;off&quot;

#

# NOTE It is also possible to configure forensic logging on the

#      per request basis using the &quot;auditlog&quot; and &quot;noauditlog&quot; rule

#      actions.

#

# TODO The default rule set logs requests that generate a 404 &quot;file not
found&quot;

#      response. These events are interesting, but may log a lot of
information.

#      you may consider removing it by setting SecAuditLogRelevantStatus

#      to &quot;^(?:5|4\d[^4])&quot;.

#

SecAuditEngine RelevantOnly

SecAuditLogRelevantStatus &quot;^(?:5|4(?!04))&quot;

 

# Log files structure

#

# You can select to log all events to a single log file (set
SecAuditLogType to 

# &quot;Serial&quot;) or to log each request to a separate file (set it to
&quot;Concurrent&quot;). 

# The former is usually easier to use, but if full logging is required
or if 

# the protected system supports a large transaction volume the later may

# be a better option.

#

# TODO Set the SecAuditLog (for &quot;Serial&quot; logging) or
SecAuditLogStorageDir (for

#      &quot;Concurrent&quot; logging).

#

# TODO If you change from &quot;Serial&quot; to &quot;Concurrent&quot; uncomment the 

#      SecAuditLogStorageDir directive and make sure the direcory
specified 

#      exists and has write permissions for the Apache user. 

 

SecAuditLogType Serial

SecAuditLog logs/modsec_audit.log

# SecAuditLogStorageDir logs/modsec_audit

 

# Select what portions of the request to log

#

# Modify the string by adding any of the letter below to it:

# A - audit log header (mandatory)

# B - request headers

# C - request body (present only if the request body exists and
ModSecurity is 

#     configured to intercept it)

# E - intermediary response body (present only if ModSecurity is
configured to 

#     intercept response bodies, and if the audit log engine is
configured to 

#     record it). Intermediary response body is the same as the actual
response 

#     body unless ModSecurity intercepts the intermediary response body,
in 

#     which case the actual response body will contain the error message


#     (either the Apache default error message, or the ErrorDocument
page).

# F - final response headers (excluding the Date and Server headers,
which are 

#     always added by Apache in the late stage of content delivery).

# H - audit log trailer

# I - This part is a replacement for part C. It will log the same data
as C in 

#     all cases except when multipart/form-data encoding in used. In
this case 

#     it will log a fake application/x-www-form-urlencoded body that
contains 

#     the information about parameters but not about the files. This is
handy 

#     if you don't want to have (often large) files stored in your audit
logs.

# Z - final boundary, signifies the end of the entry (mandatory)

 

SecAuditLogParts &quot;ABIFHKZ&quot;

 

# Create a separate log to monitor performance.

#

# TODO Performance monitoring only works with Apache 2.x. You need

#      to add mod_unique_id and mod_logio to your configuration. Then

#      uncomment the following two lines.

#

# LogFormat &quot;%V %h %t %{UNIQUE_ID}e \&quot;%r\&quot; %&gt;s %X | %I %O |
%&lt;{mod_security-time1}n %&lt;{mod_security-time2}n %&lt;{mod_security-time3}n
%D&quot; mperformance

# CustomLog logs/modsec_performance.log mperformance

 

# Custom application access log.

#

# TODO You should consider creating a custom access log. It could
contain

#      the performance metrics from above, but should also record the

#      session ID for every request. That would make it possible to

#      list all requests performed as part of a session.

#

#      One custom log should be used per application but if you want

#      multiple applications to share one log file make sure each

#      line includes a unique application ID (unless the hostname is

#      sufficient for differentiation).

 

Regards,

 

Josue Del Valle &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jodelvalle at braishfield.com</A>&gt; 

 





Coverage cannot be assumed to be bound, altered or canceled without confirmation from an authorized representative of Braishfield Associates, Inc.


DISCLAIMER:

CONFIDENTIALITY NOTICE: Braishfield Associates, Inc. would like you to know that the information contained in this communication, including attachments is privileged and confidential. It is intended only for the exclusive use of the addressee. If the reader of this message is not the intended recipient, or the employee or agent responsible for delivering it to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited. Insurance coverage can not be bound, amended or changed via an e-mail message without knowledge or consent from the insuring carrier. If you have received this communication in error please notify us by telephone immediately at (407) 825-9911 or e-mail <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">disclaimer at braishfield.com.</A> Thank you.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100629/625a3ac8/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100629/625a3ac8/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000400.html">[Owasp-modsecurity-core-rule-set] text/xml;	charset=UTF-8 triggering rule 960010
</A></li>
	<LI>Next message: <A HREF="000402.html">[Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS	2.0.7 logging
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#401">[ date ]</a>
              <a href="thread.html#401">[ thread ]</a>
              <a href="subject.html#401">[ subject ]</a>
              <a href="author.html#401">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
