<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] slow dos attacks detection problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20slow%20dos%20attacks%20detection%20problem&In-Reply-To=%3C6FDC88A9834BCC47ACC16EC4B87A5CD8030701D5%40BE000000VAS03.be.top.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001313.html">
   <LINK REL="Next"  HREF="001315.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem</H1>
    <B>Demin Olivier</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20slow%20dos%20attacks%20detection%20problem&In-Reply-To=%3C6FDC88A9834BCC47ACC16EC4B87A5CD8030701D5%40BE000000VAS03.be.top.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem">Olivier.Demin at generali.be
       </A><BR>
    <I>Sat Feb 16 11:45:13 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001313.html">[Owasp-modsecurity-core-rule-set] Setting HoneyTraps with	ModSecurity: Unused Web Ports
</A></li>
        <LI>Next message: <A HREF="001315.html">[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1314">[ date ]</a>
              <a href="thread.html#1314">[ thread ]</a>
              <a href="subject.html#1314">[ subject ]</a>
              <a href="author.html#1314">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
Hello,

I'm using the CRS 2.2.7 with mod security 2.7.2 and apache 2.2.14 on Linux Ubuntu.  I seem to have troubles with the modsecurity crs 11 slow dos protection.conf from the experimental ruleset.  In fact, the reqtimeout module is working fine and fires 408 errors after the specified number of seconds when I don't provide the HTTP header fast enough (I tested that by simply performing manual telnet sessions on the port 80 of my server).  But these 408 errors seem not to be intercepted by mod security at all.  Indeed, when I enable the maximum debug logs (level 9), nothing is appended in the debug log upon 408 firing:  no trace of any rule being checked in that particular case.

So it seems that the reqtimeout module returns in a way that prevents mod security from being activated.

Did any of you encounter similar problems?

Thanks for your help

Olivier Demin
###########################################&lt;br&gt;GENERALI BELGIUM NV-SA - Verzekeringen-Assurances&lt;br&gt;Louizalaan 149 Avenue Louise - Brussel 1050 Bruxelles&lt;br&gt;Ondernemingsnummer 0403.262.553 Num&#233;ro d'entreprise&lt;br&gt;RPR Brussel - RPM Bruxelles&lt;br&gt;###########################################&lt;br&gt;This e-mail and any files transmitted with it are confidential and&lt;br&gt;intended solely for the use of the individual or entity to whom they &lt;br&gt;are addressed. If you have received this e-mail in error please notify &lt;br&gt;the system manager.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130216/954bd776/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130216/954bd776/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001313.html">[Owasp-modsecurity-core-rule-set] Setting HoneyTraps with	ModSecurity: Unused Web Ports
</A></li>
	<LI>Next message: <A HREF="001315.html">[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1314">[ date ]</a>
              <a href="thread.html#1314">[ thread ]</a>
              <a href="subject.html#1314">[ subject ]</a>
              <a href="author.html#1314">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
