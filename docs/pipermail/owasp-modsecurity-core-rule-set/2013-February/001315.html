<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] slow dos attacks detection problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20slow%20dos%20attacks%20detection%0A%20problem&In-Reply-To=%3CFD28775D-F04F-46A9-AE0B-546B08ACDAC9%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001314.html">
   <LINK REL="Next"  HREF="001316.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20slow%20dos%20attacks%20detection%0A%20problem&In-Reply-To=%3CFD28775D-F04F-46A9-AE0B-546B08ACDAC9%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem">RBarnett at trustwave.com
       </A><BR>
    <I>Sat Feb 16 14:19:21 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001314.html">[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem
</A></li>
        <LI>Next message: <A HREF="001316.html">[Owasp-modsecurity-core-rule-set] slow dos attacks detection	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1315">[ date ]</a>
              <a href="thread.html#1315">[ thread ]</a>
              <a href="subject.html#1315">[ subject ]</a>
              <a href="author.html#1315">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>See this blog post -
<A HREF="http://blog.spiderlabs.com/2011/07/advanced-topic-of-the-week-mitigating-slow-http-dos-attacks.html">http://blog.spiderlabs.com/2011/07/advanced-topic-of-the-week-mitigating-slow-http-dos-attacks.html</A>


Caution: there are several reports that mod_reqtimeoutdoes not issue a 408 status code under various conditions&lt;<A HREF="http://old.nabble.com/-users@httpd--mod_reqtimeout-not-returning-408-td31405422.html">http://old.nabble.com/-users@httpd--mod_reqtimeout-not-returning-408-td31405422.html</A>&gt;.  This means that this implementation described below may not work reliably.

<A HREF="http://apache-http-server.18135.n6.nabble.com/users-httpd-mod-reqtimeout-not-returning-408-td4770478.html">http://apache-http-server.18135.n6.nabble.com/users-httpd-mod-reqtimeout-not-returning-408-td4770478.html</A>

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs

On Feb 16, 2013, at 6:50 AM, &quot;Demin Olivier&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Olivier.Demin at generali.be</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Olivier.Demin at generali.be</A>&gt;&gt; wrote:



Hello,

I'm using the CRS 2.2.7 with mod security 2.7.2 and apache 2.2.14 on Linux Ubuntu.  I seem to have troubles with the modsecurity crs 11 slow dos protection.conf from the experimental ruleset.  In fact, the reqtimeout module is working fine and fires 408 errors after the specified number of seconds when I don't provide the HTTP header fast enough (I tested that by simply performing manual telnet sessions on the port 80 of my server).  But these 408 errors seem not to be intercepted by mod security at all.  Indeed, when I enable the maximum debug logs (level 9), nothing is appended in the debug log upon 408 firing:  no trace of any rule being checked in that particular case.

So it seems that the reqtimeout module returns in a way that prevents mod security from being activated.

Did any of you encounter similar problems?

Thanks for your help

Olivier Demin

###########################################
GENERALI BELGIUM NV-SA - Verzekeringen-Assurances
Louizalaan 149 Avenue Louise - Brussel 1050 Bruxelles
Ondernemingsnummer 0403.262.553 Num&#233;ro d'entreprise
RPR Brussel - RPM Bruxelles
###########################################
This e-mail and any files transmitted with it are confidential and
intended solely for the use of the individual or entity to whom they
are addressed. If you have received this e-mail in error please notify
the system manager.
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130216/5cf340e6/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130216/5cf340e6/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001314.html">[Owasp-modsecurity-core-rule-set] slow dos attacks detection problem
</A></li>
	<LI>Next message: <A HREF="001316.html">[Owasp-modsecurity-core-rule-set] slow dos attacks detection	problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1315">[ date ]</a>
              <a href="thread.html#1315">[ thread ]</a>
              <a href="subject.html#1315">[ subject ]</a>
              <a href="author.html#1315">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
