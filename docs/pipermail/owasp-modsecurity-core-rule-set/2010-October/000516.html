<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] False positive?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20False%20positive%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000515.html">
   <LINK REL="Next"  HREF="000518.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] False positive?</H1>
    <B>Timothy Legge</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20False%20positive%3F&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] False positive?">timlegge at gmail.com
       </A><BR>
    <I>Mon Oct 18 09:37:43 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000515.html">[Owasp-modsecurity-core-rule-set] New ModSecurity FAQ Page and	Project Updates
</A></li>
        <LI>Next message: <A HREF="000518.html">[Owasp-modsecurity-core-rule-set] False positive?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#516">[ date ]</a>
              <a href="thread.html#516">[ thread ]</a>
              <a href="subject.html#516">[ subject ]</a>
              <a href="author.html#516">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

We have an application that is sending the following data that is
getting blocked with the Core Rules 2.0.5:

GET /pl-ws/json/ReAnon?langID=en-ca&amp;answers=%5B%7B%22q_id%22%3A%221%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%222%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%223%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%224%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%225%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%226%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%227%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%228%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%229%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%2210%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%2211%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%2212%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%2213%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%2214%22%2C%22value%22%3A%220%22%7D%2C%7B%22q_id%22%3A%2215%22%2C%22value%22%3A%220%22%7D%5D

The logs show:

Message: Pattern match
&quot;(?:union\s*(?:all|distinct|[(!@]*)?\s*[([]*\s*select)|(?:\w+\s+like\s+&quot;)|(?:like\s*&quot;\%)|(?:&quot;\s*like\W*[&quot;\d])|(?:&quot;\s*(?:n?and|x?or|not
|<i>\|\||\&amp;\&amp;)\s+[\s\w]+=\s*\w+\s*having)|(?:&quot;\s*\*\s*\w+\W+&quot;)|(?:&quot;\s*[^?\w\s=.,;)(]+\s*[(@&quot;]*\s*\w+\W+\w)|(?:select\s*[\
</I>...&quot; at ARGS:answers. [file
&quot;/usr/local/apache2/conf/modsecurity/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]
[line &quot;156&quot;] [id &quot;900045&quot;] [msg &quot;Detects basic SQL authentication
bypass attempts 2/3&quot;] [data &quot;\x22:\x221\x22,\x22v&quot;] [severity
&quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag
&quot;WEB_ATTACK/LFI&quot;]
Message: Pattern match
&quot;(?:\\x(?:23|27|3d))|(?:^.?&quot;$)|(?:^.*\\&quot;.+(?&lt;!\\)&quot;)|(?:(?:^[&quot;\\]*(?:[\d&quot;]+|[^&quot;]+&quot;))+\s*(?:n?and|x?or|not|\|\||\&amp;\&amp;)\s*[\w&quot;[+&amp;!@(),.-])|(?:[^\w\s]\w+\s*[|-]\s*&quot;\s*\w)|(?:@\w+\s+(and|or)\s*[&quot;\d]+)|(?:@[\w-]+\s(and|or)\s*[^\w\s])|(?:[^\w\s:]\s*\d\W+[^\w\s]
...&quot; at ARGS:answers. [file
&quot;/usr/local/apache2/conf/modsecurity/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]
[line &quot;256&quot;] [id &quot;900042&quot;] [msg &quot;Detects classic SQL injection
probings 1/2&quot;] [data &quot;\x221\x22,\x22v&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;WEB_ATTACK/SQLI&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]
Message: Pattern match &quot;(?:(?:n?and|x?or|not
|<i>\|\||\&amp;\&amp;)\s+[\s\w+]+(?:regexp\s*\(|sounds\s+like\s*&quot;|[=\d]+x))|(&quot;\s*\d\s*(?:--|#))|(?:&quot;[\%&amp;&lt;&gt;^=]+\d\s*(=|or))|(?:&quot;\W+[\w+-]+\s*=\s*\d\W+&quot;)|(?:&quot;\s*is\s*\d.+&quot;?\w)|(?:&quot;\|?[\w-]{3,}[^\w\s.,]+&quot;)|(?:&quot;\s*is\s*[\d.]+\s*\W.*&quot;)&quot;
</I>at ARGS:answers. [file
&quot;/usr/local/apache2/conf/modsecurity/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]
[line &quot;261&quot;] [id &quot;900046&quot;] [msg &quot;Detects basic SQL authentication
bypass attempts 3/3&quot;] [data &quot;\x22q_id\x22:\x22&quot;] [severity &quot;CRITICAL&quot;]
[tag &quot;WEB_ATTACK/SQLI&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]
Message: Pattern match
&quot;(?:\([\w\s]+\([\w\s]+\)[\w\s]+\))|(?:(?&lt;!(?:mozilla\/\d\.\d\s))\([^)[]+\[[^\]]+\][^)]*\))|(?:[^\s!][{([][^({[]+[{([][^}\])]+[}\])][\s+&quot;,\d]*[}\])])|(?:&quot;\)?\]\W*\[)|(?:=\s*[^\s:;]+\s*[{([][^}\])]+[}\])];)&quot;
at ARGS:answers. [file
&quot;/usr/local/apache2/conf/modsecurity/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]
[line &quot;301&quot;] [id &quot;90008&quot;] [msg &quot;Detects self-executing JavaScript
functions&quot;] [data
&quot;,{\x22q_id\x22:\x2214\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x2215\x22,\x22value\x22:\x220\x22}]&quot;]
[severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/XSS&quot;] [tag &quot;WEB_ATTACK/CSRF&quot;]
Message: Pattern match
&quot;(?:&quot;\s*\*.+(?:or|id)\W*&quot;\d)|(?:\^&quot;)|(?:^[\w\s&quot;-]+(?&lt;=and\s)(?&lt;=or\s)(?&lt;=xor\s)(?&lt;=nand\s)(?&lt;=not\s)(?&lt;=\|\|)(?&lt;=\&amp;\&amp;)\w+\()|(?:&quot;[\s\d]*[^\w\s]+\W*\d\W*.*[&quot;\d])|(?:&quot;\s*[^\w\s?]+\s*[^\w\s]+\s*&quot;)|(?:&quot;\s*[^\w\s]+\s*[\W\d].*(?:#|--))|(?:&quot;.*\*\s*\d)|(?:&quot;\s*o
...&quot; at ARGS:answers. [file
&quot;/usr/local/apache2/conf/modsecurity/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]
[line &quot;326&quot;] [id &quot;900043&quot;] [msg &quot;Detects classic SQL injection
probings 2/2&quot;] [data
&quot;\x22:\x221\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x222\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x223\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x224\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x225\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x226\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x227\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x228\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x229\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x2210\x22,\x22value\x22:\x220\x22},{\x22q_id\x22:\x2211\x22,\x...&quot;]
[severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag &quot;WEB_ATTACK/ID&quot;]
[tag &quot;WEB_ATTACK/LFI&quot;]
Message: Access denied with code 403 (phase 2). [file
&quot;/usr/local/apache2/conf/modsecurity/base_rules/modsecurity_crs_49_enforcement.conf&quot;]
[line &quot;25&quot;] [msg &quot;Anomaly Score Exceeded (score 31): 900043-Detects
classic SQL injection probings 2/2&quot;]

What is the best way to resolve this so the application works while
still preventing real SQL Injection attempts?

regards

Tim
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000515.html">[Owasp-modsecurity-core-rule-set] New ModSecurity FAQ Page and	Project Updates
</A></li>
	<LI>Next message: <A HREF="000518.html">[Owasp-modsecurity-core-rule-set] False positive?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#516">[ date ]</a>
              <a href="thread.html#516">[ thread ]</a>
              <a href="subject.html#516">[ subject ]</a>
              <a href="author.html#516">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
