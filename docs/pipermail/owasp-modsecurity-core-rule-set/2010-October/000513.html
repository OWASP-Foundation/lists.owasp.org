<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Anyone using the Correlated Event	Data?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Anyone%20using%20the%20Correlated%20Event%0A%09Data%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000512.html">
   <LINK REL="Next"  HREF="000514.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Anyone using the Correlated Event	Data?</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Anyone%20using%20the%20Correlated%20Event%0A%09Data%3F&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Anyone using the Correlated Event	Data?">RBarnett at trustwave.com
       </A><BR>
    <I>Fri Oct  8 09:27:55 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000512.html">[Owasp-modsecurity-core-rule-set] Call for Assistance:	ModSecurity/CRS Event Data Statistics
</A></li>
        <LI>Next message: <A HREF="000514.html">[Owasp-modsecurity-core-rule-set] New ModSecurity FAQ Page and	Project Updates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#513">[ date ]</a>
              <a href="thread.html#513">[ thread ]</a>
              <a href="subject.html#513">[ subject ]</a>
              <a href="author.html#513">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As I am receiving ModSec CRS Event Stats from the community (thanks to everyone who is helping with this effort), I am seeing many of the new inbound/outbound event correlation entries being generated.  Here is an example -

Correlated Successful Attack Identified: (Total Score: 25, SQLi=, XSS=) Inbound Attack (SQL Injection Attack - Inbound Anomaly Score: 25) + Outbound Data Leakage (SQL Information Leakage - Outbound
Anomaly Score: 30)

&gt;<i>From the Documentation link on the project site -
</I><A HREF="http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project#tab=Documentation">http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project#tab=Documentation</A>

Inbound/Outbound Correlation
After the transaction has completed (in the logging phase), the rules in the base_rules/modsecurity_crs_60_correlation.conf file will conduct further post-processing by analyzing any inbound events with any outbound events in order to provide a more intelligent/priority correlated event.

- Was there an inbound attack?
- Was there an HTTP Status Code Error (4xx/5xx level)?
- Was there an application information leak?

If an inbound attack was detected and either an outbound application status code error or infolead was detected, then the overall event severity is raised -

- 0: Emergency - is generated from correlation where there is an inbound attack and   an outbound leakage.
- 1: Alert - is generated from correlation where there is an inbound attack and an outbound application level error.

A question for the community, the rationale for adding in the inbound/outbound correlation concept was to try and help users to prioritize alert investigations.  Obviously, the correlated events should be looked at first!  Is anyone actually using this feature?  Has it helped you with doing incident response, etc...?

Please let me know as I would love to hear real user feedback on this.

Thanks,
Ryan





</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000512.html">[Owasp-modsecurity-core-rule-set] Call for Assistance:	ModSecurity/CRS Event Data Statistics
</A></li>
	<LI>Next message: <A HREF="000514.html">[Owasp-modsecurity-core-rule-set] New ModSecurity FAQ Page and	Project Updates
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#513">[ date ]</a>
              <a href="thread.html#513">[ thread ]</a>
              <a href="subject.html#513">[ subject ]</a>
              <a href="author.html#513">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
