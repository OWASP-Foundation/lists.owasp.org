From chaim at chaimsanders.com  Mon Apr  2 18:17:40 2018
From: chaim at chaimsanders.com (Chaim Sanders)
Date: Mon, 2 Apr 2018 14:17:40 -0400
Subject: [Owasp-modsecurity-core-rule-set] Monthly OWASP CRS Meeting Today
Message-ID: <CAE8hE=rwsn8LtVqWDimA-39HEfVFnyrQf-fJ7QBFyaREDOiGVQ@mail.gmail.com>

This is a reminder that our monthly OWASP CRS meeting will be held today on
IRC (#modsecurity on free node) in 15 minutes (2:30 EST). Everyone is
welcome. If you have something you'd like to discuss please add it to the
agenda (https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/1051).
Thank you.

-- 
-- 
Chaim Sanders
http://www.ChaimSanders.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180402/8b5953c7/attachment.html>

From airween at gmail.com  Thu Apr 19 20:07:32 2018
From: airween at gmail.com (=?UTF-8?Q?Ervin_Heged=C3=BCs?=)
Date: Thu, 19 Apr 2018 22:07:32 +0200
Subject: [Owasp-modsecurity-core-rule-set] File upload problem
In-Reply-To: <20170823073030.GA21794@arxnet.hu>
References: <20170823073030.GA21794@arxnet.hu>
Message-ID: <CAJ2uXbfqU+GGm0z49HfKgrbvyDM8jLJKNBz3LR-XQYRfcYEFLw@mail.gmail.com>

Hi all,

just fyi,


I've found the bug in multipart handler in libmodsecurity, and created a
new PR:
https://github.com/SpiderLabs/ModSecurity/pull/1747

Hope that it will be merged.


Regards,


a.



On Wed, Aug 23, 2017 at 9:30 AM, Ervin Heged?s <airween at gmail.com> wrote:

> Hi folks,
>
> here is a new problem with CRS 3.0(.2). There is an nGinx with
> Modsecurity 3.0, and CRS 3.0.2, and an Apache backend, which
> serves a webmail (Roundcube).
>
> When I try to import my GPG key through the upload, I got 403
> Forbidden answer.
>
> Here are the details:
>
> HTTP req:
>
> POST https://webmail.mydomain.com/?_task=settings&_action=plugin.
> enigmakeys&_a=import&_unlock=loading1503472197200
> ...
> Content-Length  4443
> Content-Type    multipart/form-data; boundary=---------------------------
> 186567636118947579521451609378
>
>
> HTTP resp:
>
> 403 Forbidden
>
> Content of audit.log:
>
> ---3U4kCbBk---A--
> [23/Aug/2017:09:10:32 +0200] 15034722321.000000 client.ip.addr 51048
> client.ip.addr 443
> ---3U4kCbBk---B--
> POST /?_task=settings&_action=plugin.enigmakeys&_a=import&_
> unlock=loading1503472197200
> HTTP/1.1
> Connection: keep-alive
> Referer: https://webmail.mydomain.com/?_task=settings&_framed=1&_
> action=plugin.enigmakeys&_a=import
> Content-Type: multipart/form-data; boundary=---------------------------
> 186567636118947579521451609378
> Accept-Encoding: gzip, deflate, br
> Cookie: language=hu; _ga=GA1.2.817NNNNNN.14NNNNNNNN; roundcube_sessid=sessionidtoken;
> roundcube_sessauth=sessauthidtoken
> Content-Length: 4443
> Accept-Language: hu-HU,hu;q=0.8,en-US;q=0.5,en;q=0.3
> Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
> User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:55.0)
> Gecko/20100101 Firefox/55.0
> Host: webmail.mydomain.com
> Upgrade-Insecure-Requests: 1
>
> ---3U4kCbBk---D--
>
> ---3U4kCbBk---E--
> ??(??????HML??)?,?I?310Vp?/J?LII?
> ...
> ...
> ---3U4kCbBk---F--
> Server: nginx/1.6.2
> Date: Wed, 23 Aug 2017 07:10:32 GMT
> Content-Type: text/html
> Connection: keep-alive
> Content-Encoding: gzip
>
> ---3U4kCbBk---H--
> ModSecurity: Warning. Matched "Operator `Eq' with parameter `0' against
> variable `MULTIPART_UNMATCHED_BOUNDARY' (Value: `1' ) [file
> "/etc/nginx/modsecurity.conf"] [line "66"] [id "200004"] [rev ""] [msg
> "Multipart parser detected a possible unmatched boundary."] [data ""]
> [severity "0"] [ver ""] [maturity "0"] [accuracy "0"] [ref "v810,1"]
>
> ---3U4kCbBk---I--
>
> ---3U4kCbBk---J--
>
> ---3U4kCbBk---Z--
>
>
> Here is the detail of POST request:
>
> -----------------------------186567636118947579521451609378
> Content-Disposition: form-data; name="_token"
>
> nEWGe3VUF9R1K7d0SSx4rZRYkYeN849B
> -----------------------------186567636118947579521451609378
> Content-Disposition: form-data; name="_framed"
>
> 1
> -----------------------------186567636118947579521451609378
> Content-Disposition: form-data; name="_file"; filename="airween_at_gmail.
> com.asc"
> Content-Type: text/plain
>
> -----BEGIN PGP PUBLIC KEY BLOCK-----
> Version: GnuPG v1
>
> mQINBFhwuigBEAC+gnmOXXTEtedn5hqcjLirPM6phHGLdeqVUsD0sRDWFjgcoh7b
> ...
> =G+Dl
> -----END PGP PUBLIC KEY BLOCK-----
>
> -----------------------------186567636118947579521451609378
> Content-Disposition: form-data; name="_search"
>
>
> -----------------------------186567636118947579521451609378--
>
>
>
>
> This error occures when I upload the .asc file above, when I try
> to upload a "simple" csv, or png, everything works as well.
>
>
>
> What should I do? How can I fix this error?
>
>
>
> Thanks,
>
>
> a.
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180419/2021a203/attachment.html>

From jai.harpalani at mulesoft.com  Tue Apr 24 18:56:15 2018
From: jai.harpalani at mulesoft.com (Jai Harpalani)
Date: Tue, 24 Apr 2018 13:56:15 -0500
Subject: [Owasp-modsecurity-core-rule-set] XML Parsing
Message-ID: <CANExQKsyXF_V3wmw87vQbtRfiV71qrN+7N512j9thB6_7Mo8sg@mail.gmail.com>

I would like to disable XML parsing. If I do so, will rules such as the one
below not get evaluated against the body of the request?

SecRule ARGS_NAMES|ARGS|XML:/* "(?:\n|\r)+(?:get|post|head|op
tions|connect|put|delete|trace|propfind|propatch|mkcol|copy|move|lock|unlock)\s+"
\
    "msg:'HTTP Request Smuggling Attack',\
    phase:request,\
    id:921110,\
    rev:'1',\
     . . .

Is this rule only valid for ARGS_NAMES, ARGS, and parsed XML? Seems like it
should also be applied to request bodies even if they are not XML bodies.
Please clarify.

Thanks.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180424/6f97cef2/attachment.html>

From Hiranmayi.Palanki at aexp.com  Wed Apr 25 14:59:20 2018
From: Hiranmayi.Palanki at aexp.com (Hiranmayi Palanki)
Date: Wed, 25 Apr 2018 14:59:20 +0000
Subject: [Owasp-modsecurity-core-rule-set] Performance Impacts with Paranoia
	Levels
Message-ID: <a3390662102a4097be3fdd01c8fb5539@BL2PR9302MB0003.024d.mgd.msft.net>

Hello Christian and team:

Would like to get the community's thoughts on performance impacts associated with each Paranoia Level.

In performance benchmark tests that we have done so far, PL4 is resulting in a significant performance impact, but is the most effective in blocking encoded XSS and SQLi attacks.

The lower Paranoia Levels are resulting in XSS and SQLi bypasses.

For a production deployment, which Paranoia Levels are folks implementing to optimize performance?

Thanks.


American Express made the following annotations
******************************************************************************
"This message and any attachments are solely for the intended recipient and may contain confidential or privileged information. If you are not the intended recipient, any disclosure, copying, use, or distribution of the information included in this message and any attachments is prohibited. If you have received this communication in error, please notify us by reply e-mail and immediately and permanently delete this message and any attachments. Thank you."

American Express a ajout? le commentaire suivant le Ce courrier et toute pi?ce jointe qu'il contient sont r?serv?s au seul destinataire indiqu? et peuvent renfermer des 
renseignements confidentiels et privil?gi?s. Si vous n'?tes pas le destinataire pr?vu, toute divulgation, duplication, utilisation ou distribution du courrier ou de toute pi?ce jointe est interdite. Si vous avez re?u cette communication par erreur, veuillez nous en aviser par courrier et d?truire imm?diatement le courrier et les pi?ces jointes. Merci.

******************************************************************************
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20180425/37d4ca46/attachment.html>

