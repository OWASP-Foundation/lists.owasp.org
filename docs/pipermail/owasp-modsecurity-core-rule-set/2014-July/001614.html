<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] What is client doing to trigger	SQL Tautology?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20client%20doing%20to%20trigger%0A%09SQL%20Tautology%3F&In-Reply-To=%3C53CF7A3A.8000801%40certitrade.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001612.html">
   <LINK REL="Next"  HREF="001615.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] What is client doing to trigger	SQL Tautology?</H1>
    <B>Logg</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20client%20doing%20to%20trigger%0A%09SQL%20Tautology%3F&In-Reply-To=%3C53CF7A3A.8000801%40certitrade.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] What is client doing to trigger	SQL Tautology?">logg at certitrade.net
       </A><BR>
    <I>Wed Jul 23 09:02:50 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001612.html">[Owasp-modsecurity-core-rule-set] Errors
</A></li>
        <LI>Next message: <A HREF="001615.html">[Owasp-modsecurity-core-rule-set] What is client doing to trigger SQL Tautology?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1614">[ date ]</a>
              <a href="thread.html#1614">[ thread ]</a>
              <a href="subject.html#1614">[ subject ]</a>
              <a href="author.html#1614">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello

We are running a payment system used by webshops. Now one new client 
gets a 403, I want to find out why so I can help client to configure 
their shop correctly.
modsec logs tell me what rule is triggered, but I can't read out what 
data the client sends in.
This only happens to this new client, so I will not modify my ruleset. I 
just need to assist our client who is obviously doing something wrong.

    [22/Jul/2014:13:10:37 +0200] U85GrQpABwsAAGYtLgkAAAAC 10.64.7.5
    49941 10.64.7.11 443
    --ed091d42-B--
    POST /webshophtml/e/auth.php HTTP/1.1
    Host: our.payment.net
    Connection: keep-alive
    Content-Length: 951
    Cache-Control: max-age=0
    Accept:
    text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
    Origin: <A HREF="http://client_webshop.se">http://client_webshop.se</A>
    User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36
    (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36
    Content-Type: application/x-www-form-urlencoded
    Referer: <A HREF="http://client_webshop.se/checkout.php?sl=0&amp;st=0">http://client_webshop.se/checkout.php?sl=0&amp;st=0</A>
    Accept-Encoding: gzip,deflate,sdch
    Accept-Language: sv-SE,sv;q=0.8,en-US;q=0.6,en;q=0.4
    Cookie: _jss_popform_1524_count=1;
    _jss_pstor=id%3Dda15bb533c3296281a7a3bad96266f93%3Afi%3D1404769754%3Ali%3D1404770148%3Aic%3D5%3Avc%3D1%3Anc%3D9f3d16019cf6fe2b%3A19f22ab828ca19a9cac8b0eed51911c0;
    __utma=188767033.1851339114.1404769702.1404769702.1404769702.1;
    __utmz=188767033.1404769702.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
    X-Forwarded-For: #.#.#.#

    --ed091d42-F--
    HTTP/1.1 403 Forbidden
    Content-Length: 224
    Keep-Alive: timeout=5, max=100
    Connection: Keep-Alive
    Content-Type: text/html; charset=iso-8859-1

    --ed091d42-E--

    --ed091d42-H--
    Message: Access denied with code 403 (phase 2). Pattern match
    &quot;(?i:([\\s'\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)([\\d\\w]++)([\\s'\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)(?:(?:=|&lt;=&gt;|r?like|sounds\\s+like|regexp)([\\s'\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\2|(?:!=|&lt;=|&gt;=|&lt;&gt;|&lt;|&gt;|\\^|is\\s+not|not\\
    ...&quot; at REQUEST_COOKIES:_jss_pstor. [file
    &quot;sec_rules/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] [line
    &quot;77&quot;] [id &quot;950901&quot;] [rev &quot;2&quot;] [msg &quot;SQL Injection Attack: SQL
    Tautology Detected.&quot;] [data &quot;Matched Data: d=d found within
    REQUEST_COOKIES:_jss_pstor:
    id=da15bb533c3296281a7a3bad96266f93:fi=1404769754:li=1404770148:ic=5:vc=1:nc=9f3d16019cf6fe2b:19f22ab828ca19a9cac8b0eed51911c0&quot;]
    [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/2.2.7&quot;] [maturity &quot;9&quot;]
    [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;] [tag
    &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag
    &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;]
    Action: Intercepted (phase 2)
    Apache-Handler: php5-script
    Stopwatch: 1406027437541081 3150 (- - -)
    Stopwatch2: 1406027437541081 3150; combined=1945, p1=330, p2=1581,
    p3=0, p4=0, p5=33, sr=99, sw=1, l=0, gc=0
    Response-Body-Transformed: Dechunked
    Producer: ModSecurity for Apache/2.8.0
    (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); OWASP_CRS/2.2.7.
    Server: Apache
    Engine-Mode: &quot;ENABLED&quot;

Regards
Peter Haraldson
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140723/56a60763/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140723/56a60763/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001612.html">[Owasp-modsecurity-core-rule-set] Errors
</A></li>
	<LI>Next message: <A HREF="001615.html">[Owasp-modsecurity-core-rule-set] What is client doing to trigger SQL Tautology?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1614">[ date ]</a>
              <a href="thread.html#1614">[ thread ]</a>
              <a href="subject.html#1614">[ subject ]</a>
              <a href="author.html#1614">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
