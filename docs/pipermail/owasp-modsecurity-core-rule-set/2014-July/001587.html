<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] FALSE POSITIVE
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20FALSE%20POSITIVE&In-Reply-To=%3CC310131DD0004743B2508B65C77B66314024D82C%40PMEXGMB04.juniper.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001586.html">
   <LINK REL="Next"  HREF="001589.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] FALSE POSITIVE</H1>
    <B>Thayyilekandy, Subin : Barclaycard US</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20FALSE%20POSITIVE&In-Reply-To=%3CC310131DD0004743B2508B65C77B66314024D82C%40PMEXGMB04.juniper.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] FALSE POSITIVE">sthayyilekan at BarclaycardUS.com
       </A><BR>
    <I>Wed Jul  2 14:57:21 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001586.html">[Owasp-modsecurity-core-rule-set] FALSE POSITIVE
</A></li>
        <LI>Next message: <A HREF="001589.html">[Owasp-modsecurity-core-rule-set] FALSE POSITIVE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1587">[ date ]</a>
              <a href="thread.html#1587">[ thread ]</a>
              <a href="subject.html#1587">[ subject ]</a>
              <a href="author.html#1587">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If data_567 will always have the Url data you can do in your custom rules file (AFTER the CRS rules)

SecRuleUpdateTargetById 950120!ARGS: data_567

Or conditionally check the url particular to this request and allow the parameter in your custom rules file (BRFORE the CRS rules)


SecRule REQUEST_FILENAME &quot;@rx /XXX/Register\.action&quot; &quot;id:999008,phase:2,t:none,nolog,pass,ctl:ruleRemoveTargetById=950120;ARGS: data_567 &quot;



Thanks

Subin
Application Security consultant | GISTR

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Ilyass Kaouam
Sent: Wednesday, July 02, 2014 6:08 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: [Owasp-modsecurity-core-rule-set] FALSE POSITIVE

Hello,

Our website is a directory that is to say we always have users who insert their data such as the URL of their website, t&#233;lephonen, fax ...
during validation by our team I noticed that the mo_security to prohibit the request because it contains URL: <A HREF="http://www.companyhacham.sitew.com/">http://www.companyhacham.sitew.com/</A>

Do you have a solution (secure) to allow url ?

Thank you

log:


codeAction=1&amp;entid=395342&amp;bilid=345129&amp;idMkt=518&amp;denomination=&amp;capital=100+000+&amp;activite=COMPANY+HACHAM+offre+des+produits+et+services+de+grande+qualit%C3%A9+dans+les+domaines+de+%3A+Menuiserie+Aluminium%2C+PVC%2C+Inox%2C+Vitrine+en+Verre%2C+Cloisons+aluminium%2C+Cuisine+Moderne+Sur+Mesure%2C+Tablier+en+lames+Micro+perfor%C3%A9es%2C+Habillage+de+Fa%C3%A7ade.+(ALUCOBOND)%2C+Faux+Plafonds%2C+Mur+Rideau%2C+Moustiquaire%2C+les+Stores%2C+Travaux+divers.&amp;effectif=0&amp;effectifCadre=0&amp;segmentEffectif=1&amp;dateContribution=06%2F08%2F13+14%3A32&amp;loginUser=sgh5%40hotmail.fr&lt;<A HREF="http://40hotmail.fr/">http://40hotmail.fr/</A>&gt;&amp;emailUser=sgh5%40hotmail.fr&lt;<A HREF="http://40hotmail.fr/">http://40hotmail.fr/</A>&gt;&amp;id=518&amp;denomination_validator=&amp;rc_validator=&amp;tribunal_validator=&amp;fmj_validator=&amp;capital_validator=&amp;adresse_validator=&amp;ville_validator=&amp;activite_validator=&amp;effectif_validator=&amp;segmentEffectif_validator=&amp;effectifCadre_validator=&amp;telfaxmailweb_565=on&amp;telfaxmailweb_565_validator=1&amp;data_565=0618555477&amp;type_565=1&amp;idMktTelfaxmailweb_565=0&amp;telfaxmailweb_566=on&amp;telfaxmailweb_566_validator=1&amp;data_566=companyhacham%40gmail.com&lt;<A HREF="http://40gmail.com/">http://40gmail.com/</A>&gt;&amp;type_566=3&amp;idMktTelfaxmailweb_566=0&amp;telfaxmailweb_567=on&amp;telfaxmailweb_567_validator=1&amp;data_567=http%3A%2F%2Fwww.companyhacham.sitew.com&lt;<A HREF="http://www.companyhacham.sitew.com/">http://www.companyhacham.sitew.com/</A>&gt;%2F&amp;type_567=4&amp;idMktTelfaxmailweb_567=0&amp;statut=1&amp;remarque=

--c307bc39-F--

HTTP/1.1 403 Forbidden

Content-Length: 245

Connection: close

Content-Type: text/html; charset=iso-8859-1



Message: Access denied with code 403 (phase 2). Match of &quot;beginsWith %{request_headers.host}&quot; against &quot;TX:1&quot; required. [file &quot;/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;] [line &quot;163&quot;] [id &quot;950120&quot;] [rev &quot;3&quot;] [msg &quot;Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link&quot;] [data &quot;Matched Data: <A HREF="http://www.companyhacham.sitew.com/">http://www.companyhacham.sitew.com/</A> found within TX:1:www.companyhacham.sitew.com/&lt;<A HREF="http://www.companyhacham.sitew.com/">http://www.companyhacham.sitew.com/</A>&gt;&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;9&quot;] [accuracy &quot;9&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/RFI&quot;]

Barclaycard
www.barclaycardus.com 

This email and any files transmitted with it may contain confidential and/or proprietary information. It is intended solely for the use of the individual or entity who is the intended recipient. Unauthorized use of this information is prohibited. If you have received this in error, please contact the sender by replying to this message and delete this material from any system it may be on.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140702/7711c572/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140702/7711c572/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001586.html">[Owasp-modsecurity-core-rule-set] FALSE POSITIVE
</A></li>
	<LI>Next message: <A HREF="001589.html">[Owasp-modsecurity-core-rule-set] FALSE POSITIVE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1587">[ date ]</a>
              <a href="thread.html#1587">[ thread ]</a>
              <a href="subject.html#1587">[ subject ]</a>
              <a href="author.html#1587">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
