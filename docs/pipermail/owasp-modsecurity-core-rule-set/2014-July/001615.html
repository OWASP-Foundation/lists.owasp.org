<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] What is client doing to trigger SQL Tautology?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20client%20doing%20to%0A%20trigger%20SQL%20Tautology%3F&In-Reply-To=%3C53CF84EC.8070401%40certitrade.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001614.html">
   <LINK REL="Next"  HREF="001617.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] What is client doing to trigger SQL Tautology?</H1>
    <B>Logg</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20client%20doing%20to%0A%20trigger%20SQL%20Tautology%3F&In-Reply-To=%3C53CF84EC.8070401%40certitrade.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] What is client doing to trigger SQL Tautology?">logg at certitrade.net
       </A><BR>
    <I>Wed Jul 23 09:48:28 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001614.html">[Owasp-modsecurity-core-rule-set] What is client doing to trigger	SQL Tautology?
</A></li>
        <LI>Next message: <A HREF="001617.html">[Owasp-modsecurity-core-rule-set] Spam: OWASP CRS: Request-method and	content-type rules don't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1615">[ date ]</a>
              <a href="thread.html#1615">[ thread ]</a>
              <a href="subject.html#1615">[ subject ]</a>
              <a href="author.html#1615">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you Josh, but I don't really want to create an exception.
Since it's just one client that triggers this, it's better to help him 
configure payment settings for his shop.
So the question would be Where does that &quot;d=d&quot; come from, I can see it's 
in a cookie but why?

Regards
Peter

2014-07-23 11:41, Josh Amishav-Zlatin skrev:
&gt;<i> On Wed, Jul 23, 2014 at 12:02 PM, Logg &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">logg at certitrade.net</A> 
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">logg at certitrade.net</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     Hello
</I>&gt;<i>
</I>&gt;<i>     We are running a payment system used by webshops. Now one new
</I>&gt;<i>     client gets a 403, I want to find out why so I can help client to
</I>&gt;<i>     configure their shop correctly.
</I>&gt;<i>     modsec logs tell me what rule is triggered, but I can't read out
</I>&gt;<i>     what data the client sends in.
</I>&gt;<i>     This only happens to this new client, so I will not modify my
</I>&gt;<i>     ruleset. I just need to assist our client who is obviously doing
</I>&gt;<i>     something wrong.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> If you look at section H below, the _jss_pstor cookie contains the 
</I>&gt;<i> string d=d which created a false positive on rule 950901. You can use 
</I>&gt;<i> the SecRuleUpdateTargetById directive to create an exception 
</I>&gt;<i> (e.g. SecRuleUpdateTargetById 950901 !REQUEST_COOKIES:_jss_pstor).
</I>&gt;<i>
</I>&gt;<i> - Josh
</I>&gt;<i>
</I>&gt;<i>         [22/Jul/2014:13:10:37 +0200] U85GrQpABwsAAGYtLgkAAAAC
</I>&gt;<i>         10.64.7.5 49941 10.64.7.11 443
</I>&gt;<i>         --ed091d42-B--
</I>&gt;<i>         POST /webshophtml/e/auth.php HTTP/1.1
</I>&gt;<i>         Host: our.payment.net &lt;<A HREF="http://our.payment.net">http://our.payment.net</A>&gt;
</I>&gt;<i>         Connection: keep-alive
</I>&gt;<i>         Content-Length: 951
</I>&gt;<i>         Cache-Control: max-age=0
</I>&gt;<i>         Accept:
</I>&gt;<i>         text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
</I>&gt;<i>         Origin: <A HREF="http://client_webshop.se">http://client_webshop.se</A>
</I>&gt;<i>         User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64)
</I>&gt;<i>         AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125
</I>&gt;<i>         Safari/537.36
</I>&gt;<i>         Content-Type: application/x-www-form-urlencoded
</I>&gt;<i>         Referer: <A HREF="http://client_webshop.se/checkout.php?sl=0&amp;st=0">http://client_webshop.se/checkout.php?sl=0&amp;st=0</A>
</I>&gt;<i>         Accept-Encoding: gzip,deflate,sdch
</I>&gt;<i>         Accept-Language: sv-SE,sv;q=0.8,en-US;q=0.6,en;q=0.4
</I>&gt;<i>         Cookie: _jss_popform_1524_count=1;
</I>&gt;<i>         _jss_pstor=id%3Dda15bb533c3296281a7a3bad96266f93%3Afi%3D1404769754%3Ali%3D1404770148%3Aic%3D5%3Avc%3D1%3Anc%3D9f3d16019cf6fe2b%3A19f22ab828ca19a9cac8b0eed51911c0;
</I>&gt;<i>         __utma=188767033.1851339114.1404769702.1404769702.1404769702.1; __utmz=188767033.1404769702.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
</I>&gt;<i>         X-Forwarded-For: #.#.#.#
</I>&gt;<i>
</I>&gt;<i>         --ed091d42-F--
</I>&gt;<i>         HTTP/1.1 403 Forbidden
</I>&gt;<i>         Content-Length: 224
</I>&gt;<i>         Keep-Alive: timeout=5, max=100
</I>&gt;<i>         Connection: Keep-Alive
</I>&gt;<i>         Content-Type: text/html; charset=iso-8859-1
</I>&gt;<i>
</I>&gt;<i>         --ed091d42-E--
</I>&gt;<i>
</I>&gt;<i>         --ed091d42-H--
</I>&gt;<i>         Message: Access denied with code 403 (phase 2). Pattern match
</I>&gt;<i>         &quot;(?i:([\\s'\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)([\\d\\w]++)([\\s'\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)(?:(?:=|&lt;=&gt;|r?like|sounds\\s+like|regexp)([\\s'\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\2|(?:!=|&lt;=|&gt;=|&lt;&gt;|&lt;|&gt;|\\^|is\\s+not|not\\
</I>&gt;<i>         ...&quot; at REQUEST_COOKIES:_jss_pstor. [file
</I>&gt;<i>         &quot;sec_rules/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;]
</I>&gt;<i>         [line &quot;77&quot;] [id &quot;950901&quot;] [rev &quot;2&quot;] [msg &quot;SQL Injection
</I>&gt;<i>         Attack: SQL Tautology Detected.&quot;] [data &quot;Matched Data: d=d
</I>&gt;<i>         found within REQUEST_COOKIES:_jss_pstor:
</I>&gt;<i>         id=da15bb533c3296281a7a3bad96266f93:fi=1404769754:li=1404770148:ic=5:vc=1:nc=9f3d16019cf6fe2b:19f22ab828ca19a9cac8b0eed51911c0&quot;]
</I>&gt;<i>         [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/2.2.7&quot;] [maturity &quot;9&quot;]
</I>&gt;<i>         [accuracy &quot;8&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;] [tag
</I>&gt;<i>         &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag
</I>&gt;<i>         &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;]
</I>&gt;<i>         Action: Intercepted (phase 2)
</I>&gt;<i>         Apache-Handler: php5-script
</I>&gt;<i>         Stopwatch: 1406027437541081 3150 (- - -)
</I>&gt;<i>         Stopwatch2: 1406027437541081 3150; combined=1945, p1=330,
</I>&gt;<i>         p2=1581, p3=0, p4=0, p5=33, sr=99, sw=1, l=0, gc=0
</I>&gt;<i>         Response-Body-Transformed: Dechunked
</I>&gt;<i>         Producer: ModSecurity for Apache/2.8.0
</I>&gt;<i>         (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); OWASP_CRS/2.2.7. &lt;<A HREF="http://2.2.7.">http://2.2.7.</A>&gt;
</I>&gt;<i>         Server: Apache
</I>&gt;<i>         Engine-Mode: &quot;ENABLED&quot;
</I>&gt;<i>
</I>&gt;<i>     Regards
</I>&gt;<i>     Peter Haraldson
</I>&gt;<i>
</I>&gt;<i>     _______________________________________________
</I>&gt;<i>     Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i>     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i>     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140723/543e0fff/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140723/543e0fff/attachment-0001.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001614.html">[Owasp-modsecurity-core-rule-set] What is client doing to trigger	SQL Tautology?
</A></li>
	<LI>Next message: <A HREF="001617.html">[Owasp-modsecurity-core-rule-set] Spam: OWASP CRS: Request-method and	content-type rules don't work
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1615">[ date ]</a>
              <a href="thread.html#1615">[ thread ]</a>
              <a href="subject.html#1615">[ subject ]</a>
              <a href="author.html#1615">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
