<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Virtual Patch for PHP Vuln
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Virtual%20Patch%20for%20PHP%20Vuln&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000159.html">
   <LINK REL="Next"  HREF="000161.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Virtual Patch for PHP Vuln</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Virtual%20Patch%20for%20PHP%20Vuln&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Virtual Patch for PHP Vuln">ryan.barnett at breach.com
       </A><BR>
    <I>Fri Nov 20 16:16:06 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000159.html">[Owasp-modsecurity-core-rule-set] Documentation
</A></li>
        <LI>Next message: <A HREF="000161.html">[Owasp-modsecurity-core-rule-set] False positive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#160">[ date ]</a>
              <a href="thread.html#160">[ thread ]</a>
              <a href="subject.html#160">[ subject ]</a>
              <a href="author.html#160">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>For those of you running php and who were not aware, there is a new release 
out - <A HREF="http://www.php.net/releases/5_3_1.php">http://www.php.net/releases/5_3_1.php</A>

One of the fixes is a patch for a DoS condition as outlined here -
<A HREF="http://www.acunetix.com/blog/websecuritynews/php-multipartform-data-denial-of-">http://www.acunetix.com/blog/websecuritynews/php-multipartform-data-denial-of-</A>
service/

Just wanted to pass along some virtual patch info in case you can't upgrade 
your systems quickly.  Since the DoS condition has to do with the way that PHP 
handles file uploads, you can create a modsecurity rule that mimics the new PHP 
max_file_uploads INI directive - 

SecRule &amp;FILES &quot;@gt 20&quot; &quot;phase:2,t:none,log,deny,msg:'Max number of file 
uploads exceeded',logdata:'Number of files: %{matched_var}'&quot;

The CRS already has the modsecurity_crs_23_request_limits.conf file with some 
example File Upload limit rules commented out.  If everyone thinks this would 
be a valuable rule to include in the distro let me know, otherwise I suggest 
that PHP users who want to use this rule add to their own custom rules file.

Hope this helps.

--
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
<A HREF="http://tacticalwebappsec.blogspot.com">http://tacticalwebappsec.blogspot.com</A>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000159.html">[Owasp-modsecurity-core-rule-set] Documentation
</A></li>
	<LI>Next message: <A HREF="000161.html">[Owasp-modsecurity-core-rule-set] False positive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#160">[ date ]</a>
              <a href="thread.html#160">[ thread ]</a>
              <a href="subject.html#160">[ subject ]</a>
              <a href="author.html#160">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
