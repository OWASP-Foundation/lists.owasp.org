<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Documentation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Documentation&In-Reply-To=8A1B4B015C52A54886DF15E9A97C7FB9F7298EFB%40MONET.utopiasystems.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000157.html">
   <LINK REL="Next"  HREF="000159.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Documentation</H1>
    <B>andy.p.smith at ba.com</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Documentation&In-Reply-To=8A1B4B015C52A54886DF15E9A97C7FB9F7298EFB%40MONET.utopiasystems.net"
       TITLE="[Owasp-modsecurity-core-rule-set] Documentation">andy.p.smith at ba.com
       </A><BR>
    <I>Thu Nov 12 08:11:05 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000157.html">[Owasp-modsecurity-core-rule-set] Documentation
</A></li>
        <LI>Next message: <A HREF="000159.html">[Owasp-modsecurity-core-rule-set] Documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#158">[ date ]</a>
              <a href="thread.html#158">[ thread ]</a>
              <a href="subject.html#158">[ subject ]</a>
              <a href="author.html#158">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ryan,

        Thanks for your response. What I was trying to get at and maybe 
didn't explain myself very well, is that I'm trying to decide whether or 
not I should simply write an exception, or whether or not the 
false/positive requires an application code review. Without the 
rational/documentation behind the rule that's an extremely difficult call 
to make. (I.E using the rule I below as an example which triggered on the 
word &quot;back&quot; within the Request_Body.) Or am I simply missing the point and 
the standard procedure should simply be to write an exception for each 
false/positive?

Best regards Andy



Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at breach.com</A>&gt; 
12/11/2009 12:14

To
&quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">andy.p.smith at ba.com</A>&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">andy.p.smith at ba.com</A>&gt;
&quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&quot; 
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
cc

Subject
Re: [Owasp-modsecurity-core-rule-set] Documentation






Andy-
With the current CRS one of our goals was to make it easier for users to 
handle false positive changes *externally* from the rules themselves. Most 
users did want to edit rules directly for fear of munging a regex or if 
they did heavy customizations then they wouldn't want to upgrade ;)

The way we addressed this was to have the rules set TX variables that hold 
metadata about the match. With this approach, you can create exceptions in 
the 48 local exceptions file that can inspect TX data for the false 
positive match and then simply expire the variable and/or adjust the 
anomaly score.

To your direct question about the intent of this exact rule - this is an 
imported phpids rule which was developed from community testing with their 
demo page. If you want details about the regex logic - I suggest you pop 
it into something like Expresso and it will give info.


Ryan C. Barnett 
Director of Application Security Research 
Breach Security, Inc. 
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at Breach.com</A> 
www.Breach.com 
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> 
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A> 
Sent: Thu Nov 12 06:37:49 2009
Subject: [Owasp-modsecurity-core-rule-set] Documentation 

Hi All, 

        I am a new to mod_security and have just started to test some of 
our external facing applications against the latest realease of 
mod_security and the latest OWASP CRS, (2.0.3). Whilst I am seeing a fair 
number of false positives, mainly againast Request_Body checking, which 
was to be expected, I'm struggling to ascertain what the best path forward 
is for each false positive, based on the rational that I don't know why 
each rule has been written the way it is. Does anybody know if there is 
any documentation, other than just the comments within the ruleset, which 
further describe the rational behind the regex and literal expressions 
tracked within each rule? 

        An example of a rule that seems to be hit a large number of times 
is line 93 from &quot;modsecurity_crs_41_phpids_filters.conf&quot; 

SecRule 
REQUEST_BODY|REQUEST_URI_RAW|ARGS|ARGS_NAMES|FILES|FILES_NAMES|XML:/* 
&quot;([^*:\s\w,.\/?+-]\s*)?(?&lt;![a-z]\s)(?&lt;![a-z\/_@&gt;\|])(\s*return\s*)?(?:hash|name|href|navigateandfind|source|pathname|close|constructor|port|protocol|assign|replace|back|forward|document|ownerdocument|window|self|parent|frames|_?content|date|cookie|innerhtml|innertext|csstext+?|outerhtml|print|moveby|resizeto|createstylesheet|stylesheets)(?(1)[^\w%\&quot;]|(?:\s*[^@\/\s\w%,.+\-]))&quot; 
&quot;phase:2,capture,multiMatch,t:none,t:urlDecodeUni,t:urlDecodeUni,t:htmlEntityDecode,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,nolog,auditlog,msg:'Detects 
JavaScript object properties and 
methods',id:'phpids-17',tag:'WEB_ATTACK',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}&quot; 


        I am finding many url strings that are matching the literals 
within this rule and could really do with some documentation to justify 
any action that I think is appropriate to my Information 
Assurance/Security department. 

Best regards Andy 

------------------------------------------------------------------------------------------------------------
Get the best from British Airways at ba.com
<A HREF="http://www.ba.com">http://www.ba.com</A>
--
This message is private and confidential and may also be legally 
privileged.  If you have received this message in error, please email it 
back to the sender and immediately permanently delete it from your 
computer system.  Please do not read, print, re-transmit, store or act in 
reliance on it or any attachments.

British Airways may monitor email traffic data and also the content of 
emails, where permitted by law, for the purposes of security and staff 
training and in order to prevent or detect unauthorised use of the British 
Airways email system.

Virus checking of emails (including attachments) is the responsibility of 
the recipient.

British Airways Plc is a public limited company registered in England and 
Wales.  Registered number: 1777777.  Registered office: Waterside, PO Box 
365, Harmondsworth, West Drayton, Middlesex, England, UB7 0GB.

Additional terms and conditions are available on our website: www.ba.com



------------------------------------------------------------------------------------------------------------
Get the best from British Airways at ba.com
<A HREF="http://www.ba.com">http://www.ba.com</A>

--
This message is private and confidential and may also be legally privileged.  If you have received this message in error, please email it back to the sender and immediately permanently delete it from your computer system.  Please do not read, print, re-transmit, store or act in reliance on it or any attachments.

British Airways may monitor email traffic data and also the content of emails, where permitted by law, for the purposes of security and staff training and in order to prevent or detect unauthorised use of the British Airways email system.

Virus checking of emails (including attachments) is the responsibility of the recipient.

British Airways Plc is a public limited company registered in England and Wales.  Registered number: 1777777.  Registered office: Waterside, PO Box 365, Harmondsworth, West Drayton, Middlesex, England, UB7 0GB.

Additional terms and conditions are available on our website: www.ba.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091112/7f6be616/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091112/7f6be616/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000157.html">[Owasp-modsecurity-core-rule-set] Documentation
</A></li>
	<LI>Next message: <A HREF="000159.html">[Owasp-modsecurity-core-rule-set] Documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#158">[ date ]</a>
              <a href="thread.html#158">[ thread ]</a>
              <a href="subject.html#158">[ subject ]</a>
              <a href="author.html#158">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
