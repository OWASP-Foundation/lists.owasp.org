<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [mod-security-users] Posting	HTML contents
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5Bmod-security-users%5D%20Posting%0A%09HTML%20contents&In-Reply-To=200911031429.14513.assistenza%40alfait.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000146.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [mod-security-users] Posting	HTML contents</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5Bmod-security-users%5D%20Posting%0A%09HTML%20contents&In-Reply-To=200911031429.14513.assistenza%40alfait.org"
       TITLE="[Owasp-modsecurity-core-rule-set] [mod-security-users] Posting	HTML contents">Ryan.Barnett at breach.com
       </A><BR>
    <I>Tue Nov  3 09:41:30 EST 2009</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000146.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] Posting	HTML contents
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#141">[ date ]</a>
              <a href="thread.html#141">[ thread ]</a>
              <a href="subject.html#141">[ subject ]</a>
              <a href="author.html#141">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Fabian,
This is a CRS issue so for future issues please use the OWASP CRS mail-list (<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>).  I am cross-posting this to both lists.

You bring up an important and challenging issue related to detecting XSS attacks and that is how to identify malicious payloads while still allowing benign html conent.  Here are a few items to consider -

1) For the CRS v2 - you can add some exception rules to the 48 local exceptions file so that you can adjust the anomaly score based on the authorized page/parameter you have for the FCKeditor app, etc...).  If you send some audit log data related to these html posts, I could show you a more specific exception example.

2) What language is your app written in?  If it is php - then you could look at installing something like htmlpurifier to help weed out bad html from good html - <A HREF="http://htmlpurifier.org/">http://htmlpurifier.org/</A>

3) On a similar front - look at something like the OWASP Anti-Sammy app.

Hope this helps,
Ryan

________________________________________
From: Fabian Martintoni [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">assistenza at alfait.org</A>]
Sent: Tuesday, November 03, 2009 8:29 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>
Subject: [mod-security-users] Posting HTML contents

Hi all,
today I've upgraded modsecurity to 2.5.10-r1 and more than half of my web
applications are giving me headache.

The more troublesome issue is (at least for now) that I cannot understand how
I can send HTML contents with a form...

For example... I have a form with an wysiwyg editor (FCKeditor, TinyMce etc)
how can I allow him to send his data? Every try is blocked by modsecurity:

[msg &quot;Detects obfuscated script tags and XML wrapped HTML&quot;]
[msg &quot;Detects basic directory traversal&quot;]
[msg &quot;finds attribute breaking injections including obfuscated attributes&quot;]
[msg &quot;finds html breaking injections including whitespace attacks&quot;]
[msg &quot;Detects possibly malicious html elements including some attributes&quot;]

I really need help on this thing, please.

Fabian

------------------------------------------------------------------------------
Come build with us! The BlackBerry(R) Developer Conference in SF, CA
is the only developer event you need to attend this year. Jumpstart your
developing skills, take BlackBerry mobile applications to market and stay
ahead of the curve. Join us from November 9 - 12, 2009. Register now!
<A HREF="http://p.sf.net/sfu/devconference">http://p.sf.net/sfu/devconference</A>
_______________________________________________
mod-security-users mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>
<A HREF="https://lists.sourceforge.net/lists/listinfo/mod-security-users">https://lists.sourceforge.net/lists/listinfo/mod-security-users</A>
Commercial ModSecurity Appliances, Rule Sets and Support:
<A HREF="http://www.modsecurity.org/breach/index.html">http://www.modsecurity.org/breach/index.html</A>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000146.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] Posting	HTML contents
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#141">[ date ]</a>
              <a href="thread.html#141">[ thread ]</a>
              <a href="subject.html#141">[ subject ]</a>
              <a href="author.html#141">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
