<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Excessive logging	in	audit.log and debug.log for modsecurity. How to deal?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Excessive%20logging%0A%09in%09audit.log%20and%20debug.log%20for%20modsecurity.%20How%20to%20deal%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000144.html">
   <LINK REL="Next"  HREF="000148.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Excessive logging	in	audit.log and debug.log for modsecurity. How to deal?</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Excessive%20logging%0A%09in%09audit.log%20and%20debug.log%20for%20modsecurity.%20How%20to%20deal%3F&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Excessive logging	in	audit.log and debug.log for modsecurity. How to deal?">Ryan.Barnett at breach.com
       </A><BR>
    <I>Tue Nov  3 13:02:09 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000144.html">[Owasp-modsecurity-core-rule-set] Excessive logging in	audit.log and debug.log for modsecurity. How to deal?
</A></li>
        <LI>Next message: <A HREF="000148.html">[Owasp-modsecurity-core-rule-set] &quot;document.gif&quot; got denied after update ModSecurity to 2.5.10 with Core Rules v2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#145">[ date ]</a>
              <a href="thread.html#145">[ thread ]</a>
              <a href="subject.html#145">[ subject ]</a>
              <a href="author.html#145">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Actually - that is what the correlated events in the error_log are supposed to do :)

We got a lot of feedback from users that said that they didn't like the old alerting as it was tough to weed through them all to prioritize them.

What we did was to reassign the severity ratings.  The most severe rating for an inbound attck alone is 2.  Only correlated events (that also factor in the http response codes and response body errors) can generate severities 1 (which indicates an attack + error status code) or 0 (which indicate an attack + infoleak and that the attack may have been successful).

Ryan C. Barnett
Director of Application Security Research
Breach Security, Inc.
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at Breach.com</A> 
www.Breach.com 


----- Original Message -----
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt;
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Sent: Tue Nov 03 12:52:28 2009
Subject: Re: [Owasp-modsecurity-core-rule-set] Excessive logging in	audit.log and debug.log for modsecurity. How to deal?

I have not noticed this. Is there anyway to scale all the possible
categories in order if importance or possible damage?

Thank you.

David

On Tue, Nov 3, 2009 at 11:50 AM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at breach.com</A>&gt; wrote:
&gt;<i> David - are you only looking at the correlated event in the apache error_log or are you also looking at the messages in the Mod audit_log file? &#160;The events in the audit_log have the same attack/vuln category tagging as the previous rules (e.g. - WEB_ATTACK/SQL_INJECTION) so you could identify transactions of interest.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Ryan C. Barnett
</I>&gt;<i> Director of Application Security Research
</I>&gt;<i> Breach Security, Inc.
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at Breach.com</A>
</I>&gt;<i> www.Breach.com
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ----- Original Message -----
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> Sent: Tue Nov 03 12:14:10 2009
</I>&gt;<i> Subject: [Owasp-modsecurity-core-rule-set] Excessive logging in audit.log &#160; &#160; &#160; and debug.log for modsecurity. How to deal?
</I>&gt;<i>
</I>&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> We have a site with about 2000 visits per day, and now the logging is
</I>&gt;<i> getting extremely hard to revise, as security is number one the ideal
</I>&gt;<i> situation for me would be to be able to classify the output into
</I>&gt;<i> groups so that I as a sysadmin can be aware of all, know if there is a
</I>&gt;<i> increase of hits for a particular rule, and most important is to know
</I>&gt;<i> when Iam getting (or tried to) getting SQL/PHP injected.
</I>&gt;<i>
</I>&gt;<i> Is there a way without using commercial add-ons to classify all this
</I>&gt;<i> output and actually make sense of it?
</I>&gt;<i>
</I>&gt;<i> In a perfect scenario I can have this log synced outside the server to
</I>&gt;<i> be analysed lively at another one and be able to create alerts. Would
</I>&gt;<i> this involve a commercial solution?
</I>&gt;<i>
</I>&gt;<i> Thank you.
</I>&gt;<i>
</I>&gt;<i> David Taveras
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000144.html">[Owasp-modsecurity-core-rule-set] Excessive logging in	audit.log and debug.log for modsecurity. How to deal?
</A></li>
	<LI>Next message: <A HREF="000148.html">[Owasp-modsecurity-core-rule-set] &quot;document.gif&quot; got denied after update ModSecurity to 2.5.10 with Core Rules v2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#145">[ date ]</a>
              <a href="thread.html#145">[ thread ]</a>
              <a href="subject.html#145">[ subject ]</a>
              <a href="author.html#145">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
