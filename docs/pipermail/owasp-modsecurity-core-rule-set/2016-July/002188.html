<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Problems with false positives.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problems%20with%20false%20positives.&In-Reply-To=%3C20160719114118.GD8069%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002187.html">
   <LINK REL="Next"  HREF="002189.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Problems with false positives.</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problems%20with%20false%20positives.&In-Reply-To=%3C20160719114118.GD8069%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Problems with false positives.">christian.folini at netnea.com
       </A><BR>
    <I>Tue Jul 19 11:41:18 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002187.html">[Owasp-modsecurity-core-rule-set] Problems with false positives.
</A></li>
        <LI>Next message: <A HREF="002189.html">[Owasp-modsecurity-core-rule-set] Video of Paranoia Mode	Presentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2188">[ date ]</a>
              <a href="thread.html#2188">[ thread ]</a>
              <a href="subject.html#2188">[ subject ]</a>
              <a href="author.html#2188">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Spork,

This is really a standard and you should be able to find a solution
online.

This is the radical approach, which makes it go away:
SecRuleRemoveById 960009

Usually, I do not advocate RemoveById, but in this particular case
I do it this way from time to time.

Ahoj,

Christian

On Mon, Jul 18, 2016 at 07:48:11PM -0400, Spork Schivago wrote:
&gt;<i> I hope this is the correct mailing list.   I lease a virtual private server
</I>&gt;<i> (VPS) from GoDaddy and pay for cPanel.   I see in
</I>&gt;<i> /usr/local/apache/logs/error_logs a lot of messages.   This is a big one
</I>&gt;<i> that I see a lot of!
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:19:34.821609 2016] [:error] [pid 6823] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Operator EQ matched 0 at REQUEST_HEADERS. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;317&quot;] [id &quot;960009&quot;] [rev &quot;1&quot;] [msg &quot;Request Missing a User Agent
</I>&gt;<i> Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
</I>&gt;<i> [accuracy &quot;9&quot;] [tag &quot;Host: &quot;] [tag &quot;application-multi&quot;] [tag
</I>&gt;<i> &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA&quot;] [tag &quot;WASCTC/WASC-21&quot;]
</I>&gt;<i> [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname &quot;franklin.jetbbs.com&quot;]
</I>&gt;<i> [uri &quot;/&quot;] [unique_id &quot;V41kBmjudWkAABqnkC4AAAAE&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:19:34.822806 2016] [:error] [pid 6823] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Operator GE matched 5 at TX:inbound_anomaly_score.
</I>&gt;<i> [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/RESPONSE-80-CORRELATION.conf&quot;]
</I>&gt;<i> [line &quot;35&quot;] [id &quot;981204&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total
</I>&gt;<i> Inbound Score: 5): Request Missing a User Agent Header&quot;] [tag &quot;Host: &quot;]
</I>&gt;<i> [tag &quot;event-correlation&quot;] [hostname &quot;franklin.jetbbs.com&quot;] [uri
</I>&gt;<i> &quot;/index.html&quot;] [unique_id &quot;V41kBmjudWkAABqnkC4AAAAE&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:20:01.427810 2016] [:error] [pid 6819] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Operator EQ matched 0 at REQUEST_HEADERS. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;283&quot;] [id &quot;960008&quot;] [rev &quot;2&quot;] [msg &quot;Request Missing a Host Header&quot;]
</I>&gt;<i> [severity &quot;WARNING&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;9&quot;]
</I>&gt;<i> [tag &quot;Host: &quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag
</I>&gt;<i> &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_HOST&quot;] [tag &quot;WASCTC/WASC-21&quot;]
</I>&gt;<i> [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname &quot;franklin.jetbbs.com&quot;]
</I>&gt;<i> [uri &quot;/whm-server-status&quot;] [unique_id &quot;V41kIWjudWkAABqjYU0AAAAA&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:20:01.427892 2016] [:error] [pid 6819] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Operator EQ matched 0 at REQUEST_HEADERS. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;317&quot;] [id &quot;960009&quot;] [rev &quot;1&quot;] [msg &quot;Request Missing a User Agent
</I>&gt;<i> Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
</I>&gt;<i> [accuracy &quot;9&quot;] [tag &quot;Host: &quot;] [tag &quot;application-multi&quot;] [tag
</I>&gt;<i> &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA&quot;] [tag &quot;WASCTC/WASC-21&quot;]
</I>&gt;<i> [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname &quot;franklin.jetbbs.com&quot;]
</I>&gt;<i> [uri &quot;/whm-server-status&quot;] [unique_id &quot;V41kIWjudWkAABqjYU0AAAAA&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:20:01.428676 2016] [:error] [pid 6819] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Operator GE matched 5 at TX:inbound_anomaly_score.
</I>&gt;<i> [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/RESPONSE-80-CORRELATION.conf&quot;]
</I>&gt;<i> [line &quot;35&quot;] [id &quot;981204&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total
</I>&gt;<i> Inbound Score: 5): Request Missing a User Agent Header&quot;] [tag &quot;Host: &quot;]
</I>&gt;<i> [tag &quot;event-correlation&quot;] [hostname &quot;franklin.jetbbs.com&quot;] [uri
</I>&gt;<i> &quot;/whm-server-status&quot;] [unique_id &quot;V41kIWjudWkAABqjYU0AAAAA&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:20:34.546597 2016] [:error] [pid 6820] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
</I>&gt;<i> &quot;REQUEST_HEADERS:User-Agent&quot; required. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
</I>&gt;<i> Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
</I>&gt;<i> [accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
</I>&gt;<i> &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
</I>&gt;<i> &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
</I>&gt;<i> &quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
</I>&gt;<i> &quot;V41kQmjudWkAABqkc0UAAAAB&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:21:34.542318 2016] [:error] [pid 6821] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
</I>&gt;<i> &quot;REQUEST_HEADERS:User-Agent&quot; required. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
</I>&gt;<i> Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
</I>&gt;<i> [accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
</I>&gt;<i> &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
</I>&gt;<i> &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
</I>&gt;<i> &quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
</I>&gt;<i> &quot;V41kfmjudWkAABqlx7cAAAAC&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:22:34.564614 2016] [:error] [pid 6822] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
</I>&gt;<i> &quot;REQUEST_HEADERS:User-Agent&quot; required. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
</I>&gt;<i> Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
</I>&gt;<i> [accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
</I>&gt;<i> &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
</I>&gt;<i> &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
</I>&gt;<i> &quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
</I>&gt;<i> &quot;V41kumjudWkAABqmocAAAAAD&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:22:51.937856 2016] [:error] [pid 6823] [client
</I>&gt;<i> 169.54.244.75] ModSecurity: Warning. Operator EQ matched 0 at
</I>&gt;<i> REQUEST_HEADERS. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;317&quot;] [id &quot;960009&quot;] [rev &quot;1&quot;] [msg &quot;Request Missing a User Agent
</I>&gt;<i> Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
</I>&gt;<i> [accuracy &quot;9&quot;] [tag &quot;Host: ip-104-238-117-105.ip.secureserver.net&quot;] [tag
</I>&gt;<i> &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag
</I>&gt;<i> &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA&quot;]
</I>&gt;<i> [tag &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
</I>&gt;<i> &quot;ip-104-238-117-105.ip.secureserver.net&quot;] [uri &quot;/&quot;] [unique_id
</I>&gt;<i> &quot;V41ky2judWkAABqnkC8AAAAE&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [Mon Jul 18 19:23:34.612950 2016] [:error] [pid 6819] [client 127.0.0.1]
</I>&gt;<i> ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
</I>&gt;<i> &quot;REQUEST_HEADERS:User-Agent&quot; required. [file
</I>&gt;<i> &quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
</I>&gt;<i> [line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
</I>&gt;<i> Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
</I>&gt;<i> [accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
</I>&gt;<i> &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
</I>&gt;<i> &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
</I>&gt;<i> &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
</I>&gt;<i> &quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
</I>&gt;<i> &quot;V41k9mjudWkAABqjYU4AAAAA&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> I believe this is a false positive.   I talked to cPanel support and I
</I>&gt;<i> believe a cPanel script is checking /whm-server-status to make sure the
</I>&gt;<i> server is up but there's maybe something wrong with the request header in
</I>&gt;<i> the script or something.
</I>&gt;<i> 
</I>&gt;<i> I'd like to safely figure out how to whitelist this, so I don't see the log
</I>&gt;<i> filled with these error messages whenever 127.0.0.1 tries connecting to
</I>&gt;<i> whm-server-status.   I think the answer lies within
</I>&gt;<i> the /usr/local/apache/conf/modsec_vendor_configs/OWASP/
</I>&gt;<i> rules/REQUEST-01-COMMON-EXCEPTIONS.conf   file but I'm not sure how to
</I>&gt;<i> properly write a rule.   Can someone show me what I'd need to put in there?
</I>&gt;<i>   Thank you!
</I>&gt;<i> 
</I>&gt;<i> Ken
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>

-- 
<A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
twitter: @ChrFolini
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002187.html">[Owasp-modsecurity-core-rule-set] Problems with false positives.
</A></li>
	<LI>Next message: <A HREF="002189.html">[Owasp-modsecurity-core-rule-set] Video of Paranoia Mode	Presentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2188">[ date ]</a>
              <a href="thread.html#2188">[ thread ]</a>
              <a href="subject.html#2188">[ subject ]</a>
              <a href="author.html#2188">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
