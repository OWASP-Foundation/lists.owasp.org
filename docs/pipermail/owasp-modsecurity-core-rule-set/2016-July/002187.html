<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Problems with false positives.
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problems%20with%20false%20positives.&In-Reply-To=%3CCAEeNszZM-GTVNGsUatpQVGeZzncEJmCnPGhnS8sF0ZCiD87NMQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002186.html">
   <LINK REL="Next"  HREF="002188.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Problems with false positives.</H1>
    <B>Spork Schivago</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problems%20with%20false%20positives.&In-Reply-To=%3CCAEeNszZM-GTVNGsUatpQVGeZzncEJmCnPGhnS8sF0ZCiD87NMQ%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Problems with false positives.">sporkschivago at gmail.com
       </A><BR>
    <I>Mon Jul 18 23:48:11 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002186.html">[Owasp-modsecurity-core-rule-set] Rule Writing Exercise: chaining
</A></li>
        <LI>Next message: <A HREF="002188.html">[Owasp-modsecurity-core-rule-set] Problems with false positives.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2187">[ date ]</a>
              <a href="thread.html#2187">[ thread ]</a>
              <a href="subject.html#2187">[ subject ]</a>
              <a href="author.html#2187">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I hope this is the correct mailing list.   I lease a virtual private server
(VPS) from GoDaddy and pay for cPanel.   I see in
/usr/local/apache/logs/error_logs a lot of messages.   This is a big one
that I see a lot of!

[Mon Jul 18 19:19:34.821609 2016] [:error] [pid 6823] [client 127.0.0.1]
ModSecurity: Warning. Operator EQ matched 0 at REQUEST_HEADERS. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;317&quot;] [id &quot;960009&quot;] [rev &quot;1&quot;] [msg &quot;Request Missing a User Agent
Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
[accuracy &quot;9&quot;] [tag &quot;Host: &quot;] [tag &quot;application-multi&quot;] [tag
&quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
&quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA&quot;] [tag &quot;WASCTC/WASC-21&quot;]
[tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname &quot;franklin.jetbbs.com&quot;]
[uri &quot;/&quot;] [unique_id &quot;V41kBmjudWkAABqnkC4AAAAE&quot;]


[Mon Jul 18 19:19:34.822806 2016] [:error] [pid 6823] [client 127.0.0.1]
ModSecurity: Warning. Operator GE matched 5 at TX:inbound_anomaly_score.
[file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/RESPONSE-80-CORRELATION.conf&quot;]
[line &quot;35&quot;] [id &quot;981204&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total
Inbound Score: 5): Request Missing a User Agent Header&quot;] [tag &quot;Host: &quot;]
[tag &quot;event-correlation&quot;] [hostname &quot;franklin.jetbbs.com&quot;] [uri
&quot;/index.html&quot;] [unique_id &quot;V41kBmjudWkAABqnkC4AAAAE&quot;]


[Mon Jul 18 19:20:01.427810 2016] [:error] [pid 6819] [client 127.0.0.1]
ModSecurity: Warning. Operator EQ matched 0 at REQUEST_HEADERS. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;283&quot;] [id &quot;960008&quot;] [rev &quot;2&quot;] [msg &quot;Request Missing a Host Header&quot;]
[severity &quot;WARNING&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;9&quot;]
[tag &quot;Host: &quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag
&quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
&quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_HOST&quot;] [tag &quot;WASCTC/WASC-21&quot;]
[tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname &quot;franklin.jetbbs.com&quot;]
[uri &quot;/whm-server-status&quot;] [unique_id &quot;V41kIWjudWkAABqjYU0AAAAA&quot;]


[Mon Jul 18 19:20:01.427892 2016] [:error] [pid 6819] [client 127.0.0.1]
ModSecurity: Warning. Operator EQ matched 0 at REQUEST_HEADERS. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;317&quot;] [id &quot;960009&quot;] [rev &quot;1&quot;] [msg &quot;Request Missing a User Agent
Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
[accuracy &quot;9&quot;] [tag &quot;Host: &quot;] [tag &quot;application-multi&quot;] [tag
&quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
&quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA&quot;] [tag &quot;WASCTC/WASC-21&quot;]
[tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname &quot;franklin.jetbbs.com&quot;]
[uri &quot;/whm-server-status&quot;] [unique_id &quot;V41kIWjudWkAABqjYU0AAAAA&quot;]


[Mon Jul 18 19:20:01.428676 2016] [:error] [pid 6819] [client 127.0.0.1]
ModSecurity: Warning. Operator GE matched 5 at TX:inbound_anomaly_score.
[file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/RESPONSE-80-CORRELATION.conf&quot;]
[line &quot;35&quot;] [id &quot;981204&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total
Inbound Score: 5): Request Missing a User Agent Header&quot;] [tag &quot;Host: &quot;]
[tag &quot;event-correlation&quot;] [hostname &quot;franklin.jetbbs.com&quot;] [uri
&quot;/whm-server-status&quot;] [unique_id &quot;V41kIWjudWkAABqjYU0AAAAA&quot;]


[Mon Jul 18 19:20:34.546597 2016] [:error] [pid 6820] [client 127.0.0.1]
ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
&quot;REQUEST_HEADERS:User-Agent&quot; required. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
[accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
&quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
&quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
&quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
&quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
&quot;V41kQmjudWkAABqkc0UAAAAB&quot;]


[Mon Jul 18 19:21:34.542318 2016] [:error] [pid 6821] [client 127.0.0.1]
ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
&quot;REQUEST_HEADERS:User-Agent&quot; required. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
[accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
&quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
&quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
&quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
&quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
&quot;V41kfmjudWkAABqlx7cAAAAC&quot;]


[Mon Jul 18 19:22:34.564614 2016] [:error] [pid 6822] [client 127.0.0.1]
ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
&quot;REQUEST_HEADERS:User-Agent&quot; required. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
[accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
&quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
&quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
&quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
&quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
&quot;V41kumjudWkAABqmocAAAAAD&quot;]


[Mon Jul 18 19:22:51.937856 2016] [:error] [pid 6823] [client
169.54.244.75] ModSecurity: Warning. Operator EQ matched 0 at
REQUEST_HEADERS. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;317&quot;] [id &quot;960009&quot;] [rev &quot;1&quot;] [msg &quot;Request Missing a User Agent
Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
[accuracy &quot;9&quot;] [tag &quot;Host: ip-104-238-117-105.ip.secureserver.net&quot;] [tag
&quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag
&quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_UA&quot;]
[tag &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
&quot;ip-104-238-117-105.ip.secureserver.net&quot;] [uri &quot;/&quot;] [unique_id
&quot;V41ky2judWkAABqnkC8AAAAE&quot;]


[Mon Jul 18 19:23:34.612950 2016] [:error] [pid 6819] [client 127.0.0.1]
ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against
&quot;REQUEST_HEADERS:User-Agent&quot; required. [file
&quot;/usr/local/apache/conf/modsec_vendor_configs/OWASP/rules/REQUEST-20-PROTOCOL-ENFORCEMENT.conf&quot;]
[line &quot;299&quot;] [id &quot;960015&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept
Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;]
[accuracy &quot;8&quot;] [tag &quot;Host: 127.0.0.1&quot;] [tag &quot;application-multi&quot;] [tag
&quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag
&quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag
&quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [hostname
&quot;127.0.0.1&quot;] [uri &quot;/whm-server-status&quot;] [unique_id
&quot;V41k9mjudWkAABqjYU4AAAAA&quot;]


I believe this is a false positive.   I talked to cPanel support and I
believe a cPanel script is checking /whm-server-status to make sure the
server is up but there's maybe something wrong with the request header in
the script or something.

I'd like to safely figure out how to whitelist this, so I don't see the log
filled with these error messages whenever 127.0.0.1 tries connecting to
whm-server-status.   I think the answer lies within
the /usr/local/apache/conf/modsec_vendor_configs/OWASP/
rules/REQUEST-01-COMMON-EXCEPTIONS.conf   file but I'm not sure how to
properly write a rule.   Can someone show me what I'd need to put in there?
  Thank you!

Ken
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160718/6b73ba3d/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160718/6b73ba3d/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002186.html">[Owasp-modsecurity-core-rule-set] Rule Writing Exercise: chaining
</A></li>
	<LI>Next message: <A HREF="002188.html">[Owasp-modsecurity-core-rule-set] Problems with false positives.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2187">[ date ]</a>
              <a href="thread.html#2187">[ thread ]</a>
              <a href="subject.html#2187">[ subject ]</a>
              <a href="author.html#2187">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
