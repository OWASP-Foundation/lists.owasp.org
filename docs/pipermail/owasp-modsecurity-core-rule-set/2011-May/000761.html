<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Testing Custom Rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Testing%20Custom%20Rules&In-Reply-To=929CE6E6-00AE-40F7-A6B6-7C21C7CB3CE5%40jwall.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000759.html">
   <LINK REL="Next"  HREF="000763.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Testing Custom Rules</H1>
    <B>Ken Brucker</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Testing%20Custom%20Rules&In-Reply-To=929CE6E6-00AE-40F7-A6B6-7C21C7CB3CE5%40jwall.org"
       TITLE="[Owasp-modsecurity-core-rule-set] Testing Custom Rules">Ken at pumastudios.com
       </A><BR>
    <I>Thu May  5 13:33:25 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000759.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
        <LI>Next message: <A HREF="000763.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#761">[ date ]</a>
              <a href="thread.html#761">[ thread ]</a>
              <a href="subject.html#761">[ subject ]</a>
              <a href="author.html#761">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If I'm understanding this tool the method of use is:

- turn on ModSecurity audit log on target website
- Run traffic to the site, including break-in attempts, normal usage, etc.
- turn off audit log

Update rules on the target website
Test client will parse audit log and replay the web events to the target website.

Review logs, rinse, repeat...

Have I understood the scheme?

On May 5, 2011, at 11:41 AM, Christian Bockermann wrote:

&gt;<i> Hi Ken,
</I>&gt;<i> 
</I>&gt;<i> your question is hitting the spot. Currently there is no such test engine available.
</I>&gt;<i> I've done some work on that by implementing a TestClient in Java, which basically
</I>&gt;<i> can re-inject all requests from a recorded ModSecurity audit-log.
</I>&gt;<i> 
</I>&gt;<i> I've had plans (and started some of that) to implement an &quot;X&quot;-Section which can be
</I>&gt;<i> used to define &quot;expected behaviour&quot;. For example, you could add some tests like:
</I>&gt;<i> 
</I>&gt;<i>     RESPONSE_STATUS @eq 404
</I>&gt;<i>     RESPONSE_BODY &quot;@rx !MySQL Error&quot;
</I>&gt;<i>     ...
</I>&gt;<i> 
</I>&gt;<i> However, since such a test-client can only check for expected results within the
</I>&gt;<i> server response, this is somewhat limitted. An extension might be to connect to the
</I>&gt;<i> AuditConsole and check the resulting &quot;newly created&quot; audit log events for the requests
</I>&gt;<i> that are injected for testing.
</I>&gt;<i> 
</I>&gt;<i> If that sounds interesting to you, just drop me a line. I'd be happy to include such
</I>&gt;<i> a thing in the jwall-tools (open-source).
</I>&gt;<i> 
</I>&gt;<i> Chris
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Am 05.05.2011 um 17:54 schrieb Ken Brucker:
</I>&gt;<i> 
</I>&gt;&gt;<i> Hi - I have some custom rules I'd like to create and I'm looking for a test engine to drive the rules and ensure I'm getting the expected results.  I checked the FAQ and found this question that directly relates:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> How do I handle False Positives and creating Custom Rules?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> It is inevitable; you will run into some False Positive hits when using web application firewalls. This is not something that is unique to ModSecurity. All web application firewalls will generate false positives from time to time. The following Blog post information will help to guide you through the process of identifying, fixing, implementing and testing new custom rules to address false positives.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> But...  the last sentence states &quot;The following blog post information ...&quot;  and there is no blog post information following.  Where do I find the referenced material?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Does a test engine exist outside Apache to feed data through the rules to enable easy regression testing in addition to focused testing of new rules?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Regards,
</I>&gt;&gt;<i> Ken
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000759.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
	<LI>Next message: <A HREF="000763.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#761">[ date ]</a>
              <a href="thread.html#761">[ thread ]</a>
              <a href="subject.html#761">[ subject ]</a>
              <a href="author.html#761">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
