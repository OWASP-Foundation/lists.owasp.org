<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule Review: 960911 - Invalid	HTTP Request Line
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20Review%3A%20960911%20-%20Invalid%0A%09HTTP%20Request%20Line&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000773.html">
   <LINK REL="Next"  HREF="000769.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule Review: 960911 - Invalid	HTTP Request Line</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20Review%3A%20960911%20-%20Invalid%0A%09HTTP%20Request%20Line&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Rule Review: 960911 - Invalid	HTTP Request Line">RBarnett at trustwave.com
       </A><BR>
    <I>Fri May  6 11:13:29 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000773.html">[Owasp-modsecurity-core-rule-set] Rule Updates Are Coming!
</A></li>
        <LI>Next message: <A HREF="000769.html">[Owasp-modsecurity-core-rule-set] Rule Review: 981227 - Apache	Error: Invalid URI in Request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#768">[ date ]</a>
              <a href="thread.html#768">[ thread ]</a>
              <a href="subject.html#768">[ subject ]</a>
              <a href="author.html#768">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If you have any comments related to this rule (improvements, questions, etc&#8230;), please reply to this email thread.

For False Positives, please sign up for
<A HREF="https://lists.sourceforge.net/lists/listinfo/mod-security-report-false-positives">https://lists.sourceforge.net/lists/listinfo/mod-security-report-false-positives</A>

Email the FP Report list here:
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-report-false-positives at lists.sourceforge.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-report-false-positives at lists.sourceforge.net</A>&gt;

Rule File:
<A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_20_protocol_violations.conf">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_20_protocol_violations.conf</A>

Current Rule:
#
# Validate request line against the format specified in the HTTP RFC
#
# -=[ Rule Logic ]=-
#
# Uses rule negation against the regex for positive security.  The regex specifies the proper
# construction of URI request lines such as:
#
#       &quot;http:&quot; &quot;//&quot; host [ &quot;:&quot; port ] [ abs_path [ &quot;?&quot; query ]]
#
# It also outlines proper construction for CONNECT, OPTIONS and GET requests.
#
# -=[ References ]=-
# <A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911</A>
# <A HREF="http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1">http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1</A>
#
SecRule REQUEST_LINE &quot;!^(?:(?:[a-z]{3,10}\s+(?:\w{3,7}?://[\w\-\./]*(?::\d+)?)?/[^?#]*(?:\?[^#\s]*)?(?:#[\S]*)?|connect (?:\d{1,3}\.){3}\d{1,3}\.?(?::\d+)?|options \*)\s+[\w\./]+|get /[^?#]*(?:\?[^#\s]*)?(?:#[\S]*)?)$&quot; \
    &quot;phase:1,t:none,t:lowercase,block,msg:'Invalid HTTP Request Line',id:'960911',severity:'4',rev:'2.2.0',logdata:'%{request_line}',tag:'<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id}',tag:'http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1',tag:'RULE_ACCURACY_LEVEL/5',setvar:'tx.msg=%{rule.msg}',setvar:'tx.id=%{rule.id}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:'tx.%{rule.id}-PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}=%{matched_var}'&quot;">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id}',tag:'http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1',tag:'RULE_ACCURACY_LEVEL/5',setvar:'tx.msg=%{rule.msg}',setvar:'tx.id=%{rule.id}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:'tx.%{rule.id}-PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}=%{matched_var}'&quot;</A>

Rule Documentation Page:
<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911</A>

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000773.html">[Owasp-modsecurity-core-rule-set] Rule Updates Are Coming!
</A></li>
	<LI>Next message: <A HREF="000769.html">[Owasp-modsecurity-core-rule-set] Rule Review: 981227 - Apache	Error: Invalid URI in Request
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#768">[ date ]</a>
              <a href="thread.html#768">[ thread ]</a>
              <a href="subject.html#768">[ subject ]</a>
              <a href="author.html#768">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
