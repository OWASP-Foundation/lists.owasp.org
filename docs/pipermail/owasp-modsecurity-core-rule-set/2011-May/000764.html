<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] how to get the description of each rule..
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20how%20to%20get%20the%20description%20of%0A%20each%20rule..&In-Reply-To=C9E817D7.2576E%25rbarnett%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000756.html">
   <LINK REL="Next"  HREF="000757.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] how to get the description of each rule..</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20how%20to%20get%20the%20description%20of%0A%20each%20rule..&In-Reply-To=C9E817D7.2576E%25rbarnett%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] how to get the description of each rule..">RBarnett at trustwave.com
       </A><BR>
    <I>Thu May  5 14:14:00 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000756.html">[Owasp-modsecurity-core-rule-set] how to get the description of each rule..
</A></li>
        <LI>Next message: <A HREF="000757.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers] CRS DoS protection &amp; x-forwarded-for header
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#764">[ date ]</a>
              <a href="thread.html#764">[ thread ]</a>
              <a href="subject.html#764">[ subject ]</a>
              <a href="author.html#764">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On a somewhat related note - some of you may have seen this email today -
<A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2011-May/">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2011-May/</A>
000760.html


I have started some work on updating the CRS rules regression testing
suite scripts.  As part of the testing suite, you have to create actual
template HTTP requests that the script uses to craft actual requests that
it will send to a ModSec install.  As part of this process, we will need
to go through each and every rule and develop an actual testing case for
it.  This will actually help with regards to the Rule ID documentation
pages
(<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_Rule_Description_Template">https://www.owasp.org/index.php/ModSecurity_CRS_Rule_Description_Template</A>)
 as we will be able to then provide the &quot;Example Payload&quot; and &quot;Example
Audit Log Entry&quot; data taken from the regression tests.

I will send a note to the mail-list when I have released the rules
regression testing suite.  My plan is to get this out sooner rather than
later.  It may not be totally updated with tests for all CRS rules, but I
want to get the framework out for testing by the community and hopefully
some people will help to actually create some tests :)

-=Ryan



On 5/5/11 9:05 AM, &quot;Ryan Barnett&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt; wrote:

&gt;<i>Yep - I was hoping that some folks from the community would help with the
</I>&gt;<i>documentation but that hasn't materialized...  If anyone wants to help
</I>&gt;<i>with Documentation please ping me so we can coordinate.
</I>&gt;<i>
</I>&gt;<i>Besides the OWASP Rule Document pages, I did start updating the comments
</I>&gt;<i>preceding each rule in the rules files.  I only finished two files so far
</I>&gt;<i>-
</I>&gt;<i>
</I>&gt;<i>modsecurity_crs_20_protocol_violations.conf
</I>&gt;<i>modsecurity_crs_21_protocol_anomalies.conf
</I>&gt;<i>
</I>&gt;<i>Each rule has Rules Logic and Reference sections to help provide
</I>&gt;<i>information as to the rule's purpose.
</I>&gt;<i>
</I>&gt;<i>#
</I>&gt;<i># -=[ Rule Logic ]=-
</I>&gt;<i># Uses rule negation against the regex for positive security.  The regex
</I>&gt;<i>specifies the proper
</I>&gt;<i># construction of URI request lines such as:
</I>&gt;<i>#
</I>&gt;<i>#       &quot;http:&quot; &quot;//&quot; host [ &quot;:&quot; port ] [ abs_path [ &quot;?&quot; query ]]
</I>&gt;<i>#
</I>&gt;<i># It also outlines proper construction for CONNECT, OPTIONS and GET
</I>&gt;<i>requests.
</I>&gt;<i>#
</I>&gt;<i># -=[ References ]=-
</I>&gt;<i># <A HREF="http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1">http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1</A>
</I>&gt;<i>#
</I>&gt;<i>SecRule REQUEST_LINE
</I>&gt;<i>&quot;!^(?:(?:[a-z]{3,10}\s+(?:\w{3,7}?://[\w\-\./]*(?::\d+)?)?/[^?#]*(?:\?[^#\
</I>&gt;<i>s
</I>&gt;<i>]*)?(?:#[\S]*)?|connect (?:\d{1,3}\.){3}\d{1,3}\.?(?::\d+)?|options
</I>&gt;<i>\*)\s+[\w\./]+|get /[^?#]*(?:\?[^#\s]*)?(?:#[\S]*)?)$&quot; \
</I>&gt;<i>    &quot;t:none,t:lowercase,phase:1,rev:'2.1.3',block,msg:'Invalid HTTP
</I>&gt;<i>Request
</I>&gt;<i>Line',id:'960911',severity:'4',tag:'<A HREF="http://www.w3.org/Protocols/rfc2616/rf">http://www.w3.org/Protocols/rfc2616/rf</A>
</I>&gt;<i>c
</I>&gt;<i>2616-sec3.html#sec3.2.1',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_sco
</I>&gt;<i>r
</I>&gt;<i>e=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.not
</I>&gt;<i>i
</I>&gt;<i>ce_anomaly_score},setvar:'tx.%{rule.id}-PROTOCOL_VIOLATION/INVALID_REQ-%{m
</I>&gt;<i>a
</I>&gt;<i>tched_var_name}=%{matched_var}'&quot;
</I>&gt;<i>
</I>&gt;<i>Again - if anyone wants to help with documentation improvements, we are
</I>&gt;<i>certainly looking for help.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>-Ryan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>On 5/5/11 4:57 AM, &quot;Josh Amishav-Zlatin&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jamuse at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>2011/5/5 &#24352;&#31456;&#25996;(&#30740;&#20845; &#31119;&#24030;) &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">zhangzhangbin at ruijie.com.cn</A>&gt;:
</I>&gt;&gt;&gt;<i> Hello!
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>     Many rule in the core-rule-set are complicated and I can&#8217;t
</I>&gt;&gt;&gt;<i>understant
</I>&gt;&gt;&gt;<i> it.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Does anyone know where to find the description of each rule?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>There was a push to start documenting the CRS rules a while back,
</I>&gt;&gt;<i>though it doesn't look like that much was completed:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i><A HREF="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_">https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_</A>
</I>&gt;&gt;<i>P
</I>&gt;&gt;<i>roject#tab=Documentation
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>To get a good understand of the ModSecurity rules language, I highly
</I>&gt;&gt;<i>recommend getting a copy the ModSecurity Handbook.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>--
</I>&gt;&gt;<i> - Josh
</I>&gt;&gt;<i>_______________________________________________
</I>&gt;&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000756.html">[Owasp-modsecurity-core-rule-set] how to get the description of each rule..
</A></li>
	<LI>Next message: <A HREF="000757.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers] CRS DoS protection &amp; x-forwarded-for header
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#764">[ date ]</a>
              <a href="thread.html#764">[ thread ]</a>
              <a href="subject.html#764">[ subject ]</a>
              <a href="author.html#764">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
