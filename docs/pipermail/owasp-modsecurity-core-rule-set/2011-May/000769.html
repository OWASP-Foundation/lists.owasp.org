<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule Review: 981227 - Apache	Error: Invalid URI in Request
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20Review%3A%20981227%20-%20Apache%0A%09Error%3A%20Invalid%20URI%20in%20Request&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000768.html">
   <LINK REL="Next"  HREF="000770.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule Review: 981227 - Apache	Error: Invalid URI in Request</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20Review%3A%20981227%20-%20Apache%0A%09Error%3A%20Invalid%20URI%20in%20Request&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Rule Review: 981227 - Apache	Error: Invalid URI in Request">RBarnett at trustwave.com
       </A><BR>
    <I>Fri May  6 11:28:43 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000768.html">[Owasp-modsecurity-core-rule-set] Rule Review: 960911 - Invalid	HTTP Request Line
</A></li>
        <LI>Next message: <A HREF="000770.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers] CRS DoS protection &amp; x-forwarded-for header
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#769">[ date ]</a>
              <a href="thread.html#769">[ thread ]</a>
              <a href="subject.html#769">[ subject ]</a>
              <a href="author.html#769">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If you have any comments related to this rule (improvements, questions, etc&#8230;), please reply to this email thread.

For False Positives, please sign up for
<A HREF="https://lists.sourceforge.net/lists/listinfo/mod-security-report-false-positives">https://lists.sourceforge.net/lists/listinfo/mod-security-report-false-positives</A>

Email the FP Report list here:
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-report-false-positives at lists.sourceforge.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-report-false-positives at lists.sourceforge.net</A>&gt;

Rule File:
<A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_20_protocol_violations.conf">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_20_protocol_violations.conf</A>

Current Rule:

#
# Identify Invalid URIs Blocked by Apache
#
# -=[ Rule Logic ]=-
#
# There are some request violations that Apache will handle internally, prior to the
# ModSecurity phase:1 POST-READ-REQUEST hook.  For these requests, we can still get
# visibility by running a check in phase:5 logging to look for the Apache error msg.
#
# -=[ References ]=-
# <A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-981227">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-981227</A>
#
SecRule WEBSERVER_ERROR_LOG &quot;@contains Invalid URI in request&quot; &quot;phase:5,t:none,log,pass,msg:'Apache Error: Invalid URI in Request',id:'981227',rev:'2.2.0',logdata:'%{matched_var}',severity:'4',tag:'<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id}',tag:'http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1',tag:'RULE_ACCURACY_LEVEL/5',setvar:'tx.msg=%{rule.msg}',setvar:'tx.id=%{rule.id}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:'tx.%{rule.id}-PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}=%{matched_var}'&quot;">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id}',tag:'http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1',tag:'RULE_ACCURACY_LEVEL/5',setvar:'tx.msg=%{rule.msg}',setvar:'tx.id=%{rule.id}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.notice_anomaly_score},setvar:'tx.%{rule.id}-PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}=%{matched_var}'&quot;</A>

Rule Documentation Page:
<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-981227">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-981227</A>

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000768.html">[Owasp-modsecurity-core-rule-set] Rule Review: 960911 - Invalid	HTTP Request Line
</A></li>
	<LI>Next message: <A HREF="000770.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers] CRS DoS protection &amp; x-forwarded-for header
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#769">[ date ]</a>
              <a href="thread.html#769">[ thread ]</a>
              <a href="subject.html#769">[ subject ]</a>
              <a href="author.html#769">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
