<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Testing Custom Rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Testing%20Custom%20Rules&In-Reply-To=78906653-FB08-48F6-9319-341245EE04B5%40pumastudios.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000758.html">
   <LINK REL="Next"  HREF="000761.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Testing Custom Rules</H1>
    <B>Christian Bockermann</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Testing%20Custom%20Rules&In-Reply-To=78906653-FB08-48F6-9319-341245EE04B5%40pumastudios.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Testing Custom Rules">chris at jwall.org
       </A><BR>
    <I>Thu May  5 12:41:40 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000758.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
        <LI>Next message: <A HREF="000761.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#759">[ date ]</a>
              <a href="thread.html#759">[ thread ]</a>
              <a href="subject.html#759">[ subject ]</a>
              <a href="author.html#759">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ken,

your question is hitting the spot. Currently there is no such test engine available.
I've done some work on that by implementing a TestClient in Java, which basically
can re-inject all requests from a recorded ModSecurity audit-log.

I've had plans (and started some of that) to implement an &quot;X&quot;-Section which can be
used to define &quot;expected behaviour&quot;. For example, you could add some tests like:

     RESPONSE_STATUS @eq 404
     RESPONSE_BODY &quot;@rx !MySQL Error&quot;
     ...

However, since such a test-client can only check for expected results within the
server response, this is somewhat limitted. An extension might be to connect to the
AuditConsole and check the resulting &quot;newly created&quot; audit log events for the requests
that are injected for testing.

If that sounds interesting to you, just drop me a line. I'd be happy to include such
a thing in the jwall-tools (open-source).

Chris


   

Am 05.05.2011 um 17:54 schrieb Ken Brucker:

&gt;<i> Hi - I have some custom rules I'd like to create and I'm looking for a test engine to drive the rules and ensure I'm getting the expected results.  I checked the FAQ and found this question that directly relates:
</I>&gt;<i> 
</I>&gt;<i>  How do I handle False Positives and creating Custom Rules?
</I>&gt;<i> 
</I>&gt;<i> It is inevitable; you will run into some False Positive hits when using web application firewalls. This is not something that is unique to ModSecurity. All web application firewalls will generate false positives from time to time. The following Blog post information will help to guide you through the process of identifying, fixing, implementing and testing new custom rules to address false positives.
</I>&gt;<i> 
</I>&gt;<i> But...  the last sentence states &quot;The following blog post information ...&quot;  and there is no blog post information following.  Where do I find the referenced material?
</I>&gt;<i> 
</I>&gt;<i> Does a test engine exist outside Apache to feed data through the rules to enable easy regression testing in addition to focused testing of new rules?
</I>&gt;<i> 
</I>&gt;<i> Regards,
</I>&gt;<i> Ken
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000758.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
	<LI>Next message: <A HREF="000761.html">[Owasp-modsecurity-core-rule-set] Testing Custom Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#759">[ date ]</a>
              <a href="thread.html#759">[ thread ]</a>
              <a href="subject.html#759">[ subject ]</a>
              <a href="author.html#759">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
