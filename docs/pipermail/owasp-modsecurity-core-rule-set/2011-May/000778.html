<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Announcing Release of OWASP ModSecurity CRS v2.2.0
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Announcing%20Release%20of%20OWASP%0A%20ModSecurity%20CRS%20v2.2.0&In-Reply-To=1306523775.3377.6.camel%40localhost.localdomain">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000777.html">
   <LINK REL="Next"  HREF="000779.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Announcing Release of OWASP ModSecurity CRS v2.2.0</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Announcing%20Release%20of%20OWASP%0A%20ModSecurity%20CRS%20v2.2.0&In-Reply-To=1306523775.3377.6.camel%40localhost.localdomain"
       TITLE="[Owasp-modsecurity-core-rule-set] Announcing Release of OWASP ModSecurity CRS v2.2.0">RBarnett at trustwave.com
       </A><BR>
    <I>Fri May 27 17:19:04 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000777.html">[Owasp-modsecurity-core-rule-set] Announcing Release of OWASP ModSecurity CRS v2.2.0
</A></li>
        <LI>Next message: <A HREF="000779.html">[Owasp-modsecurity-core-rule-set] Announcing Release of OWASP ModSecurity CRS v2.2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#778">[ date ]</a>
              <a href="thread.html#778">[ thread ]</a>
              <a href="subject.html#778">[ subject ]</a>
              <a href="author.html#778">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ah, I guess you aren't using ModSecurity v2.6.0. You should use the older variable name then - REQBODY_PROCESSOR_ERROR

Ryan

On May 27, 2011, at 3:16 PM, &quot;Arthur Dent&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">misc.lists at blueyonder.co.uk</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">misc.lists at blueyonder.co.uk</A>&gt;&gt; wrote:

On Thu, 2011-05-26 at 18:11 -0500, Ryan Barnett wrote:
Hello everyone,
I am pleased to announce the release of the OWASP ModSecurity Core Rule Set (CRS) v2.2.0.  This is a significant update as we have added a number of very important capabilities.

CHANGE LOG -


Hi Ryan,

I have just installed this CRS update and on restarting Apache I get the
following error:

# service httpd restart
Stopping httpd:                                            [  OK  ]
Starting httpd: Syntax error on line 91 of /etc/httpd/modsecurity.d/base_rules/modsecurity_crs_20_protocol_violations.conf:
Error creating rule: Unknown variable: REQBODY_ERROR
                                                          [FAILED]

I am just dashing out and don't have time to troubleshoot. For now I
have just commented out lines 90 &amp; 91

##SecRule REQBODY_ERROR &quot;!@eq 0&quot; \
##    &quot;phase:2,t:none,block,msg:'Failed to parse request body.',id:'960912',logdata:'%{reqbody_error_msg}',severity:2,setvar:'tx.msg=%{rule.msg}',setvar:'tx.id=%{rule.id}',tag:'RULE_MATURITY/7',tag:'RULE_ACCURACY/8',tag:'<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}=%{matched_var}&quot;">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.protocol_violation_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-PROTOCOL_VIOLATION/INVALID_REQ-%{matched_var_name}=%{matched_var}&quot;</A>

What is the proper fix?

Thanks in advance...

Mark

&lt;signature.asc&gt;
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000777.html">[Owasp-modsecurity-core-rule-set] Announcing Release of OWASP ModSecurity CRS v2.2.0
</A></li>
	<LI>Next message: <A HREF="000779.html">[Owasp-modsecurity-core-rule-set] Announcing Release of OWASP ModSecurity CRS v2.2.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#778">[ date ]</a>
              <a href="thread.html#778">[ thread ]</a>
              <a href="subject.html#778">[ subject ]</a>
              <a href="author.html#778">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
