From riemann913 at gmail.com  Thu Jun  5 17:01:25 2014
From: riemann913 at gmail.com (Riemann Riemann)
Date: Thu, 5 Jun 2014 12:01:25 -0500
Subject: [Owasp-modsecurity-core-rule-set] Why are some newer rules
	formatted differently in crs_41_sqli?
Message-ID: <CADr89CBGF5ozGR-TycuoR4w+sSWsDc5C7RryqSG4FDYu+VzyPg@mail.gmail.com>

Hello,

I'm updating CRS versions, and see just over 20 newer rules in CRS_41_sqli
that name a tx variable (the one that's set equal to %{tx.0}) using a
different format than any of the other rules in the CRS (e.g. rule
id:981243). The value of %{tx.msg} is added to the variable name, instead
of just %{rule.id}, which seems a bit unnecessary, and not quite as clean.
This variable is usually used to check that a rule matched a particular
parameter prior to adjusting  the anomaly score, so this creates some
inconsistencies when writing score adjustments, since %{tx.msg} contains
spaces.


The variable is typically named like this:

setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}

And a typical score adjustment would look like this:

SecRule &TX:981243-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar "@ge 1"
"setvar:tx.anomaly_score=-%{tx.critical_anomaly_score}"



With this handful of newer rules, the variable is named like this:

setvar:tx.%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}

The only way I could figure to write a score adjustment for these was with
regex (note: the regex wouldn't work with metacharacters, like \s for a
space), like this:

SecRule
&TX:'/981243-Detects.classic.SQL.injection.probings.2/2-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar/'
"@ge 1" "setvar:tx.anomaly_score=-%{tx.critical_
anomaly_score}"


Is there any reason the format for this has changed, or is different for
these rules? Is there a cleaner or more consistent way to write adjustments
for these rules?

Thanks in advance,
Dusty
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140605/763084db/attachment.html>

From RBarnett at trustwave.com  Thu Jun  5 18:39:38 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Thu, 5 Jun 2014 18:39:38 +0000
Subject: [Owasp-modsecurity-core-rule-set] Why are some newer rules
 formatted differently in crs_41_sqli?
In-Reply-To: <CADr89CBGF5ozGR-TycuoR4w+sSWsDc5C7RryqSG4FDYu+VzyPg@mail.gmail.com>
References: <CADr89CBGF5ozGR-TycuoR4w+sSWsDc5C7RryqSG4FDYu+VzyPg@mail.gmail.com>
Message-ID: <CFB6317F.F9359%rbarnett@trustwave.com>

That is a bug and is why this is labeled as a "dev" branch :)  I fixed it and just pushed an update to GitHub is you want to pull it down.

Ryan Barnett
Senior Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

From: Riemann Riemann <riemann913 at gmail.com<mailto:riemann913 at gmail.com>>
Date: Thursday, June 5, 2014 1:01 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] Why are some newer rules formatted differently in crs_41_sqli?

Hello,

I'm updating CRS versions, and see just over 20 newer rules in CRS_41_sqli that name a tx variable (the one that's set equal to %{tx.0}) using a different format than any of the other rules in the CRS (e.g. rule id:981243). The value of %{tx.msg} is added to the variable name, instead of just %{rule.id<http://rule.id>}, which seems a bit unnecessary, and not quite as clean. This variable is usually used to check that a rule matched a particular parameter prior to adjusting  the anomaly score, so this creates some inconsistencies when writing score adjustments, since %{tx.msg} contains spaces.


The variable is typically named like this:

setvar:tx.%{rule.id<http://rule.id>}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}

And a typical score adjustment would look like this:

SecRule &TX:981243-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar "@ge 1" "setvar:tx.anomaly_score=-%{tx.critical_anomaly_score}"



With this handful of newer rules, the variable is named like this:

setvar:tx.%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}

The only way I could figure to write a score adjustment for these was with regex (note: the regex wouldn't work with metacharacters, like \s for a space), like this:

SecRule &TX:'/981243-Detects.classic.SQL.injection.probings.2/2-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar/' "@ge 1" "setvar:tx.anomaly_score=-%{tx.critical_
anomaly_score}"


Is there any reason the format for this has changed, or is different for these rules? Is there a cleaner or more consistent way to write adjustments for these rules?

Thanks in advance,
Dusty

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140605/ffe9fc87/attachment.html>

From one2net at gmail.com  Fri Jun 13 07:35:30 2014
From: one2net at gmail.com (ONE2NET)
Date: Fri, 13 Jun 2014 09:35:30 +0200
Subject: [Owasp-modsecurity-core-rule-set]
	modsecurity_slr_50_malware_detection.conf"] [line "25"] [id
	"2200001"]
Message-ID: <CAD+qZx4gZV7BTG1H_qTNaCcJyENu7pjX9zgXWtGNhnb8kqg2zg@mail.gmail.com>

Hello

We have recently noticed  a lots of strange logs.

It occurs on several web site (WordPress sites, static web sites...)

ModSecurity: Access denied with code 403 (phase 4). Matched phrase
"http://" at RESPONSE_HEADERS:Location. [file
"/home/share/modsecurity/rules_slr/modsecurity_slr_50_malware_detection.conf"]
[line "25"] [id "2200001"] [msg "Known Malicious Code Detected in
Response Data."] [severity "WARNING"] [tag "MALICIOUS_CODE"]

All warning seem triggered whenever a forwarding is in place (http
header / htaccess...)
Basically no redirection or forwarding is working!

Any advices ?

Thanks a lot.

Pierre

From soeren.christian.aarup at dibs.dk  Tue Jun 24 11:36:31 2014
From: soeren.christian.aarup at dibs.dk (=?Windows-1252?Q?S=F8ren_Christian_Aarup?=)
Date: Tue, 24 Jun 2014 11:36:31 +0000
Subject: [Owasp-modsecurity-core-rule-set] application/json-rpc
In-Reply-To: <CFCF2EF6.1713B1%scaa@dibs.dk>
Message-ID: <CFCF2F75.1713B5%scaa@dibs.dk>

Hi guys.

N00b here. Trying to tweak the rules, so they work with our applications here. Current obstacle is:

Message: JSON support was not enabled
Message: Access denied with code 400 (phase 2). Match of "eq 0" against "REQBODY_ERROR" required. [file "/usr/local/nginx/conf/modsecurity.conf"] [line "82"] [id "200002"] [msg "Failed to parse request body."] [data ""] [severity "CRITICAL?]

The Content-Type is "application/json-rpc? so I added the following:

SecRule REQUEST_HEADERS:Content-Type "application/json-rpc" \
     "id:'44441',phase:1,t:none,t:lowercase,pass,nolog,ctl:requestBodyProcessor=JSON?

Which didn?t help me. The reference manual doesn?t say much about adding support for JSON. Can you help out?

Thanks-


Regards

S?ren Christian Aarup
DBA/System Administrator

LinkedIn: www.linkedin.com/in/aarup<http://www.linkedin.com/in/aarup>
[DIBS - Payments made easy]<http://www.dibs.dk/>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140624/e3ee758e/attachment.html>

From soeren.christian.aarup at dibs.dk  Wed Jun 25 07:54:49 2014
From: soeren.christian.aarup at dibs.dk (=?Windows-1252?Q?S=F8ren_Christian_Aarup?=)
Date: Wed, 25 Jun 2014 07:54:49 +0000
Subject: [Owasp-modsecurity-core-rule-set] http headers
Message-ID: <CFD04D20.171434%scaa@dibs.dk>

Hi guys.

We have a large number of apache servers with nginx+modsecurity in front as reverse proxies. On the apache?s we add ?X-Server-Name: <webserver>? to the http response header.  This is used to investigate problems, so we can see which of the webservers suffer from a potential problem etc. However after putting modsecurity/nginx in front of the apaches, this field is now removed from the response-header. The modsec log does not say anything about it removing it, but if I disable modsec I get the header. So I assume it?s a part of modsec, not sure if it?s a part of the owasp crs though.

Here?s the thing; I would like this functionality, but wouldn?t it be cool if I could trigger this response-header by adding some ?secret? text to my request? Like http://webserver.com?SHOWMETHEHEADER would pass this header-field from the apache?s response-header all the way back to the client on the other side of modsecurity. Problem is, I don?t know how :) Hints are appreciated.

Thank you.


Regards

S?ren Christian Aarup
DBA/System Administrator

LinkedIn: www.linkedin.com/in/aarup<http://www.linkedin.com/in/aarup>
[DIBS - Payments made easy]<http://www.dibs.dk/>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140625/5bf4f654/attachment.html>

From dtrivedi at sapient.com  Wed Jun 25 11:26:04 2014
From: dtrivedi at sapient.com (Deepak Trivedi)
Date: Wed, 25 Jun 2014 11:26:04 +0000
Subject: [Owasp-modsecurity-core-rule-set] Validation rules for standard
	Http headers
Message-ID: <4D2CD88621423B4E86A15684C07DEEFF62EE2948@DLUMAIL03.sapient.com>

Hi,

I want to have the validation rules for the standard HTTP headers in my application.
I need the whitelist of the characters for these headers to validate against.

The list of the headers are :
Referer

user-agent

authorization

from

content-type

content-length

accept-charset

accept-encoding

accept-language

accept

host

if-match

if-none-match

if-range

if-unmodified-since

max-forwards

proxy-authorization

proxy-connection

range

cookie

expires

date


Can you please guide me on this. Any help is very much appreciated.

Thanks,
Deepak
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140625/2c218855/attachment.html>

From soeren.christian.aarup at dibs.dk  Thu Jun 26 07:24:08 2014
From: soeren.christian.aarup at dibs.dk (=?iso-8859-1?Q?S=F8ren_Christian_Aarup?=)
Date: Thu, 26 Jun 2014 07:24:08 +0000
Subject: [Owasp-modsecurity-core-rule-set] Header-fields missing with
	DetectionOnly mode
Message-ID: <CFD19772.171B9B%scaa@dibs.dk>

Hi guys.

I do not understand why modsecurity removes stuff from my http-response-headers in detection mode? I am using nginx 1.6 and modsecurity 2.8.

Response headers:
Without modsecurity-module loaded:
HTTP/1.1 200 OK
Server: nginx/1.6.0
Date: Thu, 26 Jun 2014 07:04:31 GMT
Content-Type: text/html
Connection: keep-alive
Set-Cookie: PMLCID=XXXXXXXXXXXXXXXXXXXXXX;  expires=Sat, 26-Jul-14 07:04:31 GMT;path=/; secure; HttpOnly
X-Server-Name: server22
P3P: CP="NON DSP CURa CUSa OUR NOR STA"
Content-Length: 13809

With modsecurity-module enabled but with "SecRuleEngine DetectionOnly"
HTTP/1.1 200 OK
Server: nginx/1.6.0
Date: Thu, 26 Jun 2014 07:07:47 GMT
Content-Type: text/html
Connection: keep-alive
Set-Cookie: PMLCID=XXXXXXXXXXXXXXXXXXXXXX;  expires=Sat, 26-Jul-14 07:07:47 GMT;path=/; secure; HttpOnly
Content-Length: 13809


Med venlig hilsen/Regards

S?ren Christian Aarup
DBA/System Administrator

LinkedIn: www.linkedin.com/in/aarup<http://www.linkedin.com/in/aarup>
[DIBS - Payments made easy]<http://www.dibs.dk/>


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140626/58edca44/attachment.html>

From ilyassikai at gmail.com  Thu Jun 26 12:19:15 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Thu, 26 Jun 2014 13:19:15 +0100
Subject: [Owasp-modsecurity-core-rule-set] =?utf-8?q?Probl=C3=A8me_with_Fa?=
	=?utf-8?q?lse_Positives?=
Message-ID: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>

Hi guys.

I not understand why modsecurity blocking my request with the character "?"
in french.
log:

*--169a1612-A--*

*[26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ *

*--169a1612-B--*

*POST /beta/societe-xxxxxr HTTP/1.1*

*Host: www.xxxx.xx*

*User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0) Gecko/20100101
Firefox/30.0*

*Accept: */**

*Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3*

*Accept-Encoding: gzip, deflate*

*Content-Type: application/x-www-form-urlencoded; charset=UTF-8*

*X-Requested-With: XMLHttpRequest*

*Referer: http://www.xxx.xxx/beta/societe-xxxx
<http://www.xxx.xxx/beta/societe-xxxx>*

*Content-Length: 760*

*Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
__utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
__utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
__utmb=111125463.24.10.1403772965; __utmc=111125463;
JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08*

*Connection: keep-alive*

*Pragma: no-cache*

*Cache-Control: no-cache*


 *--169a1612-C--*

*codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr
<http://40hotmail.fr>&emailUser=nabilchant%40hotmail.fr
<http://40hotmail.fr>&id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=*

*--169a1612-F--*

*HTTP/1.1 403 Forbidden*

*Content-Length: 245*

*Connection: close*

*Content-Type: text/html; charset=iso-8859-1*


 *--169a1612-E--*


 *--169a1612-H--*

*Message: Access denied with code 403 (phase 2). Pattern match "\\W{4,}" at
ARGS:dateContribution. [file
"/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
[line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly Detection
Alert - Repetative Non-Word Characters"] [data "Matched Data:  \xc3\xa0
found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
"OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]*

*Action: Intercepted (phase 2)*

*Apache-Handler: proxy-server*

*Stopwatch: 1403776137380257 11043 (- - -)*

*Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399, p3=0,
p4=0, p5=19, sr=37, sw=0, l=0, gc=0*

*Response-Body-Transformed: Dechunked*

*Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
<http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*

*Server: Apache*

*Engine-Mode: "ENABLED"*


 *--169a1612-Z--*


 how to allow these types of characters.
thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140626/3e0abe93/attachment.html>

From jamuse at owasp.org  Thu Jun 26 12:44:40 2014
From: jamuse at owasp.org (Josh Amishav-Zlatin)
Date: Thu, 26 Jun 2014 15:44:40 +0300
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
Message-ID: <CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>

On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <ilyassikai at gmail.com> wrote:

> Hi guys.
>
> I not understand why modsecurity blocking my request with the character
> "?" in french.
> log:
>

Hi Ilyass,

Take a look at the SecUnicodeCodePage and SecUnicodeMapFile directives. For
more information see:

http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html

--
 - Josh





>
> *--169a1612-A--*
>
> *[26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ *
>
> *--169a1612-B--*
>
> *POST /beta/societe-xxxxxr HTTP/1.1*
>
> *Host: www.xxxx.xx*
>
> *User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0) Gecko/20100101
> Firefox/30.0*
>
> *Accept: */**
>
> *Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3*
>
> *Accept-Encoding: gzip, deflate*
>
> *Content-Type: application/x-www-form-urlencoded; charset=UTF-8*
>
> *X-Requested-With: XMLHttpRequest*
>
> *Referer: http://www.xxx.xxx/beta/societe-xxxx
> <http://www.xxx.xxx/beta/societe-xxxx>*
>
> *Content-Length: 760*
>
> *Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
> __utmb=111125463.24.10.1403772965; __utmc=111125463;
> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08*
>
> *Connection: keep-alive*
>
> *Pragma: no-cache*
>
> *Cache-Control: no-cache*
>
>
>  *--169a1612-C--*
>
> *codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr
> <http://40hotmail.fr>&emailUser=nabilchant%40hotmail.fr
> <http://40hotmail.fr>&id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=*
>
> *--169a1612-F--*
>
> *HTTP/1.1 403 Forbidden*
>
> *Content-Length: 245*
>
> *Connection: close*
>
> *Content-Type: text/html; charset=iso-8859-1*
>
>
>  *--169a1612-E--*
>
>
>  *--169a1612-H--*
>
> *Message: Access denied with code 403 (phase 2). Pattern match "\\W{4,}"
> at ARGS:dateContribution. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly Detection
> Alert - Repetative Non-Word Characters"] [data "Matched Data:  \xc3\xa0
> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]*
>
> *Action: Intercepted (phase 2)*
>
> *Apache-Handler: proxy-server*
>
> *Stopwatch: 1403776137380257 11043 (- - -)*
>
> *Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399, p3=0,
> p4=0, p5=19, sr=37, sw=0, l=0, gc=0*
>
> *Response-Body-Transformed: Dechunked*
>
> *Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
> <http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*
>
> *Server: Apache*
>
> *Engine-Mode: "ENABLED"*
>
>
>  *--169a1612-Z--*
>
>
>  how to allow these types of characters.
> thank you.
>
>
>
>
>
>
>
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140626/7591886d/attachment.html>

From ilyassikai at gmail.com  Thu Jun 26 14:43:50 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Thu, 26 Jun 2014 15:43:50 +0100
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
Message-ID: <CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>

Hi Josh.

It's work very good thank you :) :) :)

I have another block :(   please help me
log:



--9b18757a-A--

[26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK

--9b18757a-B--

POST /beta/societe-contribEnt HTTP/1.1

Host: www.
?xxxx
.
?xxx

User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
Gecko/20100101 Firefox/30.0

Accept: */*

Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3

Accept-Encoding: gzip, deflate

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

X-Requested-With: XMLHttpRequest

Referer: http://www.
?xxxx
.ma/beta/
?xxxxx
?action=edit

Content-Length: 1735

Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
__utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
__utmb=111125463.7.10.1403792976; __utmc=111125463;
__utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)

Connection: keep-alive

Pragma: no-cache

Cache-Control: no-cache


--9b18757a-C--

codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%
40inforisk.ma
&telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=
www.inforisk.ma
&telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%
40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1

--9b18757a-F--

HTTP/1.1 403 Forbidden

Content-Length: 225

Connection: close

Content-Type: text/html; charset=iso-8859-1


--9b18757a-E--


--9b18757a-H--

Message: Access denied with code 403 (phase 2). Pattern match
"([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
at ARGS:telfaxmailweb_1_171833. [file
"/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
[line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
Detection Alert - Total # of special characters exceeded"] [data "Matched
Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"] [ver
"OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
"OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]

Action: Intercepted (phase 2)

Apache-Handler: proxy-server

Stopwatch: 1403793315275899 22265 (- - -)

Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377, p3=0,
p4=0, p5=20, sr=28, sw=0, l=0, gc=0

Response-Body-Transformed: Dechunked

Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
OWASP_CRS/2.2.9.

Server: Apache

Engine-Mode: "ENABLED"


--9b18757a-Z--





2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:

> On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <ilyassikai at gmail.com>
> wrote:
>
>> Hi guys.
>>
>> I not understand why modsecurity blocking my request with the character
>> "?" in french.
>> log:
>>
>
> Hi Ilyass,
>
> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile directives.
> For more information see:
>
> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>
> --
>  - Josh
>
>
>
>
>
>>
>> *--169a1612-A--*
>>
>> *[26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ *
>>
>> *--169a1612-B--*
>>
>> *POST /beta/societe-xxxxxr HTTP/1.1*
>>
>> *Host: www.xxxx.xx*
>>
>> *User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0) Gecko/20100101
>> Firefox/30.0*
>>
>> *Accept: */**
>>
>> *Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3*
>>
>> *Accept-Encoding: gzip, deflate*
>>
>> *Content-Type: application/x-www-form-urlencoded; charset=UTF-8*
>>
>> *X-Requested-With: XMLHttpRequest*
>>
>> *Referer: http://www.xxx.xxx/beta/societe-xxxx
>> <http://www.xxx.xxx/beta/societe-xxxx>*
>>
>> *Content-Length: 760*
>>
>> *Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08*
>>
>> *Connection: keep-alive*
>>
>> *Pragma: no-cache*
>>
>> *Cache-Control: no-cache*
>>
>>
>>  *--169a1612-C--*
>>
>> *codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr
>> <http://40hotmail.fr>&emailUser=nabilchant%40hotmail.fr
>> <http://40hotmail.fr>&id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=*
>>
>> *--169a1612-F--*
>>
>> *HTTP/1.1 403 Forbidden*
>>
>> *Content-Length: 245*
>>
>> *Connection: close*
>>
>> *Content-Type: text/html; charset=iso-8859-1*
>>
>>
>>  *--169a1612-E--*
>>
>>
>>  *--169a1612-H--*
>>
>> *Message: Access denied with code 403 (phase 2). Pattern match "\\W{4,}"
>> at ARGS:dateContribution. [file
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly Detection
>> Alert - Repetative Non-Word Characters"] [data "Matched Data:  \xc3\xa0
>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]*
>>
>> *Action: Intercepted (phase 2)*
>>
>> *Apache-Handler: proxy-server*
>>
>> *Stopwatch: 1403776137380257 11043 (- - -)*
>>
>> *Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399, p3=0,
>> p4=0, p5=19, sr=37, sw=0, l=0, gc=0*
>>
>> *Response-Body-Transformed: Dechunked*
>>
>> *Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
>> <http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*
>>
>> *Server: Apache*
>>
>> *Engine-Mode: "ENABLED"*
>>
>>
>>  *--169a1612-Z--*
>>
>>
>>  how to allow these types of characters.
>> thank you.
>>
>>
>>
>>
>>
>>
>>
>>
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>
>>
>


-- 
*Ilyass kaouam*
*Systems administrator*
* at Inforisk Group Finaccess  *
*European Masters in Information Technology*
*Portable : (212) *
*6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140626/67de8a78/attachment-0001.html>

From jamuse at owasp.org  Fri Jun 27 07:04:31 2014
From: jamuse at owasp.org (Josh Amishav-Zlatin)
Date: Fri, 27 Jun 2014 10:04:31 +0300
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
Message-ID: <CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>

On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com> wrote:

> Hi Josh.
>
> It's work very good thank you :) :) :)
>
> I have another block :(   please help me
>

Hi Ilyass,

In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
value. Try using the SecRuleUpdateTargetById directive, e.g.
SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833

For details see:
http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html

--
 - Josh


> log:
>
>
>
> --9b18757a-A--
>
> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
>
> --9b18757a-B--
>
> POST /beta/societe-contribEnt HTTP/1.1
>
> Host: www.
> ?xxxx
> .
> ?xxx
>
> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
> Gecko/20100101 Firefox/30.0
>
> Accept: */*
>
> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>
> Accept-Encoding: gzip, deflate
>
> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>
> X-Requested-With: XMLHttpRequest
>
> Referer: http://www.
> ?xxxx
> .ma/beta/
> ?xxxxx
> ?action=edit
>
> Content-Length: 1735
>
> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
> __utmb=111125463.7.10.1403792976; __utmc=111125463;
> __utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>
> Connection: keep-alive
>
> Pragma: no-cache
>
> Cache-Control: no-cache
>
>
> --9b18757a-C--
>
>
> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%
> 40inforisk.ma
> &telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=
> www.inforisk.ma
> &telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%
> 40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
>
> --9b18757a-F--
>
> HTTP/1.1 403 Forbidden
>
> Content-Length: 225
>
> Connection: close
>
> Content-Type: text/html; charset=iso-8859-1
>
>
> --9b18757a-E--
>
>
> --9b18757a-H--
>
> Message: Access denied with code 403 (phase 2). Pattern match
> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
> at ARGS:telfaxmailweb_1_171833. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
> Detection Alert - Total # of special characters exceeded"] [data "Matched
> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"] [ver
> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>
> Action: Intercepted (phase 2)
>
> Apache-Handler: proxy-server
>
> Stopwatch: 1403793315275899 22265 (- - -)
>
> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377, p3=0,
> p4=0, p5=20, sr=28, sw=0, l=0, gc=0
>
> Response-Body-Transformed: Dechunked
>
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> OWASP_CRS/2.2.9.
>
> Server: Apache
>
> Engine-Mode: "ENABLED"
>
>
> --9b18757a-Z--
>
>
>
>
>
> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>
> On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>> wrote:
>>
>>> Hi guys.
>>>
>>> I not understand why modsecurity blocking my request with the character
>>> "?" in french.
>>> log:
>>>
>>
>> Hi Ilyass,
>>
>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile directives.
>> For more information see:
>>
>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>>
>> --
>>  - Josh
>>
>>
>>
>>
>>
>>>
>>> *--169a1612-A--*
>>>
>>> *[26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ *
>>>
>>> *--169a1612-B--*
>>>
>>> *POST /beta/societe-xxxxxr HTTP/1.1*
>>>
>>> *Host: www.xxxx.xx*
>>>
>>> *User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0) Gecko/20100101
>>> Firefox/30.0*
>>>
>>> *Accept: */**
>>>
>>> *Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3*
>>>
>>> *Accept-Encoding: gzip, deflate*
>>>
>>> *Content-Type: application/x-www-form-urlencoded; charset=UTF-8*
>>>
>>> *X-Requested-With: XMLHttpRequest*
>>>
>>> *Referer: http://www.xxx.xxx/beta/societe-xxxx
>>> <http://www.xxx.xxx/beta/societe-xxxx>*
>>>
>>> *Content-Length: 760*
>>>
>>> *Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08*
>>>
>>> *Connection: keep-alive*
>>>
>>> *Pragma: no-cache*
>>>
>>> *Cache-Control: no-cache*
>>>
>>>
>>>  *--169a1612-C--*
>>>
>>> *codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr
>>> <http://40hotmail.fr>&emailUser=nabilchant%40hotmail.fr
>>> <http://40hotmail.fr>&id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=*
>>>
>>> *--169a1612-F--*
>>>
>>> *HTTP/1.1 403 Forbidden*
>>>
>>> *Content-Length: 245*
>>>
>>> *Connection: close*
>>>
>>> *Content-Type: text/html; charset=iso-8859-1*
>>>
>>>
>>>  *--169a1612-E--*
>>>
>>>
>>>  *--169a1612-H--*
>>>
>>> *Message: Access denied with code 403 (phase 2). Pattern match "\\W{4,}"
>>> at ARGS:dateContribution. [file
>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly Detection
>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:  \xc3\xa0
>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]*
>>>
>>> *Action: Intercepted (phase 2)*
>>>
>>> *Apache-Handler: proxy-server*
>>>
>>> *Stopwatch: 1403776137380257 11043 (- - -)*
>>>
>>> *Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399, p3=0,
>>> p4=0, p5=19, sr=37, sw=0, l=0, gc=0*
>>>
>>> *Response-Body-Transformed: Dechunked*
>>>
>>> *Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
>>> <http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*
>>>
>>> *Server: Apache*
>>>
>>> *Engine-Mode: "ENABLED"*
>>>
>>>
>>>  *--169a1612-Z--*
>>>
>>>
>>>  how to allow these types of characters.
>>> thank you.
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>>
>>> _______________________________________________
>>> Owasp-modsecurity-core-rule-set mailing list
>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>>
>>>
>>
>
>
> --
> *Ilyass kaouam*
> *Systems administrator*
> * at Inforisk Group Finaccess  *
> *European Masters in Information Technology*
> *Portable : (212) *
> *6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140627/8d97e8b0/attachment-0001.html>

From ilyassikai at gmail.com  Fri Jun 27 14:41:03 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Fri, 27 Jun 2014 15:41:03 +0100
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
	<CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
Message-ID: <CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>

hi thank you for your replay
BUT the problem is that the number    telfaxmailweb*_1_**171833*   /
telfaxmailweb*_1_142609*   .... changes (non-static).
have you an idea

thank you


2014-06-27 8:04 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:

> On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com>
> wrote:
>
>> Hi Josh.
>>
>> It's work very good thank you :) :) :)
>>
>> I have another block :(   please help me
>>
>
> Hi Ilyass,
>
> In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
> value. Try using the SecRuleUpdateTargetById directive, e.g.
> SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833
>
> For details see:
>
> http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html
>
> --
>  - Josh
>
>
>>  log:
>>
>>
>>
>> --9b18757a-A--
>>
>> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
>>
>> --9b18757a-B--
>>
>> POST /beta/societe-contribEnt HTTP/1.1
>>
>> Host: www.
>> ?xxxx
>> .
>> ?xxx
>>
>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
>> Gecko/20100101 Firefox/30.0
>>
>> Accept: */*
>>
>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>>
>> Accept-Encoding: gzip, deflate
>>
>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>
>> X-Requested-With: XMLHttpRequest
>>
>> Referer: http://www.
>> ?xxxx
>> .ma/beta/
>> ?xxxxx
>> ?action=edit
>>
>> Content-Length: 1735
>>
>> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
>> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
>> __utmb=111125463.7.10.1403792976; __utmc=111125463;
>> __utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>>
>> Connection: keep-alive
>>
>> Pragma: no-cache
>>
>> Cache-Control: no-cache
>>
>>
>> --9b18757a-C--
>>
>>
>> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%
>> 40inforisk.ma
>> &telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=
>> www.inforisk.ma
>> &telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%
>> 40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
>>
>> --9b18757a-F--
>>
>> HTTP/1.1 403 Forbidden
>>
>> Content-Length: 225
>>
>> Connection: close
>>
>> Content-Type: text/html; charset=iso-8859-1
>>
>>
>> --9b18757a-E--
>>
>>
>> --9b18757a-H--
>>
>> Message: Access denied with code 403 (phase 2). Pattern match
>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>> at ARGS:telfaxmailweb_1_171833. [file
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
>> Detection Alert - Total # of special characters exceeded"] [data "Matched
>> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"] [ver
>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>>
>> Action: Intercepted (phase 2)
>>
>> Apache-Handler: proxy-server
>>
>> Stopwatch: 1403793315275899 22265 (- - -)
>>
>> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377, p3=0,
>> p4=0, p5=20, sr=28, sw=0, l=0, gc=0
>>
>> Response-Body-Transformed: Dechunked
>>
>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>> OWASP_CRS/2.2.9.
>>
>> Server: Apache
>>
>> Engine-Mode: "ENABLED"
>>
>>
>> --9b18757a-Z--
>>
>>
>>
>>
>>
>> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>>
>>  On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>>> wrote:
>>>
>>>> Hi guys.
>>>>
>>>> I not understand why modsecurity blocking my request with the
>>>> character "?" in french.
>>>> log:
>>>>
>>>
>>> Hi Ilyass,
>>>
>>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile directives.
>>> For more information see:
>>>
>>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>>>
>>> --
>>>  - Josh
>>>
>>>
>>>
>>>
>>>
>>>>
>>>> *--169a1612-A--*
>>>>
>>>> *[26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ *
>>>>
>>>> *--169a1612-B--*
>>>>
>>>> *POST /beta/societe-xxxxxr HTTP/1.1*
>>>>
>>>> *Host: www.xxxx.xx*
>>>>
>>>> *User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0)
>>>> Gecko/20100101 Firefox/30.0*
>>>>
>>>> *Accept: */**
>>>>
>>>> *Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3*
>>>>
>>>> *Accept-Encoding: gzip, deflate*
>>>>
>>>> *Content-Type: application/x-www-form-urlencoded; charset=UTF-8*
>>>>
>>>> *X-Requested-With: XMLHttpRequest*
>>>>
>>>> *Referer: http://www.xxx.xxx/beta/societe-xxxx
>>>> <http://www.xxx.xxx/beta/societe-xxxx>*
>>>>
>>>> *Content-Length: 760*
>>>>
>>>> *Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>>>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
>>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08*
>>>>
>>>> *Connection: keep-alive*
>>>>
>>>> *Pragma: no-cache*
>>>>
>>>> *Cache-Control: no-cache*
>>>>
>>>>
>>>>  *--169a1612-C--*
>>>>
>>>> *codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr
>>>> <http://40hotmail.fr>&emailUser=nabilchant%40hotmail.fr
>>>> <http://40hotmail.fr>&id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=*
>>>>
>>>> *--169a1612-F--*
>>>>
>>>> *HTTP/1.1 403 Forbidden*
>>>>
>>>> *Content-Length: 245*
>>>>
>>>> *Connection: close*
>>>>
>>>> *Content-Type: text/html; charset=iso-8859-1*
>>>>
>>>>
>>>>  *--169a1612-E--*
>>>>
>>>>
>>>>  *--169a1612-H--*
>>>>
>>>> *Message: Access denied with code 403 (phase 2). Pattern match
>>>> "\\W{4,}" at ARGS:dateContribution. [file
>>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
>>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly Detection
>>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:  \xc3\xa0
>>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]*
>>>>
>>>> *Action: Intercepted (phase 2)*
>>>>
>>>> *Apache-Handler: proxy-server*
>>>>
>>>> *Stopwatch: 1403776137380257 11043 (- - -)*
>>>>
>>>> *Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399,
>>>> p3=0, p4=0, p5=19, sr=37, sw=0, l=0, gc=0*
>>>>
>>>> *Response-Body-Transformed: Dechunked*
>>>>
>>>> *Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
>>>> <http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*
>>>>
>>>> *Server: Apache*
>>>>
>>>> *Engine-Mode: "ENABLED"*
>>>>
>>>>
>>>>  *--169a1612-Z--*
>>>>
>>>>
>>>>  how to allow these types of characters.
>>>> thank you.
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> _______________________________________________
>>>> Owasp-modsecurity-core-rule-set mailing list
>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>>>
>>>>
>>>
>>
>>
>> --
>> *Ilyass kaouam*
>> *Systems administrator*
>> * at Inforisk Group Finaccess  *
>> *European Masters in Information Technology*
>> *Portable : (212) *
>> *6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
>>
>
>


-- 
*Ilyass kaouam*
*Systems administrator*
* at Inforisk Group Finaccess  *
*European Masters in Information Technology*
*Portable : (212) *
*6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140627/91be6bb0/attachment-0001.html>

From jamuse at owasp.org  Fri Jun 27 14:57:29 2014
From: jamuse at owasp.org (Josh Amishav-Zlatin)
Date: Fri, 27 Jun 2014 17:57:29 +0300
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
	<CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
	<CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>
Message-ID: <CAC+O4mHMsXV7mRR7a6OVQ+zNR9W_j82VMn64G-tBzV3jXjHYVQ@mail.gmail.com>

On Fri, Jun 27, 2014 at 5:41 PM, Ilyass Kaouam <ilyassikai at gmail.com> wrote:

> hi thank you for your replay
> BUT the problem is that the number    telfaxmailweb*_1_**171833*   /
> telfaxmailweb*_1_142609*   .... changes (non-static).
> have you an idea
>
>
Hi Ilyass,

Try using a regex in your exception, e.g.:
SecRuleUpdateTargetById 960024 !ARGS:/telfaxmailweb/

--
 - Josh


> thank you
>
>
> 2014-06-27 8:04 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>
> On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>> wrote:
>>
>>> Hi Josh.
>>>
>>> It's work very good thank you :) :) :)
>>>
>>> I have another block :(   please help me
>>>
>>
>> Hi Ilyass,
>>
>> In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
>> value. Try using the SecRuleUpdateTargetById directive, e.g.
>> SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833
>>
>> For details see:
>>
>> http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html
>>
>> --
>>  - Josh
>>
>>
>>>  log:
>>>
>>>
>>>
>>> --9b18757a-A--
>>>
>>> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
>>>
>>> --9b18757a-B--
>>>
>>> POST /beta/societe-contribEnt HTTP/1.1
>>>
>>> Host: www.
>>> ?xxxx
>>> .
>>> ?xxx
>>>
>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
>>> Gecko/20100101 Firefox/30.0
>>>
>>> Accept: */*
>>>
>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>>>
>>> Accept-Encoding: gzip, deflate
>>>
>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>>
>>> X-Requested-With: XMLHttpRequest
>>>
>>> Referer: http://www.
>>> ?xxxx
>>> .ma/beta/
>>> ?xxxxx
>>> ?action=edit
>>>
>>> Content-Length: 1735
>>>
>>> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
>>> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
>>> __utmb=111125463.7.10.1403792976; __utmc=111125463;
>>> __utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>>>
>>> Connection: keep-alive
>>>
>>> Pragma: no-cache
>>>
>>> Cache-Control: no-cache
>>>
>>>
>>> --9b18757a-C--
>>>
>>>
>>> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%
>>> 40inforisk.ma
>>> &telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=
>>> www.inforisk.ma
>>> &telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%
>>> 40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
>>>
>>> --9b18757a-F--
>>>
>>> HTTP/1.1 403 Forbidden
>>>
>>> Content-Length: 225
>>>
>>> Connection: close
>>>
>>> Content-Type: text/html; charset=iso-8859-1
>>>
>>>
>>> --9b18757a-E--
>>>
>>>
>>> --9b18757a-H--
>>>
>>> Message: Access denied with code 403 (phase 2). Pattern match
>>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>>> at ARGS:telfaxmailweb_1_171833. [file
>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
>>> Detection Alert - Total # of special characters exceeded"] [data "Matched
>>> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"] [ver
>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>>>
>>> Action: Intercepted (phase 2)
>>>
>>> Apache-Handler: proxy-server
>>>
>>> Stopwatch: 1403793315275899 22265 (- - -)
>>>
>>> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377,
>>> p3=0, p4=0, p5=20, sr=28, sw=0, l=0, gc=0
>>>
>>> Response-Body-Transformed: Dechunked
>>>
>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>>> OWASP_CRS/2.2.9.
>>>
>>> Server: Apache
>>>
>>> Engine-Mode: "ENABLED"
>>>
>>>
>>> --9b18757a-Z--
>>>
>>>
>>>
>>>
>>>
>>> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>>>
>>>  On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>>>> wrote:
>>>>
>>>>> Hi guys.
>>>>>
>>>>> I not understand why modsecurity blocking my request with the
>>>>> character "?" in french.
>>>>> log:
>>>>>
>>>>
>>>> Hi Ilyass,
>>>>
>>>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile directives.
>>>> For more information see:
>>>>
>>>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>>>>
>>>> --
>>>>  - Josh
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>>
>>>>> *--169a1612-A--*
>>>>>
>>>>> *[26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ *
>>>>>
>>>>> *--169a1612-B--*
>>>>>
>>>>> *POST /beta/societe-xxxxxr HTTP/1.1*
>>>>>
>>>>> *Host: www.xxxx.xx*
>>>>>
>>>>> *User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0)
>>>>> Gecko/20100101 Firefox/30.0*
>>>>>
>>>>> *Accept: */**
>>>>>
>>>>> *Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3*
>>>>>
>>>>> *Accept-Encoding: gzip, deflate*
>>>>>
>>>>> *Content-Type: application/x-www-form-urlencoded; charset=UTF-8*
>>>>>
>>>>> *X-Requested-With: XMLHttpRequest*
>>>>>
>>>>> *Referer: http://www.xxx.xxx/beta/societe-xxxx
>>>>> <http://www.xxx.xxx/beta/societe-xxxx>*
>>>>>
>>>>> *Content-Length: 760*
>>>>>
>>>>> *Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>>>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>>>>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
>>>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>>>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08*
>>>>>
>>>>> *Connection: keep-alive*
>>>>>
>>>>> *Pragma: no-cache*
>>>>>
>>>>> *Cache-Control: no-cache*
>>>>>
>>>>>
>>>>>  *--169a1612-C--*
>>>>>
>>>>> *codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr
>>>>> <http://40hotmail.fr>&emailUser=nabilchant%40hotmail.fr
>>>>> <http://40hotmail.fr>&id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=*
>>>>>
>>>>> *--169a1612-F--*
>>>>>
>>>>> *HTTP/1.1 403 Forbidden*
>>>>>
>>>>> *Content-Length: 245*
>>>>>
>>>>> *Connection: close*
>>>>>
>>>>> *Content-Type: text/html; charset=iso-8859-1*
>>>>>
>>>>>
>>>>>  *--169a1612-E--*
>>>>>
>>>>>
>>>>>  *--169a1612-H--*
>>>>>
>>>>> *Message: Access denied with code 403 (phase 2). Pattern match
>>>>> "\\W{4,}" at ARGS:dateContribution. [file
>>>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
>>>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly Detection
>>>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:  \xc3\xa0
>>>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
>>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]*
>>>>>
>>>>> *Action: Intercepted (phase 2)*
>>>>>
>>>>> *Apache-Handler: proxy-server*
>>>>>
>>>>> *Stopwatch: 1403776137380257 11043 (- - -)*
>>>>>
>>>>> *Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399,
>>>>> p3=0, p4=0, p5=19, sr=37, sw=0, l=0, gc=0*
>>>>>
>>>>> *Response-Body-Transformed: Dechunked*
>>>>>
>>>>> *Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
>>>>> <http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*
>>>>>
>>>>> *Server: Apache*
>>>>>
>>>>> *Engine-Mode: "ENABLED"*
>>>>>
>>>>>
>>>>>  *--169a1612-Z--*
>>>>>
>>>>>
>>>>>  how to allow these types of characters.
>>>>> thank you.
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>
>>>>> _______________________________________________
>>>>> Owasp-modsecurity-core-rule-set mailing list
>>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>>>>
>>>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>>>>
>>>>>
>>>>
>>>
>>>
>>> --
>>> *Ilyass kaouam*
>>> *Systems administrator*
>>> * at Inforisk Group Finaccess  *
>>> *European Masters in Information Technology*
>>> *Portable : (212) *
>>> *6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
>>>
>>
>>
>
>
> --
> *Ilyass kaouam*
> *Systems administrator*
> * at Inforisk Group Finaccess  *
> *European Masters in Information Technology*
> *Portable : (212) *
> *6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140627/3f65a393/attachment-0001.html>

From jamie.riden at gmail.com  Fri Jun 27 15:08:12 2014
From: jamie.riden at gmail.com (Jamie Riden)
Date: Fri, 27 Jun 2014 16:08:12 +0100
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CAC+O4mHMsXV7mRR7a6OVQ+zNR9W_j82VMn64G-tBzV3jXjHYVQ@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
	<CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
	<CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>
	<CAC+O4mHMsXV7mRR7a6OVQ+zNR9W_j82VMn64G-tBzV3jXjHYVQ@mail.gmail.com>
Message-ID: <CAHno4i9a_8zbAWxhMH+tairqmvKbNCojXnVcaHtLoLnXAKAjxQ@mail.gmail.com>

Would

SecRuleUpdateTargetById 960024 !ARGS:/^telfaxmailweb/

be better in this instance?  (ie. anchor the start of line.)

cheers,
 Jamie

On 27 June 2014 15:57, Josh Amishav-Zlatin <jamuse at owasp.org> wrote:
> On Fri, Jun 27, 2014 at 5:41 PM, Ilyass Kaouam <ilyassikai at gmail.com> wrote:
>>
>> hi thank you for your replay
>> BUT the problem is that the number    telfaxmailweb_1_171833   /
>> telfaxmailweb_1_142609   .... changes (non-static).
>> have you an idea
>>
>
> Hi Ilyass,
>
> Try using a regex in your exception, e.g.:
> SecRuleUpdateTargetById 960024 !ARGS:/telfaxmailweb/
>
> --
>  - Josh
>
>>
>> thank you
>>
>>
>> 2014-06-27 8:04 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>>
>>> On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>>> wrote:
>>>>
>>>> Hi Josh.
>>>>
>>>> It's work very good thank you :) :) :)
>>>>
>>>> I have another block :(   please help me
>>>
>>>
>>> Hi Ilyass,
>>>
>>> In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
>>> value. Try using the SecRuleUpdateTargetById directive, e.g.
>>> SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833
>>>
>>> For details see:
>>>
>>> http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html
>>>
>>> --
>>>  - Josh
>>>
>>>>
>>>> log:
>>>>
>>>>
>>>>
>>>> --9b18757a-A--
>>>>
>>>> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
>>>>
>>>> --9b18757a-B--
>>>>
>>>> POST /beta/societe-contribEnt HTTP/1.1
>>>>
>>>> Host: www.
>>>>
>>>> xxxx
>>>> .
>>>> xxx
>>>>
>>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
>>>> Gecko/20100101 Firefox/30.0
>>>>
>>>> Accept: */*
>>>>
>>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>>>>
>>>> Accept-Encoding: gzip, deflate
>>>>
>>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>>>
>>>> X-Requested-With: XMLHttpRequest
>>>>
>>>> Referer: http://www.
>>>>
>>>> xxxx
>>>> .ma/beta/
>>>> xxxxx
>>>> ?action=edit
>>>>
>>>> Content-Length: 1735
>>>>
>>>> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
>>>> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
>>>> __utmb=111125463.7.10.1403792976; __utmc=111125463;
>>>> __utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>>>>
>>>> Connection: keep-alive
>>>>
>>>> Pragma: no-cache
>>>>
>>>> Cache-Control: no-cache
>>>>
>>>>
>>>> --9b18757a-C--
>>>>
>>>>
>>>> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%40inforisk.ma&telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=www.inforisk.ma&telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
>>>>
>>>> --9b18757a-F--
>>>>
>>>> HTTP/1.1 403 Forbidden
>>>>
>>>> Content-Length: 225
>>>>
>>>> Connection: close
>>>>
>>>> Content-Type: text/html; charset=iso-8859-1
>>>>
>>>>
>>>> --9b18757a-E--
>>>>
>>>>
>>>> --9b18757a-H--
>>>>
>>>> Message: Access denied with code 403 (phase 2). Pattern match
>>>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>>>> at ARGS:telfaxmailweb_1_171833. [file
>>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
>>>> Detection Alert - Total # of special characters exceeded"] [data "Matched
>>>> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"] [ver
>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>>>>
>>>> Action: Intercepted (phase 2)
>>>>
>>>> Apache-Handler: proxy-server
>>>>
>>>> Stopwatch: 1403793315275899 22265 (- - -)
>>>>
>>>> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377,
>>>> p3=0, p4=0, p5=20, sr=28, sw=0, l=0, gc=0
>>>>
>>>> Response-Body-Transformed: Dechunked
>>>>
>>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>>>> OWASP_CRS/2.2.9.
>>>>
>>>> Server: Apache
>>>>
>>>> Engine-Mode: "ENABLED"
>>>>
>>>>
>>>> --9b18757a-Z--
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>>>>
>>>>> On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>>>>> wrote:
>>>>>>
>>>>>> Hi guys.
>>>>>>
>>>>>> I not understand why modsecurity blocking my request with the
>>>>>> character "?" in french.
>>>>>> log:
>>>>>
>>>>>
>>>>> Hi Ilyass,
>>>>>
>>>>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile directives.
>>>>> For more information see:
>>>>>
>>>>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>>>>>
>>>>> --
>>>>>  - Josh
>>>>>
>>>>>
>>>>>
>>>>>
>>>>>>
>>>>>>
>>>>>> --169a1612-A--
>>>>>>
>>>>>> [26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ
>>>>>>
>>>>>> --169a1612-B--
>>>>>>
>>>>>> POST /beta/societe-xxxxxr HTTP/1.1
>>>>>>
>>>>>> Host: www.xxxx.xx
>>>>>>
>>>>>> User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0)
>>>>>> Gecko/20100101 Firefox/30.0
>>>>>>
>>>>>> Accept: */*
>>>>>>
>>>>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>>>>>>
>>>>>> Accept-Encoding: gzip, deflate
>>>>>>
>>>>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>>>>>
>>>>>> X-Requested-With: XMLHttpRequest
>>>>>>
>>>>>> Referer: http://www.xxx.xxx/beta/societe-xxxx
>>>>>>
>>>>>> Content-Length: 760
>>>>>>
>>>>>> Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>>>>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>>>>>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
>>>>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>>>>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08
>>>>>>
>>>>>> Connection: keep-alive
>>>>>>
>>>>>> Pragma: no-cache
>>>>>>
>>>>>> Cache-Control: no-cache
>>>>>>
>>>>>>
>>>>>> --169a1612-C--
>>>>>>
>>>>>>
>>>>>> codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr&emailUser=nabilchant%40hotmail.fr&id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=
>>>>>>
>>>>>> --169a1612-F--
>>>>>>
>>>>>> HTTP/1.1 403 Forbidden
>>>>>>
>>>>>> Content-Length: 245
>>>>>>
>>>>>> Connection: close
>>>>>>
>>>>>> Content-Type: text/html; charset=iso-8859-1
>>>>>>
>>>>>>
>>>>>> --169a1612-E--
>>>>>>
>>>>>>
>>>>>> --169a1612-H--
>>>>>>
>>>>>> Message: Access denied with code 403 (phase 2). Pattern match
>>>>>> "\\W{4,}" at ARGS:dateContribution. [file
>>>>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
>>>>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly Detection
>>>>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:  \xc3\xa0
>>>>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
>>>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]
>>>>>>
>>>>>> Action: Intercepted (phase 2)
>>>>>>
>>>>>> Apache-Handler: proxy-server
>>>>>>
>>>>>> Stopwatch: 1403776137380257 11043 (- - -)
>>>>>>
>>>>>> Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399,
>>>>>> p3=0, p4=0, p5=19, sr=37, sw=0, l=0, gc=0
>>>>>>
>>>>>> Response-Body-Transformed: Dechunked
>>>>>>
>>>>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>>>>>> OWASP_CRS/2.2.9.
>>>>>>
>>>>>> Server: Apache
>>>>>>
>>>>>> Engine-Mode: "ENABLED"
>>>>>>
>>>>>>
>>>>>> --169a1612-Z--
>>>>>>
>>>>>>
>>>>>> how to allow these types of characters.
>>>>>>
>>>>>> thank you.
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>>
>>>>>> _______________________________________________
>>>>>> Owasp-modsecurity-core-rule-set mailing list
>>>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>>>>>
>>>>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>>>>>
>>>>>
>>>>
>>>>
>>>>
>>>> --
>>>> Ilyass kaouam
>>>> Systems administrator at Inforisk Group Finaccess
>>>> European Masters in Information Technology
>>>> Portable : (212) 6 34 57 14 36
>>>> http://www.inforisk.ma
>>>
>>>
>>
>>
>>
>> --
>> Ilyass kaouam
>> Systems administrator at Inforisk Group Finaccess
>> European Masters in Information Technology
>> Portable : (212) 6 34 57 14 36
>> http://www.inforisk.ma
>
>
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>



-- 
Jamie Riden / jamie at honeynet.org / jamie.riden at gmail.com
http://uk.linkedin.com/in/jamieriden

From ilyassikai at gmail.com  Fri Jun 27 15:21:24 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Fri, 27 Jun 2014 16:21:24 +0100
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CAHno4i9a_8zbAWxhMH+tairqmvKbNCojXnVcaHtLoLnXAKAjxQ@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
	<CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
	<CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>
	<CAC+O4mHMsXV7mRR7a6OVQ+zNR9W_j82VMn64G-tBzV3jXjHYVQ@mail.gmail.com>
	<CAHno4i9a_8zbAWxhMH+tairqmvKbNCojXnVcaHtLoLnXAKAjxQ@mail.gmail.com>
Message-ID: <CAMmziWd0gp_7--z+vhA=N3k-FW8aOTu0HfM0rOzqe3uv_iByNg@mail.gmail.com>

Hi

Thank you that work excellent   :) :)

Now when i try connect with Facebook It's block 'false positive'

log:

*--be2b2979-H--*

*Message: Access denied with code 403 (phase 2). Pattern match
"([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
at ARGS:code. [file
"/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
[line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
Detection Alert - Total # of special characters exceeded"] [data "Matched
Data: - found within ARGS:code:
AQAZzUllyzvnMFeI1YdJ7btTKpmdrAZ3VS-n5iyorHDhHpSzG6gpoRuEnzi9nNpX4RY8XP1O8W3WOea-4NjU0r4S1QkiCKwpCea-smSIVe2WxCTEIu4eN7S4YVSENbyes9tTF_dt890NN64DhShsI72t5fusquL_iK7SIfEo03eaYNxIIn0IGAyY0l2IMUusVd24RFBiPKowLjRJrXC4NL02Ine0VJU0Nm57anPrK6gsuzMZG41hHbtWiqsyPtRusewjOOUmTMk0OTrXtm67sOUpCW7emT5gUsGKPlJy_efQ-Q5QTgpl0xcwOffuu4ATeBA"]
[ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
"OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]*

*Action: Intercepted (phase 2)*

*Apache-Handler: proxy-server*

*Stopwatch: 1403881875314702 2150 (- - -)*

*Stopwatch2: 1403881875314702 2150; combined=1886, p1=90, p2=1793, p3=0,
p4=0, p5=3, sr=26, sw=0, l=0, gc=0*

*Response-Body-Transformed: Dechunked*

*Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
<http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*

*Server: Apache*

*Engine-Mode: "ENABLED"*

I can use
SecRuleUpdateTargetById 960024 !ARGS:/^code/

OR it's dangerous ?




2014-06-27 16:08 GMT+01:00 Jamie Riden <jamie.riden at gmail.com>:

> Would
>
> SecRuleUpdateTargetById 960024 !ARGS:/^telfaxmailweb/
>
> be better in this instance?  (ie. anchor the start of line.)
>
> cheers,
>  Jamie
>
> On 27 June 2014 15:57, Josh Amishav-Zlatin <jamuse at owasp.org> wrote:
> > On Fri, Jun 27, 2014 at 5:41 PM, Ilyass Kaouam <ilyassikai at gmail.com>
> wrote:
> >>
> >> hi thank you for your replay
> >> BUT the problem is that the number    telfaxmailweb_1_171833   /
> >> telfaxmailweb_1_142609   .... changes (non-static).
> >> have you an idea
> >>
> >
> > Hi Ilyass,
> >
> > Try using a regex in your exception, e.g.:
> > SecRuleUpdateTargetById 960024 !ARGS:/telfaxmailweb/
> >
> > --
> >  - Josh
> >
> >>
> >> thank you
> >>
> >>
> >> 2014-06-27 8:04 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
> >>
> >>> On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com>
> >>> wrote:
> >>>>
> >>>> Hi Josh.
> >>>>
> >>>> It's work very good thank you :) :) :)
> >>>>
> >>>> I have another block :(   please help me
> >>>
> >>>
> >>> Hi Ilyass,
> >>>
> >>> In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
> >>> value. Try using the SecRuleUpdateTargetById directive, e.g.
> >>> SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833
> >>>
> >>> For details see:
> >>>
> >>>
> http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html
> >>>
> >>> --
> >>>  - Josh
> >>>
> >>>>
> >>>> log:
> >>>>
> >>>>
> >>>>
> >>>> --9b18757a-A--
> >>>>
> >>>> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
> >>>>
> >>>> --9b18757a-B--
> >>>>
> >>>> POST /beta/societe-contribEnt HTTP/1.1
> >>>>
> >>>> Host: www.
> >>>>
> >>>> xxxx
> >>>> .
> >>>> xxx
> >>>>
> >>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
> >>>> Gecko/20100101 Firefox/30.0
> >>>>
> >>>> Accept: */*
> >>>>
> >>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
> >>>>
> >>>> Accept-Encoding: gzip, deflate
> >>>>
> >>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
> >>>>
> >>>> X-Requested-With: XMLHttpRequest
> >>>>
> >>>> Referer: http://www.
> >>>>
> >>>> xxxx
> >>>> .ma/beta/
> >>>> xxxxx
> >>>> ?action=edit
> >>>>
> >>>> Content-Length: 1735
> >>>>
> >>>> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
> >>>> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
> >>>> __utmb=111125463.7.10.1403792976; __utmc=111125463;
> >>>>
> __utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
> >>>>
> >>>> Connection: keep-alive
> >>>>
> >>>> Pragma: no-cache
> >>>>
> >>>> Cache-Control: no-cache
> >>>>
> >>>>
> >>>> --9b18757a-C--
> >>>>
> >>>>
> >>>>
> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%
> 40inforisk.ma
> &telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=
> www.inforisk.ma
> &telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%
> 40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
> >>>>
> >>>> --9b18757a-F--
> >>>>
> >>>> HTTP/1.1 403 Forbidden
> >>>>
> >>>> Content-Length: 225
> >>>>
> >>>> Connection: close
> >>>>
> >>>> Content-Type: text/html; charset=iso-8859-1
> >>>>
> >>>>
> >>>> --9b18757a-E--
> >>>>
> >>>>
> >>>> --9b18757a-H--
> >>>>
> >>>> Message: Access denied with code 403 (phase 2). Pattern match
> >>>>
> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
> >>>> at ARGS:telfaxmailweb_1_171833. [file
> >>>>
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> >>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character
> Anomaly
> >>>> Detection Alert - Total # of special characters exceeded"] [data
> "Matched
> >>>> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"]
> [ver
> >>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
> >>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
> >>>>
> >>>> Action: Intercepted (phase 2)
> >>>>
> >>>> Apache-Handler: proxy-server
> >>>>
> >>>> Stopwatch: 1403793315275899 22265 (- - -)
> >>>>
> >>>> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377,
> >>>> p3=0, p4=0, p5=20, sr=28, sw=0, l=0, gc=0
> >>>>
> >>>> Response-Body-Transformed: Dechunked
> >>>>
> >>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> >>>> OWASP_CRS/2.2.9.
> >>>>
> >>>> Server: Apache
> >>>>
> >>>> Engine-Mode: "ENABLED"
> >>>>
> >>>>
> >>>> --9b18757a-Z--
> >>>>
> >>>>
> >>>>
> >>>>
> >>>>
> >>>> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
> >>>>
> >>>>> On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <ilyassikai at gmail.com
> >
> >>>>> wrote:
> >>>>>>
> >>>>>> Hi guys.
> >>>>>>
> >>>>>> I not understand why modsecurity blocking my request with the
> >>>>>> character "?" in french.
> >>>>>> log:
> >>>>>
> >>>>>
> >>>>> Hi Ilyass,
> >>>>>
> >>>>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile
> directives.
> >>>>> For more information see:
> >>>>>
> >>>>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
> >>>>>
> >>>>> --
> >>>>>  - Josh
> >>>>>
> >>>>>
> >>>>>
> >>>>>
> >>>>>>
> >>>>>>
> >>>>>> --169a1612-A--
> >>>>>>
> >>>>>> [26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ
> >>>>>>
> >>>>>> --169a1612-B--
> >>>>>>
> >>>>>> POST /beta/societe-xxxxxr HTTP/1.1
> >>>>>>
> >>>>>> Host: www.xxxx.xx
> >>>>>>
> >>>>>> User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0)
> >>>>>> Gecko/20100101 Firefox/30.0
> >>>>>>
> >>>>>> Accept: */*
> >>>>>>
> >>>>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
> >>>>>>
> >>>>>> Accept-Encoding: gzip, deflate
> >>>>>>
> >>>>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
> >>>>>>
> >>>>>> X-Requested-With: XMLHttpRequest
> >>>>>>
> >>>>>> Referer: http://www.xxx.xxx/beta/societe-xxxx
> >>>>>>
> >>>>>> Content-Length: 760
> >>>>>>
> >>>>>> Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
> >>>>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
> >>>>>>
> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
> >>>>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
> >>>>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08
> >>>>>>
> >>>>>> Connection: keep-alive
> >>>>>>
> >>>>>> Pragma: no-cache
> >>>>>>
> >>>>>> Cache-Control: no-cache
> >>>>>>
> >>>>>>
> >>>>>> --169a1612-C--
> >>>>>>
> >>>>>>
> >>>>>>
> codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%
> 40hotmail.fr&emailUser=nabilchant%40hotmail.fr
> &id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=
> >>>>>>
> >>>>>> --169a1612-F--
> >>>>>>
> >>>>>> HTTP/1.1 403 Forbidden
> >>>>>>
> >>>>>> Content-Length: 245
> >>>>>>
> >>>>>> Connection: close
> >>>>>>
> >>>>>> Content-Type: text/html; charset=iso-8859-1
> >>>>>>
> >>>>>>
> >>>>>> --169a1612-E--
> >>>>>>
> >>>>>>
> >>>>>> --169a1612-H--
> >>>>>>
> >>>>>> Message: Access denied with code 403 (phase 2). Pattern match
> >>>>>> "\\W{4,}" at ARGS:dateContribution. [file
> >>>>>>
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
> >>>>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly
> Detection
> >>>>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:
>  \xc3\xa0
> >>>>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
> >>>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]
> >>>>>>
> >>>>>> Action: Intercepted (phase 2)
> >>>>>>
> >>>>>> Apache-Handler: proxy-server
> >>>>>>
> >>>>>> Stopwatch: 1403776137380257 11043 (- - -)
> >>>>>>
> >>>>>> Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399,
> >>>>>> p3=0, p4=0, p5=19, sr=37, sw=0, l=0, gc=0
> >>>>>>
> >>>>>> Response-Body-Transformed: Dechunked
> >>>>>>
> >>>>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
> );
> >>>>>> OWASP_CRS/2.2.9.
> >>>>>>
> >>>>>> Server: Apache
> >>>>>>
> >>>>>> Engine-Mode: "ENABLED"
> >>>>>>
> >>>>>>
> >>>>>> --169a1612-Z--
> >>>>>>
> >>>>>>
> >>>>>> how to allow these types of characters.
> >>>>>>
> >>>>>> thank you.
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>>
> >>>>>> _______________________________________________
> >>>>>> Owasp-modsecurity-core-rule-set mailing list
> >>>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
> >>>>>>
> >>>>>>
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> >>>>>>
> >>>>>
> >>>>
> >>>>
> >>>>
> >>>> --
> >>>> Ilyass kaouam
> >>>> Systems administrator at Inforisk Group Finaccess
> >>>> European Masters in Information Technology
> >>>> Portable : (212) 6 34 57 14 36
> >>>> http://www.inforisk.ma
> >>>
> >>>
> >>
> >>
> >>
> >> --
> >> Ilyass kaouam
> >> Systems administrator at Inforisk Group Finaccess
> >> European Masters in Information Technology
> >> Portable : (212) 6 34 57 14 36
> >> http://www.inforisk.ma
> >
> >
> >
> > _______________________________________________
> > Owasp-modsecurity-core-rule-set mailing list
> > Owasp-modsecurity-core-rule-set at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> >
>
>
>
> --
> Jamie Riden / jamie at honeynet.org / jamie.riden at gmail.com
> http://uk.linkedin.com/in/jamieriden
>



-- 
*Ilyass kaouam*
*Systems administrator*
* at Inforisk Group Finaccess  *
*European Masters in Information Technology*
*Portable : (212) *
*6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140627/11ae6cc0/attachment-0001.html>

From ryan.barnett at owasp.org  Fri Jun 27 15:41:26 2014
From: ryan.barnett at owasp.org (Ryan Barnett)
Date: Fri, 27 Jun 2014 11:41:26 -0400
Subject: [Owasp-modsecurity-core-rule-set]
 =?iso-8859-1?q?Probl=E8me__with?= =?iso-8859-1?q?_False_Positives?=
In-Reply-To: <CAMmziWd0gp_7--z+vhA=N3k-FW8aOTu0HfM0rOzqe3uv_iByNg@mail.gmail.com>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
	<CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
	<CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>
	<CAC+O4mHMsXV7mRR7a6OVQ+zNR9W_j82VMn64G-tBzV3jXjHYVQ@mail.gmail.com>
	<CAHno4i9a_8zbAWxhMH+tairqmvKbNCojXnVcaHtLoLnXAKAjxQ@mail.gmail.com>
	<CAMmziWd0gp_7--z+vhA=N3k-FW8aOTu0HfM0rOzqe3uv_iByNg@mail.gmail.com>
Message-ID: <CFD30752.104236%ryan.barnett@owasp.org>

This is what I recommend in these cases -
1. Create a positive security/input validation check against the parameter
that is causing the false positive. In this case it is the "code" parameter.
If it matches the expected input format, then move to step 2.
2. Then use the "ctl:ruleRemoveTargetById" action to conditionally remove
ARGS:code from inspection for rule 981173
The rule would look something like this (not tested)

SecRule ARGS:code "@rx ^[a-zA-z0-9\-_]+$"
"phase:request,id:12345,nolog,pass,ctl:ruleRemoveTargetById=981173;ARGS:code
"

Place this rule in a modsecurity_crs_00_custom.conf file so that it runs
BEFORE the normal CRS rules.

In general, this approach is more secure than just simply removing a
variable from inspection when you encounter a false positive.

-Ryan

From:  Ilyass Kaouam <ilyassikai at gmail.com>
Reply-To:  <ilyassikai at gmail.com>
Date:  Friday, June 27, 2014 11:21 AM
To:  Jamie Riden <jamie.riden at gmail.com>
Cc:  "owasp-modsecurity-core-rule-set at lists.owasp.org"
<owasp-modsecurity-core-rule-set at lists.owasp.org>
Subject:  Re: [Owasp-modsecurity-core-rule-set] Probl?me with False
Positives

> Hi 
> 
> Thank you that work excellent   :) :)
> 
> Now when i try connect with Facebook It's block 'false positive'
> 
> log: 
> --be2b2979-H--
> 
> Message: Access denied with code 403 (phase 2). Pattern match
> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\
> xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}" at ARGS:code. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attack
> s.conf"] [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character
> Anomaly Detection Alert - Total # of special characters exceeded"] [data
> "Matched Data: - found within ARGS:code:
> AQAZzUllyzvnMFeI1YdJ7btTKpmdrAZ3VS-n5iyorHDhHpSzG6gpoRuEnzi9nNpX4RY8XP1O8W3WOe
> a-4NjU0r4S1QkiCKwpCea-smSIVe2WxCTEIu4eN7S4YVSENbyes9tTF_dt890NN64DhShsI72t5fus
> quL_iK7SIfEo03eaYNxIIn0IGAyY0l2IMUusVd24RFBiPKowLjRJrXC4NL02Ine0VJU0Nm57anPrK6
> gsuzMZG41hHbtWiqsyPtRusewjOOUmTMk0OTrXtm67sOUpCW7emT5gUsGKPlJy_efQ-Q5QTgpl0xcw
> Offuu4ATeBA"] [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
> 
> Action: Intercepted (phase 2)
> 
> Apache-Handler: proxy-server
> 
> Stopwatch: 1403881875314702 2150 (- - -)
> 
> Stopwatch2: 1403881875314702 2150; combined=1886, p1=90, p2=1793, p3=0, p4=0,
> p5=3, sr=26, sw=0, l=0, gc=0
> 
> Response-Body-Transformed: Dechunked
> 
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> OWASP_CRS/2.2.9. <http://2.2.9.>
> 
> Server: Apache
> 
> Engine-Mode: "ENABLED"
> 
> 
> I can use 
> SecRuleUpdateTargetById 960024 !ARGS:/^code/
> 
> OR it's dangerous ?
> 
> 
> 
> 
> 2014-06-27 16:08 GMT+01:00 Jamie Riden <jamie.riden at gmail.com>:
>> Would
>> 
>> SecRuleUpdateTargetById 960024 !ARGS:/^telfaxmailweb/
>> 
>> be better in this instance?  (ie. anchor the start of line.)
>> 
>> cheers,
>>  Jamie
>> 
>> On 27 June 2014 15:57, Josh Amishav-Zlatin <jamuse at owasp.org> wrote:
>>> > On Fri, Jun 27, 2014 at 5:41 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>>> wrote:
>>>> >>
>>>> >> hi thank you for your replay
>>>> >> BUT the problem is that the number    telfaxmailweb_1_171833   /
>>>> >> telfaxmailweb_1_142609   .... changes (non-static).
>>>> >> have you an idea
>>>> >>
>>> >
>>> > Hi Ilyass,
>>> >
>>> > Try using a regex in your exception, e.g.:
>>> > SecRuleUpdateTargetById 960024 !ARGS:/telfaxmailweb/
>>> >
>>> > --
>>> >  - Josh
>>> >
>>>> >>
>>>> >> thank you
>>>> >>
>>>> >>
>>>> >> 2014-06-27 8:04 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>>>> >>
>>>>> >>> On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>>>>> >>> wrote:
>>>>>> >>>>
>>>>>> >>>> Hi Josh.
>>>>>> >>>>
>>>>>> >>>> It's work very good thank you :) :) :)
>>>>>> >>>>
>>>>>> >>>> I have another block :(   please help me
>>>>> >>>
>>>>> >>>
>>>>> >>> Hi Ilyass,
>>>>> >>>
>>>>> >>> In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
>>>>> >>> value. Try using the SecRuleUpdateTargetById directive, e.g.
>>>>> >>> SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833
>>>>> >>>
>>>>> >>> For details see:
>>>>> >>>
>>>>> >>> 
>>>>> http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-
>>>>> exception-handling.html
>>>>> >>>
>>>>> >>> --
>>>>> >>>  - Josh
>>>>> >>>
>>>>>> >>>>
>>>>>> >>>> log:
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> --9b18757a-A--
>>>>>> >>>>
>>>>>> >>>> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
>>>>>> >>>>
>>>>>> >>>> --9b18757a-B--
>>>>>> >>>>
>>>>>> >>>> POST /beta/societe-contribEnt HTTP/1.1
>>>>>> >>>>
>>>>>> >>>> Host: www.
>>>>>> >>>>
>>>>>> >>>> xxxx
>>>>>> >>>> .
>>>>>> >>>> xxx
>>>>>> >>>>
>>>>>> >>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
>>>>>> >>>> Gecko/20100101 Firefox/30.0
>>>>>> >>>>
>>>>>> >>>> Accept: */*
>>>>>> >>>>
>>>>>> >>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>>>>>> >>>>
>>>>>> >>>> Accept-Encoding: gzip, deflate
>>>>>> >>>>
>>>>>> >>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>>>>> >>>>
>>>>>> >>>> X-Requested-With: XMLHttpRequest
>>>>>> >>>>
>>>>>> >>>> Referer: http://www.
>>>>>> >>>>
>>>>>> >>>> xxxx
>>>>>> >>>> .ma/beta/
>>>>>> >>>> xxxxx
>>>>>> >>>> ?action=edit
>>>>>> >>>>
>>>>>> >>>> Content-Length: 1735
>>>>>> >>>>
>>>>>> >>>> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
>>>>>> >>>> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
>>>>>> >>>> __utmb=111125463.7.10.1403792976; __utmc=111125463;
>>>>>> >>>> 
>>>>>> 
__utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>>>>>> >>>>
>>>>>> >>>> Connection: keep-alive
>>>>>> >>>>
>>>>>> >>>> Pragma: no-cache
>>>>>> >>>>
>>>>>> >>>> Cache-Control: no-cache
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> --9b18757a-C--
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> 
>>>>>> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&d
>>>>>> enomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&
>>>>>> fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capit
>>>>>> al_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_
>>>>>> dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi
>>>>>> %C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=
>>>>>> &effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty
>>>>>> =&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05
>>>>>> -22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-4
>>>>>> 2-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&tel
>>>>>> faxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_
>>>>>> 2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1
>>>>>> _dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&tel
>>>>>> faxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_
>>>>>> 2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612
>>>>>> =info%40inforisk.ma <http://40inforisk.ma>
>>>>>> &telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirt
>>>>>> y=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&t
>>>>>> elfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=www.inforisk.ma
>>>>>> <http://www.inforisk.ma>
>>>>>> &telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirt
>>>>>> y=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&i
>>>>>> dMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayo
>>>>>> uch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__
>>>>>> -__-__-__-__&tel_31241_dirty=&email_31241=test%40gmail.com
>>>>>> <http://40gmail.com>
>>>>>> &email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
>>>>>> >>>>
>>>>>> >>>> --9b18757a-F--
>>>>>> >>>>
>>>>>> >>>> HTTP/1.1 403 Forbidden
>>>>>> >>>>
>>>>>> >>>> Content-Length: 225
>>>>>> >>>>
>>>>>> >>>> Connection: close
>>>>>> >>>>
>>>>>> >>>> Content-Type: text/html; charset=iso-8859-1
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> --9b18757a-E--
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> --9b18757a-H--
>>>>>> >>>>
>>>>>> >>>> Message: Access denied with code 403 (phase 2). Pattern match
>>>>>> >>>> 
>>>>>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\
>>>>>> \xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>>>>>> >>>> at ARGS:telfaxmailweb_1_171833. [file
>>>>>> >>>> 
>>>>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_a
>>>>>> ttacks.conf"]
>>>>>> >>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character
>>>>>> Anomaly
>>>>>> >>>> Detection Alert - Total # of special characters exceeded"] [data
>>>>>> "Matched
>>>>>> >>>> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"]
[ver
>>>>>> >>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>>>>>> >>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>>>>>> >>>>
>>>>>> >>>> Action: Intercepted (phase 2)
>>>>>> >>>>
>>>>>> >>>> Apache-Handler: proxy-server
>>>>>> >>>>
>>>>>> >>>> Stopwatch: 1403793315275899 22265 (- - -)
>>>>>> >>>>
>>>>>> >>>> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377,
>>>>>> >>>> p3=0, p4=0, p5=20, sr=28, sw=0, l=0, gc=0
>>>>>> >>>>
>>>>>> >>>> Response-Body-Transformed: Dechunked
>>>>>> >>>>
>>>>>> >>>> Producer: ModSecurity for Apache/2.7.3
>>>>>> (http://www.modsecurity.org/);
>>>>>> >>>> OWASP_CRS/2.2.9. <http://2.2.9.>
>>>>>> >>>>
>>>>>> >>>> Server: Apache
>>>>>> >>>>
>>>>>> >>>> Engine-Mode: "ENABLED"
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> --9b18757a-Z--
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>>>>>> >>>>
>>>>>>> >>>>> On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam
>>>>>>> <ilyassikai at gmail.com>
>>>>>>> >>>>> wrote:
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Hi guys.
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> I not understand why modsecurity blocking my request with the
>>>>>>>> >>>>>> character "?" in french.
>>>>>>>> >>>>>> log:
>>>>>>> >>>>>
>>>>>>> >>>>>
>>>>>>> >>>>> Hi Ilyass,
>>>>>>> >>>>>
>>>>>>> >>>>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile
>>>>>>> directives.
>>>>>>> >>>>> For more information see:
>>>>>>> >>>>>
>>>>>>> >>>>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>>>>>>> >>>>>
>>>>>>> >>>>> --
>>>>>>> >>>>>  - Josh
>>>>>>> >>>>>
>>>>>>> >>>>>
>>>>>>> >>>>>
>>>>>>> >>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> --169a1612-A--
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> [26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> --169a1612-B--
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> POST /beta/societe-xxxxxr HTTP/1.1
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Host: www.xxxx.xx
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0)
>>>>>>>> >>>>>> Gecko/20100101 Firefox/30.0
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Accept: */*
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Accept-Encoding: gzip, deflate
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> X-Requested-With: XMLHttpRequest
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Referer: http://www.xxx.xxx/beta/societe-xxxx
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Content-Length: 760
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>>>>>>>> >>>>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>>>>>>>> >>>>>> 
>>>>>>>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=
>>>>>>>> organic|utmctr=(not%20provided);
>>>>>>>> >>>>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>>>>>>>> >>>>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Connection: keep-alive
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Pragma: no-cache
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Cache-Control: no-cache
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> --169a1612-C--
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> 
>>>>>>>> codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=
>>>>>>>> 10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL
>>>>>>>> &effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%
>>>>>>>> 2F13+%C3%A0+15%3A41&loginUser=nabilchant%40hotmail.fr
>>>>>>>> <http://40hotmail.fr> &emailUser=nabilchant%40hotmail.fr
>>>>>>>> <http://40hotmail.fr>
>>>>>>>> &id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_v
>>>>>>>> alidator=&capital_validator=&adresse_validator=&ville_validator=&activi
>>>>>>>> te_validator=&effectif_validator=&segmentEffectif_validator=&effectifCa
>>>>>>>> dre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_
>>>>>>>> 734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on
>>>>>>>> &telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelf
>>>>>>>> axmailweb_735=0&statut=1&remarque=
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> --169a1612-F--
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> HTTP/1.1 403 Forbidden
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Content-Length: 245
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Connection: close
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Content-Type: text/html; charset=iso-8859-1
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> --169a1612-E--
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> --169a1612-H--
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Message: Access denied with code 403 (phase 2). Pattern match
>>>>>>>> >>>>>> "\\W{4,}" at ARGS:dateContribution. [file
>>>>>>>> >>>>>> 
>>>>>>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attac
>>>>>>>> ks.conf"]
>>>>>>>> >>>>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly
>>>>>>>> Detection
>>>>>>>> >>>>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:
>>>>>>>> \xc3\xa0
>>>>>>>> >>>>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"]
[ver
>>>>>>>> >>>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Action: Intercepted (phase 2)
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Apache-Handler: proxy-server
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Stopwatch: 1403776137380257 11043 (- - -)
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Stopwatch2: 1403776137380257 11043; combined=642, p1=224,
>>>>>>>> p2=399,
>>>>>>>> >>>>>> p3=0, p4=0, p5=19, sr=37, sw=0, l=0, gc=0
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Response-Body-Transformed: Dechunked
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Producer: ModSecurity for Apache/2.7.3
>>>>>>>> (http://www.modsecurity.org/);
>>>>>>>> >>>>>> OWASP_CRS/2.2.9. <http://2.2.9.>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Server: Apache
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> Engine-Mode: "ENABLED"
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> --169a1612-Z--
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> how to allow these types of characters.
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> thank you.
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> _______________________________________________
>>>>>>>> >>>>>> Owasp-modsecurity-core-rule-set mailing list
>>>>>>>> >>>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>>>>>>> >>>>>>
>>>>>>>> >>>>>> 
>>>>>>>> 
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>>>>>>> >>>>>>
>>>>>>> >>>>>
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>>
>>>>>> >>>> --
>>>>>> >>>> Ilyass kaouam
>>>>>> >>>> Systems administrator at Inforisk Group Finaccess
>>>>>> >>>> European Masters in Information Technology
>>>>>> >>>> Portable : (212) 6 34 57 14 36
>>>>>> >>>> http://www.inforisk.ma
>>>>> >>>
>>>>> >>>
>>>> >>
>>>> >>
>>>> >>
>>>> >> --
>>>> >> Ilyass kaouam
>>>> >> Systems administrator at Inforisk Group Finaccess
>>>> >> European Masters in Information Technology
>>>> >> Portable : (212) 6 34 57 14 36
>>>> >> http://www.inforisk.ma
>>> >
>>> >
>>> >
>>> > _______________________________________________
>>> > Owasp-modsecurity-core-rule-set mailing list
>>> > Owasp-modsecurity-core-rule-set at lists.owasp.org
>>> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>> >
>> 
>> 
>> 
>> --
>> Jamie Riden / jamie at honeynet.org / jamie.riden at gmail.com
>> http://uk.linkedin.com/in/jamieriden
> 
> 
> 
> -- 
> Ilyass kaouam
> Systems administrator at Inforisk Group Finaccess
> European Masters in Information Technology
> Portable : (212) 6 34 57 14 36
> http://www.inforisk.ma <http://www.inforisk.ma>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140627/08ca42ff/attachment-0001.html>

From ilyassikai at gmail.com  Fri Jun 27 15:58:29 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Fri, 27 Jun 2014 16:58:29 +0100
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CFD30752.104236%ryan.barnett@owasp.org>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
	<CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
	<CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>
	<CAC+O4mHMsXV7mRR7a6OVQ+zNR9W_j82VMn64G-tBzV3jXjHYVQ@mail.gmail.com>
	<CAHno4i9a_8zbAWxhMH+tairqmvKbNCojXnVcaHtLoLnXAKAjxQ@mail.gmail.com>
	<CAMmziWd0gp_7--z+vhA=N3k-FW8aOTu0HfM0rOzqe3uv_iByNg@mail.gmail.com>
	<CFD30752.104236%ryan.barnett@owasp.org>
Message-ID: <CAMmziWdJbeTnSt-yyJnBbbcBLH75c7ez=byLbYurgCMKFg5zUw@mail.gmail.com>

I'll try that and I will come to you
Thank you very much :)


2014-06-27 16:41 GMT+01:00 Ryan Barnett <ryan.barnett at owasp.org>:

> This is what I recommend in these cases -
>
>    1. Create a positive security/input validation check against the
>    parameter that is causing the false positive. In this case it is the "code"
>    parameter.  If it matches the expected input format, then move to step 2.
>    2. Then use the "ctl:ruleRemoveTargetById" action to conditionally
>    remove ARGS:code from inspection for rule 981173
>
> The rule would look something like this (not tested)
>
> SecRule ARGS:code "@rx ^[a-zA-z0-9\-_]+$"
> "phase:request,id:12345,nolog,pass,ctl:ruleRemoveTargetById=981173;ARGS:code"
>
> Place this rule in a modsecurity_crs_00_custom.conf file so that it runs
> BEFORE the normal CRS rules.
>
> In general, this approach is more secure than just simply removing a
> variable from inspection when you encounter a false positive.
>
> -Ryan
>
> From: Ilyass Kaouam <ilyassikai at gmail.com>
> Reply-To: <ilyassikai at gmail.com>
> Date: Friday, June 27, 2014 11:21 AM
> To: Jamie Riden <jamie.riden at gmail.com>
> Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org" <
> owasp-modsecurity-core-rule-set at lists.owasp.org>
> Subject: Re: [Owasp-modsecurity-core-rule-set] Probl?me with False
> Positives
>
> Hi
>
> Thank you that work excellent   :) :)
>
> Now when i try connect with Facebook It's block 'false positive'
>
> log:
>
> *--be2b2979-H--*
>
> *Message: Access denied with code 403 (phase 2). Pattern match
> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
> at ARGS:code. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
> Detection Alert - Total # of special characters exceeded"] [data "Matched
> Data: - found within ARGS:code:
> AQAZzUllyzvnMFeI1YdJ7btTKpmdrAZ3VS-n5iyorHDhHpSzG6gpoRuEnzi9nNpX4RY8XP1O8W3WOea-4NjU0r4S1QkiCKwpCea-smSIVe2WxCTEIu4eN7S4YVSENbyes9tTF_dt890NN64DhShsI72t5fusquL_iK7SIfEo03eaYNxIIn0IGAyY0l2IMUusVd24RFBiPKowLjRJrXC4NL02Ine0VJU0Nm57anPrK6gsuzMZG41hHbtWiqsyPtRusewjOOUmTMk0OTrXtm67sOUpCW7emT5gUsGKPlJy_efQ-Q5QTgpl0xcwOffuu4ATeBA"]
> [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]*
>
> *Action: Intercepted (phase 2)*
>
> *Apache-Handler: proxy-server*
>
> *Stopwatch: 1403881875314702 2150 (- - -)*
>
> *Stopwatch2: 1403881875314702 2150; combined=1886, p1=90, p2=1793, p3=0,
> p4=0, p5=3, sr=26, sw=0, l=0, gc=0*
>
> *Response-Body-Transformed: Dechunked*
>
> *Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
> <http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*
>
> *Server: Apache*
>
> *Engine-Mode: "ENABLED"*
>
> I can use
> SecRuleUpdateTargetById 960024 !ARGS:/^code/
>
> OR it's dangerous ?
>
>
>
>
> 2014-06-27 16:08 GMT+01:00 Jamie Riden <jamie.riden at gmail.com>:
>
>> Would
>>
>> SecRuleUpdateTargetById 960024 !ARGS:/^telfaxmailweb/
>>
>> be better in this instance?  (ie. anchor the start of line.)
>>
>> cheers,
>>  Jamie
>>
>> On 27 June 2014 15:57, Josh Amishav-Zlatin <jamuse at owasp.org> wrote:
>> > On Fri, Jun 27, 2014 at 5:41 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>> wrote:
>> >>
>> >> hi thank you for your replay
>> >> BUT the problem is that the number    telfaxmailweb_1_171833   /
>> >> telfaxmailweb_1_142609   .... changes (non-static).
>> >> have you an idea
>> >>
>> >
>> > Hi Ilyass,
>> >
>> > Try using a regex in your exception, e.g.:
>> > SecRuleUpdateTargetById 960024 !ARGS:/telfaxmailweb/
>> >
>> > --
>> >  - Josh
>> >
>> >>
>> >> thank you
>> >>
>> >>
>> >> 2014-06-27 8:04 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>> >>
>> >>> On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>> >>> wrote:
>> >>>>
>> >>>> Hi Josh.
>> >>>>
>> >>>> It's work very good thank you :) :) :)
>> >>>>
>> >>>> I have another block :(   please help me
>> >>>
>> >>>
>> >>> Hi Ilyass,
>> >>>
>> >>> In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
>> >>> value. Try using the SecRuleUpdateTargetById directive, e.g.
>> >>> SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833
>> >>>
>> >>> For details see:
>> >>>
>> >>>
>> http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html
>> >>>
>> >>> --
>> >>>  - Josh
>> >>>
>> >>>>
>> >>>> log:
>> >>>>
>> >>>>
>> >>>>
>> >>>> --9b18757a-A--
>> >>>>
>> >>>> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
>> >>>>
>> >>>> --9b18757a-B--
>> >>>>
>> >>>> POST /beta/societe-contribEnt HTTP/1.1
>> >>>>
>> >>>> Host: www.
>> >>>>
>> >>>> xxxx
>> >>>> .
>> >>>> xxx
>> >>>>
>> >>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
>> >>>> Gecko/20100101 Firefox/30.0
>> >>>>
>> >>>> Accept: */*
>> >>>>
>> >>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>> >>>>
>> >>>> Accept-Encoding: gzip, deflate
>> >>>>
>> >>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>> >>>>
>> >>>> X-Requested-With: XMLHttpRequest
>> >>>>
>> >>>> Referer: http://www.
>> >>>>
>> >>>> xxxx
>> >>>> .ma/beta/
>> >>>> xxxxx
>> >>>> ?action=edit
>> >>>>
>> >>>> Content-Length: 1735
>> >>>>
>> >>>> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
>> >>>> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
>> >>>> __utmb=111125463.7.10.1403792976; __utmc=111125463;
>> >>>>
>> __utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>> >>>>
>> >>>> Connection: keep-alive
>> >>>>
>> >>>> Pragma: no-cache
>> >>>>
>> >>>> Cache-Control: no-cache
>> >>>>
>> >>>>
>> >>>> --9b18757a-C--
>> >>>>
>> >>>>
>> >>>>
>> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%
>> 40inforisk.ma
>> &telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=
>> www.inforisk.ma
>> &telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%
>> 40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
>> >>>>
>> >>>> --9b18757a-F--
>> >>>>
>> >>>> HTTP/1.1 403 Forbidden
>> >>>>
>> >>>> Content-Length: 225
>> >>>>
>> >>>> Connection: close
>> >>>>
>> >>>> Content-Type: text/html; charset=iso-8859-1
>> >>>>
>> >>>>
>> >>>> --9b18757a-E--
>> >>>>
>> >>>>
>> >>>> --9b18757a-H--
>> >>>>
>> >>>> Message: Access denied with code 403 (phase 2). Pattern match
>> >>>>
>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>> >>>> at ARGS:telfaxmailweb_1_171833. [file
>> >>>>
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>> >>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character
>> Anomaly
>> >>>> Detection Alert - Total # of special characters exceeded"] [data
>> "Matched
>> >>>> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"]
>> [ver
>> >>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>> >>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>> >>>>
>> >>>> Action: Intercepted (phase 2)
>> >>>>
>> >>>> Apache-Handler: proxy-server
>> >>>>
>> >>>> Stopwatch: 1403793315275899 22265 (- - -)
>> >>>>
>> >>>> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377,
>> >>>> p3=0, p4=0, p5=20, sr=28, sw=0, l=0, gc=0
>> >>>>
>> >>>> Response-Body-Transformed: Dechunked
>> >>>>
>> >>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
>> );
>> >>>> OWASP_CRS/2.2.9.
>> >>>>
>> >>>> Server: Apache
>> >>>>
>> >>>> Engine-Mode: "ENABLED"
>> >>>>
>> >>>>
>> >>>> --9b18757a-Z--
>> >>>>
>> >>>>
>> >>>>
>> >>>>
>> >>>>
>> >>>> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>> >>>>
>> >>>>> On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <
>> ilyassikai at gmail.com>
>> >>>>> wrote:
>> >>>>>>
>> >>>>>> Hi guys.
>> >>>>>>
>> >>>>>> I not understand why modsecurity blocking my request with the
>> >>>>>> character "?" in french.
>> >>>>>> log:
>> >>>>>
>> >>>>>
>> >>>>> Hi Ilyass,
>> >>>>>
>> >>>>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile
>> directives.
>> >>>>> For more information see:
>> >>>>>
>> >>>>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>> >>>>>
>> >>>>> --
>> >>>>>  - Josh
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-A--
>> >>>>>>
>> >>>>>> [26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ
>> >>>>>>
>> >>>>>> --169a1612-B--
>> >>>>>>
>> >>>>>> POST /beta/societe-xxxxxr HTTP/1.1
>> >>>>>>
>> >>>>>> Host: www.xxxx.xx
>> >>>>>>
>> >>>>>> User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0)
>> >>>>>> Gecko/20100101 Firefox/30.0
>> >>>>>>
>> >>>>>> Accept: */*
>> >>>>>>
>> >>>>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>> >>>>>>
>> >>>>>> Accept-Encoding: gzip, deflate
>> >>>>>>
>> >>>>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>> >>>>>>
>> >>>>>> X-Requested-With: XMLHttpRequest
>> >>>>>>
>> >>>>>> Referer: http://www.xxx.xxx/beta/societe-xxxx
>> >>>>>>
>> >>>>>> Content-Length: 760
>> >>>>>>
>> >>>>>> Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>> >>>>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>> >>>>>>
>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
>> >>>>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>> >>>>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08
>> >>>>>>
>> >>>>>> Connection: keep-alive
>> >>>>>>
>> >>>>>> Pragma: no-cache
>> >>>>>>
>> >>>>>> Cache-Control: no-cache
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-C--
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%
>> 40hotmail.fr&emailUser=nabilchant%40hotmail.fr
>> &id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=
>> >>>>>>
>> >>>>>> --169a1612-F--
>> >>>>>>
>> >>>>>> HTTP/1.1 403 Forbidden
>> >>>>>>
>> >>>>>> Content-Length: 245
>> >>>>>>
>> >>>>>> Connection: close
>> >>>>>>
>> >>>>>> Content-Type: text/html; charset=iso-8859-1
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-E--
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-H--
>> >>>>>>
>> >>>>>> Message: Access denied with code 403 (phase 2). Pattern match
>> >>>>>> "\\W{4,}" at ARGS:dateContribution. [file
>> >>>>>>
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
>> >>>>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly
>> Detection
>> >>>>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:
>>  \xc3\xa0
>> >>>>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
>> >>>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]
>> >>>>>>
>> >>>>>> Action: Intercepted (phase 2)
>> >>>>>>
>> >>>>>> Apache-Handler: proxy-server
>> >>>>>>
>> >>>>>> Stopwatch: 1403776137380257 11043 (- - -)
>> >>>>>>
>> >>>>>> Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399,
>> >>>>>> p3=0, p4=0, p5=19, sr=37, sw=0, l=0, gc=0
>> >>>>>>
>> >>>>>> Response-Body-Transformed: Dechunked
>> >>>>>>
>> >>>>>> Producer: ModSecurity for Apache/2.7.3 (
>> http://www.modsecurity.org/);
>> >>>>>> OWASP_CRS/2.2.9.
>> >>>>>>
>> >>>>>> Server: Apache
>> >>>>>>
>> >>>>>> Engine-Mode: "ENABLED"
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-Z--
>> >>>>>>
>> >>>>>>
>> >>>>>> how to allow these types of characters.
>> >>>>>>
>> >>>>>> thank you.
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>> _______________________________________________
>> >>>>>> Owasp-modsecurity-core-rule-set mailing list
>> >>>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> >>>>>>
>> >>>>>>
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> >>>>>>
>> >>>>>
>> >>>>
>> >>>>
>> >>>>
>> >>>> --
>> >>>> Ilyass kaouam
>> >>>> Systems administrator at Inforisk Group Finaccess
>> >>>> European Masters in Information Technology
>> >>>> Portable : (212) 6 34 57 14 36
>> >>>> http://www.inforisk.ma
>> >>>
>> >>>
>> >>
>> >>
>> >>
>> >> --
>> >> Ilyass kaouam
>> >> Systems administrator at Inforisk Group Finaccess
>> >> European Masters in Information Technology
>> >> Portable : (212) 6 34 57 14 36
>> >> http://www.inforisk.ma
>> >
>> >
>> >
>> > _______________________________________________
>> > Owasp-modsecurity-core-rule-set mailing list
>> > Owasp-modsecurity-core-rule-set at lists.owasp.org
>> >
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> >
>>
>>
>>
>> --
>> Jamie Riden / jamie at honeynet.org / jamie.riden at gmail.com
>> http://uk.linkedin.com/in/jamieriden
>>
>
>
>
>
>  _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140627/be07434c/attachment-0001.html>

From ilyassikai at gmail.com  Mon Jun 30 10:29:16 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Mon, 30 Jun 2014 10:29:16 +0000
Subject: [Owasp-modsecurity-core-rule-set]
	=?utf-8?q?Probl=C3=A8me_with_Fa?= =?utf-8?q?lse_Positives?=
In-Reply-To: <CFD30752.104236%ryan.barnett@owasp.org>
References: <CAMmziWdzAndDGjMw4dJT=hVzf_=F-VpHwcUY-sXiuSCLjTW_pg@mail.gmail.com>
	<CAC+O4mHTMrtVNjGtCJz9VOPaGw6V+c5kfaW-F+C0JnxoW=QE5Q@mail.gmail.com>
	<CAMmziWcig-rwfQG9jubVVVJgcJjZDyhaaTHHG5w7_TOOq1n4ZQ@mail.gmail.com>
	<CAC+O4mHwrUKygRHwxJW_vGs1Ff-zkysb9QFW3nqT06Xi7ehNAQ@mail.gmail.com>
	<CAMmziWehsKi+0HpFX4ttepEndrJ=NRvHVWqjK0bynm=ufzeVSw@mail.gmail.com>
	<CAC+O4mHMsXV7mRR7a6OVQ+zNR9W_j82VMn64G-tBzV3jXjHYVQ@mail.gmail.com>
	<CAHno4i9a_8zbAWxhMH+tairqmvKbNCojXnVcaHtLoLnXAKAjxQ@mail.gmail.com>
	<CAMmziWd0gp_7--z+vhA=N3k-FW8aOTu0HfM0rOzqe3uv_iByNg@mail.gmail.com>
	<CFD30752.104236%ryan.barnett@owasp.org>
Message-ID: <CAMmziWfCNF4WodWmTsF+qe=gZh5UhukdMsi6+Oma=6JSMaQ45A@mail.gmail.com>

Hi Ryan,

It's work.

Thank you.


2014-06-27 16:41 GMT+01:00 Ryan Barnett <ryan.barnett at owasp.org>:

> This is what I recommend in these cases -
>
>    1. Create a positive security/input validation check against the
>    parameter that is causing the false positive. In this case it is the "code"
>    parameter.  If it matches the expected input format, then move to step 2.
>    2. Then use the "ctl:ruleRemoveTargetById" action to conditionally
>    remove ARGS:code from inspection for rule 981173
>
> The rule would look something like this (not tested)
>
> SecRule ARGS:code "@rx ^[a-zA-z0-9\-_]+$"
> "phase:request,id:12345,nolog,pass,ctl:ruleRemoveTargetById=981173;ARGS:code"
>
> Place this rule in a modsecurity_crs_00_custom.conf file so that it runs
> BEFORE the normal CRS rules.
>
> In general, this approach is more secure than just simply removing a
> variable from inspection when you encounter a false positive.
>
> -Ryan
>
> From: Ilyass Kaouam <ilyassikai at gmail.com>
> Reply-To: <ilyassikai at gmail.com>
> Date: Friday, June 27, 2014 11:21 AM
> To: Jamie Riden <jamie.riden at gmail.com>
> Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org" <
> owasp-modsecurity-core-rule-set at lists.owasp.org>
> Subject: Re: [Owasp-modsecurity-core-rule-set] Probl?me with False
> Positives
>
> Hi
>
> Thank you that work excellent   :) :)
>
> Now when i try connect with Facebook It's block 'false positive'
>
> log:
>
> *--be2b2979-H--*
>
> *Message: Access denied with code 403 (phase 2). Pattern match
> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
> at ARGS:code. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
> Detection Alert - Total # of special characters exceeded"] [data "Matched
> Data: - found within ARGS:code:
> AQAZzUllyzvnMFeI1YdJ7btTKpmdrAZ3VS-n5iyorHDhHpSzG6gpoRuEnzi9nNpX4RY8XP1O8W3WOea-4NjU0r4S1QkiCKwpCea-smSIVe2WxCTEIu4eN7S4YVSENbyes9tTF_dt890NN64DhShsI72t5fusquL_iK7SIfEo03eaYNxIIn0IGAyY0l2IMUusVd24RFBiPKowLjRJrXC4NL02Ine0VJU0Nm57anPrK6gsuzMZG41hHbtWiqsyPtRusewjOOUmTMk0OTrXtm67sOUpCW7emT5gUsGKPlJy_efQ-Q5QTgpl0xcwOffuu4ATeBA"]
> [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]*
>
> *Action: Intercepted (phase 2)*
>
> *Apache-Handler: proxy-server*
>
> *Stopwatch: 1403881875314702 2150 (- - -)*
>
> *Stopwatch2: 1403881875314702 2150; combined=1886, p1=90, p2=1793, p3=0,
> p4=0, p5=3, sr=26, sw=0, l=0, gc=0*
>
> *Response-Body-Transformed: Dechunked*
>
> *Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
> <http://www.modsecurity.org/>); OWASP_CRS/2.2.9. <http://2.2.9.>*
>
> *Server: Apache*
>
> *Engine-Mode: "ENABLED"*
>
> I can use
> SecRuleUpdateTargetById 960024 !ARGS:/^code/
>
> OR it's dangerous ?
>
>
>
>
> 2014-06-27 16:08 GMT+01:00 Jamie Riden <jamie.riden at gmail.com>:
>
>> Would
>>
>> SecRuleUpdateTargetById 960024 !ARGS:/^telfaxmailweb/
>>
>> be better in this instance?  (ie. anchor the start of line.)
>>
>> cheers,
>>  Jamie
>>
>> On 27 June 2014 15:57, Josh Amishav-Zlatin <jamuse at owasp.org> wrote:
>> > On Fri, Jun 27, 2014 at 5:41 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>> wrote:
>> >>
>> >> hi thank you for your replay
>> >> BUT the problem is that the number    telfaxmailweb_1_171833   /
>> >> telfaxmailweb_1_142609   .... changes (non-static).
>> >> have you an idea
>> >>
>> >
>> > Hi Ilyass,
>> >
>> > Try using a regex in your exception, e.g.:
>> > SecRuleUpdateTargetById 960024 !ARGS:/telfaxmailweb/
>> >
>> > --
>> >  - Josh
>> >
>> >>
>> >> thank you
>> >>
>> >>
>> >> 2014-06-27 8:04 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>> >>
>> >>> On Thu, Jun 26, 2014 at 5:43 PM, Ilyass Kaouam <ilyassikai at gmail.com>
>> >>> wrote:
>> >>>>
>> >>>> Hi Josh.
>> >>>>
>> >>>> It's work very good thank you :) :) :)
>> >>>>
>> >>>> I have another block :(   please help me
>> >>>
>> >>>
>> >>> Hi Ilyass,
>> >>>
>> >>> In this case there is a hyphen in the telfaxmailweb_1_171833 parameter
>> >>> value. Try using the SecRuleUpdateTargetById directive, e.g.
>> >>> SecRuleUpdateTargetById 960024 !ARGS:telfaxmailweb_1_171833
>> >>>
>> >>> For details see:
>> >>>
>> >>>
>> http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html
>> >>>
>> >>> --
>> >>>  - Josh
>> >>>
>> >>>>
>> >>>> log:
>> >>>>
>> >>>>
>> >>>>
>> >>>> --9b18757a-A--
>> >>>>
>> >>>> [26/Jun/2014:16:35:15 +0200] U6wvo38AAAEAAFCgA4AAAAAK
>> >>>>
>> >>>> --9b18757a-B--
>> >>>>
>> >>>> POST /beta/societe-contribEnt HTTP/1.1
>> >>>>
>> >>>> Host: www.
>> >>>>
>> >>>> xxxx
>> >>>> .
>> >>>> xxx
>> >>>>
>> >>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:30.0)
>> >>>> Gecko/20100101 Firefox/30.0
>> >>>>
>> >>>> Accept: */*
>> >>>>
>> >>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>> >>>>
>> >>>> Accept-Encoding: gzip, deflate
>> >>>>
>> >>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>> >>>>
>> >>>> X-Requested-With: XMLHttpRequest
>> >>>>
>> >>>> Referer: http://www.
>> >>>>
>> >>>> xxxx
>> >>>> .ma/beta/
>> >>>> xxxxx
>> >>>> ?action=edit
>> >>>>
>> >>>> Content-Length: 1735
>> >>>>
>> >>>> Cookie: JSESSIONID=2A3D8D47FE45427E1AAFC69A2FA48F7B;
>> >>>> __utma=111125463.1234468951.1403792976.1403792976.1403792976.1;
>> >>>> __utmb=111125463.7.10.1403792976; __utmc=111125463;
>> >>>>
>> __utmz=111125463.1403792976.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>> >>>>
>> >>>> Connection: keep-alive
>> >>>>
>> >>>> Pragma: no-cache
>> >>>>
>> >>>> Cache-Control: no-cache
>> >>>>
>> >>>>
>> >>>> --9b18757a-C--
>> >>>>
>> >>>>
>> >>>>
>> codeAction=1&entid=151549&bilid=148614&idMkt=1628&denomination=INFORISK&denomination_dirty=&entrc=135529&entrc_dirty=&tribunal=12&tribunal_dirty=&fmj=Soci%C3%A9t%C3%A9+Anonyme&fmj_dirty=&capital=12+650+000+Dirhams&capital_dirty=&adresse=43%2C+Boulevard+D'anfa&adresse_dirty=&ville=1488&ville_dirty=&activite=+Collecte%2C+traitement+et+vente+des+informations+financi%C3%A8res%2C+l%C3%A9gales+et+commerciales&activite_dirty=&effectif_dirty=&effectif=30&segmentEffectif_dirty=&segmentEffectif=2&effectifCadre_dirty=&effectifCadre=0&telfaxmailweb_1_171833_dirty=&telfaxmailweb_1_171833=05-22-27-64-10&telfaxmailweb_1_142609_dirty=&telfaxmailweb_1_142609=05-22-42-90-87&telfaxmailweb_1_0_2_dirty=&telfaxmailweb_1_0_2=__-__-__-__-__&telfaxmailweb_1_0_3_dirty=&telfaxmailweb_1_0_3=__-__-__-__-__&telfaxmailweb_2_142611_dirty=&telfaxmailweb_2_142611=05-22-27-64-16&telfaxmailweb_2_0_1_dirty=&telfaxmailweb_2_0_1=__-__-__-__-__&telfaxmailweb_2_0_2_dirty=&telfaxmailweb_2_0_2=__-__-__-__-__&telfaxmailweb_2_0_3_dirty=&telfaxmailweb_2_0_3=__-__-__-__-__&telfaxmailweb_3_142612_dirty=&telfaxmailweb_3_142612=info%
>> 40inforisk.ma
>> &telfaxmailweb_3_0_1_dirty=&telfaxmailweb_3_0_1=&telfaxmailweb_3_0_2_dirty=&telfaxmailweb_3_0_2=&telfaxmailweb_3_0_3_dirty=&telfaxmailweb_3_0_3=&telfaxmailweb_4_142608_dirty=&telfaxmailweb_4_142608=
>> www.inforisk.ma
>> &telfaxmailweb_4_0_1_dirty=&telfaxmailweb_4_0_1=&telfaxmailweb_4_0_2_dirty=&telfaxmailweb_4_0_2=&telfaxmailweb_4_0_3_dirty=&telfaxmailweb_4_0_3=&idMktRefTypeContact_31241_dirty=&idMktRefTypeContact_31241=1&nom_31241=Ayouch&nom_31241_dirty=&prenom_31241=Khalid&prenom_31241_dirty=&tel_31241=__-__-__-__-__&tel_31241_dirty=&email_31241=test%
>> 40gmail.com&email_31241_dirty=1&contact_31241=1&contact_31241_dirty=1
>> >>>>
>> >>>> --9b18757a-F--
>> >>>>
>> >>>> HTTP/1.1 403 Forbidden
>> >>>>
>> >>>> Content-Length: 225
>> >>>>
>> >>>> Connection: close
>> >>>>
>> >>>> Content-Type: text/html; charset=iso-8859-1
>> >>>>
>> >>>>
>> >>>> --9b18757a-E--
>> >>>>
>> >>>>
>> >>>> --9b18757a-H--
>> >>>>
>> >>>> Message: Access denied with code 403 (phase 2). Pattern match
>> >>>>
>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>> >>>> at ARGS:telfaxmailweb_1_171833. [file
>> >>>>
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>> >>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character
>> Anomaly
>> >>>> Detection Alert - Total # of special characters exceeded"] [data
>> "Matched
>> >>>> Data: - found within ARGS:telfaxmailweb_1_171833: 05-22-27-64-10"]
>> [ver
>> >>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>> >>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>> >>>>
>> >>>> Action: Intercepted (phase 2)
>> >>>>
>> >>>> Apache-Handler: proxy-server
>> >>>>
>> >>>> Stopwatch: 1403793315275899 22265 (- - -)
>> >>>>
>> >>>> Stopwatch2: 1403793315275899 22265; combined=9584, p1=187, p2=9377,
>> >>>> p3=0, p4=0, p5=20, sr=28, sw=0, l=0, gc=0
>> >>>>
>> >>>> Response-Body-Transformed: Dechunked
>> >>>>
>> >>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/
>> );
>> >>>> OWASP_CRS/2.2.9.
>> >>>>
>> >>>> Server: Apache
>> >>>>
>> >>>> Engine-Mode: "ENABLED"
>> >>>>
>> >>>>
>> >>>> --9b18757a-Z--
>> >>>>
>> >>>>
>> >>>>
>> >>>>
>> >>>>
>> >>>> 2014-06-26 13:44 GMT+01:00 Josh Amishav-Zlatin <jamuse at owasp.org>:
>> >>>>
>> >>>>> On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam <
>> ilyassikai at gmail.com>
>> >>>>> wrote:
>> >>>>>>
>> >>>>>> Hi guys.
>> >>>>>>
>> >>>>>> I not understand why modsecurity blocking my request with the
>> >>>>>> character "?" in french.
>> >>>>>> log:
>> >>>>>
>> >>>>>
>> >>>>> Hi Ilyass,
>> >>>>>
>> >>>>> Take a look at the SecUnicodeCodePage and SecUnicodeMapFile
>> directives.
>> >>>>> For more information see:
>> >>>>>
>> >>>>> http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html
>> >>>>>
>> >>>>> --
>> >>>>>  - Josh
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-A--
>> >>>>>>
>> >>>>>> [26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ
>> >>>>>>
>> >>>>>> --169a1612-B--
>> >>>>>>
>> >>>>>> POST /beta/societe-xxxxxr HTTP/1.1
>> >>>>>>
>> >>>>>> Host: www.xxxx.xx
>> >>>>>>
>> >>>>>> User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0)
>> >>>>>> Gecko/20100101 Firefox/30.0
>> >>>>>>
>> >>>>>> Accept: */*
>> >>>>>>
>> >>>>>> Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3
>> >>>>>>
>> >>>>>> Accept-Encoding: gzip, deflate
>> >>>>>>
>> >>>>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>> >>>>>>
>> >>>>>> X-Requested-With: XMLHttpRequest
>> >>>>>>
>> >>>>>> Referer: http://www.xxx.xxx/beta/societe-xxxx
>> >>>>>>
>> >>>>>> Content-Length: 760
>> >>>>>>
>> >>>>>> Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
>> >>>>>> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
>> >>>>>>
>> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
>> >>>>>> __utmb=111125463.24.10.1403772965; __utmc=111125463;
>> >>>>>> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08
>> >>>>>>
>> >>>>>> Connection: keep-alive
>> >>>>>>
>> >>>>>> Pragma: no-cache
>> >>>>>>
>> >>>>>> Cache-Control: no-cache
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-C--
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> codeAction=1&entid=367928&bilid=321761&idMkt=672&denomination=&capital=10+000+&activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&effectif=0&effectifCadre=0&segmentEffectif=1&dateContribution=17%2F08%2F13+%C3%A0+15%3A41&loginUser=nabilchant%
>> 40hotmail.fr&emailUser=nabilchant%40hotmail.fr
>> &id=672&denomination_validator=&rc_validator=&tribunal_validator=&fmj_validator=&capital_validator=&adresse_validator=&ville_validator=&activite_validator=&effectif_validator=&segmentEffectif_validator=&effectifCadre_validator=&telfaxmailweb_734=on&telfaxmailweb_734_validator=1&data_734=0610357910&type_734=1&idMktTelfaxmailweb_734=0&telfaxmailweb_735=on&telfaxmailweb_735_validator=1&data_735=0633327850&type_735=1&idMktTelfaxmailweb_735=0&statut=1&remarque=
>> >>>>>>
>> >>>>>> --169a1612-F--
>> >>>>>>
>> >>>>>> HTTP/1.1 403 Forbidden
>> >>>>>>
>> >>>>>> Content-Length: 245
>> >>>>>>
>> >>>>>> Connection: close
>> >>>>>>
>> >>>>>> Content-Type: text/html; charset=iso-8859-1
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-E--
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-H--
>> >>>>>>
>> >>>>>> Message: Access denied with code 403 (phase 2). Pattern match
>> >>>>>> "\\W{4,}" at ARGS:dateContribution. [file
>> >>>>>>
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf"]
>> >>>>>> [line "37"] [id "960024"] [rev "2"] [msg "Meta-Character Anomaly
>> Detection
>> >>>>>> Alert - Repetative Non-Word Characters"] [data "Matched Data:
>>  \xc3\xa0
>> >>>>>> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41"] [ver
>> >>>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"]
>> >>>>>>
>> >>>>>> Action: Intercepted (phase 2)
>> >>>>>>
>> >>>>>> Apache-Handler: proxy-server
>> >>>>>>
>> >>>>>> Stopwatch: 1403776137380257 11043 (- - -)
>> >>>>>>
>> >>>>>> Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399,
>> >>>>>> p3=0, p4=0, p5=19, sr=37, sw=0, l=0, gc=0
>> >>>>>>
>> >>>>>> Response-Body-Transformed: Dechunked
>> >>>>>>
>> >>>>>> Producer: ModSecurity for Apache/2.7.3 (
>> http://www.modsecurity.org/);
>> >>>>>> OWASP_CRS/2.2.9.
>> >>>>>>
>> >>>>>> Server: Apache
>> >>>>>>
>> >>>>>> Engine-Mode: "ENABLED"
>> >>>>>>
>> >>>>>>
>> >>>>>> --169a1612-Z--
>> >>>>>>
>> >>>>>>
>> >>>>>> how to allow these types of characters.
>> >>>>>>
>> >>>>>> thank you.
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>>
>> >>>>>> _______________________________________________
>> >>>>>> Owasp-modsecurity-core-rule-set mailing list
>> >>>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> >>>>>>
>> >>>>>>
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> >>>>>>
>> >>>>>
>> >>>>
>> >>>>
>> >>>>
>> >>>> --
>> >>>> Ilyass kaouam
>> >>>> Systems administrator at Inforisk Group Finaccess
>> >>>> European Masters in Information Technology
>> >>>> Portable : (212) 6 34 57 14 36
>> >>>> http://www.inforisk.ma
>> >>>
>> >>>
>> >>
>> >>
>> >>
>> >> --
>> >> Ilyass kaouam
>> >> Systems administrator at Inforisk Group Finaccess
>> >> European Masters in Information Technology
>> >> Portable : (212) 6 34 57 14 36
>> >> http://www.inforisk.ma
>> >
>> >
>> >
>> > _______________________________________________
>> > Owasp-modsecurity-core-rule-set mailing list
>> > Owasp-modsecurity-core-rule-set at lists.owasp.org
>> >
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> >
>>
>>
>>
>> --
>> Jamie Riden / jamie at honeynet.org / jamie.riden at gmail.com
>> http://uk.linkedin.com/in/jamieriden
>>
>
>
>
> --
> *Ilyass kaouam*
> *Systems administrator*
> * at Inforisk Group Finaccess  *
> *European Masters in Information Technology*
> *Portable : (212) *
> *6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
>  _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>


-- 
*Ilyass kaouam*
*Systems administrator*
* at Inforisk Group Finaccess  *
*European Masters in Information Technology*
*Portable : (212) *
*6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140630/2bedffb9/attachment-0001.html>

