<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Except rule has been ignoring
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Except%20rule%20has%20been%20ignoring&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF01791F%40SKYMB1.trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001206.html">
   <LINK REL="Next"  HREF="001208.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Except rule has been ignoring</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Except%20rule%20has%20been%20ignoring&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DF01791F%40SKYMB1.trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Except rule has been ignoring">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Sep 19 18:12:05 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001206.html">[Owasp-modsecurity-core-rule-set] Except rule has been ignoring
</A></li>
        <LI>Next message: <A HREF="001208.html">[Owasp-modsecurity-core-rule-set] Cannot start apache after adding	core rule set
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1207">[ date ]</a>
              <a href="thread.html#1207">[ thread ]</a>
              <a href="subject.html#1207">[ subject ]</a>
              <a href="author.html#1207">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Leonardo,
How are you activating these rules?  Did you put them in a custom rules file?  Is this rules file included with the other CRS rule files in Apache Include directives?

You are showing debug log snippets below.  If your rules are activated, there should be debug log process regardless of whether the rules matched or not.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

From: Leonardo Bacha Abrantes &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">leonardo at lbasolutions.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">leonardo at lbasolutions.com</A>&gt;&gt;
Date: Wednesday, September 19, 2012 1:46 PM
To: OWASP Mod Security &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;, &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>&gt;&gt;
Subject: [Owasp-modsecurity-core-rule-set] Except rule has been ignoring

Hey people,

I'm using drupal and I created a list of IPs to access it using this rule:

# This rule was created to allow a list of IPs in a file to access /update.php
SecRule REQUEST_URI &quot;^/update.php&quot; id:1,phase:1,chain,nolog,t:none,allow,setvar:tx.remote_addr=/%{REMOTE_ADDR}/
  SecRule TX:REMOTE_ADDR &quot;@pmFromFile /etc/httpd/conf.d/modsecurity/base_rules/Allowed_to_run_update_php&quot;  t:none,ctl:ruleEngine=off

# to access /user interface
SecRule REQUEST_URI &quot;^/user&quot; id:2,phase:1,chain,nolog,t:none,allow,setvar:tx.remote_add=/%{REMOTE_ADD}/
  SecRule TX:REMOTE_ADD &quot;@pmFromFile /etc/httpd/conf.d/modsecurity/base_rules/Allowed_to_run_admin&quot;  t:none,ctl:ruleEngine=off

when I try to access /user and log am receiving the error below:


[19/Sep/2012:14:40:36 --0300] [10.1.125.204/sid#228f4e8][rid#35c23f0][/user][1&lt;<A HREF="http://10.1.125.204/sid#228f4e8">http://10.1.125.204/sid#228f4e8</A>][rid#35c23f0][/user][1&gt;] Access denied with code 403 (phase 2). Pattern match &quot;(/\\*!?|\\*/|[';]--|--[\\s\\r\\n\\v\\f]|(?:--[^-]*?-)|([^\\-&amp;])#.*?[\\s\\r\\n\\v\\f]|;?\\x00)&quot; at ARGS:pass. [file &quot;/etc/httpd/conf.d/modsecurity/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] [line &quot;49&quot;] [id &quot;981231&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Comment Sequence Detected.&quot;] [data &quot;--Ancine-&quot;] [tag &quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;]
[19/Sep/2012:14:40:39 --0300] [10.1.125.204/sid#228f4e8][rid#35c23f0][/user][1&lt;<A HREF="http://10.1.125.204/sid#228f4e8">http://10.1.125.204/sid#228f4e8</A>][rid#35c23f0][/user][1&gt;] Access denied with code 501 (phase 2). Pattern match &quot;^(?:ht|f)tps?:\\/\\/(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})&quot; at ARGS:pass. [file &quot;/etc/httpd/conf.d/modsecurity/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;] [line &quot;142&quot;] [id &quot;950117&quot;] [rev &quot;2.2.5&quot;] [msg &quot;Remote File Inclusion Attack&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/RFI&quot;]
[19/Sep/2012:14:40:46 --0300] [10.1.125.204/sid#228f4e8][rid#35c23f0][/user][1&lt;<A HREF="http://10.1.125.204/sid#228f4e8">http://10.1.125.204/sid#228f4e8</A>][rid#35c23f0][/user][1&gt;] Access denied with code 501 (phase 2). Pattern match &quot;^(?:ht|f)tps?:\\/\\/(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})&quot; at ARGS:pass. [file &quot;/etc/httpd/conf.d/modsecurity/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;] [line &quot;142&quot;] [id &quot;950117&quot;] [rev &quot;2.2.5&quot;] [msg &quot;Remote File Inclusion Attack&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/RFI&quot;]


in the exception files I'm doing this:

/10.1.125.204/&lt;<A HREF="http://10.1.125.204/">http://10.1.125.204/</A>&gt;


what is wrong ?

many thanks!

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120919/dcb0212c/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120919/dcb0212c/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001206.html">[Owasp-modsecurity-core-rule-set] Except rule has been ignoring
</A></li>
	<LI>Next message: <A HREF="001208.html">[Owasp-modsecurity-core-rule-set] Cannot start apache after adding	core rule set
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1207">[ date ]</a>
              <a href="thread.html#1207">[ thread ]</a>
              <a href="subject.html#1207">[ subject ]</a>
              <a href="author.html#1207">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
