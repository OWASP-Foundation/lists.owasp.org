<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Missing/Empty Accept Header Rule #960015
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Missing/Empty%20Accept%20Header%0A%20Rule%20%23960015&In-Reply-To=%3CD0754588.120B64%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001680.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Missing/Empty Accept Header Rule #960015</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Missing/Empty%20Accept%20Header%0A%20Rule%20%23960015&In-Reply-To=%3CD0754588.120B64%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Missing/Empty Accept Header Rule #960015">RBarnett at trustwave.com
       </A><BR>
    <I>Tue Oct 28 17:11:00 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001680.html">[Owasp-modsecurity-core-rule-set] Missing/Empty Accept Header Rule	#960015
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1683">[ date ]</a>
              <a href="thread.html#1683">[ thread ]</a>
              <a href="subject.html#1683">[ subject ]</a>
              <a href="author.html#1683">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The main purpose of those rules in the modsecurity_crs_21_protocol_anomalies.conf file are to identify non-browser clients.  While the RFC says it is optional, all major browsers will send Host, User-Agent and Accept headers.  So, if you get a request with a User-Agent value like this -

User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:32.0) Gecko/20100101 Firefox/32.0

But is it missing an Accept header, then this client is spoofing their User-Agent information.  These rules should probably not be configured to block on their own, however when running in an anomaly scoring mode, they can help to contribute to the overall transactional score for possible blocking.

Ryan Barnett
Senior Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ronald.Ploeger at bertelsmann.de</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ronald.Ploeger at bertelsmann.de</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ronald.Ploeger at bertelsmann.de</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ronald.Ploeger at bertelsmann.de</A>&gt;&gt;
Date: Tuesday, October 28, 2014 10:11 AM
To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: [Owasp-modsecurity-core-rule-set] Missing/Empty Accept Header Rule #960015

Hi,

why does the core rule set check for a missing &#8222;Accept&#8220; header?

As far as I understand it is optional. See <A HREF="http://www.w3.org/Protocols/HTTP/HTRQ_Headers.html&lt;http://scanmail.trustwave.com/?c=4062&amp;d=wanP1Gd59E_yzvm6V2I7_mriayONTN5S_nOssxt7Dw&amp;s=5&amp;u=http%3a%2f%2fwww%2ew3%2eorg%2fProtocols%2fHTTP%2fHTRQ%5fHeaders%2ehtml">http://www.w3.org/Protocols/HTTP/HTRQ_Headers.html&lt;http://scanmail.trustwave.com/?c=4062&amp;d=wanP1Gd59E_yzvm6V2I7_mriayONTN5S_nOssxt7Dw&amp;s=5&amp;u=http%3a%2f%2fwww%2ew3%2eorg%2fProtocols%2fHTTP%2fHTRQ%5fHeaders%2ehtml</A>&gt;

&#8220;If no Accept: field is present, then it is assumed that text/plain and text/html are accepted.&#8221;

Thanks and best regards,
Ronald


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20141028/af988232/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20141028/af988232/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001680.html">[Owasp-modsecurity-core-rule-set] Missing/Empty Accept Header Rule	#960015
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1683">[ date ]</a>
              <a href="thread.html#1683">[ thread ]</a>
              <a href="subject.html#1683">[ subject ]</a>
              <a href="author.html#1683">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
