<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20the%20%22Ignore%20Static%0A%20Content%22%20Rules&In-Reply-To=%3CCB61C1A9.43EF9%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001001.html">
   <LINK REL="Next"  HREF="001002.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20the%20%22Ignore%20Static%0A%20Content%22%20Rules&In-Reply-To=%3CCB61C1A9.43EF9%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Feb 16 01:19:29 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001001.html">[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules
</A></li>
        <LI>Next message: <A HREF="001002.html">[Owasp-modsecurity-core-rule-set] Software Vulnerability Mitigation	Automation - IVIL v1.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1003">[ date ]</a>
              <a href="thread.html#1003">[ thread ]</a>
              <a href="subject.html#1003">[ subject ]</a>
              <a href="author.html#1003">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Correct, that is the dilemma...  Maybe we should make two versions in the
config (one with a Cookie existence check and one without) and let the
user enable the one they want for the issue that is more of a concern:
increasing performance or reducing false negatives.


-Ryan

On 2/15/12 6:39 PM, &quot;Michael Haas&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">michael.haas10 at gmail.com</A>&gt; wrote:

&gt;<i>If there is a check for a Cookie there would be no chance to exclude
</I>&gt;<i>static resources for sites which require authentication?
</I>&gt;<i>
</I>&gt;<i>Michael
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>2012/2/15 Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;:
</I>&gt;&gt;<i> One potential bypass issue - Cookies. This was an issue in the SQL
</I>&gt;&gt;<i>injection challenge.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I guess we could add a check to make sure there are no cookies either.
</I>&gt;&gt;<i>If so, we should run the request through normal inspection.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Ryan
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Feb 15, 2012, at 5:25 PM, &quot;Ryan Barnett&quot;
</I>&gt;&gt;<i>&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I would like to update the logic of the this ruleset -
</I>&gt;&gt;<i>
</I>&gt;&gt;<i><A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/opt">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/opt</A>
</I>&gt;&gt;<i>ional_rules/modsecurity_crs_10_ignore_static.conf
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The concept is that rather than audit log all transactions (with
</I>&gt;&gt;<i>SecAuditLog On), you want to exclude logging requests for static
</I>&gt;&gt;<i>resources.  The trick is that we need to try and ensure that the attack
</I>&gt;&gt;<i>surface is significantly reduced.  In order to do that, I am testing
</I>&gt;&gt;<i>this updated ruleset -
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> SecRule REQUEST_METHOD &quot;@pm GET HEAD&quot;
</I>&gt;&gt;<i>&quot;id:'999001',chain,phase:1,t:none,nolog,pass&quot;
</I>&gt;&gt;<i>        SecRule REQUEST_URI &quot;!@contains ?&quot; &quot;chain&quot;
</I>&gt;&gt;<i>                SecRule &amp;ARGS &quot;@eq 0&quot; &quot;chain&quot;
</I>&gt;&gt;<i>                        SecRule
</I>&gt;&gt;<i>&amp;REQUEST_HEADERS:Content-Length|&amp;REQUEST_HEADERS:Content-Type &quot;@eq 0&quot;
</I>&gt;&gt;<i>&quot;ctl:ruleEngine=Off,ctl:auditEngine=Off&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This rule checks the following -
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>  1.  That the request method is either a GET or HEAD.  If it is
</I>&gt;&gt;<i>anything else, they it should probably be logged as it is a dynamic
</I>&gt;&gt;<i>request method looking to alter data.
</I>&gt;&gt;<i>  2.  Verifies that there is no query string by checking for ? Char in
</I>&gt;&gt;<i>the URI.
</I>&gt;&gt;<i>  3.  Verifies that there are no ARGS being passed
</I>&gt;&gt;<i>  4.  Verifies that there is no request body by checking for the
</I>&gt;&gt;<i>existence of Content-Length and Content-Type request headers.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If all of these rules match, then the ctl actions are used to toggle
</I>&gt;&gt;<i>off both the audit and rule engines.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Does anyone have any feedback on this updated ruleset?  Any
</I>&gt;&gt;<i>improvements?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Ryan Barnett
</I>&gt;&gt;<i> Trustwave SpiderLabs
</I>&gt;&gt;<i> ModSecurity Project Leader
</I>&gt;&gt;<i> OWASP ModSecurity CRS Project Leader
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> ________________________________
</I>&gt;&gt;<i> This transmission may contain information that is privileged,
</I>&gt;&gt;<i>confidential, and/or exempt from disclosure under applicable law. If you
</I>&gt;&gt;<i>are not the intended recipient, you are hereby notified that any
</I>&gt;&gt;<i>disclosure, copying, distribution, or use of the information contained
</I>&gt;&gt;<i>herein (including any reliance thereon) is STRICTLY PROHIBITED. If you
</I>&gt;&gt;<i>received this transmission in error, please immediately contact the
</I>&gt;&gt;<i>sender and destroy the material in its entirety, whether in electronic
</I>&gt;&gt;<i>or hard copy format.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001001.html">[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules
</A></li>
	<LI>Next message: <A HREF="001002.html">[Owasp-modsecurity-core-rule-set] Software Vulnerability Mitigation	Automation - IVIL v1.0
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1003">[ date ]</a>
              <a href="thread.html#1003">[ thread ]</a>
              <a href="subject.html#1003">[ subject ]</a>
              <a href="author.html#1003">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
