<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Modularity &amp; Documentation
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%20Thread%5D%0A%09Modularity%20%26%20Documentation&In-Reply-To=%3CCB5EF371.436A7%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000988.html">
   <LINK REL="Next"  HREF="000990.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Modularity &amp; Documentation</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%20Thread%5D%0A%09Modularity%20%26%20Documentation&In-Reply-To=%3CCB5EF371.436A7%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Modularity &amp; Documentation">RBarnett at trustwave.com
       </A><BR>
    <I>Mon Feb 13 22:15:43 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000988.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Transparency
</A></li>
        <LI>Next message: <A HREF="000990.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Usage Statistics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#989">[ date ]</a>
              <a href="thread.html#989">[ thread ]</a>
              <a href="subject.html#989">[ subject ]</a>
              <a href="author.html#989">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 2/13/12 4:56 PM, &quot;Christian Bockermann&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">chris at jwall.org</A>&gt; wrote:

&gt;<i>
</I>&gt;<i> (2) Modularity &amp; Documentation
</I>&gt;<i>
</I>&gt;<i>     The current rules have a modular structure, but to most people it is
</I>&gt;<i>not clear how
</I>&gt;<i>     to exactly adjust rules. Though I do like the blog-posts we have
</I>&gt;<i>about tweaking the
</I>&gt;<i>     rules, we need to have some central, clean and well-structured
</I>&gt;<i>documentation. This
</I>&gt;<i>     needs to be maintainable and easy to understand.
</I>
Agreed.  I think I responded to this on the other email thread.

&gt;<i>
</I>&gt;<i>     I'd propose to use a simply style (e.g. markdown) to document the
</I>&gt;<i>rules inline and
</I>&gt;<i>     additionally provide tools to automatically generate docs from that.
</I>&gt;<i>
</I>&gt;<i>     The idea of the rule-doc template is nice, but we need a nice and
</I>&gt;<i>*clean* looking
</I>&gt;<i>     central page for that (the current homepage at owasp looks terrible
</I>&gt;<i>confusing).
</I>
Yeah, OWASP recently updated the wiki templates and it blew away the
presentation and tabbed formatting so it is all messed up now.

&gt;<i>
</I>&gt;<i>     For example, if I'm hit by rule-ID 960012 - it would be perfect to
</I>&gt;<i>go to
</I>&gt;<i>
</I>&gt;<i>          <A HREF="http://www.modsecurity.org/crs/rule/960012">http://www.modsecurity.org/crs/rule/960012</A>
</I>&gt;<i>
</I>&gt;<i>     and immediately have an explanation of that rule.
</I>
I tried this approach.  I setup a rules documentation template here which
is modeled after the Snort sig documentation pages -
<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_Rule_Description_Template">https://www.owasp.org/index.php/ModSecurity_CRS_Rule_Description_Template</A>


An example page is here -

<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911</A>


The big challenge to this approach is the up-front work involved.  We have
thousands of rules...  I am hesitant to do the up front work at this
current time as our plans of re-architecting the CRS might impact the # of
rules we need to maintain (which I would like to reduce by the way).


&gt;<i>
</I>&gt;<i>     I'd be happy to directly create a link to such a URL into the
</I>&gt;<i>AuditConsole. A similar
</I>&gt;<i>     thing could be done for rule-tags.
</I>&gt;<i>     For example, the AuditConsole provides a &quot;goto&quot; link based on
</I>&gt;<i>hashtags, e.g. if an
</I>&gt;<i>     event is tagged as &quot;#sql-injection&quot;, then one can define a target
</I>&gt;<i>such as
</I>&gt;<i>
</I>&gt;<i>          <A HREF="http://my.internal.wiki.org/security/sql-injection">http://my.internal.wiki.org/security/sql-injection</A>
</I>
We already have some of those URL types of TAGS in the CRS, for example -

SecRule REQUEST_LINE
&quot;!^(?:(?:[a-z]{3,10}\s+(?:\w{3,7}?://[\w\-\./]*(?::\d+)?)?/[^?#]*(?:\?[^#\s
]*)?(?:#[\S]*)?|connect (?:\d{1,3}\.){3}\d{1,3}\.?(?::\d+)?|options
\*)\s+[\w\./]+|get /[^?#]*(?:\?[^#\s]*)?(?:#[\S]*)?)$&quot; \
    &quot;phase:1,t:none,t:lowercase,block,msg:'Invalid HTTP Request
Line',id:'960911',severity:'4',rev:'2.2.3',logdata:'%{request_line}',tag:'h
<A HREF="ttps://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id">ttps://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id</A>}',tag:'http:/
/www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1',tag:'RULE_MATURIT
Y/8',tag:'RULE_ACCURACY/8',setvar:'tx.msg=%{rule.msg}',setvar:'tx.id=%{rule
.id}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.protoco
l_violation_score=+%{tx.notice_anomaly_score},setvar:'tx.%{rule.id}-PROTOCO
L_VIOLATION/INVALID_REQ-%{matched_var_name}=%{matched_var}'&quot;



The
&quot;tag:'<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-%{tx.id</A>}'&quot;
data will be macro expanded at run time to include the current rule id in
the url.

-Ryan


This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000988.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Transparency
</A></li>
	<LI>Next message: <A HREF="000990.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Usage Statistics
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#989">[ date ]</a>
              <a href="thread.html#989">[ thread ]</a>
              <a href="subject.html#989">[ subject ]</a>
              <a href="author.html#989">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
