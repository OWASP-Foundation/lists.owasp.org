<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20the%20%22Ignore%20Static%0A%20Content%22%20Rules&In-Reply-To=%3CCAFW5hxAbdqgxgL6py%2Bqtin%2BgFxp86_7DDBJD53ZRTa9TOK9qew%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001000.html">
   <LINK REL="Next"  HREF="001003.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules</H1>
    <B>Michael Haas</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20the%20%22Ignore%20Static%0A%20Content%22%20Rules&In-Reply-To=%3CCAFW5hxAbdqgxgL6py%2Bqtin%2BgFxp86_7DDBJD53ZRTa9TOK9qew%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules">michael.haas10 at gmail.com
       </A><BR>
    <I>Wed Feb 15 23:39:38 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001000.html">[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static	Content&quot; Rules
</A></li>
        <LI>Next message: <A HREF="001003.html">[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1001">[ date ]</a>
              <a href="thread.html#1001">[ thread ]</a>
              <a href="subject.html#1001">[ subject ]</a>
              <a href="author.html#1001">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If there is a check for a Cookie there would be no chance to exclude
static resources for sites which require authentication?

Michael


2012/2/15 Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;:
&gt;<i> One potential bypass issue - Cookies. This was an issue in the SQL injection challenge.
</I>&gt;<i>
</I>&gt;<i> I guess we could add a check to make sure there are no cookies either. If so, we should run the request through normal inspection.
</I>&gt;<i>
</I>&gt;<i> Ryan
</I>&gt;<i>
</I>&gt;<i> On Feb 15, 2012, at 5:25 PM, &quot;Ryan Barnett&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> I would like to update the logic of the this ruleset -
</I>&gt;<i> <A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/optional_rules/modsecurity_crs_10_ignore_static.conf">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/optional_rules/modsecurity_crs_10_ignore_static.conf</A>
</I>&gt;<i>
</I>&gt;<i> The concept is that rather than audit log all transactions (with SecAuditLog On), you want to exclude logging requests for static resources. &#160;The trick is that we need to try and ensure that the attack surface is significantly reduced. &#160;In order to do that, I am testing this updated ruleset -
</I>&gt;<i>
</I>&gt;<i> SecRule REQUEST_METHOD &quot;@pm GET HEAD&quot; &quot;id:'999001',chain,phase:1,t:none,nolog,pass&quot;
</I>&gt;<i> &#160; &#160; &#160; &#160;SecRule REQUEST_URI &quot;!@contains ?&quot; &quot;chain&quot;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;SecRule &amp;ARGS &quot;@eq 0&quot; &quot;chain&quot;
</I>&gt;<i> &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;SecRule &amp;REQUEST_HEADERS:Content-Length|&amp;REQUEST_HEADERS:Content-Type &quot;@eq 0&quot; &quot;ctl:ruleEngine=Off,ctl:auditEngine=Off&quot;
</I>&gt;<i>
</I>&gt;<i> This rule checks the following -
</I>&gt;<i>
</I>&gt;<i> &#160;1. &#160;That the request method is either a GET or HEAD. &#160;If it is anything else, they it should probably be logged as it is a dynamic request method looking to alter data.
</I>&gt;<i> &#160;2. &#160;Verifies that there is no query string by checking for ? Char in the URI.
</I>&gt;<i> &#160;3. &#160;Verifies that there are no ARGS being passed
</I>&gt;<i> &#160;4. &#160;Verifies that there is no request body by checking for the existence of Content-Length and Content-Type request headers.
</I>&gt;<i>
</I>&gt;<i> If all of these rules match, then the ctl actions are used to toggle off both the audit and rule engines.
</I>&gt;<i>
</I>&gt;<i> Does anyone have any feedback on this updated ruleset? &#160;Any improvements?
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ryan Barnett
</I>&gt;<i> Trustwave SpiderLabs
</I>&gt;<i> ModSecurity Project Leader
</I>&gt;<i> OWASP ModSecurity CRS Project Leader
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001000.html">[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static	Content&quot; Rules
</A></li>
	<LI>Next message: <A HREF="001003.html">[Owasp-modsecurity-core-rule-set] Updating the &quot;Ignore Static Content&quot; Rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1001">[ date ]</a>
              <a href="thread.html#1001">[ thread ]</a>
              <a href="subject.html#1001">[ subject ]</a>
              <a href="author.html#1001">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
