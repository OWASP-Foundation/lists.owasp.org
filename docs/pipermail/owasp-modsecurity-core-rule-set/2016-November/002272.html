<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] False positive on rule 920300
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20positive%20on%20rule%20920300&In-Reply-To=%3C20161115194024.GA8155%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002270.html">
   <LINK REL="Next"  HREF="002273.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] False positive on rule 920300</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20positive%20on%20rule%20920300&In-Reply-To=%3C20161115194024.GA8155%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] False positive on rule 920300">christian.folini at netnea.com
       </A><BR>
    <I>Tue Nov 15 19:40:24 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002270.html">[Owasp-modsecurity-core-rule-set] False positive on rule 920300
</A></li>
        <LI>Next message: <A HREF="002273.html">[Owasp-modsecurity-core-rule-set] False positive on rule 920300
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2272">[ date ]</a>
              <a href="thread.html#2272">[ thread ]</a>
              <a href="subject.html#2272">[ subject ]</a>
              <a href="author.html#2272">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Kamil,

Thanks for reporting.

You are facing the following alerts:

920300 REQUEST_HEADERS:User-Agent     Request Missing an Accept Header
920300 REQUEST_HEADERS:User-Agent     Request Missing an Accept Header
942260 REQUEST_COOKIES:OutlookSession Detects basic SQL auth bypass
942260 REQUEST_COOKIES:OutlookSession Detects basic SQL auth bypass

920300 is usually legitimate and likely points to a client not sending
the accept header like it should. This is a widespread misbehaviour.
That is why we pushed the rule to paranoia level 2. You are apparently
running PL2 or higher. You should thus tune this alert away via a rule
exclusion.

The 942260 is likely also legitimate. It's just that your poor client
has a session cookie smelling of SQL authentication bypass. You
should exclude the said cookie from the list of parameters examined
by 942260.

My tutorials at <A HREF="https://www.netnea.com/cms/apache-tutorials">https://www.netnea.com/cms/apache-tutorials</A> give 
you detailed step by step instructions how to do this.

Best,

Christian



On Tue, Nov 15, 2016 at 05:54:52PM +0100, kamil kapturkiewicz wrote:
&gt;<i> Hi,
</I>&gt;<i> I have had this issue with previous 2.2.9 version, but I am not really sure is related to mod_security it self or to CRS. The problem is with some Windows machines, below is the example from one of our corporate user, who is working on Windows 7 machine. I am pretty sure machine is not infected by malware or something, and this problem occures on FF, Chrome, Opera and IE. But in combination with fail2ban, this cut him off from web server every time he is trying to access company website. Do 
</I>&gt;<i> you guys have any idea what is causing this?
</I>&gt;<i> 
</I>&gt;<i> [Tue Nov 15 16:26:41.962933 2016] [:error] [pid 31434] [client 213.81.82.201] ModSecurity: Warning. Match of &quot;pm 
</I>&gt;<i> AppleWebKit Android&quot; against &quot;REQUEST_HEADERS:User-Agent&quot; required. [file &quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line &quot;1251&quot;] [id &quot;920300&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag 
</I>&gt;<i> &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3QX8AAQEAAHrKJTMAAAAF&quot;]
</I>&gt;<i> [Tue Nov 15 16:26:41.963976 2016] [:error] [pid 31434] [client 213.81.82.201] ModSecurity: Access denied with code 403 (phase 2). Pattern match &quot;(?i:(?:union\\\\s*?(?:all|distinct|[(!@]*?)?\\\\s*?[([]*?\\\\s*?select\\\\s+)|(?:\\\\w+\\\\s+like\\\\s+[\\&quot;'`])|(?:like\\\\s*?[\\&quot;'`]\\\\%)|(?:[\\&quot;'`]\\\\s*?like\\\\W*?[\\&quot;'`\\\\d])|(?:[\\&quot;'`]\\\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\\\|\\\\||\\\\&amp;\\\\&amp;)\\\\s+[\\\\s\\\\w]+=\\\\s*?\\\\w+\\\\s*?h ...&quot; at REQUEST_COOKIES:OutlookSession. [file 
</I>&gt;<i> &quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf&quot;] [line &quot;705&quot;] [id &quot;942260&quot;] [rev &quot;2&quot;] [msg &quot;Detects basic SQL authentication bypass attempts 2/3&quot;] [data &quot;Matched Data: \\x22{BB1B2590-E found within REQUEST_COOKIES:OutlookSession: \\x22{BB1B2590-EEE9-451E-9ABD-B75491F282EE}\\x22&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-sqli&quot;] [tag 
</I>&gt;<i> &quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3QX8AAQEAAHrKJTMAAAAF&quot;]
</I>&gt;<i> [Tue Nov 15 16:26:44.390517 2016] [:error] [pid 31254] [client 213.81.82.201] ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against &quot;REQUEST_HEADERS:User-Agent&quot; required. [file &quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line &quot;1251&quot;] [id &quot;920300&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag 
</I>&gt;<i> &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3RH8AAQEAAHoWjIUAAAAD&quot;]
</I>&gt;<i> [Tue Nov 15 16:26:44.391535 2016] [:error] [pid 31254] [client 213.81.82.201] ModSecurity: Access denied with code 403 (phase 2). Pattern match &quot;(?i:(?:union\\\\s*?(?:all|distinct|[(!@]*?)?\\\\s*?[([]*?\\\\s*?select\\\\s+)|(?:\\\\w+\\\\s+like\\\\s+[\\&quot;'`])|(?:like\\\\s*?[\\&quot;'`]\\\\%)|(?:[\\&quot;'`]\\\\s*?like\\\\W*?[\\&quot;'`\\\\d])|(?:[\\&quot;'`]\\\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\\\|\\\\||\\\\&amp;\\\\&amp;)\\\\s+[\\\\s\\\\w]+=\\\\s*?\\\\w+\\\\s*?h ...&quot; at REQUEST_COOKIES:OutlookSession. [file 
</I>&gt;<i> &quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf&quot;] [line &quot;705&quot;] [id &quot;942260&quot;] [rev &quot;2&quot;] [msg &quot;Detects basic SQL authentication bypass attempts 2/3&quot;] [data &quot;Matched Data: \\x22{BB1B2590-E found within REQUEST_COOKIES:OutlookSession: \\x22{BB1B2590-EEE9-451E-9ABD-B75491F282EE}\\x22&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-sqli&quot;] [tag 
</I>&gt;<i> &quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3RH8AAQEAAHoWjIUAAAAD&quot;]
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002270.html">[Owasp-modsecurity-core-rule-set] False positive on rule 920300
</A></li>
	<LI>Next message: <A HREF="002273.html">[Owasp-modsecurity-core-rule-set] False positive on rule 920300
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2272">[ date ]</a>
              <a href="thread.html#2272">[ thread ]</a>
              <a href="subject.html#2272">[ subject ]</a>
              <a href="author.html#2272">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
