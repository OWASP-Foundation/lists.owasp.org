<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Issues with CRS3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Issues%20with%20CRS3&In-Reply-To=%3CCABkhgLp%2BLHPeCS5aYimEy2UtrXUmrcsJ4gzHZdBkUsFdiv9ghw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002268.html">
   <LINK REL="Next"  HREF="002277.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Issues with CRS3</H1>
    <B>Jose Pablo Valc&#225;rcel L&#225;zaro</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Issues%20with%20CRS3&In-Reply-To=%3CCABkhgLp%2BLHPeCS5aYimEy2UtrXUmrcsJ4gzHZdBkUsFdiv9ghw%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Issues with CRS3">pablo.valcarcel1980 at gmail.com
       </A><BR>
    <I>Tue Nov 15 17:28:53 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002268.html">[Owasp-modsecurity-core-rule-set] Issues with CRS3
</A></li>
        <LI>Next message: <A HREF="002277.html">[Owasp-modsecurity-core-rule-set] Issues with CRS3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2271">[ date ]</a>
              <a href="thread.html#2271">[ thread ]</a>
              <a href="subject.html#2271">[ subject ]</a>
              <a href="author.html#2271">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello.

Here there's a example where they use chain:
<A HREF="https://samhobbs.co.uk/2015/09/example-whitelisting-rules-apache-modsecurity-and-owasp-core-rule-set">https://samhobbs.co.uk/2015/09/example-whitelisting-rules-apache-modsecurity-and-owasp-core-rule-set</A>
SecRuleUpdateActionById 981175 &quot;chain,deny,status:501&quot;

Have you tried with chain instead?

Regards

El mar., 15 de noviembre de 2016 17:40, Christian Folini &lt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; escribi&#243;:

&gt;<i> Hi there,
</I>&gt;<i>
</I>&gt;<i> On Tue, Nov 15, 2016 at 04:44:15PM +0100, Heinrich M. wrote:
</I>&gt;<i> &gt; thank you for your great work! It is just great that there exists an
</I>&gt;<i> &gt; open source WAF and a corresponding ruleset! Thank you.
</I>&gt;<i>
</I>&gt;<i> You are most welcome. Glad you like it.
</I>&gt;<i>
</I>&gt;<i> &gt; I'm quite new to ModSecurity. Today, I found some time to play around
</I>&gt;<i> &gt; with ModSecurity and the new CRS release in a basic testing setup. I
</I>&gt;<i> &gt; hope that I will be able to introduce ModSec and the CRS3 in some small
</I>&gt;<i> &gt; prod environment soon.
</I>&gt;<i>
</I>&gt;<i> Please keep us posted about your experience. Us, the dev team has
</I>&gt;<i> years of experience and this is in fact a big problem as we do not
</I>&gt;<i> even see the small problems and the many questions that new users
</I>&gt;<i> like you face. Your perspective is very valuable.
</I>&gt;<i>
</I>&gt;<i> &gt; 1. Issue
</I>&gt;<i> &gt; After including the new CRS rule files, apache didn't fire up.
</I>&gt;<i> &gt; journalctl provided the following error messages:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; [...] Syntax error on line 36 of
</I>&gt;<i> &gt;
</I>&gt;<i> /etc/modsecurity/owasp-modsecurity-crs/rules/RESPONSE-950-DATA-LEAKAGES.conf:
</I>&gt;<i> &gt; [...] Error parsing actions: Unknown action: \\
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Workaround (I don't know what other effects of this might be...): Adding
</I>&gt;<i> &gt; a space to line 36 resolved the issue: &quot;t:none, \&quot;
</I>&gt;<i>
</I>&gt;<i> This is a known issue with older Apache versions. It is documented
</I>&gt;<i> in the CRS KNOWN_BUGS file:
</I>&gt;<i>
</I>&gt;<i> &gt;* Apache 2.4 prior to 2.4.11 is affected by a bug in parsing multi-line
</I>&gt;<i> &gt;  configuration directives, which causes Apache to fail during startup
</I>&gt;<i> &gt;  with an error such as:
</I>&gt;<i> &gt;    Error parsing actions: Unknown action: \\
</I>&gt;<i> &gt;    Action 'configtest' failed.
</I>&gt;<i> &gt; ...
</I>&gt;<i> &gt;  We advise to upgrade your Apache version. If upgrading is not possible,
</I>&gt;<i> &gt;  we have provided a script in the util/join-multiline-rules directory
</I>&gt;<i> &gt;  which converts the rules into a format that works around the bug.
</I>&gt;<i> &gt;  You have to re-run this script whenever you modify or update
</I>&gt;<i> &gt;  the CRS rules.
</I>&gt;<i>
</I>&gt;<i> Your workaround works equally well.
</I>&gt;<i>
</I>&gt;<i> &gt; 2. Issue
</I>&gt;<i> &gt; Changing the blocking actions did not work as documented in
</I>&gt;<i> &gt; RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.
</I>&gt;<i> &gt; I tried to use the example  &quot;send an error 404&quot; (line 67 and below).
</I>&gt;<i> &gt; With the two rules activated, blocking dind't work anymore. Removing the
</I>&gt;<i> &gt; &quot;chain&quot; from the actions made blocking work again. The rules then are as
</I>&gt;<i> &gt; follows:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; SecRuleUpdateActionById 949110 &quot;t:none,deny,status:404&quot;
</I>&gt;<i> &gt; SecRuleUpdateActionById 959100 &quot;t:none,deny,status:404&quot;
</I>&gt;<i>
</I>&gt;<i> Ooops. I need to take a look at this. I'll be back.
</I>&gt;<i>
</I>&gt;<i> Ahoj,
</I>&gt;<i>
</I>&gt;<i> Christian
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Worst-case thinking encourages society to adopt fear as of one
</I>&gt;<i> of the key principles around which the public, the government
</I>&gt;<i> and various institutions should organise their lives. It
</I>&gt;<i> institutionalises insecurity and fosters a mood of confusion
</I>&gt;<i> and powerlessness. Through popularising the belief that worst
</I>&gt;<i> cases are normal, it also encourages people to feel defenceless
</I>&gt;<i> and vulnerable to a wide range of future threats. In all but
</I>&gt;<i> name, it is an invitation to social paralysis.
</I>&gt;<i> -- Frank Furedi
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20161115/fb6c33bc/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20161115/fb6c33bc/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002268.html">[Owasp-modsecurity-core-rule-set] Issues with CRS3
</A></li>
	<LI>Next message: <A HREF="002277.html">[Owasp-modsecurity-core-rule-set] Issues with CRS3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2271">[ date ]</a>
              <a href="thread.html#2271">[ thread ]</a>
              <a href="subject.html#2271">[ subject ]</a>
              <a href="author.html#2271">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
