<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] False positive on rule 920300
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20positive%20on%20rule%20920300&In-Reply-To=%3C582b3ddc6f1875.33671646%40wp.pl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002267.html">
   <LINK REL="Next"  HREF="002270.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] False positive on rule 920300</H1>
    <B>kamil kapturkiewicz</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20False%20positive%20on%20rule%20920300&In-Reply-To=%3C582b3ddc6f1875.33671646%40wp.pl%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] False positive on rule 920300">horizn at wp.pl
       </A><BR>
    <I>Tue Nov 15 16:54:52 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002267.html">[Owasp-modsecurity-core-rule-set] Issues with CRS3
</A></li>
        <LI>Next message: <A HREF="002270.html">[Owasp-modsecurity-core-rule-set] False positive on rule 920300
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2269">[ date ]</a>
              <a href="thread.html#2269">[ thread ]</a>
              <a href="subject.html#2269">[ subject ]</a>
              <a href="author.html#2269">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,
I have had this issue with previous 2.2.9 version, but I am not really sure is related to mod_security it self or to CRS. The problem is with some Windows machines, below is the example from one of our corporate user, who is working on Windows 7 machine. I am pretty sure machine is not infected by malware or something, and this problem occures on FF, Chrome, Opera and IE. But in combination with fail2ban, this cut him off from web server every time he is trying to access company website. Do 
you guys have any idea what is causing this?

[Tue Nov 15 16:26:41.962933 2016] [:error] [pid 31434] [client 213.81.82.201] ModSecurity: Warning. Match of &quot;pm 
AppleWebKit Android&quot; against &quot;REQUEST_HEADERS:User-Agent&quot; required. [file &quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line &quot;1251&quot;] [id &quot;920300&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag 
&quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3QX8AAQEAAHrKJTMAAAAF&quot;]
[Tue Nov 15 16:26:41.963976 2016] [:error] [pid 31434] [client 213.81.82.201] ModSecurity: Access denied with code 403 (phase 2). Pattern match &quot;(?i:(?:union\\\\s*?(?:all|distinct|[(!@]*?)?\\\\s*?[([]*?\\\\s*?select\\\\s+)|(?:\\\\w+\\\\s+like\\\\s+[\\&quot;'`])|(?:like\\\\s*?[\\&quot;'`]\\\\%)|(?:[\\&quot;'`]\\\\s*?like\\\\W*?[\\&quot;'`\\\\d])|(?:[\\&quot;'`]\\\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\\\|\\\\||\\\\&amp;\\\\&amp;)\\\\s+[\\\\s\\\\w]+=\\\\s*?\\\\w+\\\\s*?h ...&quot; at REQUEST_COOKIES:OutlookSession. [file 
&quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf&quot;] [line &quot;705&quot;] [id &quot;942260&quot;] [rev &quot;2&quot;] [msg &quot;Detects basic SQL authentication bypass attempts 2/3&quot;] [data &quot;Matched Data: \\x22{BB1B2590-E found within REQUEST_COOKIES:OutlookSession: \\x22{BB1B2590-EEE9-451E-9ABD-B75491F282EE}\\x22&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-sqli&quot;] [tag 
&quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3QX8AAQEAAHrKJTMAAAAF&quot;]
[Tue Nov 15 16:26:44.390517 2016] [:error] [pid 31254] [client 213.81.82.201] ModSecurity: Warning. Match of &quot;pm AppleWebKit Android&quot; against &quot;REQUEST_HEADERS:User-Agent&quot; required. [file &quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line &quot;1251&quot;] [id &quot;920300&quot;] [rev &quot;3&quot;] [msg &quot;Request Missing an Accept Header&quot;] [severity &quot;NOTICE&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag 
&quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3RH8AAQEAAHoWjIUAAAAD&quot;]
[Tue Nov 15 16:26:44.391535 2016] [:error] [pid 31254] [client 213.81.82.201] ModSecurity: Access denied with code 403 (phase 2). Pattern match &quot;(?i:(?:union\\\\s*?(?:all|distinct|[(!@]*?)?\\\\s*?[([]*?\\\\s*?select\\\\s+)|(?:\\\\w+\\\\s+like\\\\s+[\\&quot;'`])|(?:like\\\\s*?[\\&quot;'`]\\\\%)|(?:[\\&quot;'`]\\\\s*?like\\\\W*?[\\&quot;'`\\\\d])|(?:[\\&quot;'`]\\\\s*?(?:n?and|x?x?or|div|like|between|and|not|\\\\|\\\\||\\\\&amp;\\\\&amp;)\\\\s+[\\\\s\\\\w]+=\\\\s*?\\\\w+\\\\s*?h ...&quot; at REQUEST_COOKIES:OutlookSession. [file 
&quot;/usr/share/owasp-modsecurity-crs/rules/REQUEST-942-APPLICATION-ATTACK-SQLI.conf&quot;] [line &quot;705&quot;] [id &quot;942260&quot;] [rev &quot;2&quot;] [msg &quot;Detects basic SQL authentication bypass attempts 2/3&quot;] [data &quot;Matched Data: \\x22{BB1B2590-E found within REQUEST_COOKIES:OutlookSession: \\x22{BB1B2590-EEE9-451E-9ABD-B75491F282EE}\\x22&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-sqli&quot;] [tag 
&quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;domain.com&quot;] [uri &quot;/autodiscover/autodiscover.xml&quot;] [unique_id &quot;WCs3RH8AAQEAAHoWjIUAAAAD&quot;]




</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002267.html">[Owasp-modsecurity-core-rule-set] Issues with CRS3
</A></li>
	<LI>Next message: <A HREF="002270.html">[Owasp-modsecurity-core-rule-set] False positive on rule 920300
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2269">[ date ]</a>
              <a href="thread.html#2269">[ thread ]</a>
              <a href="subject.html#2269">[ subject ]</a>
              <a href="author.html#2269">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
