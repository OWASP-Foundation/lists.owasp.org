<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] No rule-id in audit/error log with Nginx und MS3/CRS3
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20No%20rule-id%20in%20audit/error%20log%0A%20with%20Nginx%20und%20MS3/CRS3&In-Reply-To=%3C20161124163754.GA27729%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002285.html">
   <LINK REL="Next"  HREF="002287.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] No rule-id in audit/error log with Nginx und MS3/CRS3</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20No%20rule-id%20in%20audit/error%20log%0A%20with%20Nginx%20und%20MS3/CRS3&In-Reply-To=%3C20161124163754.GA27729%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] No rule-id in audit/error log with Nginx und MS3/CRS3">christian.folini at netnea.com
       </A><BR>
    <I>Thu Nov 24 16:37:54 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002285.html">[Owasp-modsecurity-core-rule-set] No rule-id in audit/error log with Nginx und MS3/CRS3
</A></li>
        <LI>Next message: <A HREF="002287.html">[Owasp-modsecurity-core-rule-set] No rule-id in audit/error log with Nginx und MS3/CRS3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2286">[ date ]</a>
              <a href="thread.html#2286">[ thread ]</a>
              <a href="subject.html#2286">[ subject ]</a>
              <a href="author.html#2286">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Nov 24, 2016 at 05:02:43PM +0100, Muenz, Michael wrote:
&gt;<i> SecAuditLogParts ABIJDEFHZ
</I>
It's a little known detail that Audit Log Parts need to be set
in alphabetic order. But I do not think this is the problem here.

For me, this sounds like a ModSec/NginX bug - unless you have some other
base config which tweaks the audit log in the said fashion. But I
do not see how you could.

So to me, this is not a CRS problem, but a ModSec on NginX problem.

Next step would be to remove the complete CRS and then copy
the said rule into the remaining config. And then you change
the rule action form pass to deny and give it another shot.

&gt;<i> What I changed in crs-setup.conf was:
</I>&gt;<i> 
</I>&gt;<i> SecDefaultAction &quot;phase:1,log,auditlog,deny,status:403&quot;
</I>&gt;<i> SecDefaultAction &quot;phase:2,log,auditlog,deny,status:403&quot;
</I>&gt;<i> 
</I>&gt;<i> ... instead of the default.
</I>
That is perfectly OK configurationwise (outside of the fact that
anomaly scoring mode is the default for a good reason. Unless you
have thought about this a lot and you really know what you are
doing, I suggest you stay in anomaly scoring mode).

Ahoj,

Christian


-- 
You don't have to be great to start, but you have to 
start to be great. 
-- Zig Ziglar
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002285.html">[Owasp-modsecurity-core-rule-set] No rule-id in audit/error log with Nginx und MS3/CRS3
</A></li>
	<LI>Next message: <A HREF="002287.html">[Owasp-modsecurity-core-rule-set] No rule-id in audit/error log with Nginx und MS3/CRS3
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2286">[ date ]</a>
              <a href="thread.html#2286">[ thread ]</a>
              <a href="subject.html#2286">[ subject ]</a>
              <a href="author.html#2286">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
