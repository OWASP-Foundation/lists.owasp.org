<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] XSS/CSP brain storm
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20XSS/CSP%20brain%20storm&In-Reply-To=%3CBAY169-DS15B048F59B29D2B1673CF1A43A0%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001443.html">
   <LINK REL="Next"  HREF="001445.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] XSS/CSP brain storm</H1>
    <B>Rolling Stone</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20XSS/CSP%20brain%20storm&In-Reply-To=%3CBAY169-DS15B048F59B29D2B1673CF1A43A0%40phx.gbl%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] XSS/CSP brain storm">jzy2000 at hotmail.com
       </A><BR>
    <I>Thu Sep 12 14:54:19 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001443.html">[Owasp-modsecurity-core-rule-set] CRS,	friendly blocking and 5xx statuses
</A></li>
        <LI>Next message: <A HREF="001445.html">[Owasp-modsecurity-core-rule-set] XSS/CSP brain storm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1444">[ date ]</a>
              <a href="thread.html#1444">[ thread ]</a>
              <a href="subject.html#1444">[ subject ]</a>
              <a href="author.html#1444">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Many agree that deploying CSP for Web apps is a hassle, one of which
requires externalizing all inline JS.

 

I would like to discuss about the idea of making this process automated by
ModSecurity Core rule set with assistant of Lua script, can anyone help me
validate this idea? Here is workflow:

 

In &quot;learning mode&quot;, creating Lua script to:

1-     Intercept and scan response data, parses HTML and identify inline JS
and JS embedded in HTML events. 

2-     Then, creating a new .js file to include identified JS, store(e.g.
FTP) it in one of web location can be accessed by public domain.

3-     Remove inline JS blocks from response. 

4-     Replace HTML event with new JS function for event call from response.

5-     Calculate CSP content based on original response as well as adding
location for newly generated .js file.

6-     Append generated CSP headers to response.

7-     Save metadata info (i.e. new .js file name, hash of original
response, request URL to local data store for caching (performance
consideration)

&quot;Learning mode&quot; is referring to Core rule set performing above actions ONLY
when it sees request from trusted source such as given IP address.

Automated requested can be sent by open sources web crawlers available out
there, or web browsers manually.

 

Thanks,

R.S.

 

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130912/18ac3dbe/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20130912/18ac3dbe/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001443.html">[Owasp-modsecurity-core-rule-set] CRS,	friendly blocking and 5xx statuses
</A></li>
	<LI>Next message: <A HREF="001445.html">[Owasp-modsecurity-core-rule-set] XSS/CSP brain storm
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1444">[ date ]</a>
              <a href="thread.html#1444">[ thread ]</a>
              <a href="subject.html#1444">[ subject ]</a>
              <a href="author.html#1444">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
