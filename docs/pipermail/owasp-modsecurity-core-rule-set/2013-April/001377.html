<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Mod_Security Blocks Google_Analytics_Content_Experiments
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Mod_Security%20Blocks%0A%20Google_Analytics_Content_Experiments&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DFD36ABE%40SKYMB1.trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001376.html">
   <LINK REL="Next"  HREF="001378.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Mod_Security Blocks Google_Analytics_Content_Experiments</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Mod_Security%20Blocks%0A%20Google_Analytics_Content_Experiments&In-Reply-To=%3C01987910BF74B341B5890120BCCE77DFD36ABE%40SKYMB1.trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Mod_Security Blocks Google_Analytics_Content_Experiments">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Apr 17 13:05:22 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="001376.html">[Owasp-modsecurity-core-rule-set] Mod_Security Blocks	Google_Analytics_Content_Experiments
</A></li>
        <LI>Next message: <A HREF="001378.html">[Owasp-modsecurity-core-rule-set] Mod_Security Blocks	Google_Analytics_Content_Experiments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1377">[ date ]</a>
              <a href="thread.html#1377">[ thread ]</a>
              <a href="subject.html#1377">[ subject ]</a>
              <a href="author.html#1377">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You want to do a conditional exception to disable the offending rule ID.  Put this in base_rules/modsecurity_crs_15_custom.conf so that is runs before the other CRS rules -

SecRule REQUEST_HEADERS:User-Agent &quot;@beginsWith Google_Analytics_Content_Experiments&quot; &quot;id:1,phase:1,t:none,nolog,pass,ctl:ruleRemoveById=960015&quot;

--
Ryan Barnett

________________________________________
From: SANEESH [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">saneeshc at scigenom.com</A>]
Sent: Wednesday, April 17, 2013 8:56 AM
To: Ryan Barnett
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Re: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks Google_Analytics_Content_Experiments

Hi Ryan,
Thanks, i tried the simple Secrule below,

SecRule REQUEST_HEADERS:User-Agent
&quot;Google_Analytics_Content_Experiments&quot; &quot;log,allow&quot;

Can you refer the correct method to do it..

Saneesh.

On 17-04-2013 18:20, Ryan Barnett wrote:
&gt;<i> Saneesh,
</I>&gt;<i> You should be able to do an exception for this.  What was your exception that you tried?
</I>&gt;<i>
</I>&gt;<i> -Ryan
</I>&gt;<i> ________________________________________
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] on behalf of SANEESH [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">saneeshc at scigenom.com</A>]
</I>&gt;<i> Sent: Wednesday, April 17, 2013 8:32 AM
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> Subject: [Owasp-modsecurity-core-rule-set] Mod_Security Blocks  Google_Analytics_Content_Experiments
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i> Am trying to integrate Google_Analytics_Content_Experiments to my webpages, when trying the Analytic test am getting &quot;We encountered an error while trying to connect to the server with your web pages (HTTP status: 403)&quot;. I found this is because mod_security is blocking the request..Please check the below log for more details..I tried to add exception for &quot;user Agent: Google_Analytics_Content_Experiments&quot;, but no luck..Please help.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Log:
</I>&gt;<i> [17/Apr/2013:07:26:18 --0400] wSzSgUDPmqEAABafQXYAAAAA 74.125.186.151 54656 64.207.154.161 80
</I>&gt;<i> --e29d6a3c-B--
</I>&gt;<i> GET /pro-membership2 HTTP/1.1
</I>&gt;<i> User-Agent: Google_Analytics_Content_Experiments (<A HREF="http://support.google.com/analytics/bin/answer.py?topic=1745208&amp;answer=1665377">http://support.google.com/analytics/bin/answer.py?topic=1745208&amp;answer=1665377</A>)
</I>&gt;<i> Host:www.test.com
</I>&gt;<i> Accept-Encoding: gzip
</I>&gt;<i> --e29d6a3c-F--
</I>&gt;<i> HTTP/1.1 403 Forbidden
</I>&gt;<i> Last-Modified: Wed, 25 May 2011 01:34:04 GMT
</I>&gt;<i> ETag: &quot;1c00603-3c2-4a40fb3273b00&quot;
</I>&gt;<i> Accept-Ranges: bytes
</I>&gt;<i> Vary: Accept-Encoding,User-Agent
</I>&gt;<i> Content-Encoding: gzip
</I>&gt;<i> X-Powered-By: PleskLin
</I>&gt;<i> Content-Length: 553
</I>&gt;<i> Connection: close
</I>&gt;<i> Content-Type: text/html
</I>&gt;<i> --e29d6a3c-H--
</I>&gt;<i> Message: Access denied with code 403 (phase 2). Operator EQ matched 0 at REQUEST_HEADERS. [file &quot;/etc/httpd/modsecurity.d/activated_rules/modsecurity_crs_21_protocol_anomalies.conf&quot;] [line &quot;47&quot;] [id &quot;960015&quot;] [rev &quot;2.2.5&quot;] [msg &quot;Request Missing an Accept Header&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;]
</I>&gt;<i> Action: Intercepted (phase 2)
</I>&gt;<i> Stopwatch: 1366197978059393 1535 (- - -)
</I>&gt;<i> Stopwatch2: 1366197978059393 1535; combined=388, p1=262, p2=86, p3=0, p4=0, p5=40, sr=99, sw=0, l=0, gc=0
</I>&gt;<i> Producer: ModSecurity for Apache/2.6.8 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); OWASP_CRS/2.2.5.
</I>&gt;<i> Server: Apache
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>    Rgrds,
</I>&gt;<i> Saneesh C.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ________________________________
</I>&gt;<i>
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;<i>
</I>&gt;<i>
</I>


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001376.html">[Owasp-modsecurity-core-rule-set] Mod_Security Blocks	Google_Analytics_Content_Experiments
</A></li>
	<LI>Next message: <A HREF="001378.html">[Owasp-modsecurity-core-rule-set] Mod_Security Blocks	Google_Analytics_Content_Experiments
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1377">[ date ]</a>
              <a href="thread.html#1377">[ thread ]</a>
              <a href="subject.html#1377">[ subject ]</a>
              <a href="author.html#1377">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
