<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] rule bypass question
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20rule%20bypass%20question&In-Reply-To=200911301632.26846.ryan.barnett%40breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000219.html">
   <LINK REL="Next"  HREF="000221.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] rule bypass question</H1>
    <B>Chris Datfung</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20rule%20bypass%20question&In-Reply-To=200911301632.26846.ryan.barnett%40breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] rule bypass question">chris.datfung at gmail.com
       </A><BR>
    <I>Sun Dec 20 17:20:24 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000219.html">[Owasp-modsecurity-core-rule-set] the crs_60_correlation.conf
</A></li>
        <LI>Next message: <A HREF="000221.html">[Owasp-modsecurity-core-rule-set] folder exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#220">[ date ]</a>
              <a href="thread.html#220">[ thread ]</a>
              <a href="subject.html#220">[ subject ]</a>
              <a href="author.html#220">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Mon, Nov 30, 2009 at 11:32 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ryan.barnett at breach.com</A>&gt;wrote:


&gt;<i> Hey Chris,
</I>
 Please see my other email that I just sent to the list about the new CRS

v2.0.4 as the HTTP Parameter Pollution rule now has a rule id.  With this
&gt;<i> info, you can now add the following example exception rule to the 48 local
</I>&gt;<i> exceptions conf file -
</I>&gt;<i>
</I>&gt;<i> SecRule REQUEST_FILENAME &quot;@streq /VulnScript.php&quot;
</I>&gt;<i> &quot;chain,phase:2,t:none,nolog,pass&quot;
</I>&gt;<i> SecRule TX:/^HPP-1.*ARGS:(foo|bar)/ &quot;.&quot; &quot;chain,setvar:tx.hpp-
</I>&gt;<i> counter=+1,setvar:tx.hpp-%{tx.hpp-counter}=%{matched_var_name}&quot;
</I>&gt;<i>        SecRule TX:'/^HPP-/' &quot;^TX:(hpp.*ARGS:(foo|bar))$&quot;
</I>&gt;<i> &quot;capture,setvar:!tx.
</I>&gt;<i> %{tx.1},setvar:tx.anomaly_score=-20&quot;
</I>&gt;<i>
</I>
Hi Ryan,

Based on the number of questions to the list regarding the proper way to
create exceptions, more documentation, perhaps a step by step blog post or
something would be really helpful in wrapping my head around this.

In the example above:
1. can you explain the logic in incrementing the tx.hpp-counter and setting
tx.hpp-%{tx.hpp-
    counter}=%{matched_var_name}&quot;

2. can you explain the last SecRule line as well.

3. when using concurrent logging, is there any way (besides for increasing
the debug log
    level) to see the name of the relevant variable set that needs its
anomaly score
    decreased?

Thanks,
 - Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091221/73d320f3/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091221/73d320f3/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000219.html">[Owasp-modsecurity-core-rule-set] the crs_60_correlation.conf
</A></li>
	<LI>Next message: <A HREF="000221.html">[Owasp-modsecurity-core-rule-set] folder exception
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#220">[ date ]</a>
              <a href="thread.html#220">[ thread ]</a>
              <a href="subject.html#220">[ subject ]</a>
              <a href="author.html#220">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
