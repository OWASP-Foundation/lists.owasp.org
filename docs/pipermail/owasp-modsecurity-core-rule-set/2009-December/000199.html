<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] no rule ID  &#65311;
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%3D%3Fiso-2022-jp%3Fb%3Fbm8gcnVsZSBJ%3F%3D%0A%20%3D%3Fiso-2022-jp%3Fb%3FRCAgGyRCISkbKEI%3D%3F%3D&In-Reply-To=200912100911.48210.ryan.barnett%40breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000197.html">
   <LINK REL="Next"  HREF="000203.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] no rule ID  &#65311;</H1>
    <B>ll</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%3D%3Fiso-2022-jp%3Fb%3Fbm8gcnVsZSBJ%3F%3D%0A%20%3D%3Fiso-2022-jp%3Fb%3FRCAgGyRCISkbKEI%3D%3F%3D&In-Reply-To=200912100911.48210.ryan.barnett%40breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] no rule ID  &#65311;">ibeginhere at gmail.com
       </A><BR>
    <I>Thu Dec 10 20:35:21 EST 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000197.html">[Owasp-modsecurity-core-rule-set] no rule ID &#65311;
</A></li>
        <LI>Next message: <A HREF="000203.html">[Owasp-modsecurity-core-rule-set] no rule ID &#65311;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#199">[ date ]</a>
              <a href="thread.html#199">[ thread ]</a>
              <a href="subject.html#199">[ subject ]</a>
              <a href="author.html#199">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Yes ,I'm reading the 48 local excetions.but still confuse.here is my
auditlog, thanks your help.I just want to disable this rule for this url
(/news/abc.swf?id=20091211&amp;style=3)
,other website still need to be inspect
--cecdfa17-A--
[10/Dec/2009:16:22:14 +0800] SyCvtdJMQTgAABXDVjcAAAAC 127.0.0.1 60252
127.0.0.1 8000
--cecdfa17-B--
GET /news/abc.swf?id=20091211&amp;style=3 HTTP/1.1
Accept: */*
Referer: <A HREF="http://www.abc.com/news/index.html">http://www.abc.com/news/index.html</A>
Accept-Language: zh-cn
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 ()
Host: www.abc.com
Cookie: JSESSIONID=869946B0D9D6C75C3600E22E54A2C172


--cecdfa17-F--
HTTP/1.1 403 Forbidden
Content-Length: 286
Content-Type: text/html; charset=iso-8859-1

--cecdfa17-H--
Message: Access denied with code 403 (phase 2). Operator GE matched 20
at TX:anomaly_score. [file
&quot;/etc/conf/modsecurity-crs_2.0.3/base_rules/modsecurity_crs_49_enforcement.conf&quot;]
[line &quot;25&quot;] [msg &quot;Anomaly Score Exceeded (score 20): XSS Attack Detected&quot;]
Action: Intercepted (phase 2)
Apache-Handler: proxy-server
Stopwatch: 1260433333972585 876832 (6983 798741 -)
Producer: ModSecurity for Apache/2.5.7 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>);
core ruleset/2.0.3.
Server: Apache/2.2.11 (Unix) mod_ssl/2.2.11 OpenSSL/0.9.8b
WebApp-Info: &quot;abc&quot; &quot;-&quot; &quot;-&quot;

--cecdfa17-K--
SecAction
&quot;phase:1,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remote_addr}&quot;
SecRule &quot;REQUEST_METHOD&quot; &quot;@rx ^(?:GET|HEAD)$&quot;
&quot;phase:2,chain,t:none,block,nolog,auditlog,status:400,msg:'GET or HEAD
requests with bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION&quot;
SecRule &quot;&amp;REQUEST_HEADERS:Content-Type&quot; &quot;@eq 0&quot;
&quot;phase:2,pass,chain,t:none,nolog,auditlog,msg:'Request Containing
Content, but Missing Content-Type header',id:960904,severity:5&quot;
SecRule &quot;ARGS_NAMES&quot; &quot;@rx .*&quot;
&quot;phase:2,chain,t:none,nolog,auditlog,pass,capture,setvar:tx.arg_name_%{tx.0}=+1,msg:'Possible
HTTP Parameter Pollution Attack: Multiple Parameters with the same Name.'&quot;
SecRule &quot;ARGS_NAMES&quot; &quot;@rx .*&quot;
&quot;phase:2,chain,t:none,nolog,auditlog,pass,capture,setvar:tx.arg_name_%{tx.0}=+1,msg:'Possible
HTTP Parameter Pollution Attack: Multiple Parameters with the same Name.'&quot;
SecRule
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;
&quot;@pmFromFile modsecurity_40_generic_attacks.data&quot;
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;
SecRule
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;
&quot;@pmFromFile modsecurity_40_generic_attacks.data&quot;
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;
SecRule
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;
&quot;@pmFromFile modsecurity_40_generic_attacks.data&quot;
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;
SecRule &quot;&amp;TX:/SQL_INJECTION/&quot; &quot;@eq 0&quot;
&quot;phase:2,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK&quot;
SecRule
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;
&quot;@pm jscript onsubmit copyparentfolder javascript meta onchange onmove
onkeydown onkeyup activexobject onerror onmouseup ecmascript bexpression
onmouseover vbscript: &lt;![cdata[ http: .innerhtml settimeout shell:
onabort asfunction: onkeypress onmousedown onclick .fromcharcode
background-image: .cookie x-javascript ondragdrop onblur mocha:
javascript: onfocus lowsrc getparentfolder onresize @import alert script
onselect onmouseout application onmousemove background .execscript
livescript: vbscript getspecialfolder .addimport iframe onunload
createtextrange &lt;input onload&quot;
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,skip:1,setvar:tx.pm_xss_data_%{matched_var_name}=%{matched_var}&quot;
SecRule &quot;REQUEST_URI_RAW|REQUEST_BODY&quot; &quot;@rx \\bstyle\\b\\W*?=&quot;
&quot;phase:2,t:none,t:lowercase,block,nolog,auditlog,ctl:debugLogLevel=9,msg:'XSS
Attack
Detected',setvar:tx.msg=%{rule.msg},setvar:tx.xss_score=+1,setvar:tx.anomaly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{matched_var}&quot;
SecRule &quot;REQUEST_FILENAME&quot; &quot;!@pmFromFile
modsecurity_46_et_sql_injection.data&quot;
&quot;phase:2,nolog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,skipAfter:END_ET_SQLI_RULES&quot;
SecRule &quot;REQUEST_FILENAME&quot; &quot;!@pmFromFile
modsecurity_46_et_web_rules.data&quot;
&quot;phase:2,nolog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,skipAfter:END_SNORT_RULES&quot;
SecRule &quot;TX:ANOMALY_SCORE&quot; &quot;@ge 20&quot;
&quot;phase:2,t:none,log,auditlog,deny,msg:'Anomaly Score Exceeded (score
%{TX.ANOMALY_SCORE}): %{tx.msg}',setvar:tx.inbound_tx_msg=%{tx.msg}&quot;

--cecdfa17-Z--



&#20110; 2009-12-10 22:11, Ryan Barnett &#20889;&#36947;:
&gt;<i> On Thursday 10 December 2009 04:11:53 am ll wrote:
</I>&gt;<i>   
</I>&gt;&gt;<i> in the newest rule set( modsecurity-crs_2.0.3) ,there are not rule id in
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> some rule .eg.
</I>&gt;&gt;<i> SecRule REQUEST_URI_RAW|REQUEST_BODY
</I>&gt;&gt;<i> &quot;\bon(abort|blur|change|click|dblclick|dragdrop|error|\
</I>&gt;&gt;<i> focus|keydown|keypress|keyup|load|mousedown|mousemove|mouseout\
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> |mouseover|mouseup|move|readystatechange|reset|resize|select|submit|unload)
</I>&gt;&gt;<i> |\b\W*?=&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> \
</I>&gt;&gt;<i> &quot;phase:2,t:none,t:lowercase,block,nolog,auditlog,msg:'XSS Attack
</I>&gt;&gt;<i> Detected',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+1,setvar:tx.anom
</I>&gt;&gt;<i> aly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{mat
</I>&gt;&gt;<i> ched_var}&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> In my server ,this is a False Positive for some url.and I want to
</I>&gt;&gt;<i> disable it for there url.
</I>&gt;&gt;<i> but there are no rule id,I can't SecRuleRemoveById.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     
</I>&gt;<i>
</I>&gt;<i> We will go back through the rule set to ensure that all rules have a rule id.  
</I>&gt;<i> That being said, you can still go to the 48 local exceptions file and add in 
</I>&gt;<i> rule there.
</I>&gt;<i>
</I>&gt;<i> If you send an example audit log entry of this false positive, I could send 
</I>&gt;<i> you an example exception.
</I>&gt;<i>
</I>&gt;<i> -Ryan
</I>&gt;<i>
</I>&gt;<i>   
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091211/270c0d75/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20091211/270c0d75/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000197.html">[Owasp-modsecurity-core-rule-set] no rule ID &#65311;
</A></li>
	<LI>Next message: <A HREF="000203.html">[Owasp-modsecurity-core-rule-set] no rule ID &#65311;
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#199">[ date ]</a>
              <a href="thread.html#199">[ thread ]</a>
              <a href="subject.html#199">[ subject ]</a>
              <a href="author.html#199">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
