<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Remove Cookie inspection for SQL injection rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Remove%20Cookie%20inspection%20for%0A%20SQL%20injection%20rules&In-Reply-To=%3C20160115081652.GA13913%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001876.html">
   <LINK REL="Next"  HREF="001878.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Remove Cookie inspection for SQL injection rules</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Remove%20Cookie%20inspection%20for%0A%20SQL%20injection%20rules&In-Reply-To=%3C20160115081652.GA13913%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Remove Cookie inspection for SQL injection rules">christian.folini at netnea.com
       </A><BR>
    <I>Fri Jan 15 08:16:52 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001876.html">[Owasp-modsecurity-core-rule-set] Remove Cookie inspection for SQL	injection rules
</A></li>
        <LI>Next message: <A HREF="001878.html">[Owasp-modsecurity-core-rule-set] Rules triggering False Positives	frequently
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1877">[ date ]</a>
              <a href="thread.html#1877">[ thread ]</a>
              <a href="subject.html#1877">[ subject ]</a>
              <a href="author.html#1877">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Richard,

On Thu, Jan 14, 2016 at 02:45:35PM +0000, Richard Jones wrote:
&gt;<i> The following seems to parse but I&#8217;ve no idea if it&#8217;s working or not.
</I>&gt;<i> Specifically I doubt that chain will extend to all the following
</I>&gt;<i> SecRuleUpdate&#8217;s.
</I>&gt;<i> 
</I>&gt;<i> SecRule REQUEST_URI &#8220;(?i)/+nmsruntime&#8221; \
</I>&gt;<i>    &#8220;chain,id:&#8217;000002&#8217;,phase:1,t:none,pass,log&#8221;
</I>&gt;<i> SecRuleUpdateTargetById 981317 &#8220;!REQUEST_COOKIES:/^VarQuestion_[0-9]+/&#8221;
</I>&gt;<i> SecRuleUpdateTargetById 981257 &#8220;!REQUEST_COOKIES:/^VarQuestion_[0-9]+/&#8221;
</I>&gt;<i> SecRuleUpdateTargetById 981245 &#8220;!REQUEST_COOKIES:/^VarQuestion_[0
</I>
No, this does not work. chain is limited to SecRule.

I believe, what you want is:

SecRule REQUEST_URI &quot;...&quot; &quot;phase:1,...,ctl:ruleRemoveTargetById=981317;REQUEST_COOKIES:/^VarQuestion/,ctl:ruleRemoveTargetById=981257;...&quot;

I have not tried this out myself. But this is the basic pattern, I would
use. 

What I am not sure is if you really want to limit the ignoring of the
said cookies to a certain path. This implies you want to check
these cookies for other paths as well. Would not it be simplet to
use SecRuleUpdateTargetById without path restriction and ignore 
the cookies site-wide?

Likewise, my regex pattern assumes, VarQuestion_... brings only
numbers as suffix. And as this should cover all of them, I think
the simpler and faster regex pattern is good enough.

&gt;<i> And using the Anomaly scoring method I couldn&#8217;t work out how to update
</I>&gt;<i> the REQUEST_COOKIE target to exclude these cookies, and it doesn&#8217;t look
</I>&gt;<i> like I can use a regex to capture VarQuestion_[0-9]+.
</I>
I have something in mind, that there is an issue with the +. Maybe you
want to try *. What certainly does not work is (a|b) patterns. Do not
know why.

Ahoj,

Christian


&gt;<i> 
</I>&gt;<i> Thanks,
</I>&gt;<i> 
</I>&gt;<i> Richard
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> <A HREF="http://www.jonze.com/privacy.html">http://www.jonze.com/privacy.html</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
-- 
Christian Folini
Ringstrasse 2
CH-3639 Kiesen
+41 (0)31 301 60 71 (H)
+41 (0)79 220 23 76 (M)
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A> (Business)
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at time-machine.ch</A> (Private)
<A HREF="http://www.christian-folini.ch">http://www.christian-folini.ch</A>

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001876.html">[Owasp-modsecurity-core-rule-set] Remove Cookie inspection for SQL	injection rules
</A></li>
	<LI>Next message: <A HREF="001878.html">[Owasp-modsecurity-core-rule-set] Rules triggering False Positives	frequently
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1877">[ date ]</a>
              <a href="thread.html#1877">[ thread ]</a>
              <a href="subject.html#1877">[ subject ]</a>
              <a href="author.html#1877">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
