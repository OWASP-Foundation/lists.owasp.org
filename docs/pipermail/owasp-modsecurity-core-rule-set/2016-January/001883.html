<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rules triggering False	Positives frequently
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rules%20triggering%20False%0A%09Positives%20frequently&In-Reply-To=%3CEC1872C3-68A9-4919-BA3E-50A81E59DF48%40spam.lifeforms.nl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001880.html">
   <LINK REL="Next"  HREF="001881.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rules triggering False	Positives frequently</H1>
    <B>Walter Hop</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rules%20triggering%20False%0A%09Positives%20frequently&In-Reply-To=%3CEC1872C3-68A9-4919-BA3E-50A81E59DF48%40spam.lifeforms.nl%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Rules triggering False	Positives frequently">modsec at spam.lifeforms.nl
       </A><BR>
    <I>Sat Jan 30 16:13:06 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001880.html">[Owasp-modsecurity-core-rule-set] Rules triggering False Positives frequently
</A></li>
        <LI>Next message: <A HREF="001881.html">[Owasp-modsecurity-core-rule-set] CRS 3.0.0rc1 renumbering issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1883">[ date ]</a>
              <a href="thread.html#1883">[ thread ]</a>
              <a href="subject.html#1883">[ subject ]</a>
              <a href="author.html#1883">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christian,

Last week I have taken a look at CRS v3 for the first time. I like the improved organization. I have also been looking at my audit logs and trying to sort out various categories of false positives and relate it to their 'fate' in CRS v3. To make the problem somewhat tractable I've focused on the rules that give me really a lot of FP. As I understand it, we have a few major categories of rules to consider, so I've sorted my FP into the following.

1) Rules which are currently gone in v3.0.0-rc1 and are not so interesting to bring back in paranoid mode due to high FP and low perceived utility. I have added my remarks about FP occurence in this table: <A HREF="https://www.owasp.org/index.php/OWASP_ModSec_CRS_Paranoia_Mode#Base_rules">https://www.owasp.org/index.php/OWASP_ModSec_CRS_Paranoia_Mode#Base_rules</A>

2) Rules which are currently included in v3.0.0-rc1 branch (normal mode), but might be candidates to move from normal to paranoid mode if their FP rate does not justify their benefits. This possibly decreases security for normal users, so the bar should be rather high. I&#8217;ve added only three candidates that you and Franziska didn&#8217;t have already. I have added my remarks about these rules in this table: <A HREF="https://www.owasp.org/index.php/OWASP_ModSec_CRS_Paranoia_Mode#Paranoia_Mode_Candidates">https://www.owasp.org/index.php/OWASP_ModSec_CRS_Paranoia_Mode#Paranoia_Mode_Candidates</A>

3) Rules from subdirectories in v2 which are no longer in v3.0.0-rc1, but we want to bring them back in paranoid mode because we think they do have worth. Bringing these rules back does not affect security for normal mode users. (experimental_rules, optional_rules, slr_rules)

I have looked at these, but I would recommend that more people look at them too. Most of them are uninteresting to me, so it's fine that they are removed. The slr_rules look quite outdated in particular. It's worth looking through experimental_rules and optional_rules though. I have added some possible candidates for us here, although I have no experience with them in production, so maybe Chaim can chime in if there are strong reasons for keeping them removed: <A HREF="https://www.owasp.org/index.php/OWASP_ModSec_CRS_Paranoia_Mode#Optional.2C_experimental.2C_slr_rules">https://www.owasp.org/index.php/OWASP_ModSec_CRS_Paranoia_Mode#Optional.2C_experimental.2C_slr_rules</A>

Finally, I noticed that some candidates might be considered paranoid but are currently already in the normal mode at notice_anomaly_score level (for example, User-Agent, Accept, Host header existence checks). These rules do not block in isolation, so we should keep in mind that the possible negative impact of FP on them is limited. Maybe it would be a useful task to add the scoring level as a column in the wiki.

In fact, we might even consider that any paranoid rules are possibly worth keeping in the 'normal mode' as lower-scoring rules - and just have paranoid mode bump up their score level, e.g. from 2 to 5. After all, if a normal user would consider the occurrence of 3 harmless protocol violations as a valid blocking heuristic, why not the occurrence of 3 paranoid rules? This last situation might be probably more predictive of an attack.

Cheers!
WH

-- 
Walter Hop | PGP key: <A HREF="https://lifeforms.nl/pgp">https://lifeforms.nl/pgp</A>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160130/1fe90dab/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160130/1fe90dab/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001880.html">[Owasp-modsecurity-core-rule-set] Rules triggering False Positives frequently
</A></li>
	<LI>Next message: <A HREF="001881.html">[Owasp-modsecurity-core-rule-set] CRS 3.0.0rc1 renumbering issues
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1883">[ date ]</a>
              <a href="thread.html#1883">[ thread ]</a>
              <a href="subject.html#1883">[ subject ]</a>
              <a href="author.html#1883">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
