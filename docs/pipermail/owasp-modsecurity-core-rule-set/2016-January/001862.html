<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Session hijacking and Could not set variable
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Session%20hijacking%20and%20Could%0A%20not%20set%20variable&In-Reply-To=%3C20160112204532.GB11513%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001861.html">
   <LINK REL="Next"  HREF="001863.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Session hijacking and Could not set variable</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Session%20hijacking%20and%20Could%0A%20not%20set%20variable&In-Reply-To=%3C20160112204532.GB11513%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Session hijacking and Could not set variable">christian.folini at netnea.com
       </A><BR>
    <I>Tue Jan 12 20:45:32 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="001861.html">[Owasp-modsecurity-core-rule-set] Session hijacking and Could not	set variable
</A></li>
        <LI>Next message: <A HREF="001863.html">[Owasp-modsecurity-core-rule-set] CRS Paranoia Mode: Let's get	going
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1862">[ date ]</a>
              <a href="thread.html#1862">[ thread ]</a>
              <a href="subject.html#1862">[ subject ]</a>
              <a href="author.html#1862">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Richard,

This error message is a rare.

On Tue, Jan 12, 2016 at 04:38:33PM +0000, Richard Jones wrote:
&gt;<i> I&#8217;m seeing huge number of these errors about session.ip_hash and
</I>&gt;<i> session.ua_hash not having a collection:
</I>&gt;<i> 
</I>&gt;<i> [Tue Jan 12 16:33:42.379454 2016] [:error] [pid 1925:tid 139976666769152] [client 10.30.82.121] ModSecurity: Could not set variable &#8220;session.ip_hash&#8221; as the collection does not exist. [hostname &#8220;www.reading.ac.uk&#8221;] [uri &#8220;/mytimetable/m&#8221;] [unique_id &#8220;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">VpUq5IbhAVgAAAeFS at UAAAEI</A>&#8221;]
</I>&gt;<i> [Tue Jan 12 16:33:42.379484 2016] [:error] [pid 1925:tid 139976666769152] [client 10.30.82.121] ModSecurity: Could not set variable &#8220;session.ua_hash&#8221; as the collection does not exist.
</I>&gt;<i> 
</I>&gt;<i> Disabling modsecurity_crs_16_session_hijacking.conf fixes the errors.
</I>
Can you confirm, that the setsid action is really executed
for the session collection and that it happens before 
modsecurity_crs_16_session_hijacking.conf?

Given your description of the setup, it should be alright, but
somehow there is an issue. If the creation of the collection fails,
then there should be an additional error, so I think setsid
is not happening.

Ahoj,

Christian


-- 
The meaning of the living words that come out of the experiences of
great hearts can never be exhausted by any one system of logical
interpretation.  They have to be endlessly explained by the
commentaries of individual lives, and they gain an added mystery in
each new revelation.
-- Rabindranath Tagore
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001861.html">[Owasp-modsecurity-core-rule-set] Session hijacking and Could not	set variable
</A></li>
	<LI>Next message: <A HREF="001863.html">[Owasp-modsecurity-core-rule-set] CRS Paranoia Mode: Let's get	going
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1862">[ date ]</a>
              <a href="thread.html#1862">[ thread ]</a>
              <a href="subject.html#1862">[ subject ]</a>
              <a href="author.html#1862">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
