From rogerio.brito at intercode.com.br  Tue May  6 20:54:43 2014
From: rogerio.brito at intercode.com.br (Rogerio Brito)
Date: Tue, 6 May 2014 17:54:43 -0300
Subject: [Owasp-modsecurity-core-rule-set] Need help with Joomla websites
	rules and SlowHttp Attacks
Message-ID: <063301cf696d$6812d490$38387db0$@intercode.com.br>

Hello all, 

 

I have lots of Joomla websites and I've just installed mod_security with
Owasp-modsecurity-core-rule-set.  I had to disable the
modsecurity_crs_41_xss_attacks.conf and
modsecurity_crs_41_sql_injection_attacks.conf rules because I could not edit
any article. Whenever I tried to save the article I would get a 403
forbidden.  I watched the audit log file and I've tried to comment out rule
by rule that fails, but as we are editing HTML  content there are so many
rules to comment that I believe there must some way else to do it. 

On another case, I've enabled the
modsecurity_crs_11_slow_dos_protection.conf rules, but I've tested the site
with http://www.acunetix.com/ and it still reports the site as vulnerable to
"Slow HTTP Denial of Service Attack". 

 

Can someone please help?

 

Thank you

Rogerio Brito

 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140506/ba326f88/attachment.html>

From RBarnett at trustwave.com  Tue May  6 21:28:26 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Tue, 6 May 2014 21:28:26 +0000
Subject: [Owasp-modsecurity-core-rule-set] Need help with Joomla
 websites	rules and SlowHttp Attacks
In-Reply-To: <063301cf696d$6812d490$38387db0$@intercode.com.br>
References: <063301cf696d$6812d490$38387db0$@intercode.com.br>
Message-ID: <0846EE03-0C36-4EED-9F71-2F8D0CE08174@trustwave.com>

Rogerio,
A couple of comments -

1) Please open GitHub Issue tickets for your false positives so that we can fix them.

2) How is Acunetix actually testing the vuln?

Keep in mind that the ModSecurity defenses for slow DoS attacks (headers vs post body) is really based on a scenario where a client has too many connections open vs actually doing any per-thread timing. If the scanner is only opening a single/small # it connections to test then the SecConnReadStateLimit/SecConnWriteStateLimit directives won't trigger.

Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

On May 6, 2014, at 5:12 PM, "Rogerio Brito" <rogerio.brito at intercode.com.br<mailto:rogerio.brito at intercode.com.br>> wrote:

Hello all,

I have lots of Joomla websites and I?ve just installed mod_security with Owasp-modsecurity-core-rule-set.  I had to disable the modsecurity_crs_41_xss_attacks.conf and modsecurity_crs_41_sql_injection_attacks.conf rules because I could not edit any article. Whenever I tried to save the article I would get a 403 forbidden.  I watched the audit log file and I?ve tried to comment out rule by rule that fails, but as we are editing HTML  content there are so many rules to comment that I believe there must some way else to do it.
On another case, I?ve enabled the modsecurity_crs_11_slow_dos_protection.conf rules, but I?ve tested the site with http://www.acunetix.com/ and it still reports the site as vulnerable to ?Slow HTTP Denial of Service Attack?.

Can someone please help?

Thank you
Rogerio Brito

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140506/98549682/attachment.html>

From rogerio.brito at intercode.com.br  Thu May  8 20:48:36 2014
From: rogerio.brito at intercode.com.br (Rogerio Brito)
Date: Thu, 8 May 2014 17:48:36 -0300
Subject: [Owasp-modsecurity-core-rule-set] RES: Need help with Joomla
	websites	rules and SlowHttp Attacks
In-Reply-To: <0846EE03-0C36-4EED-9F71-2F8D0CE08174@trustwave.com>
References: <063301cf696d$6812d490$38387db0$@intercode.com.br>
	<0846EE03-0C36-4EED-9F71-2F8D0CE08174@trustwave.com>
Message-ID: <071301cf6afe$e23fe770$a6bfb650$@intercode.com.br>

Hi Ryan, 

 

Ok, I?ll open tickets on github. 

 

To fix the Slow DoS Attacks I?ve changed the rule as indicated on Acunetix
website, as follows: 

 

<IfModule reqtimeout_module>

RequestReadTimeout header=20-40,MinRate=500 body=30,MinRate=500

</IfModule>

 

After that they reported it as secure. 

 

Thank you

[]s

assinatura_rogerio

 

De: Ryan Barnett [mailto:RBarnett at trustwave.com] 
Enviada em: ter?a-feira, 6 de maio de 2014 18:28
Para: Rogerio Brito
Cc: owasp-modsecurity-core-rule-set at lists.owasp.org
Assunto: Re: [Owasp-modsecurity-core-rule-set] Need help with Joomla
websites rules and SlowHttp Attacks

 

Rogerio,

A couple of comments -

 

1) Please open GitHub Issue tickets for your false positives so that we can
fix them. 

 

2) How is Acunetix actually testing the vuln?  

 

Keep in mind that the ModSecurity defenses for slow DoS attacks (headers vs
post body) is really based on a scenario where a client has too many
connections open vs actually doing any per-thread timing. If the scanner is
only opening a single/small # it connections to test then the
SecConnReadStateLimit/SecConnWriteStateLimit directives won't trigger. 

Ryan Barnett

Lead Security Researcher, SpiderLabs

 

Trustwave | SMART SECURITY ON DEMAND

 <http://www.trustwave.com/> www.trustwave.com


On May 6, 2014, at 5:12 PM, "Rogerio Brito" <rogerio.brito at intercode.com.br>
wrote:

Hello all, 

 

I have lots of Joomla websites and I?ve just installed mod_security with
Owasp-modsecurity-core-rule-set.  I had to disable the
modsecurity_crs_41_xss_attacks.conf and
modsecurity_crs_41_sql_injection_attacks.conf rules because I could not edit
any article. Whenever I tried to save the article I would get a 403
forbidden.  I watched the audit log file and I?ve tried to comment out rule
by rule that fails, but as we are editing HTML  content there are so many
rules to comment that I believe there must some way else to do it. 

On another case, I?ve enabled the
modsecurity_crs_11_slow_dos_protection.conf rules, but I?ve tested the site
with http://www.acunetix.com/ and it still reports the site as vulnerable to
?Slow HTTP Denial of Service Attack?. 

 

Can someone please help?

 

Thank you

Rogerio Brito

 

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

 

  _____  


This transmission may contain information that is privileged, confidential,
and/or exempt from disclosure under applicable law. If you are not the
intended recipient, you are hereby notified that any disclosure, copying,
distribution, or use of the information contained herein (including any
reliance thereon) is strictly prohibited. If you received this transmission
in error, please immediately contact the sender and destroy the material in
its entirety, whether in electronic or hard copy format.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140508/b9fcadf0/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.gif
Type: image/gif
Size: 11910 bytes
Desc: not available
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140508/b9fcadf0/attachment-0001.gif>

From RBarnett at trustwave.com  Fri May  9 13:25:04 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Fri, 9 May 2014 13:25:04 +0000
Subject: [Owasp-modsecurity-core-rule-set] RES: Need help with Joomla
 websites rules and SlowHttp Attacks
In-Reply-To: <0268BA53-6EA7-496F-B736-1C8163F63F27@proactiverisk.com>
References: <063301cf696d$6812d490$38387db0$@intercode.com.br>
	<0846EE03-0C36-4EED-9F71-2F8D0CE08174@trustwave.com>
	<071301cf6afe$e23fe770$a6bfb650$@intercode.com.br>
	<0268BA53-6EA7-496F-B736-1C8163F63F27@proactiverisk.com>
Message-ID: <CF924F1A.F2446%rbarnett@trustwave.com>

Thanks Tom. I actually used this tool when we originally added the ModSecurity defenses.  ModSecurity blocked it as the tool opens many concurrent connections and then sends the data slowly.  This triggered the ModSec thresholds for the # of threads in either the READ/WRITE bucket states.

Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

From: Tom Brennan - proactiveRISK <tomb at proactiverisk.com<mailto:tomb at proactiverisk.com>>
Date: Thursday, May 8, 2014 6:49 PM
To: Rogerio Brito <rogerio.brito at intercode.com.br<mailto:rogerio.brito at intercode.com.br>>
Cc: Ryan Barnett <rbarnett at trustwave.com<mailto:rbarnett at trustwave.com>>, "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: Re: [Owasp-modsecurity-core-rule-set] RES: Need help with Joomla websites rules and SlowHttp Attacks

Check it with this owasp tool

https://www.owasp.org/index.php/OWASP_HTTP_Post_Tool

4.0 in development too blog post about it here http://proactiverisk.blogspot.com/2014/05/blog-post.html

---
Tom Brennan | 973-298-1160 x799 | tomb at proactiverisk.com<mailto:tomb at proactiverisk.com>


On May 8, 2014, at 4:48 PM, "Rogerio Brito" <rogerio.brito at intercode.com.br<mailto:rogerio.brito at intercode.com.br>> wrote:

Hi Ryan,

Ok, I?ll open tickets on github.

To fix the Slow DoS Attacks I?ve changed the rule as indicated on Acunetix website, as follows:

<IfModule reqtimeout_module>
RequestReadTimeout header=20-40,MinRate=500 body=30,MinRate=500
</IfModule>

After that they reported it as secure.

Thank you
[]s
<image001.gif>

De: Ryan Barnett [mailto:RBarnett at trustwave.com]
Enviada em: ter?a-feira, 6 de maio de 2014 18:28
Para: Rogerio Brito
Cc: owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>
Assunto: Re: [Owasp-modsecurity-core-rule-set] Need help with Joomla websites rules and SlowHttp Attacks

Rogerio,
A couple of comments -

1) Please open GitHub Issue tickets for your false positives so that we can fix them.

2) How is Acunetix actually testing the vuln?

Keep in mind that the ModSecurity defenses for slow DoS attacks (headers vs post body) is really based on a scenario where a client has too many connections open vs actually doing any per-thread timing. If the scanner is only opening a single/small # it connections to test then the SecConnReadStateLimit/SecConnWriteStateLimit directives won't trigger.
Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

On May 6, 2014, at 5:12 PM, "Rogerio Brito" <rogerio.brito at intercode.com.br<mailto:rogerio.brito at intercode.com.br>> wrote:
Hello all,

I have lots of Joomla websites and I?ve just installed mod_security with Owasp-modsecurity-core-rule-set.  I had to disable the modsecurity_crs_41_xss_attacks.conf and modsecurity_crs_41_sql_injection_attacks.conf rules because I could not edit any article. Whenever I tried to save the article I would get a 403 forbidden.  I watched the audit log file and I?ve tried to comment out rule by rule that fails, but as we are editing HTML  content there are so many rules to comment that I believe there must some way else to do it.
On another case, I?ve enabled the modsecurity_crs_11_slow_dos_protection.conf rules, but I?ve tested the site with http://www.acunetix.com/ and it still reports the site as vulnerable to ?Slow HTTP Denial of Service Attack?.

Can someone please help?

Thank you
Rogerio Brito

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

WARNING: E-mail transmission cannot be guaranteed to be secure or error-free as information could be intercepted, corrupted, lost, destroyed, arrive late or incomplete, or contain viruses. The sender therefore does not accept liability for any errors or omissions in the contents of this message, which arise as a result of e-mail transmission. No employee or agent is authorized to conclude any binding agreement on behalf of proactiveRISK with another party by email.


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140509/ba35f0b3/attachment.html>

From RBarnett at trustwave.com  Fri May  9 14:23:00 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Fri, 9 May 2014 14:23:00 +0000
Subject: [Owasp-modsecurity-core-rule-set] RES: Need help with Joomla
 websites rules and SlowHttp Attacks
Message-ID: <CF925CC1.F24A6%rbarnett@trustwave.com>

Thanks.

Yeah, we discussed the use of mod_reqtimeout in our blog post -
http://blog.spiderlabs.com/2011/07/advanced-topic-of-the-week-mitigating-slow-http-dos-attacks.html

Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

From: Rogerio Brito <rogerio.brito at intercode.com.br<mailto:rogerio.brito at intercode.com.br>>
Date: Thursday, May 8, 2014 4:48 PM
To: Ryan Barnett <rbarnett at trustwave.com<mailto:rbarnett at trustwave.com>>
Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: RES: [Owasp-modsecurity-core-rule-set] Need help with Joomla websites rules and SlowHttp Attacks

Hi Ryan,

Ok, I?ll open tickets on github.

To fix the Slow DoS Attacks I?ve changed the rule as indicated on Acunetix website, as follows:

<IfModule reqtimeout_module>
RequestReadTimeout header=20-40,MinRate=500 body=30,MinRate=500
</IfModule>

After that they reported it as secure.

Thank you
[]s
[assinatura_rogerio]

De: Ryan Barnett [mailto:RBarnett at trustwave.com]
Enviada em: ter?a-feira, 6 de maio de 2014 18:28
Para: Rogerio Brito
Cc: owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>
Assunto: Re: [Owasp-modsecurity-core-rule-set] Need help with Joomla websites rules and SlowHttp Attacks

Rogerio,
A couple of comments -

1) Please open GitHub Issue tickets for your false positives so that we can fix them.

2) How is Acunetix actually testing the vuln?

Keep in mind that the ModSecurity defenses for slow DoS attacks (headers vs post body) is really based on a scenario where a client has too many connections open vs actually doing any per-thread timing. If the scanner is only opening a single/small # it connections to test then the SecConnReadStateLimit/SecConnWriteStateLimit directives won't trigger.
Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

On May 6, 2014, at 5:12 PM, "Rogerio Brito" <rogerio.brito at intercode.com.br<mailto:rogerio.brito at intercode.com.br>> wrote:
Hello all,

I have lots of Joomla websites and I?ve just installed mod_security with Owasp-modsecurity-core-rule-set.  I had to disable the modsecurity_crs_41_xss_attacks.conf and modsecurity_crs_41_sql_injection_attacks.conf rules because I could not edit any article. Whenever I tried to save the article I would get a 403 forbidden.  I watched the audit log file and I?ve tried to comment out rule by rule that fails, but as we are editing HTML  content there are so many rules to comment that I believe there must some way else to do it.
On another case, I?ve enabled the modsecurity_crs_11_slow_dos_protection.conf rules, but I?ve tested the site with http://www.acunetix.com/ and it still reports the site as vulnerable to ?Slow HTTP Denial of Service Attack?.

Can someone please help?

Thank you
Rogerio Brito

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140509/5087ee60/attachment-0001.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.gif
Type: image/gif
Size: 11910 bytes
Desc: image001.gif
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140509/5087ee60/attachment-0001.gif>

From anoopsaldanha at gmail.com  Mon May 12 09:14:35 2014
From: anoopsaldanha at gmail.com (Anoop Saldanha)
Date: Mon, 12 May 2014 14:44:35 +0530
Subject: [Owasp-modsecurity-core-rule-set] CRS-2.2.9 - Duplicates found for
	rules 2011257 and 2011258
Message-ID: <CAJK8jKFn=jjRP508DchZ61b2hw49TBc91pMKoT9Na=bgP6y67Q@mail.gmail.com>

Under CRS-2.2.9, under the "slr_rules" directory, each of these 2
files have the above 2 rules but with different subsequent chains in 2
different files.

Filename: modsecurity_crs_46_slr_et_wordpress_attacks.conf

# (2011257) SpiderLabs Research (SLR) Public Vulns: ET
WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
ripting Attempt
SecRule REQUEST_LINE "@contains
/wp-content/plugins/firestats/php/window-add-excluded-url.php"
"chain,phase:2,block,t:none,t\
:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
ET WEB\
_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
Scripting Attempt',tag:'web-application-attack'"

SecRule ARGS:edit
"(?i:edit\x3d.+(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblcl\
ick|onsubmit|onreset|onselect|onchange|style\x3D))"
"ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
wind\
ow-add-excluded-url.php Cross Site Scripting
Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rul\
e.id}-WEB_ATTACK/WORDPRESS-%{matched_var_name}=%{matched_var}'"

Filename: modsecurity_crs_46_slr_et_xss_attacks.conf

# (2011257) SpiderLabs Research (SLR) Public Vulns: ET
WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
ripting Attempt
SecRule REQUEST_LINE "@contains
/wp-content/plugins/firestats/php/window-add-excluded-url.php"
"chain,phase:2,block,t:none,t\
:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
ET WEB\
_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
Scripting Attempt',tag:'web-application-attack'"

SecRule &TX:'/XSS.*ARGS:edit/' "@gt 0"
"ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
window-add-exclud\
ed-url.php Cross Site Scripting
Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rule.id}-WEB_ATT\
ACK/XSS-%{matched_var_name}=%{matched_var}'"

-----

Similarly for rule with id: 2011258.

Is this behaviour intentional, or do we have a id numbering bug?

-- 
-------------------------------
Anoop Saldanha
http://www.poona.me
-------------------------------

From anoopsaldanha at gmail.com  Mon May 12 11:14:51 2014
From: anoopsaldanha at gmail.com (Anoop Saldanha)
Date: Mon, 12 May 2014 16:44:51 +0530
Subject: [Owasp-modsecurity-core-rule-set] CRS-2.2.9 - Duplicates found
	for rules 2011257 and 2011258
In-Reply-To: <CAJK8jKFn=jjRP508DchZ61b2hw49TBc91pMKoT9Na=bgP6y67Q@mail.gmail.com>
References: <CAJK8jKFn=jjRP508DchZ61b2hw49TBc91pMKoT9Na=bgP6y67Q@mail.gmail.com>
Message-ID: <CAJK8jKHLDxtfAhMJhEK1z72PpbbrNV6hf5ojs-fmyQKBZEBr0g@mail.gmail.com>

On Mon, May 12, 2014 at 2:44 PM, Anoop Saldanha <anoopsaldanha at gmail.com> wrote:
> Under CRS-2.2.9, under the "slr_rules" directory, each of these 2
> files have the above 2 rules but with different subsequent chains in 2
> different files.
>
> Filename: modsecurity_crs_46_slr_et_wordpress_attacks.conf
>
> # (2011257) SpiderLabs Research (SLR) Public Vulns: ET
> WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
> ripting Attempt
> SecRule REQUEST_LINE "@contains
> /wp-content/plugins/firestats/php/window-add-excluded-url.php"
> "chain,phase:2,block,t:none,t\
> :urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
> ET WEB\
> _SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
> Scripting Attempt',tag:'web-application-attack'"
>
> SecRule ARGS:edit
> "(?i:edit\x3d.+(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblcl\
> ick|onsubmit|onreset|onselect|onchange|style\x3D))"
> "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
> wind\
> ow-add-excluded-url.php Cross Site Scripting
> Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rul\
> e.id}-WEB_ATTACK/WORDPRESS-%{matched_var_name}=%{matched_var}'"
>
> Filename: modsecurity_crs_46_slr_et_xss_attacks.conf
>
> # (2011257) SpiderLabs Research (SLR) Public Vulns: ET
> WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
> ripting Attempt
> SecRule REQUEST_LINE "@contains
> /wp-content/plugins/firestats/php/window-add-excluded-url.php"
> "chain,phase:2,block,t:none,t\
> :urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
> ET WEB\
> _SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
> Scripting Attempt',tag:'web-application-attack'"
>
> SecRule &TX:'/XSS.*ARGS:edit/' "@gt 0"
> "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
> window-add-exclud\
> ed-url.php Cross Site Scripting
> Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rule.id}-WEB_ATT\
> ACK/XSS-%{matched_var_name}=%{matched_var}'"
>
> -----
>
> Similarly for rule with id: 2011258.
>
> Is this behaviour intentional, or do we have a id numbering bug?
>

To add to the above, it's not just the above rule, but there are a
bunch of such rules between these 2 files, sharing the same id.

-- 
-------------------------------
Anoop Saldanha
http://www.poona.me
-------------------------------

From RBarnett at trustwave.com  Mon May 12 11:53:43 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 12 May 2014 11:53:43 +0000
Subject: [Owasp-modsecurity-core-rule-set] CRS-2.2.9 - Duplicates found
 for	rules 2011257 and 2011258
In-Reply-To: <CAJK8jKFn=jjRP508DchZ61b2hw49TBc91pMKoT9Na=bgP6y67Q@mail.gmail.com>
References: <CAJK8jKFn=jjRP508DchZ61b2hw49TBc91pMKoT9Na=bgP6y67Q@mail.gmail.com>
Message-ID: <B170B319-8421-4227-8CF5-D61E0059D7D8@trustwave.com>

There are two different categories of protections on that directory that are alternatives to each other. The first one is a direct conversion of the ET signature (including the regex). The second one uses the metadata about the injection point but then uses OWASP ModSecurity CRS collaboration to check for the existence of previous generic rule matches.

See this blog post -
http://blog.spiderlabs.com/2011/04/modsecurity-advanced-topic-of-the-week-integrating-ids-signatures.html

Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

On May 12, 2014, at 5:31 AM, "Anoop Saldanha" <anoopsaldanha at gmail.com<mailto:anoopsaldanha at gmail.com>> wrote:

Under CRS-2.2.9, under the "slr_rules" directory, each of these 2
files have the above 2 rules but with different subsequent chains in 2
different files.

Filename: modsecurity_crs_46_slr_et_wordpress_attacks.conf

# (2011257) SpiderLabs Research (SLR) Public Vulns: ET
WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
ripting Attempt
SecRule REQUEST_LINE "@contains
/wp-content/plugins/firestats/php/window-add-excluded-url.php"
"chain,phase:2,block,t:none,t\
:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
ET WEB\
_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
Scripting Attempt',tag:'web-application-attack'"

SecRule ARGS:edit
"(?i:edit\x3d.+(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblcl\
ick|onsubmit|onreset|onselect|onchange|style\x3D))"
"ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
wind\
ow-add-excluded-url.php Cross Site Scripting
Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rul\
e.id}-WEB_ATTACK/WORDPRESS-%{matched_var_name}=%{matched_var}'"

Filename: modsecurity_crs_46_slr_et_xss_attacks.conf

# (2011257) SpiderLabs Research (SLR) Public Vulns: ET
WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
ripting Attempt
SecRule REQUEST_LINE "@contains
/wp-content/plugins/firestats/php/window-add-excluded-url.php"
"chain,phase:2,block,t:none,t\
:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
ET WEB\
_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
Scripting Attempt',tag:'web-application-attack'"

SecRule &TX:'/XSS.*ARGS:edit/' "@gt 0"
"ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
window-add-exclud\
ed-url.php Cross Site Scripting
Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rule.id}-WEB_ATT\
ACK/XSS-%{matched_var_name}=%{matched_var}'"

-----

Similarly for rule with id: 2011258.

Is this behaviour intentional, or do we have a id numbering bug?

--
-------------------------------
Anoop Saldanha
http://www.poona.me
-------------------------------
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140512/753f8229/attachment.html>

From anoopsaldanha at gmail.com  Mon May 12 13:58:00 2014
From: anoopsaldanha at gmail.com (Anoop Saldanha)
Date: Mon, 12 May 2014 19:28:00 +0530
Subject: [Owasp-modsecurity-core-rule-set] CRS-2.2.9 - Duplicates found
 for rules 2011257 and 2011258
In-Reply-To: <B170B319-8421-4227-8CF5-D61E0059D7D8@trustwave.com>
References: <CAJK8jKFn=jjRP508DchZ61b2hw49TBc91pMKoT9Na=bgP6y67Q@mail.gmail.com>
	<B170B319-8421-4227-8CF5-D61E0059D7D8@trustwave.com>
Message-ID: <CAJK8jKFbkmO9J_wJ_CBAnPFnW=3ACv+dcB=VT2E7OBKf7f1afw@mail.gmail.com>

Right.  Thanks Ryan.

On Mon, May 12, 2014 at 5:23 PM, Ryan Barnett <RBarnett at trustwave.com> wrote:
> There are two different categories of protections on that directory that are
> alternatives to each other. The first one is a direct conversion of the ET
> signature (including the regex). The second one uses the metadata about the
> injection point but then uses OWASP ModSecurity CRS collaboration to check
> for the existence of previous generic rule matches.
>
> See this blog post -
> http://blog.spiderlabs.com/2011/04/modsecurity-advanced-topic-of-the-week-integrating-ids-signatures.html
>
> Ryan Barnett
>
> Lead Security Researcher, SpiderLabs
>
>
>
> Trustwave | SMART SECURITY ON DEMAND
>
> www.trustwave.com
>
>
> On May 12, 2014, at 5:31 AM, "Anoop Saldanha" <anoopsaldanha at gmail.com>
> wrote:
>
> Under CRS-2.2.9, under the "slr_rules" directory, each of these 2
> files have the above 2 rules but with different subsequent chains in 2
> different files.
>
> Filename: modsecurity_crs_46_slr_et_wordpress_attacks.conf
>
> # (2011257) SpiderLabs Research (SLR) Public Vulns: ET
> WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
> ripting Attempt
> SecRule REQUEST_LINE "@contains
> /wp-content/plugins/firestats/php/window-add-excluded-url.php"
> "chain,phase:2,block,t:none,t\
> :urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
> ET WEB\
> _SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
> Scripting Attempt',tag:'web-application-attack'"
>
> SecRule ARGS:edit
> "(?i:edit\x3d.+(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblcl\
> ick|onsubmit|onreset|onselect|onchange|style\x3D))"
> "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
> wind\
> ow-add-excluded-url.php Cross Site Scripting
> Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rul\
> e.id}-WEB_ATTACK/WORDPRESS-%{matched_var_name}=%{matched_var}'"
>
> Filename: modsecurity_crs_46_slr_et_xss_attacks.conf
>
> # (2011257) SpiderLabs Research (SLR) Public Vulns: ET
> WEB_SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site Sc\
> ripting Attempt
> SecRule REQUEST_LINE "@contains
> /wp-content/plugins/firestats/php/window-add-excluded-url.php"
> "chain,phase:2,block,t:none,t\
> :urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,capture,logdata:'%{TX.0}',severity:'2',id:2011257,rev:2,msg:'SLR:
> ET WEB\
> _SPECIFIC_APPS FireStats window-add-excluded-url.php Cross Site
> Scripting Attempt',tag:'web-application-attack'"
>
> SecRule &TX:'/XSS.*ARGS:edit/' "@gt 0"
> "ctl:auditLogParts=+E,setvar:'tx.msg=ET WEB_SPECIFIC_APPS FireStats
> window-add-exclud\
> ed-url.php Cross Site Scripting
> Attempt',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:'tx.%{rule.id}-WEB_ATT\
> ACK/XSS-%{matched_var_name}=%{matched_var}'"
>
> -----
>
> Similarly for rule with id: 2011258.
>
> Is this behaviour intentional, or do we have a id numbering bug?
>
> --
> -------------------------------
> Anoop Saldanha
> http://www.poona.me
> -------------------------------
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
> ________________________________
>
> This transmission may contain information that is privileged, confidential,
> and/or exempt from disclosure under applicable law. If you are not the
> intended recipient, you are hereby notified that any disclosure, copying,
> distribution, or use of the information contained herein (including any
> reliance thereon) is strictly prohibited. If you received this transmission
> in error, please immediately contact the sender and destroy the material in
> its entirety, whether in electronic or hard copy format.



-- 
-------------------------------
Anoop Saldanha
http://www.poona.me
-------------------------------

From linux2981 at gmail.com  Thu May 15 08:31:23 2014
From: linux2981 at gmail.com (Linux Admin)
Date: Thu, 15 May 2014 14:01:23 +0530
Subject: [Owasp-modsecurity-core-rule-set] Profile timeout
Message-ID: <CAMCMj+3Mm9k_o05R0_mXXOTOTuXcuVzr2rB5Vd+FEhS3cdd1Nw@mail.gmail.com>

Hello,

I am trying to use modsecurity_crs_40_appsensor_detection_point* rules. The
rules are working for 60 minutes and after then the profiled data expired.
How can I extend this time out? I am using /tmp as "SecDataDir".


Thank you.

Best,
Sathish.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140515/d37d3c71/attachment.html>

From jamuse at owasp.org  Thu May 15 09:00:32 2014
From: jamuse at owasp.org (Josh Amishav-Zlatin)
Date: Thu, 15 May 2014 12:00:32 +0300
Subject: [Owasp-modsecurity-core-rule-set] Profile timeout
In-Reply-To: <CAMCMj+3Mm9k_o05R0_mXXOTOTuXcuVzr2rB5Vd+FEhS3cdd1Nw@mail.gmail.com>
References: <CAMCMj+3Mm9k_o05R0_mXXOTOTuXcuVzr2rB5Vd+FEhS3cdd1Nw@mail.gmail.com>
Message-ID: <CAC+O4mExu3nj95+O=wcsc9SoFG=Mi_BQk1hQ1R1XaBTU7HXeSg@mail.gmail.com>

On Thu, May 15, 2014 at 11:31 AM, Linux Admin <linux2981 at gmail.com> wrote:

> Hello,
>
> I am trying to use modsecurity_crs_40_appsensor_detection_point* rules.
> The rules are working for 60 minutes and after then the profiled data
> expired. How can I extend this time out? I am using /tmp as "SecDataDir".
>
>
Hi,

What is your SecCollectionTimeout directive set to? Default is 60 minutes:

https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecCollectionTimeout

- Josh


>
> Thank you.
>
> Best,
> Sathish.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140515/e4e533c2/attachment.html>

From neeraj at rockonllc.com  Mon May 19 19:09:33 2014
From: neeraj at rockonllc.com (Neeraj.Chaudhary)
Date: Mon, 19 May 2014 12:09:33 -0700
Subject: [Owasp-modsecurity-core-rule-set] JSON issues on mod_security
Message-ID: <003201cf7395$deacc660$9c065320$@rockonllc.com>

Hi,

It's been few days trying to figure out what is going wrong and where, but
now I am stumped and need help from you guys.

I am using mod_security on ISS version 8.0.9200.16384.
The same code works fine without mod_security but as soon as I enable
mod_security I get the below mentioned response.
Which shows that the parameter userName is not proper. I debugged and looked
into all possible concerns but unable to find an error. I am using jQuery
AJAX
 
{"Message":"Invalid web service call, missing value for parameter:
\u0027userName\u0027.","StackTrace":"   at
System.Web.Script.Services.WebServiceMethodData.CallMethod(Object target,
IDictionary`2 parameters)\r\n   at
System.Web.Script.Services.RestHandler.InvokeMethod(HttpContext context,
WebServiceMethodData methodData, IDictionary`2 rawParams)\r\n   at
System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext
context, WebServiceMethodData
methodData)","ExceptionType":"System.InvalidOperationException"}

Request Body : {"userName": "neeraj.chaudhary", "password": "Abcd123"}
Aspx webmethod signature is
		[WebMethod]
		public static string Login(string userName, string password)

I shall be delighted if someone can point out what can be done in this case.
Maybe change in rule or anything which can help me pass through this
scenario.

Regards,
Neeraj Chaudhary
+1 925 359 9074



From FCosta at trustwave.com  Mon May 19 19:37:24 2014
From: FCosta at trustwave.com (Felipe Costa)
Date: Mon, 19 May 2014 19:37:24 +0000
Subject: [Owasp-modsecurity-core-rule-set] JSON issues on mod_security
In-Reply-To: <003201cf7395$deacc660$9c065320$@rockonllc.com>
References: <003201cf7395$deacc660$9c065320$@rockonllc.com>
Message-ID: <176F385F-B1AC-4EAE-AA0B-2FA2AAF6116E@trustwave.com>

Hi Neeraj,

Can you double check if the application is receiving the request body at all? are you using
others IIS modules in combination with ModSecurity?

There is a bug opened, regarding to the ModSecurityIIS module and request body contents.
The link to the bug is available here:
https://github.com/SpiderLabs/ModSecurity/issues/562

Check if, by setting SecRequestBodyAccess to "off" your application starts to perform well again.

Br.,
Felipe "Zimmerle" Costa
Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>




On May 19, 2014, at 4:09 PM, Neeraj.Chaudhary <neeraj at rockonllc.com<mailto:neeraj at rockonllc.com>> wrote:

Hi,

It's been few days trying to figure out what is going wrong and where, but
now I am stumped and need help from you guys.

I am using mod_security on ISS version 8.0.9200.16384.
The same code works fine without mod_security but as soon as I enable
mod_security I get the below mentioned response.
Which shows that the parameter userName is not proper. I debugged and looked
into all possible concerns but unable to find an error. I am using jQuery
AJAX

{"Message":"Invalid web service call, missing value for parameter:
\u0027userName\u0027.","StackTrace":"   at
System.Web.Script.Services.WebServiceMethodData.CallMethod(Object target,
IDictionary`2 parameters)\r\n   at
System.Web.Script.Services.RestHandler.InvokeMethod(HttpContext context,
WebServiceMethodData methodData, IDictionary`2 rawParams)\r\n   at
System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext
context, WebServiceMethodData
methodData)","ExceptionType":"System.InvalidOperationException"}

Request Body : {"userName": "neeraj.chaudhary", "password": "Abcd123"}
Aspx webmethod signature is
[WebMethod]
public static string Login(string userName, string password)

I shall be delighted if someone can point out what can be done in this case.
Maybe change in rule or anything which can help me pass through this
scenario.

Regards,
Neeraj Chaudhary
+1 925 359 9074


_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set



________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140519/f04646f2/attachment.html>

From jroback at gmail.com  Mon May 19 19:46:07 2014
From: jroback at gmail.com (Joshua Roback)
Date: Mon, 19 May 2014 15:46:07 -0400
Subject: [Owasp-modsecurity-core-rule-set] JSON issues on mod_security
In-Reply-To: <003201cf7395$deacc660$9c065320$@rockonllc.com>
References: <003201cf7395$deacc660$9c065320$@rockonllc.com>
Message-ID: <CAExQ=_fDYfmQt8vAmg9xxR-gvuDwqTDKc=_7QBNBqAqhXR7Vow@mail.gmail.com>

This might help as well.

http://blog.spiderlabs.com/2014/05/modsecurity-advanced-topic-of-the-week-json-support.html


On Mon, May 19, 2014 at 3:09 PM, Neeraj.Chaudhary <neeraj at rockonllc.com>wrote:

> Hi,
>
> It's been few days trying to figure out what is going wrong and where, but
> now I am stumped and need help from you guys.
>
> I am using mod_security on ISS version 8.0.9200.16384.
> The same code works fine without mod_security but as soon as I enable
> mod_security I get the below mentioned response.
> Which shows that the parameter userName is not proper. I debugged and
> looked
> into all possible concerns but unable to find an error. I am using jQuery
> AJAX
>
> {"Message":"Invalid web service call, missing value for parameter:
> \u0027userName\u0027.","StackTrace":"   at
> System.Web.Script.Services.WebServiceMethodData.CallMethod(Object target,
> IDictionary`2 parameters)\r\n   at
> System.Web.Script.Services.RestHandler.InvokeMethod(HttpContext context,
> WebServiceMethodData methodData, IDictionary`2 rawParams)\r\n   at
> System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext
> context, WebServiceMethodData
> methodData)","ExceptionType":"System.InvalidOperationException"}
>
> Request Body : {"userName": "neeraj.chaudhary", "password": "Abcd123"}
> Aspx webmethod signature is
>                 [WebMethod]
>                 public static string Login(string userName, string
> password)
>
> I shall be delighted if someone can point out what can be done in this
> case.
> Maybe change in rule or anything which can help me pass through this
> scenario.
>
> Regards,
> Neeraj Chaudhary
> +1 925 359 9074
>
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>



-- 
Joshua Roback
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140519/69e85b48/attachment.html>

From neeraj at rockonllc.com  Mon May 19 20:25:23 2014
From: neeraj at rockonllc.com (Neeraj.Chaudhary)
Date: Mon, 19 May 2014 13:25:23 -0700
Subject: [Owasp-modsecurity-core-rule-set] JSON issues on mod_security
In-Reply-To: <176F385F-B1AC-4EAE-AA0B-2FA2AAF6116E@trustwave.com>
References: <003201cf7395$deacc660$9c065320$@rockonllc.com>
	<176F385F-B1AC-4EAE-AA0B-2FA2AAF6116E@trustwave.com>
Message-ID: <003701cf73a0$76d8b930$648a2b90$@rockonllc.com>

Hi Felipe,

 

Thanks a lot for your guidance.

Yes changing SecRequestBodyAccess to "off" use to start the application
again.

I was not using any other module on IIS. My dynamic compression was set to
off.

 

But yes, the suggestion mentioned in the link regarding
"SecStreamInBodyInspection On" solved my issue.

All I have to do now is understand what all places its gona hit me, because
in our application user can upload GBs of videos as well. 

 

Regards,

Neeraj Chaudhary

+1 925 359 9074

 

From: Felipe Costa [mailto:FCosta at trustwave.com] 
Sent: Monday, May 19, 2014 12:37 PM
To: Neeraj.Chaudhary
Cc: <owasp-modsecurity-core-rule-set at lists.owasp.org>
Subject: Re: [Owasp-modsecurity-core-rule-set] JSON issues on mod_security

 

Hi Neeraj, 

 

Can you double check if the application is receiving the request body at
all? are you using 

others IIS modules in combination with ModSecurity?

 

There is a bug opened, regarding to the ModSecurityIIS module and request
body contents.

The link to the bug is available here:

https://github.com/SpiderLabs/ModSecurity/issues/562

 

Check if, by setting SecRequestBodyAccess to "off" your application starts
to perform well again.

 

Br.,

Felipe "Zimmerle" Costa

Security Researcher, SpiderLabs

 

Trustwave | SMART SECURITY ON DEMAND

www.trustwave.com <http://www.trustwave.com/> 

 

 

 

 

On May 19, 2014, at 4:09 PM, Neeraj.Chaudhary <neeraj at rockonllc.com
<mailto:neeraj at rockonllc.com> > wrote:





Hi,

It's been few days trying to figure out what is going wrong and where, but
now I am stumped and need help from you guys.

I am using mod_security on ISS version 8.0.9200.16384.
The same code works fine without mod_security but as soon as I enable
mod_security I get the below mentioned response.
Which shows that the parameter userName is not proper. I debugged and looked
into all possible concerns but unable to find an error. I am using jQuery
AJAX

{"Message":"Invalid web service call, missing value for parameter:
\u0027userName\u0027.","StackTrace":"   at
System.Web.Script.Services.WebServiceMethodData.CallMethod(Object target,
IDictionary`2 parameters)\r\n   at
System.Web.Script.Services.RestHandler.InvokeMethod(HttpContext context,
WebServiceMethodData methodData, IDictionary`2 rawParams)\r\n   at
System.Web.Script.Services.RestHandler.ExecuteWebServiceCall(HttpContext
context, WebServiceMethodData
methodData)","ExceptionType":"System.InvalidOperationException"}

Request Body : {"userName": "neeraj.chaudhary", "password": "Abcd123"}
Aspx webmethod signature is
[WebMethod]
public static string Login(string userName, string password)

I shall be delighted if someone can point out what can be done in this case.
Maybe change in rule or anything which can help me pass through this
scenario.

Regards,
Neeraj Chaudhary
+1 925 359 9074


_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org> 
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

 

 

  _____  


This transmission may contain information that is privileged, confidential,
and/or exempt from disclosure under applicable law. If you are not the
intended recipient, you are hereby notified that any disclosure, copying,
distribution, or use of the information contained herein (including any
reliance thereon) is strictly prohibited. If you received this transmission
in error, please immediately contact the sender and destroy the material in
its entirety, whether in electronic or hard copy format.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140519/9754bc1b/attachment-0001.html>

From ilyassikai at gmail.com  Tue May 20 16:10:07 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Tue, 20 May 2014 17:10:07 +0100
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
Message-ID: <CAMmziWeqJSNw0vp=ZeQHC5qdAMOT3OxP6vfRbP-jgQ06UFtPZA@mail.gmail.com>

Hello
I've a problems when i'd like upload a jpg file.
how i can allow upload some type of file like : jpg, pdf ...
thank you

-- 
*Ilyass kaouam*
*Systems administrator*
* at Inforisk Group Finaccess  *
*European Masters in Information Technology*
*Portable : (212) *
*6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140520/af3fb954/attachment.html>

From jroback at gmail.com  Tue May 20 17:17:33 2014
From: jroback at gmail.com (Joshua Roback)
Date: Tue, 20 May 2014 13:17:33 -0400
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
In-Reply-To: <CAMmziWeqJSNw0vp=ZeQHC5qdAMOT3OxP6vfRbP-jgQ06UFtPZA@mail.gmail.com>
References: <CAMmziWeqJSNw0vp=ZeQHC5qdAMOT3OxP6vfRbP-jgQ06UFtPZA@mail.gmail.com>
Message-ID: <CAExQ=_eQHLmN5F3NH1Cm6ce4yzS0y6GQQb6_pfVVGk+VQWrPMg@mail.gmail.com>

What is the size of the file?

Perhaps you can write a custom SecRule to bypass specific file extensions
from inspection.


On Tue, May 20, 2014 at 12:10 PM, Ilyass Kaouam <ilyassikai at gmail.com>wrote:

> Hello
> I've a problems when i'd like upload a jpg file.
> how i can allow upload some type of file like : jpg, pdf ...
> thank you
>
> --
> *Ilyass kaouam*
> *Systems administrator*
> * at Inforisk Group Finaccess  *
> *European Masters in Information Technology*
> *Portable : (212) *
> *6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>


-- 
Joshua Roback
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140520/f18aa695/attachment.html>

From ilyassikai at gmail.com  Wed May 21 08:16:15 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Wed, 21 May 2014 09:16:15 +0100
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
In-Reply-To: <CAExQ=_eQHLmN5F3NH1Cm6ce4yzS0y6GQQb6_pfVVGk+VQWrPMg@mail.gmail.com>
References: <CAMmziWeqJSNw0vp=ZeQHC5qdAMOT3OxP6vfRbP-jgQ06UFtPZA@mail.gmail.com>
	<CAExQ=_eQHLmN5F3NH1Cm6ce4yzS0y6GQQb6_pfVVGk+VQWrPMg@mail.gmail.com>
Message-ID: <CAMmziWec2bLbv3-kHDZrkWcUZ18gG+E1O2y9Km04QQY3KR3w+A@mail.gmail.com>

Hello
Thank you for your help
It's 160 ko
On May 20, 2014 6:17 PM, "Joshua Roback" <jroback at gmail.com> wrote:

> What is the size of the file?
>
> Perhaps you can write a custom SecRule to bypass specific file extensions
> from inspection.
>
>
> On Tue, May 20, 2014 at 12:10 PM, Ilyass Kaouam <ilyassikai at gmail.com>wrote:
>
>> Hello
>> I've a problems when i'd like upload a jpg file.
>> how i can allow upload some type of file like : jpg, pdf ...
>> thank you
>>
>> --
>> *Ilyass kaouam*
>> *Systems administrator*
>> * at Inforisk Group Finaccess  *
>> *European Masters in Information Technology*
>> *Portable : (212) *
>> *6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
>>
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>
>>
>
>
> --
> Joshua Roback
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140521/17cdde59/attachment.html>

From ilyassikai at gmail.com  Wed May 21 09:41:12 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Wed, 21 May 2014 10:41:12 +0100
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
Message-ID: <CAMmziWfdkq_sYvi9CcGw_8rrpXrAhTx5VT4DQnrf2K+9P8LHPQ@mail.gmail.com>

Hello
I've a problems when i'd like upload a jpg file.
how i can allow upload some type of file like : jpg, pdf ...

this is the output of modsec_audit.log

--a7f42c69-A--

[21/May/2014:11:35:27 +0200] U3xzXX8AAAEAACYTAbUAAAAG xx.xx.xx.xx 60416
xx.xx.xx.xx 80

--a7f42c69-B--

POST /upload-useravatar?qqfile=xxxx.jpg HTTP/1.1

Host: www.xxxxxx.com

Connection: keep-alive

Content-Length: 159959

Origin: http://www.xxxxxx.com

X-Requested-With: XMLHttpRequest

X-File-Name: xxxx.jpg

User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2)
AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/537.36

Content-Type: application/octet-stream

Accept: */*

Referer: http://www.xxxxxx.com/user

Accept-Encoding: gzip,deflate,sdch

Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4,ar;q=0.2

Cookie: JSESSIONID=5B361D7404F645627AFB171BBA0B3F8B;
__utma=111125463.1873502041.1396101474.1400599956.1400664807.23;
__utmb=111125463.4.10.1400664807; __utmc=111125463;
__utmz=111125463.1396101474.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)


--a7f42c69-F--

HTTP/1.1 403 Forbidden

Content-Length: 219

Connection: close

Content-Type: text/html; charset=iso-8859-1


--a7f42c69-E--


--a7f42c69-H--

Message: Access denied with code 403 (phase 1). Match of "rx
^%{tx.allowed_request_content_type}$" against "TX:0" required. [file
"/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_30_http_policy.conf"]
[line "64"] [id "960010"] [rev "2"] [msg "Request content type is not
allowed by policy"] [data "application/octet-stream"] [severity "CRITICAL"]
[ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "9"] [tag
"OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED"] [tag "WASCTC/WASC-20"] [tag
"OWASP_TOP_10/A1"] [tag "OWASP_AppSensor/EE2"] [tag "PCI/12.1"]

Action: Intercepted (phase 1)

Stopwatch: 1400664925455373 1654382 (- - -)

Stopwatch2: 1400664925455373 1654382; combined=371, p1=195, p2=0, p3=0,
p4=0, p5=105, sr=47, sw=1, l=0, gc=70

Response-Body-Transformed: Dechunked

Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
OWASP_CRS/2.2.9. <http://2.2.0.9/>

Server: Apache

Engine-Mode: "ENABLED"


--a7f42c69-Z-
thank you
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140521/6d920d63/attachment.html>

From athiasjerome at gmail.com  Wed May 21 11:08:31 2014
From: athiasjerome at gmail.com (Jerome Athias)
Date: Wed, 21 May 2014 15:08:31 +0400
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
In-Reply-To: <CAMmziWfdkq_sYvi9CcGw_8rrpXrAhTx5VT4DQnrf2K+9P8LHPQ@mail.gmail.com>
References: <CAMmziWfdkq_sYvi9CcGw_8rrpXrAhTx5VT4DQnrf2K+9P8LHPQ@mail.gmail.com>
Message-ID: <CAA=AuEcrGAz7xnEq8pWaVOsesRPjvdOSpFXRDCjLWy4Q8rCXrg@mail.gmail.com>

You are not setting the proper Content-Type in your XMLHttpRequest,
you should use

setRequestHeader('Content-Type', 'image/jpeg');
in this case

and define a proper whitelist

famti?

2014-05-21 13:41 GMT+04:00 Ilyass Kaouam <ilyassikai at gmail.com>:
>
> Hello
> I've a problems when i'd like upload a jpg file.
> how i can allow upload some type of file like : jpg, pdf ...
>
> this is the output of modsec_audit.log
>
> --a7f42c69-A--
>
> [21/May/2014:11:35:27 +0200] U3xzXX8AAAEAACYTAbUAAAAG xx.xx.xx.xx 60416
> xx.xx.xx.xx 80
>
> --a7f42c69-B--
>
> POST /upload-useravatar?qqfile=xxxx.jpg HTTP/1.1
>
> Host: www.xxxxxx.com
>
> Connection: keep-alive
>
> Content-Length: 159959
>
> Origin: http://www.xxxxxx.com
>
> X-Requested-With: XMLHttpRequest
>
> X-File-Name: xxxx.jpg
>
> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2)
> AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/537.36
>
> Content-Type: application/octet-stream
>
> Accept: */*
>
> Referer: http://www.xxxxxx.com/user
>
> Accept-Encoding: gzip,deflate,sdch
>
> Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4,ar;q=0.2
>
> Cookie: JSESSIONID=5B361D7404F645627AFB171BBA0B3F8B;
> __utma=111125463.1873502041.1396101474.1400599956.1400664807.23;
> __utmb=111125463.4.10.1400664807; __utmc=111125463;
> __utmz=111125463.1396101474.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>
>
> --a7f42c69-F--
>
> HTTP/1.1 403 Forbidden
>
> Content-Length: 219
>
> Connection: close
>
> Content-Type: text/html; charset=iso-8859-1
>
>
> --a7f42c69-E--
>
>
> --a7f42c69-H--
>
> Message: Access denied with code 403 (phase 1). Match of "rx
> ^%{tx.allowed_request_content_type}$" against "TX:0" required. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_30_http_policy.conf"]
> [line "64"] [id "960010"] [rev "2"] [msg "Request content type is not
> allowed by policy"] [data "application/octet-stream"] [severity "CRITICAL"]
> [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "9"] [tag
> "OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED"] [tag "WASCTC/WASC-20"] [tag
> "OWASP_TOP_10/A1"] [tag "OWASP_AppSensor/EE2"] [tag "PCI/12.1"]
>
> Action: Intercepted (phase 1)
>
> Stopwatch: 1400664925455373 1654382 (- - -)
>
> Stopwatch2: 1400664925455373 1654382; combined=371, p1=195, p2=0, p3=0,
> p4=0, p5=105, sr=47, sw=1, l=0, gc=70
>
> Response-Body-Transformed: Dechunked
>
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> OWASP_CRS/2.2.9.
>
> Server: Apache
>
> Engine-Mode: "ENABLED"
>
>
> --a7f42c69-Z-
>
> thank you
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>

From ilyassikai at gmail.com  Wed May 21 11:26:52 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Wed, 21 May 2014 12:26:52 +0100
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
In-Reply-To: <CAA=AuEcrGAz7xnEq8pWaVOsesRPjvdOSpFXRDCjLWy4Q8rCXrg@mail.gmail.com>
References: <CAMmziWfdkq_sYvi9CcGw_8rrpXrAhTx5VT4DQnrf2K+9P8LHPQ@mail.gmail.com>
	<CAA=AuEcrGAz7xnEq8pWaVOsesRPjvdOSpFXRDCjLWy4Q8rCXrg@mail.gmail.com>
Message-ID: <CAMmziWeUgZG-5gbC5P+jwALocG5qz7aLyE6B5ZeeZTKk64=k1A@mail.gmail.com>

Thank you for you help.
I'm understand "fhamt"  :)

But i don't know hwo define a proper whitelist ? :(

please help me.


2014-05-21 12:08 GMT+01:00 Jerome Athias <athiasjerome at gmail.com>:

> You are not setting the proper Content-Type in your XMLHttpRequest,
> you should use
>
> setRequestHeader('Content-Type', 'image/jpeg');
> in this case
>
> and define a proper whitelist
>
> famti?
>
> 2014-05-21 13:41 GMT+04:00 Ilyass Kaouam <ilyassikai at gmail.com>:
> >
> > Hello
> > I've a problems when i'd like upload a jpg file.
> > how i can allow upload some type of file like : jpg, pdf ...
> >
> > this is the output of modsec_audit.log
> >
> > --a7f42c69-A--
> >
> > [21/May/2014:11:35:27 +0200] U3xzXX8AAAEAACYTAbUAAAAG xx.xx.xx.xx 60416
> > xx.xx.xx.xx 80
> >
> > --a7f42c69-B--
> >
> > POST /upload-useravatar?qqfile=xxxx.jpg HTTP/1.1
> >
> > Host: www.xxxxxx.com
> >
> > Connection: keep-alive
> >
> > Content-Length: 159959
> >
> > Origin: http://www.xxxxxx.com
> >
> > X-Requested-With: XMLHttpRequest
> >
> > X-File-Name: xxxx.jpg
> >
> > User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2)
> > AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/537.36
> >
> > Content-Type: application/octet-stream
> >
> > Accept: */*
> >
> > Referer: http://www.xxxxxx.com/user
> >
> > Accept-Encoding: gzip,deflate,sdch
> >
> > Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4,ar;q=0.2
> >
> > Cookie: JSESSIONID=5B361D7404F645627AFB171BBA0B3F8B;
> > __utma=111125463.1873502041.1396101474.1400599956.1400664807.23;
> > __utmb=111125463.4.10.1400664807; __utmc=111125463;
> >
> __utmz=111125463.1396101474.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
> >
> >
> > --a7f42c69-F--
> >
> > HTTP/1.1 403 Forbidden
> >
> > Content-Length: 219
> >
> > Connection: close
> >
> > Content-Type: text/html; charset=iso-8859-1
> >
> >
> > --a7f42c69-E--
> >
> >
> > --a7f42c69-H--
> >
> > Message: Access denied with code 403 (phase 1). Match of "rx
> > ^%{tx.allowed_request_content_type}$" against "TX:0" required. [file
> >
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_30_http_policy.conf"]
> > [line "64"] [id "960010"] [rev "2"] [msg "Request content type is not
> > allowed by policy"] [data "application/octet-stream"] [severity
> "CRITICAL"]
> > [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "9"] [tag
> > "OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED"] [tag "WASCTC/WASC-20"] [tag
> > "OWASP_TOP_10/A1"] [tag "OWASP_AppSensor/EE2"] [tag "PCI/12.1"]
> >
> > Action: Intercepted (phase 1)
> >
> > Stopwatch: 1400664925455373 1654382 (- - -)
> >
> > Stopwatch2: 1400664925455373 1654382; combined=371, p1=195, p2=0, p3=0,
> > p4=0, p5=105, sr=47, sw=1, l=0, gc=70
> >
> > Response-Body-Transformed: Dechunked
> >
> > Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> > OWASP_CRS/2.2.9.
> >
> > Server: Apache
> >
> > Engine-Mode: "ENABLED"
> >
> >
> > --a7f42c69-Z-
> >
> > thank you
> >
> > _______________________________________________
> > Owasp-modsecurity-core-rule-set mailing list
> > Owasp-modsecurity-core-rule-set at lists.owasp.org
> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140521/002878ba/attachment.html>

From RBarnett at trustwave.com  Wed May 21 11:52:50 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 21 May 2014 11:52:50 +0000
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
In-Reply-To: <CAMmziWeUgZG-5gbC5P+jwALocG5qz7aLyE6B5ZeeZTKk64=k1A@mail.gmail.com>
References: <CAMmziWfdkq_sYvi9CcGw_8rrpXrAhTx5VT4DQnrf2K+9P8LHPQ@mail.gmail.com>
	<CAA=AuEcrGAz7xnEq8pWaVOsesRPjvdOSpFXRDCjLWy4Q8rCXrg@mail.gmail.com>
	<CAMmziWeUgZG-5gbC5P+jwALocG5qz7aLyE6B5ZeeZTKk64=k1A@mail.gmail.com>
Message-ID: <CFA20BAC.F4E52%rbarnett@trustwave.com>

Edit this line in the OWASP CRS 10 setup conf file -

https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/modsecurity_crs_10_setup.conf.example#L279

Add in the allowed content type you need.

Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

From: Ilyass Kaouam <ilyassikai at gmail.com<mailto:ilyassikai at gmail.com>>
Reply-To: "ilyassikai at gmail.com<mailto:ilyassikai at gmail.com>" <ilyassikai at gmail.com<mailto:ilyassikai at gmail.com>>
Date: Wednesday, May 21, 2014 7:26 AM
To: Jerome Athias <athiasjerome at gmail.com<mailto:athiasjerome at gmail.com>>
Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: Re: [Owasp-modsecurity-core-rule-set] problems with upload jpg

Thank you for you help.
I'm understand "fhamt"  :)

But i don't know hwo define a proper whitelist ? :(

please help me.


2014-05-21 12:08 GMT+01:00 Jerome Athias <athiasjerome at gmail.com<mailto:athiasjerome at gmail.com>>:
You are not setting the proper Content-Type in your XMLHttpRequest,
you should use

setRequestHeader('Content-Type', 'image/jpeg');
in this case

and define a proper whitelist

famti?

2014-05-21 13:41 GMT+04:00 Ilyass Kaouam <ilyassikai at gmail.com<mailto:ilyassikai at gmail.com>>:
>
> Hello
> I've a problems when i'd like upload a jpg file.
> how i can allow upload some type of file like : jpg, pdf ...
>
> this is the output of modsec_audit.log
>
> --a7f42c69-A--
>
> [21/May/2014:11:35:27 +0200] U3xzXX8AAAEAACYTAbUAAAAG xx.xx.xx.xx 60416
> xx.xx.xx.xx 80
>
> --a7f42c69-B--
>
> POST /upload-useravatar?qqfile=xxxx.jpg HTTP/1.1
>
> Host: www.xxxxxx.com<http://www.xxxxxx.com>
>
> Connection: keep-alive
>
> Content-Length: 159959
>
> Origin: http://www.xxxxxx.com
>
> X-Requested-With: XMLHttpRequest
>
> X-File-Name: xxxx.jpg
>
> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2)
> AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/537.36
>
> Content-Type: application/octet-stream
>
> Accept: */*
>
> Referer: http://www.xxxxxx.com/user
>
> Accept-Encoding: gzip,deflate,sdch
>
> Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4,ar;q=0.2
>
> Cookie: JSESSIONID=5B361D7404F645627AFB171BBA0B3F8B;
> __utma=111125463.1873502041.1396101474.1400599956.1400664807.23;
> __utmb=111125463.4.10.1400664807; __utmc=111125463;
> __utmz=111125463.1396101474.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>
>
> --a7f42c69-F--
>
> HTTP/1.1 403 Forbidden
>
> Content-Length: 219
>
> Connection: close
>
> Content-Type: text/html; charset=iso-8859-1
>
>
> --a7f42c69-E--
>
>
> --a7f42c69-H--
>
> Message: Access denied with code 403 (phase 1). Match of "rx
> ^%{tx.allowed_request_content_type}$" against "TX:0" required. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_30_http_policy.conf"]
> [line "64"] [id "960010"] [rev "2"] [msg "Request content type is not
> allowed by policy"] [data "application/octet-stream"] [severity "CRITICAL"]
> [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "9"] [tag
> "OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED"] [tag "WASCTC/WASC-20"] [tag
> "OWASP_TOP_10/A1"] [tag "OWASP_AppSensor/EE2"] [tag "PCI/12.1"]
>
> Action: Intercepted (phase 1)
>
> Stopwatch: 1400664925455373 1654382 (- - -)
>
> Stopwatch2: 1400664925455373 1654382; combined=371, p1=195, p2=0, p3=0,
> p4=0, p5=105, sr=47, sw=1, l=0, gc=70
>
> Response-Body-Transformed: Dechunked
>
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> OWASP_CRS/2.2.9.<http://2.2.9.>
>
> Server: Apache
>
> Engine-Mode: "ENABLED"
>
>
> --a7f42c69-Z-
>
> thank you
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140521/65303f36/attachment.html>

From athiasjerome at gmail.com  Wed May 21 11:53:14 2014
From: athiasjerome at gmail.com (Jerome Athias)
Date: Wed, 21 May 2014 15:53:14 +0400
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
In-Reply-To: <CAMmziWeUgZG-5gbC5P+jwALocG5qz7aLyE6B5ZeeZTKk64=k1A@mail.gmail.com>
References: <CAMmziWfdkq_sYvi9CcGw_8rrpXrAhTx5VT4DQnrf2K+9P8LHPQ@mail.gmail.com>
	<CAA=AuEcrGAz7xnEq8pWaVOsesRPjvdOSpFXRDCjLWy4Q8rCXrg@mail.gmail.com>
	<CAMmziWeUgZG-5gbC5P+jwALocG5qz7aLyE6B5ZeeZTKk64=k1A@mail.gmail.com>
Message-ID: <CAA=AuEffiNr3ne53W-m4u29-r0aUauGZx1CPR7N=OPBCPwpwLw@mail.gmail.com>

not the best way, but look at the end
http://www.modsecurity.org/documentation/quick-examples.html

Please read the documentation, and google is your friend

2014-05-21 15:26 GMT+04:00 Ilyass Kaouam <ilyassikai at gmail.com>:
> Thank you for you help.
> I'm understand "fhamt"  :)
>
> But i don't know hwo define a proper whitelist ? :(
>
> please help me.
>
>
> 2014-05-21 12:08 GMT+01:00 Jerome Athias <athiasjerome at gmail.com>:
>
>> You are not setting the proper Content-Type in your XMLHttpRequest,
>> you should use
>>
>> setRequestHeader('Content-Type', 'image/jpeg');
>> in this case
>>
>> and define a proper whitelist
>>
>> famti?
>>
>> 2014-05-21 13:41 GMT+04:00 Ilyass Kaouam <ilyassikai at gmail.com>:
>> >
>> > Hello
>> > I've a problems when i'd like upload a jpg file.
>> > how i can allow upload some type of file like : jpg, pdf ...
>> >
>> > this is the output of modsec_audit.log
>> >
>> > --a7f42c69-A--
>> >
>> > [21/May/2014:11:35:27 +0200] U3xzXX8AAAEAACYTAbUAAAAG xx.xx.xx.xx 60416
>> > xx.xx.xx.xx 80
>> >
>> > --a7f42c69-B--
>> >
>> > POST /upload-useravatar?qqfile=xxxx.jpg HTTP/1.1
>> >
>> > Host: www.xxxxxx.com
>> >
>> > Connection: keep-alive
>> >
>> > Content-Length: 159959
>> >
>> > Origin: http://www.xxxxxx.com
>> >
>> > X-Requested-With: XMLHttpRequest
>> >
>> > X-File-Name: xxxx.jpg
>> >
>> > User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2)
>> > AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137
>> > Safari/537.36
>> >
>> > Content-Type: application/octet-stream
>> >
>> > Accept: */*
>> >
>> > Referer: http://www.xxxxxx.com/user
>> >
>> > Accept-Encoding: gzip,deflate,sdch
>> >
>> > Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4,ar;q=0.2
>> >
>> > Cookie: JSESSIONID=5B361D7404F645627AFB171BBA0B3F8B;
>> > __utma=111125463.1873502041.1396101474.1400599956.1400664807.23;
>> > __utmb=111125463.4.10.1400664807; __utmc=111125463;
>> >
>> > __utmz=111125463.1396101474.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>> >
>> >
>> > --a7f42c69-F--
>> >
>> > HTTP/1.1 403 Forbidden
>> >
>> > Content-Length: 219
>> >
>> > Connection: close
>> >
>> > Content-Type: text/html; charset=iso-8859-1
>> >
>> >
>> > --a7f42c69-E--
>> >
>> >
>> > --a7f42c69-H--
>> >
>> > Message: Access denied with code 403 (phase 1). Match of "rx
>> > ^%{tx.allowed_request_content_type}$" against "TX:0" required. [file
>> >
>> > "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_30_http_policy.conf"]
>> > [line "64"] [id "960010"] [rev "2"] [msg "Request content type is not
>> > allowed by policy"] [data "application/octet-stream"] [severity
>> > "CRITICAL"]
>> > [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "9"] [tag
>> > "OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED"] [tag "WASCTC/WASC-20"] [tag
>> > "OWASP_TOP_10/A1"] [tag "OWASP_AppSensor/EE2"] [tag "PCI/12.1"]
>> >
>> > Action: Intercepted (phase 1)
>> >
>> > Stopwatch: 1400664925455373 1654382 (- - -)
>> >
>> > Stopwatch2: 1400664925455373 1654382; combined=371, p1=195, p2=0, p3=0,
>> > p4=0, p5=105, sr=47, sw=1, l=0, gc=70
>> >
>> > Response-Body-Transformed: Dechunked
>> >
>> > Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>> > OWASP_CRS/2.2.9.
>> >
>> > Server: Apache
>> >
>> > Engine-Mode: "ENABLED"
>> >
>> >
>> > --a7f42c69-Z-
>> >
>> > thank you
>> >
>> > _______________________________________________
>> > Owasp-modsecurity-core-rule-set mailing list
>> > Owasp-modsecurity-core-rule-set at lists.owasp.org
>> > https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> >
>
>

From ilyassikai at gmail.com  Wed May 21 13:19:21 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Wed, 21 May 2014 14:19:21 +0100
Subject: [Owasp-modsecurity-core-rule-set] problems with upload jpg
In-Reply-To: <CFA20BAC.F4E52%rbarnett@trustwave.com>
References: <CAMmziWfdkq_sYvi9CcGw_8rrpXrAhTx5VT4DQnrf2K+9P8LHPQ@mail.gmail.com>
	<CAA=AuEcrGAz7xnEq8pWaVOsesRPjvdOSpFXRDCjLWy4Q8rCXrg@mail.gmail.com>
	<CAMmziWeUgZG-5gbC5P+jwALocG5qz7aLyE6B5ZeeZTKk64=k1A@mail.gmail.com>
	<CFA20BAC.F4E52%rbarnett@trustwave.com>
Message-ID: <CAMmziWcDesYHRpdNUms-u__HQfd13Rh=2YLcaB04gxAbXXFmiA@mail.gmail.com>

THANK YOU *:) :) :) *

It's work perfectly

i'm very happy :)

thank you for your help.


2014-05-21 12:52 GMT+01:00 Ryan Barnett <RBarnett at trustwave.com>:

>   Edit this line in the OWASP CRS 10 setup conf file -
>
>
> https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/modsecurity_crs_10_setup.conf.example#L279
>
>  Add in the allowed content type you need.
>
>  *Ryan Barnett*
>
> Lead Security Researcher, SpiderLabs
>
>
>
> *Trustwave* | SMART SECURITY ON DEMAND
>
> www.trustwave.com
>
>
>   From: Ilyass Kaouam <ilyassikai at gmail.com>
> Reply-To: "ilyassikai at gmail.com" <ilyassikai at gmail.com>
> Date: Wednesday, May 21, 2014 7:26 AM
> To: Jerome Athias <athiasjerome at gmail.com>
> Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org" <
> owasp-modsecurity-core-rule-set at lists.owasp.org>
> Subject: Re: [Owasp-modsecurity-core-rule-set] problems with upload jpg
>
>    Thank you for you help.
>  I'm understand "fhamt"  :)
>
>  But i don't know hwo define a proper whitelist ? :(
>
>  please help me.
>
>
> 2014-05-21 12:08 GMT+01:00 Jerome Athias <athiasjerome at gmail.com>:
>
>> You are not setting the proper Content-Type in your XMLHttpRequest,
>> you should use
>>
>> setRequestHeader('Content-Type', 'image/jpeg');
>> in this case
>>
>> and define a proper whitelist
>>
>> famti?
>>
>> 2014-05-21 13:41 GMT+04:00 Ilyass Kaouam <ilyassikai at gmail.com>:
>>  >
>> > Hello
>> > I've a problems when i'd like upload a jpg file.
>> > how i can allow upload some type of file like : jpg, pdf ...
>> >
>> > this is the output of modsec_audit.log
>> >
>> > --a7f42c69-A--
>> >
>> > [21/May/2014:11:35:27 +0200] U3xzXX8AAAEAACYTAbUAAAAG xx.xx.xx.xx 60416
>> > xx.xx.xx.xx 80
>> >
>> > --a7f42c69-B--
>> >
>> > POST /upload-useravatar?qqfile=xxxx.jpg HTTP/1.1
>> >
>> > Host: www.xxxxxx.com
>> >
>> > Connection: keep-alive
>> >
>> > Content-Length: 159959
>> >
>> > Origin: http://www.xxxxxx.com
>> >
>> > X-Requested-With: XMLHttpRequest
>> >
>> > X-File-Name: xxxx.jpg
>> >
>> > User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2)
>> > AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137
>> Safari/537.36
>> >
>> > Content-Type: application/octet-stream
>> >
>> > Accept: */*
>> >
>> > Referer: http://www.xxxxxx.com/user
>> >
>> > Accept-Encoding: gzip,deflate,sdch
>> >
>> > Accept-Language: fr-FR,fr;q=0.8,en-US;q=0.6,en;q=0.4,ar;q=0.2
>> >
>> > Cookie: JSESSIONID=5B361D7404F645627AFB171BBA0B3F8B;
>> > __utma=111125463.1873502041.1396101474.1400599956.1400664807.23;
>> > __utmb=111125463.4.10.1400664807; __utmc=111125463;
>> >
>> __utmz=111125463.1396101474.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)
>> >
>> >
>> > --a7f42c69-F--
>> >
>> > HTTP/1.1 403 Forbidden
>> >
>> > Content-Length: 219
>> >
>> > Connection: close
>> >
>> > Content-Type: text/html; charset=iso-8859-1
>> >
>> >
>> > --a7f42c69-E--
>> >
>> >
>> > --a7f42c69-H--
>> >
>> > Message: Access denied with code 403 (phase 1). Match of "rx
>> > ^%{tx.allowed_request_content_type}$" against "TX:0" required. [file
>> >
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_30_http_policy.conf"]
>> > [line "64"] [id "960010"] [rev "2"] [msg "Request content type is not
>> > allowed by policy"] [data "application/octet-stream"] [severity
>> "CRITICAL"]
>> > [ver "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "9"] [tag
>> > "OWASP_CRS/POLICY/ENCODING_NOT_ALLOWED"] [tag "WASCTC/WASC-20"] [tag
>> > "OWASP_TOP_10/A1"] [tag "OWASP_AppSensor/EE2"] [tag "PCI/12.1"]
>> >
>> > Action: Intercepted (phase 1)
>> >
>> > Stopwatch: 1400664925455373 1654382 (- - -)
>> >
>> > Stopwatch2: 1400664925455373 1654382; combined=371, p1=195, p2=0, p3=0,
>> > p4=0, p5=105, sr=47, sw=1, l=0, gc=70
>> >
>> > Response-Body-Transformed: Dechunked
>> >
>> > Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>> > OWASP_CRS/2.2.9.
>> >
>> > Server: Apache
>> >
>> > Engine-Mode: "ENABLED"
>> >
>> >
>> > --a7f42c69-Z-
>> >
>> > thank you
>> >
>>   > _______________________________________________
>> > Owasp-modsecurity-core-rule-set mailing list
>> > Owasp-modsecurity-core-rule-set at lists.owasp.org
>> >
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> >
>>
>
>
> ------------------------------
>
> This transmission may contain information that is privileged,
> confidential, and/or exempt from disclosure under applicable law. If you
> are not the intended recipient, you are hereby notified that any
> disclosure, copying, distribution, or use of the information contained
> herein (including any reliance thereon) is strictly prohibited. If you
> received this transmission in error, please immediately contact the sender
> and destroy the material in its entirety, whether in electronic or hard
> copy format.
>



-- 
*Ilyass kaouam*
*Systems administrator*
* at Inforisk Group Finaccess  *
*European Masters in Information Technology*
*Portable : (212) *
*6 34 57 14 36**http://www.inforisk.ma <http://www.inforisk.ma>*
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140521/f36d23ea/attachment.html>

From email at wiktornykiel.com  Wed May 21 22:56:15 2014
From: email at wiktornykiel.com (Wiktor Nykiel)
Date: Thu, 22 May 2014 00:56:15 +0200
Subject: [Owasp-modsecurity-core-rule-set] Problems setting up mod-security
	on centos 6
Message-ID: <3E2E8D7A-87BF-42FB-B2C0-1E760A2E05F5@wiktornykiel.com>

I have tried to set up mod security on centos 6 in amazon web services but the log didn't recive or store any data, also I tried to put mod evasive to integrate the output logs with a SIEM but there is something that I made wrong with mod security, I tried to change the level of the mod from inform to block but I can't stop any kind of atack like sql injection and neither log any request.

Where can I get a more complete documentation? I saw that depending of the os, the version, the apache version, ..., there are a lot of differents posibilities. And.. really, more time I spent with this configuration and more doubts I have

I also tried to add the OWASP CRS rules, I added it with symbolic links to the folder active_rules and neither works

Can anyone help me please? Which are the steps that I must to do and where can I found something good like dokumentation, manuals, step by step config or similar information that could help me in this project

Thanks in advance

Regards

Wiktor Nykiel

http://www.wiktornykiel.com
email at wiktornykiel.com


From RBarnett at trustwave.com  Thu May 22 14:24:26 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Thu, 22 May 2014 14:24:26 +0000
Subject: [Owasp-modsecurity-core-rule-set] Problems setting up
 mod-security on centos 6
In-Reply-To: <3E2E8D7A-87BF-42FB-B2C0-1E760A2E05F5@wiktornykiel.com>
References: <3E2E8D7A-87BF-42FB-B2C0-1E760A2E05F5@wiktornykiel.com>
Message-ID: <CFA3808C.F5659%rbarnett@trustwave.com>

Did you try to install from source or use the RPM source package?

Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com <http://www.trustwave.com/>




On 5/21/14 6:56 PM, "Wiktor Nykiel" <email at wiktornykiel.com> wrote:

>I have tried to set up mod security on centos 6 in amazon web services
>but the log didn't recive or store any data, also I tried to put mod
>evasive to integrate the output logs with a SIEM but there is something
>that I made wrong with mod security, I tried to change the level of the
>mod from inform to block but I can't stop any kind of atack like sql
>injection and neither log any request.
>
>Where can I get a more complete documentation? I saw that depending of
>the os, the version, the apache version, ..., there are a lot of
>differents posibilities. And.. really, more time I spent with this
>configuration and more doubts I have
>
>I also tried to add the OWASP CRS rules, I added it with symbolic links
>to the folder active_rules and neither works
>
>Can anyone help me please? Which are the steps that I must to do and
>where can I found something good like dokumentation, manuals, step by
>step config or similar information that could help me in this project
>
>Thanks in advance
>
>Regards
>
>Wiktor Nykiel
>
>http://www.wiktornykiel.com
>email at wiktornykiel.com
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From ilyassikai at gmail.com  Fri May 23 16:01:21 2014
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Fri, 23 May 2014 17:01:21 +0100
Subject: [Owasp-modsecurity-core-rule-set] log of mod-sec
Message-ID: <CAMmziWc20XjBJUzn23yM7WDaz2ancXPW8VSzHmEVPFMCF=Q_qA@mail.gmail.com>

hello,
I found this message in my logwatch

Attempts to use known hacks by 1 hosts were logged 3 time(s) from:
    127.0.0.1: 3 Time(s)


 A total of 1 sites probed the server
    127.0.0.1


?I hope know what does that mean.
Thank you for you help.

for information i use 3 server  (Centos 6):
1: It named WAF    ==> it contains : apache only (mod_proxy,firewall,
mod_security...)  ?
?2: www.site1.ma ==> web server (tomcat 7) : java application
3: www.site2.ma ==> web server (tomcat 7) : java application

                        --------------
                      -   server         -
                      -    apache     -
                      ----------------
                                 -
                                 - (mod_proxy)
?                     -----------------------------?
?                     -   ?                                          -
?                     -?                                             -
                     -                                            -
            --------------                        --------------
            -   server     -                         -   server     -
            -    tomcat1  -                         -    tomcat2  -
            ----------------                     ----------------





Thank you for your help.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140523/9919b49f/attachment.html>

From jzy2000 at hotmail.com  Wed May 28 19:18:29 2014
From: jzy2000 at hotmail.com (Rolling Stone)
Date: Wed, 28 May 2014 15:18:29 -0400
Subject: [Owasp-modsecurity-core-rule-set] @detectXSS
Message-ID: <BAY169-DS45E467A506765239C1F721A4250@phx.gbl>

Hello guys.

 

Do any of you have used this newly added @detectXSS for XSS detection, how's
the accuracy?

What's the relation of this gesture and XSS rules in Core Rule Set?

 

Thanks,

R.S.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140528/f5490b71/attachment.html>

From RBarnett at trustwave.com  Wed May 28 20:36:55 2014
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 28 May 2014 20:36:55 +0000
Subject: [Owasp-modsecurity-core-rule-set] @detectXSS
In-Reply-To: <BAY169-DS45E467A506765239C1F721A4250@phx.gbl>
References: <BAY169-DS45E467A506765239C1F721A4250@phx.gbl>
Message-ID: <CFABC049.F5D0A%rbarnett@trustwave.com>

We added the @detectXSS operator in ModSecurity v2.8.0-rc1 - https://github.com/SpiderLabs/ModSecurity/releases/tag/v2.8.0-rc1

We added a new rule that uses it to the OWASP CRS v3.0.0-dev - https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/rules/REQUEST-41-APPLICATION-ATTACK-XSS.conf#L25-55

You can test it out in our online Demo/Smoketest here -
http://www.modsecurity.org/demo/demo-deny.html?test=%3Cscript%3Ealert%28document.cookie%29%3C%2Fscript%3E

973343  XSS Attack Detected via Libinjection
        Matched script>alert at ARGS:test

If anyone finds any false positives or evasion issues ? please open a GitHub Issue - https://github.com/SpiderLabs/owasp-modsecurity-crs/issues

Thanks.

Ryan Barnett
Senior Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com<http://www.trustwave.com/>

From: Rolling Stone <jzy2000 at hotmail.com<mailto:jzy2000 at hotmail.com>>
Date: Wednesday, May 28, 2014 3:18 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] @detectXSS

Hello guys.

Do any of you have used this newly added @detectXSS for XSS detection, how?s the accuracy?
What?s the relation of this gesture and XSS rules in Core Rule Set?

Thanks,
R.S.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140528/705d37d7/attachment.html>

From jzy2000 at hotmail.com  Wed May 28 21:49:15 2014
From: jzy2000 at hotmail.com (Rolling Stone)
Date: Wed, 28 May 2014 17:49:15 -0400
Subject: [Owasp-modsecurity-core-rule-set] @detectXSS
In-Reply-To: <CFABC049.F5D0A%rbarnett@trustwave.com>
References: <BAY169-DS45E467A506765239C1F721A4250@phx.gbl>
	<CFABC049.F5D0A%rbarnett@trustwave.com>
Message-ID: <BAY169-DS3831E33D0630BD920A3427A4250@phx.gbl>

Thanks Ryan, that explains all.

 

From: Ryan Barnett [mailto:RBarnett at trustwave.com] 
Sent: May-28-14 4:37 PM
To: Rolling Stone; owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: [Owasp-modsecurity-core-rule-set] @detectXSS

 

We added the @detectXSS operator in ModSecurity v2.8.0-rc1 -
https://github.com/SpiderLabs/ModSecurity/releases/tag/v2.8.0-rc1

 

We added a new rule that uses it to the OWASP CRS v3.0.0-dev -
https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/rules/RE
QUEST-41-APPLICATION-ATTACK-XSS.conf#L25-55

 

You can test it out in our online Demo/Smoketest here -

http://www.modsecurity.org/demo/demo-deny.html?test=%3Cscript%3Ealert%28docu
ment.cookie%29%3C%2Fscript%3E

 


973343

XSS Attack Detected via Libinjection


 

Matched script>alert at ARGS:test

 

If anyone finds any false positives or evasion issues - please open a GitHub
Issue - https://github.com/SpiderLabs/owasp-modsecurity-crs/issues  

 

Thanks.

 

Ryan Barnett

Senior Lead Security Researcher, SpiderLabs

 

Trustwave | SMART SECURITY ON DEMAND

 <http://www.trustwave.com/> www.trustwave.com

 

From: Rolling Stone <jzy2000 at hotmail.com>
Date: Wednesday, May 28, 2014 3:18 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org"
<owasp-modsecurity-core-rule-set at lists.owasp.org>
Subject: [Owasp-modsecurity-core-rule-set] @detectXSS

 

Hello guys.

 

Do any of you have used this newly added @detectXSS for XSS detection, how's
the accuracy?

What's the relation of this gesture and XSS rules in Core Rule Set?

 

Thanks,

R.S.

 

  _____  


This transmission may contain information that is privileged, confidential,
and/or exempt from disclosure under applicable law. If you are not the
intended recipient, you are hereby notified that any disclosure, copying,
distribution, or use of the information contained herein (including any
reliance thereon) is strictly prohibited. If you received this transmission
in error, please immediately contact the sender and destroy the material in
its entirety, whether in electronic or hard copy format.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140528/6cfcb64d/attachment-0001.html>

