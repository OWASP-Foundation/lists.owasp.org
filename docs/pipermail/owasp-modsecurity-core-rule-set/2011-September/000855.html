<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Lots%20of%20false%20positives%20with%0A%20wordpress&In-Reply-To=CAKA73TDqHAU3w-riA4%2BdVDXLLrMyzJ%2BcAFQCi5Nd_cGH%3DAh4CQ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000858.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Lots%20of%20false%20positives%20with%0A%20wordpress&In-Reply-To=CAKA73TDqHAU3w-riA4%2BdVDXLLrMyzJ%2BcAFQCi5Nd_cGH%3DAh4CQ%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Sep  1 09:21:23 EDT 2011</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000858.html">[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#855">[ date ]</a>
              <a href="thread.html#855">[ thread ]</a>
              <a href="subject.html#855">[ subject ]</a>
              <a href="author.html#855">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
On 8/31/11 7:11 PM, &quot;Majed B.&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">majedb at gmail.com</A>&gt; wrote:

&gt;<i>Hello,
</I>&gt;<i>
</I>&gt;<i>I have just configured mod_security (2.6) with rule set 2.2.1. My
</I>&gt;<i>website runs wordpress 3.2.1. mod-sec is running in detection only
</I>&gt;<i>mode.
</I>
You may also be interested in the &quot;WordPress&quot; specific virtual patches in
the slr_rules directory.

<A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/slr_r">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/slr_r</A>
ules/modsecurity_crs_46_slr_et_wordpress_attacks.conf


These are rules that were created from converted Emerging Threats (ET)
rules for WordPress vulns.  The advantage of running these rules are that
they are very specific as to *where* they are looking for attacks vs. the
generic rules in the rest of the CRS which are looking everywhere.

&gt;<i>
</I>&gt;<i>As soon as I restarted apache, I saw many warnings in the error log as
</I>&gt;<i>visitors come to the site. First, visitors were denied access because
</I>&gt;<i>of a false positive on cookie session hijacking, then when I disabled
</I>&gt;<i>optional_rules altogether, I started getting warnings about SQLi
</I>&gt;<i>attacks when I tried to login to the admin panel of wordpress.
</I>&gt;<i>
</I>&gt;<i>Here's a sample of the error of the SQLi warning:
</I>&gt;<i>
</I>&gt;<i>[Thu Sep 01 01:57:35 2011] [error] [client 98.158.123.158]
</I>&gt;<i>ModSecurity: Warning. Operator GE matched 5 at
</I>&gt;<i>TX:restricted_sqli_char_count. [file
</I>&gt;<i>&quot;/etc/modsecurity/modsecurity-crs/2.2.1/base_rules/modsecurity_crs_41_sql_
</I>&gt;<i>injection_attacks.conf&quot;]
</I>&gt;<i>[line &quot;551&quot;] [id &quot;981173&quot;] [rev &quot;2.2.1&quot;] [msg &quot;Restricted SQL
</I>&gt;<i>Character Anomaly Detection Alert - Total # of special characters
</I>&gt;<i>exceeded&quot;] [data &quot;9&quot;] [hostname &quot;xyz.com&quot;] [uri &quot;/wp-admin/admin.php&quot;]
</I>&gt;<i>[unique_id &quot;Tl68X04vrrwAAEeUFbUAAAAF&quot;]
</I>&gt;<i>[Thu Sep 01 01:57:36 2011] [error] [client 98.158.123.158]
</I>&gt;<i>ModSecurity: Warning. Operator LT matched 5 at
</I>&gt;<i>TX:inbound_anomaly_score. [file
</I>&gt;<i>&quot;/etc/modsecurity/modsecurity-crs/2.2.1/base_rules/modsecurity_crs_60_corr
</I>&gt;<i>elation.conf&quot;]
</I>&gt;<i>[line &quot;33&quot;] [id &quot;981203&quot;] [msg &quot;Inbound Anomaly Score (Total Inbound
</I>&gt;<i>Score: 3, SQLi=10, XSS=): Restricted SQL Character Anomaly Detection
</I>&gt;<i>Alert - Total # of special characters exceeded&quot;] [hostname &quot;xyz.com&quot;]
</I>&gt;<i>[uri &quot;/wp-admin/admin.php&quot;] [unique_id &quot;Tl68X04vrrwAAEeUFbUAAAAF&quot;]
</I>&gt;<i>
</I>&gt;<i>(Note: I renamed the domain name to xyz.com)
</I>&gt;<i>
</I>&gt;<i>I tried increasing the @ge value from 4 to 5, and it stopped the
</I>&gt;<i>warnings from showing when only browsing the login page, but after I
</I>&gt;<i>login, the warnings keep pouring. I don't know what is a suitable
</I>&gt;<i>value to be put there.
</I>

You need to look at the audit log data for the transaction that has the
UniqueID - Tl68X04vrrwAAEeUFbUAAAAF.  You might also want to download the
latest SVN version of the sql injection file as those rules have been
updated -

<A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_</A>
rules/modsecurity_crs_41_sql_injection_attacks.conf?revision=1835

-Ryan

&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000858.html">[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#855">[ date ]</a>
              <a href="thread.html#855">[ thread ]</a>
              <a href="subject.html#855">[ subject ]</a>
              <a href="author.html#855">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
