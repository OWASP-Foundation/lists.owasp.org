<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Lots%20of%20false%20positives%20with%0A%20wordpress&In-Reply-To=CA84FA8D.31485%25rbarnett%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000855.html">
   <LINK REL="Next"  HREF="000856.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress</H1>
    <B>Jason Haar</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Lots%20of%20false%20positives%20with%0A%20wordpress&In-Reply-To=CA84FA8D.31485%25rbarnett%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress">Jason_Haar at trimble.com
       </A><BR>
    <I>Thu Sep  1 23:14:07 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000855.html">[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress
</A></li>
        <LI>Next message: <A HREF="000856.html">[Owasp-modsecurity-core-rule-set] (Updated) Mitigation of Apache	Range Header DoS Attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#858">[ date ]</a>
              <a href="thread.html#858">[ thread ]</a>
              <a href="subject.html#858">[ subject ]</a>
              <a href="author.html#858">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>FYI for the same reason I just upgraded to the 2.2.2
modsecurity_crs_41_sql_injection_attacks.conf ruleset, however it
doesn't appear to have made any difference.

e.g.

The following Cookie triggers 981248

LtpaToken2=x5Orq

(it didn't like &quot;50r&quot;?????)

Jason



On 02/09/11 01:21, Ryan Barnett wrote:
&gt;<i>
</I>&gt;<i> On 8/31/11 7:11 PM, &quot;Majed B.&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">majedb at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt;Hello,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I have just configured mod_security (2.6) with rule set 2.2.1. My
</I>&gt;<i> &gt;website runs wordpress 3.2.1. mod-sec is running in detection only
</I>&gt;<i> &gt;mode.
</I>&gt;<i>
</I>&gt;<i> You may also be interested in the &quot;WordPress&quot; specific virtual patches in
</I>&gt;<i> the slr_rules directory.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/slr_r">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/slr_r</A>
</I>&gt;<i> ules/modsecurity_crs_46_slr_et_wordpress_attacks.conf
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> These are rules that were created from converted Emerging Threats (ET)
</I>&gt;<i> rules for WordPress vulns.  The advantage of running these rules are that
</I>&gt;<i> they are very specific as to *where* they are looking for attacks vs. the
</I>&gt;<i> generic rules in the rest of the CRS which are looking everywhere.
</I>&gt;<i>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;As soon as I restarted apache, I saw many warnings in the error log as
</I>&gt;<i> &gt;visitors come to the site. First, visitors were denied access because
</I>&gt;<i> &gt;of a false positive on cookie session hijacking, then when I disabled
</I>&gt;<i> &gt;optional_rules altogether, I started getting warnings about SQLi
</I>&gt;<i> &gt;attacks when I tried to login to the admin panel of wordpress.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Here's a sample of the error of the SQLi warning:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;[Thu Sep 01 01:57:35 2011] [error] [client 98.158.123.158]
</I>&gt;<i> &gt;ModSecurity: Warning. Operator GE matched 5 at
</I>&gt;<i> &gt;TX:restricted_sqli_char_count. [file
</I>&gt;<i> &gt;&quot;/etc/modsecurity/modsecurity-crs/2.2.1/base_rules/modsecurity_crs_41_sql_
</I>&gt;<i> &gt;injection_attacks.conf&quot;]
</I>&gt;<i> &gt;[line &quot;551&quot;] [id &quot;981173&quot;] [rev &quot;2.2.1&quot;] [msg &quot;Restricted SQL
</I>&gt;<i> &gt;Character Anomaly Detection Alert - Total # of special characters
</I>&gt;<i> &gt;exceeded&quot;] [data &quot;9&quot;] [hostname &quot;xyz.com&quot;] [uri &quot;/wp-admin/admin.php&quot;]
</I>&gt;<i> &gt;[unique_id &quot;Tl68X04vrrwAAEeUFbUAAAAF&quot;]
</I>&gt;<i> &gt;[Thu Sep 01 01:57:36 2011] [error] [client 98.158.123.158]
</I>&gt;<i> &gt;ModSecurity: Warning. Operator LT matched 5 at
</I>&gt;<i> &gt;TX:inbound_anomaly_score. [file
</I>&gt;<i> &gt;&quot;/etc/modsecurity/modsecurity-crs/2.2.1/base_rules/modsecurity_crs_60_corr
</I>&gt;<i> &gt;elation.conf&quot;]
</I>&gt;<i> &gt;[line &quot;33&quot;] [id &quot;981203&quot;] [msg &quot;Inbound Anomaly Score (Total Inbound
</I>&gt;<i> &gt;Score: 3, SQLi=10, XSS=): Restricted SQL Character Anomaly Detection
</I>&gt;<i> &gt;Alert - Total # of special characters exceeded&quot;] [hostname &quot;xyz.com&quot;]
</I>&gt;<i> &gt;[uri &quot;/wp-admin/admin.php&quot;] [unique_id &quot;Tl68X04vrrwAAEeUFbUAAAAF&quot;]
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;(Note: I renamed the domain name to xyz.com)
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;I tried increasing the @ge value from 4 to 5, and it stopped the
</I>&gt;<i> &gt;warnings from showing when only browsing the login page, but after I
</I>&gt;<i> &gt;login, the warnings keep pouring. I don't know what is a suitable
</I>&gt;<i> &gt;value to be put there.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You need to look at the audit log data for the transaction that has the
</I>&gt;<i> UniqueID - Tl68X04vrrwAAEeUFbUAAAAF.  You might also want to download the
</I>&gt;<i> latest SVN version of the sql injection file as those rules have been
</I>&gt;<i> updated -
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_</A>
</I>&gt;<i> rules/modsecurity_crs_41_sql_injection_attacks.conf?revision=1835
</I>&gt;<i>
</I>&gt;<i> -Ryan
</I>&gt;<i>
</I>&gt;<i> &gt;_______________________________________________
</I>&gt;<i> &gt;Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This transmission may contain information that is privileged,
</I>&gt;<i> confidential, and/or exempt from disclosure under applicable law. If
</I>&gt;<i> you are not the intended recipient, you are hereby notified that any
</I>&gt;<i> disclosure, copying, distribution, or use of the information contained
</I>&gt;<i> herein (including any reliance thereon) is STRICTLY PROHIBITED. If you
</I>&gt;<i> received this transmission in error, please immediately contact the
</I>&gt;<i> sender and destroy the material in its entirety, whether in electronic
</I>&gt;<i> or hard copy format.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>
-- 
Cheers

Jason Haar
Information Security Manager, Trimble Navigation Ltd.
Phone: +1 408 481 8171
PGP Fingerprint: 7A2E 0407 C9A6 CAF6 2B9F 8422 C063 5EBB FE1D 66D1

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110902/fdd79906/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110902/fdd79906/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000855.html">[Owasp-modsecurity-core-rule-set] Lots of false positives with wordpress
</A></li>
	<LI>Next message: <A HREF="000856.html">[Owasp-modsecurity-core-rule-set] (Updated) Mitigation of Apache	Range Header DoS Attack
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#858">[ date ]</a>
              <a href="thread.html#858">[ thread ]</a>
              <a href="subject.html#858">[ subject ]</a>
              <a href="author.html#858">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
