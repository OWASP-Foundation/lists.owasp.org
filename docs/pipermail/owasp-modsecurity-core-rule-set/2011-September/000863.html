<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Bug in CRS 2.2.2 rule 960335?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Bug%20in%20CRS%202.2.2%20rule%20960335%3F&In-Reply-To=CACBJu2Xes%2B%2B76v0hq%2B%2Bfh9Qk026iks-fuCgVNFm72Hyp1iL4DA%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000862.html">
   <LINK REL="Next"  HREF="000864.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Bug in CRS 2.2.2 rule 960335?</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Bug%20in%20CRS%202.2.2%20rule%20960335%3F&In-Reply-To=CACBJu2Xes%2B%2B76v0hq%2B%2Bfh9Qk026iks-fuCgVNFm72Hyp1iL4DA%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Bug in CRS 2.2.2 rule 960335?">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Sep  7 15:26:14 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000862.html">[Owasp-modsecurity-core-rule-set] Bug in CRS 2.2.2 rule 960335?
</A></li>
        <LI>Next message: <A HREF="000864.html">[Owasp-modsecurity-core-rule-set] the whole	modsecurity_crs_41_sql_injection_attacks.conf needs	exceptions for google analytics and piwik cookies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#863">[ date ]</a>
              <a href="thread.html#863">[ thread ]</a>
              <a href="subject.html#863">[ subject ]</a>
              <a href="author.html#863">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
From: Ty &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ty733420 at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ty733420 at gmail.com</A>&gt;&gt;
Date: Wed, 7 Sep 2011 13:08:43 -0500
To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: [Owasp-modsecurity-core-rule-set] Bug in CRS 2.2.2 rule 960335?

Hello,

I'm running into what I think are false positives for rule 960335 in CRS 2.2.2.  I see blocked requests with &quot;Operator GT matched 512 at ARGS:xxx&quot; when there are clearly less than 512 parameters being sent.

Should the &quot;SecRule ARGS&quot; rule be replaced with &quot;SecRule &amp;ARGS&quot;, like the below?

Yes, good catch.  I had updated these rules and removed the &amp; that was there by mistake on these other rules and removed this one too&#8230;  It is now fixed in SVN -

<A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_23_request_limits.conf?revision=1837">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_23_request_limits.conf?revision=1837</A>

-Ryan



Thanks,
Ty

# Maximum number of arguments in request limited
SecRule &amp;TX:MAX_NUM_ARGS &quot;@eq 1&quot; &quot;chain,phase:2,t:none,block,msg:'Too many arguments in request',id:'960335',severity:'4',rev:'2.2.2'&quot;
    SecRule &amp;ARGS &quot;@gt %{tx.max_num_args}&quot; &quot;t:none,setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.policy_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id&lt;<A HREF="http://rule.id/">http://rule.id/</A>&gt;}-POLICY/SIZE_LIMIT-%{matched_var_name}=%{matched_var}&quot;

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000862.html">[Owasp-modsecurity-core-rule-set] Bug in CRS 2.2.2 rule 960335?
</A></li>
	<LI>Next message: <A HREF="000864.html">[Owasp-modsecurity-core-rule-set] the whole	modsecurity_crs_41_sql_injection_attacks.conf needs	exceptions for google analytics and piwik cookies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#863">[ date ]</a>
              <a href="thread.html#863">[ thread ]</a>
              <a href="subject.html#863">[ subject ]</a>
              <a href="author.html#863">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
