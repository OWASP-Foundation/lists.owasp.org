<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Restricted SQL Character Anomaly	Detection Alert and Roundcube mail
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Restricted%20SQL%20Character%20Anomaly%0A%09Detection%20Alert%20and%20Roundcube%20mail&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000857.html">
   <LINK REL="Next"  HREF="000860.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Restricted SQL Character Anomaly	Detection Alert and Roundcube mail</H1>
    <B>Thomas D. Dahlmann</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Restricted%20SQL%20Character%20Anomaly%0A%09Detection%20Alert%20and%20Roundcube%20mail&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Restricted SQL Character Anomaly	Detection Alert and Roundcube mail">domingo at domingo.dk
       </A><BR>
    <I>Fri Sep  2 10:27:51 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000857.html">[Owasp-modsecurity-core-rule-set] basic question
</A></li>
        <LI>Next message: <A HREF="000860.html">[Owasp-modsecurity-core-rule-set] Restricted SQL Character	Anomaly	Detection Alert and Roundcube mail
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#859">[ date ]</a>
              <a href="thread.html#859">[ thread ]</a>
              <a href="subject.html#859">[ subject ]</a>
              <a href="author.html#859">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

I've got the bellow shown exception when I try to hit my webmail site.

What kind of &quot;bad&quot; characters is the rule complaining about in this request?


--63235740-A--
[02/Sep/2011:15:59:55 +0200] TmDhWX8AAQEAAClL2qkAAAAJ x.x.x.x 28681 
2.2.2.2 443
--63235740-B--
GET 
/?_task=mail&amp;_remote=1&amp;_action=list&amp;_mbox=RoundCube&amp;_page=1&amp;_refresh=1&amp;_=1314971993364&amp;_unlock=loading1314971993363 
HTTP/1.1
Host: example.com
Connection: keep-alive
Referer: <A HREF="https://example.com/">https://example.com/</A>
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/535.1 (KHTML, 
like Gecko) Chrome/13.0.782.215 Safari/535.1
Accept: application/json, text/javascript, */*; q=0.01
X-Roundcube-Request: b7aa8fc451317a76730a72f69fbb3e9e
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-US,en;q=0.8
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: addressviewsplitter=250; prefsviewsplitter=195; 
identviewsplitter=300; mailviewsplitter=291; sieverulesviewsplitter=245; 
wp-settings-1=editor%3Dtinymce%26m4%3Do%26m0%3Do%26uploader%3D1; 
wp-settings-time-1=1308940613; mailviewsplitterv=165; 
roundcube_sessid=27cd4d0e05639619d9fa8684a6401300

--63235740-F--
HTTP/1.1 200 OK
Expires: Fri, 02 Sep 2011 13:59:55 GMT
Cache-Control: private, no-cache, must-revalidate, post-check=0, pre-check=0
Pragma: no-cache
Last-Modified: Fri, 02 Sep 2011 13:59:55 GMT
X-DNS-Prefetch-Control: off
Vary: Accept-Encoding
Content-Encoding: gzip
Content-Length: 1983
Keep-Alive: timeout=15, max=91
Connection: Keep-Alive
Content-Type: text/plain; charset=UTF-8

--63235740-H--
Message: Operator GE matched 4 at TX:restricted_sqli_char_count. [file 
&quot;/etc/apache2/modsecurity_crs/activated_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] 
[line &quot;551&quot;] [id &quot;981173&quot;] [rev &quot;2.2.1&quot;] [msg &quot;Restricted SQL Character 
Anomaly Detection Alert - Total # of special characters exceeded&quot;] [data 
&quot;4&quot;]
Message: Warning. Operator LT matched 5 at TX:inbound_anomaly_score. 
[file 
&quot;/etc/apache2/modsecurity_crs/activated_rules/modsecurity_crs_60_correlation.conf&quot;] 
[line &quot;33&quot;] [id &quot;981203&quot;] [msg &quot;Inbound Anomaly Score (Total Inbound 
Score: 3, SQLi=5, XSS=): Restricted SQL Character Anomaly Detection 
Alert - Total # of special characters exceeded&quot;]
Stopwatch: 1314971993379011 2207359 (- - -)
Stopwatch2: 1314971993379011 2207359; combined=125219, p1=1234, 
p2=123185, p3=109, p4=385, p5=303, sr=387, sw=3, l=0, gc=0
Producer: ModSecurity for Apache/2.6.1 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); 
core ruleset/2.2.1.
Server: Apache/2.2.14 (Ubuntu)

--63235740-Z--


/Thomas
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000857.html">[Owasp-modsecurity-core-rule-set] basic question
</A></li>
	<LI>Next message: <A HREF="000860.html">[Owasp-modsecurity-core-rule-set] Restricted SQL Character	Anomaly	Detection Alert and Roundcube mail
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#859">[ date ]</a>
              <a href="thread.html#859">[ thread ]</a>
              <a href="subject.html#859">[ subject ]</a>
              <a href="author.html#859">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
