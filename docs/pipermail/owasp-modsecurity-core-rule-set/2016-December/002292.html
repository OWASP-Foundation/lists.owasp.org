<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Drupal 7, nginx with ModSecurity - How to resolve that 404 error page please?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Drupal%207%2C%0A%20nginx%20with%20ModSecurity%20-%20How%20to%20resolve%20that%20404%20error%20page%20please%3F&In-Reply-To=%3CCAC7V%3DmyCZUWkiC2%3D__kCNmToyzzuSMUuX2fdLEVZ4twBD3Wp4A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002291.html">
   <LINK REL="Next"  HREF="002293.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Drupal 7, nginx with ModSecurity - How to resolve that 404 error page please?</H1>
    <B>Ehsan Mahdavi</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Drupal%207%2C%0A%20nginx%20with%20ModSecurity%20-%20How%20to%20resolve%20that%20404%20error%20page%20please%3F&In-Reply-To=%3CCAC7V%3DmyCZUWkiC2%3D__kCNmToyzzuSMUuX2fdLEVZ4twBD3Wp4A%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Drupal 7, nginx with ModSecurity - How to resolve that 404 error page please?">ehsan.mahdavi at gmail.com
       </A><BR>
    <I>Thu Dec  1 09:53:41 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002291.html">[Owasp-modsecurity-core-rule-set] Drupal 7, nginx with ModSecurity - How to resolve that 404 error page please?
</A></li>
        <LI>Next message: <A HREF="002293.html">[Owasp-modsecurity-core-rule-set] Drupal 7, nginx with ModSecurity - How to resolve that 404 error page please?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2292">[ date ]</a>
              <a href="thread.html#2292">[ thread ]</a>
              <a href="subject.html#2292">[ subject ]</a>
              <a href="author.html#2292">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Christian
It isn't very odd to me if Matej uses Nginx with Modsec V2.x.

As an experienced Nginx + Modsec V2.x(nginx_refactoring) user, it looks
like to a known bug. While using nginx+modsecV2.x in reverse proxy mode
(which is not the case for Matej) we have the very same issue for some post
requests.
I can refer you to these links:

<A HREF="http://permalink.gmane.org/gmane.comp.apache.mod-security.user/12502">http://permalink.gmane.org/gmane.comp.apache.mod-security.user/12502</A>
<A HREF="https://github.com/SpiderLabs/ModSecurity/issues/115">https://github.com/SpiderLabs/ModSecurity/issues/115</A>
<A HREF="https://github.com/SpiderLabs/ModSecurity/issues/582">https://github.com/SpiderLabs/ModSecurity/issues/582</A>
<A HREF="https://github.com/SpiderLabs/ModSecurity/issues/664">https://github.com/SpiderLabs/ModSecurity/issues/664</A>
<A HREF="https://github.com/SpiderLabs/ModSecurity/issues/748">https://github.com/SpiderLabs/ModSecurity/issues/748</A>


All complaining about this problem and no one takes the responsibility.
The only way is to disable modsec for the requested uri and wait for the
community to release modsec V3.0 or higher and hope that this bug will be
fixed.

Meantime he/she might find ctl:ruleEngine=off
&lt;<A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl</A>&gt; useful
.

Br. Ehsan

On Thu, Dec 1, 2016 at 11:56 AM, Christian Folini &lt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:

&gt;<i> Hello Matej,
</I>&gt;<i>
</I>&gt;<i> I had hoped somebody with an NginX could shed some light on this. But
</I>&gt;<i> apparently not.
</I>&gt;<i>
</I>&gt;<i> It is very odd. Your server says he can not open a certain file
</I>&gt;<i> (does it exist? permissions ok?) but then it seems that ModSec
</I>&gt;<i> influences the behaviour of the server down to opening files.
</I>&gt;<i> And that sounds quite crazy.
</I>&gt;<i>
</I>&gt;<i> On Mon, Nov 28, 2016 at 11:59:56AM +0100, Matej Zuz&#269;&#225;k wrote:
</I>&gt;<i> &gt; OWASP rule set. But when I active ModSecurity in my virtual host config
</I>&gt;<i> &gt; file for my Drupal 7 web I do not login, register or reset password with
</I>&gt;<i> &gt; this error in log:
</I>&gt;<i>
</I>&gt;<i> You English is a bit hard to understand here. Could you rephrase,
</I>&gt;<i> please?
</I>&gt;<i>
</I>&gt;<i> &gt; I found some solutions for Apache web server (these solutions use
</I>&gt;<i> &gt; modifications of htaccess file), but not for Nginx.
</I>&gt;<i>
</I>&gt;<i> What was the problem with Apache exactly and what did you modify in
</I>&gt;<i> the .htaccess file to make it go away?
</I>&gt;<i>
</I>&gt;<i> Cheers,
</I>&gt;<i>
</I>&gt;<i> Christian
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> <A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> twitter: @ChrFolini
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20161201/50d8bc86/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20161201/50d8bc86/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002291.html">[Owasp-modsecurity-core-rule-set] Drupal 7, nginx with ModSecurity - How to resolve that 404 error page please?
</A></li>
	<LI>Next message: <A HREF="002293.html">[Owasp-modsecurity-core-rule-set] Drupal 7, nginx with ModSecurity - How to resolve that 404 error page please?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2292">[ date ]</a>
              <a href="thread.html#2292">[ thread ]</a>
              <a href="subject.html#2292">[ subject ]</a>
              <a href="author.html#2292">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
