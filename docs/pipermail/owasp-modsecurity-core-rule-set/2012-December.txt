From jwilliams20122 at gmail.com  Tue Dec  4 21:39:16 2012
From: jwilliams20122 at gmail.com (John Williams)
Date: Tue, 4 Dec 2012 15:39:16 -0600
Subject: [Owasp-modsecurity-core-rule-set] v2.7.1 build on Centos 5.8,
	libxml2 issue
Message-ID: <CAOS2KAPdVW9x-L5hj3PzS_N2794ApT79YrqWeOYcF8C5HXqFRQ@mail.gmail.com>

Hello,

I have an issue with building the modsecurity binary (v2.7.1) on Centos
5.8, I receive the following error: checking if libxm2 is at least v2.6.29,
no 2.6.26.

The latest version from Centos is 2.6.26-2.1.15, does any know if they have
applied the necessary backports, or is it missing functionality added in
2.6.29?

Thank you,
J
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121204/5d37fc65/attachment.html>

From other at ahhyes.net  Thu Dec  6 04:32:37 2012
From: other at ahhyes.net (other at ahhyes.net)
Date: Thu, 06 Dec 2012 15:32:37 +1100
Subject: [Owasp-modsecurity-core-rule-set] None of the SLR rules work.
Message-ID: <9e50eccb667d20a999b106ed894f669d@ahhyes.net>

Hi Guys,

I am running ModSecurity v2.7.1 and ver.2.2.7 of the owasp ruleset 
(from the modsecurity website).

I am not having any problems with the base ruleset, however if I try to 
include any of the SLR rules, they all error out. For example:

Syntax error on line 17 of 
/usr/local/apache/conf/modsec_slr_rules/modsecurity_crs_46_slr_et_joomla_attacks.conf:
ModSecurity: No action id present within the rule

All of the rules under the SLR directory exhibit this issue.

Googling has revealed cryptic and unhelpful results. Any ideas on what 
is causing the problem?? I have the CRS config setup for Anomaly scoring 
mode.

Alex.


From other at ahhyes.net  Thu Dec  6 05:40:16 2012
From: other at ahhyes.net (other at ahhyes.net)
Date: Thu, 06 Dec 2012 16:40:16 +1100
Subject: [Owasp-modsecurity-core-rule-set] None of the SLR rules work.
In-Reply-To: <9e50eccb667d20a999b106ed894f669d@ahhyes.net>
References: <9e50eccb667d20a999b106ed894f669d@ahhyes.net>
Message-ID: <fa5ee920c9440fd06f7ff3ff22834d22@ahhyes.net>

I noticed someone else reported this issue to the mailing list in 
October:

http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2012-October/001228.html

Why wasn't this replied to? This doesnt make me feel optimistic that 
anyone will be replying to my question either.

Surely enough, I notice that all the SLR rules are missing id's, why is 
that?


On 2012-12-06 15:32, other at ahhyes.net wrote:
> Hi Guys,
>
> I am running ModSecurity v2.7.1 and ver.2.2.7 of the owasp ruleset
> (from the modsecurity website).
>
> I am not having any problems with the base ruleset, however if I try
> to include any of the SLR rules, they all error out. For example:
>
> Syntax error on line 17 of
> 
> /usr/local/apache/conf/modsec_slr_rules/modsecurity_crs_46_slr_et_joomla_attacks.conf:
> ModSecurity: No action id present within the rule
>
> All of the rules under the SLR directory exhibit this issue.
>
> Googling has revealed cryptic and unhelpful results. Any ideas on
> what is causing the problem?? I have the CRS config setup for Anomaly
> scoring mode.
>
> Alex.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> 
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

From jamuse at gmail.com  Thu Dec  6 09:12:22 2012
From: jamuse at gmail.com (Josh Amishav-Zlatin)
Date: Thu, 6 Dec 2012 11:12:22 +0200
Subject: [Owasp-modsecurity-core-rule-set] None of the SLR rules work.
In-Reply-To: <fa5ee920c9440fd06f7ff3ff22834d22@ahhyes.net>
References: <9e50eccb667d20a999b106ed894f669d@ahhyes.net>
	<fa5ee920c9440fd06f7ff3ff22834d22@ahhyes.net>
Message-ID: <CANnPkinSm42e8BePj2mdKzMoWxWjtMLuNv038g1jyUFRQZVqfg@mail.gmail.com>

On Thu, Dec 6, 2012 at 7:40 AM, <other at ahhyes.net> wrote:

> I noticed someone else reported this issue to the mailing list in October:
>
> http://lists.owasp.org/**pipermail/owasp-modsecurity-**
> core-rule-set/2012-October/**001228.html<http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2012-October/001228.html>
>
> Why wasn't this replied to? This doesnt make me feel optimistic that
> anyone will be replying to my question either.
>
>
Hi,

Some of the SLR rules are missing id's, which was an oversight. I'm not
sure if Ryan has some sort of system when assigning rule id's or if anyone
can just assign an arbitrary unused id and submit the change for inclusion
via git.

--
 - Josh


> Surely enough, I notice that all the SLR rules are missing id's, why is
> that?
>
>
>
> On 2012-12-06 15:32, other at ahhyes.net wrote:
>
>> Hi Guys,
>>
>> I am running ModSecurity v2.7.1 and ver.2.2.7 of the owasp ruleset
>> (from the modsecurity website).
>>
>> I am not having any problems with the base ruleset, however if I try
>> to include any of the SLR rules, they all error out. For example:
>>
>> Syntax error on line 17 of
>>
>> /usr/local/apache/conf/modsec_**slr_rules/modsecurity_crs_46_**
>> slr_et_joomla_attacks.conf:
>> ModSecurity: No action id present within the rule
>>
>> All of the rules under the SLR directory exhibit this issue.
>>
>> Googling has revealed cryptic and unhelpful results. Any ideas on
>> what is causing the problem?? I have the CRS config setup for Anomaly
>> scoring mode.
>>
>> Alex.
>>
>> ______________________________**_________________
>> Owasp-modsecurity-core-rule-**set mailing list
>> Owasp-modsecurity-core-rule-**set at lists.owasp.org<Owasp-modsecurity-core-rule-set at lists.owasp.org>
>>
>> https://lists.owasp.org/**mailman/listinfo/owasp-**
>> modsecurity-core-rule-set<https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set>
>>
> ______________________________**_________________
> Owasp-modsecurity-core-rule-**set mailing list
> Owasp-modsecurity-core-rule-**set at lists.owasp.org<Owasp-modsecurity-core-rule-set at lists.owasp.org>
> https://lists.owasp.org/**mailman/listinfo/owasp-**
> modsecurity-core-rule-set<https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121206/7853d663/attachment.html>

From RBarnett at trustwave.com  Fri Dec  7 15:48:52 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Fri, 7 Dec 2012 15:48:52 +0000
Subject: [Owasp-modsecurity-core-rule-set] None of the SLR rules work.
In-Reply-To: <CANnPkinSm42e8BePj2mdKzMoWxWjtMLuNv038g1jyUFRQZVqfg@mail.gmail.com>
Message-ID: <01987910BF74B341B5890120BCCE77DF0A2DFD@SKYMB1.trustwave.com>


From: Josh Amishav-Zlatin <jamuse at gmail.com<mailto:jamuse at gmail.com>>
Date: Thursday, December 6, 2012 4:12 AM
To: "other at ahhyes.net<mailto:other at ahhyes.net>" <other at ahhyes.net<mailto:other at ahhyes.net>>
Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: Re: [Owasp-modsecurity-core-rule-set] None of the SLR rules work.

On Thu, Dec 6, 2012 at 7:40 AM, <other at ahhyes.net<mailto:other at ahhyes.net>> wrote:
I noticed someone else reported this issue to the mailing list in October:

http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2012-October/001228.html

Why wasn't this replied to? This doesnt make me feel optimistic that anyone will be replying to my question either.


Hi,

Some of the SLR rules are missing id's, which was an oversight. I'm not sure if Ryan has some sort of system when assigning rule id's or if anyone can just assign an arbitrary unused id and submit the change for inclusion via git.

--
 - Josh


The problem is that ModSecurity v2.7.x required rule IDs to be set and these older converted Snort/ET rules didn't have any assigned.  I can go back through them to add them in.  Essentially, we can just reuse the ET "sid" data.

As an aside, I did send an email to the community asking if anyone was using these converted ET rules and not one responded?
http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2012-June/001091.html

-Ryan



Surely enough, I notice that all the SLR rules are missing id's, why is that?



On 2012-12-06 15:32, other at ahhyes.net<mailto:other at ahhyes.net> wrote:
Hi Guys,

I am running ModSecurity v2.7.1 and ver.2.2.7 of the owasp ruleset
(from the modsecurity website).

I am not having any problems with the base ruleset, however if I try
to include any of the SLR rules, they all error out. For example:

Syntax error on line 17 of

/usr/local/apache/conf/modsec_slr_rules/modsecurity_crs_46_slr_et_joomla_attacks.conf:
ModSecurity: No action id present within the rule

All of the rules under the SLR directory exhibit this issue.

Googling has revealed cryptic and unhelpful results. Any ideas on
what is causing the problem?? I have the CRS config setup for Anomaly
scoring mode.

Alex.

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>

https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121207/74fa20c6/attachment.html>

From sthayyilekan at BarclaycardUS.com  Thu Dec  6 16:20:58 2012
From: sthayyilekan at BarclaycardUS.com (Thayyilekandy, Subin)
Date: Thu, 6 Dec 2012 16:20:58 +0000
Subject: [Owasp-modsecurity-core-rule-set] Mod security - Failed to write to
	DBM file /global
In-Reply-To: <C310131DD0004743B2508B65C77B663121E731D3@PMEXGMB04.juniper.com>
References: <C310131DD0004743B2508B65C77B663121E731D3@PMEXGMB04.juniper.com>
Message-ID: <C310131DD0004743B2508B65C77B663121E731F6@PMEXGMB04.juniper.com>


I'm using Mod security 2.6 with ruleset/2.2.5 on apache 2.4 , Section H of all logs appearing in the audit log ends with the below lines ,Please see section H below .


Message: Failed to write to DBM file "/cust/apache/httpd-2.4.3/httpd-2.4.3/modsecurity/crs/cif/global": Invalid argument
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 9] %s   ( multiple times)

Any thoughts on what these mean and how they can be avoided ?

--a222e376-H--
Message: Warning. String match "HTTP/1.1" at REQUEST_PROTOCOL. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_20_protocol_violations.conf"] [line "221"] [id "960020"] [rev "2.2.5"] [msg "Pragma Header requires Cache-Control Header for HTTP/1.1 requests."] [severity "NOTICE"] [tag "RULE_MATURITY/5"] [tag "RULE_ACCURACY/7"] [tag "https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960020"] [tag "PROTOCOL_VIOLATION/INVALID_HREQ"] [tag "http://www.bad-behavior.ioerror.us/documentation/how-it-works/"]
Message: Warning. Pattern match "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*){4,}<file:///\\)\-\+\=\%7b\%7d\%5b\%5d\|\:\;\%22\'\xc2\xb4\xe2\x80\x99\xe2\x80\x98\%60\%3c\%3e%5d.*)%7b4,%7d>" at ARGS:ssn1. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"] [line "171"] [id "981173"] [rev "2.2.5"] [msg "Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded"] [data ">"]
Message: Warning. Pattern match "(?i:(?:union\\s*?(?:all|distinct|[(!@]*?)?\\s*?[([]*?\\s*?select)|(?:\\w+\\s+like\\s+[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98])|(?:like\\s*?[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\%)|(?:[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\s*?like\\W*?[\"'`\xc2\xb4\xe2 ..." at ARGS:ssn1. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"] [line "235"] [id "981245"] [msg "Detects basic SQL authentication bypass attempts 2/3"] [data "\x22><iMg S"] [severity "CRITICAL"] [tag "WEB_ATTACK/SQLI"]
Message: Warning. Pattern match "\\bsrc\\b\\W*?\\bvbscript:<file:///\\bsrc\b\W*%3f\bvbscript:>" at ARGS:ssn1. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"] [line "103"] [id "958033"] [rev "2.2.5"] [msg "Cross-site Scripting (XSS) Attack"] [data "src=vbscript:"] [severity "CRITICAL"] [tag "WEB_ATTACK/XSS"] [tag "WASCTC/WASC-8"] [tag "WASCTC/WASC-22"] [tag "OWASP_TOP_10/A2"] [tag "OWASP_AppSensor/IE1"] [tag "PCI/6.5.1"]
Message: Warning. Pattern match "<(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|h ..." at ARGS:ssn1. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"] [line "556"] [id "973300"] [rev "2.2.5"] [msg "Possible XSS Attack Detected - HTML Tag Handler"] [data "<img "]
Message: Warning. Pattern match "\\b(background|dynsrc|href|lowsrc|src)\\b\\W*?=<file:///\\b(background|dynsrc|href|lowsrc|src)\b\W*%3f=>" at ARGS:ssn1. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"] [line "588"] [id "973304"] [rev "2.2.5"] [msg "XSS Attack Detected"] [data "src="]
Message: Warning. Pattern match "(asfunction|javascript|vbscript|data|mocha|livescript):" at ARGS:ssn1. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"] [line "606"] [id "973305"] [rev "2.2.5"] [msg "XSS Attack Detected"] [data "vbscript:"]
Message: Warning. Pattern match "(?i:[\"\\'][ ]*(([^a-z0-9~_:\\'\<file:///\\'][%20]*(([%5ea-z0-9~_:\'\>" ])|(in)).+?\\(.*?\\))" at ARGS:ssn1. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"] [line "765"] [id "973335"] [rev "2.2.5"] [msg "IE XSS Filters - Attack Detected"] [data "\x22><iMg SrC=vBsCrIpT:MsgBox(63346)"]
Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_60_correlation.conf"] [line "37"] [id "981204"] [msg "Inbound Anomaly Score Exceeded (Total Inbound Score: 35, SQLi=2, XSS=25): IE XSS Filters - Attack Detected"]
Message: Failed to write to DBM file "/cust/apache/httpd-2.4.3/httpd-2.4.3/modsecurity/crs/cif/global": Invalid argument
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 9] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 8] %s
Apache-Error: [file "proxy_util.c"] [line 1792] [level 9] %s: found worker %s for %s
Apache-Error: [file "mod_proxy.c"] [line 1070] [level 7] AH01143: Running scheme %s handler (attempt %d)
Apache-Error: [file "proxy_util.c"] [line 2030] [level 7] AH00944: connecting %s to %s:%d
Apache-Error: [file "proxy_util.c"] [line 2152] [level 7] AH00947: connected %s to %s:%d
Apache-Handler: proxy-server
Stopwatch: 1354657503037214 99334 (- - -)
Stopwatch2: 1354657503037214 99334; combined=62623, p1=4965, p2=31299, p3=271, p4=23967, p5=1828, sr=4183, sw=293, l=0, gc=0
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/); core ruleset/2.2.5.
Server: Apache
WebApp-Info: "default" "E9BA05953DB7550EDE5B2243B52E0122" ""



Barclaycard
www.barclaycardus.com 

This email and any files transmitted with it may contain confidential and/or proprietary information. It is intended solely for the use of the individual or entity who is the intended recipient. Unauthorized use of this information is prohibited. If you have received this in error, please contact the sender by replying to this message and delete this material from any system it may be on.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121206/27c3b759/attachment-0001.html>

From PNair at barclaycardus.com  Thu Dec  6 19:48:16 2012
From: PNair at barclaycardus.com (Nair, Praveen)
Date: Thu, 6 Dec 2012 19:48:16 +0000
Subject: [Owasp-modsecurity-core-rule-set] Help - ModSecurity and ModRewrite
	issues
In-Reply-To: <2D8620FFA11CD047B8E51A5ECE45A7750841F489@PMEXGMB01.juniper.com>
References: <2D8620FFA11CD047B8E51A5ECE45A7750841F489@PMEXGMB01.juniper.com>
Message-ID: <2D8620FFA11CD047B8E51A5ECE45A7750841F4A6@PMEXGMB01.juniper.com>


Team,
I would appreciate if you could provide any help in resolving these two issues with ModSecurity and ModRewrite modules.

Mod security Pending Issues in Dev03


1.       Mod Rewrite + mod security not working properly
 https://dev03-www.xyz.com/ should redirect to https://dev03-www.xyz.com/app/ccsite/action/home, which the mod_rewrite module does, however, modSecurity is intercepting it and then the request is being forced to /cust/docs/instancemain/app. This redirect does not happen , we are not sure if this is an issue with modsecurity or mod rewrite or compatibility between the both the version of them.


2.       Mod Rewrite  trace level issues in audit logs

Mod security should not be logging trace level details in the  audit log as per the setting , We are not sure why the below lines are appearing in the log file

Apache-Error: [file "mod_rewrite.c"] [line 467] [level 9] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s
Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s


With Best Regards,

Praveen Nair, C|CISO, CISSP, CISM, CRISC
IT Security Consultant
Barclays Global Information Security - GISTR
Email: pnair at barclaycardus.com<mailto:pnair at barclaycardus.com>
Company Confidential



Barclaycard
www.barclaycardus.com 

This email and any files transmitted with it may contain confidential and/or proprietary information. It is intended solely for the use of the individual or entity who is the intended recipient. Unauthorized use of this information is prohibited. If you have received this in error, please contact the sender by replying to this message and delete this material from any system it may be on.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121206/3382ffe3/attachment.html>

From gnets1 at yahoo.co.uk  Thu Dec  6 23:33:15 2012
From: gnets1 at yahoo.co.uk (Gene)
Date: Thu, 6 Dec 2012 23:33:15 +0000 (GMT)
Subject: [Owasp-modsecurity-core-rule-set] None of the SLR rules work.
In-Reply-To: <CANnPkinSm42e8BePj2mdKzMoWxWjtMLuNv038g1jyUFRQZVqfg@mail.gmail.com>
References: <9e50eccb667d20a999b106ed894f669d@ahhyes.net>
	<fa5ee920c9440fd06f7ff3ff22834d22@ahhyes.net>
	<CANnPkinSm42e8BePj2mdKzMoWxWjtMLuNv038g1jyUFRQZVqfg@mail.gmail.com>
Message-ID: <1354836795.91613.YahooMailNeo@web132202.mail.ird.yahoo.com>





________________________________
 From: Josh Amishav-Zlatin <jamuse at gmail.com>
To: other at ahhyes.net 
Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org" <owasp-modsecurity-core-rule-set at lists.owasp.org> 
Sent: Thursday, 6 December 2012, 9:12
Subject: Re: [Owasp-modsecurity-core-rule-set] None of the SLR rules work.
 

On Thu, Dec 6, 2012 at 7:40 AM, <other at ahhyes.net> wrote:

I noticed someone else reported this issue to the mailing list in October:
>
>http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2012-October/001228.html
>
>Why wasn't this replied to? This doesnt make me feel optimistic that anyone will be replying to my question either.
>
>

Hi,

Some of the SLR rules are missing id's, which was an oversight. I'm not sure if Ryan has some sort of system when assigning rule id's or if anyone can just assign an arbitrary unused id and submit the change for inclusion via git.

--
?- Josh

?
Hi

If you're allocating id's yourself, I posted the clip below in another thread a couple weeks ago, it might be useful:

http://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#id

It sets out reserved ranges including this one:
1?99,999: reserved for local (internal) use. Use as you see fit, but do 
not use this range for rules that are distributed to others 

?
Surely enough, I notice that all the SLR rules are missing id's, why is that?
>
>
>
>On 2012-12-06 15:32, other at ahhyes.net wrote:
>
>Hi Guys,
>>
>>I am running ModSecurity v2.7.1 and ver.2.2.7 of the owasp ruleset
>>(from the modsecurity website).
>>
>>I am not having any problems with the base ruleset, however if I try
>>to include any of the SLR rules, they all error out. For example:
>>
>>Syntax error on line 17 of
>>
>>/usr/local/apache/conf/modsec_slr_rules/modsecurity_crs_46_slr_et_joomla_attacks.conf:
>>ModSecurity: No action id present within the rule
>>
>>All of the rules under the SLR directory exhibit this issue.
>>
>>Googling has revealed cryptic and unhelpful results. Any ideas on
>>what is causing the problem?? I have the CRS config setup for Anomaly
>>scoring mode.
>>
>>Alex.
>>
>>_______________________________________________
>>Owasp-modsecurity-core-rule-set mailing list
>>Owasp-modsecurity-core-rule-set at lists.owasp.org
>>
>>https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>
_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121206/4ad69845/attachment-0001.html>

From RBarnett at trustwave.com  Tue Dec  4 21:42:27 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Tue, 4 Dec 2012 21:42:27 +0000
Subject: [Owasp-modsecurity-core-rule-set] v2.7.1 build on Centos 5.8,
 libxml2 issue
In-Reply-To: <CAOS2KAPdVW9x-L5hj3PzS_N2794ApT79YrqWeOYcF8C5HXqFRQ@mail.gmail.com>
Message-ID: <01987910BF74B341B5890120BCCE77DF0A01A4@SKYMB1.trustwave.com>

John,
This list is for the OWASP ModSecurity CRS.

Please sign up for and use the ModSecurity Users mail-list - http://lists.sourceforge.net/lists/listinfo/mod-security-users

-Ryan

From: John Williams <jwilliams20122 at gmail.com<mailto:jwilliams20122 at gmail.com>>
Date: Tuesday, December 4, 2012 4:39 PM
To: <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] v2.7.1 build on Centos 5.8, libxml2 issue

Hello,

I have an issue with building the modsecurity binary (v2.7.1) on Centos 5.8, I receive the following error: checking if libxm2 is at least v2.6.29, no 2.6.26.

The latest version from Centos is 2.6.26-2.1.15, does any know if they have applied the necessary backports, or is it missing functionality added in 2.6.29?

Thank you,
J _______________________________________________ Owasp-modsecurity-core-rule-set mailing list Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121204/e8961a61/attachment.html>

From jamuse at gmail.com  Sun Dec  9 09:33:01 2012
From: jamuse at gmail.com (Josh Amishav-Zlatin)
Date: Sun, 9 Dec 2012 11:33:01 +0200
Subject: [Owasp-modsecurity-core-rule-set] Mod security - Failed to
 write to DBM file /global
In-Reply-To: <C310131DD0004743B2508B65C77B663121E731F6@PMEXGMB04.juniper.com>
References: <C310131DD0004743B2508B65C77B663121E731D3@PMEXGMB04.juniper.com>
	<C310131DD0004743B2508B65C77B663121E731F6@PMEXGMB04.juniper.com>
Message-ID: <CANnPki=veepktDO8sQJZvQqtiyQJgMHF+KTQ_cGY7OnCvatXxg@mail.gmail.com>

On Thu, Dec 6, 2012 at 6:20 PM, Thayyilekandy, Subin <
sthayyilekan at barclaycardus.com> wrote:

>  ** **
>
> I?m using Mod security 2.6 with ruleset/2.2.5 on apache 2.4 , Section H of
> all logs appearing in the audit log ends with the below lines ,Please see
> section H below .****
>
> ** **
>
> ** **
>
> *Message: Failed to write to DBM file
> "/cust/apache/httpd-2.4.3/httpd-2.4.3/modsecurity/crs/cif/global": Invalid
> argument*
>
> *Apache-Error: [file "mod_rewrite.c"] [line 467] [level 9] %s   (
> multiple times) *
>
> ** **
>
> Any thoughts on what these mean and how they can be avoided ?****
>
> **
>

Hi Subin,

The SDBM library that ModSecurity uses for persistent collections has an
arbitrary limit of 1008 bytes on the combined size of the key and record
lengths. When you go over that limit, you get a cryptic error message like
you reported above. You can increase that limit by recompiling APR
and APR-util. I explained how here:
http://www.purehacking.com/blogs/josh-zlatin/increasing-modsecurity-collection-size-limits

--
 - Josh




>  **
>
> --a222e376-H--****
>
> Message: Warning. String match "HTTP/1.1" at REQUEST_PROTOCOL. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_20_protocol_violations.conf"]
> [line "221"] [id "960020"] [rev "2.2.5"] [msg "Pragma Header requires
> Cache-Control Header for HTTP/1.1 requests."] [severity "NOTICE"] [tag
> "RULE_MATURITY/5"] [tag "RULE_ACCURACY/7"] [tag "
> https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960020"] [tag
> "PROTOCOL_VIOLATION/INVALID_HREQ"] [tag "
> http://www.bad-behavior.ioerror.us/documentation/how-it-works/"]****
>
> Message: Warning. Pattern match "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(
> \\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*){4,}"
> at ARGS:ssn1. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> [line "171"] [id "981173"] [rev "2.2.5"] [msg "Restricted SQL Character
> Anomaly Detection Alert - Total # of special characters exceeded"] [data
> ">"]****
>
> Message: Warning. Pattern match
> "(?i:(?:union\\s*?(?:all|distinct|[(!@]*?)?\\s*?[([]*?\\s*?select)|(?:\\w+\\s+like\\s+[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98])|(?:like\\s*?[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\%)|(?:[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]\\s*?like\\W*?[\"'`\xc2\xb4\xe2
> ..." at ARGS:ssn1. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> [line "235"] [id "981245"] [msg "Detects basic SQL authentication bypass
> attempts 2/3"] [data "\x22><iMg S"] [severity "CRITICAL"] [tag
> "WEB_ATTACK/SQLI"]****
>
> Message: Warning. Pattern match "\\bsrc\\b\\W*?\\bvbscript:" at
> ARGS:ssn1. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"]
> [line "103"] [id "958033"] [rev "2.2.5"] [msg "Cross-site Scripting (XSS)
> Attack"] [data "src=vbscript:"] [severity "CRITICAL"] [tag
> "WEB_ATTACK/XSS"] [tag "WASCTC/WASC-8"] [tag "WASCTC/WASC-22"] [tag
> "OWASP_TOP_10/A2"] [tag "OWASP_AppSensor/IE1"] [tag "PCI/6.5.1"]****
>
> Message: Warning. Pattern match
> "<(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|h
> ..." at ARGS:ssn1. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"]
> [line "556"] [id "973300"] [rev "2.2.5"] [msg "Possible XSS Attack Detected
> - HTML Tag Handler"] [data "<img "]****
>
> Message: Warning. Pattern match "
> \\b(background|dynsrc|href|lowsrc|src)\\b\\W*?=" at ARGS:ssn1. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"]
> [line "588"] [id "973304"] [rev "2.2.5"] [msg "XSS Attack Detected"] [data
> "src="]****
>
> Message: Warning. Pattern match
> "(asfunction|javascript|vbscript|data|mocha|livescript):" at ARGS:ssn1.
> [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"]
> [line "606"] [id "973305"] [rev "2.2.5"] [msg "XSS Attack Detected"] [data
> "vbscript:"]****
>
> Message: Warning. Pattern match "(?i:[\"\\'][ ]*(([^a-z0-9~_:\\'\"
> ])|(in)).+?\\(.*?\\))" at ARGS:ssn1. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_41_xss_attacks.conf"]
> [line "765"] [id "973335"] [rev "2.2.5"] [msg "IE XSS Filters - Attack
> Detected"] [data "\x22><iMg SrC=vBsCrIpT:MsgBox(63346)"]****
>
> Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file
> "/cust/docs/config/dev03/cif/crs/base_rules/modsecurity_crs_60_correlation.conf"]
> [line "37"] [id "981204"] [msg "Inbound Anomaly Score Exceeded (Total
> Inbound Score: 35, SQLi=2, XSS=25): IE XSS Filters - Attack Detected"]****
>
> Message: Failed to write to DBM file
> "/cust/apache/httpd-2.4.3/httpd-2.4.3/modsecurity/crs/cif/global": Invalid
> argument****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 9] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 11] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 10] %s****
>
> Apache-Error: [file "mod_rewrite.c"] [line 467] [level 8] %s****
>
> Apache-Error: [file "proxy_util.c"] [line 1792] [level 9] %s: found worker
> %s for %s****
>
> Apache-Error: [file "mod_proxy.c"] [line 1070] [level 7] AH01143: Running
> scheme %s handler (attempt %d)****
>
> Apache-Error: [file "proxy_util.c"] [line 2030] [level 7] AH00944:
> connecting %s to %s:%d****
>
> Apache-Error: [file "proxy_util.c"] [line 2152] [level 7] AH00947:
> connected %s to %s:%d****
>
> Apache-Handler: proxy-server****
>
> Stopwatch: 1354657503037214 99334 (- - -)****
>
> Stopwatch2: 1354657503037214 99334; combined=62623, p1=4965, p2=31299,
> p3=271, p4=23967, p5=1828, sr=4183, sw=293, l=0, gc=0****
>
> Response-Body-Transformed: Dechunked****
>
> Producer: ModSecurity for Apache/2.6.8 (http://www.modsecurity.org/);
> core ruleset/2.2.5.****
>
> Server: Apache****
>
> WebApp-Info: "default" "E9BA05953DB7550EDE5B2243B52E0122" ""****
>
> ** **
>
> Barclaycard
>
> www.barclaycardus.com
>
> This email and any files transmitted with it may contain confidential
> and/or proprietary information. It is intended solely for the use of the
> individual or entity who is the intended recipient. Unauthorized use of
> this information is prohibited. If you have received this in error, please
> contact the sender by replying to this message and delete this material
> from any system it may be on.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121209/6e2acd90/attachment-0001.html>

From RBarnett at trustwave.com  Mon Dec 10 12:33:47 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 10 Dec 2012 12:33:47 +0000
Subject: [Owasp-modsecurity-core-rule-set] json
In-Reply-To: <CANfYGQmDuNwaXKsbR=cDydhh2XneibnZDXvCzhNdt2egOKAmWw@mail.gmail.com>
References: <CANfYGQmDuNwaXKsbR=cDydhh2XneibnZDXvCzhNdt2egOKAmWw@mail.gmail.com>
Message-ID: <DDDE6829-C346-4E2E-9485-A95490B67632@trustwave.com>

We have an open jira ticket for this and we are working on a json request body parser that will populate ARGS.

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


On Dec 8, 2012, at 11:45 PM, "Ben WIlliams" <benwilliams+owasp at joobworld.com> wrote:

> Hi,
> I am interested to know how other modsecurity CRS users handle json requests? Since there is no processor for JSON to break it down into ARGS, the JSON is compared as one long string which causes a lot of false positives for SQLi, etc.
> My approach so far has been to disable the CRS rules that cause false positives on JSON.
> Has anyone tried luajson or a json schema library to do validation?
>
> thanks
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From RBarnett at trustwave.com  Mon Dec 17 21:32:05 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 17 Dec 2012 21:32:05 +0000
Subject: [Owasp-modsecurity-core-rule-set] Setting HoneyTraps with
	ModSecurity: Unused Web Ports
Message-ID: <01987910BF74B341B5890120BCCE77DF0AA5F9@SKYMB1.trustwave.com>

I posted this today - http://blog.spiderlabs.com/2012/12/setting-honeytraps-with-modsecurity-unused-web-ports.html

I am hoping that you find it useful and that some folks will consider setting this up and sending logs to our WASC Distributed Web Honeypots central logging server.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121217/903612b9/attachment.html>

From RBarnett at trustwave.com  Tue Dec 18 21:34:32 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Tue, 18 Dec 2012 21:34:32 +0000
Subject: [Owasp-modsecurity-core-rule-set] Setting HoneyTraps with
	ModSecurity: Project Honeypot Integration
Message-ID: <01987910BF74B341B5890120BCCE77DF0AB9D2@SKYMB1.trustwave.com>

For those of you using Project Honeypot, you might like this blog post which demonstrates how to use ModSecurity's data substitution operator (@rsub) to dynamically add in Project Honeypot links to your site - http://blog.spiderlabs.com/2012/12/setting-honeytraps-with-modsecurity-project-honeypot-integration.html

Cheers.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121218/293c3f91/attachment.html>

From RBarnett at trustwave.com  Wed Dec 19 19:44:40 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 19 Dec 2012 19:44:40 +0000
Subject: [Owasp-modsecurity-core-rule-set] Updates to OWASP ModSecurity CRS
	(v2.2.7)
Message-ID: <01987910BF74B341B5890120BCCE77DF0AD814@SKYMB1.trustwave.com>

I wanted to pass along some updates to the latest CRS version out in GitHub -

== Version 2.2.7 - 12/19/2012 ==

Improvements:
* Added JS Overrides file to identify successfull XSS probes
* Added new XSS Detection Rules from Ashar Javed (http://twitter.com/soaj1664ashar)
* Updated the SQLi Filters to add in Oracle specific functions
  - https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/7

Bug Fixes:
* Fixed Session Hijacking rules
  - https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/8

Please grab a copy of the code from GitHub and test out these new updates and let me know if you have any issues.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121219/e5649d27/attachment.html>

From rm4dillo at gmail.com  Thu Dec 20 23:00:14 2012
From: rm4dillo at gmail.com (rm4dillo D)
Date: Fri, 21 Dec 2012 00:00:14 +0100
Subject: [Owasp-modsecurity-core-rule-set] [BUGFIX]
 "modsecurity_crs_41_xss_attacks.conf" performance optimization test not
 working
In-Reply-To: <CAAzXPXByRw5C8NHfAAWh4nCYxwdEE0gKfRaG2QSzzsGwUdmV8Q@mail.gmail.com>
References: <CAAzXPXByRw5C8NHfAAWh4nCYxwdEE0gKfRaG2QSzzsGwUdmV8Q@mail.gmail.com>
Message-ID: <CAAzXPXC9LSQv7eFH19TFbQqTXj1qhGcKBCr4SeApXn2NxGHS5w@mail.gmail.com>

Hi Ryan, are you planning to add this little fix to the 2.2.7? That would
really be great!

Thank you!

On Friday, November 9, 2012, rm4dillo D wrote:

> Hi,
>
> The "base_rules/modsecurity_crs_41_xss_attacks.conf" rules file starts
> with a smart rule that checks the presence of some keywords (Ex. script
> javascript...) and depending on the result, it decides to run deeper rules
> or just skip them. The problem is that the conditional "skip" never works
> because it tests the "pm_xss_score" variable which is not initialized.
>
>     SecRule TX:PM_XSS_SCORE "@eq 0"
> "phase:2,id:'981018',t:none,pass,skipAfter:END_XSS_CHECK,nolog"
>
> To fix this, I just directive this at the beginning of the file:
>
>     SecAction
> "phase:2,rev:'2.2.5',t:none,pass,nolog,setvar:tx.pm_xss_score=0"
>
> It would be nice to fix this in the next core rule set release.
>
> Thank you in advance.
>
> Rm4dillo
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121221/56b9d397/attachment.html>

