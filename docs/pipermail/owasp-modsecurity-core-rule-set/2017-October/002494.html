<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity cannot detect SQLi in request body (HTTP POST)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS3%20Issues%20-%20modsecurity%0A%20cannot%20detect%20SQLi%20in%20request%20body%20%28HTTP%20POST%29&In-Reply-To=%3C20171017211858.yt5rmycx2qjvnzuw%40leander%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002493.html">
   <LINK REL="Next"  HREF="002495.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity cannot detect SQLi in request body (HTTP POST)</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS3%20Issues%20-%20modsecurity%0A%20cannot%20detect%20SQLi%20in%20request%20body%20%28HTTP%20POST%29&In-Reply-To=%3C20171017211858.yt5rmycx2qjvnzuw%40leander%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity cannot detect SQLi in request body (HTTP POST)">christian.folini at netnea.com
       </A><BR>
    <I>Tue Oct 17 21:18:58 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002493.html">[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity cannot	detect SQLi in request body (HTTP POST)
</A></li>
        <LI>Next message: <A HREF="002495.html">[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity	cannot detect SQLi in request body (HTTP POST)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2494">[ date ]</a>
              <a href="thread.html#2494">[ thread ]</a>
              <a href="subject.html#2494">[ subject ]</a>
              <a href="author.html#2494">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Jeff,

Could you raise you SecDebugLogLevel to 9 and then post your payload and
select that part of the debug log that handles the rule 942100?

Also: Said libinjection rules does not work on the raw request body (your
post implies this somehow). But it only works on argument names and
argument values.

Best,

Christian

On Tue, Oct 17, 2017 at 12:20:40PM -0700, Jeff Liu wrote:
&gt;<i>    Dear CRS leaders,
</I>&gt;<i>    I am trying to test the latest version of rule set (version 3) with
</I>&gt;<i>    modsecurity to detect SQLi injection. I find that the CRS is able to
</I>&gt;<i>    correctly detect SQLi attacks in request headers (HTTP GET), while it's
</I>&gt;<i>    not able to detect any SQLi attacks in the request body (HTTP POST) even
</I>&gt;<i>    for the most simple ones such as &quot;or 1=1--&quot;.
</I>&gt;<i>    I checked some online solutions and already set the SecRequestBodyAccess
</I>&gt;<i>    On but it still doesn't work.
</I>&gt;<i>    Could anyone help me with it? Thanks in advance!
</I>&gt;<i>    Regards,
</I>&gt;<i>    Tianyu
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>

-- 
ModSecurity courses Oct 2017 in London and Zurich
<A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
<A HREF="https://www.feistyduck.com/books/modsecurity-handbook/">https://www.feistyduck.com/books/modsecurity-handbook/</A>
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
twitter: @ChrFolini
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002493.html">[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity cannot	detect SQLi in request body (HTTP POST)
</A></li>
	<LI>Next message: <A HREF="002495.html">[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity	cannot detect SQLi in request body (HTTP POST)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2494">[ date ]</a>
              <a href="thread.html#2494">[ thread ]</a>
              <a href="subject.html#2494">[ subject ]</a>
              <a href="author.html#2494">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
