<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Possibility of fine tuning	libinjection results
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Possibility%20of%20fine%20tuning%0A%09libinjection%20results&In-Reply-To=%3CCACd%3Df9eScJS8yTx4bR-_xNRStKRNRp-K0V4pyxHESYiSx36-SQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002482.html">
   <LINK REL="Next"  HREF="002483.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Possibility of fine tuning	libinjection results</H1>
    <B>Bob Jolliffe</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Possibility%20of%20fine%20tuning%0A%09libinjection%20results&In-Reply-To=%3CCACd%3Df9eScJS8yTx4bR-_xNRStKRNRp-K0V4pyxHESYiSx36-SQ%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Possibility of fine tuning	libinjection results">bobjolliffe at gmail.com
       </A><BR>
    <I>Fri Oct 13 11:06:37 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002482.html">[Owasp-modsecurity-core-rule-set] Possibility of fine tuning	libinjection results
</A></li>
        <LI>Next message: <A HREF="002483.html">[Owasp-modsecurity-core-rule-set] Possibility of fine tuning libinjection results
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2487">[ date ]</a>
              <a href="thread.html#2487">[ thread ]</a>
              <a href="subject.html#2487">[ subject ]</a>
              <a href="author.html#2487">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Waqas and Manuel for your valuable suggestions.

And sorry for replying here to my own post instead of yours - I was
receiving just the digest not the individual mails.

As I said, your suggestions are valuable learning for me, but don't
really get to the heart of my problem.  Unfortunately this is not
going to be just one url.  There are many which will use the same
pattern of parameters.  What I am really trying to get to is the
fingerprint result of libinjection.  My understanding is that
libinjection returns a 1 or 0 result indicated attack detected, but
also the fingerprint of the attack detected.  In this case 'nok(n' .
Is there some way I can say to respect the result of libinjection but
ignore this particular fingerprint?

That seemed to be the intent of early discussion of integrating
libinjection back in 2013
(<A HREF="https://sourceforge.net/p/mod-security/mailman/message/30387182/">https://sourceforge.net/p/mod-security/mailman/message/30387182/</A>).
The syntax proposed in that message was:

SecRule ARGS &quot;@detectSQLi /path/to/fingerprints.txt&quot;

Maybe it does actually work like that and I am missing something.

Regards
Bob



On 12 October 2017 at 13:39, Bob Jolliffe &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">bobjolliffe at gmail.com</A>&gt; wrote:
&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> I am not very experienced with owcrs so please bear with me if I say
</I>&gt;<i> silly things.
</I>&gt;<i>
</I>&gt;<i> I have a problem that rule 942100 (libinjection) is getting falsely
</I>&gt;<i> triggered in response to a legitimate api call on our application.  In
</I>&gt;<i> particular the the offending URL is:
</I>&gt;<i>
</I>&gt;<i> GET /dhis/api/26/dimensions.json?fields=id,displayName~rename(name),dimensionType&amp;paging=false
</I>&gt;<i>
</I>&gt;<i> Which triggers 942100 with a fingerprint of 'nok(n'.
</I>&gt;<i>
</I>&gt;<i> I don't really want to disable the whole rule as I am sure
</I>&gt;<i> libinjection is valuable and it seems it is just this nok thing which
</I>&gt;<i> is tripping.   I also will not easily get developers to change the api
</I>&gt;<i> in a hurry.  Does anybody know is there a way to keep 942100 but just
</I>&gt;<i> disable responding to this particular fingerprint?
</I>&gt;<i>
</I>&gt;<i> Bonus question: can anybody tell me what it is exactly in the URL
</I>&gt;<i> which is upsetting libinjection?  I am suspecting it has to do with
</I>&gt;<i> 'rename(name)'
</I>&gt;<i>
</I>&gt;<i> Regards
</I>&gt;<i> Bob
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002482.html">[Owasp-modsecurity-core-rule-set] Possibility of fine tuning	libinjection results
</A></li>
	<LI>Next message: <A HREF="002483.html">[Owasp-modsecurity-core-rule-set] Possibility of fine tuning libinjection results
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2487">[ date ]</a>
              <a href="thread.html#2487">[ thread ]</a>
              <a href="subject.html#2487">[ subject ]</a>
              <a href="author.html#2487">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
