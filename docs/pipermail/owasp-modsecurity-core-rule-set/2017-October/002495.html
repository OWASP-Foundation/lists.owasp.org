<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity	cannot detect SQLi in request body (HTTP POST)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS3%20Issues%20-%20modsecurity%0A%09cannot%20detect%20SQLi%20in%20request%20body%20%28HTTP%20POST%29&In-Reply-To=%3C630B18D5-9FDE-42D1-B023-A61904D2F3B2%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002494.html">
   <LINK REL="Next"  HREF="002497.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity	cannot detect SQLi in request body (HTTP POST)</H1>
    <B>spartantri at gmail.com</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS3%20Issues%20-%20modsecurity%0A%09cannot%20detect%20SQLi%20in%20request%20body%20%28HTTP%20POST%29&In-Reply-To=%3C630B18D5-9FDE-42D1-B023-A61904D2F3B2%40gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity	cannot detect SQLi in request body (HTTP POST)">spartantri at gmail.com
       </A><BR>
    <I>Wed Oct 18 12:18:26 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002494.html">[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity cannot detect SQLi in request body (HTTP POST)
</A></li>
        <LI>Next message: <A HREF="002497.html">[Owasp-modsecurity-core-rule-set] mod_security_crs 2.2.9	modsecurity_crs_48_local_exceptions.conf question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2495">[ date ]</a>
              <a href="thread.html#2495">[ thread ]</a>
              <a href="subject.html#2495">[ subject ]</a>
              <a href="author.html#2495">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>That if a body processor is used, certain content-types that do not use one are ignored, eg plain text or multipart may not have all the parts inspected, so you will have to start to with that and force the right body processor to be used.

Cheers!

Enviado desde mi iPhone

&gt;<i> El 17 oct 2017, a las 23:18, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; escribi&#243;:
</I>&gt;<i> 
</I>&gt;<i> Hey Jeff,
</I>&gt;<i> 
</I>&gt;<i> Could you raise you SecDebugLogLevel to 9 and then post your payload and
</I>&gt;<i> select that part of the debug log that handles the rule 942100?
</I>&gt;<i> 
</I>&gt;<i> Also: Said libinjection rules does not work on the raw request body (your
</I>&gt;<i> post implies this somehow). But it only works on argument names and
</I>&gt;<i> argument values.
</I>&gt;<i> 
</I>&gt;<i> Best,
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;&gt;<i> On Tue, Oct 17, 2017 at 12:20:40PM -0700, Jeff Liu wrote:
</I>&gt;&gt;<i>   Dear CRS leaders,
</I>&gt;&gt;<i>   I am trying to test the latest version of rule set (version 3) with
</I>&gt;&gt;<i>   modsecurity to detect SQLi injection. I find that the CRS is able to
</I>&gt;&gt;<i>   correctly detect SQLi attacks in request headers (HTTP GET), while it's
</I>&gt;&gt;<i>   not able to detect any SQLi attacks in the request body (HTTP POST) even
</I>&gt;&gt;<i>   for the most simple ones such as &quot;or 1=1--&quot;.
</I>&gt;&gt;<i>   I checked some online solutions and already set the SecRequestBodyAccess
</I>&gt;&gt;<i>   On but it still doesn't work.
</I>&gt;&gt;<i>   Could anyone help me with it? Thanks in advance!
</I>&gt;&gt;<i>   Regards,
</I>&gt;&gt;<i>   Tianyu
</I>&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> ModSecurity courses Oct 2017 in London and Zurich
</I>&gt;<i> <A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
</I>&gt;<i> <A HREF="https://www.feistyduck.com/books/modsecurity-handbook/">https://www.feistyduck.com/books/modsecurity-handbook/</A>
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> twitter: @ChrFolini
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002494.html">[Owasp-modsecurity-core-rule-set] CRS3 Issues - modsecurity cannot detect SQLi in request body (HTTP POST)
</A></li>
	<LI>Next message: <A HREF="002497.html">[Owasp-modsecurity-core-rule-set] mod_security_crs 2.2.9	modsecurity_crs_48_local_exceptions.conf question
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2495">[ date ]</a>
              <a href="thread.html#2495">[ thread ]</a>
              <a href="subject.html#2495">[ subject ]</a>
              <a href="author.html#2495">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
