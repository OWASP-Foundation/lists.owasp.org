<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20the%20right%20process%20of%0A%20dealing%20with%20the%20false%20postivies&In-Reply-To=%3C20170815073906.r2oivpnhtbu3472j%40leander%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002450.html">
   <LINK REL="Next"  HREF="002451.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20the%20right%20process%20of%0A%20dealing%20with%20the%20false%20postivies&In-Reply-To=%3C20170815073906.r2oivpnhtbu3472j%40leander%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies">christian.folini at netnea.com
       </A><BR>
    <I>Tue Aug 15 07:39:06 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002450.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
        <LI>Next message: <A HREF="002451.html">[Owasp-modsecurity-core-rule-set] Announcing www.coreruleset.org	and new project logo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2438">[ date ]</a>
              <a href="thread.html#2438">[ thread ]</a>
              <a href="subject.html#2438">[ subject ]</a>
              <a href="author.html#2438">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey, hey,

On Tue, Aug 15, 2017 at 10:31:34AM +0300, Georgi Georgiev wrote:
&gt;<i> Thank you about your reply. I know about the exclusion, but I don&#8217;t
</I>&gt;<i> think this is the perfect solution, because if I exclude all the false
</I>&gt;<i> positive rules there will be 2-3 maybe working rules at all :) 
</I>
That is not greatly exaggerated. We have about 150 rules in the default
install. Multiply this with the application's parameter. And then look
at the few dozens of rule/parameter exclusions we provide you with.
It's the minimal set of bricks broken out of the defense wall.

&gt;<i> Maybe they should be tunned?
</I>
Or WordPress / Drupal could be fixed to make sure they do not submit any
suspicious payloads. :)

&gt;<i> What is going on when the anomaly score is
</I>&gt;<i> higher - this I couldn&#8217;t understand - users are not blocked or what?
</I>
The anomaly score is linked to an individual request.
The anomaly threshold is the anomaly limit where you start to block
requests.

If the threshold is at 25 and a request sets of 4 critical rules, you
get 4 error entries, a score of 20 and the request passes.

Got it?

If it is still not clear, could you read the explanations in
crs-config.conf again. If you are unable to understand that, please
point it out exactly for this would be a sign or documentation is not
good enough.

Ahoj,

Christian


&gt;<i> If I understand right I can start with high anomaly score for all rule
</I>&gt;<i> with equal score until I tune them perfectly.
</I>&gt;<i> 
</I>&gt;<i> In the nginx I have ratelimits and I prefer to start with most common
</I>&gt;<i> Wordpress / Joomla hacks rule that can stop some part of the hacks,
</I>&gt;<i> because this is the biggest problem
</I>&gt;<i> 
</I>&gt;<i> Best regards, Georgi Georgiev .
</I>&gt;<i> &gt; On Aug 15, 2017, at 9:52 AM, Christian Folini
</I>&gt;<i> &gt; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Hello Georgi,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; CRS3 comes with default rule exclusions for WP and Drupal that solve
</I>&gt;<i> &gt; many of the base installations FPs. Collaborating with the project
</I>&gt;<i> &gt; on a set of Joomla rule exclusions would be most helpful.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Starting with a higher anomaly threshold while you weed out the
</I>&gt;<i> &gt; false positives is a method that I advocate in my documentation.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Making sure that you do not base your tuning efforts on attack
</I>&gt;<i> &gt; traffic is an obvious problems. There are multiple approaches to
</I>&gt;<i> &gt; this, and none of them is hard science. I usually try to start off
</I>&gt;<i> &gt; with tuning based on known IP ranges.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; This is all discussed in great detail in the series of ModSecurity
</I>&gt;<i> &gt; tutorials at <A HREF="https://www.netnea.com/cms/apache-tutorials/">https://www.netnea.com/cms/apache-tutorials/</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Besides, I am also running two public ModSec courses in October.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Good luck!
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Christian
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; On Mon, Aug 14, 2017 at 03:29:39PM +0300, Georgi Georgiev wrote:
</I>&gt;<i> &gt;&gt; Hello, I am deploying mod security with nginx in shared hosting
</I>&gt;<i> &gt;&gt; environment and most of the websites are Wordpress, Joomla and
</I>&gt;<i> &gt;&gt; drupal. I don&#8217;t want to rewrite all the rules of owasp to minimize
</I>&gt;<i> &gt;&gt; the false positives. Also, I searched for specific for Wordpress or
</I>&gt;<i> &gt;&gt; Joomla ruleset but couldn&#8217;t find such thing (it would be very
</I>&gt;<i> &gt;&gt; resourceful to research for every Wordpress and Joomla hack, even
</I>&gt;<i> &gt;&gt; the most famouse one and to write rules about it, also to read how
</I>&gt;<i> &gt;&gt; to write rules :)). Even, if I put mod security initially in a mode
</I>&gt;<i> &gt;&gt; that does not block , only to log it would be very hard to see very
</I>&gt;<i> &gt;&gt; queer if it&#8217;s false positive or whether it come from evil sources.
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; I read that right practice is to change the score of the anomaly
</I>&gt;<i> &gt;&gt; but didn&#8217;t understand it at all.
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; So, I would like to ask you how you deal with this? I know that
</I>&gt;<i> &gt;&gt; false positives will be there all the time, but how you minimize
</I>&gt;<i> &gt;&gt; them? Write your own ruleset? Is there any paid ruleset that you
</I>&gt;<i> &gt;&gt; can recommend (it think that I found only one paid and many people
</I>&gt;<i> &gt;&gt; cry from it). Just I want to explain me the process you follow with
</I>&gt;<i> &gt;&gt; the rules :)
</I>&gt;<i> &gt;&gt; 
</I>&gt;<i> &gt;&gt; Thank you in advance!
</I>&gt;<i> &gt;&gt; _______________________________________________
</I>&gt;<i> &gt;&gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt;&gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; -- <A HREF="https://www.feistyduck.com/books/modsecurity-handbook/">https://www.feistyduck.com/books/modsecurity-handbook/</A>
</I>&gt;<i> &gt; mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A> twitter: @ChrFolini
</I>
-- 
<A HREF="https://www.feistyduck.com/books/modsecurity-handbook/">https://www.feistyduck.com/books/modsecurity-handbook/</A>
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
twitter: @ChrFolini
</PRE>














<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002450.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
	<LI>Next message: <A HREF="002451.html">[Owasp-modsecurity-core-rule-set] Announcing www.coreruleset.org	and new project logo
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2438">[ date ]</a>
              <a href="thread.html#2438">[ thread ]</a>
              <a href="subject.html#2438">[ subject ]</a>
              <a href="author.html#2438">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
