<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] File upload problem
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20File%20upload%20problem&In-Reply-To=%3CCA1F8776-72DC-4AA6-A35B-E82FCA5A5C10%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002462.html">
   <LINK REL="Next"  HREF="002464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] File upload problem</H1>
    <B>spartantri at gmail.com</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20File%20upload%20problem&In-Reply-To=%3CCA1F8776-72DC-4AA6-A35B-E82FCA5A5C10%40gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] File upload problem">spartantri at gmail.com
       </A><BR>
    <I>Wed Aug 23 16:36:48 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002462.html">[Owasp-modsecurity-core-rule-set] File upload problem
</A></li>
        <LI>Next message: <A HREF="002464.html">[Owasp-modsecurity-core-rule-set] File upload problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2463">[ date ]</a>
              <a href="thread.html#2463">[ thread ]</a>
              <a href="subject.html#2463">[ subject ]</a>
              <a href="author.html#2463">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Ervin,

Maybe the modsec engine multipart body processor is not rfc compliant and confuses the CRLF-- with a boundary delimiter instead of doing a full check as described in rfcs 7578 and 2046, try removing the dashes from the beginning and end of the gpg content and if it passes that may be the reason behind this.

To fix it you may add a rule to disable 200004 for that particular URL.

But read the warnings at the documentation.

File uploads are usually risky so it maybe good if you do a full check with @inspectFile for malware viruses etc

Something like
SecRule FILES_TMPNAMES &quot;@inspectFile path/inspectscript&quot; deny..

Cheers!

Enviado desde mi iPhone

&gt;<i> El 23 ago 2017, a las 17:13, Ervin Heged&#252;s &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">airween at gmail.com</A>&gt; escribi&#243;:
</I>&gt;<i> 
</I>&gt;<i> MULTIPART_UNMATCHED_BOUNDARY
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002462.html">[Owasp-modsecurity-core-rule-set] File upload problem
</A></li>
	<LI>Next message: <A HREF="002464.html">[Owasp-modsecurity-core-rule-set] File upload problem
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2463">[ date ]</a>
              <a href="thread.html#2463">[ thread ]</a>
              <a href="subject.html#2463">[ subject ]</a>
              <a href="author.html#2463">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
