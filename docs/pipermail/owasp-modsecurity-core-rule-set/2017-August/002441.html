<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20the%20right%20process%20of%0A%20dealing%20with%20the%20false%20postivies&In-Reply-To=%3CCC9D96A5-6F02-4E32-B923-12C52CA1BA20%40serversolution.info%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002439.html">
   <LINK REL="Next"  HREF="002443.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies</H1>
    <B>Georgi Georgiev</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20the%20right%20process%20of%0A%20dealing%20with%20the%20false%20postivies&In-Reply-To=%3CCC9D96A5-6F02-4E32-B923-12C52CA1BA20%40serversolution.info%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies">georgi at serversolution.info
       </A><BR>
    <I>Tue Aug 15 12:42:08 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002439.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
        <LI>Next message: <A HREF="002443.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2441">[ date ]</a>
              <a href="thread.html#2441">[ thread ]</a>
              <a href="subject.html#2441">[ subject ]</a>
              <a href="author.html#2441">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thank you about your reply again, it was useful. First of all I would like to apologize for the stupid for you questions. Currently I see that I have the following in the config which means from what I read that I am not in anomaly mode, but in traditional:

SecDefaultAction &quot;log,deny,phase:1&quot;

So, by your recommendation I understand that I should remove this lines to start using anomaly mode. Then, on every rule I can/ should add with setvar:tx.anomaly_score=5(for example) so I can control it&#8217;s score?

Also to decrease the false positives as a second step from the setup should I increase the threshold value here - or I am wrong?

# Default Inbound Anomaly Threshold Level (rule 900110 in setup.conf)
SecRule &amp;TX:inbound_anomaly_score_threshold &quot;@eq 0&quot; \
    &quot;id:901100,\
    phase:1,\
    pass,\
    nolog,\
    setvar:tx.inbound_anomaly_score_threshold=5&quot;



&gt;<i> On Aug 15, 2017, at 9:52 AM, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hello Georgi,
</I>&gt;<i> 
</I>&gt;<i> CRS3 comes with default rule exclusions for WP and Drupal that solve
</I>&gt;<i> many of the base installations FPs. Collaborating with the project on
</I>&gt;<i> a set of Joomla rule exclusions would be most helpful.
</I>&gt;<i> 
</I>&gt;<i> Starting with a higher anomaly threshold while you weed out the false
</I>&gt;<i> positives is a method that I advocate in my documentation.
</I>&gt;<i> 
</I>&gt;<i> Making sure that you do not base your tuning efforts on attack traffic
</I>&gt;<i> is an obvious problems. There are multiple approaches to this, and none
</I>&gt;<i> of them is hard science. I usually try to start off with tuning based on
</I>&gt;<i> known IP ranges.
</I>&gt;<i> 
</I>&gt;<i> This is all discussed in great detail in the series of ModSecurity
</I>&gt;<i> tutorials at <A HREF="https://www.netnea.com/cms/apache-tutorials/">https://www.netnea.com/cms/apache-tutorials/</A>
</I>&gt;<i> 
</I>&gt;<i> Besides, I am also running two public ModSec courses in October.
</I>&gt;<i> 
</I>&gt;<i> Good luck!
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Mon, Aug 14, 2017 at 03:29:39PM +0300, Georgi Georgiev wrote:
</I>&gt;&gt;<i> Hello,
</I>&gt;&gt;<i> I am deploying mod security with nginx in shared hosting environment and most of the websites are Wordpress, Joomla and drupal. I don&#8217;t want to rewrite all the rules of owasp to minimize the false positives. Also, I searched for specific for Wordpress or Joomla ruleset but couldn&#8217;t find such thing (it would be very resourceful to research for every Wordpress and Joomla hack, even the most famouse one and to write rules about it, also to read how to write rules :)). Even, if I put mod security initially in a mode that does not block , only to log it would be very hard to see very queer if it&#8217;s false positive or whether it come from evil sources.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I read that right practice is to change the score of the anomaly but didn&#8217;t understand it at all.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> So, I would like to ask you how you deal with this? I know that false positives will be there all the time, but how you minimize them? Write your own ruleset? Is there any paid ruleset that you can recommend (it think that I found only one paid and many people cry from it). Just I want to explain me the process you follow with the rules :)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Thank you in advance!
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> <A HREF="https://www.feistyduck.com/books/modsecurity-handbook/">https://www.feistyduck.com/books/modsecurity-handbook/</A>
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> twitter: @ChrFolini
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20170815/257e6c06/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20170815/257e6c06/attachment.html</A>&gt;
</PRE>







<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002439.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
	<LI>Next message: <A HREF="002443.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2441">[ date ]</a>
              <a href="thread.html#2441">[ thread ]</a>
              <a href="subject.html#2441">[ subject ]</a>
              <a href="author.html#2441">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
