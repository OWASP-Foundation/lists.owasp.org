<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20the%20right%20process%20of%0A%20dealing%20with%20the%20false%20postivies&In-Reply-To=%3C20170818082953.f3kccas5yt3l7r35%40leander%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002449.html">
   <LINK REL="Next"  HREF="002438.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20What%20is%20the%20right%20process%20of%0A%20dealing%20with%20the%20false%20postivies&In-Reply-To=%3C20170818082953.f3kccas5yt3l7r35%40leander%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies">christian.folini at netnea.com
       </A><BR>
    <I>Fri Aug 18 08:29:53 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002449.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
        <LI>Next message: <A HREF="002438.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2450">[ date ]</a>
              <a href="thread.html#2450">[ thread ]</a>
              <a href="subject.html#2450">[ subject ]</a>
              <a href="author.html#2450">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Georgi,

On Thu, Aug 17, 2017 at 07:27:49PM +0300, Georgi Georgiev wrote:
&gt;<i>     1. Is really paranoia level 1 less false postitive for a shared hosting
</I>&gt;<i>    environment and in such time enough for protection? 
</I>
That depends on your assessment of your data, its value and the threat
model.

I think PL1 is base level of security, PL2 is security for data with
some value, PL3 is online banking, PL4 is nuclear power plant. Just as a
rough guidance. ;)


&gt;<i> Does it protect from
</I>&gt;<i>    sql injection and xss as I read that they are included in paranoia level2?
</I>
Yes, the biggest part of the SQLi protection is the use of the
libinjection library that is included in PL1.

&gt;<i>    What is the best practice - initially start with paranoia level 1, tune it
</I>&gt;<i>    and then switch to 2?
</I>
That is a very good question. In fact if you aim to run in PL2, it is
far easier to start in PL2 immediately and then tune down. The problem
is that if you run in PL1 and have tuned the service to a hard blocking
setting, the enabling of PL2 will bring you new rules, new false
positives and legitimate users being blocked.

&gt;<i>    2. What is your anomaly inbound score set? Have you changed it to
</I>&gt;<i>    something other than 5 or you leaved it to 5 and changed the score of the
</I>&gt;<i>    rules?
</I>
For a productive system it should be 5. After the tuning.

&gt;<i>    3. I am not sure how to tune the tx.score for every rule in the OWASP as
</I>&gt;<i>    they are with variables such as follow:
</I>&gt;<i>      SecRule IP:REPUT_BLOCK_FLAG &quot;@eq 1&quot; \
</I>&gt;<i>        &quot;setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},\
</I>&gt;<i>       
</I>&gt;<i>    setvar:tx.%{rule.id}-AUTOMATION/MALICIOUS-%{matched_var_name}=%{matched_var}&quot;
</I>&gt;<i>    Is this the correct default scores for the specific rulesets and attacks
</I>&gt;<i>    that I should tune?
</I>
Don't touch the rules. You only want to change the anomaly score limit
in the crs-setup.conf file - and then create your rule exclusions as
documented in the tutorials.

&gt;<i>    4. Should I adjust the percentage of requests that are funnelled into the
</I>&gt;<i>    Core Rules below 100 as it&#226;**s recommended on some pages? Does this affect
</I>&gt;<i>    the false positives or only the performance?
</I>
This is a feature that is only useful when gauging the performance
impact of ModSec / CRS. You definitely need to have this at 100 or an
attacker can submit an exploit n times and eventually he will bypasss
the rule set based on your sampling rate being below 100%.

Ahoj,

Christian


-- 
History teaches us that men and nations behave wisely once they have
exhausted all other alternatives.
-- Abba Eban
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002449.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
	<LI>Next message: <A HREF="002438.html">[Owasp-modsecurity-core-rule-set] What is the right process of dealing with the false postivies
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2450">[ date ]</a>
              <a href="thread.html#2450">[ thread ]</a>
              <a href="subject.html#2450">[ subject ]</a>
              <a href="author.html#2450">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
