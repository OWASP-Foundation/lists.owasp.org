<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Updating pattern for chained rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20pattern%20for%20chained%0A%20rule&In-Reply-To=%3C558D3D6F.7040908%40kyoshiro.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001775.html">
   <LINK REL="Next"  HREF="001777.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule</H1>
    <B>Lo&#239;c Gomez</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20pattern%20for%20chained%0A%20rule&In-Reply-To=%3C558D3D6F.7040908%40kyoshiro.org%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule">owasp-crs at kyoshiro.org
       </A><BR>
    <I>Fri Jun 26 11:54:23 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001775.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule
</A></li>
        <LI>Next message: <A HREF="001777.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained	rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1776">[ date ]</a>
              <a href="thread.html#1776">[ thread ]</a>
              <a href="subject.html#1776">[ subject ]</a>
              <a href="author.html#1776">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Le 26/06/2015 13:06, Adri&#225;n a &#233;crit :
&gt;<i> Hi all,
</I>&gt;<i>
</I>&gt;<i> I've been lately trying (and failing) to update the pattern a chained rule matches against
</I>&gt;<i> when certain URI or ARG name are found. Here is the rule I am trying to update:
</I>&gt;<i> <A HREF="https://gist.github.com/anonymous/18c2a881a3277009fe79.">https://gist.github.com/anonymous/18c2a881a3277009fe79.</A>
</I>&gt;<i>
</I>&gt;<i> The desire would be, without directly modifying the CRS rule, update it not to match on a
</I>&gt;<i> set of domains considered safe/internal. I've thought about it for a while and couldn't
</I>&gt;<i> come up with something that worked. I guess that if I could append another chained rule to
</I>&gt;<i> it, since it'd make a logical AND I could use !@contains(mydomain). Is that or another
</I>&gt;<i> solution possible?
</I>&gt;<i>
</I>&gt;<i> Any help welcome!
</I>&gt;<i> Thanks
</I>
Hi,

When you update an action for a chained rule you need to append &quot;,chain&quot; again in order for
the rule to work properly.
This is a known &quot;bug&quot; as indicated here :
<A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#secruleupdateactionbyid">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#secruleupdateactionbyid</A>

Best regards
Lo&#239;c Gomez
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001775.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule
</A></li>
	<LI>Next message: <A HREF="001777.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained	rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1776">[ date ]</a>
              <a href="thread.html#1776">[ thread ]</a>
              <a href="subject.html#1776">[ subject ]</a>
              <a href="author.html#1776">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
