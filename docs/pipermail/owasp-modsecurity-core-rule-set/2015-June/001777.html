<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Updating pattern for chained	rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20pattern%20for%20chained%0A%09rule&In-Reply-To=%3CCAFDTedq8Sybia4ciL_mHYr3%3DiCzr9x91e2JoduTtMv2tre1S3w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001776.html">
   <LINK REL="Next"  HREF="001778.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Updating pattern for chained	rule</H1>
    <B>Adri&#225;n</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Updating%20pattern%20for%20chained%0A%09rule&In-Reply-To=%3CCAFDTedq8Sybia4ciL_mHYr3%3DiCzr9x91e2JoduTtMv2tre1S3w%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Updating pattern for chained	rule">adrianbn at gmail.com
       </A><BR>
    <I>Fri Jun 26 12:04:31 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001776.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule
</A></li>
        <LI>Next message: <A HREF="001778.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1777">[ date ]</a>
              <a href="thread.html#1777">[ thread ]</a>
              <a href="subject.html#1777">[ subject ]</a>
              <a href="author.html#1777">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Loic,

I still can't figure out how to update the target pattern. Would you be
able to provide an example I can use as template? Thank you!

El vie., 26 jun. 2015 a las 13:02, Lo&#239;c Gomez (&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-crs at kyoshiro.org</A>&gt;)
escribi&#243;:

&gt;<i> Le 26/06/2015 13:06, Adri&#225;n a &#233;crit :
</I>&gt;<i> &gt; Hi all,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; I've been lately trying (and failing) to update the pattern a chained
</I>&gt;<i> rule matches against
</I>&gt;<i> &gt; when certain URI or ARG name are found. Here is the rule I am trying to
</I>&gt;<i> update:
</I>&gt;<i> &gt; <A HREF="https://gist.github.com/anonymous/18c2a881a3277009fe79.">https://gist.github.com/anonymous/18c2a881a3277009fe79.</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The desire would be, without directly modifying the CRS rule, update it
</I>&gt;<i> not to match on a
</I>&gt;<i> &gt; set of domains considered safe/internal. I've thought about it for a
</I>&gt;<i> while and couldn't
</I>&gt;<i> &gt; come up with something that worked. I guess that if I could append
</I>&gt;<i> another chained rule to
</I>&gt;<i> &gt; it, since it'd make a logical AND I could use !@contains(mydomain). Is
</I>&gt;<i> that or another
</I>&gt;<i> &gt; solution possible?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any help welcome!
</I>&gt;<i> &gt; Thanks
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> When you update an action for a chained rule you need to append &quot;,chain&quot;
</I>&gt;<i> again in order for
</I>&gt;<i> the rule to work properly.
</I>&gt;<i> This is a known &quot;bug&quot; as indicated here :
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#secruleupdateactionbyid">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#secruleupdateactionbyid</A>
</I>&gt;<i>
</I>&gt;<i> Best regards
</I>&gt;<i> Lo&#239;c Gomez
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150626/da9b31d7/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150626/da9b31d7/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001776.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule
</A></li>
	<LI>Next message: <A HREF="001778.html">[Owasp-modsecurity-core-rule-set] Updating pattern for chained rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1777">[ date ]</a>
              <a href="thread.html#1777">[ thread ]</a>
              <a href="subject.html#1777">[ subject ]</a>
              <a href="author.html#1777">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
