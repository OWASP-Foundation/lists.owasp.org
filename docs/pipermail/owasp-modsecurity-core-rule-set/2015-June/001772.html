<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Ignore URI From Scanning
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Ignore%20URI%20From%20Scanning&In-Reply-To=%3CD1A0A5F2.9213%25csanders%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001771.html">
   <LINK REL="Next"  HREF="001773.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Ignore URI From Scanning</H1>
    <B>Chaim Sanders</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Ignore%20URI%20From%20Scanning&In-Reply-To=%3CD1A0A5F2.9213%25csanders%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Ignore URI From Scanning">CSanders at trustwave.com
       </A><BR>
    <I>Fri Jun 12 19:08:18 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001771.html">[Owasp-modsecurity-core-rule-set] Ignore URI From Scanning
</A></li>
        <LI>Next message: <A HREF="001773.html">[Owasp-modsecurity-core-rule-set] Searchable ruleset list
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>At this point, I&#8217;m not exactly sure what you&#8217;re asking for. But as rules are processed in a precise order (by phase and by conf) you can either use SecMarker to skip to after the processing of a certain set of rules or you could reenable requestBodyAccess as soon as you have triggered another rule which might be after all the rules you don&#8217;t want run. Hopefully this helps.

From: Joshua Roback &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jroback at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jroback at gmail.com</A>&gt;&gt;
Date: Friday, June 12, 2015 at 10:27 AM
To: Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">csanders at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">csanders at trustwave.com</A>&gt;&gt;, &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] Ignore URI From Scanning

That would work for items within the URI as I need it to, but wouldn't it also ignore for data in the request body via POST?


On Fri, Jun 12, 2015 at 10:11 AM Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt;&gt; wrote:
There is in fact access to the requestBodyAccess directive from ctl&#8230; See <A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl&lt;http://scanmail.trustwave.com/?c=4062&amp;d=x-z61WLVKy82sGToPcXlosLPCkYEyRZf-V9joextqQ&amp;s=5&amp;u=https%3a%2f%2fgithub%2ecom%2fSpiderLabs%2fModSecurity%2fwiki%2fReference-Manual%23ctl">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl&lt;http://scanmail.trustwave.com/?c=4062&amp;d=x-z61WLVKy82sGToPcXlosLPCkYEyRZf-V9joextqQ&amp;s=5&amp;u=https%3a%2f%2fgithub%2ecom%2fSpiderLabs%2fModSecurity%2fwiki%2fReference-Manual%23ctl</A>&gt;. You can use it in much the same way you could use RuleEngine. Hope this solves your problem.

Chaim Sanders
Security Researcher, SpiderLabs

Trustwave| SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: Joshua Roback [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jroback at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jroback at gmail.com</A>&gt;]
Sent: Friday, June 12, 2015 10:08 AM

To: Chaim Sanders; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] Ignore URI From Scanning

Thanks Chaim.
The ideal situation would be if there was a URI equivalent of

SecResponseBodyAccess Off


I can't always provide a URL string to match against and I don't want to disable all rules since it's only the URI that's encrypted at the application layer.  Everything else is simple SSL/TLS which I can decrypt without problem.

On Fri, Jun 12, 2015 at 10:02 AM Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt;&gt; wrote:
That will cause all rules to be skipped every time that rule is triggered which will be whenever there is a request that matches that rule. If you want to skip it altogether you can only run ModSec rules on a particular &lt;Location&gt; (see the following example: <A HREF="https://www.digitalocean.com/community/tutorials/how-to-set-up-mod_security-with-apache-on-debian-ubuntu&lt;http://scanmail.trustwave.com/?c=4062&amp;d=x-z61WLVKy82sGToPcXlosLPCkYEyRZf-VNn-LJp8g&amp;s=5&amp;u=https%3a%2f%2fwww%2edigitalocean%2ecom%2fcommunity%2ftutorials%2fhow-to-set-up-mod%5fsecurity-with-apache-on-debian-ubuntu">https://www.digitalocean.com/community/tutorials/how-to-set-up-mod_security-with-apache-on-debian-ubuntu&lt;http://scanmail.trustwave.com/?c=4062&amp;d=x-z61WLVKy82sGToPcXlosLPCkYEyRZf-VNn-LJp8g&amp;s=5&amp;u=https%3a%2f%2fwww%2edigitalocean%2ecom%2fcommunity%2ftutorials%2fhow-to-set-up-mod%5fsecurity-with-apache-on-debian-ubuntu</A>&gt;)

Chaim Sanders
Security Researcher, SpiderLabs

Trustwave| SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: Joshua Roback [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jroback at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jroback at gmail.com</A>&gt;]
Sent: Friday, June 12, 2015 9:57 AM
To: Chaim Sanders; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] Ignore URI From Scanning

Wouldn't that bypass all future rules from scanning that same HTTP transactions?

On Fri, Jun 12, 2015 at 9:44 AM Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt;&gt; wrote:
You could use the &#8216;ctl&#8217; action to disable the engine after a certain rule triggers, thereby skipping the rest of the checks. You could also place this in a virtual host area if needed.

SecRule REQUEST_URI &quot;@contains /encryptedbit/&quot; &quot;phase:1,t:none,pass, nolog,ctl:ruleEngine=Off&#8221;

Chaim Sanders
Security Researcher, SpiderLabs

Trustwave| SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt; [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt;] On Behalf Of Joshua Roback
Sent: Friday, June 12, 2015 9:16 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: [Owasp-modsecurity-core-rule-set] Ignore URI From Scanning

Hello Group,
I'm come across an issue in which I'll be using ModSecurity to protect a site with an encrypted URI.  For the sake of reducing false positives, what would be the most effective way to omit the URI from scanning but continue to scan other HTTP header fields and all payloads?

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150612/7f409cfc/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150612/7f409cfc/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001771.html">[Owasp-modsecurity-core-rule-set] Ignore URI From Scanning
</A></li>
	<LI>Next message: <A HREF="001773.html">[Owasp-modsecurity-core-rule-set] Searchable ruleset list
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1772">[ date ]</a>
              <a href="thread.html#1772">[ thread ]</a>
              <a href="subject.html#1772">[ subject ]</a>
              <a href="author.html#1772">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
