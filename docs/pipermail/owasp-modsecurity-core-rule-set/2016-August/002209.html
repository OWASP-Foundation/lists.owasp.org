<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS3-RC1 not working on	Apache 2.2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS3-RC1%20not%20working%20on%0A%09Apache%202.2&In-Reply-To=%3C20160822053551.GB12726%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002207.html">
   <LINK REL="Next"  HREF="002210.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS3-RC1 not working on	Apache 2.2</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS3-RC1%20not%20working%20on%0A%09Apache%202.2&In-Reply-To=%3C20160822053551.GB12726%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS3-RC1 not working on	Apache 2.2">christian.folini at netnea.com
       </A><BR>
    <I>Mon Aug 22 05:35:51 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002207.html">[Owasp-modsecurity-core-rule-set] CRS3-RC1 not working on	Apache 2.2
</A></li>
        <LI>Next message: <A HREF="002210.html">[Owasp-modsecurity-core-rule-set] CRS3-RC1 not working on	Apache 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2209">[ date ]</a>
              <a href="thread.html#2209">[ thread ]</a>
              <a href="subject.html#2209">[ subject ]</a>
              <a href="author.html#2209">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good morning Jens,

On Sun, Aug 21, 2016 at 12:48:32PM +0200, Jens Schleusener wrote:
&gt;<i> One reason for the &quot;silence&quot; may be also the very laborious log file
</I>&gt;<i> analysis.
</I>&gt;<i> 
</I>&gt;<i> But to get just a first impression I found your script aliases collection at
</I>&gt;<i> 
</I>&gt;<i>  <A HREF="https://github.com/Apache-Labor/labor/blob/master/bin/.apache-modsec.alias">https://github.com/Apache-Labor/labor/blob/master/bin/.apache-modsec.alias</A>
</I>&gt;<i> 
</I>&gt;<i> very useful.
</I>
Thanks. I should probably cover them in a blogpost. Right now they seem
to be a bit of a secret to those who have read my (German) tutorials.

&gt;<i> On the server that I manage (httpd 2.4.23, modsecurity 2.9.1)
</I>&gt;<i> CRS3-RC1 is now for nearly a month in use and it works very well
</I>&gt;<i> (big thanks to the CRS3 team!).
</I>
Glad it works!

&gt;<i> Although the server may be not
</I>&gt;<i> &quot;typical&quot; since it uses itself neither PHP nor SQL but offers
</I>&gt;<i> amongst others soure code browsing of FOSS software that contains
</I>&gt;<i> for e.g. PHP, SQL and HTML files here an example output for 5 days
</I>&gt;<i> (with roughly 200.000 page requests in total) using the script alias
</I>&gt;<i> &quot;melidmsg&quot; (entries fom some special self-written rules are
</I>&gt;<i> removed):
</I>&gt;<i> 
</I>&gt;<i> cat modsec_audit.log.16081[5-9] | melidmsg | sort | uniq -c | sort -nr
</I>
I guess you are aware of the alias 'sucs' and use the sort-uniq-c-sort
combination here to make it more comprehensive for the other readers.

&gt;<i>     347 921140 HTTP Header Injection Attack via headers
</I>&gt;<i>     308 910000 Request from Known Malicious Client
</I>&gt;<i>                (Based on previous traffic violations).
</I>&gt;<i>     186 920350 Host header is a numeric IP address
</I>&gt;<i>     105 932130 Remote Command Execution: Unix Shell Expression Found
</I>&gt;<i> ...
</I>
All in all, this is quite a big collection of alerts for 200K requests.
Your site is special of course, but would this special content really
affect the requests that much. Would not that be more a problem with
the responses?

There are a rules which point to a  real positive. But with many others,
we might face false positives. Did you investigate further, or do you
think they point to malign requests?

&gt;<i> Found&quot;) in some cases seems to cause FPs (especially for the
</I>&gt;<i> User-Agent &quot;Go-http-client/1.1&quot; that sends erroneously a
</I>&gt;<i> &quot;Connection: close, close&quot; HTTP header).
</I>
Would you please be so kind and open an issue on the github site for
this false positive? Ideally including a full audit log entry for the
request.

Thank you for your detailed report.

Cheers,

Christian


-- 
If it could be proved that two plus two is five, then it could be 
proved that five is not five, and then there would be no claim that 
could not be proved, and math would be a lot of bunk.
-- George Boolos
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002207.html">[Owasp-modsecurity-core-rule-set] CRS3-RC1 not working on	Apache 2.2
</A></li>
	<LI>Next message: <A HREF="002210.html">[Owasp-modsecurity-core-rule-set] CRS3-RC1 not working on	Apache 2.2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2209">[ date ]</a>
              <a href="thread.html#2209">[ thread ]</a>
              <a href="subject.html#2209">[ subject ]</a>
              <a href="author.html#2209">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
