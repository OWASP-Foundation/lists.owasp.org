<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] false positives by wrong URL Decoding ?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20false%20positives%20by%20wrong%20URL%0A%20Decoding%20%3F&In-Reply-To=%3C20160824195900.GA27733%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002196.html">
   <LINK REL="Next"  HREF="002197.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] false positives by wrong URL Decoding ?</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20false%20positives%20by%20wrong%20URL%0A%20Decoding%20%3F&In-Reply-To=%3C20160824195900.GA27733%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] false positives by wrong URL Decoding ?">christian.folini at netnea.com
       </A><BR>
    <I>Wed Aug 24 19:59:00 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002196.html">[Owasp-modsecurity-core-rule-set] false positives by wrong URL	Decoding ?
</A></li>
        <LI>Next message: <A HREF="002197.html">[Owasp-modsecurity-core-rule-set] OWASP CRS Version 3.0 RC1 Released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2217">[ date ]</a>
              <a href="thread.html#2217">[ thread ]</a>
              <a href="subject.html#2217">[ subject ]</a>
              <a href="author.html#2217">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Marco,

Truth be told, ModSecurity and especially the Core Rules are not very 
good at handling UTF8. Basic support is there, but it is really quite
limited and the Core Rules bring you a lot of false positives with
UTF-8 encoded requests.

This might be less the case with the upcoming Core Rules 3 release, but
I would not be surprised if that would continue to be a weak spot.

The rule in question has been updated for Core Rules 3.0.
It has the number 942330 now. The regex is now

&quot;(?i:(?:[\&quot;'`]\s*?(x?or|div|like|between|and)\s*?[\&quot;'`]?\d)|(?:\\\\x(?:23|27|3d))|(?:^.?[\&quot;'`]$)|(?:(?:^[\&quot;'`\\\\]*?(?:[\d\&quot;'`]+|[^\&quot;'`]+[\&quot;'`]))+\s*?(?:n?and|x?x?or|div|like|between|and|not|\|\||\&amp;\&amp;)\s*?[\w\&quot;'`][+&amp;!@(),.-])|(?:[^\w\s]\w+\s*?[|-]\s*?[\&quot;'`]\s*?\w)|(?:@\w+\s+(and|x?or|div|like|between|and)\s*?[\&quot;'`\d]+)|(?:@[\w-]+\s(and|x?or|div|like|between|and)\s*?[^\w\s])|(?:[^\w\s:]\s*?\d\W+[^\w\s]\s*?[\&quot;'`].)|(?:\Winformation_schema|table_name\W))&quot;

Would you be so kind and give this a shot.

If you still get a false positive, when we need to open an issue
on github and tag it with false positive.

Sorry for the inconvenience (and the delay with responding).

Ahoj,

Christian



On Tue, Aug 16, 2016 at 02:43:52PM +0200, Marco Wagner wrote:
&gt;<i> Hi @ all,
</I>&gt;<i> 
</I>&gt;<i> I have a question you can read on stackoverflow regarding false
</I>&gt;<i> positives when greek or russian characters are used in the requests
</I>&gt;<i> of our web services.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="http://stackoverflow.com/questions/38974102/modsecurity-owasp-core-rule-set-unicode-false-positive">http://stackoverflow.com/questions/38974102/modsecurity-owasp-core-rule-set-unicode-false-positive</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Would love to hear from you.
</I>&gt;<i> 
</I>&gt;<i> PS: I subscribed to the list a few minutes ago, I also confirmed my email.
</I>&gt;<i> 
</I>&gt;<i> Best regards,
</I>&gt;<i> Marco Wagner
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002196.html">[Owasp-modsecurity-core-rule-set] false positives by wrong URL	Decoding ?
</A></li>
	<LI>Next message: <A HREF="002197.html">[Owasp-modsecurity-core-rule-set] OWASP CRS Version 3.0 RC1 Released
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2217">[ date ]</a>
              <a href="thread.html#2217">[ thread ]</a>
              <a href="subject.html#2217">[ subject ]</a>
              <a href="author.html#2217">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
