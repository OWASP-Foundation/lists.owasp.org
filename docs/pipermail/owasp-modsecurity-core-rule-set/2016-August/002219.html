<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Windows IIS	ModSecurity	2.9.1	SecRuleEngine DetectionOnly SOULUTION
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Windows%20IIS%0A%09ModSecurity%092.9.1%09SecRuleEngine%20DetectionOnly%20SOULUTION&In-Reply-To=%3Cb2218ec6b7404420850b714274fe1442%40JMC3112.jmcmail.ch%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002216.html">
   <LINK REL="Next"  HREF="002220.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Windows IIS	ModSecurity	2.9.1	SecRuleEngine DetectionOnly SOULUTION</H1>
    <B>Steffen H&#246;hne</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Windows%20IIS%0A%09ModSecurity%092.9.1%09SecRuleEngine%20DetectionOnly%20SOULUTION&In-Reply-To=%3Cb2218ec6b7404420850b714274fe1442%40JMC3112.jmcmail.ch%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Windows IIS	ModSecurity	2.9.1	SecRuleEngine DetectionOnly SOULUTION">steffen.hoehne at jmc-software.ch
       </A><BR>
    <I>Thu Aug 25 07:09:40 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002216.html">[Owasp-modsecurity-core-rule-set] Windows IIS ModSecurity	2.9.1	SecRuleEngine DetectionOnly
</A></li>
        <LI>Next message: <A HREF="002220.html">[Owasp-modsecurity-core-rule-set] OWASP CRS Version 3.0 RC1 Rules	930100, 930110
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2219">[ date ]</a>
              <a href="thread.html#2219">[ thread ]</a>
              <a href="subject.html#2219">[ subject ]</a>
              <a href="author.html#2219">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Found the solution: <A HREF="https://github.com/SpiderLabs/ModSecurity/issues/538">https://github.com/SpiderLabs/ModSecurity/issues/538</A>

add to modsecurity.conf
# Configures the ability to use stream inspection for inbound request data in a re-allocable buffer.
# For security reasons we are still buffering the stream.
SecStreamInBodyInspection On


That solve the problem for me.

Thank you

Freundliche Gr&#252;sse
Steffen H&#246;hne
System Engineer
--------------------------------------------------------------------------------------------------------------
JMC Software AG * Riedstrasse 1 * 6343 Rotkreuz * Switzerland
Phone: +41 41 799 02 12
Internet: <A HREF="http://www.jmc-software.ch&lt;http://www.jmc-software.ch/">http://www.jmc-software.ch&lt;http://www.jmc-software.ch/</A>&gt; * Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">sh at JMC-Software.ch</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">sh at JMC-Software.ch</A>&gt;
--------------------------------------------------------------------------------------------------------------



From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Steffen H&#246;hne
Sent: Donnerstag, 25. August 2016 08:41
To: '<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] Windows IIS ModSecurity 2.9.1 SecRuleEngine DetectionOnly

Guys

Something new with that problem.

If I turn SecRequestBodyAccess off - it works without a problem.

SecRuleEngine DetectionOnly and SecRequestBodyAccess On doesn't work.

May that help you - but that's not a solution :-/

Thanks

Freundliche Gr&#252;sse
Steffen H&#246;hne
System Engineer
--------------------------------------------------------------------------------------------------------------
JMC Software AG * Riedstrasse 1 * 6343 Rotkreuz * Switzerland
Phone: +41 41 799 02 12
Internet: <A HREF="http://www.jmc-software.ch&lt;http://www.jmc-software.ch/">http://www.jmc-software.ch&lt;http://www.jmc-software.ch/</A>&gt; * Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">sh at JMC-Software.ch</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">sh at JMC-Software.ch</A>&gt;
--------------------------------------------------------------------------------------------------------------



From: Chaim Sanders [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>]
Sent: Mittwoch, 24. August 2016 17:34
To: Steffen H&#246;hne &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">steffen.hoehne at jmc-software.ch</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">steffen.hoehne at jmc-software.ch</A>&gt;&gt;; '<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: RE: [Owasp-modsecurity-core-rule-set] Windows IIS ModSecurity 2.9.1 SecRuleEngine DetectionOnly

This is very suspicious activity - I will boot up a test machine and verify it if I can - what version of IIS are you using? Are you using CRS?

Chaim Sanders
Security Researcher, SpiderLabs

Trustwave| SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt; [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Steffen H&#246;hne
Sent: Wednesday, August 24, 2016 11:00 AM
To: '<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>'
Subject: [Owasp-modsecurity-core-rule-set] Windows IIS ModSecurity 2.9.1 SecRuleEngine DetectionOnly

Hello guys

thank you for this great solution :)

Our system: Windows server 2012 standard x64 with iis
Modsecurity 2.9.1 with the latest ruleset
SecRuleEngine: DetectionOnly
web.config: &lt;ModSecurity enabled=&quot;true&quot; configFile=&quot;C:\Program Files\ModSecurity IIS\modsecurity_iis.conf&quot; /&gt;

Problem: We have a login screen at our  nopcommerce webshop - with modecurity enabled and  DetectionOnly  it isn't possible to login.
There is no warning log in the windows eventviewer. The login just redirect back to the login page.

If I turn SecRuleEngine Off and recycle the apppool and try again ... tatatata it works :)

Login URL is: <A HREF="http://admin.domain.tld/login?ReturnUrl=%2fadmin">http://admin.domain.tld/login?ReturnUrl=%2fadmin</A>

I think &quot;SecRuleEngine DetectionOnly&quot;  shouldn't block - just write an event.

Do you have any soultion for me?

Thank you


Freundliche Gr&#252;sse
Steffen H&#246;hne
System Engineer
--------------------------------------------------------------------------------------------------------------
JMC Software AG * Riedstrasse 1 * 6343 Rotkreuz * Switzerland
Phone: +41 41 799 02 12
Internet: <A HREF="http://www.jmc-software.ch&lt;http://scanmail.trustwave.com/?c=4062&amp;d=87291xk-bECw0KTtqHdUQmJvRvkcBlUrb9ddFEQ1VA&amp;s=5&amp;u=http%3a%2f%2fwww%2ejmc-software%2ech%2f">http://www.jmc-software.ch&lt;http://scanmail.trustwave.com/?c=4062&amp;d=87291xk-bECw0KTtqHdUQmJvRvkcBlUrb9ddFEQ1VA&amp;s=5&amp;u=http%3a%2f%2fwww%2ejmc-software%2ech%2f</A>&gt; * Email: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">sh at JMC-Software.ch</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">sh at JMC-Software.ch</A>&gt;
--------------------------------------------------------------------------------------------------------------


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160825/0c7a3121/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160825/0c7a3121/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002216.html">[Owasp-modsecurity-core-rule-set] Windows IIS ModSecurity	2.9.1	SecRuleEngine DetectionOnly
</A></li>
	<LI>Next message: <A HREF="002220.html">[Owasp-modsecurity-core-rule-set] OWASP CRS Version 3.0 RC1 Rules	930100, 930110
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2219">[ date ]</a>
              <a href="thread.html#2219">[ thread ]</a>
              <a href="subject.html#2219">[ subject ]</a>
              <a href="author.html#2219">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
