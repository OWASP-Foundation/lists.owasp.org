<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] How to enable BLOCK on a single	CRS rule?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20How%20to%20enable%20BLOCK%20on%20a%20single%0A%09CRS%20rule%3F&In-Reply-To=%3C2D8620FFA11CD047B8E51A5ECE45A775083FA325%40PMEXGMB01.juniper.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001232.html">
   <LINK REL="Next"  HREF="001234.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] How to enable BLOCK on a single	CRS rule?</H1>
    <B>Nair, Praveen</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20How%20to%20enable%20BLOCK%20on%20a%20single%0A%09CRS%20rule%3F&In-Reply-To=%3C2D8620FFA11CD047B8E51A5ECE45A775083FA325%40PMEXGMB01.juniper.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] How to enable BLOCK on a single	CRS rule?">PNair at barclaycardus.com
       </A><BR>
    <I>Mon Oct 22 19:01:13 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001232.html">[Owasp-modsecurity-core-rule-set] encoding
</A></li>
        <LI>Next message: <A HREF="001234.html">[Owasp-modsecurity-core-rule-set] A suggestion for modsecurity crs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1233">[ date ]</a>
              <a href="thread.html#1233">[ thread ]</a>
              <a href="subject.html#1233">[ subject ]</a>
              <a href="author.html#1233">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Team,

I would appreciate your help. I would like to know if there is a possibility to BLOCK ONLY ONE rule in ModSecurity if it is configured to &quot;Log Only&quot; mode? Appreciate your help

With Best Regards,

Praveen Nair, CISSP, CISM, CRISC
IT Security Consultant 

Company Confidential

-----Original Message-----
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-request at lists.owasp.org</A>
Sent: Monday, October 22, 2012 8:00 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Owasp-modsecurity-core-rule-set Digest, Vol 43, Issue 10

Send Owasp-modsecurity-core-rule-set mailing list submissions to
	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>

To subscribe or unsubscribe via the World Wide Web, visit
	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

or, via email, send a message with subject or body 'help' to
	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-request at lists.owasp.org</A>

You can reach the person managing the list at
	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-owner at lists.owasp.org</A>

When replying, please edit your Subject line so it is more specific than &quot;Re: Contents of Owasp-modsecurity-core-rule-set digest...&quot;


Today's Topics:

   1. Re: encoding (Achim)


----------------------------------------------------------------------

Message: 1
Date: Sun, 21 Oct 2012 19:02:57 +0200
From: Achim &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp at sic-sec.org</A>&gt;
To: Iman Vakili &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ivakili at yahoo.com</A>&gt;
Cc: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&quot;
	&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] encoding
Message-ID: &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">50842AC1.6020605 at sic-sec.org</A>&gt;
Content-Type: text/plain; charset=UTF-8

Hi,

the encoding is not relevant as all is 7-bit US-ASCII accoding the specifications of HTTP. Anything else must be URL-encoded using %HH notation. You don't need to struggle with any character set.
Consequentially all (most) rules detect non-ASCII and block, as it's considered harmful according specifications.
Things can be different in multipart POST data.

However, you can build your own rules to handle such characters if you want to make more detailed checks based on specific character sets.

God luck
Achim

Am 21.10.2012 10:07, schrieb Iman Vakili:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> I have a big problem about how mod_security interpret other encodings 
</I>&gt;<i> like iso-8859-1, when I'm sending non ASCII characters like characters 
</I>&gt;<i> from other languages (e.g my name: ????? )  when the encoding page is 
</I>&gt;<i> iso-8859-1(Western European, which is Firefox default browsing 
</I>&gt;<i> encoding for example) then the data will encoded in html and then 
</I>&gt;<i> transfer to the server (e.g myname: 
</I>&gt;<i> &#1575;&#1740;&#1605;&#1575;&#1606;), so I thought I can use 
</I>&gt;<i> t:htmlentitydecode to handle the problem but when I was checking my 
</I>&gt;<i> name I noticed that this transformation function does not work 
</I>&gt;<i> properly, it changes my name to { '\xccE'F }. I think if the function 
</I>&gt;<i> develop to change this kind of data to Unicode then it will be the 
</I>&gt;<i> best (like the new utf8tounicode function) There are more problems for 
</I>&gt;<i> example when there is a &quot;windows-1256&quot; encoded web application, my 
</I>&gt;<i> name became: %C7%26%231740%3B%E3%C7%E4, in this encoding words doesn't 
</I>&gt;<i> match with PCRE, for example we have \w regex in many rules,  these 
</I>&gt;<i> characters won't match to \w because of PCRE nature (which is ASCII or 
</I>&gt;<i> UTF8 base), I recommend to write a transformation function for these 
</I>&gt;<i> encodings too,
</I>&gt;<i> 
</I>&gt;<i> Thanks and best regards
</I>&gt;<i> 
</I>&gt;<i> ~IMAN
</I>

------------------------------

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>


End of Owasp-modsecurity-core-rule-set Digest, Vol 43, Issue 10
***************************************************************



Barclaycard
www.barclaycardus.com 

This email and any files transmitted with it may contain confidential and/or proprietary information. It is intended solely for the use of the individual or entity who is the intended recipient. Unauthorized use of this information is prohibited. If you have received this in error, please contact the sender by replying to this message and delete this material from any system it may be on.


</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001232.html">[Owasp-modsecurity-core-rule-set] encoding
</A></li>
	<LI>Next message: <A HREF="001234.html">[Owasp-modsecurity-core-rule-set] A suggestion for modsecurity crs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1233">[ date ]</a>
              <a href="thread.html#1233">[ thread ]</a>
              <a href="subject.html#1233">[ subject ]</a>
              <a href="author.html#1233">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
