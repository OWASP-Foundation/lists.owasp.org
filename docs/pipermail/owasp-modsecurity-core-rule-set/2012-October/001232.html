<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] encoding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20encoding&In-Reply-To=%3C50842AC1.6020605%40sic-sec.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001231.html">
   <LINK REL="Next"  HREF="001233.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] encoding</H1>
    <B>Achim</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20encoding&In-Reply-To=%3C50842AC1.6020605%40sic-sec.org%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] encoding">owasp at sic-sec.org
       </A><BR>
    <I>Sun Oct 21 17:02:57 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001231.html">[Owasp-modsecurity-core-rule-set] encoding
</A></li>
        <LI>Next message: <A HREF="001233.html">[Owasp-modsecurity-core-rule-set] How to enable BLOCK on a single	CRS rule?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1232">[ date ]</a>
              <a href="thread.html#1232">[ thread ]</a>
              <a href="subject.html#1232">[ subject ]</a>
              <a href="author.html#1232">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

the encoding is not relevant as all is 7-bit US-ASCII accoding the specifications
of HTTP. Anything else must be URL-encoded using %HH notation. You don't need to
struggle with any character set.
Consequentially all (most) rules detect non-ASCII and block, as it's considered
harmful according specifications.
Things can be different in multipart POST data.

However, you can build your own rules to handle such characters if you want to make
more detailed checks based on specific character sets.

God luck
Achim

Am 21.10.2012 10:07, schrieb Iman Vakili:
&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Hi
</I>&gt;<i> 
</I>&gt;<i> I have a big problem about how mod_security interpret other encodings like iso-8859-1,
</I>&gt;<i> when I'm sending non ASCII characters like characters from other languages (e.g my name: &#1575;&#1740;&#1605;&#1575;&#1606; )  when the encoding page is iso-8859-1(Western European, which is Firefox default browsing encoding for example) then the data will encoded in html and then transfer to the server (e.g myname: &#1575;&#1740;&#1605;&#1575;&#1606;), so I thought I can use t:htmlentitydecode to handle the problem but when I was checking my name I noticed that this transformation function does not work properly, it changes my name to { '\xccE'F }. I think if the function develop to change this kind of data to Unicode then it will be the best (like the new utf8tounicode function)
</I>&gt;<i> There are more problems for example when there is a &quot;windows-1256&quot; encoded web application, my name became: %C7%26%231740%3B%E3%C7%E4, in this encoding words doesn't match with PCRE, for example we have \w regex in many rules,  these characters won't match to \w because of PCRE nature (which is ASCII or UTF8 base), I recommend to write a transformation function for these encodings too, 
</I>&gt;<i> 
</I>&gt;<i> Thanks and best regards
</I>&gt;<i> 
</I>&gt;<i> ~IMAN 
</I></PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001231.html">[Owasp-modsecurity-core-rule-set] encoding
</A></li>
	<LI>Next message: <A HREF="001233.html">[Owasp-modsecurity-core-rule-set] How to enable BLOCK on a single	CRS rule?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1232">[ date ]</a>
              <a href="thread.html#1232">[ thread ]</a>
              <a href="subject.html#1232">[ subject ]</a>
              <a href="author.html#1232">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
