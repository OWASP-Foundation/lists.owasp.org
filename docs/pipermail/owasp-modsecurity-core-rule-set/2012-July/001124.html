<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] SQL Keyword Anomaly Scoring
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SQL%20Keyword%20Anomaly%20Scoring&In-Reply-To=%3CCC2EDFA7.3FAEA%25scanell%40jpl.nasa.gov%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001123.html">
   <LINK REL="Next"  HREF="001126.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] SQL Keyword Anomaly Scoring</H1>
    <B>Canell, Stephen E (2240)</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SQL%20Keyword%20Anomaly%20Scoring&In-Reply-To=%3CCC2EDFA7.3FAEA%25scanell%40jpl.nasa.gov%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] SQL Keyword Anomaly Scoring">stephen.e.canell at jpl.nasa.gov
       </A><BR>
    <I>Fri Jul 20 17:13:22 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001123.html">[Owasp-modsecurity-core-rule-set] DOS_Protection Problem: Could not set variable &quot;ip.dos_counter&quot; as the collection does not exist.
</A></li>
        <LI>Next message: <A HREF="001126.html">[Owasp-modsecurity-core-rule-set] SQL Keyword Anomaly Scoring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1124">[ date ]</a>
              <a href="thread.html#1124">[ thread ]</a>
              <a href="subject.html#1124">[ subject ]</a>
              <a href="author.html#1124">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>#
# SQL Keyword Anomaly Scoring:

I am having issues fine tuning all SQL rules for a COTS product.  This relates to the ID 981301 - 981316 with 981317.
I get a 403 from 918317 related to the previous SecRules because of the keyword count trigger.
Would the keyword in 301-316 be triggered by variables names having SQL keywords in the var name, such as:
 &quot;search.selectedJobFamily.value&quot; (981301 - select)

Also,
 I have two variables where users can enter an entire resume, so most, if not all of the SQL keywords in the SQL rules 301-316 will get hit!

I have seen the use SecRuleUpdateById in conjunction of !ARGS:&lt;var&gt; used, but 301-316 uses TX:SQLI&#8230;.. How do I use the SecRuleUpdateById with TX vs ARGS, and or
what is the best way to allow all words for these two variables and not set off the SQL triggers.

Thank you
Steve

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120720/b631ea8d/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120720/b631ea8d/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001123.html">[Owasp-modsecurity-core-rule-set] DOS_Protection Problem: Could not set variable &quot;ip.dos_counter&quot; as the collection does not exist.
</A></li>
	<LI>Next message: <A HREF="001126.html">[Owasp-modsecurity-core-rule-set] SQL Keyword Anomaly Scoring
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1124">[ date ]</a>
              <a href="thread.html#1124">[ thread ]</a>
              <a href="subject.html#1124">[ subject ]</a>
              <a href="author.html#1124">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
