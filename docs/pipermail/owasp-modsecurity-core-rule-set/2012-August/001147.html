<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] @pmFromFile fails when using IIS along with modsecurity 2.7.0-RC2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%40pmFromFile%20fails%20when%20using%0A%20IIS%20along%20with%20modsecurity%202.7.0-RC2&In-Reply-To=%3CF54DE268-E024-477E-8B8D-86C5B769E81A%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001146.html">
   <LINK REL="Next"  HREF="001148.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] @pmFromFile fails when using IIS along with modsecurity 2.7.0-RC2</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%40pmFromFile%20fails%20when%20using%0A%20IIS%20along%20with%20modsecurity%202.7.0-RC2&In-Reply-To=%3CF54DE268-E024-477E-8B8D-86C5B769E81A%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] @pmFromFile fails when using IIS along with modsecurity 2.7.0-RC2">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Aug  9 21:45:02 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001146.html">[Owasp-modsecurity-core-rule-set] @pmFromFile fails when using IIS	along with modsecurity 2.7.0-RC2
</A></li>
        <LI>Next message: <A HREF="001148.html">[Owasp-modsecurity-core-rule-set] Considering Migration to GitHub
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1147">[ date ]</a>
              <a href="thread.html#1147">[ thread ]</a>
              <a href="subject.html#1147">[ subject ]</a>
              <a href="author.html#1147">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You might want to try and specify a full path to the .data file.

--
Ryan Barnett
Researcher Lead
Trustwave - SpiderLabs


On Aug 9, 2012, at 5:39 PM, Bill Roemhild &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">consume_ at hotmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">consume_ at hotmail.com</A>&gt;&gt; wrote:

I've been playing around with modsecurity 2.7.0-RC2 for IIS along with the OWASP rules.  When running any rule set that calls for a data file through @pmFromFile the application pool crashes.  I've given read access to 'Everyone' on the data files being read without success. Anyone else run into this problem?


Rule:
SecRule REQUEST_HEADERS:User-Agent &quot;@pmFromFile modsecurity_35_scanners.data&quot; \
        &quot;phase:2,rev:'2.2.5',t:none,t:lowercase,block,msg:'Request Indicates a Security Scanner Scanned the Site',id:'990002',tag:'AUTOMATION/SECURITY_SCANNER',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'4',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.automation_score=+%{tx.warning_anomaly_score},setvar:tx.%{rule.id}-AUTOMATION/SECURITY_SCANNER-%{matched_var_name}=%{matched_var}&quot;

Crash:
w3wp.exe
   7.5.7601.17514
   4ce7afa2
   libapr-1.dll
   1.4.5.0
   500eaf34
   c0000005
   00000000000099f8
   1e08
   01cd7675752af369
   c:\windows\system32\inetsrv\w3wp.exe
   C:\Windows\system32\inetsrv\libapr-1.dll
   b4147ab9-e268-11e1-82b3-4437e66c2115



_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120809/43640c4a/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120809/43640c4a/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001146.html">[Owasp-modsecurity-core-rule-set] @pmFromFile fails when using IIS	along with modsecurity 2.7.0-RC2
</A></li>
	<LI>Next message: <A HREF="001148.html">[Owasp-modsecurity-core-rule-set] Considering Migration to GitHub
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1147">[ date ]</a>
              <a href="thread.html#1147">[ thread ]</a>
              <a href="subject.html#1147">[ subject ]</a>
              <a href="author.html#1147">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
