<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Why%20is%20rule%20981318%20triggering%3F&In-Reply-To=%3C6F2F4426-218E-4FA3-9CD2-72396EB40BCB%40jwall.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001169.html">
   <LINK REL="Next"  HREF="001168.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?</H1>
    <B>Christian Bockermann</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Why%20is%20rule%20981318%20triggering%3F&In-Reply-To=%3C6F2F4426-218E-4FA3-9CD2-72396EB40BCB%40jwall.org%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?">chris at jwall.org
       </A><BR>
    <I>Thu Aug 23 21:03:31 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001169.html">[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
</A></li>
        <LI>Next message: <A HREF="001168.html">[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1167">[ date ]</a>
              <a href="thread.html#1167">[ thread ]</a>
              <a href="subject.html#1167">[ subject ]</a>
              <a href="author.html#1167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christian,

kannst Du mal den vollst&#228;ndigen Request bzw. das AuditEvent dazu schicken?
K&#246;nnte es ggf sein, dass der Browser das Zeichen nicht URL-encoded sondern
irgendwie anders geschickt hat, und die &quot;urlDecodeUni&quot; Transformation dann
etwas daraus macht, was bei der Rule h&#228;ngen bleibt?

Ich w&#252;rde mir das gerne mal genauer anschauen, allerdings br&#228;uchte ich dazu
am besten das Event (bitte vorher etwaige private Daten wie Session-ID, IP
usw. entfernen).

Gru&#223;,
   Chris


Am 23.08.2012 um 15:34 schrieb Christian Klossek &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">c.klossek at apodiscounter.de</A>&gt;:

&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> I'm using modsecurity 2.6.7 with CRS 2.2.5 on a debian squeeze system.
</I>&gt;<i> 
</I>&gt;<i> Why is the rule 981318 triggering on a GET-param with a value of &quot;&#281;&quot;
</I>&gt;<i> (Unicode U+0119)?
</I>&gt;<i> 
</I>&gt;<i> I get this in my debug log (debug level 9):
</I>&gt;<i> -------------------------------------
</I>&gt;<i> SecRule
</I>&gt;<i> &quot;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot;
</I>&gt;<i> &quot;@rx
</I>&gt;<i> (^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
</I>&gt;<i> &quot;phase:2,nolog,auditlog,rev:2.2.5,capture,t:none,t:urlDecodeUni,block,msg:'SQL
</I>&gt;<i> Injection Attack: Common Injection Testing
</I>&gt;<i> Detected',id:981318,logdata:%{TX.0},severity:2,tag:WEB_ATTACK/SQL_INJECTION,tag:WASCTC/WASC-19,tag:OWASP_TOP_10/A1,tag:OWASP_AppSensor/CIE1,tag:PCI/6.5.2,setvar:tx.msg=%{rule.msg},setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/SQL_INJECTION-%{matched_var_name}=%{tx.0}&quot;
</I>&gt;<i> 
</I>&gt;<i> Expanded
</I>&gt;<i> &quot;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot;
</I>&gt;<i> to &quot;REQUEST_FILENAME|ARGS_NAMES:keywords|ARGS:keywords&quot;.
</I>&gt;<i> 
</I>&gt;<i> T (0) urlDecodeUni: &quot;/test.php&quot;
</I>&gt;<i> Transformation completed in 13 usec.
</I>&gt;<i> Executing operator &quot;rx&quot; with param
</I>&gt;<i> &quot;(^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
</I>&gt;<i> against REQUEST_FILENAME.
</I>&gt;<i> Target value: &quot;/test.php&quot;
</I>&gt;<i> Operator completed in 9 usec.
</I>&gt;<i> 
</I>&gt;<i> T (0) urlDecodeUni: &quot;keywords&quot;
</I>&gt;<i> Transformation completed in 13 usec.
</I>&gt;<i> Executing operator &quot;rx&quot; with param
</I>&gt;<i> &quot;(^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
</I>&gt;<i> against ARGS_NAMES:keywords.
</I>&gt;<i> Target value: &quot;keywords&quot;
</I>&gt;<i> Operator completed in 4 usec.
</I>&gt;<i> 
</I>&gt;<i> T (0) urlDecodeUni: &quot;\xc4\x99&quot;
</I>&gt;<i> Transformation completed in 14 usec.
</I>&gt;<i> Executing operator &quot;rx&quot; with param
</I>&gt;<i> &quot;(^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
</I>&gt;<i> against ARGS:keywords.
</I>&gt;<i> Target value: &quot;\xc4\x99&quot;
</I>&gt;<i> Added regex subexpression to TX.0: \x99
</I>&gt;<i> Added regex subexpression to TX.1: \x99
</I>&gt;<i> Operator completed in 38 usec.
</I>&gt;<i> Setting variable: tx.msg=%{rule.msg}
</I>&gt;<i> Resolved macro %{rule.msg} to: SQL Injection Attack: Common Injection
</I>&gt;<i> Testing Detected
</I>&gt;<i> ..
</I>&gt;<i> ..
</I>&gt;<i> -------------------------------------------
</I>&gt;<i> 
</I>&gt;<i> Thanks for your help
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001169.html">[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
</A></li>
	<LI>Next message: <A HREF="001168.html">[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1167">[ date ]</a>
              <a href="thread.html#1167">[ thread ]</a>
              <a href="subject.html#1167">[ subject ]</a>
              <a href="author.html#1167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
