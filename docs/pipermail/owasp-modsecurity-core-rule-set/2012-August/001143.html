<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] OWASP ModSecurity CRS v2.2.5 Available
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20ModSecurity%20CRS%20v2.2.5%0A%20Available&In-Reply-To=%3CCC493D84.57CD6%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001141.html">
   <LINK REL="Next"  HREF="001142.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] OWASP ModSecurity CRS v2.2.5 Available</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20ModSecurity%20CRS%20v2.2.5%0A%20Available&In-Reply-To=%3CCC493D84.57CD6%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] OWASP ModSecurity CRS v2.2.5 Available">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Aug  9 14:13:15 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001141.html">[Owasp-modsecurity-core-rule-set] OWASP ModSecurity CRS v2.2.5	Available
</A></li>
        <LI>Next message: <A HREF="001142.html">[Owasp-modsecurity-core-rule-set] Olga Segarra &#233;s fora de l'oficina.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1143">[ date ]</a>
              <a href="thread.html#1143">[ thread ]</a>
              <a href="subject.html#1143">[ subject ]</a>
              <a href="author.html#1143">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good point. You need at least ModSecurity v2.6.2.  Per the CHANGES File -

5 Sep 2011 - 2.6.2-rc1
-------------------

 * Added support to macro expansion for rx operator.


--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader






On 8/8/12 9:16 PM, &quot;Paul McGarry&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">paul at paulmcgarry.com</A>&gt; wrote:

&gt;<i>On Sat, Jun 16, 2012 at 12:21 AM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;
</I>&gt;<i>wrote:
</I>&gt;&gt;<i> OWASP ModSecurity CRS v2.2.5 Available
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> CHANGES:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Improvements:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Updated Content-Type check to fix possible evasion with @within
</I>&gt;&gt;<i>(Identified
</I>&gt;&gt;<i> by Qualys Vulnerability &amp; Malware Research Labs (VMRL))
</I>&gt;<i>
</I>&gt;<i>Firstly, does this change require a particular version of Modsecurity
</I>&gt;<i>to work correctly?
</I>&gt;<i>(I note the README says &quot;The rules are compatible with ModSecurity 2.5&quot;).
</I>&gt;<i>
</I>&gt;<i>After deploying this ruleset I am seeing messages like:
</I>&gt;<i>
</I>&gt;<i>Message: Warning. Match of &quot;rx ^%{tx.allowed_request_content_type}$&quot;
</I>&gt;<i>against &quot;TX:0&quot; required. [file
</I>&gt;<i>&quot;/etc/httpd/conf.d/modsecurity-crs_2.2.5/base_rules/modsecurity_crs_30_htt
</I>&gt;<i>p_policy.conf&quot;]
</I>&gt;<i>[line &quot;64&quot;] [id &quot;960010&quot;] [msg &quot;Request content type is not allowed by
</I>&gt;<i>policy&quot;] [data &quot;application/x-www-form-urlencoded&quot;] [severity
</I>&gt;<i>&quot;WARNING&quot;] [tag &quot;POLICY/ENCODING_NOT_ALLOWED&quot;] [tag &quot;WASCTC/WASC-20&quot;]
</I>&gt;<i>[tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/EE2&quot;] [tag &quot;PCI/12.1&quot;]
</I>&gt;<i>
</I>&gt;<i>I am loading the config like:
</I>&gt;<i>        Include conf.d/modsecurity-crs_2.2.5/*.conf
</I>&gt;<i>        Include conf.d/modsecurity-crs_2.2.5/base_rules/*.conf
</I>&gt;<i>
</I>&gt;<i>modsecurity-crs_2.2.5/modsecurity_crs_10_config.conf
</I>&gt;<i>contains
</I>&gt;<i>======
</I>&gt;<i>SecAction \
</I>&gt;<i>  &quot;id:'900012', \
</I>&gt;<i>  phase:1, \
</I>&gt;<i>  t:none, \
</I>&gt;<i>  setvar:'tx.allowed_methods=GET HEAD POST OPTIONS', \
</I>&gt;<i>
</I>&gt;<i>setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded|
</I>&gt;<i>multipart/form-data|text/xml|application/xml|application/x-amf',
</I>&gt;<i>\
</I>&gt;<i>  setvar:'tx.allowed_http_versions=HTTP/0.9 HTTP/1.0 HTTP/1.1', \
</I>&gt;<i>  setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/ .backup/
</I>&gt;<i>.bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/
</I>&gt;<i>.csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/
</I>&gt;<i>.idq/ .inc/ .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/
</I>&gt;<i>.pol/ .printer/ .pwd/ .resources/ .resx/ .sql/ .sys/ .vb/ .vbs/
</I>&gt;<i>.vbproj/ .vsdisco/ .webinfo/ .xsd/ .xsx/', \
</I>&gt;<i>  setvar:'tx.restricted_headers=/Proxy-Connection/ /Lock-Token/
</I>&gt;<i>/Content-Range/ /Translate/ /via/ /if/', \
</I>&gt;<i>  nolog, \
</I>&gt;<i>  pass&quot;
</I>&gt;<i>=======
</I>&gt;<i>
</I>&gt;<i>and 960010 in
</I>&gt;<i>modsecurity-crs_2.2.5/base_rules/modsecurity_crs_30_http_policy.conf
</I>&gt;<i>looks like
</I>&gt;<i>=======
</I>&gt;<i>SecRule REQUEST_METHOD &quot;!^(?:GET|HEAD|PROPFIND|OPTIONS)$&quot;
</I>&gt;<i>&quot;phase:1,chain,t:none,block,msg:'Request content type is not allowed
</I>&gt;<i>by
</I>&gt;<i>policy',id:'960010',tag:'POLICY/ENCODING_NOT_ALLOWED',tag:'WASCTC/WASC-20'
</I>&gt;<i>,tag:'OWASP_TOP_10/A1',tag:'OWASP_AppSensor/EE2',tag:'PCI/12.1',severity:'
</I>&gt;<i>4',logdata:'%{matched_var}'&quot;
</I>&gt;<i>        SecRule REQUEST_HEADERS:Content-Type &quot;^([^;\s]+)&quot; &quot;chain,capture&quot;
</I>&gt;<i>                SecRule TX:0 &quot;!^%{tx.allowed_request_content_type}$&quot;
</I>&gt;<i>&quot;t:none,ctl:forceRequestBodyVariable=On,setvar:'tx.msg=%{rule.msg}',setvar
</I>&gt;:<i>tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{t
</I>&gt;<i>x.warning_anomaly_score},setvar:tx.%{rule.id}-POLICY/CONTENT_TYPE_NOT_ALLO
</I>&gt;<i>WED-%{matched_var_name}=%{matched_var}&quot;
</I>&gt;<i>
</I>&gt;<i>=======
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Secondly, is there something odd with the svn repo (or Sourceforge)?
</I>&gt;<i>This change doesn't seems to occur on the checkin with the changelog
</I>&gt;<i>message:
</I>&gt;<i><A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security?view=revision&amp;">http://mod-security.svn.sourceforge.net/viewvc/mod-security?view=revision&amp;</A>
</I>&gt;<i>revision=1937
</I>&gt;<i>but on another revision:
</I>&gt;<i><A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security?view=revision&amp;">http://mod-security.svn.sourceforge.net/viewvc/mod-security?view=revision&amp;</A>
</I>&gt;<i>revision=1922
</I>&gt;<i>with the message &quot;- Added Arachni Scanner Integration Lua script/rules
</I>&gt;<i>files&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Paul
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001141.html">[Owasp-modsecurity-core-rule-set] OWASP ModSecurity CRS v2.2.5	Available
</A></li>
	<LI>Next message: <A HREF="001142.html">[Owasp-modsecurity-core-rule-set] Olga Segarra &#233;s fora de l'oficina.
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1143">[ date ]</a>
              <a href="thread.html#1143">[ thread ]</a>
              <a href="subject.html#1143">[ subject ]</a>
              <a href="author.html#1143">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
