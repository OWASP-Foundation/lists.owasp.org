<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Why%20is%20rule%20981318%20triggering%3F&In-Reply-To=%3C50363183.3020707%40apodiscounter.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001163.html">
   <LINK REL="Next"  HREF="001165.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?</H1>
    <B>Christian Klossek</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Why%20is%20rule%20981318%20triggering%3F&In-Reply-To=%3C50363183.3020707%40apodiscounter.de%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?">c.klossek at apodiscounter.de
       </A><BR>
    <I>Thu Aug 23 13:34:59 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001163.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers]	Advanced Slow DoS Mitigation
</A></li>
        <LI>Next message: <A HREF="001165.html">[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1164">[ date ]</a>
              <a href="thread.html#1164">[ thread ]</a>
              <a href="subject.html#1164">[ subject ]</a>
              <a href="author.html#1164">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm using modsecurity 2.6.7 with CRS 2.2.5 on a debian squeeze system.

Why is the rule 981318 triggering on a GET-param with a value of &quot;&#281;&quot;
(Unicode U+0119)?

I get this in my debug log (debug level 9):
-------------------------------------
SecRule
&quot;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot;
&quot;@rx
(^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
&quot;phase:2,nolog,auditlog,rev:2.2.5,capture,t:none,t:urlDecodeUni,block,msg:'SQL
Injection Attack: Common Injection Testing
Detected',id:981318,logdata:%{TX.0},severity:2,tag:WEB_ATTACK/SQL_INJECTION,tag:WASCTC/WASC-19,tag:OWASP_TOP_10/A1,tag:OWASP_AppSensor/CIE1,tag:PCI/6.5.2,setvar:tx.msg=%{rule.msg},setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/SQL_INJECTION-%{matched_var_name}=%{tx.0}&quot;

Expanded
&quot;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot;
to &quot;REQUEST_FILENAME|ARGS_NAMES:keywords|ARGS:keywords&quot;.

T (0) urlDecodeUni: &quot;/test.php&quot;
Transformation completed in 13 usec.
Executing operator &quot;rx&quot; with param
&quot;(^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
against REQUEST_FILENAME.
Target value: &quot;/test.php&quot;
Operator completed in 9 usec.

T (0) urlDecodeUni: &quot;keywords&quot;
Transformation completed in 13 usec.
Executing operator &quot;rx&quot; with param
&quot;(^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
against ARGS_NAMES:keywords.
Target value: &quot;keywords&quot;
Operator completed in 4 usec.

T (0) urlDecodeUni: &quot;\xc4\x99&quot;
Transformation completed in 14 usec.
Executing operator &quot;rx&quot; with param
&quot;(^[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+|[\&quot;'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98;]+$)&quot;
against ARGS:keywords.
Target value: &quot;\xc4\x99&quot;
Added regex subexpression to TX.0: \x99
Added regex subexpression to TX.1: \x99
Operator completed in 38 usec.
Setting variable: tx.msg=%{rule.msg}
Resolved macro %{rule.msg} to: SQL Injection Attack: Common Injection
Testing Detected
..
..
-------------------------------------------

Thanks for your help

Christian
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001163.html">[Owasp-modsecurity-core-rule-set] [Mod-security-developers]	Advanced Slow DoS Mitigation
</A></li>
	<LI>Next message: <A HREF="001165.html">[Owasp-modsecurity-core-rule-set] Why is rule 981318 triggering?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1164">[ date ]</a>
              <a href="thread.html#1164">[ thread ]</a>
              <a href="subject.html#1164">[ subject ]</a>
              <a href="author.html#1164">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
