<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] RES: Need help with Joomla websites rules and SlowHttp Attacks
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20RES%3A%20Need%20help%20with%20Joomla%0A%20websites%20rules%20and%20SlowHttp%20Attacks&In-Reply-To=%3CCF925CC1.F24A6%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001540.html">
   <LINK REL="Next"  HREF="001542.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] RES: Need help with Joomla websites rules and SlowHttp Attacks</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20RES%3A%20Need%20help%20with%20Joomla%0A%20websites%20rules%20and%20SlowHttp%20Attacks&In-Reply-To=%3CCF925CC1.F24A6%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] RES: Need help with Joomla websites rules and SlowHttp Attacks">RBarnett at trustwave.com
       </A><BR>
    <I>Fri May  9 14:23:00 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001540.html">[Owasp-modsecurity-core-rule-set] RES: Need help with Joomla websites rules and SlowHttp Attacks
</A></li>
        <LI>Next message: <A HREF="001542.html">[Owasp-modsecurity-core-rule-set] CRS-2.2.9 - Duplicates found for	rules 2011257 and 2011258
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1541">[ date ]</a>
              <a href="thread.html#1541">[ thread ]</a>
              <a href="subject.html#1541">[ subject ]</a>
              <a href="author.html#1541">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks.

Yeah, we discussed the use of mod_reqtimeout in our blog post -
<A HREF="http://blog.spiderlabs.com/2011/07/advanced-topic-of-the-week-mitigating-slow-http-dos-attacks.html">http://blog.spiderlabs.com/2011/07/advanced-topic-of-the-week-mitigating-slow-http-dos-attacks.html</A>

Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: Rogerio Brito &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rogerio.brito at intercode.com.br</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rogerio.brito at intercode.com.br</A>&gt;&gt;
Date: Thursday, May 8, 2014 4:48 PM
To: Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&gt;&gt;
Cc: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: RES: [Owasp-modsecurity-core-rule-set] Need help with Joomla websites rules and SlowHttp Attacks

Hi Ryan,

Ok, I&#8217;ll open tickets on github.

To fix the Slow DoS Attacks I&#8217;ve changed the rule as indicated on Acunetix website, as follows:

&lt;IfModule reqtimeout_module&gt;
RequestReadTimeout header=20-40,MinRate=500 body=30,MinRate=500
&lt;/IfModule&gt;

After that they reported it as secure.

Thank you
[]s
[assinatura_rogerio]

De: Ryan Barnett [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>]
Enviada em: ter&#231;a-feira, 6 de maio de 2014 18:28
Para: Rogerio Brito
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Assunto: Re: [Owasp-modsecurity-core-rule-set] Need help with Joomla websites rules and SlowHttp Attacks

Rogerio,
A couple of comments -

1) Please open GitHub Issue tickets for your false positives so that we can fix them.

2) How is Acunetix actually testing the vuln?

Keep in mind that the ModSecurity defenses for slow DoS attacks (headers vs post body) is really based on a scenario where a client has too many connections open vs actually doing any per-thread timing. If the scanner is only opening a single/small # it connections to test then the SecConnReadStateLimit/SecConnWriteStateLimit directives won't trigger.
Ryan Barnett
Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

On May 6, 2014, at 5:12 PM, &quot;Rogerio Brito&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rogerio.brito at intercode.com.br</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rogerio.brito at intercode.com.br</A>&gt;&gt; wrote:
Hello all,

I have lots of Joomla websites and I&#8217;ve just installed mod_security with Owasp-modsecurity-core-rule-set.  I had to disable the modsecurity_crs_41_xss_attacks.conf and modsecurity_crs_41_sql_injection_attacks.conf rules because I could not edit any article. Whenever I tried to save the article I would get a 403 forbidden.  I watched the audit log file and I&#8217;ve tried to comment out rule by rule that fails, but as we are editing HTML  content there are so many rules to comment that I believe there must some way else to do it.
On another case, I&#8217;ve enabled the modsecurity_crs_11_slow_dos_protection.conf rules, but I&#8217;ve tested the site with <A HREF="http://www.acunetix.com/">http://www.acunetix.com/</A> and it still reports the site as vulnerable to &#8220;Slow HTTP Denial of Service Attack&#8221;.

Can someone please help?

Thank you
Rogerio Brito

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140509/5087ee60/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140509/5087ee60/attachment-0001.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.gif
Type: image/gif
Size: 11910 bytes
Desc: image001.gif
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140509/5087ee60/attachment-0001.gif">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140509/5087ee60/attachment-0001.gif</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001540.html">[Owasp-modsecurity-core-rule-set] RES: Need help with Joomla websites rules and SlowHttp Attacks
</A></li>
	<LI>Next message: <A HREF="001542.html">[Owasp-modsecurity-core-rule-set] CRS-2.2.9 - Duplicates found for	rules 2011257 and 2011258
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1541">[ date ]</a>
              <a href="thread.html#1541">[ thread ]</a>
              <a href="subject.html#1541">[ subject ]</a>
              <a href="author.html#1541">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
