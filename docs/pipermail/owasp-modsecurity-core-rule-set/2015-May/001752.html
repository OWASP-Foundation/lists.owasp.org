<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Require information on	modsecurity_crs_11_dos_protection.conf
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Require%20information%20on%0A%09modsecurity_crs_11_dos_protection.conf&In-Reply-To=%3CCAHuMxUG0iKHMUM9kqxkJB%3Dm5w12TKB5RHbQGf3b84qMfnkVKtg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001751.html">
   <LINK REL="Next"  HREF="001753.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Require information on	modsecurity_crs_11_dos_protection.conf</H1>
    <B>deepak akula</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Require%20information%20on%0A%09modsecurity_crs_11_dos_protection.conf&In-Reply-To=%3CCAHuMxUG0iKHMUM9kqxkJB%3Dm5w12TKB5RHbQGf3b84qMfnkVKtg%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Require information on	modsecurity_crs_11_dos_protection.conf">thatsdeepak at gmail.com
       </A><BR>
    <I>Wed May 20 03:54:53 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001751.html">[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 73, Issue 11
</A></li>
        <LI>Next message: <A HREF="001753.html">[Owasp-modsecurity-core-rule-set] ModSecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1752">[ date ]</a>
              <a href="thread.html#1752">[ thread ]</a>
              <a href="subject.html#1752">[ subject ]</a>
              <a href="author.html#1752">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi All,

I would like to know more about the experimental rules related to the
following rules.

modsecurity_crs_11_brute_force.conf
modsecurity_crs_11_dos_protection.conf
modsecurity_crs_11_slow_dos_protection.conf

As per my knowledge, these rules should block the users when the conditions
mentioned in the modsecurity_crs_10_config.conf file are met. I am trying
to simulate the dos attack by modifying the properties as mentioned below
but my IP is not getting blocked even after multiple tries.

SecAction \
  &quot;id:'900015', \
  phase:1, \
  t:none, \
  setvar:'tx.dos_burst_time_slice=40', \
  setvar:'tx.dos_counter_threshold=3', \
  setvar:'tx.dos_block_timeout=20', \
  nolog, \
  pass&quot;

Am I missing anything or is blocking dependent on any other properties? Mod
security is 'On' and not in detection mode. Environment is unix and the
required conf files are added in the httpd.conf. Have not modified anything
in modsecurity_crs_11_dos_protection.conf file.

I am new to mod security rules, so any information would be of great help.


&gt;<i>From the logs I am able to see the following lines. Tried to print the dos
</I>counter value but nothing is being displayed.

Message: Warning. Match of &quot;rx \\.(jpe?g|png|gif|js|css|ico)$&quot; against
&quot;REQUEST_BASENAME&quot; required. [file
&quot;/etc/httpd/modsecurity-crs/experimental_rules/modsecurity_crs_11_dos_protection.conf&quot;]
[line &quot;30&quot;] [id &quot;981047&quot;] [msg &quot;counter is  &quot;]


Regards,
Deepak.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150520/83f9a041/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150520/83f9a041/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001751.html">[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 73, Issue 11
</A></li>
	<LI>Next message: <A HREF="001753.html">[Owasp-modsecurity-core-rule-set] ModSecurity
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1752">[ date ]</a>
              <a href="thread.html#1752">[ thread ]</a>
              <a href="subject.html#1752">[ subject ]</a>
              <a href="author.html#1752">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
