<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20960009%20generates%20false%0A%20positives%20from%20my%20own%20server%20IP&In-Reply-To=%3CD178B6DC.5799%25csanders%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001747.html">
   <LINK REL="Next"  HREF="001743.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP</H1>
    <B>Chaim Sanders</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20960009%20generates%20false%0A%20positives%20from%20my%20own%20server%20IP&In-Reply-To=%3CD178B6DC.5799%25csanders%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP">CSanders at trustwave.com
       </A><BR>
    <I>Wed May 13 12:24:07 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001747.html">[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
</A></li>
        <LI>Next message: <A HREF="001743.html">[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 73, Issue 5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1739">[ date ]</a>
              <a href="thread.html#1739">[ thread ]</a>
              <a href="subject.html#1739">[ subject ]</a>
              <a href="author.html#1739">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Luiz,
It looks like the rule in question deals with lack of a user agent, probably from some sort of internal requests or scripts. In any event, your method should work fine. The one thing I will advise is to use the &#8216;new&#8217; (modsecurity 2.7 or greater) ipmatch (<A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ipMatch">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ipMatch</A>) directive. You should find this makes your code more resilient and readable. If you run into problems keep us updated.

Also, if you find any requests that are made as part of the default installation that cause issues (for instance on /bob/test.php the comment parameter includes stuff that looks like XSS but really isn&#8217;t) for a product like Joomla we would consider adding that to the exceptions file.

Thanks for your question, good luck!



From: Guilherme Y &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">asiayaisa at hotmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">asiayaisa at hotmail.com</A>&gt;&gt;
Date: Tuesday, May 12, 2015 at 7:34 PM
To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: [Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP

Hi!

I don't know if anyone experiences the same issue as us here, but I suppose at least this might contribute to all.

I installed OWASP rules on a Centos running 2 Joomla sites with nearly 5,000 unique visitors a day.

I was fortunate enough to identify and disable 12 rules that delivered a bunch of false positives (one of them locked down the server when one of us in the team submitted a security scan from CSF/LFD...).

So, now it is running fine but one rule still delivers near 1,000 false positives a day and oddly enough having our own server IP as source!

And severity level for ALL of the hits are NOTICE. So, this is not so much troublesome, except for the extra load on the server and the log size. I rotate it automatically everynight but it comes out at nearly 0,3 GB as standard size.

So, what I am trying to do but don't know exactly how is to implent something like this in a file named modsecurity_crs_15_localrules.conf:

SecRule REMOTE_ADDR &quot;@streq XXX.YYY.Z.WWW&quot;
&gt;<i> &quot;phase:1,t:none,pass,nolog,ctl:ruleRemoveById=960009&quot;
</I>
where XXX.YYY.Z.WWW is my server's IP address.

Does anyone know if this is correct and if it can actually work to keep my server out of this rule execution?

Tks a lot!

All the best!
Luiz Guilherme

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150513/566d8fec/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150513/566d8fec/attachment.html</A>&gt;
</PRE>












<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001747.html">[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
</A></li>
	<LI>Next message: <A HREF="001743.html">[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 73, Issue 5
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1739">[ date ]</a>
              <a href="thread.html#1739">[ thread ]</a>
              <a href="subject.html#1739">[ subject ]</a>
              <a href="author.html#1739">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
