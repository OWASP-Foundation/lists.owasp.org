<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20960009%20generates%20false%0A%20positives%20from%20my%20own%20server%20IP&In-Reply-To=%3C1431782516.2585047.270337641.5A46287E%40webmail.messagingengine.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001750.html">
   <LINK REL="Next"  HREF="001739.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP</H1>
    <B>Morris Taylor</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20960009%20generates%20false%0A%20positives%20from%20my%20own%20server%20IP&In-Reply-To=%3C1431782516.2585047.270337641.5A46287E%40webmail.messagingengine.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP">morris at eml.cc
       </A><BR>
    <I>Sat May 16 13:21:56 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001750.html">[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
</A></li>
        <LI>Next message: <A HREF="001739.html">[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1747">[ date ]</a>
              <a href="thread.html#1747">[ thread ]</a>
              <a href="subject.html#1747">[ subject ]</a>
              <a href="author.html#1747">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Luiz,

Seems no one mentioned that the rule should be &quot;placed&quot; after the rule
your are going to disable. Therefore, according to the CRS repository,
we can find the rule with the id &quot;960009&quot; is located in
&quot;modsecurity_crs_21_protocol_anomalies.conf&quot;. You have to put your
whitelist rule after it, thus, you may create a file named &quot;mod
security_crs_60_disable_rid.conf&quot; and put your whitelist rule into it.
While the rule file is ready, you can restart your web server and
everything should works well.

--
BR, Morris


On Sat, May 16, 2015, at 07:53 AM, Guilherme Y wrote:
&gt;<i> Tks Chaim! But now I really got confused. I am tring to use this line:
</I>&gt;<i>
</I>&gt;<i> SecRule REMOTE_ADDR &quot;@ipMatch 999.99.99.99&quot;
</I>&gt;<i> &quot;id:1000,phase:2,t:none,pass,ctl:ruleRemoveById=960009&quot; You&#180;re telling
</I>&gt;<i> me to use this:
</I>&gt;<i>
</I>&gt;<i> &quot;ctl:ruleRemoveById=960009,id:1000,phase:2,t:none,pass&quot;SecRule
</I>&gt;<i> REMOTE_ADDR &quot;@ipMatch 999.99.99.99&quot; YIs this right? I probably got it
</I>&gt;<i> all wrong.... Tks a lot! Best regards! Luiz
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">asiayaisa at hotmail.com</A>;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">barry_pollard at hotmail.com</A>;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A> Subject: Re:
</I>&gt;<i> [Owasp-modsecurity-core-rule-set] Rule 960009 generates false
</I>&gt;<i> positives from my own server IP Date: Fri, 15 May 2015 16:48:07 +0000
</I>&gt;<i>
</I>&gt;<i> ctl:ruleRemoveById must appear BEFORE the rule in question. Where as
</I>&gt;<i> SecRuleRemoveByID must appear after. See the excerpt from this issue
</I>&gt;<i> (<A HREF="https://github.com/SpiderLabs/ModSecurity/issues/209">https://github.com/SpiderLabs/ModSecurity/issues/209</A>).
</I> Hope this isn&#8217;t too confusing :)
&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From: *Guilherme Y &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">asiayaisa at hotmail.com</A>&gt; *Date: *Friday, May 15,
</I>&gt;<i> 2015 at 10:51 AM *To: *Barry Pollard &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">barry_pollard at hotmail.com</A>&gt;,
</I>&gt;<i> &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&quot;
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt; *Subject: *Re:
</I>&gt;<i> [Owasp-modsecurity-core-rule-set] Rule 960009 generates false
</I>&gt;<i> positives from my own server IP
</I>&gt;<i>
</I>&gt;<i> ctl:ruleRemoveById
</I>&gt;<i>
</I>&gt;<i>
</I>This transmission may contain information that is privileged,
confidential, and/or exempt from disclosure under applicable law. If you
are not the intended recipient, you are hereby notified that any
disclosure, copying, distribution, or use of the information contained
herein (including any reliance thereon) is strictly prohibited. If you
received this transmission in error, please immediately contact the
sender and destroy the material in its entirety, whether in electronic
or hard copy format.
&gt;<i> _________________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150516/ede01c57/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150516/ede01c57/attachment.html</A>&gt;
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001750.html">[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
</A></li>
	<LI>Next message: <A HREF="001739.html">[Owasp-modsecurity-core-rule-set] Rule 960009 generates false positives from my own server IP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1747">[ date ]</a>
              <a href="thread.html#1747">[ thread ]</a>
              <a href="subject.html#1747">[ subject ]</a>
              <a href="author.html#1747">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
