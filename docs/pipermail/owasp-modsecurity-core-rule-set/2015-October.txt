From christian.folini at time-machine.ch  Thu Oct  1 06:43:53 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Thu, 1 Oct 2015 08:43:53 +0200
Subject: [Owasp-modsecurity-core-rule-set] Browser Bug ? -> Request Header:
	Connection: close, close
Message-ID: <20151001064353.GA3570@elias>

Hi there,

There are a lot of hits on core rule 
958295: Multiple/Conflicting Connection Header Data Found
on one of my customer's server lately. Actually it started on Sep 15.

It's all the same User Agent, multiple IPs, mostly US.

Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36

The request header has "Connection: close, close". Obviously an error.

The u.a. is able to do valid requests and seems to access some kind
of mobile area of the application (which I do not know very well
myself).

Now is this a bug in the browser, or is the application doing 
some stupid? (And if: how can it affect the connection header?)
Or could this be an app using a mobile browser on iOS?

Ahoj,

Christian


-- 
Idealism is what precedes experience; cynicism is what follows.
-- David T. Wolf

From info at waf.blue  Fri Oct 16 08:51:16 2015
From: info at waf.blue (theMiddle)
Date: Fri, 16 Oct 2015 10:51:16 +0200
Subject: [Owasp-modsecurity-core-rule-set] Rule 950005: Remote File Access
	Attempt
Message-ID: <6685c87bed62fb45eefdf0a29d50f4ed@waf.blue>

Hi,

i've see that rule 950005 (Remote File Access Attempt) does not block 
request like:

/user?current=/proc/self/environ
/?page=/proc/self/environ%00

i've change this rule in my implementation, with the following:

SecRule 
REQUEST_COOKIES|!REQUEST_COOKIES:/__utm/|!REQUEST_COOKIES:/_pk_ref/|REQUEST_COOKIES_NAMES|ARGS_NAMES|ARGS|XML:/* 
"(?:(?<!\w)(?:\.(?:ht(?:access|passwd|group)|www_?acl)|global\.asa|httpd\.conf|boot\.ini)\b|\/etc\/|\/proc\/)" 
\

it may make sense?

thank you!
best regards.

-- 
Andrea (aka theMiddle) Menin
mail: info at waf.blue

From CSanders at trustwave.com  Fri Oct 16 17:37:41 2015
From: CSanders at trustwave.com (Chaim Sanders)
Date: Fri, 16 Oct 2015 17:37:41 +0000
Subject: [Owasp-modsecurity-core-rule-set] Rule 950005: Remote File
 Access Attempt
In-Reply-To: <6685c87bed62fb45eefdf0a29d50f4ed@waf.blue>
References: <6685c87bed62fb45eefdf0a29d50f4ed@waf.blue>
Message-ID: <D246ADC6.142EB%csanders@trustwave.com>

I have no problem with accepting a patch for that. It should be noted that
this discussion is for CRS 2.x. In the CRS 3.x branch we actually already
have this support see:
https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/rules/R
EQUEST-30-APPLICATION-ATTACK-LFI.conf#L67-L96


And more specifically:
https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/rules/l
fi-os-files.data#L754


On 10/16/15, 4:51 AM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
theMiddle" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on
behalf of info at waf.blue> wrote:

>950005


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From Jens.Schleusener at t-online.de  Fri Oct 16 19:32:20 2015
From: Jens.Schleusener at t-online.de (Schleusener, Jens)
Date: Fri, 16 Oct 2015 21:32:20 +0200 (CEST)
Subject: [Owasp-modsecurity-core-rule-set] Small hint for new HTTP/2 testers
Message-ID: <alpine.LSU.2.20.1510162116220.10656@schiller2s.site>

Hi,

although it's probably a matter of course here a small hint for new HTTP/2 
testers:

Don't forget to add "HTTP/2" to the variable tx.allowed_http_versions
(set in modsecurity_crs_10_setup.conf) if the rule REQUEST_PROTOCOL 
(in modsecurity_crs_30_http_policy.conf) is in use.

It takes me some minutes to get the new http2_module of Apache httpd 
version 2.4.17 working ;-)

Regards

Jens

From christian.folini at time-machine.ch  Sat Oct 17 03:13:20 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Sat, 17 Oct 2015 05:13:20 +0200
Subject: [Owasp-modsecurity-core-rule-set] Small hint for new HTTP/2
 testers
In-Reply-To: <alpine.LSU.2.20.1510162116220.10656@schiller2s.site>
References: <alpine.LSU.2.20.1510162116220.10656@schiller2s.site>
Message-ID: <20151017031320.GA27546@elias>

Good catch. Thanks for the hint.

Christian

On Fri, Oct 16, 2015 at 09:32:20PM +0200, Schleusener, Jens wrote:
> Hi,
> 
> although it's probably a matter of course here a small hint for new
> HTTP/2 testers:
> 
> Don't forget to add "HTTP/2" to the variable tx.allowed_http_versions
> (set in modsecurity_crs_10_setup.conf) if the rule REQUEST_PROTOCOL
> (in modsecurity_crs_30_http_policy.conf) is in use.
> 
> It takes me some minutes to get the new http2_module of Apache httpd
> version 2.4.17 working ;-)
> 
> Regards
> 
> Jens
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

