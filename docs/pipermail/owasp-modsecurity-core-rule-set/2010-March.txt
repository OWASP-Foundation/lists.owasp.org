From chris.datfung at gmail.com  Mon Mar  1 05:31:18 2010
From: chris.datfung at gmail.com (Chris Datfung)
Date: Mon, 1 Mar 2010 12:31:18 +0200
Subject: [Owasp-modsecurity-core-rule-set] whitelisting a parameter
In-Reply-To: <4c9cc6791002271213t3fa1da25ga7cc2b97dca329e4@mail.gmail.com>
References: <4c9cc6791002271213t3fa1da25ga7cc2b97dca329e4@mail.gmail.com>
Message-ID: <4c9cc6791003010231g4b7ef726i2b297ddcbe05611d@mail.gmail.com>

To rephrase the question, how can I adjust the anomaly score for a specific
parameter so that it essentially is put in DetectionOnly mode, i.e. an event
will be created if it matches a rule, but the traffic wont be stopped if the
anomaly score is high only because of that parameter.

Thanks,

Chris

On Sat, Feb 27, 2010 at 10:13 PM, Chris Datfung <chris.datfung at gmail.com>wrote:

> I'm getting a large number of false positives in various requests due to
> the encrypted value of the ViewState parameter. I can whitelist the false
> positives one by one via SecRuleRemoveById, but instead of waiting for the
> next false positive (I have blocking enabled) I want to put any rules that
> want to block due to a suspicious ViewState parameter into DetectionOnly
> mode and still have the rest of the request in blocking mode. Is this
> possible?
>
> Thanks,
>   Chris
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100301/349c5896/attachment.html 

From Ryan.Barnett at breach.com  Mon Mar  1 06:48:23 2010
From: Ryan.Barnett at breach.com (Ryan Barnett)
Date: Mon, 1 Mar 2010 06:48:23 -0500
Subject: [Owasp-modsecurity-core-rule-set] whitelisting a parameter
Message-ID: <8A1B4B015C52A54886DF15E9A97C7FB9F878A75C@MONET.utopiasystems.net>

This is where inspecting the previously matched TX data comes in. You should copy the example 48 local exceptions file and place it in the base_rules dir. You then create a rule that inspects the TX data to see if there was a previous match. You would want to look for the specific ARGS:name data in the TX name and optionally match on the exact false positive matched data. Take a look at the examples in the 48 file. You probably just want to correct the anomaly score rather than switch to DetectionOnly mode.

If you send an audit log example of the false positive it would help.

Ryan C. Barnett
Director of Application Security Research
Breach Security, Inc.
Ryan.Barnett at Breach.com
www.Breach.com

________________________________
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Sent: Mon Mar 01 05:31:18 2010
Subject: Re: [Owasp-modsecurity-core-rule-set] whitelisting a parameter

To rephrase the question, how can I adjust the anomaly score for a specific parameter so that it essentially is put in DetectionOnly mode, i.e. an event will be created if it matches a rule, but the traffic wont be stopped if the anomaly score is high only because of that parameter.

Thanks,

Chris

On Sat, Feb 27, 2010 at 10:13 PM, Chris Datfung <chris.datfung at gmail.com<mailto:chris.datfung at gmail.com>> wrote:
I'm getting a large number of false positives in various requests due to the encrypted value of the ViewState parameter. I can whitelist the false positives one by one via SecRuleRemoveById, but instead of waiting for the next false positive (I have blocking enabled) I want to put any rules that want to block due to a suspicious ViewState parameter into DetectionOnly mode and still have the rest of the request in blocking mode. Is this possible?

Thanks,
  Chris

-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100301/f45d2ce7/attachment.html 

From listas at sapao.net  Mon Mar  1 12:33:29 2010
From: listas at sapao.net (Lucas Ferreira)
Date: Mon, 1 Mar 2010 14:33:29 -0300
Subject: [Owasp-modsecurity-core-rule-set] Unespected behaviour of
	SecDefaultAction
Message-ID: <245770851003010933s2adb6136v87eead319559357d@mail.gmail.com>

Hello,

I am trying to start blocking requests by changing the
SecDefaultAction to deny, but, when I do this, all requests are denied
and the logs show no information I am able to use to understand what
is happening. The audit logs show:

Not even my custom error pages are shown.

The audit logs show:

--2d48f47d-F--
HTTP/1.1 403 Forbidden
Connection: close
Transfer-Encoding: chunked
Content-Type: text/html; charset=iso-8859-1


--2d48f47d-H--
Action: Intercepted (phase 4)
Apache-Handler: proxy-server
Stopwatch: 1267464220789414 44705 (1519 16154 -)
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.5.12 (http://www.modsecurity.org/);
core ruleset/2.0.5; core ruleset/2.0.5.
Server: Apache/2.2.3 (CentOS)

--2d48f47d-Z--

Can someone help me understand what id going on?

Thanks,

Lucas

-- 
Homo sapiens non urinat in ventum.

From ard at 100.pfr.ru  Mon Mar  1 13:07:06 2010
From: ard at 100.pfr.ru (Artyom Davidov)
Date: Mon, 1 Mar 2010 21:07:06 +0300
Subject: [Owasp-modsecurity-core-rule-set] Ha: Unespected behaviour
	of	SecDefaultAction
In-Reply-To: <245770851003010933s2adb6136v87eead319559357d@mail.gmail.com>
Message-ID: <OFF8E6FC73.3BF8FB01-ONC32576D9.00631494-C32576D9.006387D8@100.pfr.ru>



> Hello,
>
> I am trying to start blocking requests by changing the
> SecDefaultAction to deny, but, when I do this, all requests are denied
> and the logs show no information I am able to use to understand what
> is happening. The audit logs show:
>
> Not even my custom error pages are shown.

[skipped]

> Can someone help me understand what id going on?

Hello, Lucas!

Please check this URL:
https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2010-February/000307.html


and make corresponding corrections to your modsecurity_crs_50_outbund.conf
to see if it helps.

wbr,
Artyom


From listas at sapao.net  Mon Mar  1 13:11:04 2010
From: listas at sapao.net (Lucas Ferreira)
Date: Mon, 1 Mar 2010 15:11:04 -0300
Subject: [Owasp-modsecurity-core-rule-set] Ha: Unespected behaviour of
	SecDefaultAction
In-Reply-To: <OFF8E6FC73.3BF8FB01-ONC32576D9.00631494-C32576D9.006387D8@100.pfr.ru>
References: <245770851003010933s2adb6136v87eead319559357d@mail.gmail.com> 
	<OFF8E6FC73.3BF8FB01-ONC32576D9.00631494-C32576D9.006387D8@100.pfr.ru>
Message-ID: <245770851003011011y1e130715ybe99dda1a5cbec9c@mail.gmail.com>

This worked fine.

Thanks.

Lucas

On Mon, Mar 1, 2010 at 15:07, Artyom Davidov <ard at 100.pfr.ru> wrote:
>
>
>> Hello,
>>
>> I am trying to start blocking requests by changing the
>> SecDefaultAction to deny, but, when I do this, all requests are denied
>> and the logs show no information I am able to use to understand what
>> is happening. The audit logs show:
>>
>> Not even my custom error pages are shown.
>
> [skipped]
>
>> Can someone help me understand what id going on?
>
> Hello, Lucas!
>
> Please check this URL:
> https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2010-February/000307.html
>
>
> and make corresponding corrections to your modsecurity_crs_50_outbund.conf
> to see if it helps.
>
> wbr,
> Artyom
>
>



-- 
Homo sapiens non urinat in ventum.

From timlegge at gmail.com  Thu Mar  4 10:15:28 2010
From: timlegge at gmail.com (Timothy Legge)
Date: Thu, 4 Mar 2010 11:15:28 -0400
Subject: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with 2.0.5
	Rules
Message-ID: <be95b6c51003040715l4bcd2c29pa0679c283de88321@mail.gmail.com>

Hi

The 2.0.5 rules included with modsecurity-apache_2.5.12 seem to be
causing me some problems.  So far I have had to add the following to
modsecurity_crs_10_config.conf.

SecAuditLog /var/log/apache2/modsec_audit.log
SecDebugLog /var/log/apache2/modsec_debug.log
SecDataDir /var/log/apache2

Unfortunately this continues to send logs to error.log instead of the
modsec* logs.

Have I missed something in the use of this rule set with 2.5.12?

Tim

From Ryan.Barnett at breach.com  Thu Mar  4 10:34:08 2010
From: Ryan.Barnett at breach.com (Ryan Barnett)
Date: Thu, 4 Mar 2010 10:34:08 -0500
Subject: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with
 2.0.5	Rules
Message-ID: <8A1B4B015C52A54886DF15E9A97C7FB9F878A772@MONET.utopiasystems.net>

We got a lot of feedback that it would be better to remove the ModSecurity config directives from the CRS as most people will customize those settings for their env to control Mod.  So in the current CRS we are trying to deal only with rule items.

Do you have a separate base Mod config file?


Ryan C. Barnett
Director of Application Security Research
Breach Security, Inc.
Ryan.Barnett at Breach.com 
www.Breach.com 


----- Original Message -----
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>
To: owasp-modsecurity-core-rule-set at lists.owasp.org <owasp-modsecurity-core-rule-set at lists.owasp.org>
Sent: Thu Mar 04 10:15:28 2010
Subject: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with 2.0.5	Rules

Hi

The 2.0.5 rules included with modsecurity-apache_2.5.12 seem to be
causing me some problems.  So far I have had to add the following to
modsecurity_crs_10_config.conf.

SecAuditLog /var/log/apache2/modsec_audit.log
SecDebugLog /var/log/apache2/modsec_debug.log
SecDataDir /var/log/apache2

Unfortunately this continues to send logs to error.log instead of the
modsec* logs.

Have I missed something in the use of this rule set with 2.5.12?

Tim
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

From timlegge at gmail.com  Thu Mar  4 10:44:49 2010
From: timlegge at gmail.com (Timothy Legge)
Date: Thu, 4 Mar 2010 11:44:49 -0400
Subject: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with
	2.0.5 Rules
In-Reply-To: <8A1B4B015C52A54886DF15E9A97C7FB9F878A772@MONET.utopiasystems.net>
References: <8A1B4B015C52A54886DF15E9A97C7FB9F878A772@MONET.utopiasystems.net>
Message-ID: <be95b6c51003040744y5017591u9a1338a256b7cc37@mail.gmail.com>

No, do not.  I assume that most of the settings are in
modsecurity.conf-minimal but it still seems to miss the SecDataDir.
Is there a better base file to work from?

The change makes sense...

Tim

On Thu, Mar 4, 2010 at 11:34 AM, Ryan Barnett <Ryan.Barnett at breach.com> wrote:
> We got a lot of feedback that it would be better to remove the ModSecurity config directives from the CRS as most people will customize those settings for their env to control Mod. ?So in the current CRS we are trying to deal only with rule items.
>
> Do you have a separate base Mod config file?
>
>
> Ryan C. Barnett
> Director of Application Security Research
> Breach Security, Inc.
> Ryan.Barnett at Breach.com
> www.Breach.com
>
>
> ----- Original Message -----
> From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>
> To: owasp-modsecurity-core-rule-set at lists.owasp.org <owasp-modsecurity-core-rule-set at lists.owasp.org>
> Sent: Thu Mar 04 10:15:28 2010
> Subject: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with 2.0.5 ? ? ? Rules
>
> Hi
>
> The 2.0.5 rules included with modsecurity-apache_2.5.12 seem to be
> causing me some problems. ?So far I have had to add the following to
> modsecurity_crs_10_config.conf.
>
> SecAuditLog /var/log/apache2/modsec_audit.log
> SecDebugLog /var/log/apache2/modsec_debug.log
> SecDataDir /var/log/apache2
>
> Unfortunately this continues to send logs to error.log instead of the
> modsec* logs.
>
> Have I missed something in the use of this rule set with 2.5.12?
>
> Tim
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>

From Ryan.Barnett at breach.com  Thu Mar  4 10:50:29 2010
From: Ryan.Barnett at breach.com (Ryan Barnett)
Date: Thu, 4 Mar 2010 10:50:29 -0500
Subject: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with
 2.0.5 Rules
Message-ID: <8A1B4B015C52A54886DF15E9A97C7FB9F878A773@MONET.utopiasystems.net>

Brian Rectanus and I will get a new base Mod config soon and it will be in the Mod code archive (basically it will be an updated version of the minimal conf you mentioned).

I would suggest that you use the minimal conf, copy to something like modsecurity_crs_9_config.conf and add needed directives to it.  Then make sure to call up this file first in your Apache Include directive.



Ryan C. Barnett
Director of Application Security Research
Breach Security, Inc.
Ryan.Barnett at Breach.com 
www.Breach.com 


----- Original Message -----
From: Timothy Legge <timlegge at gmail.com>
To: Ryan Barnett
Cc: owasp-modsecurity-core-rule-set at lists.owasp.org <owasp-modsecurity-core-rule-set at lists.owasp.org>
Sent: Thu Mar 04 10:44:49 2010
Subject: Re: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with 2.0.5 	Rules

No, do not.  I assume that most of the settings are in
modsecurity.conf-minimal but it still seems to miss the SecDataDir.
Is there a better base file to work from?

The change makes sense...

Tim

On Thu, Mar 4, 2010 at 11:34 AM, Ryan Barnett <Ryan.Barnett at breach.com> wrote:
> We got a lot of feedback that it would be better to remove the ModSecurity config directives from the CRS as most people will customize those settings for their env to control Mod. ?So in the current CRS we are trying to deal only with rule items.
>
> Do you have a separate base Mod config file?
>
>
> Ryan C. Barnett
> Director of Application Security Research
> Breach Security, Inc.
> Ryan.Barnett at Breach.com
> www.Breach.com
>
>
> ----- Original Message -----
> From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>
> To: owasp-modsecurity-core-rule-set at lists.owasp.org <owasp-modsecurity-core-rule-set at lists.owasp.org>
> Sent: Thu Mar 04 10:15:28 2010
> Subject: [Owasp-modsecurity-core-rule-set] Logs and SecDataDir with 2.0.5 ? ? ? Rules
>
> Hi
>
> The 2.0.5 rules included with modsecurity-apache_2.5.12 seem to be
> causing me some problems. ?So far I have had to add the following to
> modsecurity_crs_10_config.conf.
>
> SecAuditLog /var/log/apache2/modsec_audit.log
> SecDebugLog /var/log/apache2/modsec_debug.log
> SecDataDir /var/log/apache2
>
> Unfortunately this continues to send logs to error.log instead of the
> modsec* logs.
>
> Have I missed something in the use of this rule set with 2.5.12?
>
> Tim
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>

From dreamice.jiang at gmail.com  Mon Mar  8 04:20:31 2010
From: dreamice.jiang at gmail.com (Junyong Jiang)
Date: Mon, 8 Mar 2010 17:20:31 +0800
Subject: [Owasp-modsecurity-core-rule-set] How to check the content of an
	upload file
Message-ID: <d5dfca261003080120u108bca21o20f85c38e384d036@mail.gmail.com>

Dear all,

Can modsecurity rules check the content of an upload file?

Thanks in advance!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100308/3a81a66c/attachment.html 

From Brian.Rectanus at breach.com  Mon Mar  8 10:16:27 2010
From: Brian.Rectanus at breach.com (Brian Rectanus)
Date: Mon, 8 Mar 2010 07:16:27 -0800
Subject: [Owasp-modsecurity-core-rule-set] How to check the content of
 an	upload file
In-Reply-To: <d5dfca261003080120u108bca21o20f85c38e384d036@mail.gmail.com>
References: <d5dfca261003080120u108bca21o20f85c38e384d036@mail.gmail.com>
Message-ID: <4B9514CB.6040802@breach.com>

http://www.modsecurity.org/documentation/modsecurity-apache/2.5.12/modsecurity2-apache-reference.html#N11D38

Junyong Jiang wrote:
> Dear all,
>  
> Can modsecurity rules check the content of an upload file?
>  
> Thanks in advance!

-- 
Brian Rectanus
Breach Security


From rcbarnett at gmail.com  Mon Mar  8 12:11:25 2010
From: rcbarnett at gmail.com (Ryan Barnett)
Date: Mon, 8 Mar 2010 12:11:25 -0500
Subject: [Owasp-modsecurity-core-rule-set] CRS v2.0.6 Released - Bug Fixes
Message-ID: <201003081211.25500.rcbarnett@gmail.com>


http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project#tab=Download

--------------------------
Version 2.0.6 - 02/26/2100
--------------------------

Bug Fixes:
- Added missing trasformation functions to SQLi rules.
  https://www.modsecurity.org/tracker/browse/CORERULES-32
- Fixed duplicate rule IDs.
  https://www.modsecurity.org/tracker/browse/CORERULES-33
- Fixed typo in @pmFromFile in the Comment SPAM rules
  https://www.modsecurity.org/tracker/browse/CORERULES-34
- Added macro expansion to Restricted Headers rule
  https://www.modsecurity.org/tracker/browse/CORERULES-35
- Fixed misspelled SecMarker
  https://www.modsecurity.org/tracker/browse/CORERULES-36
- Fixed missing chain action in Content-Type header check
  https://www.modsecurity.org/tracker/browse/CORERULES-37
- Update phpids filters to use pass action instead of block

--
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
http://tacticalwebappsec.blogspot.com

From ryan.barnett at breach.com  Mon Mar  8 16:55:10 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Mon, 8 Mar 2010 16:55:10 -0500
Subject: [Owasp-modsecurity-core-rule-set] WAF Virtual Patching Workshop at
	Blackhat USA 2010 in Las Vegas
Message-ID: <201003081655.10945.ryan.barnett@breach.com>

Just wanted to let everyone know that if you headed to Blackhat USA 2010 this summer in 
Las Vegas, we have just added a 1-day workshop on the day before the Briefings start -

http://www.blackhat.com/html/bh-us-10/training/bh-us-10-training_RB-WAFVirtPatch.html

In the workshop, we will be mainly discussing the "Virtual Patching" concept of using a 
WAF (ModSecurity in this case) and we will use the OWASP WebGoat app as the target.  In 
the workshop, we will talk virtual patching theory and then have hands-on labs where we 
will show how to use Mod to virtually patch the various WebGoat lessons.  As a side note - 
we will also have a section on the new CRS v2.0 when discussing negative security models.  
So, if you want to come and dive into the deep-end of the pool and have fun using some of 
ModSecurity's advanced features (such as Lua and Content Injection) then sign-up now!

Brian and I hope to see you all in Vegas!!!  :)

--
Ryan

From mlavi at sgi.com  Mon Mar  8 17:51:03 2010
From: mlavi at sgi.com (Mark Lavi)
Date: Mon, 8 Mar 2010 16:51:03 -0600
Subject: [Owasp-modsecurity-core-rule-set] Where is the signing key?
Message-ID: <074F0C4BE8F9FB4CB1410BF8D1E10B54A6C630@CF--AMER002E--3.americas.sgi.com>

Howdy, forgive me if this has been answered, but where can I find the
signing key for the CRS?
 
I checked the wiki
http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_
Project,  scanned the mailing list archives (sadly, there's no search),
and checked the archive to no avail for a key file. I also can't figure
out what key server to use to find the RSA key ID E6405E38, I've tried
and failed. :(
 
Can an explicit reference be made to the signing key (and how to obtain
it) be made on the project summary and the download page, much like it
is thinly referenced on the mod_security direct download page?
 
Thanks,

Mark Lavi
Senior Web Producer

sgi

46600 Landing Parkway
Fremont, CA 94538
(510) 933-5234 direct
mlavi at sgi.com <blocked::mailto:mlavi at sgi.com>  
www.sgi.com <blocked::http://www.sgi.com/> 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100308/cb1bc784/attachment.html 

From rcbarnett at gmail.com  Mon Mar  8 20:43:09 2010
From: rcbarnett at gmail.com (Ryan Barnett)
Date: Mon, 8 Mar 2010 20:43:09 -0500
Subject: [Owasp-modsecurity-core-rule-set] Where is the signing key?
In-Reply-To: <074F0C4BE8F9FB4CB1410BF8D1E10B54A6C630@CF--AMER002E--3.americas.sgi.com>
References: <074F0C4BE8F9FB4CB1410BF8D1E10B54A6C630@CF--AMER002E--3.americas.sgi.com>
Message-ID: <201003082043.09841.rcbarnett@gmail.com>

On Monday 08 March 2010 17:51:03 Mark Lavi wrote:
> Howdy, forgive me if this has been answered, but where can I find the
> signing key for the CRS?
> 
> I checked the wiki
> http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_
> Project,  scanned the mailing list archives (sadly, there's no search),
> and checked the archive to no avail for a key file. I also can't figure
> out what key server to use to find the RSA key ID E6405E38, I've tried
> and failed. :(
> 
> Can an explicit reference be made to the signing key (and how to obtain
> it) be made on the project summary and the download page, much like it
> is thinly referenced on the mod_security direct download page?
> 

I have uploaded my key to the MIT keyserver.

http://pgp.mit.edu:11371/pks/lookup?op=vindex&search=0x9411FBFAE6405E38

--
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
http://tacticalwebappsec.blogspot.com

From ryan.barnett at breach.com  Wed Mar 10 13:09:44 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Wed, 10 Mar 2010 13:09:44 -0500
Subject: [Owasp-modsecurity-core-rule-set] Beta Testing rules-updater.pl
	Script
Message-ID: <201003101309.44736.ryan.barnett@breach.com>

We have setup the CRS rules repository on the www.modsecurity.org site which will allow 
for automatic query/downloading of the CRS packages using the rules-updater.pl script from 
the Mod archive (in the /tools dir).  

If anyone is interested in Beta testing it, please let me know and I will send out the 
config details.  Once we have some community users test it, we will release the info to the 
community and update the Mod archive package to include the Repo details in the rules-
updater conf file.

-Ryan

From dreamice.jiang at gmail.com  Sat Mar 13 09:54:58 2010
From: dreamice.jiang at gmail.com (Junyong Jiang)
Date: Sat, 13 Mar 2010 22:54:58 +0800
Subject: [Owasp-modsecurity-core-rule-set] How to to with this type of
	attack?
Message-ID: <d5dfca261003130654ie8b13efgcf7b52f664950e8a@mail.gmail.com>

Dear all,

I have tested modsecurity rules set for more than one years. Recently, I
came accross the following type of attack.
When I test the xss attack, I check the key word of "script", for url
encoding, it is "%53%43%72%69%50%74".
But the tricky attacker use the encoding key word as
"%53%43*%00*%72%69%50%74"(sc
ript).
I write "t:urlDecodeUni" in my modsecurity rules for url decoding,
unfortunately the url deconding procedure is only end with meeting "%00".
So current modsecurity core rules set can not do anything with this type of
attack. Even if I use "t:compressWhiteSpace", there is no effect.

Can anyone help with this type of attack? Thanks a lot!
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100313/851492b5/attachment.html 

From rcbarnett at gmail.com  Sat Mar 13 10:36:47 2010
From: rcbarnett at gmail.com (Ryan Barnett)
Date: Sat, 13 Mar 2010 10:36:47 -0500
Subject: [Owasp-modsecurity-core-rule-set] How to to with this type of
	attack?
In-Reply-To: <d5dfca261003130654ie8b13efgcf7b52f664950e8a@mail.gmail.com>
References: <d5dfca261003130654ie8b13efgcf7b52f664950e8a@mail.gmail.com>
Message-ID: <cba0286a1003130736i45794b2dj2e6ca076da94599c@mail.gmail.com>

You could do two things -

1) Use the @validateByteRange operator to identify/block on the
existence of Null Bytes (%00), or

2) Use the t:removeNulls transformation function which will normalize
the data before the operator inspection.



On 3/13/10, Junyong Jiang <dreamice.jiang at gmail.com> wrote:
> Dear all,
>
> I have tested modsecurity rules set for more than one years. Recently, I
> came accross the following type of attack.
> When I test the xss attack, I check the key word of "script", for url
> encoding, it is "%53%43%72%69%50%74".
> But the tricky attacker use the encoding key word as
> "%53%43*%00*%72%69%50%74"(sc
> ript).
> I write "t:urlDecodeUni" in my modsecurity rules for url decoding,
> unfortunately the url deconding procedure is only end with meeting "%00".
> So current modsecurity core rules set can not do anything with this type of
> attack. Even if I use "t:compressWhiteSpace", there is no effect.
>
> Can anyone help with this type of attack? Thanks a lot!
>

-- 
Sent from my mobile device

Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
http://tacticalwebappsec.blogspot.com/

From chris.datfung at gmail.com  Mon Mar 15 19:03:38 2010
From: chris.datfung at gmail.com (Chris Datfung)
Date: Tue, 16 Mar 2010 01:03:38 +0200
Subject: [Owasp-modsecurity-core-rule-set] Help debugging a false positive
Message-ID: <4c9cc6791003151603o2e76aec5nc66ff4d9a688a0c2@mail.gmail.com>

I'm running the latest 2.0.6 CRS and every time I put the ruleset in
prevention mode various parts of my app stop working, but I can't seem to
debug exactly what's wrong. For example, when I try to download an .iso
image the request is stopped. Below are sections B, H and K from the
generated event.

--c6541f33-B--
GET /image-1.6.iso HTTP/1.0
User-Agent: Opera/9.80 (X11; Linux i686; U; en) Presto/2.2.15 Version/10.10
Host: host.com
Accept: text/html, application/xml;q=0.9, application/xhtml+xml, image/png,
image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1
Accept-Language: en-US,en;q=0.9
Accept-Charset: iso-8859-1, utf-8, utf-16, *;q=0.1
Accept-Encoding: deflate, gzip, x-gzip, identity, *;q=0
Proxy-Connection: Keep-Alive

--c6541f33-H--
Message: Access denied with connection close (phase 1). String match
"xxx.xxx.xxx.xxx" at REMOTE_ADDR. [file "/opt/modsecurity/etc/
www.host.com/rules.conf"] [line "5"]
Action: Intercepted (phase 1)
Stopwatch: 1268690880578066 1617 (- - -)
Producer: ModSecurity for Apache/2.5.12 (http://www.modsecurity.org/); core
ruleset/2.0.6.
Server: Apache/2.2.9 mod_ssl/2.2.9 OpenSSL/0.9.8g
WebApp-Info: "host" "-" "-"

--c6541f33-K--
SecAction
"phase:1,auditlog,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remote_addr}"
SecAction "phase:1,auditlog,t:none,nolog,pass,setvar:tx.paranoid_mode=0"
SecAction
"phase:1,auditlog,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_level=200"
SecAction
"phase:1,auditlog,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_level=200"
SecAction
"phase:1,auditlog,t:none,nolog,pass,setvar:tx.critical_anomaly_score=20,setvar:tx.error_anomaly_score=15,setvar:tx.warning_anomaly_score=10,setvar:tx.notice_anomaly_score=5"
SecAction "phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_num_args=255"

The rule at /opt/modsecurity/etc/www.host.com/rules.conf is:

SecRule REMOTE_ADDR "@streq xxx.xxx.xxx.xxx"
phase:1,ctl:ruleEngine=On,ctl:auditEngine=On,ctl:debugLogLevel=9

finally the SecDefaultAction is set to: "phase:2,drop"

Any ideas what might be wrong?

Thanks,
 Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100316/c6f42067/attachment.html 

From ryan.barnett at breach.com  Tue Mar 16 09:43:44 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Tue, 16 Mar 2010 09:43:44 -0400
Subject: [Owasp-modsecurity-core-rule-set] Help debugging a false
	positive
In-Reply-To: <4c9cc6791003151603o2e76aec5nc66ff4d9a688a0c2@mail.gmail.com>
References: <4c9cc6791003151603o2e76aec5nc66ff4d9a688a0c2@mail.gmail.com>
Message-ID: <201003160943.44700.ryan.barnett@breach.com>

On Monday 15 March 2010 19:03:38 Chris Datfung wrote:
> I'm running the latest 2.0.6 CRS and every time I put the ruleset in
> prevention mode various parts of my app stop working, but I can't seem to
> debug exactly what's wrong. 

When you say "put the ruleset in prevent mode" you mean that you changed the disruptive 
action in the SecDefaultAction directive n the modsecurity_crs_10_config.conf file from pass 
to drop, correct?  This setting will be inherited by the anomaly scoring rules in the 
49/59 files that use the block action and by any rules that do not explicitly specify an 
action.  The last part is what is causing you problems, see below.

> For example, when I try to download an .iso
> image the request is stopped. Below are sections B, H and K from the
> generated event.
> 
> --c6541f33-B--
> GET /image-1.6.iso HTTP/1.0
> User-Agent: Opera/9.80 (X11; Linux i686; U; en) Presto/2.2.15 Version/10.10
> Host: host.com
> Accept: text/html, application/xml;q=0.9, application/xhtml+xml, image/png,
> image/jpeg, image/gif, image/x-xbitmap, */*;q=0.1
> Accept-Language: en-US,en;q=0.9
> Accept-Charset: iso-8859-1, utf-8, utf-16, *;q=0.1
> Accept-Encoding: deflate, gzip, x-gzip, identity, *;q=0
> Proxy-Connection: Keep-Alive
> 
> --c6541f33-H--
> Message: Access denied with connection close (phase 1). String match
> "xxx.xxx.xxx.xxx" at REMOTE_ADDR. [file "/opt/modsecurity/etc/
> www.host.com/rules.conf"] [line "5"]
> Action: Intercepted (phase 1)
> Stopwatch: 1268690880578066 1617 (- - -)
> Producer: ModSecurity for Apache/2.5.12 (http://www.modsecurity.org/); core
> ruleset/2.0.6.
> Server: Apache/2.2.9 mod_ssl/2.2.9 OpenSSL/0.9.8g
> WebApp-Info: "host" "-" "-"
> 
> --c6541f33-K--
> SecAction
> "phase:1,auditlog,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remo
> te_addr}" SecAction
> "phase:1,auditlog,t:none,nolog,pass,setvar:tx.paranoid_mode=0" SecAction
> "phase:1,auditlog,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_level=2
> 00" SecAction
> "phase:1,auditlog,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_level=
> 200" SecAction
> "phase:1,auditlog,t:none,nolog,pass,setvar:tx.critical_anomaly_score=20,set
> var:tx.error_anomaly_score=15,setvar:tx.warning_anomaly_score=10,setvar:tx.
> notice_anomaly_score=5" SecAction
> "phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_num_args=255"
> 
> The rule at /opt/modsecurity/etc/www.host.com/rules.conf is:
> 
> SecRule REMOTE_ADDR "@streq xxx.xxx.xxx.xxx"
> phase:1,ctl:ruleEngine=On,ctl:auditEngine=On,ctl:debugLogLevel=9
> 

This looks like a custom rule that is not part of the CRS and it appears as though you 
intend to generate some debug logging based on the traffic of a specific client.  In this 
case, you want to make sure to always specify the proper action so that it does not 
inherit the SecDefaultAction (in this case of drop).  Update your SecRule above and 
include "pass" on it.

> finally the SecDefaultAction is set to: "phase:2,drop"
> 
> Any ideas what might be wrong?
> 
> Thanks,
>  Chris

From jim at mcintyresecurity.com  Fri Mar 19 14:09:16 2010
From: jim at mcintyresecurity.com (James McIntyre)
Date: Fri, 19 Mar 2010 14:09:16 -0400
Subject: [Owasp-modsecurity-core-rule-set] id "970903"] [msg "ASP/JSP source
	code leakage
Message-ID: <1269022156.4ba3bdcc6c900@localhost>



I am receiving the following messages in modsec_audit. Can anyone
point me in the direction of determining / deciphering what modsec is
identifying as a problem ?

Message: Match of "rx
(?:\\b(?:(?:i(?:nterplay|hdr|d3)|m(?:ovi|thd)|r(?:ar!|iff)|(?:ex|jf)if|f(?:lv|ws)|varg|cws)\\b|gif)|B(?:%pdf|\\.ra)\\b)"
against "RESPONSE_BODY" required. [file
"/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_50_outbound.conf"]
[line "38"] [id "970903"] [msg "ASP/JSP source code leakage"] [severi
ty "ERROR"] [tag "LEAKAGE/SOURCE_CODE"]

Message: Warning. Operator GE matched 5 at TX:anomaly_score. [file
"/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_60_correlation.conf"]
[line "44"] [msg "Tr
ansactional Anomaly Score (score 15): ASP/JSP source code leakage"]

system: fedora 12
apache: 2.2.14-1
mod_security-2.5.10-2

Appreciate any assistance....jim

-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100319/203b8651/attachment.html 

From ryan.barnett at breach.com  Fri Mar 19 14:13:55 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Fri, 19 Mar 2010 14:13:55 -0400
Subject: [Owasp-modsecurity-core-rule-set] id "970903"] [msg "ASP/JSP
	source code leakage
In-Reply-To: <1269022156.4ba3bdcc6c900@localhost>
References: <1269022156.4ba3bdcc6c900@localhost>
Message-ID: <201003191413.55487.ryan.barnett@breach.com>

On Friday 19 March 2010 14:09:16 James McIntyre wrote:
> I am receiving the following messages in modsec_audit. Can anyone point me
> in the direction of determining / deciphering what modsec is identifying
> as a problem ?
> 
> Message: Match of "rx
> (?:\\b(?:(?:i(?:nterplay|hdr|d3)|m(?:ovi|thd)|r(?:ar!|iff)|(?:ex|jf)if|f(?
> :lv|ws)|varg|cws)\\b|gif)|B(?:%pdf|\\.ra)\\b)" against "RESPONSE_BODY"
> required. [file
> "/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_50_outbound.conf"]
> [line "38"] [id "970903"] [msg "ASP/JSP source code leakage"] [severi ty
> "ERROR"] [tag "LEAKAGE/SOURCE_CODE"]
> 
> 
> Message: Warning. Operator GE matched 5 at TX:anomaly_score. [file
> "/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_60_correlation.conf"]
> [line "44"] [msg "Tr ansactional Anomaly Score (score 15): ASP/JSP source
> code leakage"]
> 
> system: fedora 12
> apache: 2.2.14-1
> mod_security-2.5.10-2
> 
> 
> Appreciate any assistance....jim

Rule ID 970903 is looking for the existence of "<%" in response body content as this is 
most likely indicative of some server-side code that did not properly execute.  The alert 
match data is a bit confusing as actually data from the 2nd part of the chained SecRule 
which is attempting to exclude common false positive strings.  I would look in the 
audit_log for this event and see where the "<%" data string is to see if if a false 
positive or not.

-Ryan

From ryan.barnett at breach.com  Tue Mar 23 11:24:14 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Tue, 23 Mar 2010 11:24:14 -0400
Subject: [Owasp-modsecurity-core-rule-set] [mod-security-users] CSRF
	Protection
In-Reply-To: <4c9cc6791003230816n17aa99d3xc7a3ec440e873ca9@mail.gmail.com>
References: <4c9cc6791003230816n17aa99d3xc7a3ec440e873ca9@mail.gmail.com>
Message-ID: <201003231124.14888.ryan.barnett@breach.com>

On Tuesday 23 March 2010 11:16:03 Chris Datfung wrote:
> I'm trying to implement CSRF protection in an app based on Ryan's example
> from the WAF Patching Challenge Whitepaper. My app uses a dynamic session
> token name where only the first four characters (SESS) are static. An
> example cookie name is:
> 
> SESSbe7bfb0d134fa57e567359f4e62cf41d
> 
> The problem I have is how to implement this rule:
> 
> SecRule &ARGS "@ge 1" "chain,phase:2,t:none,deny,log,msg:'CSRF Attack
> Detected - Invalid Token.'"
>  SecRule ARGS:MODSEC_CSRF_TOKEN "!@streq %{request_cookies.jsessionid}"
> 
> How do I compare MODSEC_CSRF_TOKEN to a cookie name where I only know the
> the first four characters. I tried:
> 
> SecRule ARGS:MODSEC_CSRF_TOKEN "!@streq %{request_cookies./^SESS/}
> 
> but that obviously didn't work. Any ideas how I can do this?
> 
> Thanks
>   Chris

How appropriate as I was getting ready to send out some announcements soon that we will be 
migrating some of the commercial Enhanced Rule Set (ERS) items to the CRS and CSRF 
protection rules are one of them :)

Once I add these rules to the CRS, I will send a note to the OWASP CRS mail-list with 
usage info.

-Ryan

From ryan.barnett at breach.com  Tue Mar 23 11:30:52 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Tue, 23 Mar 2010 11:30:52 -0400
Subject: [Owasp-modsecurity-core-rule-set] Documenting Attack Detection
	Methods
Message-ID: <201003231130.53125.ryan.barnett@breach.com>

Greetings everyone,
I wanted to send a note to the list to ask for comments on an idea.  I was thinking that 
on the OWASP CRS project site - 
http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project - that we 
need to have better documentation that explains how the CRS detects certain attack 
categories such as SQL Injection, XSS and RFI.

Would that be helpful to users?

If so, what I would like to do is to try and tackle each topic one by one as a discussion 
item on the mail-list.  Once we have all had a chance to discuss, then I will update the 
CRS Project site with the consensus data.

Sound good?

-Ryan

From dreamice.jiang at gmail.com  Tue Mar 23 11:36:04 2010
From: dreamice.jiang at gmail.com (Junyong Jiang)
Date: Tue, 23 Mar 2010 23:36:04 +0800
Subject: [Owasp-modsecurity-core-rule-set] [mod-security-users] CSRF
	Protection
In-Reply-To: <201003231124.14888.ryan.barnett@breach.com>
References: <4c9cc6791003230816n17aa99d3xc7a3ec440e873ca9@mail.gmail.com>
	<201003231124.14888.ryan.barnett@breach.com>
Message-ID: <d5dfca261003230836u70379f8di577c1da138770b66@mail.gmail.com>

Good news. Can you share some information in advance:)

2010/3/23 Ryan Barnett <ryan.barnett at breach.com>

> On Tuesday 23 March 2010 11:16:03 Chris Datfung wrote:
> > I'm trying to implement CSRF protection in an app based on Ryan's example
> > from the WAF Patching Challenge Whitepaper. My app uses a dynamic session
> > token name where only the first four characters (SESS) are static. An
> > example cookie name is:
> >
> > SESSbe7bfb0d134fa57e567359f4e62cf41d
> >
> > The problem I have is how to implement this rule:
> >
> > SecRule &ARGS "@ge 1" "chain,phase:2,t:none,deny,log,msg:'CSRF Attack
> > Detected - Invalid Token.'"
> >  SecRule ARGS:MODSEC_CSRF_TOKEN "!@streq %{request_cookies.jsessionid}"
> >
> > How do I compare MODSEC_CSRF_TOKEN to a cookie name where I only know the
> > the first four characters. I tried:
> >
> > SecRule ARGS:MODSEC_CSRF_TOKEN "!@streq %{request_cookies./^SESS/}
> >
> > but that obviously didn't work. Any ideas how I can do this?
> >
> > Thanks
> >   Chris
>
> How appropriate as I was getting ready to send out some announcements soon
> that we will be
> migrating some of the commercial Enhanced Rule Set (ERS) items to the CRS
> and CSRF
> protection rules are one of them :)
>
> Once I add these rules to the CRS, I will send a note to the OWASP CRS
> mail-list with
> usage info.
>
> -Ryan
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100323/2520d4ea/attachment.html 

From yersinia.spiros at gmail.com  Tue Mar 23 12:04:40 2010
From: yersinia.spiros at gmail.com (yersinia)
Date: Tue, 23 Mar 2010 17:04:40 +0100
Subject: [Owasp-modsecurity-core-rule-set] Documenting Attack Detection
	Methods
In-Reply-To: <201003231130.53125.ryan.barnett@breach.com>
References: <201003231130.53125.ryan.barnett@breach.com>
Message-ID: <b086760e1003230904q63f927aw1ce6327a518bea57@mail.gmail.com>

On Tue, Mar 23, 2010 at 4:30 PM, Ryan Barnett <ryan.barnett at breach.com>wrote:

> Greetings everyone,
> I wanted to send a note to the list to ask for comments on an idea.  I was
> thinking that
> on the OWASP CRS project site -
>
> http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project- that we
> need to have better documentation that explains how the CRS detects certain
> attack
> categories such as SQL Injection, XSS and RFI.
>
> Would that be helpful to users?
>
> Many useful.

> If so, what I would like to do is to try and tackle each topic one by one
> as a discussion
> item on the mail-list.  Once we have all had a chance to discuss, then I
> will update the
> CRS Project site with the consensus data.
>
> Sound good?
>
Very good.

Regards

>
> -Ryan
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100323/5c05bd2a/attachment.html 

From jamuse at gmail.com  Tue Mar 23 19:45:04 2010
From: jamuse at gmail.com (Jamuse)
Date: Wed, 24 Mar 2010 01:45:04 +0200
Subject: [Owasp-modsecurity-core-rule-set] Documenting Attack Detection
	Methods
In-Reply-To: <201003231130.53125.ryan.barnett@breach.com>
References: <201003231130.53125.ryan.barnett@breach.com>
Message-ID: <8c1870621003231645t5eb71ae1v2ee25db5b5544511@mail.gmail.com>

On Tue, Mar 23, 2010 at 5:30 PM, Ryan Barnett <ryan.barnett at breach.com>wrote:

> Greetings everyone,
> I wanted to send a note to the list to ask for comments on an idea.  I was
> thinking that
> on the OWASP CRS project site -
>
> http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project- that we
> need to have better documentation that explains how the CRS detects certain
> attack
> categories such as SQL Injection, XSS and RFI.
>
> Would that be helpful to users?
>

Hi Ryan,

That would be very helpful. In addition, perhaps a section on how to
properly fix false positives by adjusting the anomaly score is another topic
that could use more documentation as well.

- J
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100324/6c6bf64a/attachment.html 

From yersinia.spiros at gmail.com  Wed Mar 24 05:23:09 2010
From: yersinia.spiros at gmail.com (yersinia)
Date: Wed, 24 Mar 2010 10:23:09 +0100
Subject: [Owasp-modsecurity-core-rule-set] Documenting Attack Detection
	Methods
In-Reply-To: <8c1870621003231645t5eb71ae1v2ee25db5b5544511@mail.gmail.com>
References: <201003231130.53125.ryan.barnett@breach.com>
	<8c1870621003231645t5eb71ae1v2ee25db5b5544511@mail.gmail.com>
Message-ID: <b086760e1003240223l52382a4bl2fdd02cc917956b1@mail.gmail.com>

On Wed, Mar 24, 2010 at 12:45 AM, Jamuse <jamuse at gmail.com> wrote:

> On Tue, Mar 23, 2010 at 5:30 PM, Ryan Barnett <ryan.barnett at breach.com>wrote:
>
>>
>> Would that be helpful to users?
>>
>
> Hi Ryan,
>
> That would be very helpful. In addition, perhaps a section on how to
> properly fix false positives by adjusting the anomaly score is another topic
> that could use more documentation as well.
>
> Also the mod_security handbook not have a clear section on this. Unchecked
on the latest update, however.

> - J
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100324/7d7db8ab/attachment.html 

From mlavi at sgi.com  Wed Mar 24 21:46:59 2010
From: mlavi at sgi.com (Mark Lavi)
Date: Wed, 24 Mar 2010 20:46:59 -0500
Subject: [Owasp-modsecurity-core-rule-set] CRS 2.0.6 Optional Rules: 42, 46,
	and 49
Message-ID: <074F0C4BE8F9FB4CB1410BF8D1E10B54AF2D9C@CF--AMER002E--3.americas.sgi.com>

Hello all,
 
I've upgraded to CRS 2.0.6 with ModSecurity 2.5.12 on my development web
server and reviewed the documentation on
http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_
Project#tab=Documentation. I've got a few questions that I haven't see
addressed in the last two months on the mailing list.
 
For the first three below, I've created empty files and then ModSecurity
could load and execute these rules. My question boils down to, how am I
supposed to populate these data files?
 
1) optional_rules/modsecurity_crs_42_comment_spam.conf: requires a data
file "optional_rules/modsecurity_42_comment_spam.data," but that doesn't
exist.
 
The documentation mentions a RBL check against SPAMHAUS, am I supposed
to provide the source IP address in this file?
 
2) optional_rules/modsecurity_crs_46_et_sql_injection.conf: requires a
data file "optional_rules/modsecurity_46_et_sql_injection.data," but
that doesn't exist.
3) optional_rules/modsecurity_crs_46_et_web_rules.conf: requires a data
file "optional_rules/modsecurity_46_et_web_rules.data," but that doesn't
exist.
 
I see that you're converting
http://www.emergingthreats.net/cgi-bin/cvsweb.cgi/rules/
<http://www.emergingthreats.net/cgi-bin/cvsweb.cgi/rules/>
emerging-web_server.rules and emerging-web_specific_apps.rules. Am I
supposed to pull down these Snort rule sets from their web site? I
imagine that I'm looking for your converted versions instead, is that
right?
 
4) optional_rules/modsecurity_crs_49_header_tagging.conf : Syntax error
on line 29 of optional_rules/modsecurity_crs_49_header_tagging.conf:
Invalid command 'RequestHeader', perhaps misspelled or defined by a
module not included in the server configuration.
 
I see this is an Apache directive for mod_headers
(http://httpd.apache.org/docs/2.2/mod/mod_headers.html), but this module
is disabled by default. It is not mentioned in mod_security's
installation documentation:
http://www.modsecurity.org/documentation/modsecurity-apache/2.5.12/modse
curity2-apache-reference.html#installation. 
 
Can we add a note to configure Apache with: --enable-headers for this
optional rule?
 
Also, would it be prudent to enclose the entire file or perhaps just the
RequestHeader lines inside a <IfModule mod_headers.c> </IfModule>
condition?  I did so and got ModSecurity to load this rule and start up.
 
Thanks,

Mark Lavi
Senior Web Producer

sgi

46600 Landing Parkway
Fremont, CA 94538
(510) 933-5234 direct
mlavi at sgi.com <blocked::mailto:mlavi at sgi.com>  
www.sgi.com <blocked::http://www.sgi.com/> 

 
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100324/8f6f7a65/attachment.html 

From ryan.barnett at breach.com  Wed Mar 24 22:40:42 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Wed, 24 Mar 2010 22:40:42 -0400
Subject: [Owasp-modsecurity-core-rule-set] CRS 2.0.6 Optional Rules: 42,
	46, and 49
In-Reply-To: <074F0C4BE8F9FB4CB1410BF8D1E10B54AF2D9C@CF--AMER002E--3.americas.sgi.com>
References: <074F0C4BE8F9FB4CB1410BF8D1E10B54AF2D9C@CF--AMER002E--3.americas.sgi.com>
Message-ID: <201003242240.42662.ryan.barnett@breach.com>

On Wednesday 24 March 2010 21:46:59 Mark Lavi wrote:
> Hello all,
> 
> I've upgraded to CRS 2.0.6 with ModSecurity 2.5.12 on my development web
> server and reviewed the documentation on
> http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Pr
> oject#tab=Documentation. I've got a few questions that I haven't see
> addressed in the last two months on the mailing list.
> 
> For the first three below, I've created empty files and then ModSecurity
> could load and execute these rules. My question boils down to, how am I
> supposed to populate these data files?
> 
> 1) optional_rules/modsecurity_crs_42_comment_spam.conf: requires a data
> file "optional_rules/modsecurity_42_comment_spam.data," but that doesn't
> exist.
> 
The various *.data files are actually in the base_rules dir so you can either copy/move the 
file over under the optional_rules dir or change the path to the file in the @pmFromFile 
operator.  I suggest the former.

> The documentation mentions a RBL check against SPAMHAUS, am I supposed to
> provide the source IP address in this file?
> 
The following rule in the 42 comment spam file will automatically take the client's IP from 
the REMOTE_ADDR variable and check it against the sbl-xml SPAMHAUS RBL -

SecRule REMOTE_ADDR "@rbl sbl-xbl.spamhaus.org" 
"phase:1,t:none,pass,nolog,auditlog,msg:'RBL Match for SPAM 
Source',tag:'AUTOMATION/MALICIOUS',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.automation_score=+%{tx.warning_anomaly_score},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.
%{rule.id}-
AUTOMATION/MALICIOUS-%{matched_var_name}=%{matched_var},setvar:ip.spammer=1,expirevar:ip.spammer=86400,setvar:ip.previous_rbl_check=1,expirevar:ip.previous_rbl_check=86400,skipAfter:END_RBL_CHECK"

This rule also sets a few variable so that it will only run a remote RBL check once per 
day/per IP address and it saves the results.  The various rules around this one 
(before/after) inspect the saved TX variables on subsequent requests.

> 2) optional_rules/modsecurity_crs_46_et_sql_injection.conf: requires a data
> file "optional_rules/modsecurity_46_et_sql_injection.data," but that
> doesn't exist. 

Same as above - suggest copying it from the base_rules dir.

> 3) optional_rules/modsecurity_crs_46_et_web_rules.conf:
> requires a data file "optional_rules/modsecurity_46_et_web_rules.data,"
> but that doesn't exist.
> 

Same as above.

> I see that you're converting
> http://www.emergingthreats.net/cgi-bin/cvsweb.cgi/rules/
> emerging-web_server.rules and emerging-web_specific_apps.rules. Am I
> supposed to pull down these Snort rule sets from their web site? I imagine
> that I'm looking for your converted versions instead, is that right?
> 

We have already done the conversion for you and the data is all in the 46 files.

> 4) optional_rules/modsecurity_crs_49_header_tagging.conf : Syntax error on
> line 29 of optional_rules/modsecurity_crs_49_header_tagging.conf: Invalid
> command 'RequestHeader', perhaps misspelled or defined by a module not
> included in the server configuration.
> 
> I see this is an Apache directive for mod_headers
> (http://httpd.apache.org/docs/2.2/mod/mod_headers.html), but this module
> is disabled by default. It is not mentioned in mod_security's installation
> documentation:
> http://www.modsecurity.org/documentation/modsecurity-apache/2.5.12/modsecu
> rity2-apache-reference.html#installation.
> 

This is a new experimental rule set and thus we haven't gone back to update any of the 
ModSecurity install data for it.  I believe it is best to mention it in the CRS README and 
in the comments for this file.

> Can we add a note to configure Apache with: --enable-headers for this
> optional rule?
> 
> Also, would it be prudent to enclose the entire file or perhaps just the
> RequestHeader lines inside a <IfModule mod_headers.c> </IfModule>
> condition?  I did so and got ModSecurity to load this rule and start up.
> 

Good idea.

On another note for the 49 request header tagging file - I am assuming you are running 
ModSecurity on a reverse proxy, correct?  This rules file will add Mod alert match data to 
some new Request Headers when it is proxied so that the destination server may inspect 
them and potentially take action.  Is this your intent?  Are you going to try and inspect 
these headers on the destination app?  I am interested in the request header concept as I 
believe that it has potential for WAFs to share data with the destination app servers but 
it is a new concept and I want to get feedback from users.

Cheers,
Ryan

From AFaller at excelsior.edu  Thu Mar 25 15:29:24 2010
From: AFaller at excelsior.edu (AFaller at excelsior.edu)
Date: Thu, 25 Mar 2010 15:29:24 -0400
Subject: [Owasp-modsecurity-core-rule-set] Unknown blockage
In-Reply-To: <201003251443.21297.ryan.barnett@breach.com>
Message-ID: <OFB334781B.052CB5B3-ON852576F1.006A6DE0-852576F1.006B1028@excelsior.edu>

Hi - 

I'm upgrading from Core Rules 1.x to 2.0.6, and for the life of me I can't 
figure out whats blocking a bunch of requests going to images, css and 
auxilary files after I set my secdefaultaction from pass --> fail.

I'm running modsec 2.5.12 on httpd 2.2.14 on redhat 4 in a proxy 
situation.  Below is the audit log of a failed transaction.  I've scrubbed 
some cookies, IPs and such.  Many of the rules that it matched on don't 
make sense - for instance two seem to reference content in my GET, but as 
you can see from the audit log - that is not true.

basically, I switch from SecDefaultAction "phase:2,pass" to 
SecDefaultAction "phase:2,deny" and things blow up.

Thanks in advance.

--c7bc2307-A--
[25/Mar/2010:15:17:52 --0400] S6u24KwQx3QAAD98Wq4AAAAF xxxxxx 4913 xxxxxxx 
8081
--c7bc2307-B--
GET /portal/page/portal/EC_Images/Navigation/SHADOW_WHITE.gif HTTP/1.1
Host: portaltest.xxxxxxxxxxxx
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.2.2) 
Gecko/20100316 Firefox/3.6.2 (.NET CLR 3.5.30729)
Accept: image/png,image/*;q=0.8,*/*;q=0.5
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip,deflate
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
Keep-Alive: 115
Connection: keep-alive
Referer: https://portaltest.xxxxxxxxx
Cookie: ZZZZZZZZZZZZZ
Cache-Control: max-age=0
--c7bc2307-F--
HTTP/1.1 403 Forbidden
Last-Modified: Wed, 28 May 2008 15:12:28 GMT
ETag: "1958230-432-44e4bd7454f00"
Accept-Ranges: bytes
Vary: User-Agent
Keep-Alive: timeout=15, max=199
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/html
--c7bc2307-H--
Action: Intercepted (phase 4)
Stopwatch: 1269544672616177 32476 (1886 4785 -)
Producer: ModSecurity for Apache/2.5.12 (http://www.modsecurity.org/); 
core ruleset/2.0.6.
Server: Apache/2.2.14 (Unix) mod_ssl/2.2.14 OpenSSL/0.9.7a mod_jk/1.2.28
--c7bc2307-K--
SecAction 
"phase:1,auditlog,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remote_addr}"
SecAction "phase:1,auditlog,t:none,nolog,pass,setvar:tx.paranoid_mode=0"
SecAction 
"phase:1,auditlog,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_level=20"
SecAction 
"phase:1,auditlog,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_level=15"
SecAction 
"phase:1,auditlog,t:none,nolog,pass,setvar:tx.critical_anomaly_score=20,setvar:tx.error_anomaly_score=15,setvar:tx.warning_anomaly_score=10,setvar:tx.notice_anomaly_score=5"
SecAction "phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_num_args=255"
SecAction 
"phase:1,auditlog,t:none,nolog,pass,setvar:'tx.allowed_methods=GET HEAD 
POST 
OPTIONS',setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded 
multipart/form-data text/xml 
application/xml',setvar:'tx.allowed_http_versions=HTTP/0.9 HTTP/1.0 
HTTP/1.1',setvar:'tx.restricted_extensions=.asa .asax .ascx .axd .backup 
.bak .bat .cdx .cer .cfg .cmd .com .config .conf .cs .csproj .csr .dat .db 
.dbf .dll .dos .htr .htw .ida .idc .idq .inc .ini .key .licx .lnk .log 
.mdb .old .pass .pdb .pol .printer .pwd .resources .resx .sql .sys .vb 
.vbs .vbproj .vsdisco .webinfo .xsd 
.xsx',setvar:'tx.restricted_headers=Lock-Token Content-Range Translate via 
if'"
SecRule "REQUEST_METHOD" "@rx ^(?:GET|HEAD)$" 
"phase:2,chain,rev:2.0.6,t:none,pass,nolog,auditlog,msg:'GET or HEAD 
requests with 
bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,tag:http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3"
SecRule "&REQUEST_HEADERS:Content-Type" "@eq 0" 
"phase:2,deny,chain,rev:2.0.6,t:none,nolog,auditlog,msg:'Request 
Containing Content, but Missing Content-Type header',id:960904,severity:5"
SecRule "&TX:MAX_NUM_ARGS" "@eq 1" 
"phase:2,chain,t:none,pass,nolog,auditlog,msg:'Too many arguments in 
request',id:960335,severity:4,rev:2.0.6"
SecRule "REQUEST_BASENAME" "@rx \\.(.*)$" 
"phase:2,chain,capture,t:none,t:urlDecodeUni,t:lowercase,pass,nolog,auditlog,msg:'URL 
file extension is restricted by 
policy',severity:2,id:960035,tag:POLICY/EXT_RESTRICTED,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,logdata:%{TX.0}"
SecRule "TX:PARANOID_MODE" "!@eq 1" 
"phase:2,t:none,nolog,skipAfter:END_SESSION_FIXATION"
SecRule "TX:PARANOID_MODE" "!@eq 1" 
"phase:2,t:none,nolog,skipAfter:END_FILE_INJECTION"
SecRule "TX:PARANOID_MODE" "!@eq 1" 
"phase:2,t:none,nolog,skipAfter:END_COMMAND_ACCESS"
SecRule "TX:PARANOID_MODE" "!@eq 1" 
"phase:2,t:none,nolog,skipAfter:END_COMMAND_INJECTION"
SecRule "TX:PARANOID_MODE" "!@eq 1" 
"phase:2,rev:2.0.6,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK"
SecRule "TX:PARANOID_MODE" "!@eq 1" 
"phase:2,t:none,nolog,skipAfter:END_XSS_CHECK"
SecRule "RESPONSE_BODY" "!@pm iframe" 
"phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,nolog,skipAfter:END_IFRAME_CHECK"
SecRule "RESPONSE_BODY" "!@pmFromFile modsecurity_50_outbound.data" 
"phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,nolog,skipAfter:END_OUTBOUND_CHECK"
--c7bc2307-Z--
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100325/5aea6eb2/attachment.html 

From ard at 100.pfr.ru  Thu Mar 25 16:10:53 2010
From: ard at 100.pfr.ru (Artyom Davidov)
Date: Thu, 25 Mar 2010 23:10:53 +0300
Subject: [Owasp-modsecurity-core-rule-set] Ha:  Unknown blockage
In-Reply-To: <OFB334781B.052CB5B3-ON852576F1.006A6DE0-852576F1.006B1028@excelsior.edu>
Message-ID: <OFF58571F7.B9392A85-ONC32576F1.006D0CEB-C32576F1.006EDC9F@100.pfr.ru>

> 
> Hi - 
> 
> I'm upgrading from Core Rules 1.x to 2.0.6, and for the life of me I
> can't figure out whats blocking a bunch of requests going to images,
> css and auxilary files after I set my secdefaultaction from pass --> 
fail. 
> 
> I'm running modsec 2.5.12 on httpd 2.2.14 on redhat 4 in a proxy 
> situation.  Below is the audit log of a failed transaction.  I've 
> scrubbed some cookies, IPs and such.  Many of the rules that it 
> matched on don't make sense - for instance two seem to reference 
> content in my GET, but as you can see from the audit log - that is not 
true. 
> 
> basically, I switch from SecDefaultAction "phase:2,pass" to 
> SecDefaultAction "phase:2,deny" and things blow up. 
> 
> Thanks in advance. 
> 
[...skipped...]
> SecRule "RESPONSE_BODY" "!@pmFromFile modsecurity_50_outbound.data" 
> "phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,
> nolog,skipAfter:END_OUTBOUND_CHECK" 

Hmmm... Strange.
It seems that a part of the bug with id "CORERULES-36" is still in place.
Just checked modsecurity_crs_50_outbound.conf and it looks like it's still 
missing default action in this rule.
We've got the same behaviour with 2.0.5 rules until we've added a "pass" 
default action to this rule.
So the corrected rule should look like the following:

SecRule RESPONSE_BODY "!@pmFromFile modsecurity_50_outbound.data" \
 
"phase:4,rev:'2.0.6',t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,pass,nolog,skipAfter:END_OUTBOUND_CHECK"

Strange though. Maybe Ryan can comment on this.

wbr
Artyom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100325/abde635e/attachment.html 

From ryan.barnett at breach.com  Thu Mar 25 16:27:52 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Thu, 25 Mar 2010 16:27:52 -0400
Subject: [Owasp-modsecurity-core-rule-set] Ha:  Unknown blockage
In-Reply-To: <OFF58571F7.B9392A85-ONC32576F1.006D0CEB-C32576F1.006EDC9F@100.pfr.ru>
References: <OFF58571F7.B9392A85-ONC32576F1.006D0CEB-C32576F1.006EDC9F@100.pfr.ru>
Message-ID: <201003251627.53103.ryan.barnett@breach.com>

On Thursday 25 March 2010 16:10:53 Artyom Davidov wrote:
> > Hi -
> > 
> > I'm upgrading from Core Rules 1.x to 2.0.6, and for the life of me I
> > can't figure out whats blocking a bunch of requests going to images,
> > css and auxilary files after I set my secdefaultaction from pass -->
> > fail.
> > 
> > I'm running modsec 2.5.12 on httpd 2.2.14 on redhat 4 in a proxy
> > situation.  Below is the audit log of a failed transaction.  I've
> > scrubbed some cookies, IPs and such.  Many of the rules that it
> > matched on don't make sense - for instance two seem to reference
> > content in my GET, but as you can see from the audit log - that is not
> > true.
> > 
> > basically, I switch from SecDefaultAction "phase:2,pass" to
> > SecDefaultAction "phase:2,deny" and things blow up.
> > 
> > Thanks in advance.
> 
> [...skipped...]
> 
> > SecRule "RESPONSE_BODY" "!@pmFromFile modsecurity_50_outbound.data"
> > "phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,
> > nolog,skipAfter:END_OUTBOUND_CHECK"
> 
> Hmmm... Strange.
> It seems that a part of the bug with id "CORERULES-36" is still in place.
> Just checked modsecurity_crs_50_outbound.conf and it looks like it's still
> missing default action in this rule. We've got the same behaviour with
> 2.0.5 rules until we've added a "pass" default action to this rule. So the
> corrected rule should look like the following:
> 
> SecRule RESPONSE_BODY "!@pmFromFile modsecurity_50_outbound.data" \
>        
> "phase:4,rev:'2.0.6',t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,pass
> ,nolog,skipAfter:END_OUTBOUND_CHECK"
> 
> Strange though. Maybe Ryan can comment on this.
> 

Your comments are correct in that those @pmFromFile prequalifier check rules were missing a 
disruptive action specification (in this case - pass) and they therefore inherited the 
default one set in SecDefaultAction.  I did fix these missing ones in the 50 outbound file 
in the source however they are not in CRS 2.0.6.  They will be in v2.0.7.  In the 
meantime, just manually add the "pass" action to those rules in the 50 file that have a 
ctl:skipAfter action.

-Ryan

-Ryan
> wbr
> Artyom

From ard at 100.pfr.ru  Thu Mar 25 16:33:52 2010
From: ard at 100.pfr.ru (Artyom Davidov)
Date: Thu, 25 Mar 2010 23:33:52 +0300
Subject: [Owasp-modsecurity-core-rule-set] Ha:  Unknown blockage
In-Reply-To: <201003251627.53103.ryan.barnett@breach.com>
Message-ID: <OF7A3B3C03.A5B6D9B5-ONC32576F1.0070D328-C32576F1.0070F72C@100.pfr.ru>

Ryan Barnett <ryan.barnett at breach.com> wrote 25.03.2010 23:27:52:

> On Thursday 25 March 2010 16:10:53 Artyom Davidov wrote:
> > > Hi -
> > > 
> > > I'm upgrading from Core Rules 1.x to 2.0.6, and for the life of me I
> > > can't figure out whats blocking a bunch of requests going to images,
> > > css and auxilary files after I set my secdefaultaction from pass -->
> > > fail.
> > > 
> > > I'm running modsec 2.5.12 on httpd 2.2.14 on redhat 4 in a proxy
> > > situation.  Below is the audit log of a failed transaction.  I've
> > > scrubbed some cookies, IPs and such.  Many of the rules that it
> > > matched on don't make sense - for instance two seem to reference
> > > content in my GET, but as you can see from the audit log - that is 
not
> > > true.
> > > 
> > > basically, I switch from SecDefaultAction "phase:2,pass" to
> > > SecDefaultAction "phase:2,deny" and things blow up.
> > > 
> > > Thanks in advance.
> > 
> > [...skipped...]
> > 
> > > SecRule "RESPONSE_BODY" "!@pmFromFile modsecurity_50_outbound.data"
> > > "phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,
> > > nolog,skipAfter:END_OUTBOUND_CHECK"
> > 
> > Hmmm... Strange.
> > It seems that a part of the bug with id "CORERULES-36" is still in 
place.
> > Just checked modsecurity_crs_50_outbound.conf and it looks like it's 
still
> > missing default action in this rule. We've got the same behaviour with
> > 2.0.5 rules until we've added a "pass" default action to this rule. So 
the
> > corrected rule should look like the following:
> > 
> > SecRule RESPONSE_BODY "!@pmFromFile modsecurity_50_outbound.data" \
> > 
> > 
"phase:4,rev:'2.0.6',t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,pass
> > ,nolog,skipAfter:END_OUTBOUND_CHECK"
> > 
> > Strange though. Maybe Ryan can comment on this.
> > 
> 
> Your comments are correct in that those @pmFromFile prequalifier 
> check rules were missing a 
> disruptive action specification (in this case - pass) and they 
> therefore inherited the 
> default one set in SecDefaultAction.  I did fix these missing ones 
> in the 50 outbound file 
> in the source however they are not in CRS 2.0.6.  They will be in 
> v2.0.7.  In the 
> meantime, just manually add the "pass" action to those rules in the 
> 50 file that have a 
> ctl:skipAfter action.
> 
> -Ryan

Now it is clear. Thank you Ryan.

wbr
Artyom
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100325/b5ddfb8a/attachment-0001.html 

From chris.datfung at gmail.com  Thu Mar 25 16:53:39 2010
From: chris.datfung at gmail.com (Chris Datfung)
Date: Thu, 25 Mar 2010 22:53:39 +0200
Subject: [Owasp-modsecurity-core-rule-set] Core Rule Set Community
	Involvement
Message-ID: <4c9cc6791003251353r5d12df18wd97ba4aaa32c55f0@mail.gmail.com>

I assumed when Breach moved the CRS over to be a OWASP project, the intent
was to get the community move involved. Now that it has been a couple
months, I was wondering what Breach's plan's are for community involvement?
Can we get more involved?

- Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100325/2de92f93/attachment.html 

From ryan.barnett at breach.com  Thu Mar 25 17:05:36 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Thu, 25 Mar 2010 17:05:36 -0400
Subject: [Owasp-modsecurity-core-rule-set] Core Rule Set Community
	Involvement
In-Reply-To: <4c9cc6791003251353r5d12df18wd97ba4aaa32c55f0@mail.gmail.com>
References: <4c9cc6791003251353r5d12df18wd97ba4aaa32c55f0@mail.gmail.com>
Message-ID: <201003251705.36591.ryan.barnett@breach.com>

On Thursday 25 March 2010 16:53:39 Chris Datfung wrote:
> I assumed when Breach moved the CRS over to be a OWASP project, the intent
> was to get the community move involved. Now that it has been a couple
> months, I was wondering what Breach's plan's are for community
> involvement? Can we get more involved?
> 
> - Chris

Absolutely.  The first item of business, as I see it, is with regards to documentation.  
That was the main driver for moving to OWASP - the wiki project site capabilities.  Now, 
anyone can create an OWASP account and go in a edit whatever you want.  The Core Rule Set 
needs much better documentation, use cases, exceptions, etc...  

As I stated in another email thread a day or so ago - I am going to initiate this 
documentation soon.  I will pick one attack that the CRS addresses and then we will 
discuss it on the mail-list.  I will then update the OWASP project site with the 
documentation.  This can then be used as the "template" format for documenting how the CRS 
addresses issues.  With this in place, then anyone in the community can go in, copy the 
template and document a new attack mitigation.

This will be a HUGE step in the right direction.

-Ryan

