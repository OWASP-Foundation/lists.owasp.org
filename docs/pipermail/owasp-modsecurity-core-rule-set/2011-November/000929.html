<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] How to replace response	key	words
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20to%20replace%20response%0A%09key%09words&In-Reply-To=CAE2E0r2u0ACMeH0BqbFyfS_yjPB7wONWqa2hBSK58d-24UcwJQ%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000928.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] How to replace response	key	words</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20How%20to%20replace%20response%0A%09key%09words&In-Reply-To=CAE2E0r2u0ACMeH0BqbFyfS_yjPB7wONWqa2hBSK58d-24UcwJQ%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] How to replace response	key	words">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Nov 30 22:00:20 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000928.html">[Owasp-modsecurity-core-rule-set] How to replace response key	words
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#929">[ date ]</a>
              <a href="thread.html#929">[ thread ]</a>
              <a href="subject.html#929">[ subject ]</a>
              <a href="author.html#929">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Try enabling SecContentInjection On.

Ryan

On Nov 30, 2011, at 8:16 PM, &quot;dreamice&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dreamice.jiang at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dreamice.jiang at gmail.com</A>&gt;&gt; wrote:

Thanks for your reply!
I use the latest version(httpd-2.2.21 and mod-2.6.2),and I write the rule as follow:
SecStreamOutBodyInspection On
SecRule STREAM_OUTPUT_BODY &quot;@rsub s/1111/xxxx/&quot; &quot;phase:4,t:none,log,auditlog,pass&quot;

my default page is:
&lt;html&gt;&lt;body&gt;&lt;h1&gt;It works!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
1111

After I restart the httpd, I request the index.html page, the &quot;1111&quot; has not been replaced.
I global set SecRuleEngine On, what is the problem with my operation?

Thanks in advance!



2011/11/24 Josh Amishav-Zlatin &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jamuse at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jamuse at gmail.com</A>&gt;&gt;
On Thu, Nov 24, 2011 at 1:51 PM, dreamice &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dreamice.jiang at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dreamice.jiang at gmail.com</A>&gt;&gt; wrote:
&gt;<i> Hi,
</I>&gt;<i> I want to replace the response key words. Such as if the response data
</I>&gt;<i> include &quot;Fuck&quot;, I want to write a rule to replace it with &quot;****&quot;, how can I
</I>&gt;<i> do it?
</I>
If your using 2.6.0 or later then use the @rsub operator.

--
 - Josh

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000928.html">[Owasp-modsecurity-core-rule-set] How to replace response key	words
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#929">[ date ]</a>
              <a href="thread.html#929">[ thread ]</a>
              <a href="subject.html#929">[ subject ]</a>
              <a href="author.html#929">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
