<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Limiting Brute Force Blocks to	protected_urls
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Limiting%20Brute%20Force%20Blocks%20to%0A%09protected_urls&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000922.html">
   <LINK REL="Next"  HREF="000924.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Limiting Brute Force Blocks to	protected_urls</H1>
    <B>danil at whiterose.org</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Limiting%20Brute%20Force%20Blocks%20to%0A%09protected_urls&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] Limiting Brute Force Blocks to	protected_urls">danil at whiterose.org
       </A><BR>
    <I>Fri Nov 11 11:30:07 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000922.html">[Owasp-modsecurity-core-rule-set] a question about rules	&quot;t:decodeXXX&quot; instructions and owasp codecs
</A></li>
        <LI>Next message: <A HREF="000924.html">[Owasp-modsecurity-core-rule-set] What is this rule means?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#923">[ date ]</a>
              <a href="thread.html#923">[ thread ]</a>
              <a href="subject.html#923">[ subject ]</a>
              <a href="author.html#923">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
I'm looking at using modsecurity_crs_11_brute_force as a way of mitigating
a 
short list of urls that are vulnerable to enumeration attacks.

My UX designers are not happy about the fact that the block, when it goes
into 
effect, restricts all requests from the attacking IP address.

So I'm considering adding an entry to skip the brute force checks if 
REQUEST_FILENAME does not match a protected URL.

The current implementation looks like


   Include conf/modsecurity_crs/*.conf

   SecRule REQUEST_FILENAME &quot;!@within %{tx.brute_force_protected_urls}&quot; 
&quot;phase:1,id:'88888',t:none,nolog,pass,skipAfter:END_BRUTE_FORCE_PROTECTION_C
HECK
S&quot;

   Include 
conf/modsecurity_crs/experimental_rules/modsecurity_crs_11_brute_force.conf

Have I introduced a new weakness by doing this?

Thank you,
Danil



--------------------------------------------------------------------
mail2web LIVE &#150; Free email based on Microsoft&#174; Exchange technology -
<A HREF="http://link.mail2web.com/LIVE">http://link.mail2web.com/LIVE</A>


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000922.html">[Owasp-modsecurity-core-rule-set] a question about rules	&quot;t:decodeXXX&quot; instructions and owasp codecs
</A></li>
	<LI>Next message: <A HREF="000924.html">[Owasp-modsecurity-core-rule-set] What is this rule means?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#923">[ date ]</a>
              <a href="thread.html#923">[ thread ]</a>
              <a href="subject.html#923">[ subject ]</a>
              <a href="author.html#923">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
