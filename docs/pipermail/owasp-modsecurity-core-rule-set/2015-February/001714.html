<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Exception for DoS rules for IP	range
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Exception%20for%20DoS%20rules%20for%20IP%0A%09range&In-Reply-To=%3CDUB126-W700C97AFD03E3E189A67FD82230%40phx.gbl%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001713.html">
   <LINK REL="Next"  HREF="001715.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Exception for DoS rules for IP	range</H1>
    <B>Barry Pollard</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Exception%20for%20DoS%20rules%20for%20IP%0A%09range&In-Reply-To=%3CDUB126-W700C97AFD03E3E189A67FD82230%40phx.gbl%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Exception for DoS rules for IP	range">barry_pollard at hotmail.com
       </A><BR>
    <I>Fri Feb 13 11:36:12 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001713.html">[Owasp-modsecurity-core-rule-set] Modsecurity - Symphony rules
</A></li>
        <LI>Next message: <A HREF="001715.html">[Owasp-modsecurity-core-rule-set] Exception for DoS rules for IP range
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1714">[ date ]</a>
              <a href="thread.html#1714">[ thread ]</a>
              <a href="subject.html#1714">[ subject ]</a>
              <a href="author.html#1714">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Is it possible to exclude&#160;modsecurity_crs_11_dos_protection.conf rules only for certain IP ranges?

Our internal test suites are being flagged with this (as expected as they run a lot of tests in a short period of time) so I would like them excluded. However I want the other CRS tests to be included in case we add changes that cause issues with them (and also because ModSecurity is proving quite helpful in identifying issues in our code!).

I also don't want to have to set SecRuleEngine to DetectionOnly in test, and ignore the DoS errors as there are a lot of them in the logs and could easily lead to real alerts being ignored.

I could just not include this conf file on test environments but would prefer to keep my production and testing configuration the same, with a few exceptions I have based on environment variables (e.g. to have extra logging on in test). Or is there a way to only include files in Apache based on an environment variable?

I also tried to use SecRuleRemoveByMsg but think that checks the actual rule message configured in the rule, rather than the one outputted after the rule runs, so below does not work to exclude 127.0.x.x IP addresses for example:

#Remove internal IPs from DoS blocking so Testing can run scripts
SecRuleRemoveByMsg &quot;Denial of Service \(DoS\) Attack Identified from 127\.0&quot;
SecRuleRemoveByMsg &quot;Potential Denial of Service \(DoS\) Attack from 127\.0&quot;

On a separate but related topic, why are these still marked as &quot;experimental&quot; rules rather than optional ones despite being over two years old? Is there a definition on this? Are there extra risks for the experimental rules that I should be aware of and are they not recommended for production use?

Finally is there a way of searching the mail archives in case any of this has been asked before as going step by step through the posts on <A HREF="http://lists.owasp.org.pipermail/owasp-modsecurity-core-rule-set/">http://lists.owasp.org.pipermail/owasp-modsecurity-core-rule-set/</A> isn't the easiest.

Thanks,
Barry 		 	   		  
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001713.html">[Owasp-modsecurity-core-rule-set] Modsecurity - Symphony rules
</A></li>
	<LI>Next message: <A HREF="001715.html">[Owasp-modsecurity-core-rule-set] Exception for DoS rules for IP range
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1714">[ date ]</a>
              <a href="thread.html#1714">[ thread ]</a>
              <a href="subject.html#1714">[ subject ]</a>
              <a href="author.html#1714">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
