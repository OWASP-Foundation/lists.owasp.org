<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] block CONNECT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20block%20CONNECT&In-Reply-To=%3C54D85BFD.9050809%40gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001708.html">
   <LINK REL="Next"  HREF="001710.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] block CONNECT</H1>
    <B>Aniyan Rajan</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20block%20CONNECT&In-Reply-To=%3C54D85BFD.9050809%40gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] block CONNECT">aniyan.rajan6 at gmail.com
       </A><BR>
    <I>Mon Feb  9 07:04:29 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001708.html">[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 70, Issue 1
</A></li>
        <LI>Next message: <A HREF="001710.html">[Owasp-modsecurity-core-rule-set] ModSecurity Rules - Windows	server 2008 R2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1709">[ date ]</a>
              <a href="thread.html#1709">[ thread ]</a>
              <a href="subject.html#1709">[ subject ]</a>
              <a href="author.html#1709">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,


I am getting the following in the apache/error.log. There are plenty of 
such errors coming in daily. So I would like to block them. They are 
from different ips. So fail2ban is not a good option. They come from 
&quot;mail2000.com.tw&quot;. How can I block this domain from trying to CONNECT ?


[Sat Feb 07 09:52:21 2015] [error] [client 118.165.130.55] ModSecurity: 
Access denied with code 403 (phase 1). Match of &quot;rx 
^(?:(?:[a-z]{3,10}\\\\s+(?:\\\\w{3,7}?://[\\\\w\\\\-\\\\./]*(?::\\\\d+)?)?/[^?#]*(?:\\\\?[^#\\\\s]*)?(?:#[\\\\S]*)?|connect 
(?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}\\\\.?(?::\\\\d+)?|options 
\\\\*)\\\\s+[\\\\w\\\\./]+|get 
/[^?#]*(?:\\\\?[^#\\\\s]*)?(?:#[\\\\S]*)?)$&quot; against &quot;REQUEST_LINE&quot; 
required. [file 
&quot;/usr/share/modsecurity-crs/activated_rules/modsecurity_crs_20_protocol_violations.conf&quot;] 
[line &quot;37&quot;] [id &quot;960911&quot;] [rev &quot;2.2.5&quot;] [msg &quot;Invalid HTTP Request 
Line&quot;] [data &quot;CONNECT mx0.mail2000.com.tw:25 HTTP/1.0&quot;] [severity 
&quot;WARNING&quot;] [tag 
&quot;<A HREF="https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911">https://www.owasp.org/index.php/ModSecurity_CRS_RuleID-960911</A>&quot;] [tag 
&quot;<A HREF="http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1">http://www.w3.org/Protocols/rfc2616/rfc2616-sec3.html#sec3.2.1</A>&quot;] [tag 
&quot;RULE_MATURITY/8&quot;] [tag &quot;RULE_ACCURACY/8&quot;] [hostname 
&quot;mx0.mail2000.com.tw&quot;] [uri &quot;/&quot;] [unique_id &quot;VNXgVX8AAAEAAHqycsoAAAAC&quot;]


I tried the following in /etc/apache2/sites-available/default. Will this 
work ?
&lt;VirtualHost *:80&gt;
.....
.....
&lt;/VirtualHost&gt;

&lt;Files *&gt;
&lt;LimitExcept GET POST&gt;
deny from all
&lt;/LimitExcept&gt;


Thanks.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001708.html">[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 70, Issue 1
</A></li>
	<LI>Next message: <A HREF="001710.html">[Owasp-modsecurity-core-rule-set] ModSecurity Rules - Windows	server 2008 R2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1709">[ date ]</a>
              <a href="thread.html#1709">[ thread ]</a>
              <a href="subject.html#1709">[ subject ]</a>
              <a href="author.html#1709">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
