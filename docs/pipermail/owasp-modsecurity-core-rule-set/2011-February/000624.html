<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] False positives
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20False%20positives&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000623.html">
   <LINK REL="Next"  HREF="000625.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] False positives</H1>
    <B>chris derham</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20False%20positives&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] False positives">chris at derham.me.uk
       </A><BR>
    <I>Tue Feb 15 11:30:54 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000623.html">[Owasp-modsecurity-core-rule-set] Experimental ruleset to detect	Floating Point DoS Payloads
</A></li>
        <LI>Next message: <A HREF="000625.html">[Owasp-modsecurity-core-rule-set] Announcing: Real-time Application	Profiling Ruleset
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#624">[ date ]</a>
              <a href="thread.html#624">[ thread ]</a>
              <a href="subject.html#624">[ subject ]</a>
              <a href="author.html#624">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>All,

We have a web application that has been configured to run with mod_security.
We are getting a few false positives. Another server needs to perform http
posts to us, and the framework that performs these calls  is getting
blocked. I have managed to figure out that if we update apache config with
the following changes our app works correctly

    &lt;LocationMatch &quot;/secure/j_spring_security_check*&quot;&gt;
        SecRuleRemoveById 960015 960021 960012 990012
    &lt;/LocationMatch&gt;
    &lt;LocationMatch &quot;/thirdPartyTransaction/submission*&quot;&gt;
        SecRuleRemoveById 960015 960021 960012 990012
    &lt;/LocationMatch&gt;
    &lt;LocationMatch &quot;/secure/j_spring_security_logout*&quot;&gt;
        SecRuleRemoveById 960015 960021 960012 990012
    &lt;/LocationMatch&gt;

This works fine in that the app now works without raising any false
positives. The rules are for missing accept header, content length, and
invalid user agent. My questions are

   1. is this out of date or current/preferred method for handling false
   positives
   2. should we use SecFilterSelective instead?
   3. can we do this better - e.g. if we know the IP range for the client,
   can we configure to switch these rules off across the board?

Apache 2.2.17, win32, core ruleset/2.1.1

First post, so please forgive me when I forget something critical

Thanks

Chris
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110215/4885076c/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110215/4885076c/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000623.html">[Owasp-modsecurity-core-rule-set] Experimental ruleset to detect	Floating Point DoS Payloads
</A></li>
	<LI>Next message: <A HREF="000625.html">[Owasp-modsecurity-core-rule-set] Announcing: Real-time Application	Profiling Ruleset
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#624">[ date ]</a>
              <a href="thread.html#624">[ thread ]</a>
              <a href="subject.html#624">[ subject ]</a>
              <a href="author.html#624">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
