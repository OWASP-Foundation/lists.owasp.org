<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] inconsistent	tx.sql_injection_score calculation?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20inconsistent%0A%09tx.sql_injection_score%20calculation%3F&In-Reply-To=%3Calpine.LRH.2.11.1408181355530.27590%40ash.usask.ca%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001623.html">
   <LINK REL="Next"  HREF="001625.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] inconsistent	tx.sql_injection_score calculation?</H1>
    <B>Earl Fogel</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20inconsistent%0A%09tx.sql_injection_score%20calculation%3F&In-Reply-To=%3Calpine.LRH.2.11.1408181355530.27590%40ash.usask.ca%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] inconsistent	tx.sql_injection_score calculation?">earl.fogel at usask.ca
       </A><BR>
    <I>Mon Aug 18 20:49:20 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001623.html">[Owasp-modsecurity-core-rule-set] Stumped on a false positive rule 950901
</A></li>
        <LI>Next message: <A HREF="001625.html">[Owasp-modsecurity-core-rule-set] inbound_anomaly_score_level -	Only send critical events
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1624">[ date ]</a>
              <a href="thread.html#1624">[ thread ]</a>
              <a href="subject.html#1624">[ subject ]</a>
              <a href="author.html#1624">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

In the SQL injection rules, tx.sql_injection_score is set two different 
ways. Some rules use &quot;+1&quot; while others increment it in sync with 
tx.anomaly_score, e.g.:

Rule 981231: 
setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.sql_injection_score=+1

Rule 981260:
setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score}

If the latter approach was used everywhere, then you could easily skip the 
SQL injection rules for certain URLs -- just create a local rule that 
matches the URLs you are interested in and subtract the
sql_injection_score from the anomaly_score for those URLs.

I've done this in my own copy of the core rules, and would love to have 
these changes included in the official core rules.

Earl Fogel
Information and Communications Technology
University of Saskatchewan
--

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001623.html">[Owasp-modsecurity-core-rule-set] Stumped on a false positive rule 950901
</A></li>
	<LI>Next message: <A HREF="001625.html">[Owasp-modsecurity-core-rule-set] inbound_anomaly_score_level -	Only send critical events
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1624">[ date ]</a>
              <a href="thread.html#1624">[ thread ]</a>
              <a href="subject.html#1624">[ subject ]</a>
              <a href="author.html#1624">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
