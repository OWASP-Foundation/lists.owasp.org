<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] crs against brute force not	working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20crs%20against%20brute%20force%20not%0A%09working&In-Reply-To=%3CCAE9Kp-YHjZEDtso9ZoXVSGWsqG5nM35s4v1m_YAn4prAQJSh1w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001638.html">
   <LINK REL="Next"  HREF="001642.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] crs against brute force not	working</H1>
    <B>Sabin Ranjit</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20crs%20against%20brute%20force%20not%0A%09working&In-Reply-To=%3CCAE9Kp-YHjZEDtso9ZoXVSGWsqG5nM35s4v1m_YAn4prAQJSh1w%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] crs against brute force not	working">think.sabin at gmail.com
       </A><BR>
    <I>Tue Aug 26 06:00:57 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001638.html">[Owasp-modsecurity-core-rule-set] crs against brute force not	working
</A></li>
        <LI>Next message: <A HREF="001642.html">[Owasp-modsecurity-core-rule-set] crs against brute force not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1641">[ date ]</a>
              <a href="thread.html#1641">[ thread ]</a>
              <a href="subject.html#1641">[ subject ]</a>
              <a href="author.html#1641">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>sorry, I checked out everything you have mentioned, it didnt work out for
me. :(

thanks for your replies,

regards,


On Fri, Aug 22, 2014 at 9:40 PM, Wesley Render &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&gt;
wrote:

&gt;<i> No. I have not actually tested it with other web software.  Maybe try the
</I>&gt;<i> following?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &#183;         Make sure the modsecurity_crs_11_brute_force.conf is loading
</I>&gt;<i> properly .  Maybe you have made a mistake with symbolic link or putting the
</I>&gt;<i> file in wrong folder.
</I>&gt;<i>
</I>&gt;<i> &#183;         Make sure you have uncommented the brute force rule in
</I>&gt;<i> modsecurity_crs_10_setup.conf (By default it is commented out)
</I>&gt;<i>
</I>&gt;<i> &#183;         Maybe try changing your URL to include your actual web login
</I>&gt;<i> file?  I know they show it without pound symbols on each end.  Like this:
</I>&gt;<i> setvar:'tx.brute_force_protected_urls=/wp-login.php', \
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [image: Otherdata_Logo_2011]
</I>&gt;<i>
</I>&gt;<i> *Wesley Render, IT Consultant, RHCSA*
</I>&gt;<i>
</I>&gt;<i> Phone: 1.403.228.1221 ext 201
</I>&gt;<i>
</I>&gt;<i> www.otherdata.com
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [image: findonfacebook] &lt;<A HREF="http://www.facebook.com/otherdata">http://www.facebook.com/otherdata</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* Sabin Ranjit [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>]
</I>&gt;<i> *Sent:* August-21-14 11:21 PM
</I>&gt;<i>
</I>&gt;<i> *To:* Wesley Render
</I>&gt;<i> *Cc:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> *Subject:* Re: [Owasp-modsecurity-core-rule-set] crs against brute force
</I>&gt;<i> not working
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> naah!! I tried it, its not working for me. I used the value like that but
</I>&gt;<i> when i do brute force attempt in the web application with random username
</I>&gt;<i> and password it gives me nothing in the mod audit log. I'm using burp suit
</I>&gt;<i> pro intruder for testing.
</I>&gt;<i>
</I>&gt;<i> Have you tried it besides wordpress? Wonder what I'm doing wrong.
</I>&gt;<i>
</I>&gt;<i> thanks anyway.
</I>&gt;<i>
</I>&gt;<i> cheers
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Aug 21, 2014 at 11:43 PM, Wesley Render &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> I believe you would just set yours like this  (Just include the URL after
</I>&gt;<i> the domain name)&#8230;.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> # -- [[ Brute Force Protection ]]
</I>&gt;<i> ---------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> # If you are using the Brute Force Protection rule set, then uncomment the
</I>&gt;<i> following
</I>&gt;<i>
</I>&gt;<i> # lines and set the following variables:
</I>&gt;<i>
</I>&gt;<i> # - Protected URLs: resources to protect (e.g. login pages) - set to your
</I>&gt;<i> login page
</I>&gt;<i>
</I>&gt;<i> # - Burst Time Slice Interval: time interval window to monitor for bursts
</I>&gt;<i>
</I>&gt;<i> # - Request Threshold: request # threshold to trigger a burst
</I>&gt;<i>
</I>&gt;<i> # - Block Period: temporary block timeout
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> SecAction \
</I>&gt;<i>
</I>&gt;<i>   &quot;id:'900014', \
</I>&gt;<i>
</I>&gt;<i>   phase:1, \
</I>&gt;<i>
</I>&gt;<i>   t:none, \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_protected_urls=#/user/user/login/#', \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_burst_time_slice=60', \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_counter_threshold=10', \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_block_timeout=300', \
</I>&gt;<i>
</I>&gt;<i>   nolog, \
</I>&gt;<i>
</I>&gt;<i>   pass&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [image: Otherdata_Logo_2011]
</I>&gt;<i>
</I>&gt;<i> *Wesley Render, IT Consultant, RHCSA*
</I>&gt;<i>
</I>&gt;<i> Phone: 1.403.228.1221 ext 201
</I>&gt;<i>
</I>&gt;<i> www.otherdata.com
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [image: findonfacebook] &lt;<A HREF="http://www.facebook.com/otherdata">http://www.facebook.com/otherdata</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* Sabin Ranjit [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>]
</I>&gt;<i> *Sent:* August-21-14 10:39 AM
</I>&gt;<i> *To:* Wesley Render
</I>&gt;<i> *Cc:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> *Subject:* Re: [Owasp-modsecurity-core-rule-set] crs against brute force
</I>&gt;<i> not working
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> hi Wesley,
</I>&gt;<i>
</I>&gt;<i> I'm not using wordpress, I'm try to protect my application made in Yii
</I>&gt;<i> framework and its login url looks like this:
</I>&gt;<i> <A HREF="https://domainname.net/user/user/login/">https://domainname.net/user/user/login/</A>
</I>&gt;<i>
</I>&gt;<i> how can I set brute_force_protected_urls value for this of url ? I tried
</I>&gt;<i> few ways but it gave me syntax error.
</I>&gt;<i>
</I>&gt;<i> thanks,
</I>&gt;<i>
</I>&gt;<i> regards
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Aug 21, 2014 at 9:36 PM, Wesley Render &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> In your modsecurity_crs_10_setup.conf file you need to make sure to
</I>&gt;<i> uncomment, and define the paths for your login page.  You will notice the
</I>&gt;<i> first line of the rule is commented out with a regular pound symbol.  Then
</I>&gt;<i> restart apache.  Here is how mine looks. I set it up for WordPress and
</I>&gt;<i> Drupal.  It has been working well for WordPress brute force attempts:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> # -- [[ Brute Force Protection ]]
</I>&gt;<i> ---------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> # If you are using the Brute Force Protection rule set, then uncomment the
</I>&gt;<i> following
</I>&gt;<i>
</I>&gt;<i> # lines and set the following variables:
</I>&gt;<i>
</I>&gt;<i> # - Protected URLs: resources to protect (e.g. login pages) - set to your
</I>&gt;<i> login page
</I>&gt;<i>
</I>&gt;<i> # - Burst Time Slice Interval: time interval window to monitor for bursts
</I>&gt;<i>
</I>&gt;<i> # - Request Threshold: request # threshold to trigger a burst
</I>&gt;<i>
</I>&gt;<i> # - Block Period: temporary block timeout
</I>&gt;<i>
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> SecAction \
</I>&gt;<i>
</I>&gt;<i>   &quot;id:'900014', \
</I>&gt;<i>
</I>&gt;<i>   phase:1, \
</I>&gt;<i>
</I>&gt;<i>   t:none, \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_protected_urls=#/wp-login.php# #/user#', \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_burst_time_slice=60', \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_counter_threshold=10', \
</I>&gt;<i>
</I>&gt;<i>   setvar:'tx.brute_force_block_timeout=300', \
</I>&gt;<i>
</I>&gt;<i>   nolog, \
</I>&gt;<i>
</I>&gt;<i>   pass&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [image: Otherdata_Logo_2011]
</I>&gt;<i>
</I>&gt;<i> *Wesley Render, IT Consultant, RHCSA*
</I>&gt;<i>
</I>&gt;<i> Phone: 1.403.228.1221 ext 201
</I>&gt;<i>
</I>&gt;<i> www.otherdata.com
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> [image: findonfacebook] &lt;<A HREF="http://www.facebook.com/otherdata">http://www.facebook.com/otherdata</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> *From:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] *On Behalf Of *Sabin
</I>&gt;<i> Ranjit
</I>&gt;<i> *Sent:* August-21-14 4:17 AM
</I>&gt;<i> *To:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> *Subject:* [Owasp-modsecurity-core-rule-set] crs against brute force not
</I>&gt;<i> working
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> hi,
</I>&gt;<i>
</I>&gt;<i> im using latest modsecurity rule set and i tried out crs_11_bruteforce
</I>&gt;<i> from experimental rule. But its not working for me. I created a shortlink
</I>&gt;<i> of it in the activated rules directory, restarted the apache and when i
</I>&gt;<i> brute force my web application login page the modsecurity audit log dont
</I>&gt;<i> give me any brute force warnings. what could be the problem? Im using burp
</I>&gt;<i> suite pro version's intruder for brute forcing.
</I>&gt;<i>
</I>&gt;<i> can anyone point to helpful resource that i can follow?
</I>&gt;<i>
</I>&gt;<i> thanks.
</I>&gt;<i>
</I>&gt;<i> regards
</I>&gt;<i>
</I>&gt;<i> sabin
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140826/722fe897/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140826/722fe897/attachment-0001.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 1769 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140826/722fe897/attachment-0002.jpg">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140826/722fe897/attachment-0002.jpg</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 4437 bytes
Desc: not available
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140826/722fe897/attachment-0003.jpg">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140826/722fe897/attachment-0003.jpg</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001638.html">[Owasp-modsecurity-core-rule-set] crs against brute force not	working
</A></li>
	<LI>Next message: <A HREF="001642.html">[Owasp-modsecurity-core-rule-set] crs against brute force not working
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1641">[ date ]</a>
              <a href="thread.html#1641">[ thread ]</a>
              <a href="subject.html#1641">[ subject ]</a>
              <a href="author.html#1641">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
