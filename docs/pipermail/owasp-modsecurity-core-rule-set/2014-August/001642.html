<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] crs against brute force not working
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20crs%20against%20brute%20force%20not%0A%20working&In-Reply-To=%3CD023AF4C.10F692%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001641.html">
   <LINK REL="Next"  HREF="001630.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] crs against brute force not working</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20crs%20against%20brute%20force%20not%0A%20working&In-Reply-To=%3CD023AF4C.10F692%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] crs against brute force not working">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Aug 27 19:53:09 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001641.html">[Owasp-modsecurity-core-rule-set] crs against brute force not	working
</A></li>
        <LI>Next message: <A HREF="001630.html">[Owasp-modsecurity-core-rule-set] False positive for SQL injection	rule 981245
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1642">[ date ]</a>
              <a href="thread.html#1642">[ thread ]</a>
              <a href="subject.html#1642">[ subject ]</a>
              <a href="author.html#1642">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Have you enabled the debug log for your test connections and reviewed the logs?

Ryan Barnett
Senior Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: Sabin Ranjit &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>&gt;&gt;
Date: Tuesday, August 26, 2014 2:00 AM
To: Wesley Render &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&gt;&gt;
Cc: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] crs against brute force not working

sorry, I checked out everything you have mentioned, it didnt work out for me. :(

thanks for your replies,

regards,


On Fri, Aug 22, 2014 at 9:40 PM, Wesley Render &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&gt;&gt; wrote:
No. I have not actually tested it with other web software.  Maybe try the following?


&#183;         Make sure the modsecurity_crs_11_brute_force.conf is loading properly .  Maybe you have made a mistake with symbolic link or putting the file in wrong folder.

&#183;         Make sure you have uncommented the brute force rule in modsecurity_crs_10_setup.conf (By default it is commented out)

&#183;         Maybe try changing your URL to include your actual web login file?  I know they show it without pound symbols on each end.  Like this:  setvar:'tx.brute_force_protected_urls=/wp-login.php', \


[Otherdata_Logo_2011]
Wesley Render, IT Consultant, RHCSA
Phone: 1.403.228.1221 ext 201&lt;tel:1.403.228.1221%20ext%20201&gt;
www.otherdata.com&lt;<A HREF="http://www.otherdata.com/">http://www.otherdata.com/</A>&gt;

[findonfacebook]&lt;<A HREF="http://www.facebook.com/otherdata">http://www.facebook.com/otherdata</A>&gt;

From: Sabin Ranjit [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>&gt;]
Sent: August-21-14 11:21 PM

To: Wesley Render
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] crs against brute force not working

naah!! I tried it, its not working for me. I used the value like that but when i do brute force attempt in the web application with random username and password it gives me nothing in the mod audit log. I'm using burp suit pro intruder for testing.
Have you tried it besides wordpress? Wonder what I'm doing wrong.
thanks anyway.

cheers

On Thu, Aug 21, 2014 at 11:43 PM, Wesley Render &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&gt;&gt; wrote:
I believe you would just set yours like this  (Just include the URL after the domain name)&#8230;.

#
# -- [[ Brute Force Protection ]] ---------------------------------------------------------
#
# If you are using the Brute Force Protection rule set, then uncomment the following
# lines and set the following variables:
# - Protected URLs: resources to protect (e.g. login pages) - set to your login page
# - Burst Time Slice Interval: time interval window to monitor for bursts
# - Request Threshold: request # threshold to trigger a burst
# - Block Period: temporary block timeout
#
SecAction \
  &quot;id:'900014', \
  phase:1, \
  t:none, \
  setvar:'tx.brute_force_protected_urls=#/user/user/login/#', \
  setvar:'tx.brute_force_burst_time_slice=60', \
  setvar:'tx.brute_force_counter_threshold=10', \
  setvar:'tx.brute_force_block_timeout=300', \
  nolog, \
  pass&quot;



[Otherdata_Logo_2011]
Wesley Render, IT Consultant, RHCSA
Phone: 1.403.228.1221 ext 201&lt;tel:1.403.228.1221%20ext%20201&gt;
www.otherdata.com&lt;<A HREF="http://www.otherdata.com/">http://www.otherdata.com/</A>&gt;

[findonfacebook]&lt;<A HREF="http://www.facebook.com/otherdata">http://www.facebook.com/otherdata</A>&gt;

From: Sabin Ranjit [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">think.sabin at gmail.com</A>&gt;]
Sent: August-21-14 10:39 AM
To: Wesley Render
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] crs against brute force not working

hi Wesley,
I'm not using wordpress, I'm try to protect my application made in Yii framework and its login url looks like this:
<A HREF="https://domainname.net/user/user/login/">https://domainname.net/user/user/login/</A>
how can I set brute_force_protected_urls value for thisof url ?I tried few ways but it gave me syntax error.
thanks,
regards

On Thu, Aug 21, 2014 at 9:36 PM, Wesley Render &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">wrender at otherdata.com</A>&gt;&gt; wrote:
In your modsecurity_crs_10_setup.conf file you need to make sure to uncomment, and define the paths for your login page.  You will notice the first line of the rule is commented out with a regular pound symbol.  Then restart apache.  Here is how mine looks. I set it up for WordPress and Drupal.  It has been working well for WordPress brute force attempts:

#
# -- [[ Brute Force Protection ]] ---------------------------------------------------------
#
# If you are using the Brute Force Protection rule set, then uncomment the following
# lines and set the following variables:
# - Protected URLs: resources to protect (e.g. login pages) - set to your login page
# - Burst Time Slice Interval: time interval window to monitor for bursts
# - Request Threshold: request # threshold to trigger a burst
# - Block Period: temporary block timeout
#
SecAction \
  &quot;id:'900014', \
  phase:1, \
  t:none, \
  setvar:'tx.brute_force_protected_urls=#/wp-login.php# #/user#', \
  setvar:'tx.brute_force_burst_time_slice=60', \
  setvar:'tx.brute_force_counter_threshold=10', \
  setvar:'tx.brute_force_block_timeout=300', \
  nolog, \
  pass&quot;


[Otherdata_Logo_2011]
Wesley Render, IT Consultant, RHCSA
Phone: 1.403.228.1221 ext 201&lt;tel:1.403.228.1221%20ext%20201&gt;
www.otherdata.com&lt;<A HREF="http://www.otherdata.com/">http://www.otherdata.com/</A>&gt;

[findonfacebook]&lt;<A HREF="http://www.facebook.com/otherdata">http://www.facebook.com/otherdata</A>&gt;


From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt; [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt;] On Behalf Of Sabin Ranjit
Sent: August-21-14 4:17 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: [Owasp-modsecurity-core-rule-set] crs against brute force not working

hi,
im using latest modsecurity rule set and i tried out crs_11_bruteforce from experimental rule. But its not working for me. I created a shortlink of it in the activated rules directory, restarted the apache and when i brute force my web application login page the modsecurity audit log dont give me any brute force warnings. what could be the problem? Im using burp suite pro version's intruder for brute forcing.
can anyone point to helpful resource that i can follow?
thanks.

regards
sabin




________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140827/b630e3ec/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140827/b630e3ec/attachment-0001.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image002.jpg
Type: image/jpeg
Size: 1769 bytes
Desc: image002.jpg
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140827/b630e3ec/attachment-0002.jpg">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140827/b630e3ec/attachment-0002.jpg</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.jpg
Type: image/jpeg
Size: 4437 bytes
Desc: image001.jpg
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140827/b630e3ec/attachment-0003.jpg">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140827/b630e3ec/attachment-0003.jpg</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001641.html">[Owasp-modsecurity-core-rule-set] crs against brute force not	working
</A></li>
	<LI>Next message: <A HREF="001630.html">[Owasp-modsecurity-core-rule-set] False positive for SQL injection	rule 981245
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1642">[ date ]</a>
              <a href="thread.html#1642">[ thread ]</a>
              <a href="subject.html#1642">[ subject ]</a>
              <a href="author.html#1642">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
