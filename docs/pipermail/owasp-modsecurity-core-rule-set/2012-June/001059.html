<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] error 403 with CRS 2.2.4 &amp;	modsecurity 2.6.5
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20error%20403%20with%20CRS%202.2.4%20%26%0A%09modsecurity%202.6.5&In-Reply-To=%3C1963440128.20120605014225%40carlopoliti.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] error 403 with CRS 2.2.4 &amp;	modsecurity 2.6.5</H1>
    <B>Carlo Politi</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20error%20403%20with%20CRS%202.2.4%20%26%0A%09modsecurity%202.6.5&In-Reply-To=%3C1963440128.20120605014225%40carlopoliti.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] error 403 with CRS 2.2.4 &amp;	modsecurity 2.6.5">carlo at carlopoliti.net
       </A><BR>
    <I>Mon Jun  4 23:42:25 UTC 2012</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good evening,
i'm trying to make work modsecurity with core rule set 2.2.4 but i have very strange behaviors. If i enable modsecurity, i cannot access my blog (WordPress 3.3.2) and i get a 403 error and my logs are full with these things:

[Mon Jun 04 21:10:32 2012] [error] [client 93.148.109.162] ModSecurity: Rule b5fcf270 [id &quot;950901&quot;][file &quot;/usr/share/modsecurity-crs_2.2.4/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;][line &quot;77&quot;] - Execution error - PCRE limits exceeded (-8): (null). [hostname &quot;blog.carlopoliti.net&quot;] [uri &quot;/wp-admin/admin.php&quot;] [unique_id &quot;T80kSH8AAAEAAGPFKCMAAAAH&quot;]

[Mon Jun 04 21:10:32 2012] [error] [client 93.148.109.162] ModSecurity: Rule b5fcf270 [id &quot;950901&quot;][file &quot;/usr/share/modsecurity-crs_2.2.4/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;][line &quot;77&quot;] - Execution error - PCRE limits exceeded (-8): (null). [hostname &quot;blog.carlopoliti.net&quot;] [uri &quot;/wp-admin/admin.php&quot;] [unique_id &quot;T80kSH8AAAEAAGPFKCMAAAAH&quot;]

[Mon Jun 04 21:10:32 2012] [error] [client 93.148.109.162] ModSecurity: Rule b5fcf270 [id &quot;950901&quot;][file &quot;/usr/share/modsecurity-crs_2.2.4/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;][line &quot;77&quot;] - Execution error - PCRE limits exceeded (-8): (null). [hostname &quot;blog.carlopoliti.net&quot;] [uri &quot;/wp-admin/admin.php&quot;] [unique_id &quot;T80kSH8AAAEAAGPFKCMAAAAH&quot;]

[Mon Jun 04 21:10:32 2012] [error] [client 93.148.109.162]
ModSecurity: Access denied with code 403 (phase 2). Pattern match &quot;([\\\\~\\\\!\\\\@\\\\#\\\\$\\\\%\\\\^\\\\&amp;\\\\*\\\\(\\\\)\\\\-\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\|\\\\:\\\\;\\&quot;\\\\'\\\\\\xc2\\xb4\\\\\\xe2\\x80\\x99\\\\\\xe2\\x80\\x98\\\\`\\\\&lt;\\\\&gt;].*){8,}&quot; at REQUEST_COOKIES:wp-settings-1. [file &quot;/usr/share/modsecurity-crs_2.2.4/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] [line &quot;169&quot;] [id &quot;981172&quot;] [rev &quot;2.2.4&quot;] [msg &quot;Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded&quot;] [data &quot;=o&quot;] [hostname &quot;blog.carlopoliti.net&quot;] [uri &quot;/wp-admin/admin.php&quot;] [unique_id &quot;T80kSH8AAAEAAGPFKCMAAAAH&quot;]

[Mon Jun 04 21:10:33 2012] [error] [client 93.148.109.162] ModSecurity: Unable to retrieve collection (name &quot;global&quot;, key &quot;global&quot;). Use SecDataDir to define data directory first. [hostname &quot;blog.carlopoliti.net&quot;] [uri &quot;/custompage/404.css&quot;] [unique_id &quot;T80kSX8AAAEAAGPFKCQAAAAH&quot;]

[Mon Jun 04 21:10:33 2012] [error] [client 93.148.109.162]
ModSecurity: Access denied with code 403 (phase 2). Pattern match &quot;([\\\\~\\\\!\\\\@\\\\#\\\\$\\\\%\\\\^\\\\&amp;\\\\*\\\\(\\\\)\\\\-\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\|\\\\:\\\\;\\&quot;\\\\'\\\\\\xc2\\xb4\\\\\\xe2\\x80\\x99\\\\\\xe2\\x80\\x98\\\\`\\\\&lt;\\\\&gt;].*){8,}&quot; at REQUEST_COOKIES:wp-settings-1. [file &quot;/usr/share/modsecurity-crs_2.2.4/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] [line &quot;169&quot;] [id &quot;981172&quot;] [rev &quot;2.2.4&quot;] [msg &quot;Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded&quot;] [data &quot;=o&quot;] [hostname &quot;blog.carlopoliti.net&quot;] [uri &quot;/custompage/404.css&quot;] [unique_id &quot;T80kSX8AAAEAAGPFKCQAAAAH&quot;]

[Mon Jun 04 21:10:33 2012] [error] [client 93.148.109.162]
ModSecurity: Access denied with code 403 (phase 2). Pattern match &quot;([\\\\~\\\\!\\\\@\\\\#\\\\$\\\\%\\\\^\\\\&amp;\\\\*\\\\(\\\\)\\\\-\\\\+\\\\=\\\\{\\\\}\\\\[\\\\]\\\\|\\\\:\\\\;\\&quot;\\\\'\\\\\\xc2\\xb4\\\\\\xe2\\x80\\x99\\\\\\xe2\\x80\\x98\\\\`\\\\&lt;\\\\&gt;].*){8,}&quot; at REQUEST_COOKIES:wp-settings-1. [file &quot;/usr/share/modsecurity-crs_2.2.4/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] [line &quot;169&quot;] [id &quot;981172&quot;] [rev &quot;2.2.4&quot;] [msg &quot;Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded&quot;] [data &quot;=o&quot;] [hostname &quot;blog.carlopoliti.net&quot;] [uri &quot;/custompage/emailCP.png&quot;] [unique_id &quot;T80kSX8AAAEAAGPfLVoAAAAI&quot;]


I have tried to disable these 2 lines and now all works (it seems so) but i'm wondering if there is a way to make it work or i have to disable the line 77 and 169 of file modsecurity_crs_41_sql_injection_attacks.conf?

Thanks


-- 
Carlo Politi
eMail: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">carlo at carlopoliti.net</A>
www: <A HREF="http://www.carlopoliti.net/">http://www.carlopoliti.net/</A>
blog: <A HREF="http://blog.carlopoliti.net/">http://blog.carlopoliti.net/</A>





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1059">[ date ]</a>
              <a href="thread.html#1059">[ thread ]</a>
              <a href="subject.html#1059">[ subject ]</a>
              <a href="author.html#1059">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
