<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]Updating Rule IDs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5DUpdating%20Rule%20IDs&In-Reply-To=%3C3fbf20b54847484f88718b360d672fdb%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001073.html">
   <LINK REL="Next"  HREF="001066.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]Updating Rule IDs</H1>
    <B>David Sinclair</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5DUpdating%20Rule%20IDs&In-Reply-To=%3C3fbf20b54847484f88718b360d672fdb%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]Updating Rule IDs">dbsinclair at multiservice.com
       </A><BR>
    <I>Wed Jun  6 15:28:01 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001073.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Updating Rule IDs
</A></li>
        <LI>Next message: <A HREF="001066.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating Rule IDs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1067">[ date ]</a>
              <a href="thread.html#1067">[ thread ]</a>
              <a href="subject.html#1067">[ subject ]</a>
              <a href="author.html#1067">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I think it is a good idea to better group the rules but it will require an
extensive review of rule exceptions.  If there is a mapping available from
the old id to the new id for those rules that are reassigned that would be
very helpful and reduce the review effort.



*David B. Sinclair*

Security Manager

Multi Service Corporation



+1-913-663-9474-w

+1-816-718-0449-m

<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dbsinclair at multiservice.com</A>


  ------------------------------

*From:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] *On Behalf Of *Ryan
Barnett
*Sent:* Wednesday, June 06, 2012 9:24 AM
*To:* <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
*Subject:* [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion
Thread]Updating Rule IDs



One of the items we are considering with the CRS v3.0 update is to start
from scratch with all of the rule IDs.  We have a defined range reserved
for the OWASP CRS -

<A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#id">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#id</A>



900,000&#8211;999,999: reserved for the OWASP ModSecurity Core Rule Set
[12]&lt;<A HREF="http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project</A>&gt;
 project



The rationale for this change is to make it easier to users to do
exceptions and disable groups of rules by using SecRuleRemoveById, etc&#8230;
That directive has the capability to remove *ranges* of rule IDs, however
over the years the rule IDs were added ad-hoc and they are not properly
grouped in this manner.  For instance, groupings could be something similar
to this -



   - Protocol Violation &#8211; 900000-900099
   - Protocol Policies - 900100&#8211;900199
   - Cross-site Scripting - 900200&#8211;900299
   - &#8230;

 We would give each rule group approx 100 rule IDs.  The initial number
would be less than that which would allow some growth.  After some analysis
of the current rules, we really shouldn't ever exceed those allotments as
there ends up being rule logic duplication and you just end up with bloated
rule amounts.



Keep in mind that the active rule IDs were going to change a bit anyways
with this update as we will be consolidating many rules into highly
optimized regexes, etc..



The only concern that I have with making this move would be if users have
extensively implemented exceptions based on the current rule IDs.  They
would need to be aware of this when they migrate to v3.0.



Comments?



-- 

Ryan Barnett
Trustwave SpiderLabs

ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader


 ------------------------------

This transmission may contain information that is privileged, confidential,
and/or exempt from disclosure under applicable law. If you are not the
intended recipient, you are hereby notified that any disclosure, copying,
distribution, or use of the information contained herein (including any
reliance thereon) is STRICTLY PROHIBITED. If you received this transmission
in error, please immediately contact the sender and destroy the material in
its entirety, whether in electronic or hard copy format.


---------------------------------------------------------------------------------------
This email is intended solely for the use of the addressee and may
contain information that is confidential, proprietary, or both.
If you receive this email in error please immediately notify the
sender and delete the email.
---------------------------------------------------------------------------------------

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120606/2421bd19/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120606/2421bd19/attachment-0001.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001073.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Updating Rule IDs
</A></li>
	<LI>Next message: <A HREF="001066.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating Rule IDs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1067">[ date ]</a>
              <a href="thread.html#1067">[ thread ]</a>
              <a href="subject.html#1067">[ subject ]</a>
              <a href="author.html#1067">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
