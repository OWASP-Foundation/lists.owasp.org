<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating Rule IDs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5D%20Updating%20Rule%20IDs&In-Reply-To=%3CC54775D1-238C-40B7-AD9F-C35855AE3964%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001095.html">
   <LINK REL="Next"  HREF="001090.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating Rule IDs</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5D%20Updating%20Rule%20IDs&In-Reply-To=%3CC54775D1-238C-40B7-AD9F-C35855AE3964%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating Rule IDs">RBarnett at trustwave.com
       </A><BR>
    <I>Fri Jun  8 21:11:57 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001095.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating Rule IDs
</A></li>
        <LI>Next message: <A HREF="001090.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	GeoIP Database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1097">[ date ]</a>
              <a href="thread.html#1097">[ thread ]</a>
              <a href="subject.html#1097">[ subject ]</a>
              <a href="author.html#1097">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Agreed. We added the ver action to 2.7 -
<A HREF="http://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#ver">http://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#ver</A>

We will be using that to hold the main CRS value (such as OWASP_CRS/2.2.5). We will the. Use the rev action for its intended purpose to track modifications to an existing rule ID.

I think it would also be good to include a ruleid-map file that will make it easier to see what was added/changed.

Ryan

On Jun 8, 2012, at 4:48 PM, &quot;Michael Haas&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">michael.haas10 at gmail.com</A>&gt; wrote:

&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> Ruleid's should never be reused.
</I>&gt;<i> I think it would be also a great benefit if the rev field is only
</I>&gt;<i> updated if something has changed in the actual rule.
</I>&gt;<i> That would make it easier to search with normal diff command for updates.
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i> Michael
</I>&gt;<i>
</I>&gt;<i> 2012/6/7 Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On 6/6/12 6:47 PM, &quot;Klaubert Herr da Silveira&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">klaubert at gmail.com</A>&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Ryan,
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> The &quot;highly optimized regexes&quot; will be written optimized or will be
</I>&gt;&gt;&gt;<i> optimized by a tool? If is written and then optimized, will be very
</I>&gt;&gt;&gt;<i> useful to have the &quot;source&quot; for debuging purpose, like a version
</I>&gt;&gt;&gt;<i> minified and a standard version of a js lib.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Yes, we can do that.  Just to be clear, we are planning on extensively
</I>&gt;&gt;<i> using the @pm/@pmf to do fast pre-qualification of groups of rules.  If
</I>&gt;&gt;<i> these rules match, then we will execute the optimized regular expression
</I>&gt;&gt;<i> rules.  What we can do is provide the smaller regex sources with Apache
</I>&gt;&gt;<i> comments prior to the rules.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> So, you would really have two ways of knowing the source data for the
</I>&gt;&gt;<i> optimized regexes:
</I>&gt;&gt;<i> 1) The plain text string pm data, and
</I>&gt;&gt;<i> 2) The smaller, individual regexes.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> -Ryan
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Klaubert Herr
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Wed, Jun 6, 2012 at 11:23 AM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;
</I>&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;&gt;<i> One of the items we are considering with the CRS v3.0 update is to start
</I>&gt;&gt;&gt;&gt;<i> from scratch with all of the rule IDs.  We have a defined range
</I>&gt;&gt;&gt;&gt;<i> reserved for
</I>&gt;&gt;&gt;&gt;<i> the OWASP CRS -
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Refer">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Refer</A>
</I>&gt;&gt;&gt;&gt;<i> ence_Manual#id
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> 900,000&#173;999,999: reserved for the OWASP ModSecurity Core Rule
</I>&gt;&gt;&gt;&gt;<i> Set [12] project
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The rationale for this change is to make it easier to users to do
</I>&gt;&gt;&gt;&gt;<i> exceptions
</I>&gt;&gt;&gt;&gt;<i> and disable groups of rules by using SecRuleRemoveById, etc&#352; That
</I>&gt;&gt;&gt;&gt;<i> directive
</I>&gt;&gt;&gt;&gt;<i> has the capability to remove ranges of rule IDs, however over the years
</I>&gt;&gt;&gt;&gt;<i> the
</I>&gt;&gt;&gt;&gt;<i> rule IDs were added ad-hoc and they are not properly grouped in this
</I>&gt;&gt;&gt;&gt;<i> manner.
</I>&gt;&gt;&gt;&gt;<i>  For instance, groupings could be something similar to this -
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Protocol Violation &#173; 900000-900099
</I>&gt;&gt;&gt;&gt;<i> Protocol Policies - 900100&#173;900199
</I>&gt;&gt;&gt;&gt;<i> Cross-site Scripting - 900200&#173;900299
</I>&gt;&gt;&gt;&gt;<i> &#352;
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> We would give each rule group approx 100 rule IDs.  The initial number
</I>&gt;&gt;&gt;&gt;<i> would
</I>&gt;&gt;&gt;&gt;<i> be less than that which would allow some growth.  After some analysis
</I>&gt;&gt;&gt;&gt;<i> of the
</I>&gt;&gt;&gt;&gt;<i> current rules, we really shouldn't ever exceed those allotments as there
</I>&gt;&gt;&gt;&gt;<i> ends up being rule logic duplication and you just end up with bloated
</I>&gt;&gt;&gt;&gt;<i> rule
</I>&gt;&gt;&gt;&gt;<i> amounts.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Keep in mind that the active rule IDs were going to change a bit anyways
</I>&gt;&gt;&gt;&gt;<i> with this update as we will be consolidating many rules into highly
</I>&gt;&gt;&gt;&gt;<i> optimized regexes, etc..
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> The only concern that I have with making this move would be if users
</I>&gt;&gt;&gt;&gt;<i> have
</I>&gt;&gt;&gt;&gt;<i> extensively implemented exceptions based on the current rule IDs.  They
</I>&gt;&gt;&gt;&gt;<i> would need to be aware of this when they migrate to v3.0.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Comments?
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;<i> Ryan Barnett
</I>&gt;&gt;&gt;&gt;<i> Trustwave SpiderLabs
</I>&gt;&gt;&gt;&gt;<i> ModSecurity Project Leader
</I>&gt;&gt;&gt;&gt;<i> OWASP ModSecurity CRS Project Leader
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> ________________________________
</I>&gt;&gt;&gt;&gt;<i> This transmission may contain information that is privileged,
</I>&gt;&gt;&gt;&gt;<i> confidential,
</I>&gt;&gt;&gt;&gt;<i> and/or exempt from disclosure under applicable law. If you are not the
</I>&gt;&gt;&gt;&gt;<i> intended recipient, you are hereby notified that any disclosure,
</I>&gt;&gt;&gt;&gt;<i> copying,
</I>&gt;&gt;&gt;&gt;<i> distribution, or use of the information contained herein (including any
</I>&gt;&gt;&gt;&gt;<i> reliance thereon) is STRICTLY PROHIBITED. If you received this
</I>&gt;&gt;&gt;&gt;<i> transmission
</I>&gt;&gt;&gt;&gt;<i> in error, please immediately contact the sender and destroy the
</I>&gt;&gt;&gt;&gt;<i> material in
</I>&gt;&gt;&gt;&gt;<i> its entirety, whether in electronic or hard copy format.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001095.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating Rule IDs
</A></li>
	<LI>Next message: <A HREF="001090.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	GeoIP Database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1097">[ date ]</a>
              <a href="thread.html#1097">[ thread ]</a>
              <a href="subject.html#1097">[ subject ]</a>
              <a href="author.html#1097">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
