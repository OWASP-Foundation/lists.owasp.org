<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]Updating Rule IDs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5DUpdating%20Rule%20IDs&In-Reply-To=%3CCBF5319E.5057D%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001076.html">
   <LINK REL="Next"  HREF="001080.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]Updating Rule IDs</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5DUpdating%20Rule%20IDs&In-Reply-To=%3CCBF5319E.5057D%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]Updating Rule IDs">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Jun  6 20:16:39 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001076.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion	Thread]Updating Rule IDs
</A></li>
        <LI>Next message: <A HREF="001080.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion	Thread]Updating Rule IDs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1079">[ date ]</a>
              <a href="thread.html#1079">[ thread ]</a>
              <a href="subject.html#1079">[ subject ]</a>
              <a href="author.html#1079">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Mark,
Good points.  You are correct in that we can address this already with the
tag action: tag:'WEB_ATTACK/SQL_INJECTION'

This allows users to disable categories of rules with SecRuleRemoveByTag
directive.

Perhaps we should just keep existing rule IDs to help ease with updates.

I will reiterate though that we will be consolidating rules and many rule
IDs may just go away.  This brings up the issue of rule ID reuse.  Should
we ever re-use a rule ID?  If so, how should we notify the user.  I
believe that we can address that by utilizing the &quot;rev&quot; action.  If we
update a rule or re-use the rule ID for another purpose, we should then
increment the rev value.

Thoughts?

-Ryan



On 6/6/12 3:50 PM, &quot;Mark Boos (IntCom)&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mark at intcom.nl</A>&gt; wrote:

&gt;<i>To me, it sounds like a database / categorization problem which you want
</I>&gt;<i>to
</I>&gt;<i>solve via id's. Is there no other way to add a category indication ? In my
</I>&gt;<i>field, customers want to order member numbers to the alphabet. It's ok to
</I>&gt;<i>do
</I>&gt;<i>that when you start, but the next new member that comes gets max_id+1
</I>&gt;<i>regardless of his last name.
</I>&gt;<i>
</I>&gt;<i>Also, it sounds like a lot of work to categorize every rule to new
</I>&gt;<i>numbers,
</I>&gt;<i>also in the future.
</I>&gt;<i>
</I>&gt;<i>And lastly, indeed; for the people who make exceptions based on the
</I>&gt;<i>current
</I>&gt;<i>rule id's, this will cause a lot lot of problems for them.
</I>&gt;<i>
</I>&gt;<i>Regards
</I>&gt;<i>Mark
</I>&gt;<i>
</I>&gt;<i>-----Oorspronkelijk bericht-----
</I>&gt;<i>Van: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>
</I>&gt;<i>[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>]Namens
</I>&gt;<i>Ryan
</I>&gt;<i>Barnett
</I>&gt;<i>Verzonden: woensdag 6 juni 2012 17:40
</I>&gt;<i>Aan: David Sinclair; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i>Onderwerp: Re: [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion
</I>&gt;<i>Thread]Updating Rule IDs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I will investigate the idea of a rule mapping, but keep in mind that
</I>&gt;<i>following -
</I>&gt;<i>One of our goals with the update is to make the rule accuracy better (less
</I>&gt;<i>false positives).  So, just because a specific rule is currently a false
</I>&gt;<i>positive and you chose to add an exception to disable it, that does not
</I>&gt;<i>mean
</I>&gt;<i>that you would need to keep the exception with the new version of the
</I>&gt;<i>rule.
</I>&gt;<i>ModSecurity v2.7 (will be released very soon) has the new &quot;accuracy&quot; and
</I>&gt;<i>&quot;maturity&quot; actions.  This will allow us (Trustwave) to give a relative
</I>&gt;<i>score
</I>&gt;<i>for each of these settings.  This will help you to decide which rules to
</I>&gt;<i>run
</I>&gt;<i>default or not.
</I>&gt;<i>As for directory structure groupings, it is my belief that all rules in
</I>&gt;<i>the
</I>&gt;<i>&quot;base_rules&quot; directory should have a very high quality of accuracy (low FP
</I>&gt;<i>rate).  If a user wants to get more aggressive with detection, then they
</I>&gt;<i>will be able to activate other rule files under the &quot;experimental_rules&quot;
</I>&gt;<i>directory in which the accuracy/maturity values would be lower.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>-Ryan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>From: David Sinclair &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dbsinclair at multiservice.com</A>&gt;
</I>&gt;<i>Date: Wed, 6 Jun 2012 10:28:01 -0500
</I>&gt;<i>To: Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&gt;,
</I>&gt;<i>&quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&quot;
</I>&gt;<i>&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i>Subject: RE: [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion
</I>&gt;<i>Thread]Updating Rule IDs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>I think it is a good idea to better group the rules but it will require an
</I>&gt;<i>extensive review of rule exceptions.  If there is a mapping available from
</I>&gt;<i>the old id to the new id for those rules that are reassigned that would be
</I>&gt;<i>very helpful and reduce the review effort.
</I>&gt;<i>
</I>&gt;<i>David B. Sinclair
</I>&gt;<i>Security Manager
</I>&gt;<i>Multi Service Corporation
</I>&gt;<i>
</I>&gt;<i>+1-913-663-9474-w
</I>&gt;<i>+1-816-718-0449-m
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dbsinclair at multiservice.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>From:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>
</I>&gt;<i>[mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf
</I>&gt;<i>Of Ryan Barnett
</I>&gt;<i>Sent: Wednesday, June 06, 2012 9:24 AM
</I>&gt;<i>To:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i>Subject: [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion
</I>&gt;<i>Thread]Updating Rule IDs
</I>&gt;<i>
</I>&gt;<i>One of the items we are considering with the CRS v3.0 update is to start
</I>&gt;<i>from scratch with all of the rule IDs.  We have a defined range reserved
</I>&gt;<i>for
</I>&gt;<i>the OWASP CRS -
</I>&gt;<i><A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Refere">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Refere</A>
</I>&gt;<i>nc
</I>&gt;<i>e_Manual#id
</I>&gt;<i>
</I>&gt;<i>900,000&#173;999,999: reserved for the OWASP ModSecurity Core Rule Set
</I>&gt;<i>[12] project
</I>&gt;<i>
</I>&gt;<i>The rationale for this change is to make it easier to users to do
</I>&gt;<i>exceptions
</I>&gt;<i>and disable groups ofrules by using SecRuleRemoveById, etc&#352; That directive
</I>&gt;<i>has the capability to remove ranges of rule IDs, however over the years
</I>&gt;<i>the
</I>&gt;<i>rule IDs were added ad-hoc and they are not properly grouped in this
</I>&gt;<i>manner.
</I>&gt;<i>For instance, groupings could be something similar to this -
</I>&gt;<i>
</I>&gt;<i>Protocol Violation &#173; 900000-900099
</I>&gt;<i>Protocol Policies - 900100&#173;900199
</I>&gt;<i>Cross-site Scripting - 900200&#173;900299
</I>&gt;<i>&#352;
</I>&gt;<i>We would give each rule group approx 100 rule IDs.  The initial number
</I>&gt;<i>would
</I>&gt;<i>be less than thatwhich would allow some growth.  After some analysis of
</I>&gt;<i>the
</I>&gt;<i>current rules, we really shouldn't ever exceed those allotments as there
</I>&gt;<i>ends up being rule logic duplication and you just end up with bloated rule
</I>&gt;<i>amounts.
</I>&gt;<i>
</I>&gt;<i>Keep in mind that the active rule IDs were going to change a bit anyways
</I>&gt;<i>with this update as we will be consolidating many rules into highly
</I>&gt;<i>optimized regexes, etc..
</I>&gt;<i>
</I>&gt;<i>The only concern that I have with making this move would be if users have
</I>&gt;<i>extensively implemented exceptions based on the current rule IDs.  They
</I>&gt;<i>would need to be aware of this when they migrate to v3.0.
</I>&gt;<i>
</I>&gt;<i>Comments?
</I>&gt;<i>
</I>&gt;<i>--
</I>&gt;<i>Ryan Barnett
</I>&gt;<i>Trustwave SpiderLabs
</I>&gt;<i>ModSecurity Project Leader
</I>&gt;<i>OWASP ModSecurity CRS Project Leader
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>This transmission may contain information that is privileged,
</I>&gt;<i>confidential,
</I>&gt;<i>and/or exempt from disclosure under applicable law. If you are not the
</I>&gt;<i>intended recipient, you are hereby notified that any disclosure, copying,
</I>&gt;<i>distribution, or use of the information contained herein (including any
</I>&gt;<i>reliance thereon) is STRICTLY PROHIBITED. If you received this
</I>&gt;<i>transmission
</I>&gt;<i>in error, please immediately contact the sender and destroy the material
</I>&gt;<i>in
</I>&gt;<i>its entirety, whether in electronic or hard copy format.
</I>&gt;<i>--------------------------------------------------------------------------
</I>&gt;<i>--
</I>&gt;<i>-----------
</I>&gt;<i>This email is intended solely for the use of the addressee and may
</I>&gt;<i>contain information that is confidential, proprietary, or both.
</I>&gt;<i>If you receive this email in error please immediately notify the
</I>&gt;<i>sender and delete the email.
</I>&gt;<i>--------------------------------------------------------------------------
</I>&gt;<i>--
</I>&gt;<i>-----------
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>This transmission may contain information that is privileged,
</I>&gt;<i>confidential,
</I>&gt;<i>and/or exempt from disclosure under applicable law. If you are not the
</I>&gt;<i>intended recipient, you are hereby notified that any disclosure, copying,
</I>&gt;<i>distribution, or use of the information contained herein (including any
</I>&gt;<i>reliance thereon) is STRICTLY PROHIBITED. If you received this
</I>&gt;<i>transmission
</I>&gt;<i>in error, please immediately contact the sender and destroy the material
</I>&gt;<i>in
</I>&gt;<i>its entirety, whether in electronic or hard copy format.
</I>&gt;<i>
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.



</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001076.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion	Thread]Updating Rule IDs
</A></li>
	<LI>Next message: <A HREF="001080.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion	Thread]Updating Rule IDs
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1079">[ date ]</a>
              <a href="thread.html#1079">[ thread ]</a>
              <a href="subject.html#1079">[ subject ]</a>
              <a href="author.html#1079">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
