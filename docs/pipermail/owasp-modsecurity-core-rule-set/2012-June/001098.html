<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Updating the logdata action data
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%20Thread%5D%0A%09Updating%20the%20logdata%20action%20data&In-Reply-To=%3CCBFF6A69.524D3%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001091.html">
   <LINK REL="Next"  HREF="001099.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Updating the logdata action data</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%20Thread%5D%0A%09Updating%20the%20logdata%20action%20data&In-Reply-To=%3CCBFF6A69.524D3%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Updating the logdata action data">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Jun 14 14:23:20 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001091.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Converted Snort Signatures
</A></li>
        <LI>Next message: <A HREF="001099.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating the logdata action data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1098">[ date ]</a>
              <a href="thread.html#1098">[ thread ]</a>
              <a href="subject.html#1098">[ subject ]</a>
              <a href="author.html#1098">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>We are considering updating the &quot;logdata&quot; action field in the CRS to
provide more information about the operator match data.  Currently, we
mainly only use %{TX.0} which will show you the exact portion of the
variable data that matched the regex -

SecRule
REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:
/*
&quot;(/\*!?|\*/|[';]--|--[\s\r\n\v\f]|(?:--[^-]*?-)|([^\-&amp;])#.*?[\s\r\n\v\f]|;?
\\x00)&quot;
&quot;phase:2,rev:'2.2.5',id:'981231',t:none,t:urlDecodeUni,block,msg:'SQL
Comment Sequence
Detected.',capture,logdata:'%{tx.0}',tag:'WEB_ATTACK/SQL_INJECTION',tag:'WA
SCTC/WASC-19',tag:'OWASP_TOP_10/A1',tag:'OWASP_AppSensor/CIE1',tag:'PCI/6.5
.2',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.sql_inje
ction_score=+1,setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-WEB_ATTACK/
SQL_INJECTION-%{matched_var_name}=%{tx.0}&quot;

We thinking that it might be more informative to modify the logdata action
to something like this -

logdata:'Data matched: %{TX.0}, within variable payload: %{MATCHED_VAR}'

This would provide more data and context for alerts and may allow for
easier false positive validation without needing to review the full audit
log data.

Comments welcome.

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader


This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001091.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Converted Snort Signatures
</A></li>
	<LI>Next message: <A HREF="001099.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updating the logdata action data
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1098">[ date ]</a>
              <a href="thread.html#1098">[ thread ]</a>
              <a href="subject.html#1098">[ subject ]</a>
              <a href="author.html#1098">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
