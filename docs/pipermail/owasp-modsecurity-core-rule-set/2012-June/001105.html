<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule 950901 optimization
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20950901%20optimization&In-Reply-To=%3C22D5647C-D4FB-406D-9628-0F7A434379EA%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001104.html">
   <LINK REL="Next"  HREF="001106.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule 950901 optimization</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20950901%20optimization&In-Reply-To=%3C22D5647C-D4FB-406D-9628-0F7A434379EA%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Rule 950901 optimization">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Jun 20 21:45:26 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001104.html">[Owasp-modsecurity-core-rule-set] Rule 950901 optimization
</A></li>
        <LI>Next message: <A HREF="001106.html">[Owasp-modsecurity-core-rule-set] Question on	optional_rules/modsecurity_crs_25_cc_known.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1105">[ date ]</a>
              <a href="thread.html#1105">[ thread ]</a>
              <a href="subject.html#1105">[ subject ]</a>
              <a href="author.html#1105">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Guys,
This is GREAT feedback. As part of the CRS update, we want to do this type of analysis on all rules.

I will be sending out emails to start the discussions.

Ryan

On Jun 20, 2012, at 5:14 PM, Andrew Norris &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">andrewn at locus.net</A>&gt; wrote:

&gt;<i> For what it's worth I'll throw my optimization for that rule into the mix:
</I>&gt;<i>
</I>&gt;<i> &quot;(?i:([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)([\d\w]++)([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)(?:(?:=|&lt;=&gt;|r?like|sounds\s+like|regexp)([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)\2|(?:!=|&lt;=|&gt;=|&lt;&gt;|&lt;|&gt;|\^|is\s+not|not\s+like|not\s+regexp)([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)(?!\2)([\d\w]+)))&quot;
</I>&gt;<i>
</I>&gt;<i> On 06/20/2012 03:35 PM, Benjamin Flament wrote:
</I>&gt;&gt;<i> Hi
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Rule 950901 on CRS 2.2.5 is missing several regex optimizations. It
</I>&gt;&gt;<i> captures way too much data and tends to originate alerts related to PCRE
</I>&gt;&gt;<i> capture limits exceeded.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I sugest changing it from:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;(?i:([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)?([\d\w]+)([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)?(?:=|&lt;=&gt;|r?like|sounds\s+like|regexp)([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)?\2|([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)?([\d\w]+)([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)?(?:!=|&lt;=|&gt;=|&lt;&gt;|&lt;|&gt;|\^|is\s+not|not\s+like|not\s+regexp)([\s'\&quot;`&#180;&#8217;&#8216;\(\)]*)?(?!\6)([\d\w]+))&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> to:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &quot;(?i:[\s'\&quot;`&#180;&#8217;&#8216;\(\)]*([\d\w]+)[\s'\&quot;`&#180;&#8217;&#8216;\(\)]*(?:=|&lt;=&gt;|r?like|sounds\s+like|regexp)[\s'\&quot;`&#180;&#8217;&#8216;\(\)]*\1|[\s'\&quot;`&#180;&#8217;&#8216;\(\)]*([\d\w]+)[\s'\&quot;`&#180;&#8217;&#8216;\(\)]*(?:!=|&lt;=|&gt;=|&lt;&gt;|&lt;|&gt;|\^|is\s+not|not\s+like|not\s+regexp)[\s'\&quot;`&#180;&#8217;&#8216;\(\)]*(?:(?!\2))[\d\w]+)&quot;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> The only modifications are the removal of some redundant characters and
</I>&gt;&gt;<i> adding of non capturing groups to some parts.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Regards
</I>&gt;&gt;<i> Benjamin
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Andrew Norris
</I>&gt;<i> Systems Administrator
</I>&gt;<i> Locus Telecommunications
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">andrewn at locus.net</A>
</I>&gt;<i> (201)-585-3605
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001104.html">[Owasp-modsecurity-core-rule-set] Rule 950901 optimization
</A></li>
	<LI>Next message: <A HREF="001106.html">[Owasp-modsecurity-core-rule-set] Question on	optional_rules/modsecurity_crs_25_cc_known.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1105">[ date ]</a>
              <a href="thread.html#1105">[ thread ]</a>
              <a href="subject.html#1105">[ subject ]</a>
              <a href="author.html#1105">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
