<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] 10 Setup Conf File: SecDefaultAction
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%20Thread%5D%0A%2010%20Setup%20Conf%20File%3A%20SecDefaultAction&In-Reply-To=%3CCBF50352.50508%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001085.html">
   <LINK REL="Next"  HREF="001096.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] 10 Setup Conf File: SecDefaultAction</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%20Thread%5D%0A%2010%20Setup%20Conf%20File%3A%20SecDefaultAction&In-Reply-To=%3CCBF50352.50508%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] 10 Setup Conf File: SecDefaultAction">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Jun  6 17:03:39 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001085.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] 10 Setup Conf File: SecComponentSignature
</A></li>
        <LI>Next message: <A HREF="001096.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] 10 Setup Conf File: SecDefaultAction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1082">[ date ]</a>
              <a href="thread.html#1082">[ thread ]</a>
              <a href="subject.html#1082">[ subject ]</a>
              <a href="author.html#1082">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Updated the following section for the SecDefaultAction directive that controls the mode of operation &#8211; either self-contained or collaborative detection.

#
# -- [[ Modes of Operation: Self-Contained vs. Collaborative Detection ]] -----------------
#
# Each detection rule uses the &quot;block&quot; action which will inherit the SecDefaultAction
# specified below.  Your settings here will determine which mode of operation you use.
#
# -- [[ Self-Contained Mode ]] --
# Rules inherit the &quot;deny&quot; disruptive action.  The first rule that matches will block.
#
# -- [[ Collaborative Detection Mode ]] --
# This is a &quot;delayed blocking&quot; mode of operation where each matching rule will inherit
# the &quot;pass&quot; action and will only contribute to anomaly scores.  Transactional blocking
# can be applied
#
# -- [[ Alert Logging Control ]] --
# You have three options -
#
# - To log to both the Apache error_log and ModSecurity audit_log file use: &quot;log&quot;
# - To log *only* to the ModSecurity audit_log file use: &quot;nolog,auditlog&quot;
# - To log *only* to the Apache error_log file use: &quot;log,noauditlog&quot;
#
# Ref: <A HREF="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html</A>
# Ref: <A HREF="https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecDefaultAction">https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecDefaultAction</A>
#
SecDefaultAction &quot;phase:2,deny,log&quot;

For discussion purposes, regarding &quot;disruptive actions&quot;, I believe that we should consider responding differently to malicious transactions.  Issuing HTTP 4xx level response codes are of no help to non-malicious end users who have innocently triggered an alert and they also &quot;tip the hand&quot; a bit to malicious users that there is some type of separate security layer in place.  I am a proponent of trying to make a WAF deployment transparent to the user &#8211; meaning that they can decipher when ModSecurity has triggered an alert vs. if the application itself issues some type of violation.

For example &#8211; oftentimes when an invalid request is received, applications will issue 302 Redirects back to the previous page or a login page.  I would like to prose the idea of using the redirect action here within the SecDefaultAction setting and letting the ModSec Admin choose where to redirect users too when an alert is triggered.  Example:

SecDefaultAction &quot;phase:2,redirect:<A HREF="http://www.example.com/login.php,log">http://www.example.com/login.php,log</A>&quot;

Comments?

--
Ryan Barnett
Trustwave SpiderLabs
ModSecurity Project Leader
OWASP ModSecurity CRS Project Leader

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120606/6b40b3c3/attachment-0003.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120606/6b40b3c3/attachment-0003.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001085.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] 10 Setup Conf File: SecComponentSignature
</A></li>
	<LI>Next message: <A HREF="001096.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] 10 Setup Conf File: SecDefaultAction
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1082">[ date ]</a>
              <a href="thread.html#1082">[ thread ]</a>
              <a href="subject.html#1082">[ subject ]</a>
              <a href="author.html#1082">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
