<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS and json
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20and%20json&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000428.html">
   <LINK REL="Next"  HREF="000430.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS and json</H1>
    <B>Jakub Ouhrabka</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20and%20json&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] CRS and json">kuba at comgate.cz
       </A><BR>
    <I>Thu Aug 19 00:51:04 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000428.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
        <LI>Next message: <A HREF="000430.html">[Owasp-modsecurity-core-rule-set] [JIRA] Resolved: (CORERULES-40) tx.restricted_headers partial string comparison
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#429">[ date ]</a>
              <a href="thread.html#429">[ thread ]</a>
              <a href="subject.html#429">[ subject ]</a>
              <a href="author.html#429">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

I'm a modsecurity/crs newbie. I like both projects very much!

I have one question though: How to cope with json in POST requests to 
the server, e.g.

{&quot;requiredMessages&quot;:[{&quot;contactID&quot;:&quot;86&quot;,&quot;lastInGot&quot;:null,&quot;lastOutGot&quot;:null},{&quot;contactID&quot;:&quot;85&quot;,&quot;lastInGot&quot;:null,&quot;lastOutGot&quot;:null},{&quot;contactID&quot;:&quot;90&quot;,&quot;lastInGot&quot;:null,&quot;lastOutGot&quot;:null}],&quot;readMessages&quot;:[],&quot;userEvents&quot;:[{&quot;eventID&quot;:&quot;2&quot;,&quot;eventName&quot;:&quot;openTab&quot;,&quot;eventParam&quot;:86},{&quot;eventID&quot;:&quot;3&quot;,&quot;eventName&quot;:&quot;openTab&quot;,&quot;eventParam&quot;:85},{&quot;eventID&quot;:&quot;4&quot;,&quot;eventName&quot;:&quot;openTab&quot;,&quot;eventParam&quot;:90}]}

I tried the request here:

<A HREF="http://www.modsecurity.org/demo/">http://www.modsecurity.org/demo/</A>
<A HREF="http://demo.php-ids.org/">http://demo.php-ids.org/</A>

Modsecurity always blocks the request - due to rules imported from 
php-ids. But when trying on php-ids website with checked json checkbox 
the request is considered ok.

Is it possible to detect json requests in modsecurity/crs automatically? 
Or should I mark them somehow, e.g. add request header, use only special 
variable name jsondata?

When the json request is detected is it possible to process it the same 
way as php-ids would do it?

Looking in the source code of php-ids, I think that when it detects json 
data (using variable name) it first decodes it and then it's processed 
by rules. Would it be possible to do the same in modsecurity?

Thanks,

Kuba
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000428.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
	<LI>Next message: <A HREF="000430.html">[Owasp-modsecurity-core-rule-set] [JIRA] Resolved: (CORERULES-40) tx.restricted_headers partial string comparison
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#429">[ date ]</a>
              <a href="thread.html#429">[ thread ]</a>
              <a href="subject.html#429">[ subject ]</a>
              <a href="author.html#429">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
