<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] 900011 double-counting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20900011%20double-counting&In-Reply-To=5889717B8EF90049926E1B6B68E220140D78ACDF%40BD01MSXMB018.US.Cingular.Net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000425.html">
   <LINK REL="Next"  HREF="000427.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] 900011 double-counting</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20900011%20double-counting&In-Reply-To=5889717B8EF90049926E1B6B68E220140D78ACDF%40BD01MSXMB018.US.Cingular.Net"
       TITLE="[Owasp-modsecurity-core-rule-set] 900011 double-counting">rcbarnett at gmail.com
       </A><BR>
    <I>Thu Aug  5 17:37:52 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000425.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
        <LI>Next message: <A HREF="000427.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#426">[ date ]</a>
              <a href="thread.html#426">[ thread ]</a>
              <a href="subject.html#426">[ subject ]</a>
              <a href="author.html#426">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I believe this is caused be &quot;paranoid_mode&quot; being set to 1 in the 10
conf file.  This mode checks the sigs against variables that are prone
to higher false positive rates.

I am fixing the logic in the next phpids filters file version so that
it will skip the paparoind check if the initial rule matches.


On 8/5/10, MARTIN, JASON (ATTSI) &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">JM9991 at att.com</A>&gt; wrote:
&gt;<i> Hello, I am trying to figure out why arule 900011 rule seems to be being
</I>&gt;<i> 'double-counted' against the anomaly score. Rule 900011 is triggering
</I>&gt;<i> twice on the same value; /home/ appears once in the argument but it
</I>&gt;<i> triggers twice. Any ideas why this is happening?
</I>&gt;<i>
</I>&gt;<i> When I add a counter-rule to reduce the score (as this behavior is ok
</I>&gt;<i> for my site), it fires only once and so the score is too high.
</I>&gt;<i>
</I>&gt;<i> This is with CRS 2.0.7 (patched with
</I>&gt;<i> <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2010-J">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2010-J</A>
</I>&gt;<i> une/000398.html) , mod_security  2.5.12, apache 2.2.15, Solaris 10
</I>&gt;<i> SPARC.
</I>&gt;<i>
</I>&gt;<i> --00002f18-A--
</I>&gt;<i> [05/Aug/2010:12:22:10 --0700] TFsPYQoWATMAAGRfQSYAAADP x.x.x.x x.x.x.x
</I>&gt;<i> --00002f18-B--
</I>&gt;<i> GET /foo?bar=/en_US/home/default.xml&amp;modsecdebug=taps HTTP/1.1
</I>&gt;<i> User-Agent: curl/7.19.4 (i386-pc-solaris2.11) libcurl/7.19.4
</I>&gt;<i> OpenSSL/0.9.8a zlib/1.2.3 libidn/1.9
</I>&gt;<i> Host: example.com
</I>&gt;<i> Accept: */*
</I>&gt;<i> Cache-Control: max-stale=0
</I>&gt;<i> Connection: Keep-Alive
</I>&gt;<i>
</I>&gt;<i> --00002f18-F--
</I>&gt;<i> HTTP/1.1 404 Not Found
</I>&gt;<i> Content-Length: 201
</I>&gt;<i> Keep-Alive: timeout=30, max=187
</I>&gt;<i> Connection: Keep-Alive
</I>&gt;<i> Content-Type: text/html; charset=iso-8859-1
</I>&gt;<i>
</I>&gt;<i> --00002f18-H--
</I>&gt;<i> Message: Matched phrase &quot;curl&quot; at REQUEST_HEADERS:User-Agent. [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
</I>&gt;<i> dsecurity_crs_35_bad_robots.conf&quot;] [line &quot;26&quot;] [id &quot;990012&quot;] [rev
</I>&gt;<i> &quot;2.0.7&quot;] [msg &quot;Rogue web site crawler&quot;] [data &quot;curl&quot;] [severity
</I>&gt;<i> &quot;WARNING&quot;] [tag &quot;AUTOMATION/MALICIOUS&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag
</I>&gt;<i> &quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;]
</I>&gt;<i> Message: Pattern match
</I>&gt;<i> &quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
</I>&gt;<i> p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
</I>&gt;<i> |(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
</I>&gt;<i> dsecurity_crs_41_phpids_filters.conf&quot;] [line &quot;101&quot;] [id &quot;900011&quot;] [msg
</I>&gt;<i> &quot;Detects specific directory and path traversal&quot;] [data &quot;/home/&quot;]
</I>&gt;<i> [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag
</I>&gt;<i> &quot;WEB_ATTACK/LFI&quot;]
</I>&gt;<i> Message: Pattern match
</I>&gt;<i> &quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
</I>&gt;<i> p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
</I>&gt;<i> |(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
</I>&gt;<i> dsecurity_crs_41_phpids_filters.conf&quot;] [line &quot;101&quot;] [id &quot;900011&quot;] [msg
</I>&gt;<i> &quot;Detects specific directory and path traversal&quot;] [data &quot;/home/&quot;]
</I>&gt;<i> [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag
</I>&gt;<i> &quot;WEB_ATTACK/LFI&quot;]
</I>&gt;<i> Message: Operator GE matched 21 at TX:anomaly_score. [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
</I>&gt;<i> dsecurity_crs_49_inbound_blocking.conf&quot;] [line &quot;18&quot;] [msg &quot;Inbound
</I>&gt;<i> Anomaly Score Exceeded (Total Score: 52, SQLi=, XSS=): 900011-Detects
</I>&gt;<i> specific directory and path traversal&quot;]
</I>&gt;<i> Message: Warning. Operator GE matched 21 at TX:inbound_anomaly_score.
</I>&gt;<i> [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
</I>&gt;<i> dsecurity_crs_60_correlation.conf&quot;] [line &quot;35&quot;] [msg &quot;Inbound Anomaly
</I>&gt;<i> Score Exceeded (Total Inbound Score: 52, SQLi=, XSS=): 900011-Detects
</I>&gt;<i> specific directory and path traversal&quot;]
</I>&gt;<i> Apache-Error: [file &quot;core.c&quot;] [line 3648] [level 3] File does not exist:
</I>&gt;<i> /sites/www-site/www/foo
</I>&gt;<i> Stopwatch: 1281036129731407 461977 (5100 459965 -)
</I>&gt;<i> Producer: ModSecurity for Apache/2.5.12 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>);
</I>&gt;<i> core ruleset/2.0.7.
</I>&gt;<i> Server: Apache
</I>&gt;<i>
</I>&gt;<i> --00002f18-K--
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,pass,nolog,initcol:global=global,initcol:ip=%{r
</I>&gt;<i> emote_addr}&quot;
</I>&gt;<i> SecAction &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.paranoid_mode=0&quot;
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_leve
</I>&gt;<i> l=21&quot;
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_lev
</I>&gt;<i> el=15&quot;
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.critical_anomaly_score=21,
</I>&gt;<i> setvar:tx.error_anomaly_score=15,setvar:tx.warning_anomaly_score=10,setv
</I>&gt;<i> ar:tx.notice_anomaly_score=5&quot;
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_num_args=255&quot;
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_file_size=1048576&quot;
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.combined_file_sizes=104857
</I>&gt;<i> 6&quot;
</I>&gt;<i> SecAction
</I>&gt;<i> &quot;phase:1,auditlog,t:none,nolog,pass,setvar:'tx.allowed_methods=GET HEAD
</I>&gt;<i> POST',setvar:'tx.allowed_request_content_type=application/x-www-form-url
</I>&gt;<i> encoded multipart/form-data text/xml
</I>&gt;<i> application/xml',setvar:'tx.allowed_http_versions=HTTP/0.9 HTTP/1.0
</I>&gt;<i> HTTP/1.1',setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/
</I>&gt;<i> .backup/ .bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/
</I>&gt;<i> .csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/
</I>&gt;<i> .idq/ .inc/ .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/
</I>&gt;<i> .pol/ .printer/ .pwd/ .resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/
</I>&gt;<i> .vsdisco/ .webinfo/ .xsd/
</I>&gt;<i> .xsx/',setvar:'tx.restricted_headers=/Proxy-Connection/ /Lock-Token/
</I>&gt;<i> /Content-Range/ /Translate/ /via/ /if/'&quot;
</I>&gt;<i> SecRule &quot;ARGS:modsecdebug&quot; &quot;@rx taps&quot;
</I>&gt;<i> &quot;phase:2,log,auditlog,pass,ctl:debugLogLevel=9&quot;
</I>&gt;<i> SecRule &quot;REQUEST_METHOD&quot; &quot;@rx ^(?:GET|HEAD)$&quot;
</I>&gt;<i> &quot;phase:2,chain,rev:2.0.7,t:none,pass,nolog,auditlog,msg:'GET or HEAD
</I>&gt;<i> requests with
</I>&gt;<i> bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION,tag:WASCTC/W
</I>&gt;<i> ASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,tag:<A HREF="http://www.w3.org/Protocol">http://www.w3.org/Protocol</A>
</I>&gt;<i> s/rfc2616/rfc2616-sec4.html#sec4.3&quot;
</I>&gt;<i> SecRule &quot;&amp;REQUEST_HEADERS:Pragma&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:2,chain,rev:2.0.7,t:none,pass,nolog,auditlog,msg:'Pragma Header
</I>&gt;<i> requires Cache-Control Header for HTTP/1.1
</I>&gt;<i> requests.',severity:5,id:960020,tag:PROTOCOL_VIOLATION/INVALID_HREQ,tag:
</I>&gt;<i> <A HREF="http://www.bad-behavior.ioerror.us/documentation/how-it-works/&quot;">http://www.bad-behavior.ioerror.us/documentation/how-it-works/&quot;</A>
</I>&gt;<i> SecRule &quot;&amp;REQUEST_HEADERS:Content-Type&quot; &quot;@eq 0&quot;
</I>&gt;<i> &quot;phase:2,pass,chain,rev:2.0.7,t:none,nolog,auditlog,msg:'Request
</I>&gt;<i> Containing Content, but Missing Content-Type
</I>&gt;<i> header',id:960904,severity:5&quot;
</I>&gt;<i> SecRule &quot;&amp;TX:MAX_NUM_ARGS&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Too many arguments in
</I>&gt;<i> request',id:960335,severity:4,rev:2.0.7&quot;
</I>&gt;<i> SecRule &quot;&amp;TX:MAX_FILE_SIZE&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Uploaded file size too
</I>&gt;<i> large',id:960342,severity:4,rev:2.0.7&quot;
</I>&gt;<i> SecRule &quot;&amp;TX:COMBINED_FILE_SIZES&quot; &quot;@eq 1&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Total uploaded files size
</I>&gt;<i> too large',id:960343,severity:4,rev:2.0.7&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
</I>&gt;<i> by
</I>&gt;<i> policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
</I>&gt;<i> WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
</I>&gt;<i> 15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
</I>&gt;<i> pture,setvar:tx.header_name='/%{tx.0}/'&quot;
</I>&gt;<i> SecRule &quot;REQUEST_HEADERS:User-Agent&quot; &quot;@pmFromFile
</I>&gt;<i> modsecurity_35_bad_robots.data&quot;
</I>&gt;<i> &quot;phase:2,rev:2.0.7,t:none,pass,nolog,auditlog,msg:'Rogue web site
</I>&gt;<i> crawler',id:990012,tag:AUTOMATION/MALICIOUS,tag:WASCTC/WASC-21,tag:OWASP
</I>&gt;<i> _TOP_10/A7,tag:PCI/6.5.10,severity:4,capture,logdata:%{TX.0},setvar:tx.m
</I>&gt;<i> sg=%{rule.msg},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setv
</I>&gt;<i> ar:tx.automation_score=+%{tx.warning_anomaly_score},setvar:tx.%{rule.id}
</I>&gt;<i> -AUTOMATION/MALICIOUS-%{matched_var_name}=%{matched_var}&quot;
</I>&gt;<i> SecRule &quot;REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot; &quot;@pmFromFile
</I>&gt;<i> modsecurity_40_generic_attacks.data&quot;
</I>&gt;<i> &quot;phase:2,rev:2.0.7,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowe
</I>&gt;<i> rcase,nolog,pass,setvar:tx.pm_score=+1&quot;
</I>&gt;<i> SecRule &quot;REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot; &quot;@pmFromFile
</I>&gt;<i> modsecurity_40_generic_attacks.data&quot;
</I>&gt;<i> &quot;phase:2,rev:2.0.7,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowe
</I>&gt;<i> rcase,nolog,pass,setvar:tx.pm_score=+1&quot;
</I>&gt;<i> SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
</I>&gt;<i> &quot;phase:2,t:none,nolog,skipAfter:END_SESSION_FIXATION&quot;
</I>&gt;<i> SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
</I>&gt;<i> &quot;phase:2,t:none,nolog,skipAfter:END_FILE_INJECTION&quot;
</I>&gt;<i> SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
</I>&gt;<i> &quot;phase:2,t:none,nolog,skipAfter:END_COMMAND_ACCESS&quot;
</I>&gt;<i> SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
</I>&gt;<i> &quot;phase:2,t:none,nolog,skipAfter:END_COMMAND_INJECTION&quot;
</I>&gt;<i> SecRule &quot;ARGS|ARGS_NAMES|XML:/*&quot; &quot;@rx
</I>&gt;<i> (?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev
</I>&gt;<i> |tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/|
</I>&gt;<i> \\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot;
</I>&gt;<i> &quot;phase:2,capture,multiMatch,t:none,t:cssDecode,t:jsDecode,t:htmlEntityDe
</I>&gt;<i> code,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogPart
</I>&gt;<i> s=+E,block,nolog,auditlog,msg:'Detects specific directory and path
</I>&gt;<i> traversal',id:900011,tag:WEB_ATTACK/DT,tag:WEB_ATTACK/ID,tag:WEB_ATTACK/
</I>&gt;<i> LFI,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.id}-%{rule.msg},setv
</I>&gt;<i> ar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{tx.msg}-WE
</I>&gt;<i> B_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}&quot;
</I>&gt;<i> SecRule &quot;ARGS|ARGS_NAMES|XML:/*&quot; &quot;@rx
</I>&gt;<i> (?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev
</I>&gt;<i> |tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/|
</I>&gt;<i> \\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot;
</I>&gt;<i> &quot;phase:2,capture,multiMatch,t:none,t:cssDecode,t:jsDecode,t:htmlEntityDe
</I>&gt;<i> code,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogPart
</I>&gt;<i> s=+E,block,nolog,auditlog,msg:'Detects specific directory and path
</I>&gt;<i> traversal',id:900011,tag:WEB_ATTACK/DT,tag:WEB_ATTACK/ID,tag:WEB_ATTACK/
</I>&gt;<i> LFI,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.id}-%{rule.msg},setv
</I>&gt;<i> ar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{tx.msg}-WE
</I>&gt;<i> B_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}&quot;
</I>&gt;<i> SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
</I>&gt;<i> &quot;phase:2,rev:2.0.7,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK&quot;
</I>&gt;<i> SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
</I>&gt;<i> &quot;phase:2,t:none,nolog,skipAfter:END_XSS_CHECK&quot;
</I>&gt;<i> SecRule &quot;TX:ANOMALY_SCORE&quot; &quot;@gt 0&quot;
</I>&gt;<i> &quot;phase:2,chain,t:none,nolog,auditlog,block,msg:'Inbound Anomaly Score
</I>&gt;<i> Exceeded (Total Score: %{TX.ANOMALY_SCORE}, SQLi=%{TX.SQLI_SCORE},
</I>&gt;<i> XSS=%{TX.XSS_SCORE}):
</I>&gt;<i> %{tx.msg}',setvar:tx.inbound_tx_msg=%{tx.msg},setvar:tx.inbound_anomaly_
</I>&gt;<i> score=%{tx.anomaly_score}&quot;
</I>&gt;<i> SecRule &quot;TX:ANOMALY_SCORE&quot; &quot;@ge %{tx.inbound_anomaly_score_level}&quot;
</I>&gt;<i> SecRule &quot;TX:INBOUND_ANOMALY_SCORE&quot; &quot;@gt 0&quot;
</I>&gt;<i> &quot;phase:5,chain,t:none,log,noauditlog,pass,msg:'Inbound Anomaly Score
</I>&gt;<i> (Total Inbound Score: %{TX.INBOUND_ANOMALY_SCORE},
</I>&gt;<i> SQLi=%{TX.SQLI_SCORE}, XSS=%{TX.XSS_SCORE}): %{tx.inbound_tx_msg}'&quot;
</I>&gt;<i> SecRule &quot;TX:INBOUND_ANOMALY_SCORE&quot; &quot;@ge
</I>&gt;<i> %{tx.inbound_anomaly_score_level}&quot;
</I>&gt;<i> &quot;phase:5,t:none,log,noauditlog,pass,msg:'Inbound Anomaly Score Exceeded
</I>&gt;<i> (Total Inbound Score: %{TX.INBOUND_ANOMALY_SCORE},
</I>&gt;<i> SQLi=%{TX.SQLI_SCORE}, XSS=%{TX.XSS_SCORE}): %{tx.inbound_tx_msg}'&quot;
</I>&gt;<i>
</I>&gt;<i> --00002f18-Z-
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Section of the debug log showing the duplicate:
</I>&gt;<i>
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Recipe: Invoking rule
</I>&gt;<i> f2bea8; [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
</I>&gt;<i> dsecurity_crs_41_phpids_filters.conf&quot;] [line &quot;101&quot;] [id &quot;900011&quot;].
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][5] Rule f2bea8: SecRule
</I>&gt;<i> &quot;ARGS|ARGS_NAMES|XML:/*&quot; &quot;@rx
</I>&gt;<i> (?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev
</I>&gt;<i> |tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/|
</I>&gt;<i> \\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot;
</I>&gt;<i> &quot;phase:2,capture,m
</I>&gt;<i> ultiMatch,t:none,t:cssDecode,t:jsDecode,t:htmlEntityDecode,t:replaceComm
</I>&gt;<i> ents,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,nolog,a
</I>&gt;<i> uditlog,msg:'Detects specific directory and path
</I>&gt;<i> traversal',id:900011,tag:WEB_ATTACK/DT,tag:WEB_ATTACK/ID,tag:WEB_ATTACK/
</I>&gt;<i> LFI,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.id}-%{rule.msg},setv
</I>&gt;<i> ar:tx.anomaly_score=+%{tx.cr
</I>&gt;<i> itical_anomaly_score},setvar:tx.%{tx.msg}-WEB_ATTACK/INJECTION-%{matched
</I>&gt;<i> _var_name}=%{tx.0}&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Expanded
</I>&gt;<i> &quot;ARGS|ARGS_NAMES|XML:/*&quot; to
</I>&gt;<i> &quot;ARGS:bar|ARGS:modsecdebug|ARGS_NAMES:bar|ARGS_NAMES:modsecdebug&quot;.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Transformation completed
</I>&gt;<i> in 2 usec.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Executing operator &quot;rx&quot;
</I>&gt;<i> with param
</I>&gt;<i> &quot;(?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|de
</I>&gt;<i> v|tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/
</I>&gt;<i> |\\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot; against
</I>&gt;<i> ARGS:bar.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Target value:
</I>&gt;<i> &quot;/en_US/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
</I>&gt;<i> to TX.0: /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
</I>&gt;<i> to TX.1: home
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Operator completed in 62
</I>&gt;<i> usec.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Ctl: Set auditLogParts to
</I>&gt;<i> ABIFHKZE.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
</I>&gt;<i> tx.msg=%{rule.id}-%{rule.msg}
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.id}
</I>&gt;<i> to: 900011
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.msg}
</I>&gt;<i> to: Detects specific directory and path traversal
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable &quot;tx.msg&quot; to
</I>&gt;<i> &quot;900011-Detects specific directory and path traversal&quot;.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
</I>&gt;<i> tx.anomaly_score=+%{tx.critical_anomaly_score}
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Original collection
</I>&gt;<i> variable: tx.anomaly_score = &quot;10&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
</I>&gt;<i> %{tx.critical_anomaly_score} to: 21
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Relative change:
</I>&gt;<i> anomaly_score=10+21
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
</I>&gt;<i> &quot;tx.anomaly_score&quot; to &quot;31&quot;.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
</I>&gt;<i> tx.%{tx.msg}-WEB_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.msg}
</I>&gt;<i> to: 900011-Detects specific directory and path traversal
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
</I>&gt;<i> %{matched_var_name} to: ARGS:bar
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.0} to:
</I>&gt;<i> /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
</I>&gt;<i> &quot;tx.900011-Detects specific directory and path
</I>&gt;<i> traversal-WEB_ATTACK/INJECTION-ARGS:bar&quot; to &quot;/home/&quot;.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
</I>&gt;<i> /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
</I>&gt;<i> /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Warning. Pattern match
</I>&gt;<i> &quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
</I>&gt;<i> p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
</I>&gt;<i> |(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-w
</I>&gt;<i> orker-niagara/conf/modsecurity2/modsecurity_crs_41_phpids_filters.conf&quot;]
</I>&gt;<i> [line &quot;101&quot;] [id &quot;900011&quot;] [msg &quot;Detects specific directory and path
</I>&gt;<i> traversal&quot;] [data &quot;/home/&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;]
</I>&gt;<i> [tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) cssDecode:
</I>&gt;<i> &quot;/en_US/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) jsDecode:
</I>&gt;<i> &quot;/en_US/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) htmlEntityDecode:
</I>&gt;<i> &quot;/en_US/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) replaceComments:
</I>&gt;<i> &quot;/en_US/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) compressWhitespace:
</I>&gt;<i> &quot;/en_US/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) lowercase:
</I>&gt;<i> &quot;/en_us/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Transformation completed
</I>&gt;<i> in 1969 usec.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Executing operator &quot;rx&quot;
</I>&gt;<i> with param
</I>&gt;<i> &quot;(?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|de
</I>&gt;<i> v|tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/
</I>&gt;<i> |\\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot; against
</I>&gt;<i> ARGS:bar.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Target value:
</I>&gt;<i> &quot;/en_us/home/default.xml&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
</I>&gt;<i> to TX.0: /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
</I>&gt;<i> to TX.1: home
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Operator completed in 64
</I>&gt;<i> usec.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Ctl: Set auditLogParts to
</I>&gt;<i> ABIFHKZEE.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
</I>&gt;<i> tx.msg=%{rule.id}-%{rule.msg}
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.id}
</I>&gt;<i> to: 900011
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.msg}
</I>&gt;<i> to: Detects specific directory and path traversal
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable &quot;tx.msg&quot; to
</I>&gt;<i> &quot;900011-Detects specific directory and path traversal&quot;.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
</I>&gt;<i> tx.anomaly_score=+%{tx.critical_anomaly_score}
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Original collection
</I>&gt;<i> variable: tx.anomaly_score = &quot;31&quot;
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
</I>&gt;<i> %{tx.critical_anomaly_score} to: 21
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Relative change:
</I>&gt;<i> anomaly_score=31+21
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
</I>&gt;<i> &quot;tx.anomaly_score&quot; to &quot;52&quot;.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
</I>&gt;<i> tx.%{tx.msg}-WEB_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.msg}
</I>&gt;<i> to: 900011-Detects specific directory and path traversal
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
</I>&gt;<i> %{matched_var_name} to: ARGS:bar
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.0} to:
</I>&gt;<i> /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
</I>&gt;<i> &quot;tx.900011-Detects specific directory and path
</I>&gt;<i> traversal-WEB_ATTACK/INJECTION-ARGS:bar&quot; to &quot;/home/&quot;.
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
</I>&gt;<i> /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
</I>&gt;<i> /home/
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Warning. Pattern match
</I>&gt;<i> &quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
</I>&gt;<i> p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
</I>&gt;<i> |(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&gt;<i> &quot;/sites/www-site/APACHE/httpd-2.2.15-w
</I>&gt;<i> orker-niagara/conf/modsecurity2/modsecurity_crs_41_phpids_filters.conf&quot;]
</I>&gt;<i> [line &quot;101&quot;] [id &quot;900011&quot;] [msg &quot;Detects specific directory and path
</I>&gt;<i> traversal&quot;] [data &quot;/home/&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;]
</I>&gt;<i> [tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]
</I>&gt;<i> [05/Aug/2010:12:22:09 --0700]
</I>&gt;<i> [example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Transformation completed
</I>&gt;<i> in 2 usec.
</I>&gt;<i>
</I>&gt;<i> Thank you,
</I>&gt;<i> -Jason Martin
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>
-- 
Sent from my mobile device

Ryan C. Barnett
SANS Certified Instructor
WASC Web Hacking Incident Database Project Leader
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
<A HREF="http://tacticalwebappsec.blogspot.com/">http://tacticalwebappsec.blogspot.com/</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000425.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
	<LI>Next message: <A HREF="000427.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#426">[ date ]</a>
              <a href="thread.html#426">[ thread ]</a>
              <a href="subject.html#426">[ subject ]</a>
              <a href="author.html#426">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
