<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] 900011 double-counting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20900011%20double-counting&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000426.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] 900011 double-counting</H1>
    <B>MARTIN, JASON (ATTSI)</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20900011%20double-counting&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] 900011 double-counting">JM9991 at att.com
       </A><BR>
    <I>Thu Aug  5 16:19:06 EDT 2010</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000426.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#425">[ date ]</a>
              <a href="thread.html#425">[ thread ]</a>
              <a href="subject.html#425">[ subject ]</a>
              <a href="author.html#425">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, I am trying to figure out why arule 900011 rule seems to be being
'double-counted' against the anomaly score. Rule 900011 is triggering
twice on the same value; /home/ appears once in the argument but it
triggers twice. Any ideas why this is happening?

When I add a counter-rule to reduce the score (as this behavior is ok
for my site), it fires only once and so the score is too high.

This is with CRS 2.0.7 (patched with
<A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2010-J">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/2010-J</A>
une/000398.html) , mod_security  2.5.12, apache 2.2.15, Solaris 10
SPARC.

--00002f18-A--
[05/Aug/2010:12:22:10 --0700] TFsPYQoWATMAAGRfQSYAAADP x.x.x.x x.x.x.x
--00002f18-B--
GET /foo?bar=/en_US/home/default.xml&amp;modsecdebug=taps HTTP/1.1
User-Agent: curl/7.19.4 (i386-pc-solaris2.11) libcurl/7.19.4
OpenSSL/0.9.8a zlib/1.2.3 libidn/1.9
Host: example.com
Accept: */*
Cache-Control: max-stale=0
Connection: Keep-Alive

--00002f18-F--
HTTP/1.1 404 Not Found
Content-Length: 201
Keep-Alive: timeout=30, max=187
Connection: Keep-Alive
Content-Type: text/html; charset=iso-8859-1

--00002f18-H--
Message: Matched phrase &quot;curl&quot; at REQUEST_HEADERS:User-Agent. [file
&quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
dsecurity_crs_35_bad_robots.conf&quot;] [line &quot;26&quot;] [id &quot;990012&quot;] [rev
&quot;2.0.7&quot;] [msg &quot;Rogue web site crawler&quot;] [data &quot;curl&quot;] [severity
&quot;WARNING&quot;] [tag &quot;AUTOMATION/MALICIOUS&quot;] [tag &quot;WASCTC/WASC-21&quot;] [tag
&quot;OWASP_TOP_10/A7&quot;] [tag &quot;PCI/6.5.10&quot;]
Message: Pattern match
&quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
|<i>(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
dsecurity_crs_41_phpids_filters.conf&quot;] [line &quot;101&quot;] [id &quot;900011&quot;] [msg
&quot;Detects specific directory and path traversal&quot;] [data &quot;/home/&quot;]
[severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag
&quot;WEB_ATTACK/LFI&quot;]
Message: Pattern match
&quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
|<i>(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
dsecurity_crs_41_phpids_filters.conf&quot;] [line &quot;101&quot;] [id &quot;900011&quot;] [msg
&quot;Detects specific directory and path traversal&quot;] [data &quot;/home/&quot;]
[severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag
&quot;WEB_ATTACK/LFI&quot;]
Message: Operator GE matched 21 at TX:anomaly_score. [file
&quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
dsecurity_crs_49_inbound_blocking.conf&quot;] [line &quot;18&quot;] [msg &quot;Inbound
Anomaly Score Exceeded (Total Score: 52, SQLi=, XSS=): 900011-Detects
specific directory and path traversal&quot;]
Message: Warning. Operator GE matched 21 at TX:inbound_anomaly_score.
[file
&quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
dsecurity_crs_60_correlation.conf&quot;] [line &quot;35&quot;] [msg &quot;Inbound Anomaly
Score Exceeded (Total Inbound Score: 52, SQLi=, XSS=): 900011-Detects
specific directory and path traversal&quot;]
Apache-Error: [file &quot;core.c&quot;] [line 3648] [level 3] File does not exist:
/sites/www-site/www/foo
Stopwatch: 1281036129731407 461977 (5100 459965 -)
Producer: ModSecurity for Apache/2.5.12 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>);
core ruleset/2.0.7.
Server: Apache

--00002f18-K--
SecAction
&quot;phase:1,auditlog,t:none,pass,nolog,initcol:global=global,initcol:ip=%{r
emote_addr}&quot;
SecAction &quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.paranoid_mode=0&quot;
SecAction
&quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_leve
l=21&quot;
SecAction
&quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_lev
el=15&quot;
SecAction
&quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.critical_anomaly_score=21,
setvar:tx.error_anomaly_score=15,setvar:tx.warning_anomaly_score=10,setv
ar:tx.notice_anomaly_score=5&quot;
SecAction
&quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_num_args=255&quot;
SecAction
&quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_file_size=1048576&quot;
SecAction
&quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.combined_file_sizes=104857
6&quot;
SecAction
&quot;phase:1,auditlog,t:none,nolog,pass,setvar:'tx.allowed_methods=GET HEAD
POST',setvar:'tx.allowed_request_content_type=application/x-www-form-url
encoded multipart/form-data text/xml
application/xml',setvar:'tx.allowed_http_versions=HTTP/0.9 HTTP/1.0
HTTP/1.1',setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/
.backup/ .bak/ .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/
.csproj/ .csr/ .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/
.idq/ .inc/ .ini/ .key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/
.pol/ .printer/ .pwd/ .resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/
.vsdisco/ .webinfo/ .xsd/
.xsx/',setvar:'tx.restricted_headers=/Proxy-Connection/ /Lock-Token/
/Content-Range/ /Translate/ /via/ /if/'&quot;
SecRule &quot;ARGS:modsecdebug&quot; &quot;@rx taps&quot;
&quot;phase:2,log,auditlog,pass,ctl:debugLogLevel=9&quot;
SecRule &quot;REQUEST_METHOD&quot; &quot;@rx ^(?:GET|HEAD)$&quot;
&quot;phase:2,chain,rev:2.0.7,t:none,pass,nolog,auditlog,msg:'GET or HEAD
requests with
bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION,tag:WASCTC/W
ASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,tag:<A HREF="http://www.w3.org/Protocol">http://www.w3.org/Protocol</A>
s/rfc2616/rfc2616-sec4.html#sec4.3&quot;
SecRule &quot;&amp;REQUEST_HEADERS:Pragma&quot; &quot;@eq 1&quot;
&quot;phase:2,chain,rev:2.0.7,t:none,pass,nolog,auditlog,msg:'Pragma Header
requires Cache-Control Header for HTTP/1.1
requests.',severity:5,id:960020,tag:PROTOCOL_VIOLATION/INVALID_HREQ,tag:
<A HREF="http://www.bad-behavior.ioerror.us/documentation/how-it-works/&quot;">http://www.bad-behavior.ioerror.us/documentation/how-it-works/&quot;</A>
SecRule &quot;&amp;REQUEST_HEADERS:Content-Type&quot; &quot;@eq 0&quot;
&quot;phase:2,pass,chain,rev:2.0.7,t:none,nolog,auditlog,msg:'Request
Containing Content, but Missing Content-Type
header',id:960904,severity:5&quot;
SecRule &quot;&amp;TX:MAX_NUM_ARGS&quot; &quot;@eq 1&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Too many arguments in
request',id:960335,severity:4,rev:2.0.7&quot;
SecRule &quot;&amp;TX:MAX_FILE_SIZE&quot; &quot;@eq 1&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Uploaded file size too
large',id:960342,severity:4,rev:2.0.7&quot;
SecRule &quot;&amp;TX:COMBINED_FILE_SIZES&quot; &quot;@eq 1&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Total uploaded files size
too large',id:960343,severity:4,rev:2.0.7&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS_NAMES&quot; &quot;@rx ^(.*)$&quot;
&quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'HTTP header is restricted
by
policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLO
WED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-
15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},ca
pture,setvar:tx.header_name='/%{tx.0}/'&quot;
SecRule &quot;REQUEST_HEADERS:User-Agent&quot; &quot;@pmFromFile
modsecurity_35_bad_robots.data&quot;
&quot;phase:2,rev:2.0.7,t:none,pass,nolog,auditlog,msg:'Rogue web site
crawler',id:990012,tag:AUTOMATION/MALICIOUS,tag:WASCTC/WASC-21,tag:OWASP
_TOP_10/A7,tag:PCI/6.5.10,severity:4,capture,logdata:%{TX.0},setvar:tx.m
sg=%{rule.msg},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setv
ar:tx.automation_score=+%{tx.warning_anomaly_score},setvar:tx.%{rule.id}
-AUTOMATION/MALICIOUS-%{matched_var_name}=%{matched_var}&quot;
SecRule &quot;REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot; &quot;@pmFromFile
modsecurity_40_generic_attacks.data&quot;
&quot;phase:2,rev:2.0.7,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowe
rcase,nolog,pass,setvar:tx.pm_score=+1&quot;
SecRule &quot;REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot; &quot;@pmFromFile
modsecurity_40_generic_attacks.data&quot;
&quot;phase:2,rev:2.0.7,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowe
rcase,nolog,pass,setvar:tx.pm_score=+1&quot;
SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
&quot;phase:2,t:none,nolog,skipAfter:END_SESSION_FIXATION&quot;
SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
&quot;phase:2,t:none,nolog,skipAfter:END_FILE_INJECTION&quot;
SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
&quot;phase:2,t:none,nolog,skipAfter:END_COMMAND_ACCESS&quot;
SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
&quot;phase:2,t:none,nolog,skipAfter:END_COMMAND_INJECTION&quot;
SecRule &quot;ARGS|ARGS_NAMES|XML:/*&quot; &quot;@rx
(?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev
|<i>tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/|
</I>\\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot;
&quot;phase:2,capture,multiMatch,t:none,t:cssDecode,t:jsDecode,t:htmlEntityDe
code,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogPart
s=+E,block,nolog,auditlog,msg:'Detects specific directory and path
traversal',id:900011,tag:WEB_ATTACK/DT,tag:WEB_ATTACK/ID,tag:WEB_ATTACK/
LFI,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.id}-%{rule.msg},setv
ar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{tx.msg}-WE
B_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}&quot;
SecRule &quot;ARGS|ARGS_NAMES|XML:/*&quot; &quot;@rx
(?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev
|<i>tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/|
</I>\\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot;
&quot;phase:2,capture,multiMatch,t:none,t:cssDecode,t:jsDecode,t:htmlEntityDe
code,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogPart
s=+E,block,nolog,auditlog,msg:'Detects specific directory and path
traversal',id:900011,tag:WEB_ATTACK/DT,tag:WEB_ATTACK/ID,tag:WEB_ATTACK/
LFI,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.id}-%{rule.msg},setv
ar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{tx.msg}-WE
B_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}&quot;
SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
&quot;phase:2,rev:2.0.7,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK&quot;
SecRule &quot;TX:PARANOID_MODE&quot; &quot;!@eq 1&quot;
&quot;phase:2,t:none,nolog,skipAfter:END_XSS_CHECK&quot;
SecRule &quot;TX:ANOMALY_SCORE&quot; &quot;@gt 0&quot;
&quot;phase:2,chain,t:none,nolog,auditlog,block,msg:'Inbound Anomaly Score
Exceeded (Total Score: %{TX.ANOMALY_SCORE}, SQLi=%{TX.SQLI_SCORE},
XSS=%{TX.XSS_SCORE}):
%{tx.msg}',setvar:tx.inbound_tx_msg=%{tx.msg},setvar:tx.inbound_anomaly_
score=%{tx.anomaly_score}&quot;
SecRule &quot;TX:ANOMALY_SCORE&quot; &quot;@ge %{tx.inbound_anomaly_score_level}&quot;
SecRule &quot;TX:INBOUND_ANOMALY_SCORE&quot; &quot;@gt 0&quot;
&quot;phase:5,chain,t:none,log,noauditlog,pass,msg:'Inbound Anomaly Score
(Total Inbound Score: %{TX.INBOUND_ANOMALY_SCORE},
SQLi=%{TX.SQLI_SCORE}, XSS=%{TX.XSS_SCORE}): %{tx.inbound_tx_msg}'&quot;
SecRule &quot;TX:INBOUND_ANOMALY_SCORE&quot; &quot;@ge
%{tx.inbound_anomaly_score_level}&quot;
&quot;phase:5,t:none,log,noauditlog,pass,msg:'Inbound Anomaly Score Exceeded
(Total Inbound Score: %{TX.INBOUND_ANOMALY_SCORE},
SQLi=%{TX.SQLI_SCORE}, XSS=%{TX.XSS_SCORE}): %{tx.inbound_tx_msg}'&quot;

--00002f18-Z-


Section of the debug log showing the duplicate:

[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Recipe: Invoking rule
f2bea8; [file
&quot;/sites/www-site/APACHE/httpd-2.2.15-worker-niagara/conf/modsecurity2/mo
dsecurity_crs_41_phpids_filters.conf&quot;] [line &quot;101&quot;] [id &quot;900011&quot;].
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][5] Rule f2bea8: SecRule
&quot;ARGS|ARGS_NAMES|XML:/*&quot; &quot;@rx
(?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev
|<i>tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/|
</I>\\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot;
&quot;phase:2,capture,m
ultiMatch,t:none,t:cssDecode,t:jsDecode,t:htmlEntityDecode,t:replaceComm
ents,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,nolog,a
uditlog,msg:'Detects specific directory and path
traversal',id:900011,tag:WEB_ATTACK/DT,tag:WEB_ATTACK/ID,tag:WEB_ATTACK/
LFI,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.id}-%{rule.msg},setv
ar:tx.anomaly_score=+%{tx.cr
itical_anomaly_score},setvar:tx.%{tx.msg}-WEB_ATTACK/INJECTION-%{matched
_var_name}=%{tx.0}&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Expanded
&quot;ARGS|ARGS_NAMES|XML:/*&quot; to
&quot;ARGS:bar|ARGS:modsecdebug|ARGS_NAMES:bar|ARGS_NAMES:modsecdebug&quot;.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Transformation completed
in 2 usec.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Executing operator &quot;rx&quot;
with param
&quot;(?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|de
v|tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/
|<i>\\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot; against
</I>ARGS:bar.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Target value:
&quot;/en_US/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
to TX.0: /home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
to TX.1: home
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Operator completed in 62
usec.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Ctl: Set auditLogParts to
ABIFHKZE.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
tx.msg=%{rule.id}-%{rule.msg}
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.id}
to: 900011
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.msg}
to: Detects specific directory and path traversal
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable &quot;tx.msg&quot; to
&quot;900011-Detects specific directory and path traversal&quot;.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
tx.anomaly_score=+%{tx.critical_anomaly_score}
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Original collection
variable: tx.anomaly_score = &quot;10&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
%{tx.critical_anomaly_score} to: 21
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Relative change:
anomaly_score=10+21
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
&quot;tx.anomaly_score&quot; to &quot;31&quot;.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
tx.%{tx.msg}-WEB_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.msg}
to: 900011-Detects specific directory and path traversal
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
%{matched_var_name} to: ARGS:bar
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.0} to:
/home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
&quot;tx.900011-Detects specific directory and path
traversal-WEB_ATTACK/INJECTION-ARGS:bar&quot; to &quot;/home/&quot;.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
/home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
/home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Warning. Pattern match
&quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
|<i>(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&quot;/sites/www-site/APACHE/httpd-2.2.15-w
orker-niagara/conf/modsecurity2/modsecurity_crs_41_phpids_filters.conf&quot;]
[line &quot;101&quot;] [id &quot;900011&quot;] [msg &quot;Detects specific directory and path
traversal&quot;] [data &quot;/home/&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;]
[tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) cssDecode:
&quot;/en_US/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) jsDecode:
&quot;/en_US/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) htmlEntityDecode:
&quot;/en_US/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) replaceComments:
&quot;/en_US/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) compressWhitespace:
&quot;/en_US/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] T (1) lowercase:
&quot;/en_us/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Transformation completed
in 1969 usec.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Executing operator &quot;rx&quot;
with param
&quot;(?:%c0%ae\\/)|(?:(?:\\/|\\\\)(home|conf|usr|etc|proc|opt|s?bin|local|de
v|tmp|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\\/
|<i>\\\\))|(?:(?:\\/|\\\\)inetpub|localstart\\.asp|boot\\.ini)&quot; against
</I>ARGS:bar.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Target value:
&quot;/en_us/home/default.xml&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
to TX.0: /home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Added regex subexpression
to TX.1: home
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Operator completed in 64
usec.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Ctl: Set auditLogParts to
ABIFHKZEE.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
tx.msg=%{rule.id}-%{rule.msg}
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.id}
to: 900011
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{rule.msg}
to: Detects specific directory and path traversal
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable &quot;tx.msg&quot; to
&quot;900011-Detects specific directory and path traversal&quot;.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
tx.anomaly_score=+%{tx.critical_anomaly_score}
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Original collection
variable: tx.anomaly_score = &quot;31&quot;
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
%{tx.critical_anomaly_score} to: 21
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Relative change:
anomaly_score=31+21
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
&quot;tx.anomaly_score&quot; to &quot;52&quot;.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Setting variable:
tx.%{tx.msg}-WEB_ATTACK/INJECTION-%{matched_var_name}=%{tx.0}
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.msg}
to: 900011-Detects specific directory and path traversal
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro
%{matched_var_name} to: ARGS:bar
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{tx.0} to:
/home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Set variable
&quot;tx.900011-Detects specific directory and path
traversal-WEB_ATTACK/INJECTION-ARGS:bar&quot; to &quot;/home/&quot;.
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
/home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][9] Resolved macro %{TX.0} to:
/home/
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Warning. Pattern match
&quot;(?:%c0%ae\/)|(?:(?:\/|\\)(home|conf|usr|etc|proc|opt|s?bin|local|dev|tm
p|kern|[br]oot|sys|system|windows|winnt|program|%[a-z_-]{3,}%)(?:\/|\\))
|<i>(?:(?:\/|\\)inetpub|localstart\.asp|boot\.ini)&quot; at ARGS:bar. [file
</I>&quot;/sites/www-site/APACHE/httpd-2.2.15-w
orker-niagara/conf/modsecurity2/modsecurity_crs_41_phpids_filters.conf&quot;]
[line &quot;101&quot;] [id &quot;900011&quot;] [msg &quot;Detects specific directory and path
traversal&quot;] [data &quot;/home/&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/DT&quot;]
[tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;]
[05/Aug/2010:12:22:09 --0700]
[example.com/sid#9bbf8][rid#1ab32d8][/foo][4] Transformation completed
in 2 usec.

Thank you,
-Jason Martin
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000426.html">[Owasp-modsecurity-core-rule-set] 900011 double-counting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#425">[ date ]</a>
              <a href="thread.html#425">[ thread ]</a>
              <a href="subject.html#425">[ subject ]</a>
              <a href="author.html#425">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
