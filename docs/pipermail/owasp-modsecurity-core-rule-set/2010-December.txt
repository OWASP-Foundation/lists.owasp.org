From RBarnett at trustwave.com  Wed Dec  1 10:49:38 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 1 Dec 2010 09:49:38 -0600
Subject: [Owasp-modsecurity-core-rule-set] Announcing Release of OWASP
	ModSecurity CRS v2.0.10
Message-ID: <C91BD8C2.182B9%rbarnett@trustwave.com>

Greetings everyone,
I am pleased to announce the release of the OWASP ModSecurity Core Rule Set (CRS) v2.0.10.  This is a minor update.

CHANGE LOG -
--------------------------
Version 2.0.10 - 11/29/2010
--------------------------

Improvements:
- Commented out the Anomaly Scoring Blocking Mode TX variable since, by default, the CRS
  is running in traditional mode.

Bug Fixes:
- Moved all skipAfter actions in chained rules to chain starter SecRules
  https://www.modsecurity.org/tracker/browse/MODSEC-159
- Changed phases on several rules in the 20 protocol anomaly rules file to phase:1 to avoid FNs

--------------------------
DOWNLOADING
--------------------------
Manual Downloading:
You can always download the latest CRS version here -
https://sourceforge.net/projects/mod-security/files/modsecurity-crs/0-CURRENT/

Automated Downloading:
Use the rules-updater.pl script in the CRS /util directory

# Get a list of what the repository contains:
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/ -l

Repository: http://www.modsecurity.org/autoupdate/repository

modsecurity-crs {
          2.0.0: modsecurity-crs_2.0.0.zip
          2.0.1: modsecurity-crs_2.0.1.zip
          2.0.2: modsecurity-crs_2.0.2.zip
          2.0.3: modsecurity-crs_2.0.3.zip
          2.0.4: modsecurity-crs_2.0.4.zip
          2.0.5: modsecurity-crs_2.0.5.zip
          2.0.6: modsecurity-crs_2.0.6.zip
          2.0.7: modsecurity-crs_2.0.7.zip
          2.0.8: modsecurity-crs_2.0.8.zip
          2.0.9: modsecurity-crs_2.0.9.zip
          2.0.9: modsecurity-crs_2.0.10.zip
}

# Get the latest stable version of "modsecurity-crs":
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/ -prules -Smodsecurity-crs
Fetching: modsecurity-crs/modsecurity-crs_2.0.9.zip ...
$ ls -R rules
modsecurity-crs

rules/modsecurity-crs:
modsecurity-crs_2.0.9.zip    modsecurity-crs_2.0.9.zip.sig

--
Ryan Barnett
Senior Security Researcher
Trustwave - SpiderLabs
ModSecurity Community Manager
OWASP ModSecurity CRS Project Leader


From forum at timk.de  Wed Dec  1 13:39:34 2010
From: forum at timk.de (Tim)
Date: Wed, 1 Dec 2010 18:39:34 +0000 (UTC)
Subject: [Owasp-modsecurity-core-rule-set] Allowing z-push
References: <1289661018.3312.81.camel@localhost>
Message-ID: <loom.20101201T192918-48@post.gmane.org>

Arthur Dent <misc.lists at ...> writes:

> 
> METHOD: POST   URI: /Microsoft-Server-ActiveSync 
> 1) Request content type is not allowed by policy 2) Inbound Anomaly Score
(Total Inbound Score: 10, SQLi=,
> XSS=): Request content type is not allowed by policy
> 

This is a false positive. Search the "id=" for this rule at your ruleset and
disable the rule with the following command in your apache config.

SecRuleRemoveById 950004   (950004 ist example ID)


> 
> METHOD: OPTIONS   URI: /Microsoft-Server-ActiveSync 
>  Access denied with code 405 (phase 2). Match of "rx ^(GET|POST|HEAD)$"
against "REQUEST_METHOD" required.
> 

ActiceSync uses also the method "OPTIONS" but normaly this is unwanted at
webserver. So the default ruleset of mod_security only allows "GET", "POST" or
"HEAD" as Request Method.

You can rewrite the rule in the default ruleset - the fast but dirty way -

# Rule to block non-standard methods (See Modsec book p50)
SecRule REQUEST_METHOD "!^(GET|POST|HEAD|OPTIONS)$" "deny,status:405"


Best regards and good luck

Tim


From apache-lists at riggs.me  Fri Dec 10 12:00:58 2010
From: apache-lists at riggs.me (Jim Riggs)
Date: Fri, 10 Dec 2010 11:00:58 -0600
Subject: [Owasp-modsecurity-core-rule-set] Apache config file order
Message-ID: <93F3DEB9-6090-496D-A696-1EA6EFF1E186@riggs.me>

I'm in the process of moving from an old, stale modsec/crs config to the current version.  In doing so, I am trying to understand a couple of things in particular with regards to getting all of the config files loaded in order in Apache.

As we all know, the file structure looks like this:

modsec/
+ modsecurity_crs_10_config.conf.example
+ modsecurity_crs_48_local_exceptions.conf.example
+ base_rules/
| - *.conf *.data
+ optional_rules/
| - *.conf *.data
+ ...

The implication of this structure is that you will create your own local 10 and 48 files and put them in the top-level directory alongside the example files.  BUT, then the docs say that your apache config should be as follows:

Include modsec/*.conf
Include modsec/base_rules/*.conf

So, my local 10 and 48 get loaded first, followed by the base_rules, which I don't believe will work correctly, right?  The 48 needs to be loaded after the rules but before 49, no?  If my logic is correct, what is the best way to fix this?:

- Move 48.example into base_rules and update docs to say that the conf file needs to be created and edited in there?

- Update docs to say that you shouldn't Include base_rules/*.conf but should instead move the conf/data files you want into the top-level dir?  (Not a good idea IMO.)

- Update the Apache config example to load files one at a time or by other fnmatch()-type patterns that will get 48 put in the right place?  (Again, probably not a good idea.)

- ??? (Am I missing something?)


From RBarnett at trustwave.com  Mon Dec 13 12:42:49 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 13 Dec 2010 11:42:49 -0600
Subject: [Owasp-modsecurity-core-rule-set] Live SANS Special Webcast: Scared
 Straight: A Real-World Web App Attack and How to Prevent It
Message-ID: <C92BC549.18932%rbarnett@trustwave.com>

I know this is last minute, but if you are interested, I am co-hosting a live SANS webcast in about 20 minutes -
https://www.sans.org/webcasts/scared-straight-real-world-web-app-attack-prevent-93778

I will present some virtual patching options using ModSecurity.

--
Ryan Barnett
Senior Security Researcher
Trustwave?s SpiderLabs


From RBarnett at trustwave.com  Mon Dec 13 14:51:47 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 13 Dec 2010 13:51:47 -0600
Subject: [Owasp-modsecurity-core-rule-set] Apache config file order
In-Reply-To: <93F3DEB9-6090-496D-A696-1EA6EFF1E186@riggs.me>
Message-ID: <C92BE383.1894E%rbarnett@trustwave.com>

On 12/10/10 12:00 PM, "Jim Riggs" <apache-lists at riggs.me> wrote:

> I'm in the process of moving from an old, stale modsec/crs config to the
> current version.  In doing so, I am trying to understand a couple of things in
> particular with regards to getting all of the config files loaded in order in
> Apache.
> 
> As we all know, the file structure looks like this:
> 
> modsec/
> + modsecurity_crs_10_config.conf.example
> + modsecurity_crs_48_local_exceptions.conf.example
> + base_rules/
> | - *.conf *.data
> + optional_rules/
> | - *.conf *.data
> + ...
> 
> The implication of this structure is that you will create your own local 10
> and 48 files and put them in the top-level directory alongside the example
> files.  BUT, then the docs say that your apache config should be as follows:
> 
> Include modsec/*.conf
> Include modsec/base_rules/*.conf
> 
> So, my local 10 and 48 get loaded first, followed by the base_rules, which I
> don't believe will work correctly, right?  The 48 needs to be loaded after the
> rules but before 49, no?  If my logic is correct, what is the best way to fix
> this?:
> 
> - Move 48.example into base_rules and update docs to say that the conf file
> needs to be created and edited in there?

Hey Jim,
This is the recommended approach.  Previously, we had the file in the
base_rules directory and it was called
modsecurity_crs_48_local_exceptions.conf.  We needed to change this as a CRS
update would overwrite the locally updated file.  I initially moved it up
one level to get it out of the base_rules directory sot that it wouldn't
accidentally be included in an Include wildcard directive.  After looking at
this some more, we still had issues with people wild-carding all *.conf in
the main directory.... So, I went in and renamed it to have an ".example"
extension.  With this new extension, we can now just move it back to the
base_rules directory.

So, to make this long explanation clear :)  We will move the
modsecurity_crs_48_local_exceptions.conf.example file back into the
base_rules directory.  Users should then rename it and drop the ".example"
extension when they want to add local exceptions.  This should make updates
easier as the CRS will only update the ".extension" file and it should be in
the right location to work with the numbering scheme.

Sorry for the confusion :)

-Ryan

> 
> - Update docs to say that you shouldn't Include base_rules/*.conf but should
> instead move the conf/data files you want into the top-level dir?  (Not a good
> idea IMO.)
> 
> - Update the Apache config example to load files one at a time or by other
> fnmatch()-type patterns that will get 48 put in the right place?  (Again,
> probably not a good idea.)
> 
> - ??? (Am I missing something?)
> 
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
> 



From apache-lists at riggs.me  Tue Dec 14 07:57:38 2010
From: apache-lists at riggs.me (Jim Riggs)
Date: Tue, 14 Dec 2010 06:57:38 -0600
Subject: [Owasp-modsecurity-core-rule-set] Apache config file order
In-Reply-To: <C92BE383.1894E%rbarnett@trustwave.com>
References: <C92BE383.1894E%rbarnett@trustwave.com>
Message-ID: <05D1B8A1-5B48-4FA9-B619-2AFF09448B86@riggs.me>

On Dec 13, 2010, at 1:51 PM, Ryan Barnett wrote:

> Hey Jim,
> This is the recommended approach.  Previously, we had the file in the
> base_rules directory and it was called
> modsecurity_crs_48_local_exceptions.conf.  We needed to change this as a CRS
> update would overwrite the locally updated file.  I initially moved it up
> one level to get it out of the base_rules directory sot that it wouldn't
> accidentally be included in an Include wildcard directive.  After looking at
> this some more, we still had issues with people wild-carding all *.conf in
> the main directory.... So, I went in and renamed it to have an ".example"
> extension.  With this new extension, we can now just move it back to the
> base_rules directory.
> 
> So, to make this long explanation clear :)  We will move the
> modsecurity_crs_48_local_exceptions.conf.example file back into the
> base_rules directory.  Users should then rename it and drop the ".example"
> extension when they want to add local exceptions.  This should make updates
> easier as the CRS will only update the ".extension" file and it should be in
> the right location to work with the numbering scheme.
> 
> Sorry for the confusion :)

Cool.  Looking back through archives, change logs, and release notes, that was pretty much what I had surmised.  It's good to have confirmation, though.  Thanks!


From jodelvalle at braishfield.com  Wed Dec 29 10:47:24 2010
From: jodelvalle at braishfield.com (Josue Del Valle)
Date: Wed, 29 Dec 2010 10:47:24 -0500
Subject: [Owasp-modsecurity-core-rule-set] Access denied code 403 (Multiple
	Parameters with the same Name)
Message-ID: <65D9A9F334ED8A48B9E6108528349EC70C34FE36@hercules.braishfield.local>

Hi,

 

Our developer has a form which submits 2 inputs with the same name.
There are 2 check boxes and if he select one checkbox and submit
everything works fine but if he select both checkboxes he gets an access
denied code 403 error.

 

Can anyone explain how to create an exception so this doesn't happen.  I
have attached the error log.

 

Please be as detail as possible because I know little about
mod_security.

 

Thanks in advance for your help.

 

Regards,

 

 

Josue del Valle

 





Coverage cannot be assumed to be bound, altered or canceled without confirmation from an authorized representative of Braishfield Associates, Inc.


DISCLAIMER:

CONFIDENTIALITY NOTICE: Braishfield Associates, Inc. would like you to know that the information contained in this communication, including attachments is privileged and confidential. It is intended only for the exclusive use of the addressee. If the reader of this message is not the intended recipient, or the employee or agent responsible for delivering it to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited. Insurance coverage can not be bound, amended or changed via an e-mail message without knowledge or consent from the insuring carrier. If you have received this communication in error please notify us by telephone immediately at (407) 825-9911 or e-mail disclaimer at braishfield.com. Thank you.

Loss runs are now available online to contracted agents.  Please visit our web portal and utilize this efficient functionality.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20101229/f60ac21c/attachment.html 
-------------- next part --------------
A non-text attachment was scrubbed...
Name: modsecurity.log
Type: application/octet-stream
Size: 7491 bytes
Desc: modsecurity.log
Url : https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20101229/f60ac21c/attachment.obj 

From RBarnett at trustwave.com  Wed Dec 29 10:57:38 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 29 Dec 2010 09:57:38 -0600
Subject: [Owasp-modsecurity-core-rule-set] Access denied code 403
 (Multiple Parameters with the same Name)
In-Reply-To: <65D9A9F334ED8A48B9E6108528349EC70C34FE36@hercules.braishfield.local>
Message-ID: <C940C34D.16B88%rbarnett@trustwave.com>

From:  Josue Del Valle <jodelvalle at braishfield.com>
Date:  Wed, 29 Dec 2010 09:47:24 -0600
To:  "owasp-modsecurity-core-rule-set at lists.owasp.org"
<owasp-modsecurity-core-rule-set at lists.owasp.org>
Cc:  "mod-security-users at lists.sourceforge.net"
<mod-security-users at lists.sourceforge.net>
Subject:  [Owasp-modsecurity-core-rule-set] Access denied code 403
(Multiple Parameters with the same Name)


>Hi,
> 
>Our developer has a form which submits 2 inputs with the same name.
>There are 2 check boxes and if he select one checkbox and submit
>everything works fine but if he select both checkboxes he gets an access
>denied code 403 error.
> 
>Can anyone explain how to create an exception so this doesn?t happen.  I
>have attached the error log.
> 
> Please be as detail as possible because I know little about mod_security.
> 
>Thanks in advance for your help.
> 
>Regards,
> 
> 
>Josue del Valle
> 
>
> 

Josue,
I would suggest that you upgrade your OWASP CRS package.  You are using
v2.0.1 and the current version is 2.0.10.  As to your specific issue, the
old CRS that you are using issued alerts for HTTP Parameter Pollution
(HPP) when there are more than 1 parameters with the same name.  This was
a crude attempt at detection as, as you have shown, there are still
legitimate scenarios where an app may have multiple params with the same
name.  In newer CRS, we have moved the HPP rules to the experimental rules
files (instead of in the 40 generic attacks file as it is with your
version).  Additionally, the newer HPP rules don't alert when multiple
params have the same name, but instead attempts to concat the payloads
into a new TX variable that is then inspected by the other attack rules.

If you can't upgrade CRS at this time, I would suggest that you just
comment out that rule.

Hope this helps,
Ryan 



From jodelvalle at braishfield.com  Wed Dec 29 11:05:11 2010
From: jodelvalle at braishfield.com (Josue Del Valle)
Date: Wed, 29 Dec 2010 11:05:11 -0500
Subject: [Owasp-modsecurity-core-rule-set] Access denied code 403
	(Multiple Parameters with the same Name)
In-Reply-To: <C940C34D.16B88%rbarnett@trustwave.com>
References: <65D9A9F334ED8A48B9E6108528349EC70C34FE36@hercules.braishfield.local>
	<C940C34D.16B88%rbarnett@trustwave.com>
Message-ID: <65D9A9F334ED8A48B9E6108528349EC70C34FE39@hercules.braishfield.local>

Sounds like upgrading is the best option.  

Thanks Ryan.


Josue del Valle


-----Original Message-----
From: Ryan Barnett [mailto:RBarnett at trustwave.com] 
Sent: Wednesday, December 29, 2010 10:58 AM
To: Josue Del Valle; owasp-modsecurity-core-rule-set at lists.owasp.org
Cc: mod-security-users at lists.sourceforge.net
Subject: Re: [Owasp-modsecurity-core-rule-set] Access denied code 403 (Multiple Parameters with the same Name)

From:  Josue Del Valle <jodelvalle at braishfield.com>
Date:  Wed, 29 Dec 2010 09:47:24 -0600
To:  "owasp-modsecurity-core-rule-set at lists.owasp.org"
<owasp-modsecurity-core-rule-set at lists.owasp.org>
Cc:  "mod-security-users at lists.sourceforge.net"
<mod-security-users at lists.sourceforge.net>
Subject:  [Owasp-modsecurity-core-rule-set] Access denied code 403
(Multiple Parameters with the same Name)


>Hi,
> 
>Our developer has a form which submits 2 inputs with the same name.
>There are 2 check boxes and if he select one checkbox and submit
>everything works fine but if he select both checkboxes he gets an access
>denied code 403 error.
> 
>Can anyone explain how to create an exception so this doesn?t happen.  I
>have attached the error log.
> 
> Please be as detail as possible because I know little about mod_security.
> 
>Thanks in advance for your help.
> 
>Regards,
> 
> 
>Josue del Valle
> 
>
> 

Josue,
I would suggest that you upgrade your OWASP CRS package.  You are using
v2.0.1 and the current version is 2.0.10.  As to your specific issue, the
old CRS that you are using issued alerts for HTTP Parameter Pollution
(HPP) when there are more than 1 parameters with the same name.  This was
a crude attempt at detection as, as you have shown, there are still
legitimate scenarios where an app may have multiple params with the same
name.  In newer CRS, we have moved the HPP rules to the experimental rules
files (instead of in the 40 generic attacks file as it is with your
version).  Additionally, the newer HPP rules don't alert when multiple
params have the same name, but instead attempts to concat the payloads
into a new TX variable that is then inspected by the other attack rules.

If you can't upgrade CRS at this time, I would suggest that you just
comment out that rule.

Hope this helps,
Ryan 






Coverage cannot be assumed to be bound, altered or canceled without confirmation from an authorized representative of Braishfield Associates, Inc.


DISCLAIMER:

CONFIDENTIALITY NOTICE: Braishfield Associates, Inc. would like you to know that the information contained in this communication, including attachments is privileged and confidential. It is intended only for the exclusive use of the addressee. If the reader of this message is not the intended recipient, or the employee or agent responsible for delivering it to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited. Insurance coverage can not be bound, amended or changed via an e-mail message without knowledge or consent from the insuring carrier. If you have received this communication in error please notify us by telephone immediately at (407) 825-9911 or e-mail disclaimer at braishfield.com. Thank you.

Loss runs are now available online to contracted agents.  Please visit our web portal and utilize this efficient functionality.


From RBarnett at trustwave.com  Wed Dec 29 14:58:15 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 29 Dec 2010 13:58:15 -0600
Subject: [Owasp-modsecurity-core-rule-set] Seasons Greetings! Announcing
 Release of OWASP ModSecurity CRS v2.1.0
Message-ID: <C940FD07.16C37%rbarnett@trustwave.com>

Greetings everyone,
I am pleased to announce the release of the OWASP ModSecurity Core Rule Set (CRS) v2.1.0.  This is a significant update as we have added many new capabilities.

CHANGE LOG -
--------------------------
Version 2.1.0 - 12/29/2010
--------------------------

Improvements:
- Added Experimental Lua Converter script to normalize payloads. Based on
  PHPIDS Converter code and it used with the advanced filters conf file.
- Changed the name of PHPIDS converted rules to Advanced Filters
- Added Ignore Static Content (Performance enhancement) rule set
- Added XML Enabler (Web Services) rule set which will parse XML data
- Added Authorized Vulnerability Scanning (AVS) Whitelist rule set
- Added Denial of Service (DoS) Protection rule set
- Added Slow HTTP DoS (Connection Consumption) Protection rule set
- Added Brute Force Attack Protection rule set
- Added Session Hijacking Detection rule set
- Added Username Tracking rule set
- Added Authentication Tracking rule set
- Added Anti-Virus Scanning of File Attachments rule set
- Added AV Scanning program to /util directory
- Added Credit Card Usage Tracking/Leakage Prevention rule set
- Added experimental CC Track/PAN Leakage Prevention rule set
- Added an experimental_rules directory to hold new BETA rules
- Moved the local exceptions conf file back into base_rules dirctory however
  it has a ".example" extension to prevent overwriting customized versions
  when upgrading
- Separated out HTTP Parameter Pollution and Restricted Character Anomaly Detection rules to
  the experimental_rules directory
- Adding the REQUEST_HEADERS:User-Agent macro data to the initcol in 10 config file, which will
  help to make collections a bit more unique


--------------------------
DOWNLOADING
--------------------------
Manual Downloading:
You can always download the latest CRS version here -
https://sourceforge.net/projects/mod-security/files/modsecurity-crs/0-CURRENT/

Automated Downloading:
Use the rules-updater.pl script in the CRS /util directory

# Get a list of what the repository contains:
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/ -l

Repository: http://www.modsecurity.org/autoupdate/repository

modsecurity-crs {
          2.0.0: modsecurity-crs_2.0.0.zip
          2.0.1: modsecurity-crs_2.0.1.zip
          2.0.2: modsecurity-crs_2.0.2.zip
          2.0.3: modsecurity-crs_2.0.3.zip
          2.0.4: modsecurity-crs_2.0.4.zip
          2.0.5: modsecurity-crs_2.0.5.zip
          2.0.6: modsecurity-crs_2.0.6.zip
          2.0.7: modsecurity-crs_2.0.7.zip
          2.0.8: modsecurity-crs_2.0.8.zip
          2.0.9: modsecurity-crs_2.0.9.zip
          2.0.9: modsecurity-crs_2.0.10.zip
          2.1.0: modsecurity-crs_2.1.0.zip
}

# Get the latest stable version of "modsecurity-crs":
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/ -prules -Smodsecurity-crs
Fetching: modsecurity-crs/modsecurity-crs_2.1.0.zip ...
$ ls -R rules
modsecurity-crs

rules/modsecurity-crs:
modsecurity-crs_2.1.0.zip    modsecurity-crs_2.1.0.zip.sig

--
Ryan Barnett
Senior Security Researcher
Trustwave - SpiderLabs
ModSecurity Community Manager
OWASP ModSecurity CRS Project Leader


From RBarnett at trustwave.com  Wed Dec 29 16:08:33 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 29 Dec 2010 15:08:33 -0600
Subject: [Owasp-modsecurity-core-rule-set] Seasons Greetings! Announcing
 Release of OWASP ModSecurity CRS v2.1.0
In-Reply-To: <C940FD07.16C37%rbarnett@trustwave.com>
Message-ID: <C9410D11.16CA2%rbarnett@trustwave.com>

FYI ? I just fixed a typo in the optional_rules/modsecurity_crs_16_session_hijacking.conf file.  I updated the archives.  Please re-download.

Cheers,
Ryan



From: Ryan Barnett <RBarnett at trustwave.com<mailto:RBarnett at trustwave.com>>
Date: Wed, 29 Dec 2010 13:58:15 -0600
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>, "mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>" <mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>>
Subject: Seasons Greetings! Announcing Release of OWASP ModSecurity CRS v2.1.0

Greetings everyone,
I am pleased to announce the release of the OWASP ModSecurity Core Rule Set (CRS) v2.1.0.  This is a significant update as we have added many new capabilities.

CHANGE LOG -
--------------------------
Version 2.1.0 - 12/29/2010
--------------------------

Improvements:
- Added Experimental Lua Converter script to normalize payloads. Based on
  PHPIDS Converter code and it used with the advanced filters conf file.
- Changed the name of PHPIDS converted rules to Advanced Filters
- Added Ignore Static Content (Performance enhancement) rule set
- Added XML Enabler (Web Services) rule set which will parse XML data
- Added Authorized Vulnerability Scanning (AVS) Whitelist rule set
- Added Denial of Service (DoS) Protection rule set
- Added Slow HTTP DoS (Connection Consumption) Protection rule set
- Added Brute Force Attack Protection rule set
- Added Session Hijacking Detection rule set
- Added Username Tracking rule set
- Added Authentication Tracking rule set
- Added Anti-Virus Scanning of File Attachments rule set
- Added AV Scanning program to /util directory
- Added Credit Card Usage Tracking/Leakage Prevention rule set
- Added experimental CC Track/PAN Leakage Prevention rule set
- Added an experimental_rules directory to hold new BETA rules
- Moved the local exceptions conf file back into base_rules dirctory however
  it has a ".example" extension to prevent overwriting customized versions
  when upgrading
- Separated out HTTP Parameter Pollution and Restricted Character Anomaly Detection rules to
  the experimental_rules directory
- Adding the REQUEST_HEADERS:User-Agent macro data to the initcol in 10 config file, which will
  help to make collections a bit more unique


--------------------------
DOWNLOADING
--------------------------
Manual Downloading:
You can always download the latest CRS version here -
https://sourceforge.net/projects/mod-security/files/modsecurity-crs/0-CURRENT/

Automated Downloading:
Use the rules-updater.pl script in the CRS /util directory

# Get a list of what the repository contains:
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/ -l

Repository: http://www.modsecurity.org/autoupdate/repository

modsecurity-crs {
          2.0.0: modsecurity-crs_2.0.0.zip
          2.0.1: modsecurity-crs_2.0.1.zip
          2.0.2: modsecurity-crs_2.0.2.zip
          2.0.3: modsecurity-crs_2.0.3.zip
          2.0.4: modsecurity-crs_2.0.4.zip
          2.0.5: modsecurity-crs_2.0.5.zip
          2.0.6: modsecurity-crs_2.0.6.zip
          2.0.7: modsecurity-crs_2.0.7.zip
          2.0.8: modsecurity-crs_2.0.8.zip
          2.0.9: modsecurity-crs_2.0.9.zip
          2.0.9: modsecurity-crs_2.0.10.zip
          2.1.0: modsecurity-crs_2.1.0.zip
}

# Get the latest stable version of "modsecurity-crs":
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/ -prules -Smodsecurity-crs
Fetching: modsecurity-crs/modsecurity-crs_2.1.0.zip ...
$ ls -R rules
modsecurity-crs

rules/modsecurity-crs:
modsecurity-crs_2.1.0.zip    modsecurity-crs_2.1.0.zip.sig

--
Ryan Barnett
Senior Security Researcher
Trustwave - SpiderLabs
ModSecurity Community Manager
OWASP ModSecurity CRS Project Leader


From dyioulos at firstbhph.com  Wed Dec 29 18:17:23 2010
From: dyioulos at firstbhph.com (Dimitri Yioulos)
Date: Wed, 29 Dec 2010 18:17:23 -0500
Subject: [Owasp-modsecurity-core-rule-set] Custom ruleset not working
Message-ID: <201012291817.24596.dyioulos@firstbhph.com>

Since I upgraded my ruleset to the latest and 
greatest, my custom ruleset 
(modsecurity_crs_15_customconfig.conf) to 
whitelist my internal hosts insn't working.  Here 
are the rules:

SecRule REMOTE_ADDR "127\.0\.0\.1" "allow, nolog"
SecRule REMOTE_ADDR "^192\.168\.100\." 
phase:1,nolog,allow,ctl:ruleEngine=Off,ctl:auditEngine=Off
SecRule REMOTE_ADDR "^192\.168\.1\." 
phase:1,nolog,allow,ctl:ruleEngine=Off,ctl:auditEngine=Off
SecRule REMOTE_ADDR "^192\.168\.101\." 
phase:1,nolog,allow,ctl:ruleEngine=Off,ctl:auditEngine=Off

One of my internal host running nagios is 
now triggering a rule (Access denied with code 403 
(phase 1). Pattern match "^(.*)$" at 
REQUEST_HEADERS:User-Agent). ?What do I need to 
do to fix this?

Thanks.

Dimitri

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.


From RBarnett at trustwave.com  Wed Dec 29 18:27:56 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 29 Dec 2010 17:27:56 -0600
Subject: [Owasp-modsecurity-core-rule-set] Custom ruleset not working
In-Reply-To: <201012291817.24596.dyioulos@firstbhph.com>
Message-ID: <C9412C48.16CCF%rbarnett@trustwave.com>


On 12/29/10 6:17 PM, "Dimitri Yioulos" <dyioulos at firstbhph.com> wrote:

>Since I upgraded my ruleset to the latest and
>greatest, my custom ruleset
>(modsecurity_crs_15_customconfig.conf) to
>whitelist my internal hosts insn't working.  Here
>are the rules:
>
>SecRule REMOTE_ADDR "127\.0\.0\.1" "allow, nolog"
>SecRule REMOTE_ADDR "^192\.168\.100\."
>phase:1,nolog,allow,ctl:ruleEngine=Off,ctl:auditEngine=Off
>SecRule REMOTE_ADDR "^192\.168\.1\."
>phase:1,nolog,allow,ctl:ruleEngine=Off,ctl:auditEngine=Off
>SecRule REMOTE_ADDR "^192\.168\.101\."
>phase:1,nolog,allow,ctl:ruleEngine=Off,ctl:auditEngine=Off
>
>One of my internal host running nagios is
>now triggering a rule (Access denied with code 403
>(phase 1). Pattern match "^(.*)$" at
>REQUEST_HEADERS:User-Agent).  What do I need to
>do to fix this?

Dimitri,
What specific CRS rule ID is triggering?  Can you send an audit or error
log example?

-Ryan



From dreamice.jiang at gmail.com  Wed Dec 29 20:50:08 2010
From: dreamice.jiang at gmail.com (dreamice)
Date: Thu, 30 Dec 2010 09:50:08 +0800
Subject: [Owasp-modsecurity-core-rule-set] [BUG Report] Restricted
	extensions rule bug
Message-ID: <AANLkTimBpCy94gEQEhxw+tu4=3p1WFRoRu1oHEeN9oC5@mail.gmail.com>

Dear Ryan,
I just find a bug of the Restricted extensions rule.

The original rule are:
setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/ .backup/ .bak/
.bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/
.dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/ .key/
.licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/
.resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/ .xsd/
.xsx/', \

SecRule REQUEST_BASENAME "\.(.*)$" "chain,capture,setvar:tx.extension
=?.%{tx.1}/?,phase:2,t:none,t:urlDecodeUni,t:lowercase,deny,log,auditlog,msg:'URL
file extension is restricted by policy',
severity:'2',id:'960035',tag:'POLICY/EXT_RESTRICTED',tag:'WASCTC/WASC-15',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',logdata:'%{TX.0}'"
        SecRule TX:EXTENSION "@within %{tx.restricted_extensions}"
"t:none,setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{
rule.id}-POLICY/EXT_RESTRICTED-%{matched_var_name}=%{matched_var}"
I test and debug it but this rule does not work right. So I saw that the
rule set tx.extension with two more single quote(''), but the setvar does
not set the two single quote.
For example, if you request the base name test.log, the rule sets the
tx.extension with '.log/', but the restrcted_extensions is .log, They are
not equal and the rule can not be matched.

Wish you do a test and update the rules. Thanks a lot.

Best regards,

dreamice
2010-12-30
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20101230/a8ae076f/attachment.html 

From dreamice.jiang at gmail.com  Wed Dec 29 20:52:36 2010
From: dreamice.jiang at gmail.com (dreamice)
Date: Thu, 30 Dec 2010 09:52:36 +0800
Subject: [Owasp-modsecurity-core-rule-set] [BUG Report] Restricted
	extensions rule bug
In-Reply-To: <AANLkTimBpCy94gEQEhxw+tu4=3p1WFRoRu1oHEeN9oC5@mail.gmail.com>
References: <AANLkTimBpCy94gEQEhxw+tu4=3p1WFRoRu1oHEeN9oC5@mail.gmail.com>
Message-ID: <AANLkTik=Y-3hnrOfVQGn4MeAqmyJkq6xoT7niMeTdqst@mail.gmail.com>

I just change the rule to:
SecRule REQUEST_BASENAME "\.(.*)$" "chain,capture,setvar:tx.extension
=.%{tx.1}/,phase:2,t:none,t:urlDecodeUni,t:lowercase,deny,log,auditlog,msg:'URL
file extension is restricted by policy',
severity:'2',id:'960035',tag:'POLICY/EXT_RESTRICTED',tag:'WASCTC/WASC-15',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',logdata:'%{TX.0}'"
        SecRule TX:EXTENSION "@within %{tx.restricted_extensions}"
"t:none,setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{
rule.id}-POLICY/EXT_RESTRICTED-%{matched_var_name}=%{matched_var}"

Then it works well.

2010/12/30 dreamice <dreamice.jiang at gmail.com>

> Dear Ryan,
> I just find a bug of the Restricted extensions rule.
>
> The original rule are:
> setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/ .backup/ .bak/
> .bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/
> .dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/ .key/
> .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/
> .resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/ .xsd/
> .xsx/', \
>
> SecRule REQUEST_BASENAME "\.(.*)$" "chain,capture,setvar:tx.extension
> =?.%{tx.1}/?,phase:2,t:none,t:urlDecodeUni,t:lowercase,deny,log,auditlog,msg:'URL
> file extension is restricted by policy',
> severity:'2',id:'960035',tag:'POLICY/EXT_RESTRICTED',tag:'WASCTC/WASC-15',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',logdata:'%{TX.0}'"
>         SecRule TX:EXTENSION "@within %{tx.restricted_extensions}"
> "t:none,setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{
> rule.id}-POLICY/EXT_RESTRICTED-%{matched_var_name}=%{matched_var}"
> I test and debug it but this rule does not work right. So I saw that the
> rule set tx.extension with two more single quote(''), but the setvar does
> not set the two single quote.
> For example, if you request the base name test.log, the rule sets the
> tx.extension with '.log/', but the restrcted_extensions is .log, They are
> not equal and the rule can not be matched.
>
> Wish you do a test and update the rules. Thanks a lot.
>
> Best regards,
>
> dreamice
> 2010-12-30
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20101230/82f22efc/attachment.html 

From RBarnett at trustwave.com  Thu Dec 30 08:58:21 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Thu, 30 Dec 2010 07:58:21 -0600
Subject: [Owasp-modsecurity-core-rule-set] [BUG Report] Restricted
	extensions rule bug
In-Reply-To: <AANLkTimBpCy94gEQEhxw+tu4=3p1WFRoRu1oHEeN9oC5@mail.gmail.com>
Message-ID: <C941F961.16D22%rbarnett@trustwave.com>


From:  dreamice <dreamice.jiang at gmail.com>
Date:  Wed, 29 Dec 2010 19:50:08 -0600
To:  "owasp-modsecurity-core-rule-set at lists.owasp.org"
<owasp-modsecurity-core-rule-set at lists.owasp.org>, Ryan Barnett
<RBarnett at trustwave.com>
Subject:  [BUG Report] Restricted extensions rule bug


>Dear Ryan,
>I just find a bug of the Restricted extensions rule.
> 
>The original rule are:
>setvar:'tx.restricted_extensions=.asa/ .asax/ .ascx/ .axd/ .backup/ .bak/
>.bat/ .cdx/ .cer/ .cfg/ .cmd/ .com/ .config/ .conf/ .cs/ .csproj/ .csr/
>.dat/ .db/ .dbf/ .dll/ .dos/ .htr/ .htw/ .ida/ .idc/ .idq/ .inc/ .ini/
>.key/ .licx/ .lnk/ .log/ .mdb/ .old/ .pass/ .pdb/ .pol/ .printer/ .pwd/
>.resources/ .resx/ .sql/ .sys/ .vb/ .vbs/ .vbproj/ .vsdisco/ .webinfo/
>.xsd/ .xsx/', \
> 
>SecRule REQUEST_BASENAME "\.(.*)$"
>"chain,capture,setvar:tx.extension=?.%{tx.1}/?,phase:2,t:none,t:urlDecodeU
>ni,t:lowercase,deny,log,auditlog,msg:'URL file extension is restricted by
>policy', 
>severity:'2',id:'960035',tag:'POLICY/EXT_RESTRICTED',tag:'WASCTC/WASC-15',
>tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',logdata:'%{TX.0}'"
>        SecRule TX:EXTENSION "@within %{tx.restricted_extensions}"
>"t:none,setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.warning_
>anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:
>tx.%{rule.id 
><http://rule.id>}-POLICY/EXT_RESTRICTED-%{matched_var_name}=%{matched_var}
>"
>
>I test and debug it but this rule does not work right. So I saw that the
>rule set tx.extension with two more single quote(''), but the setvar does
>not set the two single quote.
>For example, if you request the base name test.log, the rule sets the
>tx.extension with '.log/', but the restrcted_extensions is .log, They are
>not equal and the rule can not be matched.
> 
>Wish you do a test and update the rules. Thanks a lot.

Nice catch and thanks for notifying me.  Those single quotes are placed
incorrectly.  As an FYI to those rule writers on the list, if you need to
do a setvar and you want to include spaces, you can use the single quotes
like this -

...pass,nolog,setvar:'name_of_variable=foo bar baz',msg:'....

I have updated the CRS code and will be updating SVN and releasing a bug
fix CRS version today.

Thanks again,
Ryan



From rcbarnett at gmail.com  Thu Dec 30 13:14:31 2010
From: rcbarnett at gmail.com (Ryan Barnett)
Date: Thu, 30 Dec 2010 13:14:31 -0500
Subject: [Owasp-modsecurity-core-rule-set] OWASP ModSecurity CRS v2.1.1
	Released
Message-ID: <C9423637.16D70%rcbarnett@gmail.com>

Thanks to those how did some testing and provided feedback.  I have made a
bug fix release v2.1.1 -

--------------------------
Version 2.1.1 - 12/30/2010
--------------------------

Bug Fixes:
- Updated the 10 config conf file to add in pass action to User-Agent rule
- Updated the CSRF ruleset to conditionally do content injection - if the
csrf token was created by the session hijacking conf file
- Updated the session hijacking conf file to only enforce rules if a
SessionID Cookie was submitted
- Fixed macro expansion setvar bug in the restricted file extension rule
- Moved the comment spam data file into the optional_rules directory

https://sourceforge.net/projects/mod-security/files/modsecurity-crs/0-CURREN
T/


-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20101230/34e307e9/attachment.html 

From dyioulos at firstbhph.com  Thu Dec 30 14:43:59 2010
From: dyioulos at firstbhph.com (Dimitri Yioulos)
Date: Thu, 30 Dec 2010 14:43:59 -0500
Subject: [Owasp-modsecurity-core-rule-set] What does this mean
Message-ID: <201012301444.00318.dyioulos@firstbhph.com>

All,

With the installation of the latest rulesit, I'm 
now getting the following alerts:

Warning - Sticky SessionID Data Changed - 
User-Agent Mismatch.    Access denied with code 
403 (phase 2). Match of "streq %{SESSION.UA}" 
against "TX:ua_hash" required.

Hope I'm not being too stupid here, but what does 
that mean?  Am I blocking legitimate traffic?

Better still, is there a place (documents, etc.) 
that describes various alerts?

Thanks.

Dimitri

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.


From RBarnett at trustwave.com  Thu Dec 30 14:52:29 2010
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Thu, 30 Dec 2010 13:52:29 -0600
Subject: [Owasp-modsecurity-core-rule-set] What does this mean
In-Reply-To: <201012301444.00318.dyioulos@firstbhph.com>
Message-ID: <C9424BAF.16D89%rbarnett@trustwave.com>


On 12/30/10 2:43 PM, "Dimitri Yioulos" <dyioulos at firstbhph.com> wrote:

>All,
>
>With the installation of the latest rulesit, I'm
>now getting the following alerts:
>
>Warning - Sticky SessionID Data Changed -
>User-Agent Mismatch.    Access denied with code
>403 (phase 2). Match of "streq %{SESSION.UA}"
>against "TX:ua_hash" required.
>
>Hope I'm not being too stupid here, but what does
>that mean?  Am I blocking legitimate traffic?
>
>Better still, is there a place (documents, etc.)
>that describes various alerts?

This ruleset will track the IP Address Block Range and User-Agent string
hash for each user and tie it to a SessionID.  If those values change
during the course of a session, it will trigger.  The goal is to identify
possible session hijacking attacks.

Dimitri - please download the latest release (CRS v2.1.1) that I just
released today.  I made a change to the Session Hijacking conf file -
CHANGES file -

- Updated the session hijacking conf file to only enforce rules if a
SessionID Cookie was submitted


http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/optio
nal_rules/modsecurity_crs_16_session_hijacking.conf?revision=1576

I added this line which will skip the check if the client doesn't submit a
SessionID Cookie -

SecRule 
&REQUEST_COOKIES:'/(j?sessionid|(php)?sessid|(asp|jserv|jw)?session[-_]?(id
)?|cf(id|token)|sid)/' "@eq 0"
"phase:1,t:none,nolog,pass,skipAfter:END_SESSION_STARTUP"

Hope this helps,
Ryan



From dyioulos at firstbhph.com  Thu Dec 30 15:39:01 2010
From: dyioulos at firstbhph.com (Dimitri Yioulos)
Date: Thu, 30 Dec 2010 15:39:01 -0500
Subject: [Owasp-modsecurity-core-rule-set] What does this mean
In-Reply-To: <C9424BAF.16D89%rbarnett@trustwave.com>
References: <C9424BAF.16D89%rbarnett@trustwave.com>
Message-ID: <201012301539.02370.dyioulos@firstbhph.com>

On Thursday 30 December 2010 2:52:29 pm Ryan 
Barnett wrote:
> On 12/30/10 2:43 PM, "Dimitri Yioulos" 
<dyioulos at firstbhph.com> wrote:
> >All,
> >
> >With the installation of the latest rulesit,
> > I'm now getting the following alerts:
> >
> >Warning - Sticky SessionID Data Changed -
> >User-Agent Mismatch.    Access denied with
> > code 403 (phase 2). Match of "streq
> > %{SESSION.UA}" against "TX:ua_hash" required.
> >
> >Hope I'm not being too stupid here, but what
> > does that mean?  Am I blocking legitimate
> > traffic?
> >
> >Better still, is there a place (documents,
> > etc.) that describes various alerts?
>
> This ruleset will track the IP Address Block
> Range and User-Agent string hash for each user
> and tie it to a SessionID.  If those values
> change during the course of a session, it will
> trigger.  The goal is to identify possible
> session hijacking attacks.
>
> Dimitri - please download the latest release
> (CRS v2.1.1) that I just released today.  I
> made a change to the Session Hijacking conf
> file - CHANGES file -
>
> - Updated the session hijacking conf file to
> only enforce rules if a SessionID Cookie was
> submitted
>
>
> http://mod-security.svn.sourceforge.net/viewvc/
>mod-security/crs/trunk/optio
> nal_rules/modsecurity_crs_16_session_hijacking.
>conf?revision=1576
>
> I added this line which will skip the check if
> the client doesn't submit a SessionID Cookie -
>
> SecRule
> &REQUEST_COOKIES:'/(j?sessionid|(php)?sessid|(a
>sp|jserv|jw)?session[-_]?(id
> )?|cf(id|token)|sid)/' "@eq 0"
> "phase:1,t:none,nolog,pass,skipAfter:END_SESSIO
>N_STARTUP"
>
> Hope this helps,
> Ryan


Ryan,

Thanks very much for your help.

I did install the changed session_hijacking.conf 
file, along with any other updated files (but not 
the entire ruleset).

Just to be on the safe side, I had someone test 
reaching our Web site from outside, and she 
landed on the Apache test page.  Yikes!  So, I 
disabled session_hijacking.conf, and she was then 
able to get to our site.  Is it an issue with 
session_hijacking.conf or with our site?

Regards,

Dimitri

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.


From mlavi at sgi.com  Thu Dec 30 17:15:03 2010
From: mlavi at sgi.com (Mark Lavi)
Date: Thu, 30 Dec 2010 16:15:03 -0600
Subject: [Owasp-modsecurity-core-rule-set] Seasons Greetings! Announcing
	Release of OWASP ModSecurity CRS v2.1.0
In-Reply-To: <C9410D11.16CA2%rbarnett@trustwave.com>
References: <C940FD07.16C37%rbarnett@trustwave.com>
	<C9410D11.16CA2%rbarnett@trustwave.com>
Message-ID: <074F0C4BE8F9FB4CB1410BF8D1E10B540116E0F1@CF--AMER002E--3.americas.sgi.com>

FYI: I see CRS 2.1.1 is now available and it is less than six hours old.
Here is the relevant portion of the change log:

--------------------------
OWASP ModSecurity Core Rule Set (CRS) JIRA CHANGELOG
--------------------------
https://www.modsecurity.org/tracker/browse/CORERULES

--------------------------
Version 2.1.1 - 12/30/2010
--------------------------

Bug Fixes:
- Updated the 10 config conf file to add in pass action to User-Agent
rule
- Updated the CSRF ruleset to conditionally do content injection - if
the
  csrf token was created by the session hijacking conf file
- Updated the session hijacking conf file to only enforce rules if a
SessionID
  Cookie was submitted
- Fixed macro expansion setvar bug in the restricted file extension rule
- Moved the comment spam data file into the optional_rules directory


Mark Lavi
Senior Web Producer

sgi

46600 Landing Parkway
Fremont, CA 94538
(510) 933-5234 direct
mlavi at sgi.com 
www.sgi.com


-----Original Message-----
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
[mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On
Behalf Of Ryan Barnett
Sent: Wednesday, December 29, 2010 1:09 PM
To: owasp-modsecurity-core-rule-set at lists.owasp.org;
mod-security-users at lists.sourceforge.net
Subject: Re: [Owasp-modsecurity-core-rule-set] Seasons Greetings!
Announcing Release of OWASP ModSecurity CRS v2.1.0

FYI - I just fixed a typo in the
optional_rules/modsecurity_crs_16_session_hijacking.conf file.  I
updated the archives.  Please re-download.

Cheers,
Ryan



From: Ryan Barnett
<RBarnett at trustwave.com<mailto:RBarnett at trustwave.com>>
Date: Wed, 29 Dec 2010 13:58:15 -0600
To:
"owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurit
y-core-rule-set at lists.owasp.org>"
<owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurit
y-core-rule-set at lists.owasp.org>>,
"mod-security-users at lists.sourceforge.net<mailto:mod-security-users at list
s.sourceforge.net>"
<mod-security-users at lists.sourceforge.net<mailto:mod-security-users at list
s.sourceforge.net>>
Subject: Seasons Greetings! Announcing Release of OWASP ModSecurity CRS
v2.1.0

Greetings everyone,
I am pleased to announce the release of the OWASP ModSecurity Core Rule
Set (CRS) v2.1.0.  This is a significant update as we have added many
new capabilities.

CHANGE LOG -
--------------------------
Version 2.1.0 - 12/29/2010
--------------------------

Improvements:
- Added Experimental Lua Converter script to normalize payloads. Based
on
  PHPIDS Converter code and it used with the advanced filters conf file.
- Changed the name of PHPIDS converted rules to Advanced Filters
- Added Ignore Static Content (Performance enhancement) rule set
- Added XML Enabler (Web Services) rule set which will parse XML data
- Added Authorized Vulnerability Scanning (AVS) Whitelist rule set
- Added Denial of Service (DoS) Protection rule set
- Added Slow HTTP DoS (Connection Consumption) Protection rule set
- Added Brute Force Attack Protection rule set
- Added Session Hijacking Detection rule set
- Added Username Tracking rule set
- Added Authentication Tracking rule set
- Added Anti-Virus Scanning of File Attachments rule set
- Added AV Scanning program to /util directory
- Added Credit Card Usage Tracking/Leakage Prevention rule set
- Added experimental CC Track/PAN Leakage Prevention rule set
- Added an experimental_rules directory to hold new BETA rules
- Moved the local exceptions conf file back into base_rules dirctory
however
  it has a ".example" extension to prevent overwriting customized
versions
  when upgrading
- Separated out HTTP Parameter Pollution and Restricted Character
Anomaly Detection rules to
  the experimental_rules directory
- Adding the REQUEST_HEADERS:User-Agent macro data to the initcol in 10
config file, which will
  help to make collections a bit more unique


--------------------------
DOWNLOADING
--------------------------
Manual Downloading:
You can always download the latest CRS version here -
https://sourceforge.net/projects/mod-security/files/modsecurity-crs/0-CU
RRENT/

Automated Downloading:
Use the rules-updater.pl script in the CRS /util directory

# Get a list of what the repository contains:
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/
-l

Repository: http://www.modsecurity.org/autoupdate/repository

modsecurity-crs {
          2.0.0: modsecurity-crs_2.0.0.zip
          2.0.1: modsecurity-crs_2.0.1.zip
          2.0.2: modsecurity-crs_2.0.2.zip
          2.0.3: modsecurity-crs_2.0.3.zip
          2.0.4: modsecurity-crs_2.0.4.zip
          2.0.5: modsecurity-crs_2.0.5.zip
          2.0.6: modsecurity-crs_2.0.6.zip
          2.0.7: modsecurity-crs_2.0.7.zip
          2.0.8: modsecurity-crs_2.0.8.zip
          2.0.9: modsecurity-crs_2.0.9.zip
          2.0.9: modsecurity-crs_2.0.10.zip
          2.1.0: modsecurity-crs_2.1.0.zip }

# Get the latest stable version of "modsecurity-crs":
$ ./rules-updater.pl -rhttp://www.modsecurity.org/autoupdate/repository/
-prules -Smodsecurity-crs
Fetching: modsecurity-crs/modsecurity-crs_2.1.0.zip ...
$ ls -R rules
modsecurity-crs

rules/modsecurity-crs:
modsecurity-crs_2.1.0.zip    modsecurity-crs_2.1.0.zip.sig

--
Ryan Barnett
Senior Security Researcher
Trustwave - SpiderLabs
ModSecurity Community Manager
OWASP ModSecurity CRS Project Leader

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

From jamuse at gmail.com  Fri Dec 31 04:21:52 2010
From: jamuse at gmail.com (Jamuse)
Date: Fri, 31 Dec 2010 11:21:52 +0200
Subject: [Owasp-modsecurity-core-rule-set] What does this mean
In-Reply-To: <201012301539.02370.dyioulos@firstbhph.com>
References: <C9424BAF.16D89%rbarnett@trustwave.com>
	<201012301539.02370.dyioulos@firstbhph.com>
Message-ID: <AANLkTi=du7V4ocm=rK+ZPEVCV9druSVt2EX=dYBsqHRZ@mail.gmail.com>

On Thu, Dec 30, 2010 at 10:39 PM, Dimitri Yioulos
<dyioulos at firstbhph.com> wrote:

> Ryan,
>
> Thanks very much for your help.
>
> I did install the changed session_hijacking.conf
> file, along with any other updated files (but not
> the entire ruleset).
>
> Just to be on the safe side, I had someone test
> reaching our Web site from outside, and she
> landed on the Apache test page. ?Yikes! ?So, I
> disabled session_hijacking.conf, and she was then
> able to get to our site. ?Is it an issue with
> session_hijacking.conf or with our site?

Hi Dimitri,

Take a look at the modsecurity audit and/or debug logs to know whether
it is ModSec which is stopping the traffic or not. As an aside, what
is the SecDefaultAction set to?

--
 - Josh

