From ilyassikai at gmail.com  Wed Sep  9 16:24:49 2015
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Wed, 9 Sep 2015 17:24:49 +0100
Subject: [Owasp-modsecurity-core-rule-set] Modsecurity block JSON
Message-ID: <CAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9++A@mail.gmail.com>

Hi,

I have this request :
POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig

with this parameters :
left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :  0,
collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, { mod
: 'mod-recherche', hidden :  0, collapsed : 0 }

When I execute this request modsecurity block my request.


Log :


--1354a526-A--

[09/Sep/2015:17:48:39 +0200] VfBU138AAAEAAFm8PlQAAAAk
?XXX.XXX.XXX
 53935
?XXX.XXX.XXX
 80

--1354a526-B--

POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig HTTP/1.1

Host: www.
?abc
.
?com?

User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:40.0)
Gecko/20100101 Firefox/40.0

Accept: */*

Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3

Accept-Encoding: gzip, deflate

Content-Type: application/x-www-form-urlencoded; charset=UTF-8

X-Requested-With: XMLHttpRequest

Referer: http://www.
?abc
.
?com
/beta/servlet/EspaceClientServlet?plateform=new

Content-Length: 413

Cookie: JSESSIONID=6B370AFFEA03BE2B80F916C5755EEEC5;
__utma=37027576.1259853019.1435675370.1441795926.1441813263.22;
__utmz=37027576.1435675370.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);
style=null; JSESSIONID=DACE18AC3CBA86CAF59264F47E99B028; __utmc=37027576;
__utmb=37027576.3.10.1441813263

Connection: keep-alive

Pragma: no-cache

Cache-Control: no-cache


--1354a526-C--

left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, {
mod : 'mod-recherche', hidden :  0, collapsed : 0 }

--1354a526-F--

HTTP/1.1 403 Forbidden

Content-Length: 296

Connection: close

Content-Type: text/html; charset=iso-8859-1


--1354a526-E--


--1354a526-H--

Message: Access denied with code 403 (phase 2). Pattern match
"([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
at ARGS:left. [file
"/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
[line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
Detection Alert - Total # of special characters exceeded"] [data "Matched
Data: - found within ARGS:left: { mod : 'mod-historique', hidden : 0,
collapsed : 0 }, { mod : 'mod-cercle-inforisk', hidden : 0, collapsed : 0
}, { mod : 'mod-graph', hidden : 0, collapsed : 0 }"] [ver
"OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
"OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]

Action: Intercepted (phase 2)

Apache-Handler: proxy-server

Stopwatch: 1441813719351394 3237 (- - -)

Stopwatch2: 1441813719351394 3237; combined=2824, p1=202, p2=2592, p3=0,
p4=0, p5=30, sr=26, sw=0, l=0, gc=0

Response-Body-Transformed: Dechunked

Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
OWASP_CRS/2.2.9.

Server: Apache/2.2.15 (CentOS) DAV/2

Engine-Mode: "ENABLED"


--1354a526-Z--






Who can I allow like this request safety
? ??

Thank's  ?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150909/b9eb56e4/attachment.html>

From adrianbn at gmail.com  Thu Sep 10 09:01:24 2015
From: adrianbn at gmail.com (=?UTF-8?Q?Adri=C3=A1n?=)
Date: Thu, 10 Sep 2015 09:01:24 +0000
Subject: [Owasp-modsecurity-core-rule-set] Modsecurity block JSON
In-Reply-To: <CAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9++A@mail.gmail.com>
References: <CAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9++A@mail.gmail.com>
Message-ID: <CAFDTedpfDm94ixkmn6iUX4TXr75ab-n3-pCvkx5dkQ_Xpe72Kw@mail.gmail.com>

Unfortunately, you are hitting an unsolved issue in ModSecurity: requests
which have content type other than application/json but include json in
some of the parameters. ModSecurity doesn't know how to handle this and
treats the whole argument as one single variable, thus triggering multiple
rules that shouldn't be triggered if the json object was parsed
appropriately. There is an issue open in GitHub to support something like
t:jsonDecode to aid with these situations, but it hasn't been actioned yet.

What you could do is, for those arguments you know are json format, create
a rule that reduces the score of the anomaly detection rules. That may do
the trick for many cases.


On Wed 9 Sep 2015 at 17:38 Ilyass Kaouam <ilyassikai at gmail.com> wrote:

> Hi,
>
> I have this request :
> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
>
> with this parameters :
> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
> 0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 },
> { mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>
> When I execute this request modsecurity block my request.
>
>
> Log :
>
>
> --1354a526-A--
>
> [09/Sep/2015:17:48:39 +0200] VfBU138AAAEAAFm8PlQAAAAk
> ?XXX.XXX.XXX
>  53935
> ?XXX.XXX.XXX
>  80
>
> --1354a526-B--
>
> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
> HTTP/1.1
>
> Host: www.
> ?abc
> .
> ?com?
>
> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:40.0)
> Gecko/20100101 Firefox/40.0
>
> Accept: */*
>
> Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
>
> Accept-Encoding: gzip, deflate
>
> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>
> X-Requested-With: XMLHttpRequest
>
> Referer: http://www.
> ?abc
> .
> ?com
> /beta/servlet/EspaceClientServlet?plateform=new
>
> Content-Length: 413
>
> Cookie: JSESSIONID=6B370AFFEA03BE2B80F916C5755EEEC5;
> __utma=37027576.1259853019.1435675370.1441795926.1441813263.22;
> __utmz=37027576.1435675370.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);
> style=null; JSESSIONID=DACE18AC3CBA86CAF59264F47E99B028; __utmc=37027576;
> __utmb=37027576.3.10.1441813263
>
> Connection: keep-alive
>
> Pragma: no-cache
>
> Cache-Control: no-cache
>
>
> --1354a526-C--
>
> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
> 0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, {
> mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>
> --1354a526-F--
>
> HTTP/1.1 403 Forbidden
>
> Content-Length: 296
>
> Connection: close
>
> Content-Type: text/html; charset=iso-8859-1
>
>
> --1354a526-E--
>
>
> --1354a526-H--
>
> Message: Access denied with code 403 (phase 2). Pattern match
> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
> at ARGS:left. [file
> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
> Detection Alert - Total # of special characters exceeded"] [data "Matched
> Data: - found within ARGS:left: { mod : 'mod-historique', hidden : 0,
> collapsed : 0 }, { mod : 'mod-cercle-inforisk', hidden : 0, collapsed : 0
> }, { mod : 'mod-graph', hidden : 0, collapsed : 0 }"] [ver
> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>
> Action: Intercepted (phase 2)
>
> Apache-Handler: proxy-server
>
> Stopwatch: 1441813719351394 3237 (- - -)
>
> Stopwatch2: 1441813719351394 3237; combined=2824, p1=202, p2=2592, p3=0,
> p4=0, p5=30, sr=26, sw=0, l=0, gc=0
>
> Response-Body-Transformed: Dechunked
>
> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
> OWASP_CRS/2.2.9.
>
> Server: Apache/2.2.15 (CentOS) DAV/2
>
> Engine-Mode: "ENABLED"
>
>
> --1354a526-Z--
>
>
>
>
>
>
> Who can I allow like this request safety
> ? ??
>
> Thank's  ?
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150910/5af7bd05/attachment-0001.html>

From ilyassikai at gmail.com  Thu Sep 10 09:16:44 2015
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Thu, 10 Sep 2015 10:16:44 +0100
Subject: [Owasp-modsecurity-core-rule-set] Modsecurity block JSON
In-Reply-To: <CAFDTedpfDm94ixkmn6iUX4TXr75ab-n3-pCvkx5dkQ_Xpe72Kw@mail.gmail.com>
References: <CAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9++A@mail.gmail.com>
	<CAFDTedpfDm94ixkmn6iUX4TXr75ab-n3-pCvkx5dkQ_Xpe72Kw@mail.gmail.com>
Message-ID: <CAMmziWcphwzGvGSRh-HZUaEsUDs6T_6wqPCFkYwZJFMRdauV6g@mail.gmail.com>

Hi,

Thank your for your reply.
I don't Know If I understood correctly. Now if I change the content-type to
json, It should work ?
Thank's

2015-09-10 10:01 GMT+01:00 Adri?n <adrianbn at gmail.com>:

> Unfortunately, you are hitting an unsolved issue in ModSecurity: requests
> which have content type other than application/json but include json in
> some of the parameters. ModSecurity doesn't know how to handle this and
> treats the whole argument as one single variable, thus triggering multiple
> rules that shouldn't be triggered if the json object was parsed
> appropriately. There is an issue open in GitHub to support something like
> t:jsonDecode to aid with these situations, but it hasn't been actioned yet.
>
> What you could do is, for those arguments you know are json format, create
> a rule that reduces the score of the anomaly detection rules. That may do
> the trick for many cases.
>
>
> On Wed 9 Sep 2015 at 17:38 Ilyass Kaouam <ilyassikai at gmail.com> wrote:
>
>> Hi,
>>
>> I have this request :
>> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
>>
>> with this parameters :
>> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
>> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
>> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
>> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
>> 0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 },
>> { mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>>
>> When I execute this request modsecurity block my request.
>>
>>
>> Log :
>>
>>
>> --1354a526-A--
>>
>> [09/Sep/2015:17:48:39 +0200] VfBU138AAAEAAFm8PlQAAAAk
>> ?XXX.XXX.XXX
>>  53935
>> ?XXX.XXX.XXX
>>  80
>>
>> --1354a526-B--
>>
>> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
>> HTTP/1.1
>>
>> Host: www.
>> ?abc
>> .
>> ?com?
>>
>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:40.0)
>> Gecko/20100101 Firefox/40.0
>>
>> Accept: */*
>>
>> Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
>>
>> Accept-Encoding: gzip, deflate
>>
>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>
>> X-Requested-With: XMLHttpRequest
>>
>> Referer: http://www.
>> ?abc
>> .
>> ?com
>> /beta/servlet/EspaceClientServlet?plateform=new
>>
>> Content-Length: 413
>>
>> Cookie: JSESSIONID=6B370AFFEA03BE2B80F916C5755EEEC5;
>> __utma=37027576.1259853019.1435675370.1441795926.1441813263.22;
>> __utmz=37027576.1435675370.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);
>> style=null; JSESSIONID=DACE18AC3CBA86CAF59264F47E99B028; __utmc=37027576;
>> __utmb=37027576.3.10.1441813263
>>
>> Connection: keep-alive
>>
>> Pragma: no-cache
>>
>> Cache-Control: no-cache
>>
>>
>> --1354a526-C--
>>
>> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
>> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
>> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
>> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
>> 0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, {
>> mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>>
>> --1354a526-F--
>>
>> HTTP/1.1 403 Forbidden
>>
>> Content-Length: 296
>>
>> Connection: close
>>
>> Content-Type: text/html; charset=iso-8859-1
>>
>>
>> --1354a526-E--
>>
>>
>> --1354a526-H--
>>
>> Message: Access denied with code 403 (phase 2). Pattern match
>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>> at ARGS:left. [file
>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
>> Detection Alert - Total # of special characters exceeded"] [data "Matched
>> Data: - found within ARGS:left: { mod : 'mod-historique', hidden : 0,
>> collapsed : 0 }, { mod : 'mod-cercle-inforisk', hidden : 0, collapsed : 0
>> }, { mod : 'mod-graph', hidden : 0, collapsed : 0 }"] [ver
>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>>
>> Action: Intercepted (phase 2)
>>
>> Apache-Handler: proxy-server
>>
>> Stopwatch: 1441813719351394 3237 (- - -)
>>
>> Stopwatch2: 1441813719351394 3237; combined=2824, p1=202, p2=2592, p3=0,
>> p4=0, p5=30, sr=26, sw=0, l=0, gc=0
>>
>> Response-Body-Transformed: Dechunked
>>
>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>> OWASP_CRS/2.2.9.
>>
>> Server: Apache/2.2.15 (CentOS) DAV/2
>>
>> Engine-Mode: "ENABLED"
>>
>>
>> --1354a526-Z--
>>
>>
>>
>>
>>
>>
>> Who can I allow like this request safety
>> ? ??
>>
>> Thank's  ?
>>
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150910/aec3b64c/attachment.html>

From adrianbn at gmail.com  Fri Sep 11 12:18:38 2015
From: adrianbn at gmail.com (=?UTF-8?Q?Adri=C3=A1n?=)
Date: Fri, 11 Sep 2015 12:18:38 +0000
Subject: [Owasp-modsecurity-core-rule-set] Modsecurity block JSON
In-Reply-To: <CAMmziWcphwzGvGSRh-HZUaEsUDs6T_6wqPCFkYwZJFMRdauV6g@mail.gmail.com>
References: <CAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9++A@mail.gmail.com>
	<CAFDTedpfDm94ixkmn6iUX4TXr75ab-n3-pCvkx5dkQ_Xpe72Kw@mail.gmail.com>
	<CAMmziWcphwzGvGSRh-HZUaEsUDs6T_6wqPCFkYwZJFMRdauV6g@mail.gmail.com>
Message-ID: <CAFDTedqkHCifrpqcKnkWrdD3JgOBJALgbgReUOsR09Kin08WHA@mail.gmail.com>

What I am saying is that ModSecurity understands a properly formatted JSON
request. One that has the Content-Type set to application/json and which
body is a JSON object. If you change the content type and the format of the
body, then it should work.

On Thu, 10 Sep 2015 at 10:17 Ilyass Kaouam <ilyassikai at gmail.com> wrote:

> Hi,
>
> Thank your for your reply.
> I don't Know If I understood correctly. Now if I change the content-type
> to json, It should work ?
> Thank's
>
> 2015-09-10 10:01 GMT+01:00 Adri?n <adrianbn at gmail.com>:
>
>> Unfortunately, you are hitting an unsolved issue in ModSecurity: requests
>> which have content type other than application/json but include json in
>> some of the parameters. ModSecurity doesn't know how to handle this and
>> treats the whole argument as one single variable, thus triggering multiple
>> rules that shouldn't be triggered if the json object was parsed
>> appropriately. There is an issue open in GitHub to support something like
>> t:jsonDecode to aid with these situations, but it hasn't been actioned yet.
>>
>> What you could do is, for those arguments you know are json format,
>> create a rule that reduces the score of the anomaly detection rules. That
>> may do the trick for many cases.
>>
>>
>> On Wed 9 Sep 2015 at 17:38 Ilyass Kaouam <ilyassikai at gmail.com> wrote:
>>
>>> Hi,
>>>
>>> I have this request :
>>> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
>>>
>>> with this parameters :
>>> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
>>> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
>>> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
>>> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden
>>> :  0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed :
>>> 1 }, { mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>>>
>>> When I execute this request modsecurity block my request.
>>>
>>>
>>> Log :
>>>
>>>
>>> --1354a526-A--
>>>
>>> [09/Sep/2015:17:48:39 +0200] VfBU138AAAEAAFm8PlQAAAAk
>>> ?XXX.XXX.XXX
>>>  53935
>>> ?XXX.XXX.XXX
>>>  80
>>>
>>> --1354a526-B--
>>>
>>> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
>>> HTTP/1.1
>>>
>>> Host: www.
>>> ?abc
>>> .
>>> ?com?
>>>
>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:40.0)
>>> Gecko/20100101 Firefox/40.0
>>>
>>> Accept: */*
>>>
>>> Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
>>>
>>> Accept-Encoding: gzip, deflate
>>>
>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>>
>>> X-Requested-With: XMLHttpRequest
>>>
>>> Referer: http://www.
>>> ?abc
>>> .
>>> ?com
>>> /beta/servlet/EspaceClientServlet?plateform=new
>>>
>>> Content-Length: 413
>>>
>>> Cookie: JSESSIONID=6B370AFFEA03BE2B80F916C5755EEEC5;
>>> __utma=37027576.1259853019.1435675370.1441795926.1441813263.22;
>>> __utmz=37027576.1435675370.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);
>>> style=null; JSESSIONID=DACE18AC3CBA86CAF59264F47E99B028; __utmc=37027576;
>>> __utmb=37027576.3.10.1441813263
>>>
>>> Connection: keep-alive
>>>
>>> Pragma: no-cache
>>>
>>> Cache-Control: no-cache
>>>
>>>
>>> --1354a526-C--
>>>
>>> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
>>> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
>>> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
>>> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
>>> 0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, {
>>> mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>>>
>>> --1354a526-F--
>>>
>>> HTTP/1.1 403 Forbidden
>>>
>>> Content-Length: 296
>>>
>>> Connection: close
>>>
>>> Content-Type: text/html; charset=iso-8859-1
>>>
>>>
>>> --1354a526-E--
>>>
>>>
>>> --1354a526-H--
>>>
>>> Message: Access denied with code 403 (phase 2). Pattern match
>>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>>> at ARGS:left. [file
>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
>>> Detection Alert - Total # of special characters exceeded"] [data "Matched
>>> Data: - found within ARGS:left: { mod : 'mod-historique', hidden : 0,
>>> collapsed : 0 }, { mod : 'mod-cercle-inforisk', hidden : 0, collapsed : 0
>>> }, { mod : 'mod-graph', hidden : 0, collapsed : 0 }"] [ver
>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>>>
>>> Action: Intercepted (phase 2)
>>>
>>> Apache-Handler: proxy-server
>>>
>>> Stopwatch: 1441813719351394 3237 (- - -)
>>>
>>> Stopwatch2: 1441813719351394 3237; combined=2824, p1=202, p2=2592, p3=0,
>>> p4=0, p5=30, sr=26, sw=0, l=0, gc=0
>>>
>>> Response-Body-Transformed: Dechunked
>>>
>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>>> OWASP_CRS/2.2.9.
>>>
>>> Server: Apache/2.2.15 (CentOS) DAV/2
>>>
>>> Engine-Mode: "ENABLED"
>>>
>>>
>>> --1354a526-Z--
>>>
>>>
>>>
>>>
>>>
>>>
>>> Who can I allow like this request safety
>>> ? ??
>>>
>>> Thank's  ?
>>>
>>> _______________________________________________
>>> Owasp-modsecurity-core-rule-set mailing list
>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>>
>>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150911/ef4efaef/attachment.html>

From modsec at spam.lifeforms.nl  Sun Sep 13 13:51:56 2015
From: modsec at spam.lifeforms.nl (Walter Hop)
Date: Sun, 13 Sep 2015 15:51:56 +0200
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted
Message-ID: <487B47FD-65F9-4672-935A-B3BE8EB487AE@spam.lifeforms.nl>

Last week, Mazin Ahmed published a report with some XSS evasions for various WAFs including ModSecurity. It can be found as a PDF here: http://blog.mazinahmed.net/2015/09/evading-all-web-application-firewalls.html

He describes three evasions against ModSecurity. They?re listed on page 14 of the PDF. It might be interesting to look at them and see if they need addressing.

I?ll list the points here if the spam filters will accept it?

5.6.1 Using &NewLine; and &Tab;

<a href="j[785 bytes of (&NewLine;&Tab;)]avascript:alert(1);">XSS</a> 

This first idiom to evade detection of ?javascript:? string sounds potentially interesting, now I couldn?t reproduce this whole example because of the other rules, but it might be useful to investigate.

5.6.2 US-Encoding Bypass:

1?4script3?4alert(?xss?)1?4/script3?4 

This sounds not so interesting to me since only IE6 and IE7 ?auto-correct? this monstrosity.

5.6.3 Triple URL encoding:

<b/%25%32%35%25%33%36%25%36%36%25%32%35%25%33%36%25%36%35mouseover=alert(1)>

The substring of URL-encoded characters does trigger the rule for multiple URL encoding, however this is logged at warning level only.

I?m not sure what to make of it since the given examples themselves also trigger various other CRS rules, but passing it on just in case.

Cheers,
WH

-- 
Walter Hop | PGP key: https://lifeforms.nl/pgp


From ilyassikai at gmail.com  Mon Sep 14 09:18:21 2015
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Mon, 14 Sep 2015 10:18:21 +0100
Subject: [Owasp-modsecurity-core-rule-set] Modsecurity block JSON
In-Reply-To: <CAFDTedqkHCifrpqcKnkWrdD3JgOBJALgbgReUOsR09Kin08WHA@mail.gmail.com>
References: <CAMmziWchG87-K60fv0oEcCUpR8EJQrfahrVzi5fwA7qELW9++A@mail.gmail.com>
	<CAFDTedpfDm94ixkmn6iUX4TXr75ab-n3-pCvkx5dkQ_Xpe72Kw@mail.gmail.com>
	<CAMmziWcphwzGvGSRh-HZUaEsUDs6T_6wqPCFkYwZJFMRdauV6g@mail.gmail.com>
	<CAFDTedqkHCifrpqcKnkWrdD3JgOBJALgbgReUOsR09Kin08WHA@mail.gmail.com>
Message-ID: <CAMmziWdc=8dpa3a=i_knX73vQ_8mpCs3fZFfzXOCcQnaFggc8Q@mail.gmail.com>

Hi Adri?n,

It's work perfectly thank's  :)

2015-09-11 13:18 GMT+01:00 Adri?n <adrianbn at gmail.com>:

> What I am saying is that ModSecurity understands a properly formatted JSON
> request. One that has the Content-Type set to application/json and which
> body is a JSON object. If you change the content type and the format of the
> body, then it should work.
>
>
> On Thu, 10 Sep 2015 at 10:17 Ilyass Kaouam <ilyassikai at gmail.com> wrote:
>
>> Hi,
>>
>> Thank your for your reply.
>> I don't Know If I understood correctly. Now if I change the content-type
>> to json, It should work ?
>> Thank's
>>
>> 2015-09-10 10:01 GMT+01:00 Adri?n <adrianbn at gmail.com>:
>>
>>> Unfortunately, you are hitting an unsolved issue in ModSecurity:
>>> requests which have content type other than application/json but include
>>> json in some of the parameters. ModSecurity doesn't know how to handle this
>>> and treats the whole argument as one single variable, thus triggering
>>> multiple rules that shouldn't be triggered if the json object was parsed
>>> appropriately. There is an issue open in GitHub to support something like
>>> t:jsonDecode to aid with these situations, but it hasn't been actioned yet.
>>>
>>> What you could do is, for those arguments you know are json format,
>>> create a rule that reduces the score of the anomaly detection rules. That
>>> may do the trick for many cases.
>>>
>>>
>>> On Wed 9 Sep 2015 at 17:38 Ilyass Kaouam <ilyassikai at gmail.com> wrote:
>>>
>>>> Hi,
>>>>
>>>> I have this request :
>>>> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
>>>>
>>>> with this parameters :
>>>> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
>>>> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
>>>> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
>>>> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations',
>>>> hidden :  0, collapsed : 0 }, { mod : 'mod-service', hidden :  0,
>>>> collapsed : 1 }, { mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>>>>
>>>> When I execute this request modsecurity block my request.
>>>>
>>>>
>>>> Log :
>>>>
>>>>
>>>> --1354a526-A--
>>>>
>>>> [09/Sep/2015:17:48:39 +0200] VfBU138AAAEAAFm8PlQAAAAk
>>>> ?XXX.XXX.XXX
>>>>  53935
>>>> ?XXX.XXX.XXX
>>>>  80
>>>>
>>>> --1354a526-B--
>>>>
>>>> POST /beta/servlet/EspaceClientServlet?Action=Ajax$SaveWidgetConfig
>>>> HTTP/1.1
>>>>
>>>> Host: www.
>>>> ?abc
>>>> .
>>>> ?com?
>>>>
>>>> User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:40.0)
>>>> Gecko/20100101 Firefox/40.0
>>>>
>>>> Accept: */*
>>>>
>>>> Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3
>>>>
>>>> Accept-Encoding: gzip, deflate
>>>>
>>>> Content-Type: application/x-www-form-urlencoded; charset=UTF-8
>>>>
>>>> X-Requested-With: XMLHttpRequest
>>>>
>>>> Referer: http://www.
>>>> ?abc
>>>> .
>>>> ?com
>>>> /beta/servlet/EspaceClientServlet?plateform=new
>>>>
>>>> Content-Length: 413
>>>>
>>>> Cookie: JSESSIONID=6B370AFFEA03BE2B80F916C5755EEEC5;
>>>> __utma=37027576.1259853019.1435675370.1441795926.1441813263.22;
>>>> __utmz=37027576.1435675370.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none);
>>>> style=null; JSESSIONID=DACE18AC3CBA86CAF59264F47E99B028; __utmc=37027576;
>>>> __utmb=37027576.3.10.1441813263
>>>>
>>>> Connection: keep-alive
>>>>
>>>> Pragma: no-cache
>>>>
>>>> Cache-Control: no-cache
>>>>
>>>>
>>>> --1354a526-C--
>>>>
>>>> left={ mod : 'mod-historique', hidden : 0, collapsed : 0 }, { mod :
>>>> 'mod-cercle-inforisk', hidden : 0, collapsed : 0 }, { mod : 'mod-graph',
>>>> hidden : 0, collapsed : 0 }&right={ mod : 'mod-surveillance-implicit',
>>>> hidden :  0, collapsed : 0 }, { mod : 'mod-dernieres-creations', hidden :
>>>> 0, collapsed : 0 }, { mod : 'mod-service', hidden :  0, collapsed : 1 }, {
>>>> mod : 'mod-recherche', hidden :  0, collapsed : 0 }
>>>>
>>>> --1354a526-F--
>>>>
>>>> HTTP/1.1 403 Forbidden
>>>>
>>>> Content-Length: 296
>>>>
>>>> Connection: close
>>>>
>>>> Content-Type: text/html; charset=iso-8859-1
>>>>
>>>>
>>>> --1354a526-E--
>>>>
>>>>
>>>> --1354a526-H--
>>>>
>>>> Message: Access denied with code 403 (phase 2). Pattern match
>>>> "([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\"\\'\\\xc2\xb4\\\xe2\x80\x99\\\xe2\x80\x98\\`\\<\\>].*?){4,}"
>>>> at ARGS:left. [file
>>>> "/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
>>>> [line "159"] [id "981173"] [rev "2"] [msg "Restricted SQL Character Anomaly
>>>> Detection Alert - Total # of special characters exceeded"] [data "Matched
>>>> Data: - found within ARGS:left: { mod : 'mod-historique', hidden : 0,
>>>> collapsed : 0 }, { mod : 'mod-cercle-inforisk', hidden : 0, collapsed : 0
>>>> }, { mod : 'mod-graph', hidden : 0, collapsed : 0 }"] [ver
>>>> "OWASP_CRS/2.2.9"] [maturity "9"] [accuracy "8"] [tag
>>>> "OWASP_CRS/WEB_ATTACK/SQL_INJECTION"]
>>>>
>>>> Action: Intercepted (phase 2)
>>>>
>>>> Apache-Handler: proxy-server
>>>>
>>>> Stopwatch: 1441813719351394 3237 (- - -)
>>>>
>>>> Stopwatch2: 1441813719351394 3237; combined=2824, p1=202, p2=2592,
>>>> p3=0, p4=0, p5=30, sr=26, sw=0, l=0, gc=0
>>>>
>>>> Response-Body-Transformed: Dechunked
>>>>
>>>> Producer: ModSecurity for Apache/2.7.3 (http://www.modsecurity.org/);
>>>> OWASP_CRS/2.2.9.
>>>>
>>>> Server: Apache/2.2.15 (CentOS) DAV/2
>>>>
>>>> Engine-Mode: "ENABLED"
>>>>
>>>>
>>>> --1354a526-Z--
>>>>
>>>>
>>>>
>>>>
>>>>
>>>>
>>>> Who can I allow like this request safety
>>>> ? ??
>>>>
>>>> Thank's  ?
>>>>
>>>> _______________________________________________
>>>> Owasp-modsecurity-core-rule-set mailing list
>>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>>>
>>>
>>
>>
>>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150914/2e43a558/attachment.html>

From kauselot at yahoo.com  Mon Sep 14 18:19:38 2015
From: kauselot at yahoo.com (kause lotski)
Date: Mon, 14 Sep 2015 18:19:38 +0000 (UTC)
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
Message-ID: <1997255831.2489169.1442254778503.JavaMail.yahoo@mail.yahoo.com>

Hi,
as it seems 3.0 greatly improves extended character sets in unicode handling (false positives due to this characters), I would like to give it a try. But as structure has totally changed INSTALL instructions aren't correct anymore in 3.0 branch, can someone give me a quick guide? is there any ETA for 3.0 ?

Regards,Kause
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150914/aa5ab53e/attachment.html>

From christian.folini at time-machine.ch  Tue Sep 15 04:03:05 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Tue, 15 Sep 2015 06:03:05 +0200
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted
Message-ID: <20150915040305.GA18940@elias>

Good morning,

What is funny about the paper is, that he lists contact with all
the other vendors and how they reacted to his responsible
disclosure, but this is missing for ModSec.

Has there been no contact / no interest to patch in due time?

Ahoj,

Christian


-- 
It's easier to ask forgiveness, than it is to get permission.
-- Radm Grace Hopper, aka Amazing Grace


From CSanders at trustwave.com  Tue Sep 15 13:23:18 2015
From: CSanders at trustwave.com (Chaim Sanders)
Date: Tue, 15 Sep 2015 13:23:18 +0000
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted
In-Reply-To: <20150915040305.GA18940@elias>
References: <20150915040305.GA18940@elias>
Message-ID: <D21D93C1.12822%csanders@trustwave.com>

As far as I am aware we have not received anything. It certainly didn?t go
to this mailing list and I don?t recall anything on
security at modsecurity.org. I am be preparing a blog post where we analysis
these attacks as we speak. Be on the lookout for it :)

On 9/15/15, 12:03 AM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
Christian Folini" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
on behalf of christian.folini at time-machine.ch> wrote:

>Good morning,
>
>What is funny about the paper is, that he lists contact with all
>the other vendors and how they reacted to his responsible
>disclosure, but this is missing for ModSec.
>
>Has there been no contact / no interest to patch in due time?
>
>Ahoj,
>
>Christian
>
>
>--
>It's easier to ask forgiveness, than it is to get permission.
>-- Radm Grace Hopper, aka Amazing Grace
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>http://scanmail.trustwave.com/?c=4062&d=vp331TYeSJtl4OUFeRwH_d8xwpzKptjDeB
>Wj6-tsnQ&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
>asp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From info at otherdata.com  Tue Sep 15 15:18:51 2015
From: info at otherdata.com (OtherData)
Date: Tue, 15 Sep 2015 09:18:51 -0600
Subject: [Owasp-modsecurity-core-rule-set]
	Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
In-Reply-To: <mailman.11.1442318408.24537.owasp-modsecurity-core-rule-set@lists.owasp.org>
References: <mailman.11.1442318408.24537.owasp-modsecurity-core-rule-set@lists.owasp.org>
Message-ID: <OZuFn.1700cc7425.000001d0efc9$dd13ed40$973bc7c0$@otherdata.com>

I am also interested in why the 2.2.9 rule set is still considered the
latest rule set, and 3.0 is not.  The 3.0 ruleset appears to be now bundled
with cPanel which is confusing as to why they would bundle it with cPanel if
it is not stable.


Wesley Render, Consultant
www.otherdata.com


-----Original Message-----
From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
[mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf
Of owasp-modsecurity-core-rule-set-request at lists.owasp.org
Sent: September 15, 2015 6:00 AM
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5

Send Owasp-modsecurity-core-rule-set mailing list submissions to
	owasp-modsecurity-core-rule-set at lists.owasp.org

To subscribe or unsubscribe via the World Wide Web, visit
	
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

or, via email, send a message with subject or body 'help' to
	owasp-modsecurity-core-rule-set-request at lists.owasp.org

You can reach the person managing the list at
	owasp-modsecurity-core-rule-set-owner at lists.owasp.org

When replying, please edit your Subject line so it is more specific than
"Re: Contents of Owasp-modsecurity-core-rule-set digest..."


Today's Topics:

   1. Using 3.0 ruleset (kause lotski)
   2. Re: Some XSS evasions posted (Christian Folini)


----------------------------------------------------------------------

Message: 1
Date: Mon, 14 Sep 2015 18:19:38 +0000 (UTC)
From: kause lotski <kauselot at yahoo.com>
To: "owasp-modsecurity-core-rule-set at lists.owasp.org"
	<owasp-modsecurity-core-rule-set at lists.owasp.org>
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
Message-ID:
	<1997255831.2489169.1442254778503.JavaMail.yahoo at mail.yahoo.com>
Content-Type: text/plain; charset="utf-8"

Hi,
as it seems 3.0 greatly improves extended character sets in unicode handling
(false positives due to this characters), I would like to give it a try. But
as structure has totally changed INSTALL instructions aren't correct anymore
in 3.0 branch, can someone give me a quick guide? is there any ETA for 3.0 ?

Regards,Kause
-------------- next part --------------
An HTML attachment was scrubbed...
URL:
<http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachment
s/20150914/aa5ab53e/attachment-0001.html>

------------------------------

Message: 2
Date: Tue, 15 Sep 2015 06:03:05 +0200
From: Christian Folini <christian.folini at time-machine.ch>
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: [Owasp-modsecurity-core-rule-set] Some XSS evasions
	posted
Message-ID: <20150915040305.GA18940 at elias>
Content-Type: text/plain; charset=utf-8

Good morning,

What is funny about the paper is, that he lists contact with all the other
vendors and how they reacted to his responsible disclosure, but this is
missing for ModSec.

Has there been no contact / no interest to patch in due time?

Ahoj,

Christian


--
It's easier to ask forgiveness, than it is to get permission.
-- Radm Grace Hopper, aka Amazing Grace



------------------------------

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


End of Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
**************************************************************


From CSanders at trustwave.com  Tue Sep 15 17:44:43 2015
From: CSanders at trustwave.com (Chaim Sanders)
Date: Tue, 15 Sep 2015 17:44:43 +0000
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
In-Reply-To: <1997255831.2489169.1442254778503.JavaMail.yahoo@mail.yahoo.com>
References: <1997255831.2489169.1442254778503.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <D21C90DF.1232D%csanders@trustwave.com>

The installation instructions are exactly identical, simply drop the folder structure in an area readable by your web server, include the .conf files from httpd.conf or equivalent, and go through the recommended configuration file and configure your options. At this point in fact 3.0 is by a large margin the preferred ruleset as far as OWASP CRS is concerned. We have hesitated to push 3.0 to main branch for two reasons right now... 1) is that it requires 2.8 or greater in order to run (thanks to things like @detectxss)(only recently has 2.8 become available in things like yum/apt-get repos) and two it has known high(but less high then 2.x) false positives rate for SQL injection. We want to address these false positives before we push it to the master branch. Does that answer your questions?

From: <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>> on behalf of kause lotski <kauselot at yahoo.com<mailto:kauselot at yahoo.com>>
Reply-To: kause lotski <kauselot at yahoo.com<mailto:kauselot at yahoo.com>>
Date: Monday, September 14, 2015 at 2:19 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset

Hi,

as it seems 3.0 greatly improves extended character sets in unicode handling (false positives due to this characters), I would like to give it a try. But as structure has totally changed INSTALL instructions aren't correct anymore in 3.0 branch, can someone give me a quick guide? is there any ETA for 3.0 ?

Regards,
Kause

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150915/4abc72e0/attachment.html>

From CSanders at trustwave.com  Tue Sep 15 17:47:31 2015
From: CSanders at trustwave.com (Chaim Sanders)
Date: Tue, 15 Sep 2015 17:47:31 +0000
Subject: [Owasp-modsecurity-core-rule-set]
 Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
In-Reply-To: <OZuFn.1700cc7425.000001d0efc9$dd13ed40$973bc7c0$@otherdata.com>
References: <mailman.11.1442318408.24537.owasp-modsecurity-core-rule-set@lists.owasp.org>
	<OZuFn.1700cc7425.000001d0efc9$dd13ed40$973bc7c0$@otherdata.com>
Message-ID: <D21DD19D.12A11%csanders@trustwave.com>

We are actually heavily using the feedback from cPanel in order to steer
changes to the 3.0 rule set? in conjunction with my previous email this
should kind of give you some insight. We are very thankful to cPanel for
helping us with this telemetry data.

On 9/15/15, 11:18 AM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
OtherData" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on
behalf of info at otherdata.com> wrote:

>I am also interested in why the 2.2.9 rule set is still considered the
>latest rule set, and 3.0 is not.  The 3.0 ruleset appears to be now
>bundled
>with cPanel which is confusing as to why they would bundle it with cPanel
>if
>it is not stable.
>
>
>Wesley Render, Consultant
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1Gstr
>VdQ3EjKQ&s=5&u=http%3a%2f%2fwww%2eotherdata%2ecom
>
>
>-----Original Message-----
>From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
>[mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On Behalf
>Of owasp-modsecurity-core-rule-set-request at lists.owasp.org
>Sent: September 15, 2015 6:00 AM
>To: owasp-modsecurity-core-rule-set at lists.owasp.org
>Subject: Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
>
>Send Owasp-modsecurity-core-rule-set mailing list submissions to
>       owasp-modsecurity-core-rule-set at lists.owasp.org
>
>To subscribe or unsubscribe via the World Wide Web, visit
>
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1Gstu
>QOSnFydg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
>asp-modsecurity-core-rule-set
>
>or, via email, send a message with subject or body 'help' to
>       owasp-modsecurity-core-rule-set-request at lists.owasp.org
>
>You can reach the person managing the list at
>       owasp-modsecurity-core-rule-set-owner at lists.owasp.org
>
>When replying, please edit your Subject line so it is more specific than
>"Re: Contents of Owasp-modsecurity-core-rule-set digest..."
>
>
>Today's Topics:
>
>   1. Using 3.0 ruleset (kause lotski)
>   2. Re: Some XSS evasions posted (Christian Folini)
>
>
>----------------------------------------------------------------------
>
>Message: 1
>Date: Mon, 14 Sep 2015 18:19:38 +0000 (UTC)
>From: kause lotski <kauselot at yahoo.com>
>To: "owasp-modsecurity-core-rule-set at lists.owasp.org"
>       <owasp-modsecurity-core-rule-set at lists.owasp.org>
>Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
>Message-ID:
>       <1997255831.2489169.1442254778503.JavaMail.yahoo at mail.yahoo.com>
>Content-Type: text/plain; charset="utf-8"
>
>Hi,
>as it seems 3.0 greatly improves extended character sets in unicode
>handling
>(false positives due to this characters), I would like to give it a try.
>But
>as structure has totally changed INSTALL instructions aren't correct
>anymore
>in 3.0 branch, can someone give me a quick guide? is there any ETA for
>3.0 ?
>
>Regards,Kause
>-------------- next part --------------
>An HTML attachment was scrubbed...
>URL:
><http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1Gst
>ugORHByKw&s=5&u=http%3a%2f%2flists%2eowasp%2eorg%2fpipermail%2fowasp-modse
>curity-core-rule-set%2fattachment
>s/20150914/aa5ab53e/attachment-0001.html>
>
>------------------------------
>
>Message: 2
>Date: Tue, 15 Sep 2015 06:03:05 +0200
>From: Christian Folini <christian.folini at time-machine.ch>
>To: owasp-modsecurity-core-rule-set at lists.owasp.org
>Subject: Re: [Owasp-modsecurity-core-rule-set] Some XSS evasions
>       posted
>Message-ID: <20150915040305.GA18940 at elias>
>Content-Type: text/plain; charset=utf-8
>
>Good morning,
>
>What is funny about the paper is, that he lists contact with all the other
>vendors and how they reacted to his responsible disclosure, but this is
>missing for ModSec.
>
>Has there been no contact / no interest to patch in due time?
>
>Ahoj,
>
>Christian
>
>
>--
>It's easier to ask forgiveness, than it is to get permission.
>-- Radm Grace Hopper, aka Amazing Grace
>
>
>
>------------------------------
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1Gstu
>QOSnFydg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
>asp-modsecurity-core-rule-set
>
>
>End of Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
>**************************************************************
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1Gstu
>QOSnFydg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
>asp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

From info at otherdata.com  Tue Sep 15 17:55:49 2015
From: info at otherdata.com (OtherData)
Date: Tue, 15 Sep 2015 11:55:49 -0600
Subject: [Owasp-modsecurity-core-rule-set]
	Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
In-Reply-To: <D21DD19D.12A11%csanders@trustwave.com>
References: <mailman.11.1442318408.24537.owasp-modsecurity-core-rule-set@lists.owasp.org>
	<000001d0efc9$dd13ed40$973bc7c0$@otherdata.com>
	<D21DD19D.12A11%csanders@trustwave.com>
Message-ID: <OZuFn.8700ba4c40.000001d0efdf$c1a70b80$44f52280$@otherdata.com>

Ok. Thanks for clarification Chaim. 

Regards,

Wesley Render, Consultant


-----Original Message-----
From: Chaim Sanders [mailto:CSanders at trustwave.com] 
Sent: September 15, 2015 11:48 AM
To: OtherData <info at otherdata.com>;
owasp-modsecurity-core-rule-set at lists.owasp.org
Subject: Re: [Owasp-modsecurity-core-rule-set]
Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5

We are actually heavily using the feedback from cPanel in order to steer
changes to the 3.0 rule set? in conjunction with my previous email this
should kind of give you some insight. We are very thankful to cPanel for
helping us with this telemetry data.

On 9/15/15, 11:18 AM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
OtherData" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on
behalf of info at otherdata.com> wrote:

>I am also interested in why the 2.2.9 rule set is still considered the 
>latest rule set, and 3.0 is not.  The 3.0 ruleset appears to be now 
>bundled with cPanel which is confusing as to why they would bundle it 
>with cPanel if it is not stable.
>
>
>Wesley Render, Consultant
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1G
>str VdQ3EjKQ&s=5&u=http%3a%2f%2fwww%2eotherdata%2ecom
>
>
>-----Original Message-----
>From: owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
>[mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org] On 
>Behalf Of owasp-modsecurity-core-rule-set-request at lists.owasp.org
>Sent: September 15, 2015 6:00 AM
>To: owasp-modsecurity-core-rule-set at lists.owasp.org
>Subject: Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
>
>Send Owasp-modsecurity-core-rule-set mailing list submissions to
>       owasp-modsecurity-core-rule-set at lists.owasp.org
>
>To subscribe or unsubscribe via the World Wide Web, visit
>
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1G
>stu 
>QOSnFydg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2
>fow
>asp-modsecurity-core-rule-set
>
>or, via email, send a message with subject or body 'help' to
>       owasp-modsecurity-core-rule-set-request at lists.owasp.org
>
>You can reach the person managing the list at
>       owasp-modsecurity-core-rule-set-owner at lists.owasp.org
>
>When replying, please edit your Subject line so it is more specific 
>than
>"Re: Contents of Owasp-modsecurity-core-rule-set digest..."
>
>
>Today's Topics:
>
>   1. Using 3.0 ruleset (kause lotski)
>   2. Re: Some XSS evasions posted (Christian Folini)
>
>
>----------------------------------------------------------------------
>
>Message: 1
>Date: Mon, 14 Sep 2015 18:19:38 +0000 (UTC)
>From: kause lotski <kauselot at yahoo.com>
>To: "owasp-modsecurity-core-rule-set at lists.owasp.org"
>       <owasp-modsecurity-core-rule-set at lists.owasp.org>
>Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
>Message-ID:
>       <1997255831.2489169.1442254778503.JavaMail.yahoo at mail.yahoo.com>
>Content-Type: text/plain; charset="utf-8"
>
>Hi,
>as it seems 3.0 greatly improves extended character sets in unicode 
>handling (false positives due to this characters), I would like to give 
>it a try.
>But
>as structure has totally changed INSTALL instructions aren't correct 
>anymore in 3.0 branch, can someone give me a quick guide? is there any 
>ETA for
>3.0 ?
>
>Regards,Kause
>-------------- next part -------------- An HTML attachment was 
>scrubbed...
>URL:
><http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1
>Gst 
>ugORHByKw&s=5&u=http%3a%2f%2flists%2eowasp%2eorg%2fpipermail%2fowasp-mo
>dse
>curity-core-rule-set%2fattachment
>s/20150914/aa5ab53e/attachment-0001.html>
>
>------------------------------
>
>Message: 2
>Date: Tue, 15 Sep 2015 06:03:05 +0200
>From: Christian Folini <christian.folini at time-machine.ch>
>To: owasp-modsecurity-core-rule-set at lists.owasp.org
>Subject: Re: [Owasp-modsecurity-core-rule-set] Some XSS evasions
>       posted
>Message-ID: <20150915040305.GA18940 at elias>
>Content-Type: text/plain; charset=utf-8
>
>Good morning,
>
>What is funny about the paper is, that he lists contact with all the 
>other vendors and how they reacted to his responsible disclosure, but 
>this is missing for ModSec.
>
>Has there been no contact / no interest to patch in due time?
>
>Ahoj,
>
>Christian
>
>
>--
>It's easier to ask forgiveness, than it is to get permission.
>-- Radm Grace Hopper, aka Amazing Grace
>
>
>
>------------------------------
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list 
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1G
>stu 
>QOSnFydg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2
>fow
>asp-modsecurity-core-rule-set
>
>
>End of Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5
>**************************************************************
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list 
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>http://scanmail.trustwave.com/?c=4062&d=ibz41bI2K9m7Ta3ev1ksnCpRdP9Fi1G
>stu 
>QOSnFydg&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2
>fow
>asp-modsecurity-core-rule-set


________________________________

This transmission may contain information that is privileged, confidential,
and/or exempt from disclosure under applicable law. If you are not the
intended recipient, you are hereby notified that any disclosure, copying,
distribution, or use of the information contained herein (including any
reliance thereon) is strictly prohibited. If you received this transmission
in error, please immediately contact the sender and destroy the material in
its entirety, whether in electronic or hard copy format.


From kauselot at yahoo.com  Wed Sep 16 08:24:11 2015
From: kauselot at yahoo.com (kause lotski)
Date: Wed, 16 Sep 2015 08:24:11 +0000 (UTC)
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
In-Reply-To: <D21C90DF.1232D%csanders@trustwave.com>
References: <D21C90DF.1232D%csanders@trustwave.com>
Message-ID: <1955164852.217426.1442391851895.JavaMail.yahoo@mail.yahoo.com>

Hi,
I was referring to this file https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/INSTALL which mentions directories that don't exist in 3.0 branch (base_rules, experimental_rules etc ) - is it safe to presume rules directory is the same as base_rules in 2.x ?
Problem I hope to be at least somehow better ( I got this impression by reading tickets on github
) in 3.0 is that with 2.2.9 I basically need to disable most sql injection rules for any form field with user generated content (text fields, textareas etc) as this rules get triggered by UTF-8 encoded characters from Latin Extended-A - Wikipedia, the free encyclopedia subset.

| ? |
| ? | ? | ? | ? | ? |
| Latin Extended-A - Wikipedia, the free encyclopediaLatin Extended-A is a block of the Unicode Standard. |
|  |
| View on en.wikipedia.org | Preview by Yahoo |
|  |
| ? |


     From: Chaim Sanders <CSanders at trustwave.com>
 To: kause lotski <kauselot at yahoo.com>; "owasp-modsecurity-core-rule-set at lists.owasp.org" <owasp-modsecurity-core-rule-set at lists.owasp.org> 
 Sent: Tuesday, September 15, 2015 7:44 PM
 Subject: Re: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
   
The installation instructions are exactly identical, simply drop the folder structure in an area readable by your web server, include the .conf files from httpd.conf or equivalent, and go through the recommended configuration file and configure your options. At this point in fact 3.0 is by a large margin the preferred ruleset as far as OWASP CRS is concerned. We have hesitated to push 3.0 to main branch for two reasons right now? 1) is that it requires 2.8 or greater in order to run (thanks to things like @detectxss)(only recently has 2.8 become available in things like yum/apt-get repos) and two it has known high(but less high then 2.x) false positives rate for SQL injection. We want to address these false positives before we push it to the master branch. Does that answer your questions?


From: <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org> on behalf of kause lotski <kauselot at yahoo.com>
Reply-To: kause lotski <kauselot at yahoo.com>
Date: Monday, September 14, 2015 at 2:19 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org" <owasp-modsecurity-core-rule-set at lists.owasp.org>
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset

Hi,
as it seems 3.0 greatly improves extended character sets in unicode handling (false positives due to this characters), I would like to give it a try. But as structure has totally changed INSTALL instructions aren't correct anymore in 3.0 branch, can someone give me a quick guide? is there any ETA for 3.0 ?

Regards,Kause


This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


  
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150916/97436f67/attachment-0001.html>

From CSanders at trustwave.com  Wed Sep 16 13:47:43 2015
From: CSanders at trustwave.com (Chaim Sanders)
Date: Wed, 16 Sep 2015 13:47:43 +0000
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset
In-Reply-To: <1955164852.217426.1442391851895.JavaMail.yahoo@mail.yahoo.com>
References: <D21C90DF.1232D%csanders@trustwave.com>
	<1955164852.217426.1442391851895.JavaMail.yahoo@mail.yahoo.com>
Message-ID: <D21EEA82.12A35%csanders@trustwave.com>

Hey kause,
I'll take a look at the install and update it today :) thanks for bringing that up. In general we are trying to deal with how PCRE deals with unicode characters... most of the problem is that many arabic chars (and others as you mentioned) are considered non-worst characters (/W) by PCRE... this is backwards (from our perspective) and a serious problem that requires us manually specifying large swaths of char sets in our rules... currently a good solution hasn't been suggested yet. If you have any input I'd love to hear it.

From: kause lotski <kauselot at yahoo.com<mailto:kauselot at yahoo.com>>
Reply-To: kause lotski <kauselot at yahoo.com<mailto:kauselot at yahoo.com>>
Date: Wednesday, September 16, 2015 at 4:24 AM
To: Chaim Sanders <csanders at trustwave.com<mailto:csanders at trustwave.com>>, "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: Re: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset

Hi,

I was referring to this file https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/INSTALL<http://scanmail.trustwave.com/?c=4062&d=rqf51bXRy3x_GvmCPADdd0iyNXviY6YH2Vzd-6RKyQ&s=5&u=https%3a%2f%2fgithub%2ecom%2fSpiderLabs%2fowasp-modsecurity-crs%2fblob%2fv3%2e0%2e0-dev%2fINSTALL> which mentions directories that don't exist in 3.0 branch (base_rules, experimental_rules etc ) - is it safe to presume rules directory is the same as base_rules in 2.x ?

Problem I hope to be at least somehow better ( I got this impression by reading tickets on github
) in 3.0 is that with 2.2.9 I basically need to disable most sql injection rules for any form field with user generated content (text fields, textareas etc) as this rules get triggered by UTF-8 encoded characters from Latin Extended-A - Wikipedia, the free encyclopedia<http://scanmail.trustwave.com/?c=4062&d=rqf51bXRy3x_GvmCPADdd0iyNXviY6YH2QCI8P4czA&s=5&u=https%3a%2f%2fen%2ewikipedia%2eorg%2fwiki%2fLatin%5fExtended-A> subset.












Latin Extended-A - Wikipedia, the free encyclopedia<http://scanmail.trustwave.com/?c=4062&d=rqf51bXRy3x_GvmCPADdd0iyNXviY6YH2QCI8P4czA&s=5&u=https%3a%2f%2fen%2ewikipedia%2eorg%2fwiki%2fLatin%5fExtended-A>
Latin Extended-A is a block of the Unicode Standard.


View on en.wikipedia.org<http://scanmail.trustwave.com/?c=4062&d=rqf51bXRy3x_GvmCPADdd0iyNXviY6YH2QCI8P4czA&s=5&u=https%3a%2f%2fen%2ewikipedia%2eorg%2fwiki%2fLatin%5fExtended-A>

Preview by Yahoo





________________________________
From: Chaim Sanders <CSanders at trustwave.com<mailto:CSanders at trustwave.com>>
To: kause lotski <kauselot at yahoo.com<mailto:kauselot at yahoo.com>>; "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Sent: Tuesday, September 15, 2015 7:44 PM
Subject: Re: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset

The installation instructions are exactly identical, simply drop the folder structure in an area readable by your web server, include the .conf files from httpd.conf or equivalent, and go through the recommended configuration file and configure your options. At this point in fact 3.0 is by a large margin the preferred ruleset as far as OWASP CRS is concerned. We have hesitated to push 3.0 to main branch for two reasons right now... 1) is that it requires 2.8 or greater in order to run (thanks to things like @detectxss)(only recently has 2.8 become available in things like yum/apt-get repos) and two it has known high(but less high then 2.x) false positives rate for SQL injection. We want to address these false positives before we push it to the master branch. Does that answer your questions?



From: <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>> on behalf of kause lotski <kauselot at yahoo.com<mailto:kauselot at yahoo.com>>
Reply-To: kause lotski <kauselot at yahoo.com<mailto:kauselot at yahoo.com>>
Date: Monday, September 14, 2015 at 2:19 PM
To: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: [Owasp-modsecurity-core-rule-set] Using 3.0 ruleset

Hi,

as it seems 3.0 greatly improves extended character sets in unicode handling (false positives due to this characters), I would like to give it a try. But as structure has totally changed INSTALL instructions aren't correct anymore in 3.0 branch, can someone give me a quick guide? is there any ETA for 3.0 ?

Regards,
Kause

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.



________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150916/9cdefee0/attachment-0001.html>

From christian.folini at time-machine.ch  Thu Sep 17 08:35:44 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Thu, 17 Sep 2015 10:35:44 +0200
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and
 some thoughts why ModSec Core Rules users were hit on day 0)
In-Reply-To: <D21D93C1.12822%csanders@trustwave.com>
References: <20150915040305.GA18940@elias>
	<D21D93C1.12822%csanders@trustwave.com>
Message-ID: <20150917083543.GC8220@elias>

Chaim,

Having read your report, I got in touch with the author of the said
report, mazin at mazinahmed.net, myself. He replied immediately.

I do not want to quote him, but his message boils down to Trustwave
responding to him with the information that Ryan has left Trustwave 
and that his successor will work on the findings.

We'll have to take this with a grain of salt, but honestly, 
transparency and responsibilities in ModSec and the Core Rules
project is a bit lacking from my point of view. I have no doubt things 
are very clear for you guys working at Trustwave; and it is likely all
the information is somewhere to be found. But what I would appreciate
a more moderation and an easier way to find the things you need.

Examples:
https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project
seems to be the website of the Core Rules. At least it is the number one
hit I get on google and duckduckgo.

It lists:
Project Leader: Ryan Barnett
Contributors:
    Josh Zlatin
    Roberto Salgado
    Ashar Javed (@soaj1664ashar)

But _you_ are not mentioned. Still you seem to handle things as this.
Do you have any authority to speak on behalf of the project? Is Ryan
still around in the project? Why was there no farewell message?

What is dearly missing is an email address to report security issues with the
Core Rules. I mean that would be the address I would be looking for
if I were a responsible security researcher with an exploit in my hands.

When you take the link to Github, you land on a repository with 
the last commit two years old. If you read the mailinglists you will
find, the development is actually happening, but it's now in the 3.0.0 branch
(where the last commit is 4 months old). Ryan forked the 3.0.0 branch in 2012, 
but it was first mentioned in the core rules mailinglist in July 2015. It's
probably my fault I did not check if there were any interesting branches
with the core rules in the meantime, but things would really be easier
if things would be more transparent.

I do not want to do fingerpointing. Even if it may seem so. I want to
make clear how things look from the outside for users as me, let alone someone 
new to ModSec or the Core Rules. Both are great projects and they could 
be better still (and actually attract contributions) if they were more 
accessible and transparent.

Best regards,

Christian


On Tue, Sep 15, 2015 at 01:23:18PM +0000, Chaim Sanders wrote:
> As far as I am aware we have not received anything. It certainly didn?t go
> to this mailing list and I don?t recall anything on
> security at modsecurity.org. I am be preparing a blog post where we analysis
> these attacks as we speak. Be on the lookout for it :)
> 
> On 9/15/15, 12:03 AM,
> "owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
> Christian Folini" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
> on behalf of christian.folini at time-machine.ch> wrote:
> 
> >Good morning,
> >
> >What is funny about the paper is, that he lists contact with all
> >the other vendors and how they reacted to his responsible
> >disclosure, but this is missing for ModSec.
> >
> >Has there been no contact / no interest to patch in due time?
> >
> >Ahoj,
> >
> >Christian
> >
> >
> >--
> >It's easier to ask forgiveness, than it is to get permission.
> >-- Radm Grace Hopper, aka Amazing Grace
> >
> >_______________________________________________
> >Owasp-modsecurity-core-rule-set mailing list
> >Owasp-modsecurity-core-rule-set at lists.owasp.org
> >http://scanmail.trustwave.com/?c=4062&d=vp331TYeSJtl4OUFeRwH_d8xwpzKptjDeB
> >Wj6-tsnQ&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
> >asp-modsecurity-core-rule-set
> 
> 
> ________________________________
> 
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

-- 
Christian Folini
Ringstrasse 2
CH-3639 Kiesen
+41 (0)31 301 60 71 (H)
+41 (0)79 220 23 76 (M)
mailto:christian.folini at netnea.com (Business)
mailto:christian.folini at time-machine.ch (Private)
http://www.christian-folini.ch


From christian.folini at time-machine.ch  Thu Sep 17 08:47:23 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Thu, 17 Sep 2015 10:47:23 +0200
Subject: [Owasp-modsecurity-core-rule-set] From 2.2.X to 3.0.0 (was: Re:
 Owasp-modsecurity-core-rule-set Digest, Vol 77, Issue 5)
In-Reply-To: <OZuFn.1700cc7425.000001d0efc9$dd13ed40$973bc7c0$@otherdata.com>
References: <mailman.11.1442318408.24537.owasp-modsecurity-core-rule-set@lists.owasp.org>
	<OZuFn.1700cc7425.000001d0efc9$dd13ed40$973bc7c0$@otherdata.com>
Message-ID: <20150917084723.GA8641@elias>

Hello,

On Tue, Sep 15, 2015 at 09:18:51AM -0600, OtherData wrote:
> I am also interested in why the 2.2.9 rule set is still considered the
> latest rule set, and 3.0 is not.  The 3.0 ruleset appears to be now bundled
> with cPanel which is confusing as to why they would bundle it with cPanel if
> it is not stable.

Has anybody made the transition from 2.2.x to 3.0.0 yet? 

I have a three digit number of services under my hands with several thousand 
tunings/ignore-rules. All tied to individual rule ids. This is really
a lot of work.

When the core rules consolidated the SQLi rules and combined this
transition with the removal of the commit history in the old subversion
repository (not exactly at the same moment, but close enough to
give us an updated core rule set with new rule ids but no commit 
history to link them to the old rule ids), we were in deep, deep shit.

The idea to revisit this tragedy gives me the creeps.

Therefore any war stories, reports or advice would be greatly appreciated.
I am willing to contribute on an advisory document describing the
best practice for the transition.

Ahoj,

Christian

-- 
Real knowledge is to know the extent of one's own ignorance.
-- Confucius

From ryan.barnett at owasp.org  Thu Sep 17 12:39:46 2015
From: ryan.barnett at owasp.org (Ryan Barnett)
Date: Thu, 17 Sep 2015 08:39:46 -0400
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and
 some thoughts why ModSec Core Rules users were hit on day 0)
In-Reply-To: <20150917083543.GC8220@elias>
References: <20150915040305.GA18940@elias>
	<D21D93C1.12822%csanders@trustwave.com>
	<20150917083543.GC8220@elias>
Message-ID: <426F3386-2987-421F-A76B-08497FE05F3B@owasp.org>

Christian,
You bring up many valid points and I thank you for pushing on these.  Here are some responses -
First and foremost ? both ModSecurity itself and the OWASP ModSecurity Core Rule Set (CRS) are open source projects.  Trustwave does not own either of them.  The only thing that Trustwave owns in the ?ModSecurity? trademark name.  The projects are Apache ASLv2 licensed.  These project will live and (hopefullly not) die dependent upon the community support.  The support that Trustwave gave to these projects over the years has been a double-edged sword in some respects.  Yes, we were allocated commercial work time to invest in these projects as they have commercial ModSecurity offerings to support ModSecurity.  This support, however, gave the appearance to the community that Trustwave would do all the work and that the community could basically just send emails or open issue tickets and wait for things to get fixed by SpiderLabs.  This misconception, I feel, has truly limited ModSecurity from fully blossoming into a vibrant open source community.
Speaking of me personally, as many of you know, I moved on from Trustwave Spiderlabs and joined the Akamai Threat Research Team where I now provide research for our cloud security products (including Kona WAF).  Referring to my previous point ? just because I switched jobs/companies does not preclude me from still working on these projects.  I am still the OWASP ModSecurity CRS Project Leader.  Not having Chaim listed on the OWASP Project page was an oversight and is now corrected (thanks for pointing that out).  The issue we have had in releasing these updates has mainly been because we have all been swamped with work from our day-jobs.  This is where having a real community driven project helps as there aren?t any bottle-necks to slow things down.  Community members can fork the CRS repo, update and initiate PULL requests and we can all move on.  To date, however, this workflow has not really blossomed.
As for security researchers responsibly reporting issues ? we have a number of places that list how to contact the team -
http://www.modsecurity.org/help.html
SecurityWe take security very seriously! If you need to report a security problem please write to security/modsecurity.org
Hope this info helps.

Ryan



From:  <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org> on behalf of Christian Folini
Date:  Thursday, September 17, 2015 at 4:35 AM
To:  Chaim Sanders
Cc:  "owasp-modsecurity-core-rule-set at lists.owasp.org"
Subject:  Re: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and some thoughts why ModSec Core Rules users were hit on day 0)

Chaim,

Having read your report, I got in touch with the author of the said
report, mazin at mazinahmed.net, myself. He replied immediately.

I do not want to quote him, but his message boils down to Trustwave
responding to him with the information that Ryan has left Trustwave 
and that his successor will work on the findings.

We'll have to take this with a grain of salt, but honestly, 
transparency and responsibilities in ModSec and the Core Rules
project is a bit lacking from my point of view. I have no doubt things 
are very clear for you guys working at Trustwave; and it is likely all
the information is somewhere to be found. But what I would appreciate
a more moderation and an easier way to find the things you need.

Examples:
https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project
seems to be the website of the Core Rules. At least it is the number one
hit I get on google and duckduckgo.

It lists:
Project Leader: Ryan Barnett
Contributors:
    Josh Zlatin
    Roberto Salgado
    Ashar Javed (@soaj1664ashar)

But _you_ are not mentioned. Still you seem to handle things as this.
Do you have any authority to speak on behalf of the project? Is Ryan
still around in the project? Why was there no farewell message?

What is dearly missing is an email address to report security issues with the
Core Rules. I mean that would be the address I would be looking for
if I were a responsible security researcher with an exploit in my hands.

When you take the link to Github, you land on a repository with 
the last commit two years old. If you read the mailinglists you will
find, the development is actually happening, but it's now in the 3.0.0 branch
(where the last commit is 4 months old). Ryan forked the 3.0.0 branch in 2012, 
but it was first mentioned in the core rules mailinglist in July 2015. It's
probably my fault I did not check if there were any interesting branches
with the core rules in the meantime, but things would really be easier
if things would be more transparent.

I do not want to do fingerpointing. Even if it may seem so. I want to
make clear how things look from the outside for users as me, let alone someone 
new to ModSec or the Core Rules. Both are great projects and they could 
be better still (and actually attract contributions) if they were more 
accessible and transparent.

Best regards,

Christian


On Tue, Sep 15, 2015 at 01:23:18PM +0000, Chaim Sanders wrote:
 As far as I am aware we have not received anything. It certainly didn?t go
 to this mailing list and I don?t recall anything on
 security at modsecurity.org. I am be preparing a blog post where we analysis
 these attacks as we speak. Be on the lookout for it :)
 
 On 9/15/15, 12:03 AM,
 "owasp-modsecurity-core-rule-set-bounces at lists.owasp.org on behalf of
 Christian Folini" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org
 on behalf of christian.folini at time-machine.ch> wrote:
 
 >Good morning,
 >
 >What is funny about the paper is, that he lists contact with all
 >the other vendors and how they reacted to his responsible
 >disclosure, but this is missing for ModSec.
 >
 >Has there been no contact / no interest to patch in due time?
 >
 >Ahoj,
 >
 >Christian
 >
 >
 >--
 >It's easier to ask forgiveness, than it is to get permission.
 >-- Radm Grace Hopper, aka Amazing Grace
 >
 >_______________________________________________
 >Owasp-modsecurity-core-rule-set mailing list
 >Owasp-modsecurity-core-rule-set at lists.owasp.org
 >http://scanmail.trustwave.com/?c=4062&d=vp331TYeSJtl4OUFeRwH_d8xwpzKptjDeB
 >Wj6-tsnQ&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
 >asp-modsecurity-core-rule-set
 
 
 ________________________________
 
 This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

-- 
Christian Folini
Ringstrasse 2
CH-3639 Kiesen
+41 (0)31 301 60 71 (H)
+41 (0)79 220 23 76 (M)
mailto:christian.folini at netnea.com (Business)
mailto:christian.folini at time-machine.ch (Private)
http://www.christian-folini.ch

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150917/4d49e835/attachment.html>

From CSanders at trustwave.com  Thu Sep 17 16:05:12 2015
From: CSanders at trustwave.com (Chaim Sanders)
Date: Thu, 17 Sep 2015 16:05:12 +0000
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and
 some thoughts why ModSec Core Rules users were hit on day 0)
In-Reply-To: <426F3386-2987-421F-A76B-08497FE05F3B@owasp.org>
References: <20150915040305.GA18940@elias>
	<D21D93C1.12822%csanders@trustwave.com> <20150917083543.GC8220@elias>
	<426F3386-2987-421F-A76B-08497FE05F3B@owasp.org>
Message-ID: <D22052C9.12A68%csanders@trustwave.com>

Hey Ryan, We miss you here :).
Christian, I?d like to reiterate what Ryan said and add some points here, although I should note that we are preparing a blog post on the topic of these recent evasions. In practice, the Trustwave team is very small, at this current time it is Felipe and Myself (although the size fluctuates). This means that we must split our time over things like dealing with ModSecurity bug fixes, developing new features for ModSecurity, working on the Core Rule Set, offering commercial support, answering the open source support, developing QA for the project, maintaining servers for the project, posting blogs on complex topics, maintaining information on the project, meetings (for the love of god meetings),  and maintaing the commercial rules that Trustwave offers (I think this is it but there is probably more). This is not meant as an excuse, you will see we?ve been working on some of these areas heavily. As always community support is always invited in the bulk of these areas.

In terms of help. We would LOVE help, and we?re more then willing to give access to repo?s/servers and such for individuals who show a commitment to the project, currently there are a only a limited number of people who frequently comment on the mailing list (yourself included, which we love? in this one case I?d like to call out h.reindl at thelounge.net for his particularly funny replies), let alone committing patches. If you think you would like to help with a particular area, such as updating information on various sites we?re more then happy to help with that and give you access to the desired areas, given that you?ve been around for at least a little bit :-P.

 So what are the future directions of ModSecurity from our perspective?
Well, the most important thing we?re working on right now is ModSecurity v3. Not only are we working on (Felipe has been committing pretty much daily for the past 4 months) it but it is almost ready for release. There are a couple main goals with this platform. The biggest is to deal with reliance that ModSecurity had on Apache (being developed originally for it). v3, also known as libmodsecurity is designed to act as a library with what we call connectors to web servers (that is, connectors will be built as web server modules that talk to the library). This approach should not only make it MUCH easier for new web server support to be added, but also fix a number of issues that have been plaguing ModSecurity regarding nginx support (see the issues list). Currently, the version we have can run 99% of the OWASP CRS 3.x ruleset with the rest expected to be functional within the next couple days.
The second thing we?ve been working on is the ModSecurity dashboard. While this has been in use for a few months, we spent a while focusing on its development. The dashboard allows individuals to maintain which rules get delivered to their ModSecurity instances via an easy to configure dashboard that will automatically push rules to ModSecurity instances by way of the new ?SecRemoteRules? directive.
In the backend we?ve also been doing lots of revamping of our testing process. In fact leading up to ModSecurity v3 we?ve created 1000?s of test cases which will finally ground the ModSecurity development process in a solid foundation. Coupled with this we?ve been building out our buildbot infrastructure for monitoring these test both externally (for build control) and internally for performance testing.
Obviously there have been other things from working with organizations to expand how ModSecurity is used across the web with various partners like CPanel and Kemp, to fundamentally changing the structure of the commercial rules we offer to make them more effective.
In closing you are undoubtedly right, we (contributors to ModSecurity) should attempt to communicate better what activities we are undertaking and where work can be directed. We are hoping to promote CRS 3.x to the master branch very soon (for reasons we have listed previously we have not) and also hoping that we can match that timing fairly closely with the general release of v3 (which is only developed for NGINX right now, but is wholly backwards compatible). Perhaps to address this concern each quarter we will start to undertake a 'state of ModSecurity? e-mail blast. What are your thoughts on how to increase communication?

From: Ryan Barnett <ryan.barnett at owasp.org<mailto:ryan.barnett at owasp.org>>
Date: Thursday, September 17, 2015 at 8:39 AM
To: Christian Folini <christian.folini at time-machine.ch<mailto:christian.folini at time-machine.ch>>, Chaim Sanders <csanders at trustwave.com<mailto:csanders at trustwave.com>>
Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>, "mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>" <mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>>
Subject: Re: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and some thoughts why ModSec Core Rules users were hit on day 0)

Christian,
You bring up many valid points and I thank you for pushing on these.  Here are some responses -

  *   First and foremost ? both ModSecurity itself and the OWASP ModSecurity Core Rule Set (CRS) are open source projects.  Trustwave does not own either of them.  The only thing that Trustwave owns in the ?ModSecurity? trademark name.  The projects are Apache ASLv2 licensed.  These project will live and (hopefullly not) die dependent upon the community support.  The support that Trustwave gave to these projects over the years has been a double-edged sword in some respects.  Yes, we were allocated commercial work time to invest in these projects as they have commercial ModSecurity offerings to support ModSecurity.  This support, however, gave the appearance to the community that Trustwave would do all the work and that the community could basically just send emails or open issue tickets and wait for things to get fixed by SpiderLabs.  This misconception, I feel, has truly limited ModSecurity from fully blossoming into a vibrant open source community.
  *   Speaking of me personally, as many of you know, I moved on from Trustwave Spiderlabs and joined the Akamai Threat Research Team where I now provide research for our cloud security products (including Kona WAF).  Referring to my previous point ? just because I switched jobs/companies does not preclude me from still working on these projects.  I am still the OWASP ModSecurity CRS Project Leader.  Not having Chaim listed on the OWASP Project page was an oversight and is now corrected (thanks for pointing that out).  The issue we have had in releasing these updates has mainly been because we have all been swamped with work from our day-jobs.  This is where having a real community driven project helps as there aren?t any bottle-necks to slow things down.  Community members can fork the CRS repo, update and initiate PULL requests and we can all move on.  To date, however, this workflow has not really blossomed.
  *   As for security researchers responsibly reporting issues ? we have a number of places that list how to contact the team -
     *   http://www.modsecurity.org/help.html<http://scanmail.trustwave.com/?c=4062&d=lrT61dMwAdx7hULPhvWaAY3mkk2rF9k3ozde_fhYqA&s=5&u=http%3a%2f%2fwww%2emodsecurity%2eorg%2fhelp%2ehtml>

Security        We take security very seriously! If you need to report a security problem please write to security/modsecurity.org
Hope this info helps.

Ryan



From: <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>> on behalf of Christian Folini
Date: Thursday, September 17, 2015 at 4:35 AM
To: Chaim Sanders
Cc: "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>"
Subject: Re: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and some thoughts why ModSec Core Rules users were hit on day 0)

Chaim,

Having read your report, I got in touch with the author of the said
report, mazin at mazinahmed.net<mailto:mazin at mazinahmed.net>, myself. He replied immediately.

I do not want to quote him, but his message boils down to Trustwave
responding to him with the information that Ryan has left Trustwave
and that his successor will work on the findings.

We'll have to take this with a grain of salt, but honestly,
transparency and responsibilities in ModSec and the Core Rules
project is a bit lacking from my point of view. I have no doubt things
are very clear for you guys working at Trustwave; and it is likely all
the information is somewhere to be found. But what I would appreciate
a more moderation and an easier way to find the things you need.

Examples:
https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project<http://scanmail.trustwave.com/?c=4062&d=lrT61dMwAdx7hULPhvWaAY3mkk2rF9k3ozBer_haqg&s=5&u=https%3a%2f%2fwww%2eowasp%2eorg%2findex%2ephp%2fCategory%3aOWASP%5fModSecurity%5fCore%5fRule%5fSet%5fProject>
seems to be the website of the Core Rules. At least it is the number one
hit I get on google and duckduckgo.

It lists:
Project Leader: Ryan Barnett
Contributors:
    Josh Zlatin
    Roberto Salgado
    Ashar Javed (@soaj1664ashar)

But _you_ are not mentioned. Still you seem to handle things as this.
Do you have any authority to speak on behalf of the project? Is Ryan
still around in the project? Why was there no farewell message?

What is dearly missing is an email address to report security issues with the
Core Rules. I mean that would be the address I would be looking for
if I were a responsible security researcher with an exploit in my hands.

When you take the link to Github, you land on a repository with
the last commit two years old. If you read the mailinglists you will
find, the development is actually happening, but it's now in the 3.0.0 branch
(where the last commit is 4 months old). Ryan forked the 3.0.0 branch in 2012,
but it was first mentioned in the core rules mailinglist in July 2015. It's
probably my fault I did not check if there were any interesting branches
with the core rules in the meantime, but things would really be easier
if things would be more transparent.

I do not want to do fingerpointing. Even if it may seem so. I want to
make clear how things look from the outside for users as me, let alone someone
new to ModSec or the Core Rules. Both are great projects and they could
be better still (and actually attract contributions) if they were more
accessible and transparent.

Best regards,

Christian


On Tue, Sep 15, 2015 at 01:23:18PM +0000, Chaim Sanders wrote:
As far as I am aware we have not received anything. It certainly didn?t go
to this mailing list and I don?t recall anything on
security at modsecurity.org<mailto:security at modsecurity.org>. I am be preparing a blog post where we analysis
these attacks as we speak. Be on the lookout for it :)
On 9/15/15, 12:03 AM,
"owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org> on behalf of
Christian Folini" <owasp-modsecurity-core-rule-set-bounces at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set-bounces at lists.owasp.org>
on behalf of christian.folini at time-machine.ch<mailto:christian.folini at time-machine.ch>> wrote:
>Good morning,
>
>What is funny about the paper is, that he lists contact with all
>the other vendors and how they reacted to his responsible
>disclosure, but this is missing for ModSec.
>
>Has there been no contact / no interest to patch in due time?
>
>Ahoj,
>
>Christian
>
>
>--
>It's easier to ask forgiveness, than it is to get permission.
>-- Radm Grace Hopper, aka Amazing Grace
>
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
>http://scanmail.trustwave.com/?c=4062&d=vp331TYeSJtl4OUFeRwH_d8xwpzKptjDeB
>Wj6-tsnQ&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fow
>asp-modsecurity-core-rule-set
________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

--
Christian Folini
Ringstrasse 2
CH-3639 Kiesen
+41 (0)31 301 60 71 (H)
+41 (0)79 220 23 76 (M)
mailto:christian.folini at netnea.com (Business)
mailto:christian.folini at time-machine.ch (Private)
http://www.christian-folini.ch<http://scanmail.trustwave.com/?c=4062&d=lrT61dMwAdx7hULPhvWaAY3mkk2rF9k3o2QD-atVrg&s=5&u=http%3a%2f%2fwww%2echristian-folini%2ech>

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set<http://scanmail.trustwave.com/?c=4062&d=lrT61dMwAdx7hULPhvWaAY3mkk2rF9k3o2FWpa0Oow&s=5&u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set>


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150917/7296fbb3/attachment-0001.html>

From christian.folini at time-machine.ch  Fri Sep 18 12:06:51 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Fri, 18 Sep 2015 14:06:51 +0200
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and
 some thoughts why ModSec Core Rules users were hit on day 0)
In-Reply-To: <D22052C9.12A68%csanders@trustwave.com>
References: <20150915040305.GA18940@elias>
	<D21D93C1.12822%csanders@trustwave.com>
	<20150917083543.GC8220@elias>
	<426F3386-2987-421F-A76B-08497FE05F3B@owasp.org>
	<D22052C9.12A68%csanders@trustwave.com>
Message-ID: <20150918120651.GA9112@elias>

Chaim, Ryan,

Thank you for your extensive and informative responses.

It goes without saying, that juggling that many plates
as you guys are doing will bring shifting priorities
and areas which are neglected. This is natural and we
are all only humans.

Your message reminded me of a business meeting I had
on Tuesday, where the bottleneck of a given process
stated he and his team were so buried in work, they
did not have the ressources to prepare tasks for us
to help them.

I get the same feeling with ModSecurity at times. Your
argumentation makes perfect sense, yet things look a
bit different from the user perspective. Forgive me for
pointing these issues out. It's really not meant as an
offence. It's more an attempt to help you understand
why people like me stand at the sidelines, suffering from
a bad conscience for not supporting you as you deserve.
Meanwhile you fight a lonely battle feeling lost with
all the tickets and requests.

So Trustwave is in a similar position as Breach 
or Ivan Risti? on his own before. Ivan used to blame
it on him picking the GPL license while you guys
shifted to the Apache Licence. But this did not really
change the situation.

Yes, it's Apache Licenced and Trustwave only has the
trademark. But in fact there is a fat Copyright
by Trustwave in all the files I checked for this message.

https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/v3.0.0-dev/rules/REQUEST-42-APPLICATION-ATTACK-SQLI.conf
https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_21_protocol_anomalies.conf
https://github.com/SpiderLabs/ModSecurity/blob/master/apache2/modsecurity.c

So Trustwave does commercial support and commercial rules
and it claims the copyright. I do commercial ModSecurity
support and I write rules for a living. So working on
a project where somebody else claims the copyright makes
me feel a bit uneasy.

The Core Rules Project has been transferred to OWASP, which
I think has been a good move. Unfortunately, it did not
bring a vibrant community around it. Attempts to
document existing rules faltered quickly. 
Again, it seems to me the that the core rules are still
very much meant to be a Trustwave / SpiderLabs thing.
Rightly so, you do almost all of the work, but it gives
an exclusive feeling to the community and by exclusive
I mean without us.

But there is a 2nd issue, which I think is very difficult
with pull requests. These are heavily optimised regexes.

Honestly, I am in no position to submit a pull request
to update something like this:
"(?:\((?:\W*?(?:objectc(?:ategory|lass)|homedirectory|[gu]idnumber|cn)\b\W*?=|[^\w\x80-\xFF]*?[\!\&\|][^\w\x80-\xFF]*?\()|\)[^\w\x80-\xFF]*?\([^\w\x80-\xFF]*?[\!\&\|])"

Disassembling it and trying to understand it, would take
me the better part of an hour and I lack the deep
knowledge of the real world http traffic (Honey Pot Project!)
to tell legitimate from attack traffic.

It looks like the 3.0.0 ruleset would be easier to read/understand.
But without a more detailed description of what a given
rule does and how it means to achieve this, it is very hard
to contribute.

In fact I have a few items, which I thought to contribute
to the core rule for some time now. But then life hit me
and I postponed it again and again.

A lot of information is in fact available, but it is spread
over too many sites. Some interlinked, some not. What I
think is missing are the classic contribution / todo
files what accompany other open source projects. There
is developer info on www.modsecurity.org, but it is not
very inviting, I think (and I think it should be) and
there is nothing to be read about the plans Chaim explained
in his message.

I had my doubts if Apache was still a first class platform
for ModSecurity and now I read for the first time black on
white that nginx is now the first class passenger. But that's
only a sidenote to underline the point, that it is very hard
to support you, if we do not know where the train is supposed
to be heading.

Other things just do not seem to work. There are issues and
patches which go unacknowledged. Requests for explanations
or more documentation are sent in vain:
 
https://github.com/SpiderLabs/ModSecurity/pull/840
https://github.com/SpiderLabs/ModSecurity/issues/849
http://sourceforge.net/p/mod-security/mailman/message/30918751/

I mean I am a very weak coder and it takes me ages to
nail down an issue. Taking me by the hand and leading me
to the next bug to tackle could actually encourage
me to invest more time. Ignoring a pull request on the
other hand is disappointing.

But as I said, this is not meant to be a fingerpointing message. You
listed all your tasks and duties and responding to a pull request,
nobody else from the community seems to be interested in, does not have
top priority. Given your tasklist, it is beyond imagination to fulfill
all the demands from all sides.  I understand that. It's just not going
to change the situation of you fighting a lonely battle.

There is this video about the leadership lessons of the
dancing guy. Give it a shot if you do not know it. Especially
the comment of the sociologist are right to the point:
https://www.youtube.com/watch?v=fW8amMCVAJQ

@Chaim: Your announcement of a regular message about the
state and the direction of ModSec would be much appreciated.

Me getting involved with certain aspects and sites, could be
an option. What do you have in mind?

Thank you for all your good work. It is much appreciated. So
much, I built a living around Apache and ModSecurity. I no
longer attend international conferences, but I still do many
local talks about successful ModSecurity installations and
I am still thrilled, whenever I get to write cool new rules
(like yesterday, where I was able to create something
really neat). This all would not be possible without you
sitting down and working on ModSecurity every day.

Best,

Christian


-- 
It ought to be remembered that there is nothing more difficult to
take in hand, more perilous to conduct, or more uncertain in its
success, than to take the lead in the introduction of a new order of
things.
--- Niccol? Machiavelli

From christian.folini at time-machine.ch  Fri Sep 18 18:30:47 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Fri, 18 Sep 2015 20:30:47 +0200
Subject: [Owasp-modsecurity-core-rule-set] Some XSS evasions posted (and
 some thoughts why ModSec Core Rules users were hit on day 0)
In-Reply-To: <D22052C9.12A68%csanders@trustwave.com>
References: <20150915040305.GA18940@elias>
	<D21D93C1.12822%csanders@trustwave.com>
	<20150917083543.GC8220@elias>
	<426F3386-2987-421F-A76B-08497FE05F3B@owasp.org>
	<D22052C9.12A68%csanders@trustwave.com>
Message-ID: <20150918183047.GA15027@elias>

Chaim, 

There was a thing I forgot to highlight.

On Thu, Sep 17, 2015 at 04:05:12PM +0000, Chaim Sanders wrote:
> In the backend we?ve also been doing lots of revamping of our testing process. In fact leading up to ModSecurity v3 we?ve created 1000?s of test cases which will finally ground the ModSecurity development process in a solid foundation. Coupled with this we?ve been building out our buildbot infrastructure for monitoring these test both externally (for build control) and internally for performance testing.

I think this is a wonderful achievement and a very good
use of your and Felipe's time.

Cheers,

Christian


-- 
Real knowledge is to know the extent of one's own ignorance.
-- Confucius

From christian.folini at time-machine.ch  Mon Sep 21 12:26:41 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Mon, 21 Sep 2015 14:26:41 +0200
Subject: [Owasp-modsecurity-core-rule-set] CRS v3.0.0-dev: Pull Request 255:
 Header Injection / More Request Smuggling
Message-ID: <20150921122641.GA29606@elias>

Dear all,

After last week's complaints, it seems only fair and suitable to
follow up and contribute to the project. Here we go with something
that has been in my drawer for too long.

The core rules have strong sides and weaker spots. One spot that I think is not
very well developed is the whole http request splitting and header injection
field. I have been bitten twice and decided to act and develop a set of new
rules that would cover this attack vector in a generic way with the goal
to bring these rules into the core rules.

Achim Hoffmann joined me on this little project and while I coordinated
a big test run, he wrote most of the rules / regular expressions.

A generic attack / a prepared link which will result in a transparent
redirect to an evil site in case the handler action.do is vulnerable.
https://www.example.com/smartapp/action.do?param1=file&file=foo.txt%0D%0ARefresh:%201;%20url=http://www.evilsite.com&file_type=txt

This may sound foolish, but I have had two customers falling for
this sort of weakness.

In the stable Core-Rules, ModSecurity will only trigger
981173 : Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded
In fact this rule is a false positive, as this is no SQL injection
going on, but at least it gave us a hint something is amiss.
981173 will result in a score of 5 points. In many if not most
installations, a score of 5 is below the threshold / limit
defined and the attack will thus pass the WAF.

In the v3.0.0 dev branch, things are not much better with
950907 Remote Command Execution (RCE) Attempt 
bring triggered.

The attack does a CR/LF and then brings an http response header.
Both in a query string to be sent as part of a request. This should
be quite easy to detect actually, and I think it can be done in a
very generic way. Detecting and blocking results in a successful
mitigation of the attack.

So this pull request vs. v.3.0.0-dev extends the existing protocol
attacks, that are listed in REQUEST-21-PROTOCOL-ATTACK.conf. In fact
the existing 3 rules are fairly similar to the new ones I am proposing
together with Achim, so there is a fair bit of redundancy (which adds
to the score, which makes blocking all the more likely).

Please see 
https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/255
for the rules, more detailed description and an assessment of the
false positive rates for the various rules. 4 of them do quite OK
in this regard. 950917 has a different milage though. It brings far
more false positives and pushing it into an area of optional paranoid
qould make sense, I guess.

I would appreciate, if you could review the pull request and
include it in the dev version 3.0.0. Obviously, I am open to
update the rules, if you have any suggestions.

Best regards,

Christian Folini


-- 
It's when they say 2 + 2 = 5 that I begin to argue.
-- Eric Pepke

From christian.folini at time-machine.ch  Wed Sep 23 13:36:30 2015
From: christian.folini at time-machine.ch (Christian Folini)
Date: Wed, 23 Sep 2015 15:36:30 +0200
Subject: [Owasp-modsecurity-core-rule-set] A Set of Performance Rules
Message-ID: <20150923133630.GC31766@elias>

Hello,

Chaim was kind enough to merge Achim's and my set of Header 
Injection Prevention rules into the v3.0.0-branch.

This was smooth, so let's try the process with a 2nd little set of
rules, which I use at time.

It's a set of performance rules, that do some measuring at different
phases and prepare the info into variables, which can then be logged.

It's more detailed then Stopwatch2 in the audit-log and the data is
prepared to be pushed into the access-log (or whatever you call it for
non-apache httpd servers).

For the 2.2.x ruleset, this would fit into the optional_rules folder,
but I am not sure about the right course of action for v3.0.0-dev.

Do you plan to include an optional_rules folder eventually, or would
you rather define a switch in modsecurity_crs_10_setup.conf.example,
which would then enable/disable the ruleset in two files like
rules/REQUEST-00-0-PERFORMANCE-START.conf
rules/RESPONSE-99-9-PERFORMANCE-END.conf
?

Ahoj,

Christian


-- 
Chains of habit are too light to be felt until they are too heavy
to be broken.       ?
-- Warren Buffett

From ilyassikai at gmail.com  Tue Sep 29 16:09:56 2015
From: ilyassikai at gmail.com (Ilyass Kaouam)
Date: Tue, 29 Sep 2015 17:09:56 +0100
Subject: [Owasp-modsecurity-core-rule-set] =?utf-8?q?Probl=C3=A8me_with_fr?=
	=?utf-8?q?ensh_word?=
Message-ID: <CAMmziWcN8vPmpVNrYCcHq9x4jZgfwgEJvX-z==CDTJsyfY+mog@mail.gmail.com>

Hello,

Modsecurity block this string :


"Au clic sur l?icone du document, tout fonctionne correctement.

Par contre au clic sur le lien texte (le curseur devient cliquable), une
page d?erreur s?ouvre.

Supprimer la possibilit? de cliquer sur le lien texte. Conserver uniquement
le clic sur l?icone.

Je n?ai pas pu tester la fonctionnalit? avec le User Test Douane car il n?y
a pas de documents r?cents. Ce bug provient des tests effectu?s par la
Douane."

log :


Message: Rule b7a846ac5e0 [id "981173"][file
"/etc/httpd/crs/owasp-modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"][line
"159"] - Execution error - PCRE limits exceeded (-8): (null).

Message: Access denied with code 403 (phase 2). Pattern match
"(?i:(?:,.*?[)\\da-f\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98][\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98](?:[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98].*?[\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]|\\Z|[^\"'`\xc2\xb4\xe2\x80\x99\xe2\x80\x98]+))|(?:\\Wselect.+\\W*?from)|((?
..." at ARGS:description. [file
"/etc/httpd/crs/owasp-modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"]
[line "209"] [id "981257"] [msg "Detects MySQL comment-/space-obfuscated
injections and backtick termination"] [data "Matched Data: , tout
fonctionne correctement.\x0d\x0aPar contre au clic sur le lien texte (le
curseur devient cliquable), une page d\xe2\x80\x99 found within
ARGS:description: Au clic sur l\xe2\x80\x99icone du document, tout
fonctionne correctement.\x0d\x0aPar contre au clic sur le lien texte (le
curseur devient cliquable), une page d\xe2\x80\x99erreur
s\xe2\x80\x99ouvre.\x0d\x0aSupprimer la possibilit\xc3\xa9 de cliquer sur
le lien texte. Conserver uniquement le c

Action: Intercepted (phase 2)

?Can you help me please?
? ?
Thank you.?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150929/583422fe/attachment.html>

