<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] few questions in regards to rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20few%20questions%20in%20regards%20to%0A%20rules&In-Reply-To=CAN%2BtBVNHxiqsN3LF30aXFL6Q%3D6hsVreMbm7JjCaG8pmycOYokw%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000937.html">
   <LINK REL="Next"  HREF="000939.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] few questions in regards to rules</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20few%20questions%20in%20regards%20to%0A%20rules&In-Reply-To=CAN%2BtBVNHxiqsN3LF30aXFL6Q%3D6hsVreMbm7JjCaG8pmycOYokw%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] few questions in regards to rules">RBarnett at trustwave.com
       </A><BR>
    <I>Thu Dec  8 16:25:58 EST 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000937.html">[Owasp-modsecurity-core-rule-set] few questions in regards to rules
</A></li>
        <LI>Next message: <A HREF="000939.html">[Owasp-modsecurity-core-rule-set] few questions in regards to	rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#938">[ date ]</a>
              <a href="thread.html#938">[ thread ]</a>
              <a href="subject.html#938">[ subject ]</a>
              <a href="author.html#938">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>

On 12/6/11 9:31 PM, &quot;Tzury Bar Yochay&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">tzury.by at reguluslabs.com</A>&gt; wrote:

&gt;<i>While going through rule files i have gathered few questions which I
</I>&gt;<i>will appreciate if someone can help me with them.
</I>&gt;<i>
</I>&gt;<i>1) I have seen several cases where setvar is stated without the right
</I>&gt;<i>part, e.g.
</I>&gt;<i>
</I>&gt;<i>        SecRule TX:'/MISSING_HEADER_/' &quot;TX\:(.*)&quot;
</I>&gt;<i>&quot;capture,t:none,setvar:!tx.%{tx.1}&quot;
</I>&gt;<i>
</I>&gt;<i>   I wonder what it means, as normally, set is in the form of x = y,
</I>&gt;<i>and not x, or !x in this case.
</I>
This is the syntax to remove a TX variable entirely.

&gt;<i>
</I>&gt;<i>2) There seems to be a typo at line:
</I>&gt;<i>
</I>&gt;<i>        SecRule REQUEST_LINE &quot;^GET /$&quot;
</I>&gt;<i>&quot;chain,phase:2,id:981020',t:none,pass,nolog&quot;
</I>&gt;<i>
</I>&gt;<i>    There is a trailing apostrophe (') after the id
</I>
There actually should have been a single quote at the beginning of the id
data like this - id:'981020'.  I fixed it locally and it will be updated
in SNV soon.


&gt;<i>
</I>&gt;<i>3) Few days ago I asked the following question but yet not got answer for
</I>&gt;<i>    When I see a rule such as
</I>&gt;<i>
</I>&gt;<i>        SecRule ARGS:&amp;category &quot;(?i:SELECT.+FROM)&quot;
</I>&gt;<i>&quot;ctl:auditLogParts=+...&quot;
</I>&gt;<i>
</I>&gt;<i>    I wonder what is the role of the ampersand, before the category, so
</I>&gt;<i>    far I know, '&amp;' means counting operatoration and usually, it follows
</I>&gt;<i>    by a numeric operation, e.g. @eq, @ge and alike.
</I>&gt;<i>
</I>&gt;<i>    However, this is a case where I see &amp; which followed by an implicit
</I>&gt;<i>'@rx'
</I>
This was a bug in the snort2modsec.pl script.  The &amp; should have been
removed when creating the SecRule.  I will take a look.

-Ryan

&gt;<i>
</I>&gt;<i>
</I>&gt;<i>Thanks in advance for your help,
</I>&gt;<i>Tzury
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000937.html">[Owasp-modsecurity-core-rule-set] few questions in regards to rules
</A></li>
	<LI>Next message: <A HREF="000939.html">[Owasp-modsecurity-core-rule-set] few questions in regards to	rules
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#938">[ date ]</a>
              <a href="thread.html#938">[ thread ]</a>
              <a href="subject.html#938">[ subject ]</a>
              <a href="author.html#938">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
