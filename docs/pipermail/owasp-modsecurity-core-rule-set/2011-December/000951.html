<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] a question about rules 981173 as	an example (and others alike)
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20a%20question%20about%20rules%20981173%0A%20as%09an%20example%20%28and%20others%20alike%29&In-Reply-To=%3C1163F571-9CC0-4969-8AE8-0E3EB9F045A9%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000949.html">
   <LINK REL="Next"  HREF="000952.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] a question about rules 981173 as	an example (and others alike)</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20a%20question%20about%20rules%20981173%0A%20as%09an%20example%20%28and%20others%20alike%29&In-Reply-To=%3C1163F571-9CC0-4969-8AE8-0E3EB9F045A9%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] a question about rules 981173 as	an example (and others alike)">RBarnett at trustwave.com
       </A><BR>
    <I>Mon Dec 19 22:26:06 UTC 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000949.html">[Owasp-modsecurity-core-rule-set] a question about rules 981173 as	an example (and others alike)
</A></li>
        <LI>Next message: <A HREF="000952.html">[Owasp-modsecurity-core-rule-set] a question about rules 981173 as an example (and others alike)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#951">[ date ]</a>
              <a href="thread.html#951">[ thread ]</a>
              <a href="subject.html#951">[ subject ]</a>
              <a href="author.html#951">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The purpose of that rule is to identify repeated meta characters in a row (at least 4).  We developed this rule based on analysis of evasion methods of basic filters.

The example you gave did he 2 meta characters (&lt; and &gt;) however they were repetitive.

Ryan

On Dec 19, 2011, at 10:12 AM, &quot;Tzury Bar Yochay&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">tzury.by at reguluslabs.com</A>&gt; wrote:

&gt;<i> The rule is as follows:
</I>&gt;<i>
</I>&gt;<i> SecRule ARGS_NAMES|ARGS|XML:/*
</I>&gt;<i> &quot;([\~\!\@\#\$\%\^\&amp;\*\(\)\-\+\=\{\}\[\]\|\:\;\&quot;\'\&#180;\&#8217;\&#8216;\`\&lt;\&gt;].*){4,}&quot;
</I>&gt;<i> &quot;phase:2,t:none,t:urlDecodeUni,block,id:'981173',rev:'2.2.2',msg:'Restricted
</I>&gt;<i> SQL Character Anomaly Detection Alert - Total # of special characters
</I>&gt;<i> exceeded',capture,logdata:'%{tx.1}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.sql_injection_score=+1,setvar:'tx.msg=%{rule.msg}',setvar:tx.%{rule.id}-WEB_ATTACK/RESTRICTED_SQLI_CHARS-%{matched_var_name}=%{tx.0}&quot;
</I>&gt;<i>
</I>&gt;<i> This seemed should match request such as /?a=&lt;script&gt;
</I>&gt;<i>
</I>&gt;<i> Question is, is this by design?
</I>&gt;<i> Shall I enable by default such restricting rules?
</I>&gt;<i> Should there I expect legitimate user input escaped somehow differently?
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ------8&lt;------ my pcre matching test case below ------8&lt;------
</I>&gt;<i>
</I>&gt;<i> Lua 5.1.4  Copyright (C) 1994-2008 Lua.org, PUC-Rio
</I>&gt;&gt;<i> require &quot;rex_pcre&quot;
</I>&gt;&gt;<i> return rex_pcre.new([====[([\~\!\@\#\$\%\^\&amp;\*\(\)\-\+\=\{\}\[\]\|\:\;\&quot;\'\&#180;\&#8217;\&#8216;\`\&lt;\&gt;].*){4,}]====]):exec(&quot;&lt;script&gt;&quot;)
</I>&gt;<i> 1       14      table: 0x907d80
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000949.html">[Owasp-modsecurity-core-rule-set] a question about rules 981173 as	an example (and others alike)
</A></li>
	<LI>Next message: <A HREF="000952.html">[Owasp-modsecurity-core-rule-set] a question about rules 981173 as an example (and others alike)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#951">[ date ]</a>
              <a href="thread.html#951">[ thread ]</a>
              <a href="subject.html#951">[ subject ]</a>
              <a href="author.html#951">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
