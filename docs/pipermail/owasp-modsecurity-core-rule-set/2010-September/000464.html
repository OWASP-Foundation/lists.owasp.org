<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Integration with mod_headers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Integration%20with%20mod_headers&In-Reply-To=C8A43461.13790%25rbarnett%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000463.html">
   <LINK REL="Next"  HREF="000465.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Integration with mod_headers</H1>
    <B>mailing lists</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Integration%20with%20mod_headers&In-Reply-To=C8A43461.13790%25rbarnett%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Integration with mod_headers">lists at c22.cc
       </A><BR>
    <I>Thu Sep  2 10:01:32 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000463.html">[Owasp-modsecurity-core-rule-set] Integration with mod_headers
</A></li>
        <LI>Next message: <A HREF="000465.html">[Owasp-modsecurity-core-rule-set] CRS configuration files questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#464">[ date ]</a>
              <a href="thread.html#464">[ thread ]</a>
              <a href="subject.html#464">[ subject ]</a>
              <a href="author.html#464">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi,

Thanks for the pointer. I was looking at that very post last night in order
to find possible solutions. Looks like I missed the most important part
though (the env=http_cookie at the end of the header line). I'll take
another stab at this tonight and hopefully get it working as desired.

Thanks for the quick reply.

Chris

On Wed, Sep 1, 2010 at 10:48 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;wrote:

&gt;<i> On 9/1/10 4:45 PM, &quot;Chris John Riley&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">lists at c22.cc</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;<i> &gt; Hi,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Apologies if this has already been covered, but I'm trying to use
</I>&gt;<i> mod_headers
</I>&gt;<i> &gt; to set an additional cookie value based on the results of a mod_security
</I>&gt;<i> &gt; SecRule. I've tried a number of things, including skip/skipAfter, but
</I>&gt;<i> nothing
</I>&gt;<i> &gt; seems to work for some reason.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Example:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;   SecRule RESPONSE_STATUS &quot;^[345]&quot; &quot;phase:3,skip:1&quot;
</I>&gt;<i> &gt;   header add Set-Cookie &quot;Test=1&quot;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Any ideas how I can achieve the desired result (setting a cookie only on
</I>&gt;<i> a 200
</I>&gt;<i> &gt; status). It's probably something simple, but darned if I can find it!
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; Thanks, and sorry for the noob question.
</I>&gt;<i> &gt;
</I>&gt;<i>
</I>&gt;<i> Hey Chris,
</I>&gt;<i> Take a look at this previous blog post that I did which is somewhat related
</I>&gt;<i> (having ModSecurity interact with mod_headers) to choose which to fix
</I>&gt;<i> outbound set-cookie sessionids that are missing the httponly cookie flag.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl">http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl</A>
</I>&gt;<i> ag.html&lt;<A HREF="http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl%0Aag.html">http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl%0Aag.html</A>&gt;
</I>&gt;<i>
</I>&gt;<i> Basically you just need to have modsec set and ENV varaible (with the
</I>&gt;<i> setenv
</I>&gt;<i> action) so that Apache can read it and then conditionally use the header
</I>&gt;<i> directive if that ENV token is set.
</I>&gt;<i>
</I>&gt;<i> Hope that helps,
</I>&gt;<i> Ryan
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>

-- 
--
&#8226; Chris John Riley &#8226;
&#8226; <A HREF="http://blog.c22.cc">http://blog.c22.cc</A> &#8226;
--
------------------------------------------
All emails ROT-26 encrypted
------------------------------------------
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100902/f1c85b83/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100902/f1c85b83/attachment.html</A> 
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000463.html">[Owasp-modsecurity-core-rule-set] Integration with mod_headers
</A></li>
	<LI>Next message: <A HREF="000465.html">[Owasp-modsecurity-core-rule-set] CRS configuration files questions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#464">[ date ]</a>
              <a href="thread.html#464">[ thread ]</a>
              <a href="subject.html#464">[ subject ]</a>
              <a href="author.html#464">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
