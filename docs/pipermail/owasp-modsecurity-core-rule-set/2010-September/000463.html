<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Integration with mod_headers
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Integration%20with%20mod_headers&In-Reply-To=CA4598F4-07D8-4481-9299-26888C411CDD%40c22.cc">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000462.html">
   <LINK REL="Next"  HREF="000464.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Integration with mod_headers</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Integration%20with%20mod_headers&In-Reply-To=CA4598F4-07D8-4481-9299-26888C411CDD%40c22.cc"
       TITLE="[Owasp-modsecurity-core-rule-set] Integration with mod_headers">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Sep  1 16:48:33 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000462.html">[Owasp-modsecurity-core-rule-set] Integration with mod_headers
</A></li>
        <LI>Next message: <A HREF="000464.html">[Owasp-modsecurity-core-rule-set] Integration with mod_headers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#463">[ date ]</a>
              <a href="thread.html#463">[ thread ]</a>
              <a href="subject.html#463">[ subject ]</a>
              <a href="author.html#463">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 9/1/10 4:45 PM, &quot;Chris John Riley&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">lists at c22.cc</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i> 
</I>&gt;<i> Apologies if this has already been covered, but I'm trying to use mod_headers
</I>&gt;<i> to set an additional cookie value based on the results of a mod_security
</I>&gt;<i> SecRule. I've tried a number of things, including skip/skipAfter, but nothing
</I>&gt;<i> seems to work for some reason.
</I>&gt;<i> 
</I>&gt;<i> Example:
</I>&gt;<i> 
</I>&gt;<i>   SecRule RESPONSE_STATUS &quot;^[345]&quot; &quot;phase:3,skip:1&quot;
</I>&gt;<i>   header add Set-Cookie &quot;Test=1&quot;
</I>&gt;<i> 
</I>&gt;<i> Any ideas how I can achieve the desired result (setting a cookie only on a 200
</I>&gt;<i> status). It's probably something simple, but darned if I can find it!
</I>&gt;<i> 
</I>&gt;<i> Thanks, and sorry for the noob question.
</I>&gt;<i> 
</I>
Hey Chris,
Take a look at this previous blog post that I did which is somewhat related
(having ModSecurity interact with mod_headers) to choose which to fix
outbound set-cookie sessionids that are missing the httponly cookie flag.

<A HREF="http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl">http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl</A>
ag.html

Basically you just need to have modsec set and ENV varaible (with the setenv
action) so that Apache can read it and then conditionally use the header
directive if that ENV token is set.

Hope that helps,
Ryan


</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000462.html">[Owasp-modsecurity-core-rule-set] Integration with mod_headers
</A></li>
	<LI>Next message: <A HREF="000464.html">[Owasp-modsecurity-core-rule-set] Integration with mod_headers
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#463">[ date ]</a>
              <a href="thread.html#463">[ thread ]</a>
              <a href="subject.html#463">[ subject ]</a>
              <a href="author.html#463">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
