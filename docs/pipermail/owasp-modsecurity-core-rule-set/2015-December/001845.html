<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Comparing%202.2.9%20and%203.0.0-dev&In-Reply-To=%3CDM2PR07MB416F40D27E9A329A478C3EFDBE40%40DM2PR07MB416.namprd07.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001844.html">
   <LINK REL="Next"  HREF="001846.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev</H1>
    <B>Chaim Sanders</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Comparing%202.2.9%20and%203.0.0-dev&In-Reply-To=%3CDM2PR07MB416F40D27E9A329A478C3EFDBE40%40DM2PR07MB416.namprd07.prod.outlook.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev">CSanders at trustwave.com
       </A><BR>
    <I>Mon Dec 21 13:40:13 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001844.html">[Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev
</A></li>
        <LI>Next message: <A HREF="001846.html">[Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1845">[ date ]</a>
              <a href="thread.html#1845">[ thread ]</a>
              <a href="subject.html#1845">[ subject ]</a>
              <a href="author.html#1845">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Christian,
Thanks for the awesome breakdown!
We've really seen some of the older issues rear some nasty levels of false positives which as you noted was the reason behind many of these. However, based on your findings I'm open to including a more false-positive prone file that is maybe only anomaly based featuring some of the rules that have been taken out. (we've been talking about this already). There are other options also (see below)
Additionally I have it on my list to defang 950907 just a bit as its EXTEREMLY overzealous.
I'm surprised about the XSS rules as most of them were combined into single regex's (for speed reasons) I'll have to take a look
We feel your concern about LibInjection but the concept seems to work and is used currently by a number of major WAF's. We can work with the author on a code review if this is something we want to prioritize.
In terms of the 990012, I think this is something we should probably be able to add back, I'll submit a pull request sometime this week.

Thoughts from you, others?
Do you think the false-positives file is the best way to handle it or do you think these belong in their respective files with a HUGE warning. The last thing we want is people complaining about false positives and eliminating those three rules has gone a LONG way. I think putting them in anomaly only isn't a horrible idea, I'm glad you did a look at anomaly scoring, this is always a little bit of a dark art. On the new one in some places we've set it up we bumped it up to 7 but it is usually below 10. Also there are now multiple different anon scoring areas.

We should resolve this quickly as I'd like to try and have an RC1 of 3.x by mid-February. Thoughts on that as well.



Chaim Sanders
Security Researcher, SpiderLabs

Trustwave |&#160;SMART SECURITY ON DEMAND
www.trustwave.com

-----Original Message-----
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>] On Behalf Of Christian Folini
Sent: Monday, December 21, 2015 12:34 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: [Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev

Dear all,

The CRS 3.0.0-dev is in the making bringing a lot of new features and new rules. I tried to understand the differences and wrote a blog post about it.

<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=2JX31uvfAV09c2P0_qCM5MP7s2dUhDPQ0reFkp-Msg&amp;s=5&amp;u=https%3a%2f%2fwww%2enetnea%2ecom%2fcms%2f2015%2f12%2f20%2fmodsec-crs-2-2-x-vs-3-0-0-dev%2f">http://scanmail.trustwave.com/?c=4062&amp;d=2JX31uvfAV09c2P0_qCM5MP7s2dUhDPQ0reFkp-Msg&amp;s=5&amp;u=https%3a%2f%2fwww%2enetnea%2ecom%2fcms%2f2015%2f12%2f20%2fmodsec-crs-2-2-x-vs-3-0-0-dev%2f</A>

If you are using the core rules, this will interest you. There are nice new rules, but based on my tests, it looks like we are also losing a lot of alerts.

I would love to have your feedback on this. Ideally here on the mailinglist, but feel free to ping me via mail or twitter.

Christian Folini, @ChrFolini


--
Seek simplicity, and distrust it.
-- Alfred North Whitehead
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
<A HREF="http://scanmail.trustwave.com/?c=4062&amp;d=2JX31uvfAV09c2P0_qCM5MP7s2dUhDPQ0uDTycuMvw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set">http://scanmail.trustwave.com/?c=4062&amp;d=2JX31uvfAV09c2P0_qCM5MP7s2dUhDPQ0uDTycuMvw&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2fowasp-modsecurity-core-rule-set</A>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001844.html">[Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev
</A></li>
	<LI>Next message: <A HREF="001846.html">[Owasp-modsecurity-core-rule-set] Comparing 2.2.9 and 3.0.0-dev
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1845">[ date ]</a>
              <a href="thread.html#1845">[ thread ]</a>
              <a href="subject.html#1845">[ subject ]</a>
              <a href="author.html#1845">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
