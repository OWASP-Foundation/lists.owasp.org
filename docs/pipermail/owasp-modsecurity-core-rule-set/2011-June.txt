From RBarnett at trustwave.com  Fri Jun  3 11:44:12 2011
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Fri, 3 Jun 2011 10:44:12 -0500
Subject: [Owasp-modsecurity-core-rule-set] Fingerprint Sharing Alliance for
	ModSecurity Users
Message-ID: <CA0E798C.27E81%rbarnett@trustwave.com>

I wanted to run an idea past the community to see if there would be enough interest in pursing this concept further.  Please refer to this project by Arbor Networks - http://www.arbornetworks.com/fingerprint-sharing-alliance.html

This is the key description paragraph -

"Attack resolution requires real-time cooperation and coordination between service providers to identify a compromised or infected system as close to the absolute Internet ingress as possible. The community of service providers that are participating in the Fingerprint Sharing Alliance will be sharing cyber attack profiles, or "fingerprints" to stop attacks more quickly and closer to the source. This is the first time worldwide telecommunications companies have been able to share attack profiles automatically, allowing providers to consistently protect one another and their customers from today's distributed threats."

What I am interested in doing it creating an automated method for users to submit "fingerprints" of malicious attacks they have seen on their sites so that other ModSecurity users can quickly download those rules and use them to protect their sites.  I don't want to dive too deep into the technical details of "how" at this point.

What I want to know is the following -

 1.  Is this something that you would use?
 2.  Is this something that you would participate in by submitting fingerprints?

Please respond to this email thread if you are interested in this concept.  If we get a good response, we will proceed with development and work with the community on details.

Thanks,
Ryan

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From yersinia.spiros at gmail.com  Fri Jun  3 11:55:49 2011
From: yersinia.spiros at gmail.com (yersinia)
Date: Fri, 3 Jun 2011 17:55:49 +0200
Subject: [Owasp-modsecurity-core-rule-set] Fingerprint Sharing Alliance
 for ModSecurity Users
In-Reply-To: <CA0E798C.27E81%rbarnett@trustwave.com>
References: <CA0E798C.27E81%rbarnett@trustwave.com>
Message-ID: <BANLkTin2KUkLtJPh4y6gRu3Tex4mWZrdEA@mail.gmail.com>

On Fri, Jun 3, 2011 at 5:44 PM, Ryan Barnett <RBarnett at trustwave.com> wrote:

> I wanted to run an idea past the community to see if there would be enough
> interest in pursing this concept further.  Please refer to this project by
> Arbor Networks -
> http://www.arbornetworks.com/fingerprint-sharing-alliance.html
>
> This is the key description paragraph -
>
> "Attack resolution requires real-time cooperation and coordination between
> service providers to identify a compromised or infected system as close to
> the absolute Internet ingress as possible. The community of service
> providers that are participating in the Fingerprint Sharing Alliance will be
> sharing cyber attack profiles, or "fingerprints" to stop attacks more
> quickly and closer to the source. This is the first time worldwide
> telecommunications companies have been able to share attack profiles
> automatically, allowing providers to consistently protect one another and
> their customers from today's distributed threats."
>
> What I am interested in doing it creating an automated method for users to
> submit "fingerprints" of malicious attacks they have seen on their sites so
> that other ModSecurity users can quickly download those rules and use them
> to protect their sites.  I don't want to dive too deep into the technical
> details of "how" at this point.
>
> What I want to know is the following -
>
>  1.  Is this something that you would use?
>
Yes . I have some dubt on the possibility of false positive and how to
mitigate this risk.

>  2.  Is this something that you would participate in by submitting
> fingerprints?
>
Yes

Thanks very much


>
> Please respond to this email thread if you are interested in this concept.
>  If we get a good response, we will proceed with development and work with
> the community on details.
>
>   Thanks,

> Ryan
>
> ________________________________
> This transmission may contain information that is privileged, confidential,
> and/or exempt from disclosure under applicable law. If you are not the
> intended recipient, you are hereby notified that any disclosure, copying,
> distribution, or use of the information contained herein (including any
> reliance thereon) is STRICTLY PROHIBITED. If you received this transmission
> in error, please immediately contact the sender and destroy the material in
> its entirety, whether in electronic or hard copy format.
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20110603/5fa2b07f/attachment.html 

From RBarnett at trustwave.com  Mon Jun  6 13:24:08 2011
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Mon, 6 Jun 2011 12:24:08 -0500
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity Happy Hour at
	Blackhat USA 2011
Message-ID: <CA128578.280C4%rbarnett@trustwave.com>

SpiderLabs is hosting a Happy Hour at Blackhat USA 2011.  If you are planning on attending Blackhat/DefCon, please come by.  Details/RSVP here - http://blog.spiderlabs.com/2011/06/modsecurity-happy-hour-at-blackhat-usa-2011.html

Hope to see you there!

Ryan

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From RBarnett at trustwave.com  Thu Jun 16 09:21:04 2011
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Thu, 16 Jun 2011 08:21:04 -0500
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity Happy Hour at
	Blackhat USA 2011
In-Reply-To: <CA128578.280C4%rbarnett@trustwave.com>
Message-ID: <CA1F7AF8.28EC6%rbarnett@trustwave.com>

Just a reminder to please RSVP for the ModSecurity Happy Hour if you are planning on being at Blackhat USA 2011!

I am looking forward to having some beers and discussing the ins and outs of ModSecurity with users :)

Cheers,
Ryan

From: Ryan Barnett <rbarnett at trustwave.com<mailto:rbarnett at trustwave.com>>
Date: Mon, 6 Jun 2011 12:24:08 -0500
To: "mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>" <mod-security-users at lists.sourceforge.net<mailto:mod-security-users at lists.sourceforge.net>>, "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>, "mod-security-developers at lists.sourceforge.net<mailto:mod-security-developers at lists.sourceforge.net>" <mod-security-developers at lists.sourceforge.net<mailto:mod-security-developers at lists.sourceforge.net>>
Subject: ModSecurity Happy Hour at Blackhat USA 2011

SpiderLabs is hosting a Happy Hour at Blackhat USA 2011.  If you are planning on attending Blackhat/DefCon, please come by.  Details/RSVP here - http://blog.spiderlabs.com/2011/06/modsecurity-happy-hour-at-blackhat-usa-2011.html

Hope to see you there!

Ryan

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From RBarnett at trustwave.com  Fri Jun 17 08:20:12 2011
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Fri, 17 Jun 2011 07:20:12 -0500
Subject: [Owasp-modsecurity-core-rule-set] [Mod-security-developers] CRS
	DoS bugs/suggestions
In-Reply-To: <CA20BCA5.29064%rbarnett@trustwave.com>
Message-ID: <CA20BE4E.29071%rbarnett@trustwave.com>

I am forwarding this to the OWASP ModSecurity CRS list as this pertains to
the DoS rules.


Oleg - please send future issues related to the OWASP CRS to this
mail-list instead of the ModSec Dev list.

Thanks.

-Ryan

On 6/17/11 8:15 AM, "Ryan Barnett" <RBarnett at trustwave.com> wrote:

>Oleg,
>First of all, thank you for taking the time to test these rules further.
>The rule quality will only improve if the community takes the time to
>test them and report back the status.
>
>To your comments about the lack of "expirevar" actions, this should not
>be needed for the ip.dos_counter var as the last rule uses the
>"setvar:!ip.dos_counter" action to actually remove that variable if the
>operator matches.  Can you please check your debug log during testing to
>verify if that action is not removing that variable?  Perhaps there is a
>bug in removing the variable with the "!" symbol and using expirevar is
>more reliable.
>
>Also ? what version of ModSecurity are you using?
>
>-Ryan
>
>From: Oleg Gryb <oleg_gryb at yahoo.com<mailto:oleg_gryb at yahoo.com>>
>Reply-To: "oleg at gryb.info<mailto:oleg at gryb.info>"
><oleg at gryb.info<mailto:oleg at gryb.info>>,
>"mod-security-developers at lists.sourceforge.net<mailto:mod-security-develop
>ers at lists.sourceforge.net>"
><mod-security-developers at lists.sourceforge.net<mailto:mod-security-develop
>ers at lists.sourceforge.net>>
>Date: Thu, 16 Jun 2011 11:32:11 -0500
>To:
>"mod-security-developers at lists.sourceforge.net<mailto:mod-security-develop
>ers at lists.sourceforge.net>"
><mod-security-developers at lists.sourceforge.net<mailto:mod-security-develop
>ers at lists.sourceforge.net>>
>Subject: [Mod-security-developers] CRS DoS bugs/suggestions
>
>
>I was testing DoS ruleset lately and found that there probably was a bug
>related to ip.dos_counter variable. The expiration time was not set for
>this var, as a result the counter persists longer than
>tx.dos_burst_time_slice. As a result, the history of hits is counted for
>a longer time period.
>
>I've added expiration time in two places and it started to work correctly
>after that. The changes are below:
>
>SecRule REQUEST_BASENAME "!\.(jpe?g|png|gif|js|css|ico)$"
>"phase:5,t:none,nolog,pass,setvar:ip.dos_counter=+1,expirevar:ip.dos_count
>er=%{tx.dos_burst_time_slice}"
>
>...
>
>SecRule IP:DOS_COUNTER "@ge %{tx.dos_counter_threshold}"
>"phase:5,t:none,nolog,pass,t:none,setvar:ip.dos_burst_counter=+1,expirevar
>:ip.dos_burst_counter=%{tx.dos_burst_time_slice},setvar:!ip.dos_counter,ex
>pirevar:ip.dos_counter=%{tx.dos_burst_time_slice}"
>
>I've also attached the sample of testing program. I think, we should have
>something like that to test all limits. There are only two tests
>implemented for now: for request size and DoS, but it should be easy to
>add more.
>
>
>
>________________________________
>This transmission may contain information that is privileged,
>confidential, and/or exempt from disclosure under applicable law. If you
>are not the intended recipient, you are hereby notified that any
>disclosure, copying, distribution, or use of the information contained
>herein (including any reliance thereon) is STRICTLY PROHIBITED. If you
>received this transmission in error, please immediately contact the
>sender and destroy the material in its entirety, whether in electronic or
>hard copy format.
>
>
>--------------------------------------------------------------------------
>----
>EditLive Enterprise is the world's most technically advanced content
>authoring tool. Experience the power of Track Changes, Inline Image
>Editing and ensure content is compliant with Accessibility Checking.
>http://p.sf.net/sfu/ephox-dev2dev
>_______________________________________________
>mod-security-developers mailing list
>mod-security-developers at lists.sourceforge.net
>https://lists.sourceforge.net/lists/listinfo/mod-security-developers
>ModSecurity Services from Trustwave's SpiderLabs:
>https://www.trustwave.com/spiderLabs.php
>


This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From oleg_gryb at yahoo.com  Fri Jun 17 13:58:15 2011
From: oleg_gryb at yahoo.com (Oleg Gryb)
Date: Fri, 17 Jun 2011 10:58:15 -0700 (PDT)
Subject: [Owasp-modsecurity-core-rule-set] [Mod-security-developers] CRS
	DoS bugs/suggestions
In-Reply-To: <CA20BCA5.29064%rbarnett@trustwave.com>
References: <CA20BCA5.29064%rbarnett@trustwave.com>
Message-ID: <933219.31062.qm@web121002.mail.ne1.yahoo.com>

No, I think it's a logical error. !ip.dos_counter is called only  after 
dos_counter reached the threshold. Now, think about the following  scenario:

1. I've sent a couple of requests
2. Waited for more than dos_burst_time_slice seconds hoping that it will clear 
the dos_counter
3. Send some requests again. All of them will be added to the dos_counter 
becuase it didn't expire.

All that means that you can keep adding to dos_counter for a very long  period 
of time, which is much longer than dos_burst_time_slice and it  defeats the 
purpose of dos_burst_time_slice parameter in my view.





----- Original Message ----
> From: Ryan Barnett <RBarnett at trustwave.com>
> To: "oleg at gryb.info" <oleg at gryb.info>; 
>"mod-security-developers at lists.sourceforge.net" 
><mod-security-developers at lists.sourceforge.net>
> Sent: Fri, June 17, 2011 5:15:57 AM
> Subject: Re: [Mod-security-developers] CRS DoS bugs/suggestions
> 
> Oleg,
> First of all, thank you for taking the time to test these rules  further.  The 
>rule quality will only improve if the community takes the  time to test them and 
>report back the status.
> 
> To your comments about the  lack of "expirevar" actions, this should not be 
>needed for the ip.dos_counter  var as the last rule uses the 
>"setvar:!ip.dos_counter" action to actually remove  that variable if the 
>operator matches.  Can you please check your debug log  during testing to verify 
>if that action is not removing that variable?   Perhaps there is a bug in 
>removing the variable with the "!" symbol and using  expirevar is more reliable.
> 
> Also ? what version of ModSecurity are you  using?
> 
> -Ryan
> 
> From: Oleg Gryb <oleg_gryb at yahoo.com<mailto:oleg_gryb at yahoo.com>>
> Reply-To:  "oleg at gryb.info<mailto:oleg at gryb.info>" 
><oleg at gryb.info<mailto:oleg at gryb.info>>, 
>"mod-security-developers at lists.sourceforge.net<mailto:mod-security-developers at lists.sourceforge.net>"
>  
><mod-security-developers at lists.sourceforge.net<mailto:mod-security-developers at lists.sourceforge.net>>
>
> Date:  Thu, 16 Jun 2011 11:32:11 -0500
> To: 
>"mod-security-developers at lists.sourceforge.net<mailto:mod-security-developers at lists.sourceforge.net>"
>  
><mod-security-developers at lists.sourceforge.net<mailto:mod-security-developers at lists.sourceforge.net>>
>
> Subject:  [Mod-security-developers] CRS DoS bugs/suggestions
> 
> 
> I was testing DoS  ruleset lately and found that there probably was a bug 
>related to ip.dos_counter  variable. The expiration time was not set for this 
>var, as a result the counter  persists longer than tx.dos_burst_time_slice. As a 
>result, the history of hits  is counted for a longer time period.
> 
> I've added expiration time in two  places and it started to work correctly 
>after that. The changes are  below:
> 
> SecRule REQUEST_BASENAME "!\.(jpe?g|png|gif|js|css|ico)$"  
>"phase:5,t:none,nolog,pass,setvar:ip.dos_counter=+1,expirevar:ip.dos_counter=%{tx.dos_burst_time_slice}"
>
> 
> ...
> 
> SecRule  IP:DOS_COUNTER "@ge %{tx.dos_counter_threshold}"  
>"phase:5,t:none,nolog,pass,t:none,setvar:ip.dos_burst_counter=+1,expirevar:ip.dos_burst_counter=%{tx.dos_burst_time_slice},setvar:!ip.dos_counter,expirevar:ip.dos_counter=%{tx.dos_burst_time_slice}"
>
> 
> I've  also attached the sample of testing program. I think, we should have 
>something  like that to test all limits. There are only two tests implemented 
>for now: for  request size and DoS, but it should be easy to add  more.
> 
> 
> 
> ________________________________
> This transmission may  contain information that is privileged, confidential, 
>and/or exempt from  disclosure under applicable law. If you are not the intended 
>recipient, you are  hereby notified that any disclosure, copying, distribution, 
>or use of the  information contained herein (including any reliance thereon) is 
>STRICTLY  PROHIBITED. If you received this transmission in error, please 
>immediately  contact the sender and destroy the material in its entirety, 
>whether in  electronic or hard copy format.
> 
> 

From RBarnett at trustwave.com  Wed Jun 22 15:00:44 2011
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 22 Jun 2011 14:00:44 -0500
Subject: [Owasp-modsecurity-core-rule-set] Announcing the ModSecurity SQL
	Injection Challenge
Message-ID: <CA27B41C.295CB%rbarnett@trustwave.com>

Announcing the ModSecurity SQL Injection Challenge

The ModSecurity Project Team is happy to announce our first community hacking challenge<http://www.modsecurity.org/demo/challenge.html>!

This is a SQL Injection and Filter Evasion Challenge. We have setup ModSecurity to proxy to the following 4 commercial vuln scanner demo sites:

 *   IBM (AppScan) - demo.testfire.net site<http://www.modsecurity.org/demo.testfire.net/>
 *   Cenzic (HailStorm) - CrackMe Bank site<http://www.modsecurity.org/crackme.cenzic.com/>
 *   HP (WebInspect) - Free Bank site<http://www.modsecurity.org/zero.webappsecurity.com/>
 *   Acunetix (Acunetix) - Acuart site<http://www.modsecurity.org/testphp.vulnweb.com/>

Challenge Details

To successfully complete the challenge, participants must do the following:

 1.  Identify a SQL Injection vector within one of the demo websites listed above.
 2.  Successfully enumerate the following information about the database:
    *   DB User(s) - provide request data.
    *   DB Name(s) - provide request data.
    *   Table Name(s) - provide request data.
    *   Column Name(s) - provide request data.

Challenge Submission

Please send challenge submissions to security at modsecurity.org<mailto:security at modsecurity.org> with the details from above.

Winning Levels

There are two levels to this challenge:

Level 1 - Speed Hacking

Winners of this level will be determined as the first person to identify the enumeration data listed above for each demo app. There will be 4 winners at this level and they will be listed on the challenge page.

Level 2 - Filter Evasion

Winners of this level will be anyone who is able to enumerate the data listed above for each demo app without triggering an Inbound ModSecurity Alert. If ModSecurity sees any inbound attacks or outbound application defects/info leakages, it will prepend a warning banner to the top of the page. Here is an example:

ModSecurity Alert Message:
Inbound Alert: SQL Injection
Outbound Alert: SQL Information Leakage.
Your challenge is to try and evade the ModSecurity inbound filters while still enumerating the same data from above. There is no limit to the number of winners of this level. All winners will be listed in the challenge page.



Prizes

All Level 2 winners will receive an official ModSecurity t-shirt from Trustwave's Spiderlabs.



--
Ryan Barnett


________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From RBarnett at trustwave.com  Sat Jun 25 09:22:17 2011
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Sat, 25 Jun 2011 08:22:17 -0500
Subject: [Owasp-modsecurity-core-rule-set] Announcing the ModSecurity
	SQL Injection Challenge
In-Reply-To: <CA27B41C.295CB%rbarnett@trustwave.com>
References: <CA27B41C.295CB%rbarnett@trustwave.com>
Message-ID: <D6318EA7-DBC1-4936-B4BF-C10DA91C24A8@trustwave.com>

Just wanted to send an update to the lists. The challenge is still ongoing (Level I is closed but Level II is still open).

The challenge has already been a huge success. We had over 650 people participate!  This type of testing of the CRS is vitally important and we could not have done this ourselves. The end result is that the CRS' SQLi protections will be much improved.

We are already making updates. I will notify the lists when it is updated.

Cheers

Ryan

On Jun 22, 2011, at 3:00 PM, "Ryan Barnett" <RBarnett at trustwave.com<mailto:RBarnett at trustwave.com>> wrote:

Announcing the ModSecurity SQL Injection Challenge

The ModSecurity Project Team is happy to announce our first community hacking challenge<http://www.modsecurity.org/demo/challenge.html>!

This is a SQL Injection and Filter Evasion Challenge. We have setup ModSecurity to proxy to the following 4 commercial vuln scanner demo sites:

 *   IBM (AppScan) - <http://www.modsecurity.org/demo.testfire.net/> demo.testfire.net<http://demo.testfire.net> site
 *   Cenzic (HailStorm) - CrackMe Bank site<http://www.modsecurity.org/crackme.cenzic.com/>
 *   HP (WebInspect) - Free Bank site<http://www.modsecurity.org/zero.webappsecurity.com/>
 *   Acunetix (Acunetix) - Acuart site<http://www.modsecurity.org/testphp.vulnweb.com/>

Challenge Details

To successfully complete the challenge, participants must do the following:

 1.  Identify a SQL Injection vector within one of the demo websites listed above.
 2.  Successfully enumerate the following information about the database:
    *   DB User(s) - provide request data.
    *   DB Name(s) - provide request data.
    *   Table Name(s) - provide request data.
    *   Column Name(s) - provide request data.

Challenge Submission

Please send challenge submissions to <mailto:security at modsecurity.org> security at modsecurity.org<mailto:security at modsecurity.org> with the details from above.

Winning Levels

There are two levels to this challenge:

Level 1 - Speed Hacking

Winners of this level will be determined as the first person to identify the enumeration data listed above for each demo app. There will be 4 winners at this level and they will be listed on the challenge page.

Level 2 - Filter Evasion

Winners of this level will be anyone who is able to enumerate the data listed above for each demo app without triggering an Inbound ModSecurity Alert. If ModSecurity sees any inbound attacks or outbound application defects/info leakages, it will prepend a warning banner to the top of the page. Here is an example:

ModSecurity Alert Message:
Inbound Alert: SQL Injection
Outbound Alert: SQL Information Leakage.
Your challenge is to try and evade the ModSecurity inbound filters while still enumerating the same data from above. There is no limit to the number of winners of this level. All winners will be listed in the challenge page.



Prizes

All Level 2 winners will receive an official ModSecurity t-shirt from Trustwave's Spiderlabs.



--
Ryan Barnett


________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

