<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Problem with the Rule
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problem%20with%20the%20Rule&In-Reply-To=%3CD02F37AF.111F40%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001659.html">
   <LINK REL="Next"  HREF="001661.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Problem with the Rule</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Problem%20with%20the%20Rule&In-Reply-To=%3CD02F37AF.111F40%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Problem with the Rule">RBarnett at trustwave.com
       </A><BR>
    <I>Fri Sep  5 13:53:57 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001659.html">[Owasp-modsecurity-core-rule-set] Problem with the Rule
</A></li>
        <LI>Next message: <A HREF="001661.html">[Owasp-modsecurity-core-rule-set] Problem with the Rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1660">[ date ]</a>
              <a href="thread.html#1660">[ thread ]</a>
              <a href="subject.html#1660">[ subject ]</a>
              <a href="author.html#1660">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Try to use all SecRules like this and add an explicit phase action -

SecRule REQUEST_FILENAME &quot;@endsWith wp-login.php&quot; &quot;chain,id:88888880,phase:request,drop,msg:'Non-Japan IP address'&quot;
SecRule REMOTE_ADDR &quot;@geoLookup&quot; &quot;chain&quot;
SecRule GEO:COUNTRY_CODE !@streq JP&lt;mailto:!@streq%20JP&gt; &quot;t:none&quot;


Ryan Barnett
Senior Lead Security Researcher, SpiderLabs

Trustwave | SMART SECURITY ON DEMAND
www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;

From: &quot;Mesra.net CEO&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">admin at mesra.my</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">admin at mesra.my</A>&gt;&gt;
Date: Friday, September 5, 2014 1:24 AM
To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: [Owasp-modsecurity-core-rule-set] Problem with the Rule

Dear all,

I think I have problem with below rule:

&lt;LocationMatch &quot;wp-login.php&quot;&gt;
SecRule REMOTE_ADDR &quot;@geoLookup&quot; &quot;chain,id:88888880,drop,msg:'Non-Japan IP address'&quot;
SecRule GEO:COUNTRY_CODE !@streq JP&lt;mailto:!@streq%20JP&gt; &quot;t:none&quot;
&lt;/LocationMatch&gt;

What I&#8217;m trying to do is to block any access out of Japan to wp-login.php file, what I see on the Apache log, its only working with POST but its doesn&#8217;t work with GET

Please help. TQ



________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140905/bb9c8ef3/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140905/bb9c8ef3/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001659.html">[Owasp-modsecurity-core-rule-set] Problem with the Rule
</A></li>
	<LI>Next message: <A HREF="001661.html">[Owasp-modsecurity-core-rule-set] Problem with the Rule
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1660">[ date ]</a>
              <a href="thread.html#1660">[ thread ]</a>
              <a href="subject.html#1660">[ subject ]</a>
              <a href="author.html#1660">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
