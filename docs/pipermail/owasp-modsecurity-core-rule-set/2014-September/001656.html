<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Block URL of Joomla
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Block%20URL%20of%20Joomla&In-Reply-To=%3C6A612B53A37A4AFBB0FC14E77203187D%40UserPC%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001655.html">
   <LINK REL="Next"  HREF="001657.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Block URL of Joomla</H1>
    <B>Mesra.net CEO</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Block%20URL%20of%20Joomla&In-Reply-To=%3C6A612B53A37A4AFBB0FC14E77203187D%40UserPC%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Block URL of Joomla">admin at mesra.my
       </A><BR>
    <I>Thu Sep  4 18:09:15 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001655.html">[Owasp-modsecurity-core-rule-set] Block URL of Joomla
</A></li>
        <LI>Next message: <A HREF="001657.html">[Owasp-modsecurity-core-rule-set] Block URL of Joomla
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1656">[ date ]</a>
              <a href="thread.html#1656">[ thread ]</a>
              <a href="subject.html#1656">[ subject ]</a>
              <a href="author.html#1656">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Ryan,

I just tested the rules and what I can see on Apache is:

xxx.xxx.xxx.xxx - - [05/Sep/2014:02:05:29 +0800] &quot;GET /index.php/appradio/item/23-all-features HTTP/1.1&quot; 200 45429 &quot;-&quot; &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;
xxx.xxx.xxx.xxx - - [05/Sep/2014:02:05:30 +0800] &quot;POST /index.php/about HTTP/1.1&quot; 404 - <A HREF="http://www.com/index.php/appradio/item/23-all-features">http://www.com/index.php/appradio/item/23-all-features</A> &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;

Seem its only block for &#8216;POST&#8217; but still allow access for &#8216;GET&#8217;, correct me if I&#8217;m wrong.

Please advice. TQ so much for help.


From: Ryan Barnett 
Sent: Friday, September 05, 2014 1:42 AM
To: Mesra.net CEO ; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A> 
Subject: Re: [Owasp-modsecurity-core-rule-set] Block URL of Joomla

Try this (untested) -

SecRule REQUEST_FILENAME &quot;@streq /index.php/appradio&quot; &quot;phase:request,t:none,t:utf8toUnicode,t:urlDecodeUni,t:normalizePathWin,block,msg:'Blocking Joomla AppRadio Demo Template Request'&quot;


Ryan Barnett

Senior Lead Security Researcher, SpiderLabs



Trustwave | SMART SECURITY ON DEMAND

www.trustwave.com


From: &quot;Mesra.net CEO&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">admin at mesra.my</A>&gt;
Date: Thursday, September 4, 2014 1:10 PM
To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Subject: [Owasp-modsecurity-core-rule-set] Block URL of Joomla


  Dear All,

  I&#8217;m facing problem with one of my stubborn client who host on my server, I did advice him to remove the demo template for example <A HREF="http://www.xxxx.com/index.php/appradio">http://www.xxxx.com/index.php/appradio</A> because the spammer misused it to submit their ads and the client still deny it, that activity very annoying because that make my server overloaded due lot of submission of ads, so how can I block any access to index.php/appradio with modsecurity ?

  Please help and Thank you so much 




--------------------------------------------------------------------------------

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140905/5da603d4/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140905/5da603d4/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001655.html">[Owasp-modsecurity-core-rule-set] Block URL of Joomla
</A></li>
	<LI>Next message: <A HREF="001657.html">[Owasp-modsecurity-core-rule-set] Block URL of Joomla
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1656">[ date ]</a>
              <a href="thread.html#1656">[ thread ]</a>
              <a href="subject.html#1656">[ subject ]</a>
              <a href="author.html#1656">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
