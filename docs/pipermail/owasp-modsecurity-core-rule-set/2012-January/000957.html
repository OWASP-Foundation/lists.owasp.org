<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Potential false positive?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Potential%20false%20positive%3F&In-Reply-To=%3C4F085352.3090801%40astrocalc.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000963.html">
   <LINK REL="Next"  HREF="000958.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Potential false positive?</H1>
    <B>Joakim Schramm</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Potential%20false%20positive%3F&In-Reply-To=%3C4F085352.3090801%40astrocalc.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Potential false positive?">joakim at astrocalc.com
       </A><BR>
    <I>Sat Jan  7 14:14:42 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000963.html">[Owasp-modsecurity-core-rule-set] Inconsistent Anomaly scoring in modsecurity_crs_41_sql_injection_attacks.conf
</A></li>
        <LI>Next message: <A HREF="000958.html">[Owasp-modsecurity-core-rule-set] Potential false positive?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#957">[ date ]</a>
              <a href="thread.html#957">[ thread ]</a>
              <a href="subject.html#957">[ subject ]</a>
              <a href="author.html#957">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi List,

my first post here so hope I get it right.

Setting up and testing a site I run in to what I think is a false 
positive block, at least it doesn't make sense to me. The hit or hits I 
may say as 3 rules seem to be triggered and a 4th as a result there of, 
comes from an url item in a css file pointing to a image file. How that 
can be judged as an critical web attack and sql injection attempt is 
over my head, although I understand there probably exists a logical 
explaination... and can it possibly be that these rules should exclude 
common image files?

Anyway, here is the related log lines and I hope it's understandable as 
there is no way to format it here. I have disguised ip and host names.

[Sat Jan 07 12:55:18 2012] [error] [client 213.xxx.xxx.xxx] ModSecurity: 
Warning. Pattern match 
&quot;(?i:(?:\\\\d(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98)\\\\s+(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98)\\\\s+\\\\d)|(?:^admin\\\\s*(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98)|(\\\\/\\\\*)+(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98)+\\\\s?(?:--|#|\\\\/\\\\*|{)?)|(?:(\\&quot;|'| 
...&quot; at REQUEST_FILENAME. [file 
&quot;/etc/modsecurity/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] 
[line &quot;533&quot;] [id &quot;981244&quot;] [msg &quot;Detects basic SQL authentication bypass 
attempts 1/3&quot;] [data &quot;div&quot;] [severity &quot;CRITICAL&quot;] [tag 
&quot;WEB_ATTACK/SQLI&quot;] [tag &quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;] 
[hostname &quot;shop.domain.com&quot;] [uri 
&quot;/skin/frontend/domain/default/images/bkg_divider1.gif&quot;] [unique_id 
&quot;TwhAtsCoAWgAADYlFsAAAAAF&quot;]
[Sat Jan 07 12:55:18 2012] [error] [client 213.xxx.xxx.xxx] ModSecurity: 
Warning. Pattern match 
&quot;(?i:(?:@.+=\\\\s*\\\\(\\\\s*select)|(?:\\\\d+\\\\s*x?or|div|like|between|and\\\\s*\\\\d+\\\\s*[\\\\-+])|(?:\\\\/\\\\w+;?\\\\s+(?:having|and|x?or|div|like|between|and|select)\\\\W)|(?:\\\\d\\\\s+group\\\\s+by.+\\\\()|(?:(?:;|#|--)\\\\s*(?:drop|alter))|(?:(?:;|#|--)\\\\s*(?:update|insert)\\\\s 
...&quot; at REQUEST_FILENAME. [file 
&quot;/etc/modsecurity/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] 
[line &quot;539&quot;] [id &quot;981248&quot;] [msg &quot;Detects chained SQL injection attempts 
1/2&quot;] [data &quot;div&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag 
&quot;WEB_ATTACK/ID&quot;] [hostname &quot;shop.domain.com&quot;] [uri 
&quot;/skin/frontend/domain/default/images/bkg_divider1.gif&quot;] [unique_id 
&quot;TwhAtsCoAWgAADYlFsAAAAAF&quot;]
[Sat Jan 07 12:55:18 2012] [error] [client 213.xxx.xxx.xxx] ModSecurity: 
Warning. Pattern match 
&quot;(?i:(?:(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98)\\\\s*\\\\*.+(?:x?or|div|like|between|and|id)\\\\W*(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98)\\\\d)|(?:\\\\^(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98))|(?:^[\\\\w\\\\s(\\&quot;|'|`|\\xc2\\xb4|\\xe2\\x80\\x99|\\xe2\\x80\\x98)-]+( 
...&quot; at REQUEST_FILENAME. [file 
&quot;/etc/modsecurity/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;] 
[line &quot;573&quot;] [id &quot;981243&quot;] [msg &quot;Detects classic SQL injection probings 
2/2&quot;] [data &quot;div&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [tag 
&quot;WEB_ATTACK/ID&quot;] [tag &quot;WEB_ATTACK/LFI&quot;] [hostname &quot;shop.domain.com&quot;] 
[uri &quot;/skin/frontend/domain/default/images/bkg_divider1.gif&quot;] [unique_id 
&quot;TwhAtsCoAWgAADYlFsAAAAAF&quot;]
[Sat Jan 07 12:55:18 2012] [error] [client 213.xxx.xxx.xxx] ModSecurity: 
Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file 
&quot;/etc/modsecurity/base_rules/modsecurity_crs_60_correlation.conf&quot;] [line 
&quot;37&quot;] [id &quot;981204&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total Inbound 
Score: 19, SQLi=, XSS=): 981243-Detects classic SQL injection probings 
2/2&quot;] [hostname &quot;shop.domain.com&quot;] [uri 
&quot;/skin/frontend/domain/default/images/bkg_divider1.gif&quot;] [unique_id 
&quot;TwhAtsCoAWgAADYlFsAAAAAF&quot;]

The css line that triggers looks like this:
.dashboard .box .box-title { background:url(../images/bkg_divider1.gif) 
0 100% repeat-x; padding:0 0 2px; margin:0 0 8px; text-align:right; }

Nothing scary really but how can this false positive be avoided? Is it 
best to improve the regexp or can well known image files be filtered out 
any other way?

TIA,

Joakim
</PRE>




<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000963.html">[Owasp-modsecurity-core-rule-set] Inconsistent Anomaly scoring in modsecurity_crs_41_sql_injection_attacks.conf
</A></li>
	<LI>Next message: <A HREF="000958.html">[Owasp-modsecurity-core-rule-set] Potential false positive?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#957">[ date ]</a>
              <a href="thread.html#957">[ thread ]</a>
              <a href="subject.html#957">[ subject ]</a>
              <a href="author.html#957">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
