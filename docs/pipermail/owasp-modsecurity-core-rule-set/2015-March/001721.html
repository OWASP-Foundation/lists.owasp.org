<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 71, Issue 2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%0A%09Owasp-modsecurity-core-rule-set%20Digest%2C%20Vol%2071%2C%20Issue%202&In-Reply-To=%3C1425573201900.8ae98178%40Nodemailer%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001720.html">
   <LINK REL="Next"  HREF="001722.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 71, Issue 2</H1>
    <B>John Babbidge</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%0A%09Owasp-modsecurity-core-rule-set%20Digest%2C%20Vol%2071%2C%20Issue%202&In-Reply-To=%3C1425573201900.8ae98178%40Nodemailer%3E"
       TITLE="[Owasp-modsecurity-core-rule-set]	Owasp-modsecurity-core-rule-set Digest, Vol 71, Issue 2">jbabbidge at gmail.com
       </A><BR>
    <I>Thu Mar  5 16:33:22 UTC 2015</I>
    <P><UL>
        <LI>Previous message: <A HREF="001720.html">[Owasp-modsecurity-core-rule-set] Successful Redirect Attack Scoring only 3 with Core Rules (any clue?)
</A></li>
        <LI>Next message: <A HREF="001722.html">[Owasp-modsecurity-core-rule-set] Questions about	modsecurity_crs_11_dos_protection.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1721">[ date ]</a>
              <a href="thread.html#1721">[ thread ]</a>
              <a href="subject.html#1721">[ subject ]</a>
              <a href="author.html#1721">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>.&#160;



&#8212;
Sent from my phone

On Thu, Mar 5, 2015 at 4:06 AM, null
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-request at lists.owasp.org</A>&gt; wrote:

&gt;<i> Send Owasp-modsecurity-core-rule-set mailing list submissions to
</I>&gt;<i> 	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> To subscribe or unsubscribe via the World Wide Web, visit
</I>&gt;<i> 	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> or, via email, send a message with subject or body 'help' to
</I>&gt;<i> 	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-request at lists.owasp.org</A>
</I>&gt;<i> You can reach the person managing the list at
</I>&gt;<i> 	<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-owner at lists.owasp.org</A>
</I>&gt;<i> When replying, please edit your Subject line so it is more specific
</I>&gt;<i> than &quot;Re: Contents of Owasp-modsecurity-core-rule-set digest...&quot;
</I>&gt;<i> Today's Topics:
</I>&gt;<i>    1. ModSecurity cPanel Reporting	Capabilities (Chaim Sanders)
</I>&gt;<i>    2. Re: Successful Redirect Attack Scoring only 3 with Core Rules
</I>&gt;<i>       (any clue?) (Christian Folini)
</I>&gt;<i> ----------------------------------------------------------------------
</I>&gt;<i> Message: 1
</I>&gt;<i> Date: Wed, 4 Mar 2015 21:36:56 +0000
</I>&gt;<i> From: Chaim Sanders &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CSanders at trustwave.com</A>&gt;
</I>&gt;<i> To: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&quot;
</I>&gt;<i> 	&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> Subject: [Owasp-modsecurity-core-rule-set] ModSecurity cPanel
</I>&gt;<i> 	Reporting	Capabilities
</I>&gt;<i> Message-ID:
</I>&gt;<i> 	&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">F684BDD553BAF1479F5380EDAD3BE37101048EA2 at SKYMB1.trustwave.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;us-ascii&quot;
</I>&gt;<i> Are you using OWASP CRS and cPanel? We are happy to announce that cPanel has just added the ability to 'Report a Rule'. We are very excited about this new feature because, as we all know, a WAF is only as good as its ruleset. If you are using cPanel with OWASP CRS and you find that a rule is not working correctly we highly encourage you to follow the steps outlined at <A HREF="https://documentation.cpanel.net/display/ALD/ModSecurity+Tools#ModSecurityTools-Reportarule.">https://documentation.cpanel.net/display/ALD/ModSecurity+Tools#ModSecurityTools-Reportarule.</A> This will file a report about the rule directly with the ModSecurity team and we will do our best to quickly address the concern. We'd like to thank the cPanel team for going the extra mile in implementing this feature, we really do think it will make everyone more secure. If you are not using cPanel please remember to open issues on GitHub or email the mailing list if you find a bug. We are always on the lookout for how to improve our rules.
</I>&gt;<i> Chaim Sanders
</I>&gt;<i> Security Researcher, SpiderLabs
</I>&gt;<i> Trustwave | SMART SECURITY ON DEMAND
</I>&gt;<i> www.trustwave.com&lt;<A HREF="http://www.trustwave.com/">http://www.trustwave.com/</A>&gt;
</I>&gt;<i> ________________________________
</I>&gt;<i> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is strictly prohibited. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
</I>&gt;<i> -------------- next part --------------
</I>&gt;<i> An HTML attachment was scrubbed...
</I>&gt;<i> URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150304/ecf963fe/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150304/ecf963fe/attachment-0001.html</A>&gt;
</I>&gt;<i> ------------------------------
</I>&gt;<i> Message: 2
</I>&gt;<i> Date: Thu, 5 Mar 2015 09:32:56 +0100
</I>&gt;<i> From: Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at time-machine.ch</A>&gt;
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> Subject: Re: [Owasp-modsecurity-core-rule-set] Successful Redirect
</I>&gt;<i> 	Attack Scoring only 3 with Core Rules (any clue?)
</I>&gt;<i> Message-ID: &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">20150305083256.GA14398 at elias</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=utf-8
</I>&gt;<i> Hi Achim,
</I>&gt;<i> Good to hear from you. Unfortunately, nobody else responded. We'll
</I>&gt;<i> see how far we can get.
</I>&gt;<i> On Tue, Mar 03, 2015 at 09:00:35AM +0100, Achim wrote:
</I>&gt;&gt;<i> this is a typical &quot;header injection&quot; attack. AFAIK CRS has no spezial
</I>&gt;&gt;<i> rules for that. What best fits is the HTTP Response Splitting rule 950911,
</I>&gt;&gt;<i> but it is far to specific to match in this case.
</I>&gt;<i> You hit the nail on the head. We first had a response splitting
</I>&gt;<i> vulnerability. Then we lowered the limit (which had been raised by
</I>&gt;<i> a sysadmin on his own), then the pen-tester worked around the lower
</I>&gt;<i> limit with this redirect vulnerability scoring 3 on the core ruleset.
</I>&gt;&gt;<i> I'd suggest to craft a new set of rules for header injections.
</I>&gt;<i> I think that is due. 
</I>&gt;&gt;<i> Also a variant of your example would be the meta tag, if the aplication
</I>&gt;&gt;<i> writes the paramter there.
</I>&gt;<i> Agreed.
</I>&gt;&gt;<i> In OWASP Top 10 (2013) this is A1 and A10.
</I>&gt;<i> dito
</I>&gt;<i> So what can we do? I must say I am a bit at loss when thinking about a
</I>&gt;<i> good _generic_ approach.
</I>&gt;<i> (1) Disallow CR/LF in Query-Strings
</I>&gt;<i>     This seems do-able, but it does not help us with request bodies
</I>&gt;<i> (2) Disallow CR/LF in Query-Strings and Request Bodies
</I>&gt;<i>     This will raise a ton of false positives. But tuning them away
</I>&gt;<i>     on certain input fields could do the job
</I>&gt;<i> (3) Disallow CR/LF in Query-Strings and Request Bodies in combination
</I>&gt;<i>     with certain keywords
</I>&gt;<i>     This might bring less false positives, but &quot;Refresh&quot; is a standard
</I>&gt;<i>     word, so you can not rule them out.
</I>&gt;<i>     What keywords would need to be covered to address the issue?
</I>&gt;<i>     What transformation / escape variants?
</I>&gt;<i> (4) Disallow refresh header / meta tag in response phases
</I>&gt;<i>     Will only work when ResponseBodyAccess is enabled.
</I>&gt;<i>     And I think there are are still tons of applications around who
</I>&gt;<i>     redirect applications in this way. -&gt; False Positives
</I>&gt;<i> (5) Define a list of allowed redirects, then disallow refresh headers /
</I>&gt;<i>     meta tags not pointing to these hosts/domains.
</I>&gt;<i>     I am not sure if such a list / variable-to-take-this-list
</I>&gt;<i>     exists in the core rules. It's definitely a pain in the A* to
</I>&gt;<i>     maintain. And the restriction with ResponseBodyAccess
</I>&gt;<i>     in (4) applies too.
</I>&gt;<i> I am not particularly fond of all these variants and I would appreciate
</I>&gt;<i> if somebody had a better idea.
</I>&gt;<i> Ahoj,
</I>&gt;<i> Christian
</I>&gt;<i> P.S. I will talk about practical CRS Tuning in Berne, Switzerland,
</I>&gt;<i> next Tuesday, 4pm. If anybody wants to join.
</I>&gt;<i> More infos here: <A HREF="http://www.sig-switzerland.ch/de/event_bern.php">http://www.sig-switzerland.ch/de/event_bern.php</A>
</I>&gt;<i> -- 
</I>&gt;<i> Any technology that does not appear magical is insufficiently
</I>&gt;<i> advanced.        ?
</I>&gt;<i> -- Gregory Benford
</I>&gt;<i> ------------------------------
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> End of Owasp-modsecurity-core-rule-set Digest, Vol 71, Issue 2
</I>&gt;<i> **************************************************************
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150305/bae4a36b/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150305/bae4a36b/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001720.html">[Owasp-modsecurity-core-rule-set] Successful Redirect Attack Scoring only 3 with Core Rules (any clue?)
</A></li>
	<LI>Next message: <A HREF="001722.html">[Owasp-modsecurity-core-rule-set] Questions about	modsecurity_crs_11_dos_protection.conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1721">[ date ]</a>
              <a href="thread.html#1721">[ thread ]</a>
              <a href="subject.html#1721">[ subject ]</a>
              <a href="author.html#1721">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
