<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] What does this mean
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20What%20does%20this%20mean&In-Reply-To=C9424BAF.16D89%25rbarnett%40trustwave.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000580.html">
   <LINK REL="Next"  HREF="000583.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] What does this mean</H1>
    <B>Dimitri Yioulos</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20What%20does%20this%20mean&In-Reply-To=C9424BAF.16D89%25rbarnett%40trustwave.com"
       TITLE="[Owasp-modsecurity-core-rule-set] What does this mean">dyioulos at firstbhph.com
       </A><BR>
    <I>Thu Dec 30 15:39:01 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000580.html">[Owasp-modsecurity-core-rule-set] What does this mean
</A></li>
        <LI>Next message: <A HREF="000583.html">[Owasp-modsecurity-core-rule-set] What does this mean
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#581">[ date ]</a>
              <a href="thread.html#581">[ thread ]</a>
              <a href="subject.html#581">[ subject ]</a>
              <a href="author.html#581">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thursday 30 December 2010 2:52:29 pm Ryan 
Barnett wrote:
&gt;<i> On 12/30/10 2:43 PM, &quot;Dimitri Yioulos&quot; 
</I>&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">dyioulos at firstbhph.com</A>&gt; wrote:
&gt;<i> &gt;All,
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;With the installation of the latest rulesit,
</I>&gt;<i> &gt; I'm now getting the following alerts:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Warning - Sticky SessionID Data Changed -
</I>&gt;<i> &gt;User-Agent Mismatch.    Access denied with
</I>&gt;<i> &gt; code 403 (phase 2). Match of &quot;streq
</I>&gt;<i> &gt; %{SESSION.UA}&quot; against &quot;TX:ua_hash&quot; required.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Hope I'm not being too stupid here, but what
</I>&gt;<i> &gt; does that mean?  Am I blocking legitimate
</I>&gt;<i> &gt; traffic?
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;Better still, is there a place (documents,
</I>&gt;<i> &gt; etc.) that describes various alerts?
</I>&gt;<i>
</I>&gt;<i> This ruleset will track the IP Address Block
</I>&gt;<i> Range and User-Agent string hash for each user
</I>&gt;<i> and tie it to a SessionID.  If those values
</I>&gt;<i> change during the course of a session, it will
</I>&gt;<i> trigger.  The goal is to identify possible
</I>&gt;<i> session hijacking attacks.
</I>&gt;<i>
</I>&gt;<i> Dimitri - please download the latest release
</I>&gt;<i> (CRS v2.1.1) that I just released today.  I
</I>&gt;<i> made a change to the Session Hijacking conf
</I>&gt;<i> file - CHANGES file -
</I>&gt;<i>
</I>&gt;<i> - Updated the session hijacking conf file to
</I>&gt;<i> only enforce rules if a SessionID Cookie was
</I>&gt;<i> submitted
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://mod-security.svn.sourceforge.net/viewvc/">http://mod-security.svn.sourceforge.net/viewvc/</A>
</I>&gt;<i>mod-security/crs/trunk/optio
</I>&gt;<i> nal_rules/modsecurity_crs_16_session_hijacking.
</I>&gt;<i>conf?revision=1576
</I>&gt;<i>
</I>&gt;<i> I added this line which will skip the check if
</I>&gt;<i> the client doesn't submit a SessionID Cookie -
</I>&gt;<i>
</I>&gt;<i> SecRule
</I>&gt;<i> &amp;REQUEST_COOKIES:'/(j?sessionid|(php)?sessid|(a
</I>&gt;<i>sp|jserv|jw)?session[-_]?(id
</I>&gt;<i> )?|cf(id|token)|sid)/' &quot;@eq 0&quot;
</I>&gt;<i> &quot;phase:1,t:none,nolog,pass,skipAfter:END_SESSIO
</I>&gt;<i>N_STARTUP&quot;
</I>&gt;<i>
</I>&gt;<i> Hope this helps,
</I>&gt;<i> Ryan
</I>

Ryan,

Thanks very much for your help.

I did install the changed session_hijacking.conf 
file, along with any other updated files (but not 
the entire ruleset).

Just to be on the safe side, I had someone test 
reaching our Web site from outside, and she 
landed on the Apache test page.  Yikes!  So, I 
disabled session_hijacking.conf, and she was then 
able to get to our site.  Is it an issue with 
session_hijacking.conf or with our site?

Regards,

Dimitri

-- 
This message has been scanned for viruses and
dangerous content by MailScanner, and is
believed to be clean.

</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000580.html">[Owasp-modsecurity-core-rule-set] What does this mean
</A></li>
	<LI>Next message: <A HREF="000583.html">[Owasp-modsecurity-core-rule-set] What does this mean
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#581">[ date ]</a>
              <a href="thread.html#581">[ thread ]</a>
              <a href="subject.html#581">[ subject ]</a>
              <a href="author.html#581">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
