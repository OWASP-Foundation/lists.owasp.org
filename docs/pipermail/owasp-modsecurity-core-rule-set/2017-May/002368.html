<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] SecRuleUpdateActionById and	chained rules
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SecRuleUpdateActionById%20and%0A%09chained%20rules&In-Reply-To=%3C560828A85A22484C8AA3AD2538FDFC27173B9F85%40STEXCHANGE-01.ad.securetrading.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002367.html">
   <LINK REL="Next"  HREF="002369.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] SecRuleUpdateActionById and	chained rules</H1>
    <B>Brian Bird</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20SecRuleUpdateActionById%20and%0A%09chained%20rules&In-Reply-To=%3C560828A85A22484C8AA3AD2538FDFC27173B9F85%40STEXCHANGE-01.ad.securetrading.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] SecRuleUpdateActionById and	chained rules">Brian.Bird at securetrading.com
       </A><BR>
    <I>Tue May 30 09:45:26 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="002367.html">[Owasp-modsecurity-core-rule-set] OWASP AppSecEU Videos + OWASP CRS Presentation
</A></li>
        <LI>Next message: <A HREF="002369.html">[Owasp-modsecurity-core-rule-set] Matched rule modification
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2368">[ date ]</a>
              <a href="thread.html#2368">[ thread ]</a>
              <a href="subject.html#2368">[ subject ]</a>
              <a href="author.html#2368">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm deploying modsecurity 2.9.1 with the OWASP CRS 3.0.2 rules.

I'd like to update a few rules to have different anomaly scores. This is quite easy for a normal rule: eg.
SecRuleUpdateActionById 920350 &quot;setvar:tx.anomaly_score=+100&quot;

However, for chained rules this type of update will only update the first rule in the chain. Eg.
SecRuleUpdateActionById 920440 &quot;setvar:tx.anomaly_score=+100,chain&quot;

Since the action is non-disruptive the score addition takes place whenever the first rule in the chain matches (as referenced <A HREF="http://blog.modsecurity.org/2008/07/modsecurity-tri.html">http://blog.modsecurity.org/2008/07/modsecurity-tri.html</A>).

Has anything been done to allow SecRuleUpdateActionById to specify offsets (eg. as suggested at <A HREF="https://github.com/SpiderLabs/ModSecurity/issues/190">https://github.com/SpiderLabs/ModSecurity/issues/190</A>)?

I tried this:
SecRuleUpdateActionById 920440:1 &quot;setvar:tx.anomaly_score=+100,chain&quot;
and there is no error about the Rule Id not existing, but it doesn't seem like the update has taken place. I'm assuming this feature suggestion hasn't been implemented yet and the update action is ignored because there is no rule id &quot;920440:1&quot;?

So my question is: Is it possible to change the anomaly score for a specified chained rule in the CRS without editing the CRS files directly?

Thanks

Brian


-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20170530/25a97dfa/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20170530/25a97dfa/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002367.html">[Owasp-modsecurity-core-rule-set] OWASP AppSecEU Videos + OWASP CRS Presentation
</A></li>
	<LI>Next message: <A HREF="002369.html">[Owasp-modsecurity-core-rule-set] Matched rule modification
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2368">[ date ]</a>
              <a href="thread.html#2368">[ thread ]</a>
              <a href="subject.html#2368">[ subject ]</a>
              <a href="author.html#2368">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
