<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] malicious file not getting	blocked while uploading
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20malicious%20file%20not%20getting%0A%09blocked%20while%20uploading&In-Reply-To=%3CCAE9Kp-bofUaXr4kaqQS9YBG1UYhhM4b6qv1Jh5d4RkmYU32eEg%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001690.html">
   <LINK REL="Next"  HREF="001692.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] malicious file not getting	blocked while uploading</H1>
    <B>Sabin Ranjit</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20malicious%20file%20not%20getting%0A%09blocked%20while%20uploading&In-Reply-To=%3CCAE9Kp-bofUaXr4kaqQS9YBG1UYhhM4b6qv1Jh5d4RkmYU32eEg%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] malicious file not getting	blocked while uploading">think.sabin at gmail.com
       </A><BR>
    <I>Mon Dec  8 09:59:11 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001690.html">[Owasp-modsecurity-core-rule-set] Http Flood Attack from list of WordPress vulnerabilities
</A></li>
        <LI>Next message: <A HREF="001692.html">[Owasp-modsecurity-core-rule-set] Don't filter requests to a	subdomain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1691">[ date ]</a>
              <a href="thread.html#1691">[ thread ]</a>
              <a href="subject.html#1691">[ subject ]</a>
              <a href="author.html#1691">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hi,
I'm using modsecurity_crs_46_av_scanning to scan a file with clamAV when
user uploads a file. When i tested i did get the log regarding the
modsecurity telling its malicious but did not block it from uploading into
the server. The modsecurity was running in active mode.
How can it be that configured to block malicious file uploads? I got follow
log:

Message: Warning. File
&quot;/tmp//20141208-005725-VIVn9H8AAQEAADlz2AAAAAAG-file-pDG9cN&quot; rejected by
the approver script &quot;/usr/share/modsecurity-crs/util/av-scanning/runav.pl&quot;:
0 clamscan: Suspect.PDF.EmbeddedExecutable-2 [file
&quot;/usr/share/modsecurity-crs/activated_rules/modsecurity_crs_46_av_scanning.conf&quot;]
[line &quot;17&quot;] [id &quot;950115&quot;] [msg &quot;Virus found in uploaded file&quot;] [severity
&quot;CRITICAL&quot;] [tag &quot;MALICIOUS_SOFTWARE/VIRUS&quot;] [tag &quot;PCI/5.1&quot;]
Apache-Handler: application/x-httpd-php
Stopwatch: 1418029044999223 91983157 (- - -)
Stopwatch2: 1418029044999223 91983157; combined=90317213, p1=68,
p2=90317138, p3=3, p4=0, p5=4, sr=0, sw=0, l=0, gc=0
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.7.7 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>).
Server: Apache/2.4.7 (Ubuntu)
Engine-Mode: &quot;ENABLED&quot;

--87cb1800-J--
3,755390,&quot;evil.pdf&quot;,&quot;&lt;Unknown ContentType&gt;&quot;
Total,755390


thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20141208/a8af211f/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20141208/a8af211f/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001690.html">[Owasp-modsecurity-core-rule-set] Http Flood Attack from list of WordPress vulnerabilities
</A></li>
	<LI>Next message: <A HREF="001692.html">[Owasp-modsecurity-core-rule-set] Don't filter requests to a	subdomain
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1691">[ date ]</a>
              <a href="thread.html#1691">[ thread ]</a>
              <a href="subject.html#1691">[ subject ]</a>
              <a href="author.html#1691">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
