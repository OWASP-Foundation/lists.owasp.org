<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Http Flood Attack from list of WordPress vulnerabilities
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Http%20Flood%20Attack%20from%20list%0A%20of%20WordPress%20vulnerabilities&In-Reply-To=%3CCAC%2BO4mHPPprJDyaP%3DqTggo6cf6AH-Hv6Nz-f6CgW6zzgOMim1g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001689.html">
   <LINK REL="Next"  HREF="001691.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Http Flood Attack from list of WordPress vulnerabilities</H1>
    <B>Josh Amishav-Zlatin</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Http%20Flood%20Attack%20from%20list%0A%20of%20WordPress%20vulnerabilities&In-Reply-To=%3CCAC%2BO4mHPPprJDyaP%3DqTggo6cf6AH-Hv6Nz-f6CgW6zzgOMim1g%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Http Flood Attack from list of WordPress vulnerabilities">jamuse at owasp.org
       </A><BR>
    <I>Thu Dec  4 10:39:14 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001689.html">[Owasp-modsecurity-core-rule-set] Http Flood Attack from list of	WordPress vulnerabilities
</A></li>
        <LI>Next message: <A HREF="001691.html">[Owasp-modsecurity-core-rule-set] malicious file not getting	blocked while uploading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1690">[ date ]</a>
              <a href="thread.html#1690">[ thread ]</a>
              <a href="subject.html#1690">[ subject ]</a>
              <a href="author.html#1690">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Andrei,

Based on your question, are you asking how to stop all external requests
that contain the string WordPress in the UA string, but allow the local
Wordpress instance to send requests? You can do that by chaining your rule
with logic that checks the REMOTE_ADDR variable does not equal
192.168.1.100.

- Josh

On Thu, Dec 4, 2014 at 4:52 AM, Andrei &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">corovin at starnet.md</A>&gt; wrote:

&gt;<i> Hello,
</I>&gt;<i>
</I>&gt;<i> How can I drop on ModSecurity for IIS any request from user-agent
</I>&gt;<i> WordPress/?
</I>&gt;<i>
</I>&gt;<i> IIS 8.0 access log:
</I>&gt;<i> ------------
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 184.154.226.5 HTTP/1.0 WordPress/4.0.1;+<A HREF="http://www.nonohitters.com">http://www.nonohitters.com</A>
</I>&gt;<i> ;+verifying+pingback+from+89.248.174.78 - - example.com 200 0 0 26063 199
</I>&gt;<i> 9422
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 77.68.54.144 HTTP/1.0 WordPress/3.4;+<A HREF="http://appyhour.co">http://appyhour.co</A> - - example.com
</I>&gt;<i> 200 0 0 26063 157 8484
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 194.145.201.141 HTTP/1.0 WordPress/4.0.1;+<A HREF="http://microdermal-piercing.nl;+">http://microdermal-piercing.nl;+</A>
</I>&gt;<i> verifying+pingback+from+89.248.174.78 - - example.com 200 0 0 26063 203
</I>&gt;<i> 9843
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 213.5.176.14 HTTP/1.0 WordPress/3.8.5;+<A HREF="http://www.uvac.ac.uk;+verifying+pingback+from+89.248.174.78">http://www.uvac.ac.uk;+verifying+pingback+from+89.248.174.78</A>
</I>&gt;<i> - - example.com 200 0 0 26063 194 8468
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 84.200.79.196 HTTP/1.0 WordPress/4.0;+<A HREF="http://milla.smyck.org">http://milla.smyck.org</A>
</I>&gt;<i> ;+verifying+pingback+from+89.248.174.78 - - example.com 200 0 0 26063 193
</I>&gt;<i> 8453
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 188.93.144.146 HTTP/1.0 WordPress/3.5.1;+<A HREF="http://www.">http://www.</A>
</I>&gt;<i> bastiaanfranken.nl/blog - - example.com 200 0 0 26063 175 9828
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 213.171.218.216 HTTP/1.0 WordPress/4.0.1;+<A HREF="http://www.">http://www.</A>
</I>&gt;<i> wordpress.michaelgrange.co.uk;+verifying+pingback+from+89.248.174.78 - -
</I>&gt;<i> example.com 200 0 0 26063 213 8468
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 174.139.169.10 HTTP/1.0 WordPress/4.0.1;+<A HREF="http://www.zahnarzt-koeln.org">http://www.zahnarzt-koeln.org</A>
</I>&gt;<i> ;+verifying+pingback+from+89.248.174.78 - - example.com 200 0 0 26063 202
</I>&gt;<i> 9734
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 185.38.251.154 HTTP/1.0 WordPress/4.0.1;+<A HREF="http://www.zac-efron.us">http://www.zac-efron.us</A>
</I>&gt;<i> ;+verifying+pingback+from+89.248.174.78 - - example.com 200 0 0 26063 196
</I>&gt;<i> 9047
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 69.27.40.40 HTTP/1.0 WordPress/2.8.5;+<A HREF="http://funktion.catalystexhibit.com">http://funktion.catalystexhibit.com</A>
</I>&gt;<i> - - example.com 200 0 0 26063 213 9953
</I>&gt;<i> 2014-12-03 16:30:08 W3SVC1 WebServer 192.168.1.100 GET /Index.aspx - 80 -
</I>&gt;<i> 85.13.143.156 HTTP/1.0 WordPress/4.0.1;+<A HREF="http://www.">http://www.</A>
</I>&gt;<i> matchanglershop.de/blog;+verifying+pingback+from+89.248.174.78 - -
</I>&gt;<i> example.com 200 0 0 26063 207 9922
</I>&gt;<i> ------------
</I>&gt;<i>
</I>&gt;<i> But need to allow this:
</I>&gt;<i>
</I>&gt;<i> [client 192.168.1.100:13015] ModSecurity: Access denied with code 403
</I>&gt;<i> (phase 1). Pattern match &quot;WordPress/&quot; at REQUEST_HEADERS:User-Agent. [file
</I>&gt;<i> &quot;C:\/Program Files/ModSecurity IIS/owasp_crs/custom/
</I>&gt;<i> modscurity_crs_15_custom.conf&quot;] [line &quot;13&quot;] [id &quot;8&quot;] [msg &quot;Prevent DDos
</I>&gt;<i> from WordPress CMS&quot;] [hostname &quot;WebServer&quot;] [uri
</I>&gt;<i> &quot;/wp-cron.php?doing_wp_cron=1417660712.6131439208984375000000&quot;]
</I>&gt;<i> [unique_id &quot;17654110601569370214&quot;]
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20141204/088bca11/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20141204/088bca11/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001689.html">[Owasp-modsecurity-core-rule-set] Http Flood Attack from list of	WordPress vulnerabilities
</A></li>
	<LI>Next message: <A HREF="001691.html">[Owasp-modsecurity-core-rule-set] malicious file not getting	blocked while uploading
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1690">[ date ]</a>
              <a href="thread.html#1690">[ thread ]</a>
              <a href="subject.html#1690">[ subject ]</a>
              <a href="author.html#1690">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
