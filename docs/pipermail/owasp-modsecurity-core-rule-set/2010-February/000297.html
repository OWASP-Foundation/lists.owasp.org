<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5Bmod-security-users%5D%20base%0A%09rules%20phpids&In-Reply-To=be95b6c51002170523y3f715c46idd49cccb0a721359%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000296.html">
   <LINK REL="Next"  HREF="000298.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5Bmod-security-users%5D%20base%0A%09rules%20phpids&In-Reply-To=be95b6c51002170523y3f715c46idd49cccb0a721359%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids">Ryan.Barnett at breach.com
       </A><BR>
    <I>Wed Feb 17 08:35:45 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000296.html">[Owasp-modsecurity-core-rule-set] basic questions of apache	exploitation &amp; modsecurity.
</A></li>
        <LI>Next message: <A HREF="000298.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#297">[ date ]</a>
              <a href="thread.html#297">[ thread ]</a>
              <a href="subject.html#297">[ subject ]</a>
              <a href="author.html#297">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Tim,
There is a separate email list for the CRS - 
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>

I am cross-posting this thread however.  The security filters taken from PHPIDS are applicable to *all* web applications.  The filters use the same &quot;attack payload detection&quot; approach that the CRS does.  They are not specifically focusing on any PHP vulnerabilities.  They are looking for XSS, SQLi, RFI, etc...  Looking at the rule you listed below, it looks as though it is triggering on some XSS/Javascript data.  If you can post an example audit log entry it may help to diagnose.

-Ryan

________________________________________
From: Timothy Legge [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">timlegge at gmail.com</A>]
Sent: Wednesday, February 17, 2010 8:23 AM
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>
Subject: [mod-security-users] base rules phpids

Hi

We have a couple of pages that are hitting the following rule:

SecRule REQUEST_BODY|REQUEST_URI_RAW|ARGS|ARGS_NAMES|FILES|FILES_NAMES|XML:/*
&quot;(?:\.\s*\w+\W*=)|(?:\W\s*(?:location|document)\s*\W[^({[;]+[({[;])|(?:\(\w+\?[:\w]+\))|(?:\w{2,}\s*=\s*\d+[^&amp;\w]\w+)|(?:\]\s*\(\s*\w+)&quot;
&quot;phase:2,capture,multiMatch,t:none,t:urlDecodeUni,t:urlDecodeUni,t:htmlEntityDecode,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,nolog,auditlog,msg:'Detects
JavaScript location/document property access and window access
obfuscation',id:'phpids-23',tag:'WEB_ATTACK',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}&quot;

Our site is not php is there any good reason to use the phpids rules?

Tim

------------------------------------------------------------------------------
SOLARIS 10 is the OS for Data Centers - provides features such as DTrace,
Predictive Self Healing and Award Winning ZFS. Get Solaris 10 NOW
<A HREF="http://p.sf.net/sfu/solaris-dev2dev">http://p.sf.net/sfu/solaris-dev2dev</A>
_______________________________________________
mod-security-users mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>
<A HREF="https://lists.sourceforge.net/lists/listinfo/mod-security-users">https://lists.sourceforge.net/lists/listinfo/mod-security-users</A>
Commercial ModSecurity Appliances, Rule Sets and Support:
<A HREF="http://www.modsecurity.org/breach/index.html">http://www.modsecurity.org/breach/index.html</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000296.html">[Owasp-modsecurity-core-rule-set] basic questions of apache	exploitation &amp; modsecurity.
</A></li>
	<LI>Next message: <A HREF="000298.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#297">[ date ]</a>
              <a href="thread.html#297">[ thread ]</a>
              <a href="subject.html#297">[ subject ]</a>
              <a href="author.html#297">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
