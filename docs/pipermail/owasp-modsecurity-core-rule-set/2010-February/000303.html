<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [JIRA] Resolved: (CORERULES-26) HTTP error code 501 are returned for localized Indonesian version of Firefox
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5BJIRA%5D%20Resolved%3A%20%28CORERULES-26%29%0A%20HTTP%20error%20code%20501%20are%20returned%20for%20localized%20Indonesian%20version%20of%0A%20Firefox&In-Reply-To=30532388.1267021159702.JavaMail.tomcat%40modsec-apps.colo.breach.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000302.html">
   <LINK REL="Next"  HREF="000304.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [JIRA] Resolved: (CORERULES-26) HTTP error code 501 are returned for localized Indonesian version of Firefox</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5BJIRA%5D%20Resolved%3A%20%28CORERULES-26%29%0A%20HTTP%20error%20code%20501%20are%20returned%20for%20localized%20Indonesian%20version%20of%0A%20Firefox&In-Reply-To=30532388.1267021159702.JavaMail.tomcat%40modsec-apps.colo.breach.com"
       TITLE="[Owasp-modsecurity-core-rule-set] [JIRA] Resolved: (CORERULES-26) HTTP error code 501 are returned for localized Indonesian version of Firefox">Ryan.Barnett at breach.com
       </A><BR>
    <I>Wed Feb 24 09:21:55 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000302.html">[Owasp-modsecurity-core-rule-set] Core Rules version 2.0.5 and	ModSecurity 2.5.11
</A></li>
        <LI>Next message: <A HREF="000304.html">[Owasp-modsecurity-core-rule-set] FW: [JIRA] Resolved: (CORERULES-32) SQL Injection rules should be case-insensitive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#303">[ date ]</a>
              <a href="thread.html#303">[ thread ]</a>
              <a href="subject.html#303">[ subject ]</a>
              <a href="author.html#303">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>
     [ <A HREF="https://www.modsecurity.org/tracker/browse/CORERULES-26?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel">https://www.modsecurity.org/tracker/browse/CORERULES-26?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel</A> ]

Ryan Barnett resolved CORERULES-26.
-----------------------------------

       Resolution: Fixed
    Fix Version/s: 2.0

Fixed in CRS v2.0.6.  Due to the low attack frequency and high false positive rate, I removed REQUEST_HEADERS:User-Agent from inspection for these OS commanding rules.

&gt;<i> HTTP error code 501 are returned for localized Indonesian version of Firefox
</I>&gt;<i> ----------------------------------------------------------------------------
</I>&gt;<i>
</I>&gt;<i>                 Key: CORERULES-26
</I>&gt;<i>                 URL: <A HREF="https://www.modsecurity.org/tracker/browse/CORERULES-26">https://www.modsecurity.org/tracker/browse/CORERULES-26</A>
</I>&gt;<i>             Project: Core Rules
</I>&gt;<i>          Issue Type: Bug
</I>&gt;<i>      Security Level: New
</I>&gt;<i>          Components: False positive
</I>&gt;<i>         Environment: Web Servers:
</I>&gt;<i> 1. CentOS 5.4 on VirtualBox, using compiled Apache (2.2.14) annd compiled Modsecurity (2.1.7)
</I>&gt;<i> 2. Fedora 10 on VirtualBox, using Apache RPM (2.2.11-2.fc10) and Modsecurity RPM (2.5.10-2.fc10)
</I>&gt;<i> Web Browser:
</I>&gt;<i> Firefox Localized Indonesian version, User-Agents:
</I>&gt;<i> &quot;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; id; rv:1.9.2b5pre) Gecko/20091126 Namoroka/3.6b5pre&quot;
</I>&gt;<i>            Reporter: Romi Hardiyanto
</I>&gt;<i>            Assignee: Ryan Barnett
</I>&gt;<i>             Fix For: 2.0
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> At least two localized Firefox are suffering from modsecurity_crs_40_generic_attacks.conf.
</I>&gt;<i> Please see following newsgroup discussions:
</I>&gt;<i> <A HREF="http://groups.google.com/group/mozilla.dev.l10n/browse_thread/thread/a165f75e2947d5ee">http://groups.google.com/group/mozilla.dev.l10n/browse_thread/thread/a165f75e2947d5ee</A>
</I>&gt;<i> I'm testing using
</I>&gt;<i> - Firefox 3.6 (Localized version: Indonesia, nightly build) using following User-Agent: Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; id; rv:1.9.2b5pre) Gecko/20091126 Namoroka/3.6b5pre
</I>&gt;<i> - Firefox 3.6 (Localized version: Indonesia) on other platforms (win32 and linux)
</I>&gt;<i> - Released versions: Firefox 3.5, Firefox 3.0 (Localized version: Indonesia)
</I>&gt;<i> - wget -U &quot;Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10.6; id)&quot;.
</I>&gt;<i> Webserver systems tested are:
</I>&gt;<i> 1. CentOS 5.4 on VirtualBox, using compiled Apache (2.2.14) annd compiled Modsecurity (2.1.7)
</I>&gt;<i> 2. Fedora 10 on VirtualBox, using Apache RPM (2.2.11-2.fc10) and Modsecurity RPM (2.5.10-2.fc10)
</I>&gt;<i> For both system, browsing with mentioned web browser, HTTP error code 501 is returned. Using English/French/Germany version of Firefox doesn't result this HTTP error.
</I>&gt;<i> For system #1 (modsecurity 2.1.7):
</I>&gt;<i> Rule id:950006 (line 105-108 in modsecurity_crs_40_generic_attacks.conf) is causing the problem.
</I>&gt;<i> For system #2 (modsecurity 2.5.10):
</I>&gt;<i> Rule id:958885 (line 254 in modsecurity_crs_40_generic_attacks.conf) is causing the problem. Romansh (locale code: rm) are also suffer from similar rule id:958894, and I suspect future localized Firefox with locale code &quot;ps&quot; will also suffer with rule id:958886.
</I>&gt;<i> Workaround for 2.5.10 is to disable the rule in the configuration, workaround for modsecurity 2.17 is removing string &quot;id&quot; in the regular expression
</I>&gt;<i> More info for Firefox/Mozilla locale codes that currently ships is here:
</I>&gt;<i> - <A HREF="http://l10n.mozilla.org/dashboard/?tree=fx36x">http://l10n.mozilla.org/dashboard/?tree=fx36x</A>
</I>&gt;<i> - <A HREF="http://l10n.mozilla.org/dashboard/?tree=fx35x">http://l10n.mozilla.org/dashboard/?tree=fx35x</A>
</I>&gt;<i> - <A HREF="http://l10n.mozilla.org/dashboard/?tree=fennec10x">http://l10n.mozilla.org/dashboard/?tree=fennec10x</A>
</I>&gt;<i> And guidelines for Mozilla locale codes are on: <A HREF="https://wiki.mozilla.org/L10n:Simple_locale_names">https://wiki.mozilla.org/L10n:Simple_locale_names</A>
</I>
--
This message is automatically generated by JIRA.
-
If you think it was sent incorrectly contact one of the administrators: <A HREF="https://www.modsecurity.org/tracker/secure/Administrators.jspa">https://www.modsecurity.org/tracker/secure/Administrators.jspa</A>
-
For more information on JIRA, see: <A HREF="http://www.atlassian.com/software/jira">http://www.atlassian.com/software/jira</A>


</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000302.html">[Owasp-modsecurity-core-rule-set] Core Rules version 2.0.5 and	ModSecurity 2.5.11
</A></li>
	<LI>Next message: <A HREF="000304.html">[Owasp-modsecurity-core-rule-set] FW: [JIRA] Resolved: (CORERULES-32) SQL Injection rules should be case-insensitive
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#303">[ date ]</a>
              <a href="thread.html#303">[ thread ]</a>
              <a href="subject.html#303">[ subject ]</a>
              <a href="author.html#303">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
