<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5Bmod-security-users%5D%20base%0A%09rules%20phpids&In-Reply-To=be95b6c51002170556y4cabf372i3083217fec6b9b60%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000298.html">
   <LINK REL="Next"  HREF="000300.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20%5Bmod-security-users%5D%20base%0A%09rules%20phpids&In-Reply-To=be95b6c51002170556y4cabf372i3083217fec6b9b60%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids">Ryan.Barnett at breach.com
       </A><BR>
    <I>Wed Feb 17 09:02:30 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000298.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
</A></li>
        <LI>Next message: <A HREF="000300.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#299">[ date ]</a>
              <a href="thread.html#299">[ thread ]</a>
              <a href="subject.html#299">[ subject ]</a>
              <a href="author.html#299">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>If you look in the audit log for transaction, the &quot;data&quot; field in the Message line will tell you what portion of the payload matched the regex.

-Ryan
________________________________________
From: Timothy Legge [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">timlegge at gmail.com</A>]
Sent: Wednesday, February 17, 2010 8:56 AM
To: Ryan Barnett
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Re: [mod-security-users] base rules phpids

Ryan

Thanks, I have subscribed.

I think it is hitting on

selections=5-O%2C6-O&amp;nums=110%2C105&amp;baseAmount=2.00&amp;withTax=2.35&amp;view=all&amp;tab=&amp;ps_viewType=all&amp;baseAmount=2.00&amp;5-O=1.10&amp;6-O=1.05

specifically I think the encoded comma %2C but I am not certain.

Tim



On Wed, Feb 17, 2010 at 9:35 AM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at breach.com</A>&gt; wrote:
&gt;<i> Tim,
</I>&gt;<i> There is a separate email list for the CRS -
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i> I am cross-posting this thread however.  The security filters taken from PHPIDS are applicable to *all* web applications.  The filters use the same &quot;attack payload detection&quot; approach that the CRS does.  They are not specifically focusing on any PHP vulnerabilities.  They are looking for XSS, SQLi, RFI, etc...  Looking at the rule you listed below, it looks as though it is triggering on some XSS/Javascript data.  If you can post an example audit log entry it may help to diagnose.
</I>&gt;<i>
</I>&gt;<i> -Ryan
</I>&gt;<i>
</I>&gt;<i> ________________________________________
</I>&gt;<i> From: Timothy Legge [<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">timlegge at gmail.com</A>]
</I>&gt;<i> Sent: Wednesday, February 17, 2010 8:23 AM
</I>&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>
</I>&gt;<i> Subject: [mod-security-users] base rules phpids
</I>&gt;<i>
</I>&gt;<i> Hi
</I>&gt;<i>
</I>&gt;<i> We have a couple of pages that are hitting the following rule:
</I>&gt;<i>
</I>&gt;<i> SecRule REQUEST_BODY|REQUEST_URI_RAW|ARGS|ARGS_NAMES|FILES|FILES_NAMES|XML:/*
</I>&gt;<i> &quot;(?:\.\s*\w+\W*=)|(?:\W\s*(?:location|document)\s*\W[^({[;]+[({[;])|(?:\(\w+\?[:\w]+\))|(?:\w{2,}\s*=\s*\d+[^&amp;\w]\w+)|(?:\]\s*\(\s*\w+)&quot;
</I>&gt;<i> &quot;phase:2,capture,multiMatch,t:none,t:urlDecodeUni,t:urlDecodeUni,t:htmlEntityDecode,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,nolog,auditlog,msg:'Detects
</I>&gt;<i> JavaScript location/document property access and window access
</I>&gt;<i> obfuscation',id:'phpids-23',tag:'WEB_ATTACK',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}&quot;
</I>&gt;<i>
</I>&gt;<i> Our site is not php is there any good reason to use the phpids rules?
</I>&gt;<i>
</I>&gt;<i> Tim
</I>&gt;<i>
</I>&gt;<i> ------------------------------------------------------------------------------
</I>&gt;<i> SOLARIS 10 is the OS for Data Centers - provides features such as DTrace,
</I>&gt;<i> Predictive Self Healing and Award Winning ZFS. Get Solaris 10 NOW
</I>&gt;<i> <A HREF="http://p.sf.net/sfu/solaris-dev2dev">http://p.sf.net/sfu/solaris-dev2dev</A>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> mod-security-users mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">mod-security-users at lists.sourceforge.net</A>
</I>&gt;<i> <A HREF="https://lists.sourceforge.net/lists/listinfo/mod-security-users">https://lists.sourceforge.net/lists/listinfo/mod-security-users</A>
</I>&gt;<i> Commercial ModSecurity Appliances, Rule Sets and Support:
</I>&gt;<i> <A HREF="http://www.modsecurity.org/breach/index.html">http://www.modsecurity.org/breach/index.html</A>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000298.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
</A></li>
	<LI>Next message: <A HREF="000300.html">[Owasp-modsecurity-core-rule-set] [mod-security-users] base	rules phpids
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#299">[ date ]</a>
              <a href="thread.html#299">[ thread ]</a>
              <a href="subject.html#299">[ subject ]</a>
              <a href="author.html#299">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
