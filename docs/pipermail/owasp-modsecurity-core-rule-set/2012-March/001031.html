<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5D%20Updated%20Rule%20Formatting&In-Reply-To=%3CCAFoCuZrYZk%3DHp1Znm48c5n9Cs2UpxOOCLiNKxB9GqUWREOCF9w%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001030.html">
   <LINK REL="Next"  HREF="001033.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting</H1>
    <B>Klaubert Herr da Silveira</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5D%20Updated%20Rule%20Formatting&In-Reply-To=%3CCAFoCuZrYZk%3DHp1Znm48c5n9Cs2UpxOOCLiNKxB9GqUWREOCF9w%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting">klaubert at gmail.com
       </A><BR>
    <I>Tue Mar 13 23:35:52 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001030.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Updated Rule Formatting
</A></li>
        <LI>Next message: <A HREF="001033.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1031">[ date ]</a>
              <a href="thread.html#1031">[ thread ]</a>
              <a href="subject.html#1031">[ subject ]</a>
              <a href="author.html#1031">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ryan,

it will be more clear to check these diferent aspects of the rule, action,
tags, variables, etc. Sounds good to me, this way you are swapping the very
long lines by a long file... More humam readable :)

Klaubert




On Tue, Mar 13, 2012 at 4:49 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;wrote:

&gt;<i> I am working on updating the current CRS SecRule formatting.  The idea is
</I>&gt;<i> to make the rules easier to read and understand what is happening, for
</I>&gt;<i> example to quickly understand the ACTION line data.
</I>&gt;<i>
</I>&gt;<i> The format is updated to:
</I>&gt;<i>
</I>&gt;<i> 1) Separate the VARIABLE OPERATOR and ACTION sections from each other by
</I>&gt;<i> using the Apache \ line continuation character.
</I>&gt;<i> 2) The 1st ACTION line starts with the rule ID.  This makes it easier to
</I>&gt;<i> find rules of interest.
</I>&gt;<i> 3) The end of the 1st ACTION line lists any disruptive actions.
</I>&gt;<i> 4) Transformation functions have their own line
</I>&gt;<i> 5) Tags have their own line
</I>&gt;<i> 6) Meta-actions (such as setvars) have their own line
</I>&gt;<i> 7) Also including example attack payloads that are detected by the
</I>&gt;<i> OPERATOR to help understand what the regex is looking form
</I>&gt;<i>
</I>&gt;<i> Please review/comment on the updated format below.  I would like to start
</I>&gt;<i> updating the CRS rules to use this format for the 3.0 version.
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ryan Barnett
</I>&gt;<i> Trustwave SpiderLabsModSecurity Project Leader
</I>&gt;<i> OWASP ModSecurity CRS Project Leader
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> #####################################
</I>&gt;<i> #
</I>&gt;<i> # Example Payloads Detected:
</I>&gt;<i> # -------------------------
</I>&gt;<i> # ' or 1=1#
</I>&gt;<i> # ') or ('1'='1--
</I>&gt;<i> # 1 OR \'1\'!=0
</I>&gt;<i> # aaa\' or (1)=(1) #!asd
</I>&gt;<i> # aaa\' OR (1) IS NOT NULL #!asd
</I>&gt;<i> # ' =+ '
</I>&gt;<i> # asd' =- (-'asd') -- -a
</I>&gt;<i> # aa&quot; =+ - &quot;0
</I>&gt;<i> # asd&quot;or-1=&quot;-1
</I>&gt;<i> # asd&quot;or!1=&quot;!1
</I>&gt;<i> # asd&quot;or!(1)=&quot;1
</I>&gt;<i> # asd&quot; or ascii(1)=&quot;49
</I>&gt;<i> # asd' or md5(5)^'1
</I>&gt;<i> # \&quot;asd&quot; or 1=&quot;1
</I>&gt;<i> # ' or id= 1 having 1 #1 !
</I>&gt;<i> # ' or id= 2-1 having 1 #1 !
</I>&gt;<i> # aa'or BINARY 1= '1
</I>&gt;<i> # aa'like-'aa
</I>&gt;<i> # -------------------------
</I>&gt;<i> #
</I>&gt;<i>
</I>&gt;<i> SecRule
</I>&gt;<i> REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:
</I>&gt;<i> /* \
</I>&gt;<i> \
</I>&gt;<i> &quot;(?i)(?i:\d[\&quot;'`&#180;&#185;&#338;]\s+[\&quot;'`&#180;&#185;&#338;]\s+\d)|(?:^admin\s*?[\&quot;'`&#180;&#185;&#338;]|(\/\*)+[\&quot;'`
</I>&gt;<i> &#180;&#185;&#338;]+\s?(?:--|#|\/\*|{)?)|(?:[\&quot;'`&#180;&#185;&#338;]\s*?(x?or|div|like|between|and)[\w\s-
</I>&gt;<i> ]+\s*?[+&lt;&gt;=(),-]\s*?[\d\&quot;'`&#180;&#185;&#338;])|(?:[\&quot;'`&#180;&#185;&#338;]\s*?[^\w\s]?=\s*?[\&quot;'`&#180;&#185;&#338;])|(?
</I>&gt;<i> :[\&quot;'`&#180;&#185;&#338;]\W*?[+=]+\W*?[\&quot;'`&#180;&#185;&#338;])|(?:[\&quot;'`&#180;&#185;&#338;]\s*?[!=|][\d\s!=+-]+.*?[\&quot;'`
</I>&gt;<i> &#180;&#185;&#338;(].*?$)|(?:[\&quot;'`&#180;&#185;&#338;]\s*?[!=|][\d\s!=]+.*?\d+$)|(?:[\&quot;'`&#180;&#185;&#338;]\s*?like\W+[\
</I>&gt;<i> w\&quot;'`&#180;&#185;&#338;(])|(?:\sis\s*?0\W)|(?:where\s[\s\w\.,-]+\s=)|(?:[\&quot;'`&#180;&#185;&#338;][&lt;&gt;~]+[\&quot;
</I>&gt;<i> '`&#180;&#185;&#338;])&quot; \
</I>&gt;<i> \
</I>&gt;<i> &quot;id:'981244',msg:'Detects basic SQL authentication bypass attempts
</I>&gt;<i> 1/3',logdata:'%{TX.0}',severity:'2',phase:2,capture,block, \
</I>&gt;<i> t:none,t:urlDecodeUni, \
</I>&gt;<i> tag:'WEB_ATTACK/SQLI', \
</I>&gt;<i> setvar:'tx.msg=%{rule.id}-%{rule.msg}', \
</I>&gt;<i> setvar:'tx.%{tx.msg}-WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}' \
</I>&gt;<i> setvar:tx.sql_injection_score=+1, \
</I>&gt;<i> setvar:tx.anomaly_score=+%{tx.critical_anomaly_score}&quot;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> This transmission may contain information that is privileged,
</I>&gt;<i> confidential, and/or exempt from disclosure under applicable law. If you
</I>&gt;<i> are not the intended recipient, you are hereby notified that any
</I>&gt;<i> disclosure, copying, distribution, or use of the information contained
</I>&gt;<i> herein (including any reliance thereon) is STRICTLY PROHIBITED. If you
</I>&gt;<i> received this transmission in error, please immediately contact the sender
</I>&gt;<i> and destroy the material in its entirety, whether in electronic or hard
</I>&gt;<i> copy format.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120313/e899d41f/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120313/e899d41f/attachment.html</A>&gt;
</PRE>



<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001030.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread]	Updated Rule Formatting
</A></li>
	<LI>Next message: <A HREF="001033.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1031">[ date ]</a>
              <a href="thread.html#1031">[ thread ]</a>
              <a href="subject.html#1031">[ subject ]</a>
              <a href="author.html#1031">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
