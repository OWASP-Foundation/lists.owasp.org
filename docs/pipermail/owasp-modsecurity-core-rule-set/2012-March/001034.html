<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5D%20Updated%20Rule%20Formatting&In-Reply-To=%3CCB861641.45DB6%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001033.html">
   <LINK REL="Next"  HREF="001032.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20%5BRule%20Update%20-%20Discussion%0A%20Thread%5D%20Updated%20Rule%20Formatting&In-Reply-To=%3CCB861641.45DB6%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Mar 14 13:33:11 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001033.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
</A></li>
        <LI>Next message: <A HREF="001032.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1034">[ date ]</a>
              <a href="thread.html#1034">[ thread ]</a>
              <a href="subject.html#1034">[ subject ]</a>
              <a href="author.html#1034">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Agreed and we do that already with chained rules within the CRS.

-Ryan

From: Josh Amishav-Zlatin &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jamuse at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">jamuse at gmail.com</A>&gt;&gt;
Date: Wed, 14 Mar 2012 03:41:00 -0500
To: Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rbarnett at trustwave.com</A>&gt;&gt;
Cc: &quot;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;&gt;
Subject: Re: [Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting

On Tue, Mar 13, 2012 at 4:49 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">RBarnett at trustwave.com</A>&gt;&gt; wrote:
I am working on updating the current CRS SecRule formatting.  The idea is
to make the rules easier to read and understand what is happening, for
example to quickly understand the ACTION line data.

The format is updated to:

1) Separate the VARIABLE OPERATOR and ACTION sections from each other by
using the Apache \ line continuation character.
2) The 1st ACTION line starts with the rule ID.  This makes it easier to
find rules of interest.
3) The end of the 1st ACTION line lists any disruptive actions.
4) Transformation functions have their own line
5) Tags have their own line
6) Meta-actions (such as setvars) have their own line
7) Also including example attack payloads that are detected by the
OPERATOR to help understand what the regex is looking form

Please review/comment on the updated format below.  I would like to start
updating the CRS rules to use this format for the 3.0 version.


Hi Ryan,

I like new format. IMHO, we can improve readable a bit further by adding indentation to all lines that do not start a rule. That especially helps locate the start of the various rules within a chained rule. For example:

SecRule ARGS test1 &quot;id:123,phase:2,block,chain, \
  setvar:tx.sql_injection_score=+1, \
  setvar:tx.anomaly_score=+%{tx.critical_anomaly_score}&quot;
    SecRule ARGS test2

--
 - Josh

________________________________
This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120314/422970ba/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120314/422970ba/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001033.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
</A></li>
	<LI>Next message: <A HREF="001032.html">[Owasp-modsecurity-core-rule-set] [Rule Update - Discussion Thread] Updated Rule Formatting
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1034">[ date ]</a>
              <a href="thread.html#1034">[ thread ]</a>
              <a href="subject.html#1034">[ subject ]</a>
              <a href="author.html#1034">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
