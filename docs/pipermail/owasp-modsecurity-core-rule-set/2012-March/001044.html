<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Should not the following being blocked by default?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Should%20not%20the%20following%0A%20being%20blocked%20by%20default%3F&In-Reply-To=%3CCB987CCF.488A6%25rbarnett%40trustwave.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001043.html">
   <LINK REL="Next"  HREF="001045.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Should not the following being blocked by default?</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Should%20not%20the%20following%0A%20being%20blocked%20by%20default%3F&In-Reply-To=%3CCB987CCF.488A6%25rbarnett%40trustwave.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Should not the following being blocked by default?">RBarnett at trustwave.com
       </A><BR>
    <I>Wed Mar 28 12:33:55 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="001043.html">[Owasp-modsecurity-core-rule-set] Should not the following being	blocked by default?
</A></li>
        <LI>Next message: <A HREF="001045.html">[Owasp-modsecurity-core-rule-set] Should not the following being blocked by default?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1044">[ date ]</a>
              <a href="thread.html#1044">[ thread ]</a>
              <a href="subject.html#1044">[ subject ]</a>
              <a href="author.html#1044">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>What CRS version are you using?
How do you have the SecRuleEngine configured?  Unless it is set to On, you
can't rely upon returned status codes for detection.
How have you activated the rules?  Are you sure you have the
modsecurity_crs_41_sql_injection_attacks.conf file activated?

I tested your first payload against the latest CRS version and it
triggered many SQLi alerts -

[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(\\\\!\\\\=|\\\\&amp;\\\\&amp;|\\\\|\\\\||&gt;&gt;|&lt;&lt;|&gt;=|&lt;=|&lt;&gt;|&lt;=&gt;|xor|rlike|regexp|
isnull)|(?:not\\\\s+between\\\\s+0\\\\s+and)|(?:is\\\\s+null)|(like\\\\s+nu
ll)|(?:(?:^|\\\\W)in[+\\\\s]*\\\\([\\\\s\\\\d\\&quot;]+[^()]*\\\\))|(?:xor|&lt;&gt;|rl
ike(?:\\\\s+binary)?)|(?:regexp\\\\s+binary))&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;70&quot;] [id &quot;981319&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Injection
Attack: SQL Operator Detected&quot;] [data &quot;REGEXP&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;]
[tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [hostname &quot;localhost&quot;] [uri
&quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:m(?:s(?:ysaccessobjects|msysaces|msysobjects|msysqueries|msysrelati
onships|msysaccessstorage|msysaccessxml|msysmodules|msysmodules2|db)|aster\
\\\.\\\\.sysdatabases|ysql\\\\.db)|s(?:ys(?:\\\\.database_name|aux)|chema(?
:<i>\\\\W*\\\\(|_name)|qlite(_temp)?_master ...&quot; at ARGS:id. [file
</I>&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;84&quot;] [id &quot;981320&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Injection
Attack: Common DB Names Detected&quot;] [data &quot;information_schema&quot;] [severity
&quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag
&quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;]
[hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Operator GE matched 3 at TX:sqli_select_statement_count. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;108&quot;] [id &quot;981317&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL SELECT
Statement Anomaly Detection Alert&quot;] [data &quot;4&quot;] [tag
&quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;]
[tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [hostname &quot;localhost&quot;] [uri
&quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:\\\\b(?:(?:s(?:ys\\\\.(?:user_(?:(?:t(?:ab(?:_column|le)|rigger)|ob
ject|view)s|c(?:onstraints|atalog))|all_tables|tab)|elect\\\\b.{0,40}\\\\b(
?:substring|users?|ascii))|m(?:sys(?:(?:queri|ac)e|relationship|column|obje
ct)s|ysql\\\\.(db|user))|c(?:onstraint ...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;116&quot;] [id &quot;950007&quot;] [rev &quot;2.2.5&quot;] [msg &quot;Blind SQL
Injection Attack&quot;] [data &quot;table_name&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;]
[tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [hostname &quot;localhost&quot;] [uri
&quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:
ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_
user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4
_compat|ipv4_mapped|ipv4|ipv ...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;125&quot;] [id &quot;950001&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Injection
Attack&quot;] [data &quot;SELECT 1 FROM information_schema.tables WHERE&quot;] [severity
&quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag
&quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;]
[hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;\\\\b(?i:having)\\\\b\\\\s+(\\\\d{1,10}|'[^=]{1,10}')\\\\s*[=&lt;&gt;]|(?i:\\\\b
execute(\\\\s{1,5}[\\\\w\\\\.$]{1,5}\\\\s{0,3})?\\\\()|\\\\bhaving\\\\b
?(?:\\\\d{1,10}|[\\\\'\\&quot;][^=]{1,10}[\\\\'\\&quot;])
?[=&lt;&gt;]+|(?i:\\\\bcreate\\\\s+?table.{0,20}?\\\\()|(?i:\\\\blike\\\\W*?char\
\\\W*?\\\\()|(?i:(?:(select(.*) ...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;131&quot;] [id &quot;959070&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Injection
Attack&quot;] [data &quot;FROM information_schema.tables WHERE
TABLE_SCHEMA=\\x22blind_sqli\\x22 AND table_name REGEXP '^[a-z]' LIMIT&quot;]
[severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag
&quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;]
[tag &quot;PCI/6.5.2&quot;] [hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i)\\\\b(?i:and)\\\\b\\\\s+(\\\\d{1,10}|'[^=]{1,10}')\\\\s*[=]|\\\\b(?i:a
nd)\\\\b\\\\s+(\\\\d{1,10}|'[^=]{1,10}')\\\\s*[&lt;&gt;]|\\\\band\\\\b
?(?:\\\\d{1,10}|[\\\\'\\&quot;][^=]{1,10}[\\\\'\\&quot;])
?[=&lt;&gt;]+|\\\\b(?i:and)\\\\b\\\\s+(\\\\d{1,10}|'[^=]{1,10}')&quot; at ARGS:id.
[file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;137&quot;] [id &quot;959072&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Injection
Attack&quot;] [data &quot;and 1=&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag &quot;OWASP_TOP_10/A1&quot;]
[tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;] [hostname &quot;localhost&quot;] [uri
&quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:(?:s(?:t(?:d(?:dev(_pop|_samp)?)?|r(?:_to_date|cmp))|u(?:b(?:str(?:
ing(_index)?)?|(?:dat|tim)e)|m)|e(?:c(?:_to_time|ond)|ssion_user)|ys(?:tem_
user|date)|ha(1|2)?|oundex|chema|ig?n|pace|qrt)|i(?:s(null|_(free_lock|ipv4
_compat|ipv4_mapped|ipv4|ipv ...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;144&quot;] [id &quot;959073&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Injection
Attack&quot;] [data &quot;SELECT 1 FROM information_schema.tables WHERE&quot;] [severity
&quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;WASCTC/WASC-19&quot;] [tag
&quot;OWASP_TOP_10/A1&quot;] [tag &quot;OWASP_AppSensor/CIE1&quot;] [tag &quot;PCI/6.5.2&quot;]
[hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match &quot;\\\\W{4,}&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;155&quot;] [id &quot;960024&quot;] [rev &quot;2.2.5&quot;] [msg &quot;SQL Character
Anomaly Detection Alert - Repetative Non-Word Characters&quot;] [data &quot; '^[&quot;]
[hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;([\\\\~\\\\!\\\\@\\\\#\\\\$\\\\%\\\\^\\\\&amp;\\\\*\\\\(\\\\)\\\\-\\\\+\\\\=\\
\\{\\\\}\\\\[\\\\]\\\\|\\\\:\\\\;\\&quot;\\\\'\\\\\\xc2\\xb4\\\\\\xe2\\x80\\x99\
\\\\\xe2\\x80\\x98\\\\`\\\\&lt;\\\\&gt;].*){4,}&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;171&quot;] [id &quot;981173&quot;] [rev &quot;2.2.5&quot;] [msg &quot;Restricted SQL
Character Anomaly Detection Alert - Total # of special characters
exceeded&quot;] [data &quot;)&quot;] [hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:\\\\sexec\\\\s+xp_cmdshell)|(?:[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2
\\x80\\x98]\\\\s*?!\\\\s*?[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98\\\
\w])|(?:from\\\\W+information_schema\\\\W)|(?:(?:(?:current_)?user|database
|<i>schema|connection_id)\\\\s*?\\\\([^\\\\)]*?)|(?:[\\&quot;'`\\xc2\\xb4\\xe2
</I>...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;219&quot;] [id &quot;981255&quot;] [msg &quot;Detects MSSQL code execution
and information gathering attempts&quot;] [data &quot;FROM information_schema.&quot;]
[severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [hostname &quot;localhost&quot;] [uri
&quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:,.*[)\\\\da-f\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98][\\&quot;'`\\
xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98](?:[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\
xe2\\x80\\x98].*?[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]|\\\\Z|[^\\
&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]+))|(?:\\\\Wselect.+\\\\W*from)
|<i>((?:s ...&quot; at ARGS:id. [file
</I>&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;221&quot;] [id &quot;981257&quot;] [msg &quot;Detects MySQL
comment-/space-obfuscated injections and backtick termination&quot;] [data
&quot;(SELECT 1 FROM&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [hostname
&quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:@.+=\\\\s*?\\\\(\\\\s*?select)|(?:\\\\d+\\\\s*?(x?or|div|like|betwe
en|and)\\\\s*?\\\\d+\\\\s*?[\\\\-+])|(?:\\\\/\\\\w+;?\\\\s+(?:having|and|x?
or|div|like|between|and|select)\\\\W)|(?:\\\\d\\\\s+group\\\\s+by.+\\\\()|(
?:(?:;|#|--)\\\\s*?(?:drop|alter))|(?:(?:;|#|--)\\\\s*?(?:update|i ...&quot; at
ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;223&quot;] [id &quot;981248&quot;] [msg &quot;Detects chained SQL injection
attempts 1/2&quot;] [data &quot;and 1=(&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;WEB_ATTACK/SQLI&quot;] [hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:union\\\\s*?(?:all|distinct|[(!@]*?)?\\\\s*?[([]*?\\\\s*?select)|(?
:<i>\\\\w+\\\\s+like\\\\s+[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98])|(?:
</I>like\\\\s*?[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\%)|(?:[\\&quot;'`\
\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?like\\\\W*?[\\&quot;'`\\xc2\\xb4\
\xe2 ...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;235&quot;] [id &quot;981245&quot;] [msg &quot;Detects basic SQL
authentication bypass attempts 2/3&quot;] [data &quot;SELECT 1 FROM&quot;] [severity
&quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [hostname &quot;localhost&quot;] [uri
&quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?(x?or|div|lik
e|between|and)\\\\s*?[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]?\\\\d)
|<i>(?:\\\\\\\\x(?:23|27|3d))|(?:^.?[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\
</I>\x98]$)|(?:(?:^[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98\\\\\\\\]*?(?:
[\\\\ ...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;249&quot;] [id &quot;981242&quot;] [msg &quot;Detects classic SQL injection
probings 1/2&quot;] [data &quot; information_schema&quot;] [severity &quot;CRITICAL&quot;] [tag
&quot;WEB_ATTACK/SQLI&quot;] [hostname &quot;localhost&quot;] [uri &quot;/index.php&quot;] [unique_id
&quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]
[Wed Mar 28 08:30:23 2012] [error] [client 127.0.0.1] ModSecurity:
Warning. Pattern match
&quot;(?i:(?:[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98]\\\\s*?\\\\*.+(?:x?o
r|div|like|between|and|id)\\\\W*?[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\
\x98]\\\\d)|(?:\\\\^[\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98])|(?:^[\
\\\w\\\\s\\&quot;'`\\xc2\\xb4\\xe2\\x80\\x99\\xe2\\x80\\x98-]+(?&lt;=and\\\\s)(?&lt;=o
r|xor ...&quot; at ARGS:id. [file
&quot;/usr/local/apache/conf/crs/base_rules/modsecurity_crs_41_sql_injection_att
acks.conf&quot;] [line &quot;257&quot;] [id &quot;981243&quot;] [msg &quot;Detects classic SQL injection
probings 2/2&quot;] [data &quot;\\x22 AND table_name REGEXP '^[a-z]' LIMIT 0,1&quot;]
[severity &quot;CRITICAL&quot;] [tag &quot;WEB_ATTACK/SQLI&quot;] [hostname &quot;localhost&quot;] [uri
&quot;/index.php&quot;] [unique_id &quot;T3MEX8CoqAEAAWNHI4gAAAAE&quot;]





On 3/28/12 2:18 AM, &quot;Tzury Bar Yochay&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">tzury.by at reguluslabs.com</A>&gt; wrote:

&gt;<i>Hi,
</I>&gt;<i>
</I>&gt;<i>below is an output of a small program I wrote to test sites protected
</I>&gt;<i>by modSecurity
</I>&gt;<i>I tried pushing in some SQL injection tests and was surprised to find
</I>&gt;<i>out the following just passed through and not being blocked despite
</I>&gt;<i>having all default rules active)
</I>&gt;<i>
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables+WHERE+TABLE
</I>&gt;<i>_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^[a-z]'+LIMIT+0,1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables++WHERE+TABL
</I>&gt;<i>E_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^[a-n]'+LIMIT+0,1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables++WHERE+TABL
</I>&gt;<i>E_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^[a-g]'+LIMIT+0,1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables++WHERE+TABL
</I>&gt;<i>E_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^[h-n]'+LIMIT+0,1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables++WHERE+TABL
</I>&gt;<i>E_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^[h-l]'+LIMIT+0,1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables++WHERE+TABL
</I>&gt;<i>E_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^m'+LIMIT+0,1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables++WHERE+TABL
</I>&gt;<i>E_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^n'+LIMIT+0,1)+
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+information_schema.tables++WHERE+TABL
</I>&gt;<i>E_SCHEMA=&quot;blind_sqli&quot;+AND+table_name+REGEXP+'^n'+LIMIT+1,1)+
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/default.asp?id=1+AND+1=(SELECT+TOP+1+1+FROM+information_schema.tables+WHE
</I>&gt;<i>RE+TABLE_SCHEMA=&quot;blind_sqli&quot;+and+table_name+LIKE+'[a-z]%'+)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/default.asp?id=1+AND+1=(SELECT+TOP+1+1+FROM+information_schema.tables+WHE
</I>&gt;<i>RE+TABLE_SCHEMA=&quot;blind_sqli&quot;+and+table_name+NOT+IN+(+SELECT+TOP+1+table_na
</I>&gt;<i>me+FROM+information_schema.tables)+and+table_name+LIKE+'[a-z]%'+)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+users+WHERE+password+REGEXP+'^[a-f]'+
</I>&gt;<i>AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+users+WHERE+password+REGEXP+'^[0-9]'+
</I>&gt;<i>AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+users+WHERE+password+REGEXP+'^[0-4]'+
</I>&gt;<i>AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+users+WHERE+password+REGEXP+'^[5-9]'+
</I>&gt;<i>AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+users+WHERE+password+REGEXP+'^[5-7]'+
</I>&gt;<i>AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/index.php?id=1+and+1=(SELECT+1+FROM+users+WHERE+password+REGEXP+'^5'+AND+
</I>&gt;<i>ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/default.asp?id=1+AND+1=(SELECT+1+FROM+users+WHERE+password+LIKE+'5[a-f]%'
</I>&gt;<i>+AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/default.asp?id=1+AND+1=(SELECT+1+FROM+users+WHERE+password+LIKE+'5[a-c]%'
</I>&gt;<i>+AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/default.asp?id=1+AND+1=(SELECT+1+FROM+users+WHERE+password+LIKE+'5[d-f]%'
</I>&gt;<i>+AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/default.asp?id=1+AND+1=(SELECT+1+FROM+users+WHERE+password+LIKE+'5[d-e]%'
</I>&gt;<i>+AND+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/default.asp?id=1+AND+1=(SELECT+1+FROM+users+WHERE+password+LIKE+'5f%'+AND
</I>&gt;<i>+ID=1)
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET --
</I>&gt;<i>/<A HREF="http://example/article.asp?ID=2+union+all+select+name+from+sysobjects">http://example/article.asp?ID=2+union+all+select+name+from+sysobjects</A>
</I>&gt;<i>{}. Expected: &lt;class 'requests.exceptions.ConnectionError'&gt;, got 200
</I>&gt;<i>instead
</I>&gt;<i>test failed: GET -- /article.asp?ID=2'+and+1=1 {}. Expected: &lt;class
</I>&gt;<i>'requests.exceptions.ConnectionError'&gt;, got 200 instead
</I>&gt;<i>test failed: GET -- /article.asp?ID=2'+and+1=0+ {}. Expected: &lt;class
</I>&gt;<i>'requests.exceptions.ConnectionError'&gt;, got 200 instead
</I>&gt;<i>_______________________________________________
</I>&gt;<i>Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i><A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.

</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001043.html">[Owasp-modsecurity-core-rule-set] Should not the following being	blocked by default?
</A></li>
	<LI>Next message: <A HREF="001045.html">[Owasp-modsecurity-core-rule-set] Should not the following being blocked by default?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1044">[ date ]</a>
              <a href="thread.html#1044">[ thread ]</a>
              <a href="subject.html#1044">[ subject ]</a>
              <a href="author.html#1044">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
