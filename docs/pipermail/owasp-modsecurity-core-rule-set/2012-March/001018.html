<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Mod security is not detecting	double header's
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Mod%20security%20is%20not%20detecting%0A%09double%20header%27s&In-Reply-To=%3CCA%2BVXBuur0YH80_-DxEE%3DVWy_RUbhWA2VMpLj7fE-KnANZP34-Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="001019.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Mod security is not detecting	double header's</H1>
    <B>Gagandeep Singh</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Mod%20security%20is%20not%20detecting%0A%09double%20header%27s&In-Reply-To=%3CCA%2BVXBuur0YH80_-DxEE%3DVWy_RUbhWA2VMpLj7fE-KnANZP34-Q%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Mod security is not detecting	double header's">gagandeepsohi at gmail.com
       </A><BR>
    <I>Thu Mar  1 17:15:36 UTC 2012</I>
    <P><UL>
        
        <LI>Next message: <A HREF="001019.html">[Owasp-modsecurity-core-rule-set] Mod security is not detecting double header's
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1018">[ date ]</a>
              <a href="thread.html#1018">[ thread ]</a>
              <a href="subject.html#1018">[ subject ]</a>
              <a href="author.html#1018">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi

We have configured modsecurity apache_2.6.3 and its working fine for most
of the cases but we have identified a special attack which is causing a
double header injection to the site.

Example :-
 <A HREF="https://www.XYZ.com/%0d%0aLocation:http://www.google.com&lt;https://www.xyz.com/%0d%0aLocation:http://www.google.com">https://www.XYZ.com/%0d%0aLocation:http://www.google.com&lt;https://www.xyz.com/%0d%0aLocation:http://www.google.com</A>&gt;
 Note - XYZ is any site.

This generates a Duplicate headers error page which is shown below-

Duplicate headers received from the server
&gt;<i>
</I>

&gt;<i> The response from the server contained duplicate headers. This problem is
</I>&gt;<i> generally the result of a misconfigured website or proxy. Only the website
</I>&gt;<i> or proxy administrator can fix this issue.
</I>&gt;<i>
</I>

&gt;<i>  Error 350 (net::ERR_RESPONSE_HEADERS_MULTIPLE_LOCATION): Multiple
</I>&gt;<i> Location headers received. This is disallowed to protect against HTTP
</I>&gt;<i> response-splitting attacks.
</I>


As per the discussion with Bren we came to know that this will be fixed in
CRS 2.2.4 but we need this urgently, Is it possible to get the rule for
above issue so we can apply the patch for the time being and will apply
2.2.4 soon as it becomes available.

Could you please also assist on this, what configuration changes are
required to handle this?

Regards
Gagandeep Singh  Sohi
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120301/c7328cde/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20120301/c7328cde/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="001019.html">[Owasp-modsecurity-core-rule-set] Mod security is not detecting double header's
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1018">[ date ]</a>
              <a href="thread.html#1018">[ thread ]</a>
              <a href="subject.html#1018">[ subject ]</a>
              <a href="author.html#1018">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
