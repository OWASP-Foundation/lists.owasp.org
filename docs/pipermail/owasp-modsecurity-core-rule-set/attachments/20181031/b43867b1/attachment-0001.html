<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;Hi&nbsp;Venki,&lt;/div&gt;&lt;div&gt;first&nbsp;of&nbsp;all&nbsp;it&nbsp;should&nbsp;be&nbsp;helpful&nbsp;to&nbsp;know&nbsp;about&nbsp;the&nbsp;version&nbsp;of&nbsp;modsecurity,&nbsp;OS&nbsp;and&nbsp;web&nbsp;server&nbsp;you&nbsp;are&nbsp;using&nbsp;for&nbsp;your&nbsp;tests.&nbsp;Then,&nbsp;I&nbsp;would&nbsp;suggest&nbsp;you&nbsp;to&nbsp;use&nbsp;OWASP&nbsp;CRS&nbsp;v3,&nbsp;that&nbsp;should&nbsp;block&nbsp;you&nbsp;request&nbsp;out-of-the-shelf&nbsp;with&nbsp;at&nbsp;least&nbsp;a&nbsp;couple&nbsp;of&nbsp;rules&nbsp;already&nbsp;in&nbsp;paranoia&nbsp;level&nbsp;1.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Assuming&nbsp;that&nbsp;you&nbsp;are&nbsp;using&nbsp;modsec&nbsp;version&nbsp;2&nbsp;not&nbsp;3,&nbsp;if&nbsp;you&nbsp;can&#39;t&nbsp;adopt&nbsp;CRS,&nbsp;please&nbsp;try&nbsp;enabling&nbsp;the&nbsp;K&nbsp;section&nbsp;in&nbsp;your&nbsp;audit&nbsp;log:&lt;/div&gt;&lt;div&gt;&quot;K:&nbsp;This&nbsp;part&nbsp;contains&nbsp;a&nbsp;full&nbsp;list&nbsp;of&nbsp;every&nbsp;rule&nbsp;that&nbsp;matched&nbsp;(one&nbsp;per&nbsp;line)&nbsp;in&nbsp;the&nbsp;order&nbsp;they&nbsp;were&nbsp;matched.&nbsp;The&nbsp;rules&nbsp;are&nbsp;fully&nbsp;qualified&nbsp;and&nbsp;will&nbsp;thus&nbsp;show&nbsp;inherited&nbsp;actions&nbsp;and&nbsp;default&nbsp;operators.&quot;&nbsp;Rif. &lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#SecAuditLogParts&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#SecAuditLogParts&lt;/a&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Also,&nbsp;if&nbsp;this&nbsp;won&#39;t&nbsp;help&nbsp;you,&nbsp;the&nbsp;final&nbsp;and&nbsp;always&nbsp;helpful&nbsp;action&nbsp;to&nbsp;do&nbsp;is&nbsp;tracing&nbsp;modsec&nbsp;activities&nbsp;using&nbsp;its&nbsp;debug&nbsp;feature&nbsp;with&nbsp;directives&nbsp;SecDebugLog&nbsp;and&nbsp;SecDebugLogLevel&nbsp;(Rif.&nbsp;&lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#SecDebugLog&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#SecDebugLog&lt;/a&gt;).&nbsp;You&nbsp;can&nbsp;enable&nbsp;it&nbsp;also&nbsp;on&nbsp;specific&nbsp;requests&nbsp;using&nbsp;&quot;ctl&quot;&nbsp;action&nbsp;in&nbsp;a&nbsp;matching&nbsp;rule&nbsp;(Rif. &lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#ctl&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual-%28v2.x%29#ctl&lt;/a&gt;).&lt;/div&gt;&lt;div&gt;Once&nbsp;you&nbsp;have&nbsp;debug&nbsp;enabled&nbsp;and&nbsp;configured,&nbsp;repeat&nbsp;your&nbsp;curl&nbsp;request&nbsp;and&nbsp;locate&nbsp;your&nbsp;rule&nbsp;number&nbsp;in&nbsp;the&nbsp;debug&nbsp;log;&nbsp;there&nbsp;you&nbsp;will&nbsp;find&nbsp;all&nbsp;you&nbsp;need&nbsp;for&nbsp;understanding&nbsp;what&#39;s&nbsp;going&nbsp;wrong&nbsp;with&nbsp;your&nbsp;rule.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Just&nbsp;for&nbsp;information,&nbsp;with&nbsp;your&nbsp;rule&nbsp;and&nbsp;passing&nbsp;the&nbsp;request&nbsp;you&nbsp;pointed,&nbsp;in&nbsp;main&nbsp;environment&nbsp;it&nbsp;is&nbsp;blocked.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Regards&lt;/div&gt;&lt;div&gt;Paolo&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;<br>
Hi,&lt;br&gt;<br>
We&nbsp;have&nbsp;a&nbsp;secrule&nbsp;like&nbsp;this&nbsp;:&lt;br&gt;<br>
&#39;SecRule&nbsp;REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&lt;br&gt;<br>
&quot;(fromcharcode|alert|eval)\s*\(&quot;&nbsp;\&lt;br&gt;<br>
 &quot;phase:2,rev:&#39;2.0.10&#39;,id:&#39;973307&#39;,capture,t:none,t:htmlEntityDecode,t:jsDecode,t:lowercase,pass,nolog,auditlog,msg:&#39;XSS&lt;br&gt;<br>
Attack&lt;br&gt;<br>
Detected&#39;,logdata:&#39;%{TX.0}&#39;,setvar:&#39;tx.msg=%{rule.msg}&#39;,setvar:tx.xss_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-WEB_ATTACK/XSS-%{matched_var_name}=%{tx.0}&quot;&#39;&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;user&nbsp;supplies&nbsp;url&nbsp;like&nbsp;this&nbsp;:&lt;br&gt;<br>
&lt;br&gt;<br>
 &lt;hostname&gt;?param1=test%27,alert(document.cookie),%27test&amp;param2&lt;br&gt;<br>
&lt;br&gt;<br>
Its&nbsp;not&nbsp;being&nbsp;blocked.&nbsp;Please&nbsp;suggest&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
Thanks,&lt;br&gt;<br>
Venki&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
