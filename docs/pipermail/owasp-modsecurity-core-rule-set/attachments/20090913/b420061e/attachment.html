<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'DejaVu&nbsp;Sans';&nbsp;font-size:9pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;On&nbsp;Sunday&nbsp;13&nbsp;September&nbsp;2009&nbsp;02:38:39&nbsp;am&nbsp;OSSEC&nbsp;junkie&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;I'm&nbsp;testing&nbsp;this&nbsp;with&nbsp;Firefox&nbsp;and&nbsp;Chrome&nbsp;using&nbsp;this&nbsp;payload,&lt;br&gt;<br>
&amp;gt;&nbsp;1%22;}eval%28%27al%27%2b%27ert%28docu%27%2b%27ment.c%27%2b%27ookie%29%27%29&lt;br&gt;<br>
&amp;gt;;function%20a%28%29{var%20a=%22&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;But&nbsp;it&nbsp;never&nbsp;gets&nbsp;caught,&nbsp;even&nbsp;with&nbsp;the&nbsp;phpids&nbsp;filters&nbsp;applied,&nbsp;did&lt;br&gt;<br>
&amp;gt;&nbsp;not&nbsp;modify&nbsp;them,&nbsp;left&nbsp;as&nbsp;is.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Works&nbsp;fine&nbsp;for&nbsp;me.&nbsp;&nbsp;I&nbsp;sent&nbsp;your&nbsp;payload&nbsp;and&nbsp;the&nbsp;error_log&nbsp;showed&nbsp;this&nbsp;(indicating&nbsp;that&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;was&nbsp;60)&nbsp;-&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;[Sun&nbsp;Sep&nbsp;13&nbsp;08:15:55&nbsp;2009]&nbsp;[error]&nbsp;[client&nbsp;127.0.0.1]&nbsp;ModSecurity:&nbsp;Warning.&nbsp;Operator&nbsp;GE&nbsp;matched&nbsp;5&nbsp;at&nbsp;TX:anomaly_score.&nbsp;[file&nbsp;&quot;/usr/local/apache/conf/modsecurity-crs_2.0.2/base_rules/modsecurity_crs_60_correlation.conf&quot;]&nbsp;[line&nbsp;&quot;41&quot;]&nbsp;[msg&nbsp;&quot;Transactional&nbsp;Anomaly&nbsp;Score&nbsp;(score&nbsp;60):&nbsp;Detects&nbsp;JavaScript&nbsp;language&nbsp;constructs&quot;]&nbsp;[hostname&nbsp;&quot;localhost&quot;]&nbsp;[uri&nbsp;&quot;/example.php&quot;]&nbsp;[unique_id&nbsp;&quot;Sqzie38AAQEAABXNKDEAAAAA&quot;]&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Here&nbsp;is&nbsp;the&nbsp;data&nbsp;from&nbsp;the&nbsp;modsec_audit.log.&nbsp;&nbsp;Notice&nbsp;under&nbsp;section&nbsp;H&nbsp;that&nbsp;there&nbsp;are&nbsp;3&nbsp;phpids&nbsp;rules&nbsp;that&nbsp;trigger&nbsp;on&nbsp;this&nbsp;payload&nbsp;-&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;--4533267f-A--&lt;br&gt;<br>
[13/Sep/2009:08:15:55&nbsp;--0400]&nbsp;Sqzie38AAQEAABXNKDEAAAAA&nbsp;127.0.0.1&nbsp;41838&nbsp;127.0.0.1&nbsp;80&lt;br&gt;<br>
--4533267f-B--&lt;br&gt;<br>
GET&nbsp;/example.php?test=1%20;%7Deval%20%20AL%20%2B%20ERT%20DOCU%20%2B%20MENT.C%20%2B%20OOKIE%20%20%20;function%20a%20%20%7Bvar%20a=%20&nbsp;HTTP/1.1&lt;br&gt;<br>
Host:&nbsp;localhost&lt;br&gt;<br>
User-Agent:&nbsp;Mozilla/5.0&nbsp;(X11;&nbsp;U;&nbsp;Linux&nbsp;i686;&nbsp;en-US;&nbsp;rv:1.9.1.3)&nbsp;Gecko/20090824&nbsp;Firefox/3.5.3&lt;br&gt;<br>
Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&lt;br&gt;<br>
Accept-Language:&nbsp;en-us,en;q=0.5&lt;br&gt;<br>
Accept-Encoding:&nbsp;gzip,deflate&lt;br&gt;<br>
Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7&lt;br&gt;<br>
Keep-Alive:&nbsp;300&lt;br&gt;<br>
Connection:&nbsp;keep-alive&lt;br&gt;<br>
Pragma:&nbsp;no-cache&lt;br&gt;<br>
Cache-Control:&nbsp;no-cache&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;--4533267f-F--&lt;br&gt;<br>
HTTP/1.1&nbsp;403&nbsp;Forbidden&lt;br&gt;<br>
Content-Length:&nbsp;213&lt;br&gt;<br>
Keep-Alive:&nbsp;timeout=5,&nbsp;max=100&lt;br&gt;<br>
Connection:&nbsp;Keep-Alive&lt;br&gt;<br>
Content-Type:&nbsp;text/html;&nbsp;charset=iso-8859-1&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;--4533267f-H--&lt;br&gt;<br>
Message:&nbsp;Pattern&nbsp;match&nbsp;&quot;(?:,\s*(?:alert|showmodaldialog|eval)\s*,)|(?::\s*eval\s*[^\s])|([^:\s\w,.\/?+-]\s*)?(?&amp;lt;![a-z\/_@])(\s*return\s*)?(?:(?:document\s*\.)?(?:.+\/)?(?:alert|eval|msgbox|showmodaldialog|prompt|write(?:ln)?|confirm|dialog|open))\s*(?(1)[^\w]|(?:\s*[^\s\w,.@\&nbsp;...&quot;&nbsp;at&nbsp;REQUEST_URI_RAW.&nbsp;[file&nbsp;&quot;/usr/local/apache/conf/modsecurity-crs_2.0.2/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]&nbsp;[line&nbsp;&quot;47&quot;]&nbsp;[id&nbsp;&quot;phpids-21&quot;]&nbsp;[msg&nbsp;&quot;Detects&nbsp;very&nbsp;basic&nbsp;XSS&nbsp;probings&quot;]&nbsp;[data&nbsp;&quot;}eval&nbsp;&quot;]&nbsp;[severity&nbsp;&quot;CRITICAL&quot;]&nbsp;[tag&nbsp;&quot;WEB_ATTACK&quot;]&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Message:&nbsp;Pattern&nbsp;match&nbsp;&quot;([^*\s\w,.\/?+-]\s*)?(?&amp;lt;![a-mo-z]\s)(?&amp;lt;![a-z\/_@&amp;gt;\-\|])(\s*return\s*)?(?:alert|inputbox|showmodaldialog|infinity|isnan|isnull|msgbox|expression|prompt|write(?:ln)?|confirm|dialog|urn|(?:un)?eval|exec|execscript|tostring|status|execute|window|unescape|n&nbsp;...&quot;&nbsp;at&nbsp;REQUEST_URI_RAW.&nbsp;[file&nbsp;&quot;/usr/local/apache/conf/modsecurity-crs_2.0.2/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]&nbsp;[line&nbsp;&quot;55&quot;]&nbsp;[id&nbsp;&quot;phpids-16&quot;]&nbsp;[msg&nbsp;&quot;Detects&nbsp;possible&nbsp;includes&nbsp;and&nbsp;typical&nbsp;script&nbsp;methods&quot;]&nbsp;[data&nbsp;&quot;}eval&nbsp;&quot;]&nbsp;[severity&nbsp;&quot;CRITICAL&quot;]&nbsp;[tag&nbsp;&quot;WEB_ATTACK&quot;]&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Message:&nbsp;Pattern&nbsp;match&nbsp;&quot;([^*:\s\w,.\/?+-]\s*)?(?&amp;lt;![a-z]\s)(?&amp;lt;![a-z_@&amp;gt;\|])(\s*return\s*)?(?:globalstorage|sessionstorage|postmessage|callee|constructor|content|domain|prototype|try|catch|top|call|apply|url|function|object|array|string|math|if|elseif|case|switch|regex|boolean|l&nbsp;...&quot;&nbsp;at&nbsp;REQUEST_URI_RAW.&nbsp;[file&nbsp;&quot;/usr/local/apache/conf/modsecurity-crs_2.0.2/base_rules/modsecurity_crs_41_phpids_filters.conf&quot;]&nbsp;[line&nbsp;&quot;67&quot;]&nbsp;[id&nbsp;&quot;phpids-20&quot;]&nbsp;[msg&nbsp;&quot;Detects&nbsp;JavaScript&nbsp;language&nbsp;constructs&quot;]&nbsp;[data&nbsp;&quot;;function&nbsp;&quot;]&nbsp;[severity&nbsp;&quot;CRITICAL&quot;]&nbsp;[tag&nbsp;&quot;WEB_ATTACK&quot;]&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Message:&nbsp;Warning.&nbsp;Operator&nbsp;GE&nbsp;matched&nbsp;5&nbsp;at&nbsp;TX:anomaly_score.&nbsp;[file&nbsp;&lt;br&gt;<br>
&quot;/usr/local/apache/conf/modsecurity-crs_2.0.2/base_rules/modsecurity_crs_60_correlation.conf&quot;]&nbsp;[line&nbsp;&quot;41&quot;]&nbsp;[msg&nbsp;&quot;Transactional&nbsp;Anomaly&nbsp;Score&nbsp;(score&nbsp;60):&nbsp;Detects&nbsp;JavaScript&nbsp;language&nbsp;constructs&quot;]&lt;br&gt;<br>
Action:&nbsp;Intercepted&nbsp;(phase&nbsp;2)&lt;br&gt;<br>
Stopwatch:&nbsp;1252844155385934&nbsp;200058&nbsp;(4259&nbsp;199045&nbsp;-)&lt;br&gt;<br>
Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.5.10-dev1&nbsp;(http://www.modsecurity.org/);&nbsp;core&nbsp;ruleset/2.0.2.&lt;br&gt;<br>
Server:&nbsp;Apache/2.2.12&nbsp;(Unix)&nbsp;mod_ssl/2.2.12&nbsp;OpenSSL/0.9.8g&nbsp;DAV/2&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&amp;gt;&nbsp;The&nbsp;only&nbsp;time&nbsp;it&nbsp;gets&nbsp;caught&nbsp;is&nbsp;when&nbsp;my&nbsp;browser&nbsp;changes&nbsp;the&nbsp;payload&lt;br&gt;<br>
&amp;gt;&nbsp;to:&lt;br&gt;<br>
&amp;gt;&nbsp;1&quot;;}eval('al'%2b'ert(docu'%2b'ment.c'%2b'ookie)');function%20a(){var%20a=&quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Then&nbsp;ModSecurity&nbsp;picks&nbsp;it&nbsp;up,&nbsp;but&nbsp;every&nbsp;other&nbsp;time&nbsp;I&nbsp;try&nbsp;with&nbsp;the&nbsp;1%22&lt;br&gt;<br>
&amp;gt;&nbsp;...&nbsp;payload...it&nbsp;just&nbsp;gets&nbsp;right&nbsp;past&nbsp;ModSecurity..any&nbsp;ideas?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;The&nbsp;rules&nbsp;are&nbsp;using&nbsp;t:urlDecodeUni&nbsp;which&nbsp;will&nbsp;perform&nbsp;url&nbsp;decoding.&nbsp;&nbsp;Did&nbsp;you&nbsp;review&nbsp;the&nbsp;debug&nbsp;log&nbsp;to&nbsp;see&nbsp;what&nbsp;is&nbsp;happening?&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
