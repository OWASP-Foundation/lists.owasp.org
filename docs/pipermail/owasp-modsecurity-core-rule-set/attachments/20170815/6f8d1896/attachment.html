<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Great!&nbsp;Thanks&nbsp;Christian!&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;did&nbsp;try&nbsp;and&nbsp;figure&nbsp;out&nbsp;what&nbsp;was&nbsp;going&nbsp;on&nbsp;with&nbsp;the&nbsp;higher&nbsp;debug&nbsp;log&nbsp;levels,&nbsp;but&nbsp;didn&#39;t&nbsp;realise&nbsp;that&nbsp;was&nbsp;what&nbsp;was&nbsp;happening.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;by&nbsp;&quot;steering&nbsp;commando&nbsp;rules&quot;&nbsp;you&nbsp;mean&nbsp;the&nbsp;rules&nbsp;that&nbsp;check&nbsp;which&nbsp;paranoia&nbsp;level&nbsp;is&nbsp;set,&nbsp;and&nbsp;then&nbsp;jump&nbsp;to&nbsp;the&nbsp;marker&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;file?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;e.g.&nbsp;SecRule&nbsp;TX:PARANOIA_LEVEL&nbsp;&quot;@lt&nbsp;1&quot;&nbsp;&quot;phase:1,id:942011,nolog,pass,skipAfter:END-REQUEST-942-APPLICATION-ATTACK-SQLI&quot;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;In&nbsp;the&nbsp;SQLi&nbsp;include&nbsp;file,&nbsp;these&nbsp;rules&nbsp;are&nbsp;all&nbsp;numbered&nbsp;942011-18,&nbsp;so&nbsp;I&nbsp;changed&nbsp;the&nbsp;rules&nbsp;to&nbsp;only&nbsp;alter&nbsp;the&nbsp;rules&nbsp;from&nbsp;942100-942999.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;following&nbsp;config&nbsp;then&nbsp;works!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;&lt;div&gt;Include&nbsp;modsecurity/crs-setup.conf&lt;/div&gt;&lt;div&gt;Include&nbsp;crs/*.conf&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;#&nbsp;Disable&nbsp;CRS&#39;s&nbsp;SQLi&nbsp;rules:&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!REQUEST_COOKIES&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!REQUEST_COOKIES_NAMES&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!ARGS_NAMES&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!ARGS&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!XML&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;Only&nbsp;test&nbsp;SQLi&nbsp;for&nbsp;the&nbsp;SearchTerm&nbsp;parameter&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;ARGS:SearchTerm&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;After&nbsp;this,&nbsp;the&nbsp;SQLi&nbsp;rules&nbsp;are&nbsp;disabled&nbsp;for&nbsp;all&nbsp;cookies,&nbsp;arguments&nbsp;and&nbsp;XML,&nbsp;and&nbsp;then&nbsp;only&nbsp;re-enabled&nbsp;for&nbsp;my&nbsp;one&nbsp;parameter&nbsp;name.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Next,&nbsp;I&nbsp;attempted&nbsp;to&nbsp;do&nbsp;this&nbsp;at&nbsp;runtime,&nbsp;so&nbsp;I&nbsp;could&nbsp;apply&nbsp;the&nbsp;rules&nbsp;to&nbsp;only&nbsp;my&nbsp;particular&nbsp;page:&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@beginsWith&nbsp;/product/search&quot;&nbsp;\&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp;&quot;id:2011,phase:2,\&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;pass,nolog,\&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;t:none,t:lowercase,t:normalisePath,\&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;ctl:ruleUpdateTargetById=942100-942999;ARGS:SearchTerm&quot;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;However,&nbsp;the&nbsp;ctl:ruleUpdateTargetById&nbsp;action&nbsp;doesn&#39;t&nbsp;work&nbsp;-&nbsp;I&nbsp;was&nbsp;lead&nbsp;astray&nbsp;by&nbsp;the&nbsp;Mod&nbsp;Security&nbsp;Handbook,&nbsp;which&nbsp;is&nbsp;a&nbsp;bit&nbsp;out&nbsp;of&nbsp;date&nbsp;(at&nbsp;this&nbsp;url: &lt;a&nbsp;href=&quot;https://www.feistyduck.com/library/modsecurity-handbook-2ed/online/xx1-directives.html#N15992&quot;&gt;https://www.feistyduck.com/library/modsecurity-handbook-2ed/online/xx1-directives.html#N15992&lt;/a&gt;).&nbsp;It&nbsp;looks&nbsp;like&nbsp;that&nbsp;got&nbsp;removed:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;Note&nbsp;:&nbsp;There&nbsp;was&nbsp;a&nbsp;ctl:ruleUpdateTargetById&nbsp;introduced&nbsp;in&nbsp;2.6.0&nbsp;and&nbsp;removed&nbsp;from&nbsp;the&nbsp;code&nbsp;in&nbsp;2.7.0.&nbsp;JSON&nbsp;was&nbsp;added&nbsp;as&nbsp;part&nbsp;of&nbsp;v2.8.0-rc1&lt;/div&gt;&lt;div&gt;(from &lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#ctl&lt;/a&gt;)&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;you&nbsp;have&nbsp;any&nbsp;ideas&nbsp;on&nbsp;how&nbsp;to&nbsp;further&nbsp;restrict&nbsp;it&nbsp;so&nbsp;I&nbsp;can&nbsp;rule&nbsp;the&nbsp;SQLi&nbsp;rules&nbsp;for&nbsp;only&nbsp;one&nbsp;page&nbsp;+&nbsp;parameter&nbsp;combo,&nbsp;I&#39;m&nbsp;interested&nbsp;to&nbsp;know!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Kirk&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Aug&nbsp;15,&nbsp;2017&nbsp;at&nbsp;7:10&nbsp;PM,&nbsp;Christian&nbsp;Folini&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&nbsp;target=&quot;_blank&quot;&gt;christian.folini@netnea.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Kirk,&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;is&nbsp;a&nbsp;tricky&nbsp;one.&nbsp;Actually&nbsp;your&nbsp;recipe&nbsp;should&nbsp;work.&nbsp;But&nbsp;then&nbsp;it&nbsp;does&lt;br&gt;<br>
not.&nbsp;I&nbsp;dug&nbsp;a&nbsp;bit&nbsp;deeper&nbsp;and&nbsp;found&nbsp;out&nbsp;an&nbsp;issue.&lt;br&gt;<br>
&lt;br&gt;<br>
SecRuleUpdateTargetByID&nbsp;942000-942999&nbsp;&quot;ARGS:SearchTerm&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
adds&nbsp;the&nbsp;arg&nbsp;SearchTerm&nbsp;to&nbsp;all&nbsp;rules&nbsp;including&nbsp;steering&nbsp;commando&nbsp;rules&lt;br&gt;<br>
used&nbsp;for&nbsp;Paranoia&nbsp;Levels.&nbsp;And&nbsp;this&nbsp;seems&nbsp;to&nbsp;f**k&nbsp;them&nbsp;up.&nbsp;At&nbsp;least&nbsp;this&lt;br&gt;<br>
is&nbsp;my&nbsp;first&nbsp;impression.&lt;br&gt;<br>
&lt;br&gt;<br>
Could&nbsp;you&nbsp;try&nbsp;and&nbsp;apply&nbsp;the&nbsp;Update&nbsp;only&nbsp;to&nbsp;those&nbsp;rules&nbsp;that&nbsp;really&lt;br&gt;<br>
apply&nbsp;and&nbsp;report&nbsp;back?&lt;br&gt;<br>
&lt;br&gt;<br>
There&nbsp;might&nbsp;be&nbsp;a&nbsp;deeper&nbsp;issue&nbsp;here,&nbsp;so&nbsp;let&#39;s&nbsp;try&nbsp;and&nbsp;work&nbsp;together&lt;br&gt;<br>
to&nbsp;find&nbsp;a&nbsp;good&nbsp;recipe&nbsp;to&nbsp;solve&nbsp;your&nbsp;use&nbsp;case&nbsp;-&nbsp;which&nbsp;is&nbsp;actually&nbsp;a&nbsp;very&lt;br&gt;<br>
useful&nbsp;one.&lt;br&gt;<br>
&lt;br&gt;<br>
Ahoj,&lt;br&gt;<br>
&lt;br&gt;<br>
Christian&lt;br&gt;<br>
&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Mon,&nbsp;Aug&nbsp;14,&nbsp;2017&nbsp;at&nbsp;10:03:15AM&nbsp;+1200,&nbsp;Kirk&nbsp;Jackson&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&#39;d&nbsp;like&nbsp;to&nbsp;run&nbsp;the&nbsp;SQLi&nbsp;checks&nbsp;on&nbsp;only&nbsp;the&nbsp;one&nbsp;parameter&nbsp;on&nbsp;my&nbsp;site&nbsp;that&lt;br&gt;<br>
&gt;&nbsp;is&nbsp;vulnerable&nbsp;to&nbsp;those&nbsp;attacks.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;was&nbsp;wondering&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;pattern&nbsp;to&nbsp;do&nbsp;this,&nbsp;or&nbsp;if&nbsp;I&nbsp;need&nbsp;to&nbsp;copy&nbsp;the&lt;br&gt;<br>
&gt;&nbsp;rules&nbsp;from&nbsp;REQUEST-942-APPLICATION-&lt;wbr&gt;ATTACK-SQLI.conf&nbsp;into&nbsp;my&nbsp;own&nbsp;file,&nbsp;and&lt;br&gt;<br>
&gt;&nbsp;change&nbsp;the&nbsp;variables&nbsp;to&nbsp;my&nbsp;ARGS:ParamName?&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;tried&nbsp;doing&nbsp;this,&nbsp;to&nbsp;disable&nbsp;the&nbsp;rules,&nbsp;and&nbsp;then&nbsp;re-enable&nbsp;for&nbsp;just&nbsp;my&lt;br&gt;<br>
&gt;&nbsp;param,&nbsp;but&nbsp;that&nbsp;didn&#39;t&nbsp;work:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;SecRuleUpdateTargetByID&nbsp;942000-942999&nbsp;&quot;!REQUEST_COOKIES&quot;&lt;br&gt;<br>
&gt;&nbsp;SecRuleUpdateTargetByID&nbsp;942000-942999&nbsp;&quot;!REQUEST_COOKIES_NAMES&quot;&lt;br&gt;<br>
&gt;&nbsp;SecRuleUpdateTargetByID&nbsp;942000-942999&nbsp;&quot;!ARGS_NAMES&quot;&lt;br&gt;<br>
&gt;&nbsp;SecRuleUpdateTargetByID&nbsp;942000-942999&nbsp;&quot;!ARGS&quot;&lt;br&gt;<br>
&gt;&nbsp;SecRuleUpdateTargetByID&nbsp;942000-942999&nbsp;&quot;!XML&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;SecRuleUpdateTargetByID&nbsp;942000-942999&nbsp;&quot;ARGS:SearchTerm&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Many&nbsp;thanks!&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Kirk&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&gt;&nbsp;______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
&gt;&nbsp;Owasp-modsecurity-core-rule-&lt;wbr&gt;set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-&lt;wbr&gt;set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/&lt;wbr&gt;mailman/listinfo/owasp-&lt;wbr&gt;modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://www.feistyduck.com/books/modsecurity-handbook/&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.feistyduck.com/&lt;wbr&gt;books/modsecurity-handbook/&lt;/a&gt;&lt;br&gt;<br>
mailto:&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&gt;christian.folini@&lt;wbr&gt;netnea.com&lt;/a&gt;&lt;br&gt;<br>
twitter:&nbsp;@ChrFolini&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
