<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;div&gt;ModSecurity&nbsp;has&nbsp;it&#39;s&nbsp;own&nbsp;custom&nbsp;logging&nbsp;format.&nbsp;This&nbsp;can&nbsp;be&nbsp;changed&nbsp;to&nbsp;JSON&nbsp;in&nbsp;ModSecurity&nbsp;2.9&nbsp;and&nbsp;greater.&nbsp;Generally&nbsp;though&nbsp;being&nbsp;able&nbsp;to&nbsp;understand&nbsp;the&nbsp;log&nbsp;typically&nbsp;involves&nbsp;looking&nbsp;at&nbsp;the&nbsp;message&nbsp;that&nbsp;is&nbsp;generated,&nbsp;and&nbsp;occasionally&nbsp;looking&nbsp;at&nbsp;the&nbsp;rule&nbsp;in&nbsp;question&nbsp;if&nbsp;this&nbsp;isn&#39;t&nbsp;enough.&nbsp;In&nbsp;this&nbsp;case&nbsp;you&nbsp;have&nbsp;two&nbsp;rules&nbsp;listed.&lt;/div&gt;&lt;div&gt;The&nbsp;first&nbsp;rule, &lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;920180&lt;/span&gt;,&nbsp;says&nbsp;that&nbsp;&#39;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;POST&nbsp;request&nbsp;missing&nbsp;Content-Length&nbsp;Header&#39;.&nbsp;Generally&nbsp;this&nbsp;means&nbsp;that&nbsp;the&nbsp;Content-Length&nbsp;header,&nbsp;which&nbsp;typically&nbsp;specifies&nbsp;how&nbsp;much&nbsp;POST&nbsp;data&nbsp;is&nbsp;present&nbsp;was&nbsp;not&nbsp;provided.&nbsp;This&nbsp;can&nbsp;be&nbsp;triggered&nbsp;by&nbsp;using&nbsp;non-standard&nbsp;user-agents.&nbsp;All&nbsp;browsers&nbsp;known&nbsp;will&nbsp;provide&nbsp;this&nbsp;value&nbsp;as&nbsp;it&nbsp;is&nbsp;highly&nbsp;suggested&nbsp;by&nbsp;the&nbsp;RFC.&nbsp;This&nbsp;rule&nbsp;can&nbsp;be&nbsp;found&nbsp;here: &lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/e4e0497be4d598cce0e0a8fef20d1f1e5578c8d0/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf#L292&quot;&gt;https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/e4e0497be4d598cce0e0a8fef20d1f1e5578c8d0/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf#L292&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;The&nbsp;next&nbsp;rule&nbsp;you&nbsp;have&nbsp;highlighted&nbsp;is &lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;920270.&nbsp;This&nbsp;indicates&nbsp;that&nbsp;a&nbsp;null&nbsp;byte&nbsp;was&nbsp;passed&nbsp;to&nbsp;a&nbsp;cookie.&nbsp;Null&nbsp;bytes&nbsp;are&nbsp;used&nbsp;in&nbsp;various&nbsp;attacks&nbsp;but&nbsp;are&nbsp;almost&nbsp;always&nbsp;avoided&nbsp;by&nbsp;legit&nbsp;applications.&nbsp;This&nbsp;rule&nbsp;can&nbsp;be&nbsp;found&nbsp;here: &lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/e4e0497be4d598cce0e0a8fef20d1f1e5578c8d0/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf#L564&quot;&gt;https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/e4e0497be4d598cce0e0a8fef20d1f1e5578c8d0/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf#L564&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;To&nbsp;see&nbsp;whole&nbsp;requests&nbsp;when&nbsp;a&nbsp;rule&nbsp;triggers&nbsp;you&nbsp;should&nbsp;enable&nbsp;the&nbsp;audit&nbsp;logging&nbsp;capability.&nbsp;For&nbsp;more&nbsp;details&nbsp;on&nbsp;this&nbsp;please&nbsp;see&nbsp;the&nbsp;following&nbsp;entry&nbsp;in&nbsp;the&nbsp;reference&nbsp;manual: &lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecAuditEngine&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecAuditEngine&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Jul&nbsp;27,&nbsp;2017&nbsp;at&nbsp;7:16&nbsp;AM,&nbsp;Пацев&nbsp;Антон&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:patsev.anton@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;patsev.anton@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;Hello!&lt;/div&gt;&lt;div&gt;Can&nbsp;some&nbsp;help&nbsp;about&nbsp;REQUEST-920-PROTOCOL-&lt;wbr&gt;ENFORCEMENT.conf?&lt;/div&gt;&lt;div&gt;Used:&nbsp;modsecurity&nbsp;v3&nbsp;from&nbsp;master,&nbsp;nginx&nbsp;1.10.2,&nbsp;core&nbsp;rules&nbsp;from&nbsp;github&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;crs-setup.conf:&lt;/div&gt;&lt;div&gt;SecDefaultAction&nbsp;&quot;phase:1,log,auditlog,pass&quot;&lt;/div&gt;&lt;div&gt;SecDefaultAction&nbsp;&quot;phase:2,log,auditlog,pass&quot;&lt;/div&gt;&lt;div&gt;SecAction&nbsp;\&lt;/div&gt;&lt;div&gt; &nbsp;&quot;id:900000,\&lt;/div&gt;&lt;div&gt; &nbsp; phase:1,\&lt;/div&gt;&lt;div&gt; &nbsp; nolog,\&lt;/div&gt;&lt;div&gt; &nbsp; pass,\&lt;/div&gt;&lt;div&gt; &nbsp; t:none,\&lt;/div&gt;&lt;div&gt; &nbsp; setvar:tx.paranoia_level=1&quot;&lt;/div&gt;&lt;div&gt;SecAction&nbsp;\&lt;/div&gt;&lt;div&gt; &quot;id:900110,\&lt;/div&gt;&lt;div&gt; &nbsp;phase:1,\&lt;/div&gt;&lt;div&gt; &nbsp;nolog,\&lt;/div&gt;&lt;div&gt; &nbsp;pass,\&lt;/div&gt;&lt;div&gt; &nbsp;t:none,\&lt;/div&gt;&lt;div&gt; &nbsp;setvar:tx.inbound_anomaly_&lt;wbr&gt;score_threshold=5,\&lt;/div&gt;&lt;div&gt; &nbsp;setvar:tx.outbound_anomaly_&lt;wbr&gt;score_threshold=4&quot;&lt;/div&gt;&lt;div&gt;SecCollectionTimeout&nbsp;600&lt;/div&gt;&lt;div&gt;SecAction&nbsp;\&lt;/div&gt;&lt;div&gt; &quot;id:900990,\&lt;/div&gt;&lt;div&gt; &nbsp;phase:1,\&lt;/div&gt;&lt;div&gt; &nbsp;nolog,\&lt;/div&gt;&lt;div&gt; &nbsp;pass,\&lt;/div&gt;&lt;div&gt; &nbsp;t:none,\&lt;/div&gt;&lt;div&gt; &nbsp;setvar:tx.crs_setup_version=&lt;wbr&gt;302&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Log&nbsp;file&nbsp;have:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ModSecurity:&nbsp;Warning.&nbsp;Matched&nbsp;&quot;Operator&nbsp;`Eq&#39;&nbsp;with&nbsp;parameter&nbsp;`0&#39;&nbsp;against&nbsp;variable&nbsp;`REQUEST_HEADERS:Content-&lt;wbr&gt;Length&#39;&nbsp;(Value:&nbsp;`0&#39;&nbsp;)&nbsp;[file&nbsp;&quot;/etc/nginx/rules/REQUEST-920-&lt;wbr&gt;PROTOCOL-ENFORCEMENT.conf&quot;]&nbsp;[line&nbsp;&quot;258&quot;]&nbsp;[id&nbsp;&quot;920180&quot;]&nbsp;[rev&nbsp;&quot;1&quot;]&nbsp;[msg&nbsp;&quot;POST&nbsp;request&nbsp;missing&nbsp;Content-Length&nbsp;Header.&quot;]&nbsp;[data&nbsp;&quot;0&quot;]&nbsp;[severity&nbsp;&quot;4&quot;]&nbsp;[ver&nbsp;&quot;OWASP_CRS/3.0.0&quot;]&nbsp;[maturity&nbsp;&quot;9&quot;]&nbsp;[accuracy&nbsp;&quot;9&quot;]&nbsp;[tag&nbsp;&quot;application-multi&quot;]&nbsp;[tag&nbsp;&quot;language-multi&quot;]&nbsp;[tag&nbsp;&quot;platform-multi&quot;]&nbsp;[tag&nbsp;&quot;attack-protocol&quot;]&nbsp;[tag&nbsp;&quot;OWASP_CRS/PROTOCOL_VIOLATION/&lt;wbr&gt;INVALID_HREQ&quot;]&nbsp;[tag&nbsp;&quot;CAPEC-272&quot;]&nbsp;[ref&nbsp;&quot;o0,4v0,4&quot;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ModSecurity:&nbsp;Warning.&nbsp;Matched&nbsp;&quot;Operator&nbsp;`ValidadeByteRange&#39;&nbsp;with&nbsp;parameter&nbsp;`1-255&#39;&nbsp;against&nbsp;variable&nbsp;`REQUEST_HEADERS:Cookie&#39;&nbsp;(Value:&nbsp;`JSESSIONID=XXXXXXXXXXXXXX;&nbsp;loggedin=true;&nbsp;hash=yyyyyyy;&nbsp;loggedUser=gggggg&nbsp;(781&nbsp;characters&nbsp;omitted)&#39;&nbsp;)&nbsp;[file&nbsp;&quot;/etc/nginx/rules/REQUEST-920-&lt;wbr&gt;PROTOCOL-ENFORCEMENT.conf&quot;]&nbsp;[line&nbsp;&quot;488&quot;]&nbsp;[id&nbsp;&quot;920270&quot;]&nbsp;[rev&nbsp;&quot;2&quot;]&nbsp;[msg&nbsp;&quot;Invalid&nbsp;character&nbsp;in&nbsp;request&nbsp;(null&nbsp;character)&quot;]&nbsp;[data&nbsp;&quot;&quot;]&nbsp;[severity&nbsp;&quot;2&quot;]&nbsp;[ver&nbsp;&quot;OWASP_CRS/3.0.0&quot;]&nbsp;[maturity&nbsp;&quot;9&quot;]&nbsp;[accuracy&nbsp;&quot;9&quot;]&nbsp;[tag&nbsp;&quot;application-multi&quot;]&nbsp;[tag&nbsp;&quot;language-multi&quot;]&nbsp;[tag&nbsp;&quot;platform-multi&quot;]&nbsp;[tag&nbsp;&quot;attack-protocol&quot;]&nbsp;[tag&nbsp;&quot;OWASP_CRS/PROTOCOL_VIOLATION/&lt;wbr&gt;EVASION&quot;]&nbsp;[ref&nbsp;&quot;o185,1o186,1o187,1o188,1o189,&lt;wbr&gt;1o190,1o191,1o192,1o193,1o194,&lt;wbr&gt;1o195,1o196,1o197,1o198,1o199,&lt;wbr&gt;1o200,1o201,1o202,1o313,1o314,&lt;wbr&gt;1o315,1o316,1o317,1o318,1o319,&lt;wbr&gt;1o320,1o321,1o322,1o323,1o324,&lt;wbr&gt;1o325,1o326,1o327,1o328,1o329,&lt;wbr&gt;1o330,1o331,1o332,1o333,1o334,&lt;wbr&gt;1o335,1o336,1o337,1o338,1o408,&lt;wbr&gt;1o409,1o410,1o411,1o412,1o413,&lt;wbr&gt;1v479,881t:urlDecodeUni&quot;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;How&nbsp;understend&nbsp;this&nbsp;is&nbsp;log?&nbsp;How&nbsp;Write&nbsp;request&nbsp;to&nbsp;log?&lt;/div&gt;&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:rgb(0,136,0);font-family:Menlo,&quot;Bitstream&nbsp;Vera&nbsp;Sans&nbsp;Mono&quot;,Consolas,&quot;Lucida&nbsp;Console&quot;,&quot;Courier&nbsp;New&quot;,Courier,monospace;font-size:14px;white-space:pre-wrap&quot;&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;m_6017480070088814325gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
С&nbsp;уважением,&nbsp;Антон&nbsp;Пацев.&lt;br&gt;&lt;span&gt;Best&nbsp;regards,&lt;/span&gt;&nbsp;Anton&nbsp;Patsev.&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-&lt;wbr&gt;set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-&lt;wbr&gt;set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/&lt;wbr&gt;mailman/listinfo/owasp-&lt;wbr&gt;modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;--&nbsp;&lt;br&gt;Chaim&nbsp;Sanders&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.ChaimSanders.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.ChaimSanders.com&lt;/a&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
