<tt>
&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;charset=ISO-2022-JP&quot;<br>
&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;title&gt;&lt;/title&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Yes&nbsp;,I'm&nbsp;reading&nbsp;the&nbsp;48&nbsp;local&nbsp;excetions.but&nbsp;still&nbsp;confuse.here&nbsp;is&nbsp;my<br>
auditlog,&nbsp;thanks&nbsp;your&nbsp;help.I&nbsp;just&nbsp;want&nbsp;to&nbsp;disable&nbsp;this&nbsp;rule&nbsp;for&nbsp;this<br>
url&nbsp;(/news/abc.swf?id=20091211&amp;amp;style=3)&lt;br&gt;<br>
,other&nbsp;website&nbsp;still&nbsp;need&nbsp;to&nbsp;be&nbsp;inspect&lt;br&gt;<br>
--cecdfa17-A--&lt;br&gt;<br>
[10/Dec/2009:16:22:14&nbsp;+0800]&nbsp;SyCvtdJMQTgAABXDVjcAAAAC&nbsp;127.0.0.1&nbsp;60252<br>
127.0.0.1&nbsp;8000&lt;br&gt;<br>
--cecdfa17-B--&lt;br&gt;<br>
GET&nbsp;/news/abc.swf?id=20091211&amp;amp;style=3&nbsp;HTTP/1.1&lt;br&gt;<br>
Accept:&nbsp;*/*&lt;br&gt;<br>
Referer:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.abc.com/news/index.html&quot;&gt;http://www.abc.com/news/index.html&lt;/a&gt;&lt;br&gt;<br>
Accept-Language:&nbsp;zh-cn&lt;br&gt;<br>
UA-CPU:&nbsp;x86&lt;br&gt;<br>
Accept-Encoding:&nbsp;gzip,&nbsp;deflate&lt;br&gt;<br>
User-Agent:&nbsp;Mozilla/4.0&nbsp;()&lt;br&gt;<br>
Host:&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;http://www.abc.com&quot;&gt;www.abc.com&lt;/a&gt;&lt;br&gt;<br>
Cookie:&nbsp;JSESSIONID=869946B0D9D6C75C3600E22E54A2C172&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--cecdfa17-F--&lt;br&gt;<br>
HTTP/1.1&nbsp;403&nbsp;Forbidden&lt;br&gt;<br>
Content-Length:&nbsp;286&lt;br&gt;<br>
Content-Type:&nbsp;text/html;&nbsp;charset=iso-8859-1&lt;br&gt;<br>
&lt;br&gt;<br>
--cecdfa17-H--&lt;br&gt;<br>
Message:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;2).&nbsp;Operator&nbsp;GE&nbsp;matched&nbsp;20<br>
at&nbsp;TX:anomaly_score.&nbsp;[file<br>
&quot;/etc/conf/modsecurity-crs_2.0.3/base_rules/modsecurity_crs_49_enforcement.conf&quot;]<br>
[line&nbsp;&quot;25&quot;]&nbsp;[msg&nbsp;&quot;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(score&nbsp;20):&nbsp;XSS&nbsp;Attack<br>
Detected&quot;]&lt;br&gt;<br>
Action:&nbsp;Intercepted&nbsp;(phase&nbsp;2)&lt;br&gt;<br>
Apache-Handler:&nbsp;proxy-server&lt;br&gt;<br>
Stopwatch:&nbsp;1260433333972585&nbsp;876832&nbsp;(6983&nbsp;798741&nbsp;-)&lt;br&gt;<br>
Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.5.7&nbsp;(&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;http://www.modsecurity.org/&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);<br>
core&nbsp;ruleset/2.0.3.&lt;br&gt;<br>
Server:&nbsp;Apache/2.2.11&nbsp;(Unix)&nbsp;mod_ssl/2.2.11&nbsp;OpenSSL/0.9.8b&lt;br&gt;<br>
WebApp-Info:&nbsp;&quot;abc&quot;&nbsp;&quot;-&quot;&nbsp;&quot;-&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
--cecdfa17-K--&lt;br&gt;<br>
SecAction<br>
&quot;phase:1,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remote_addr}&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;REQUEST_METHOD&quot;&nbsp;&quot;@rx&nbsp;^(?:GET|HEAD)$&quot;<br>
&quot;phase:2,chain,t:none,block,nolog,auditlog,status:400,msg:'GET&nbsp;or&nbsp;HEAD<br>
requests&nbsp;with<br>
bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;&amp;amp;REQUEST_HEADERS:Content-Type&quot;&nbsp;&quot;@eq&nbsp;0&quot;<br>
&quot;phase:2,pass,chain,t:none,nolog,auditlog,msg:'Request&nbsp;Containing<br>
Content,&nbsp;but&nbsp;Missing&nbsp;Content-Type&nbsp;header',id:960904,severity:5&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;ARGS_NAMES&quot;&nbsp;&quot;@rx&nbsp;.*&quot;<br>
&quot;phase:2,chain,t:none,nolog,auditlog,pass,capture,setvar:tx.arg_name_%{tx.0}=+1,msg:'Possible<br>
HTTP&nbsp;Parameter&nbsp;Pollution&nbsp;Attack:&nbsp;Multiple&nbsp;Parameters&nbsp;with&nbsp;the&nbsp;same<br>
Name.'&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;ARGS_NAMES&quot;&nbsp;&quot;@rx&nbsp;.*&quot;<br>
&quot;phase:2,chain,t:none,nolog,auditlog,pass,capture,setvar:tx.arg_name_%{tx.0}=+1,msg:'Possible<br>
HTTP&nbsp;Parameter&nbsp;Pollution&nbsp;Attack:&nbsp;Multiple&nbsp;Parameters&nbsp;with&nbsp;the&nbsp;same<br>
Name.'&quot;&lt;br&gt;<br>
SecRule<br>
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;<br>
&quot;@pmFromFile&nbsp;modsecurity_40_generic_attacks.data&quot;<br>
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
SecRule<br>
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;<br>
&quot;@pmFromFile&nbsp;modsecurity_40_generic_attacks.data&quot;<br>
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
SecRule<br>
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;<br>
&quot;@pmFromFile&nbsp;modsecurity_40_generic_attacks.data&quot;<br>
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;&amp;amp;TX:/SQL_INJECTION/&quot;&nbsp;&quot;@eq&nbsp;0&quot;<br>
&quot;phase:2,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK&quot;&lt;br&gt;<br>
SecRule<br>
&quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;<br>
&quot;@pm&nbsp;jscript&nbsp;onsubmit&nbsp;copyparentfolder&nbsp;javascript&nbsp;meta&nbsp;onchange&nbsp;onmove<br>
onkeydown&nbsp;onkeyup&nbsp;activexobject&nbsp;onerror&nbsp;onmouseup&nbsp;ecmascript<br>
bexpression&nbsp;onmouseover&nbsp;vbscript:&nbsp;&amp;lt;![cdata[&nbsp;http:&nbsp;.innerhtml<br>
settimeout&nbsp;shell:&nbsp;onabort&nbsp;asfunction:&nbsp;onkeypress&nbsp;onmousedown&nbsp;onclick<br>
.fromcharcode&nbsp;background-image:&nbsp;.cookie&nbsp;x-javascript&nbsp;ondragdrop&nbsp;onblur<br>
mocha:&nbsp;javascript:&nbsp;onfocus&nbsp;lowsrc&nbsp;getparentfolder&nbsp;onresize&nbsp;@import<br>
alert&nbsp;script&nbsp;onselect&nbsp;onmouseout&nbsp;application&nbsp;onmousemove&nbsp;background<br>
.execscript&nbsp;livescript:&nbsp;vbscript&nbsp;getspecialfolder&nbsp;.addimport&nbsp;iframe<br>
onunload&nbsp;createtextrange&nbsp;&amp;lt;input&nbsp;onload&quot;<br>
&quot;phase:2,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,skip:1,setvar:tx.pm_xss_data_%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;REQUEST_URI_RAW|REQUEST_BODY&quot;&nbsp;&quot;@rx&nbsp;\\bstyle\\b\\W*?=&quot;<br>
&quot;phase:2,t:none,t:lowercase,block,nolog,auditlog,ctl:debugLogLevel=9,msg:'XSS<br>
Attack<br>
Detected',setvar:tx.msg=%{rule.msg},setvar:tx.xss_score=+1,setvar:tx.anomaly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;REQUEST_FILENAME&quot;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:!@pmFromFilemodsecurity_46_et_sql_injection.data&quot;&gt;&quot;!@pmFromFile<br>
modsecurity_46_et_sql_injection.data&quot;&lt;/a&gt;<br>
&quot;phase:2,nolog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,skipAfter:END_ET_SQLI_RULES&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;REQUEST_FILENAME&quot;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-rfc2396E&quot;&nbsp;href=&quot;mailto:!@pmFromFilemodsecurity_46_et_web_rules.data&quot;&gt;&quot;!@pmFromFile<br>
modsecurity_46_et_web_rules.data&quot;&lt;/a&gt;<br>
&quot;phase:2,nolog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normalisePathWin,skipAfter:END_SNORT_RULES&quot;&lt;br&gt;<br>
SecRule&nbsp;&quot;TX:ANOMALY_SCORE&quot;&nbsp;&quot;@ge&nbsp;20&quot;<br>
&quot;phase:2,t:none,log,auditlog,deny,msg:'Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(score<br>
%{TX.ANOMALY_SCORE}):&nbsp;%{tx.msg}',setvar:tx.inbound_tx_msg=%{tx.msg}&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
--cecdfa17-Z--&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
$BP2(B&nbsp;2009-12-10&nbsp;22:11,&nbsp;Ryan&nbsp;Barnett&nbsp;$B&lt;LF;(B:<br>
&lt;blockquote&nbsp;cite=&quot;mid:200912100911.48210.ryan.barnett@breach.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;On&nbsp;Thursday&nbsp;10&nbsp;December&nbsp;2009&nbsp;04:11:53&nbsp;am&nbsp;ll&nbsp;wrote:<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;in&nbsp;the&nbsp;newest&nbsp;rule&nbsp;set(&nbsp;modsecurity-crs_2.0.3)&nbsp;,there&nbsp;are&nbsp;not&nbsp;rule&nbsp;id&nbsp;in<br>
<br>
some&nbsp;rule&nbsp;.eg.<br>
SecRule&nbsp;REQUEST_URI_RAW|REQUEST_BODY<br>
&quot;\bon(abort|blur|change|click|dblclick|dragdrop|error|\<br>
focus|keydown|keypress|keyup|load|mousedown|mousemove|mouseout\<br>
<br>
|mouseover|mouseup|move|readystatechange|reset|resize|select|submit|unload)<br>
|\b\W*?=&quot;<br>
<br>
\<br>
&quot;phase:2,t:none,t:lowercase,block,nolog,auditlog,msg:'XSS&nbsp;Attack<br>
Detected',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+1,setvar:tx.anom<br>
aly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{mat<br>
ched_var}&quot;<br>
<br>
In&nbsp;my&nbsp;server&nbsp;,this&nbsp;is&nbsp;a&nbsp;False&nbsp;Positive&nbsp;for&nbsp;some&nbsp;url.and&nbsp;I&nbsp;want&nbsp;to<br>
disable&nbsp;it&nbsp;for&nbsp;there&nbsp;url.<br>
but&nbsp;there&nbsp;are&nbsp;no&nbsp;rule&nbsp;id,I&nbsp;can't&nbsp;SecRuleRemoveById.<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;&lt;!----&gt;<br>
We&nbsp;will&nbsp;go&nbsp;back&nbsp;through&nbsp;the&nbsp;rule&nbsp;set&nbsp;to&nbsp;ensure&nbsp;that&nbsp;all&nbsp;rules&nbsp;have&nbsp;a&nbsp;rule&nbsp;id.&nbsp;&nbsp;<br>
That&nbsp;being&nbsp;said,&nbsp;you&nbsp;can&nbsp;still&nbsp;go&nbsp;to&nbsp;the&nbsp;48&nbsp;local&nbsp;exceptions&nbsp;file&nbsp;and&nbsp;add&nbsp;in&nbsp;<br>
rule&nbsp;there.<br>
<br>
If&nbsp;you&nbsp;send&nbsp;an&nbsp;example&nbsp;audit&nbsp;log&nbsp;entry&nbsp;of&nbsp;this&nbsp;false&nbsp;positive,&nbsp;I&nbsp;could&nbsp;send&nbsp;<br>
you&nbsp;an&nbsp;example&nbsp;exception.<br>
<br>
-Ryan<br>
<br>
&nbsp;&nbsp;&lt;/pre&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
