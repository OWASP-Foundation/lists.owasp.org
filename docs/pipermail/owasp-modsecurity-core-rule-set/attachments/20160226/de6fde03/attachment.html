<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&quot;&gt;<br>
&lt;div&gt;Hi,&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;I&#8217;m&nbsp;trying&nbsp;to&nbsp;allow&nbsp;a&nbsp;certain&nbsp;domain&nbsp;to&nbsp;be&nbsp;exempted&nbsp;from&nbsp;the&nbsp;core&nbsp;RFI&nbsp;rule.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;What&nbsp;I&#8217;ve&nbsp;done&nbsp;is&nbsp;modified&nbsp;the&nbsp;relevant&nbsp;rule&nbsp;in&nbsp;modsecurity_crs_40_generic_attacks.conf:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;SecRule&nbsp;ARGS&nbsp;&quot;^(?:ht|f)tps?://(.*)$&quot;&nbsp;\&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;chain,phase:2,rev:'3',ver:'OWASP_CRS/2.2.9',maturity:'9',accuracy:'9',t:none,capture,ctl:auditLogParts=&#43;E,block,msg:'Possible&nbsp;Remote&nbsp;File&nbsp;Inclusion&nbsp;(RFI)&nbsp;Attack:&nbsp;Off-Domain&nbsp;Reference/Link',logdata:'Matched&nbsp;Data:&nbsp;%{TX.0}&nbsp;found&nbsp;within&nbsp;%{MATCHED_VAR_NAME}:<br>
&nbsp;%{MATCHED_VAR}',id:'950120',severity:'2',tag:'OWASP_CRS/WEB_ATTACK/RFI'&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;b&gt;SecRule&nbsp;TX:1&nbsp;&quot;!@contains&nbsp;abc&quot;&nbsp;&quot;chain&quot;&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;TX:1&nbsp;&quot;!@beginsWith&nbsp;%{request_headers.host}&quot;&nbsp;&quot;setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=&#43;%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-OWASP_CRS/WEB_ATTACK/RFI-%{matched_var_name}=%{tx.1}&#8221;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;And&nbsp;this&nbsp;works.&nbsp;However,&nbsp;an&nbsp;upgrade&nbsp;of&nbsp;the&nbsp;CRS&nbsp;will&nbsp;wipe&nbsp;this&nbsp;out&nbsp;and&nbsp;it&nbsp;will&nbsp;have&nbsp;to&nbsp;be&nbsp;manually&nbsp;added&nbsp;again.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;How&nbsp;would&nbsp;I&nbsp;go&nbsp;about&nbsp;inserting&nbsp;a&nbsp;&#8220;link&#8221;&nbsp;into&nbsp;the&nbsp;chain&nbsp;from&nbsp;an&nbsp;external&nbsp;file&nbsp;(e.g,&nbsp;modsecurity_crs_61_customrules.conf)?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Thanks,&lt;/div&gt;<br>
&lt;div&gt;Brian&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
