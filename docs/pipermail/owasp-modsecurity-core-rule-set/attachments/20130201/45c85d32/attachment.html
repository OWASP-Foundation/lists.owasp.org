<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;dir=&quot;auto&quot;&gt;<br>
&lt;div&gt;Got&nbsp;your&nbsp;GitHub&nbsp;Pull&nbsp;request,&nbsp;thanks.&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Just&nbsp;for&nbsp;some&nbsp;background&nbsp;on&nbsp;my&nbsp;request&nbsp;to&nbsp;use&nbsp;github.&nbsp;Using&nbsp;GitHub&nbsp;for&nbsp;CRS&nbsp;Dev&nbsp;is&nbsp;critical&nbsp;for&nbsp;collaboration&nbsp;and&nbsp;community&nbsp;involvement.&nbsp;I&nbsp;realize&nbsp;this&nbsp;was&nbsp;a&nbsp;minor&nbsp;change&nbsp;and&nbsp;*easy*&nbsp;to&nbsp;do&nbsp;however&nbsp;I&nbsp;want&nbsp;to&nbsp;encourage&nbsp;use&nbsp;of&nbsp;GitHub&nbsp;for&nbsp;all&nbsp;updates.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;contribution!&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;div&gt;--&lt;/div&gt;<br>
&lt;div&gt;Ryan&nbsp;Barnett&lt;/div&gt;<br>
&lt;div&gt;Lead&nbsp;Security&nbsp;Researcher&lt;/div&gt;<br>
&lt;div&gt;Trustwave&nbsp;-&nbsp;SpiderLabs&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
On&nbsp;Jan&nbsp;31,&nbsp;2013,&nbsp;at&nbsp;5:15&nbsp;PM,&nbsp;&quot;Ryan&nbsp;Barnett&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;&nbsp;font-size:14px&quot;&gt;Please&nbsp;use&nbsp;GitHub&nbsp;and&nbsp;issue&nbsp;a&nbsp;Pull&nbsp;request.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;&nbsp;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;&nbsp;font-size:14px&quot;&gt;Thanks.&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;&nbsp;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Consolas,&nbsp;'Courier&nbsp;New',&nbsp;Courier&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabs&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;ModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;&nbsp;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&nbsp;style=&quot;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;border-bottom:medium&nbsp;none;&nbsp;border-left:medium&nbsp;none;&nbsp;padding-bottom:0in;&nbsp;padding-left:0in;&nbsp;padding-right:0in;&nbsp;border-top:#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;border-right:medium&nbsp;none;&nbsp;padding-top:3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;yersinia&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:yersinia.spiros@gmail.com&quot;&gt;yersinia.spiros@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Thursday,&nbsp;January&nbsp;31,&nbsp;2013&nbsp;12:33&nbsp;PM&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;[PATCH]&nbsp;modsecurity_crs_47_common_exceptions.conf:&nbsp;drop&nbsp;apache&nbsp;User-Agent&nbsp;signature&nbsp;for&nbsp;dummy&nbsp;connection&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;border-left:#b5c4df&nbsp;5&nbsp;solid;&nbsp;padding:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;margin:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;Patch&nbsp;not&nbsp;useful&nbsp;or&nbsp;wrong&nbsp;way&nbsp;to&nbsp;post&nbsp;it&nbsp;?&nbsp;Just&nbsp;for&nbsp;info.&lt;br&gt;<br>
&lt;br&gt;<br>
Best&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Jan&nbsp;30,&nbsp;2013&nbsp;at&nbsp;11:57&nbsp;AM,&nbsp;Elia&nbsp;Pinto&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;&lt;a&nbsp;href=&quot;mailto:yersinia.spiros@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;yersinia.spiros@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;&nbsp;border-left:1px&nbsp;#ccc&nbsp;solid;&nbsp;padding-left:1ex&quot;&gt;<br>
When&nbsp;the&nbsp;apache&nbsp;HTTP&nbsp;Server&nbsp;manages&nbsp;its&nbsp;child&nbsp;processes,&nbsp;it&nbsp;sends&nbsp;a&nbsp;simple&nbsp;HTTP&nbsp;request&nbsp;back&nbsp;to&nbsp;itself.&lt;br&gt;<br>
This&nbsp;request&nbsp;will&nbsp;appear&nbsp;in&nbsp;the&nbsp;access_log&nbsp;file&nbsp;with&nbsp;the&nbsp;remote&nbsp;address&nbsp;set&nbsp;to&nbsp;the&nbsp;loop-back&nbsp;interface&lt;br&gt;<br>
and&nbsp;if&nbsp;you&nbsp;log&nbsp;the&nbsp;User-Agent&nbsp;string&nbsp;you&nbsp;will&nbsp;see&nbsp;the&nbsp;server&nbsp;signature&nbsp;followed&nbsp;by&nbsp;&quot;(internal&nbsp;dummy&nbsp;connection)&quot;&lt;br&gt;<br>
on&nbsp;non-SSL&nbsp;servers.&nbsp;modsecurity_crs_47_common_exceptions&nbsp;already&nbsp;contain&nbsp;a&nbsp;chained&nbsp;rule&nbsp;for&nbsp;skipping&lt;br&gt;<br>
the&nbsp;apache&nbsp;internal&nbsp;dummy&nbsp;connection&nbsp;if&nbsp;the&nbsp;connection&nbsp;is&nbsp;from&nbsp;the&nbsp;lookback&nbsp;address.&lt;br&gt;<br>
&lt;br&gt;<br>
But&nbsp;if&nbsp;the&nbsp;administrator&nbsp;has&nbsp;set&nbsp;the&nbsp;directive&nbsp;SecServerSignature&lt;br&gt;<br>
to&nbsp;one&nbsp;of&nbsp;the&nbsp;./modsecurity_35_bad_robots.data,&nbsp;for&nbsp;example&nbsp;chinaclaw,&nbsp;the&nbsp;skip&nbsp;rule&nbsp;for&nbsp;the&nbsp;internal&nbsp;dummy&nbsp;connection&nbsp;is&nbsp;not&nbsp;used,&lt;br&gt;<br>
because&nbsp;in&nbsp;that&nbsp;case&nbsp;the&nbsp;User-Agent&nbsp;is&nbsp;defined&nbsp;by&nbsp;the&nbsp;valued&nbsp;of&nbsp;the&nbsp;SecServerSignature,&nbsp;and&lt;br&gt;<br>
not&nbsp;contain&nbsp;the&nbsp;value&nbsp;Apache:&nbsp;in&nbsp;this&nbsp;case&nbsp;the&nbsp;rule&nbsp;990012&nbsp;will&nbsp;fire&nbsp;wrongly.&lt;br&gt;<br>
Therefore,&nbsp;because&nbsp;the&nbsp;skip&nbsp;rule&nbsp;it&nbsp;is&nbsp;applied&nbsp;already&nbsp;to&nbsp;connection&nbsp;from&nbsp;127.0.0.1,&lt;br&gt;<br>
so&nbsp;it&nbsp;is&nbsp;sufficently&nbsp;safe,&nbsp;don't&nbsp;cause&nbsp;any&nbsp;problem&nbsp;to&nbsp;eliminate&nbsp;the&nbsp;&quot;Apache&quot;&nbsp;control&nbsp;also&nbsp;on&nbsp;the&nbsp;User-Agent&nbsp;variables.&lt;br&gt;<br>
It&nbsp;is&nbsp;very&nbsp;similar&nbsp;to&nbsp;a&nbsp;standard&nbsp;iptables&nbsp;setup&nbsp;in&nbsp;which&nbsp;it&nbsp;is&nbsp;common&nbsp;to&nbsp;put&nbsp;a&nbsp;catchall&nbsp;ACCEPT&nbsp;rule&lt;br&gt;<br>
on&nbsp;the&nbsp;loopback&nbsp;interface.&lt;br&gt;<br>
---&lt;br&gt;<br>
&nbsp;.../modsecurity_crs_47_common_exceptions.conf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&#43;-&lt;br&gt;<br>
&nbsp;1&nbsp;files&nbsp;changed,&nbsp;1&nbsp;insertions(&#43;),&nbsp;1&nbsp;deletions(-)&lt;br&gt;<br>
&lt;br&gt;<br>
diff&nbsp;--git&nbsp;a/base_rules/modsecurity_crs_47_common_exceptions.conf&nbsp;b/base_rules/modsecurity_crs_47_common_exceptions.conf&lt;br&gt;<br>
index&nbsp;c63cabd..eda515b&nbsp;100644&lt;br&gt;<br>
---&nbsp;a/base_rules/modsecurity_crs_47_common_exceptions.conf&lt;br&gt;<br>
&#43;&#43;&#43;&nbsp;b/base_rules/modsecurity_crs_47_common_exceptions.conf&lt;br&gt;<br>
@@&nbsp;-23,7&nbsp;&#43;23,7&nbsp;@@&nbsp;SecRule&nbsp;REQUEST_LINE&nbsp;&quot;^GET&nbsp;/$&quot;&nbsp;&quot;chain,phase:2,id:'981020',t:none,pass,nolog&quot;&lt;br&gt;<br>
&nbsp;#&lt;br&gt;<br>
&nbsp;SecRule&nbsp;REQUEST_LINE&nbsp;&quot;^(GET&nbsp;/|OPTIONS&nbsp;\*)&nbsp;HTTP/1.0$&quot;&nbsp;&quot;chain,phase:2,id:'981021',t:none,pass,nolog&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;^(127\.0\.0\.|\:\:)1$&quot;&nbsp;&quot;chain,t:none&quot;&lt;br&gt;<br>
-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&quot;^Apache.*\(internal&nbsp;dummy&nbsp;connection\)$&quot;&nbsp;&quot;t:none,t:none,chain&quot;&lt;br&gt;<br>
&#43;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&quot;^.*\(internal&nbsp;dummy&nbsp;connection\)$&quot;&nbsp;&quot;t:none,t:none,chain&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;TX:'/PROTOCOL_VIOLATION\\\/MISSING_HEADER/'&nbsp;&quot;.*&quot;&nbsp;&quot;chain,setvar:tx.missing_header=&#43;1,setvar:tx.missing_header_%{tx.missing_header}=%{matched_var_name}&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;TX:'/MISSING_HEADER_/'&nbsp;&quot;TX\:(.*)&quot;&nbsp;&quot;capture,t:none,setvar:!tx.%{tx.1}&quot;&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
--&lt;br&gt;<br>
1.7.1&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;/blockquote&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information<br>
&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
