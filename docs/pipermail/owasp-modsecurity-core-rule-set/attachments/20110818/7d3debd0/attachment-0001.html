<tt>
I&nbsp;think&nbsp;there&nbsp;is&nbsp;a&nbsp;bug&nbsp;that&nbsp;won&amp;#39;t&nbsp;allow&nbsp;us&nbsp;to&nbsp;omit&nbsp;log&nbsp;entries&nbsp;to&nbsp;the&nbsp;audit&nbsp;log.&nbsp;In&nbsp;my&nbsp;case,&nbsp;I&nbsp;tried&nbsp;several&nbsp;different&nbsp;phases&nbsp;and&nbsp;crs&nbsp;files&nbsp;as&nbsp;you&nbsp;can&nbsp;see&nbsp;below:&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;in&nbsp;modsecurity_crs_48_local_exceptions.conf&nbsp;AND&nbsp;I&nbsp;tried&nbsp;modsecurity_crs_15_customrules.conf&lt;/div&gt;<br>
&lt;div&gt;&lt;ul&gt;&lt;li&gt;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&amp;quot;pingdom&amp;quot;&nbsp;&amp;quot;nolog,noauditlog,pass&amp;quot;&lt;/li&gt;&lt;li&gt;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&amp;quot;pingdom&amp;quot;&nbsp;&amp;quot;nolog,noauditlog,pass,ctl:auditEngine=Off&amp;quot;&lt;/li&gt;<br>
&lt;/ul&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;And&nbsp;after&nbsp;restarting&nbsp;apache,&nbsp;I&nbsp;still&nbsp;am&nbsp;getting&nbsp;these&nbsp;entries:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--4489f76b-B--&lt;/div&gt;&lt;div&gt;GET&nbsp;/account/login/?next=/&nbsp;HTTP/1.0&lt;/div&gt;&lt;div&gt;User-Agent:&nbsp;Pingdom.com_bot_version_1.4_(&lt;a&nbsp;href=&quot;http://www.pingdom.com/&quot;&gt;http://www.pingdom.com/&lt;/a&gt;)&lt;/div&gt;<br>
&lt;div&gt;Host:&nbsp;&lt;a&nbsp;href=&quot;http://blah.com&quot;&gt;blah.com&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Gil&nbsp;Vidals&nbsp;/&nbsp;VM&nbsp;Racks&lt;/div&gt;&lt;div&gt;ESXi&nbsp;Hosting&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Aug&nbsp;18,&nbsp;2011&nbsp;at&nbsp;6:26&nbsp;AM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&nbsp;target=&quot;_blank&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&gt;&lt;br&gt;<br>
On&nbsp;8/18/11&nbsp;3:21&nbsp;AM,&nbsp;&amp;quot;Paul&nbsp;McGarry&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:paul@paulmcgarry.com&quot;&nbsp;target=&quot;_blank&quot;&gt;paul@paulmcgarry.com&lt;/a&gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;Hi&nbsp;all,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;I&nbsp;have&nbsp;a&nbsp;site&nbsp;which&nbsp;is&nbsp;routinely&nbsp;scanned&nbsp;both&nbsp;internally&nbsp;and&nbsp;by&lt;br&gt;<br>
&amp;gt;external&nbsp;service.&lt;br&gt;<br>
&amp;gt;I&nbsp;want&nbsp;to&nbsp;have&nbsp;mod_security&nbsp;running&nbsp;and&nbsp;intervening&nbsp;but&nbsp;don&amp;#39;t&nbsp;want&nbsp;any&lt;br&gt;<br>
&amp;gt;of&nbsp;the&nbsp;associated&nbsp;log&nbsp;noise,&nbsp;the&nbsp;scans&nbsp;originate&nbsp;from&nbsp;known&nbsp;IPs&nbsp;and&lt;br&gt;<br>
&amp;gt;have&nbsp;known&nbsp;User&nbsp;agents&nbsp;etc&nbsp;so&nbsp;I&nbsp;can&nbsp;easily&nbsp;identify&nbsp;them.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;So&nbsp;far&nbsp;I&nbsp;have&nbsp;been&nbsp;turning&nbsp;the&nbsp;auditEngine&nbsp;off&nbsp;with&nbsp;things&nbsp;like:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;SecRule&nbsp;REMOTE_ADDR&nbsp;&amp;quot;^123\.123\.123\.123$&amp;quot;&nbsp;&amp;quot;nolog,ctl:auditEngine=Off&amp;quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Try&nbsp;this&nbsp;rule&nbsp;and&nbsp;see&nbsp;if&nbsp;it&nbsp;works&nbsp;any&nbsp;better&nbsp;-&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REMOTE_ADDR&nbsp;&amp;quot;@ipMatch&nbsp;123.123.123.123&amp;quot;&lt;br&gt;<br>
&amp;quot;phase:1,t:none,nolog,pass,ctl:auditEngine=Off&amp;quot;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;rule&nbsp;specifies&nbsp;phase:1&nbsp;vs.&nbsp;defaulting&nbsp;to&nbsp;phase:2&nbsp;if&nbsp;you&nbsp;don&amp;#39;t&lt;br&gt;<br>
explicitly&nbsp;set&nbsp;one&nbsp;and&nbsp;it&nbsp;also&nbsp;uses&nbsp;the&nbsp;@ipMatch&nbsp;operator&nbsp;which&nbsp;is&nbsp;better&lt;br&gt;<br>
suited&nbsp;to&nbsp;handle&nbsp;IP&nbsp;addresses.&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;but&nbsp;I&nbsp;have&nbsp;noticed&nbsp;this&nbsp;doesn&amp;#39;t&nbsp;catch&nbsp;everything,&nbsp;specifically&nbsp;CRS&lt;br&gt;<br>
&amp;gt;rule&nbsp;981227&nbsp;(Apache&nbsp;Error:&nbsp;Invalid&nbsp;URI&nbsp;in&nbsp;Request).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;If&nbsp;I&nbsp;understand&nbsp;things&nbsp;correctly&nbsp;this&nbsp;is&nbsp;because&nbsp;Apache&nbsp;is&nbsp;blocking&lt;br&gt;<br>
&amp;gt;the&nbsp;request&nbsp;early&nbsp;and&nbsp;Modsec&nbsp;phases&nbsp;1-4&nbsp;don&amp;#39;t&nbsp;run,&nbsp;it&nbsp;just&nbsp;goes&lt;br&gt;<br>
&amp;gt;straight&nbsp;to&nbsp;5?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Should&nbsp;I&nbsp;be&nbsp;putting&nbsp;my&nbsp;rule&nbsp;above&nbsp;in&nbsp;phase&nbsp;5&nbsp;(additionally&nbsp;or&nbsp;instead)?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Good&nbsp;observation.&nbsp;Yes,&nbsp;there&nbsp;are&nbsp;some&nbsp;requests&nbsp;that&nbsp;may&nbsp;be&nbsp;handled&nbsp;by&lt;br&gt;<br>
Apache&nbsp;before&nbsp;it&nbsp;reaches&nbsp;the&nbsp;ModSecurity&nbsp;hooks.&nbsp; You&nbsp;may&nbsp;need&nbsp;to&nbsp;replicate&lt;br&gt;<br>
this&nbsp;rule&nbsp;to&nbsp;also&nbsp;run&nbsp;in&nbsp;phase:5.&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Ryan&amp;#39;s&nbsp;blog&nbsp;at:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;a&nbsp;href=&quot;http://blog.spiderlabs.com/2010/12/advanced-topic-of-the-week-handling-aut&quot;&nbsp;target=&quot;_blank&quot;&gt;http://blog.spiderlabs.com/2010/12/advanced-topic-of-the-week-handling-aut&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;horized-scanning-traffic.html&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;and&nbsp;modsecurity_crs_11_avs_traffic.conf&nbsp;CRS&nbsp;file&nbsp;seem&nbsp;to&nbsp;suggest&nbsp;that&lt;br&gt;<br>
&amp;gt;phase&nbsp;1&nbsp;is&nbsp;the&nbsp;preferred&nbsp;place&nbsp;but&nbsp;that&nbsp;doesn&amp;#39;t&nbsp;seem&nbsp;to&nbsp;be&nbsp;entirely&lt;br&gt;<br>
&amp;gt;effective&nbsp;for&nbsp;me.&nbsp;Am&nbsp;I&nbsp;missing&nbsp;something?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;One&nbsp;other&nbsp;monkey&nbsp;wrench&nbsp;here...&nbsp;Reference&nbsp;this&nbsp;JIRA&nbsp;ticket&nbsp;-&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://www.modsecurity.org/tracker/browse/MODSEC-98&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.modsecurity.org/tracker/browse/MODSEC-98&lt;/a&gt;.&nbsp; Ivan&nbsp;Ristic&nbsp;had&lt;br&gt;<br>
previously&nbsp;made&nbsp;a&nbsp;change&nbsp;to&nbsp;the&nbsp;code&nbsp;so&nbsp;that&nbsp;phase:1&nbsp;and&nbsp;phase:2&nbsp;actually&lt;br&gt;<br>
run&nbsp;in&nbsp;the&nbsp;same&nbsp;Apache&nbsp;hook&nbsp;(fixup&nbsp;phase&nbsp;-&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#Processing_Phases&quot;&nbsp;target=&quot;_blank&quot;&gt;https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Referen&lt;br&gt;<br>
ce_Manual#Processing_Phases&lt;/a&gt;).&nbsp; This&nbsp;was&nbsp;done&nbsp;for&nbsp;a&nbsp;valid&nbsp;reason&nbsp;-&nbsp;running&lt;br&gt;<br>
rules&nbsp;in&nbsp;the&nbsp;post-read-request&nbsp;hook&nbsp;prevented&nbsp;users&nbsp;from&nbsp;nesting&lt;br&gt;<br>
ModSecurity&nbsp;SecRules&nbsp;within&nbsp;Apache&nbsp;scope&nbsp;locations&nbsp;(such&nbsp;as&nbsp;&amp;lt;Location&amp;gt;,&lt;br&gt;<br>
&amp;lt;Directory&amp;gt;,&nbsp;etc...).&nbsp; His&nbsp;change&nbsp;fixes&nbsp;that,&nbsp;however&nbsp;there&nbsp;are&nbsp;some&lt;br&gt;<br>
examples&nbsp;where&nbsp;you&nbsp;actually&nbsp;want&nbsp;a&nbsp;rule&nbsp;to&nbsp;run&nbsp;in&nbsp;the&nbsp;old&nbsp;phase:1&nbsp;hook&lt;br&gt;<br>
(post-read-request).&nbsp; We&nbsp;are&nbsp;currently&nbsp;reviewing&nbsp;this&nbsp;change&nbsp;and&lt;br&gt;<br>
considering&nbsp;options.&lt;br&gt;<br>
&lt;br&gt;<br>
-Ryan&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;Paul&lt;br&gt;<br>
&amp;gt;_______________________________________________&lt;br&gt;<br>
&amp;gt;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
<br>
<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;span&nbsp;style=&quot;font-family:Verdana;font-size:13px&quot;&gt;Gil&nbsp;Vidals,&nbsp;VCP&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:gvidals@vmracks.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gvidals@vmracks.com&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.vmracks.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.vmracks.com&lt;/a&gt;&nbsp;-&nbsp;VMware&nbsp;Hosting&nbsp;Service&nbsp;Provider&lt;br&gt;<br>
t.&nbsp;760.705.4022&nbsp;IM:&nbsp;&lt;a&nbsp;href=&quot;mailto:gilvidals@hotmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gilvidals@hotmail.com&lt;/a&gt;&lt;br&gt;&lt;/span&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:Verdana;font-size:13px&quot;&gt;&lt;img&nbsp;src=&quot;http://esx-hosting.vm-racks.com/images/VMracks/VMracks-logo.png&quot;&gt;&lt;br&gt;<br>
HIPAA&nbsp;Compliant&nbsp;Hosting&lt;br&gt;VMware&nbsp;Hosting&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;font-family:Verdana;font-size:13px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;Verdana&quot;&gt;CONFIDENTIALITY&nbsp;NOTICE: The&nbsp;information&nbsp;contained&nbsp;in&nbsp;this&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;privileged&nbsp;and&nbsp;confidential&nbsp;information.&nbsp; It&nbsp;is&nbsp;intended&nbsp;only&nbsp;for&nbsp;the&nbsp;use&nbsp;of&nbsp;the&nbsp;person(s)&nbsp;named&nbsp;above.&nbsp; If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;please&nbsp;contact&nbsp;the&nbsp;sender&nbsp;by&nbsp;reply&nbsp;email&nbsp;and&nbsp;permanently&nbsp;delete&nbsp;the&nbsp;original&nbsp;message.&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;br&gt;<br>

</tt>
