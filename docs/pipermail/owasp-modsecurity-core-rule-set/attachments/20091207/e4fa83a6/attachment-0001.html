<tt>
&lt;html&gt;&lt;head&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;&lt;!--&nbsp;DIV&nbsp;{margin:0px;}&nbsp;--&gt;&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;font-family:arial,helvetica,sans-serif;font-size:10pt&quot;&gt;&lt;div&gt;Hi&nbsp;Ryan,&lt;br&gt;&lt;br&gt;I&nbsp;also&nbsp;think&nbsp;of&nbsp;using&nbsp;the&nbsp;audit&nbsp;log&nbsp;file&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;satisfy&nbsp;our&nbsp;situation.&nbsp;I&nbsp;think&nbsp;that&nbsp;the&nbsp;audit&nbsp;log&nbsp;file&nbsp;contains&nbsp;a&nbsp;lot&nbsp;of&nbsp;information&nbsp;and&nbsp;it&nbsp;is&nbsp;only&nbsp;suitable&nbsp;for&nbsp;debugging.&nbsp;Currenly,&nbsp;we&nbsp;are&nbsp;using&nbsp;CRS&nbsp;1.x&nbsp;which&nbsp;output&nbsp;matched&nbsp;rules&nbsp;in&nbsp;apache&nbsp;error&nbsp;log.&nbsp;Then&nbsp;we&nbsp;use&nbsp;some&nbsp;tools&nbsp;to&nbsp;parse&nbsp;apache&nbsp;error&nbsp;log&nbsp;to&nbsp;do&nbsp;some&nbsp;statistics&nbsp;and&nbsp;monitor&nbsp;activity&nbsp;of&nbsp;the&nbsp;rules&nbsp;(based&nbsp;on&nbsp;the&nbsp;rule&nbsp;id).&nbsp;Unfortunately,&nbsp;CRSv2&nbsp;is&nbsp;using&nbsp;a&nbsp;different&nbsp;approach&nbsp;and&nbsp;we&nbsp;can't&nbsp;do&nbsp;this&nbsp;anymore.&lt;br&gt;&lt;br&gt;Anyway,&nbsp;thank&nbsp;a&nbsp;lot&nbsp;for&nbsp;your&nbsp;consideration.&nbsp;I&nbsp;am&nbsp;looking&nbsp;forward&nbsp;to&nbsp;the&nbsp;later&nbsp;version&nbsp;of&nbsp;CRS.&lt;br&gt;&lt;br&gt;-Nam.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;10pt;&quot;&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;font-size:&nbsp;13px;&quot;&gt;&lt;font&nbsp;face=&quot;Tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;hr&nbsp;size=&quot;1&quot;&gt;&lt;b&gt;&lt;span<br>
&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;From:&lt;/span&gt;&lt;/b&gt;&nbsp;Ryan&nbsp;Barnett&nbsp;&amp;lt;ryan.barnett@breach.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;To:&lt;/span&gt;&lt;/b&gt;&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Cc:&lt;/span&gt;&lt;/b&gt;&nbsp;Nham&nbsp;Xuan&nbsp;Nam&nbsp;&amp;lt;nhamxuannam@yahoo.com&amp;gt;&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Sent:&lt;/span&gt;&lt;/b&gt;&nbsp;Monday,&nbsp;December&nbsp;7,&nbsp;2009&nbsp;20:47:26&lt;br&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold;&quot;&gt;Subject:&lt;/span&gt;&lt;/b&gt;&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;How&nbsp;to&nbsp;log&nbsp;matched&nbsp;rules&nbsp;in&nbsp;core&nbsp;ruleset&nbsp;2.x&lt;br&gt;&lt;/font&gt;&lt;br&gt;On&nbsp;Monday&nbsp;07&nbsp;December&nbsp;2009&nbsp;02:47:35&nbsp;am&nbsp;Nham&nbsp;Xuan&nbsp;Nam&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;Hi&nbsp;all,&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;We&nbsp;are&nbsp;currently&nbsp;using&nbsp;modsecuriy&nbsp;with&nbsp;core&nbsp;ruleset&nbsp;1.6.1&nbsp;and&nbsp;we&nbsp;want&nbsp;to&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;upgrade&nbsp;our&nbsp;core&nbsp;ruleset&nbsp;to&nbsp;2.x&nbsp;version.&nbsp;As&nbsp;I&nbsp;know,&nbsp;in&nbsp;this&nbsp;new&nbsp;version,&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;core&nbsp;ruleset&nbsp;uses&nbsp;anomaly_score&nbsp;to&nbsp;detect&nbsp;attacks.&nbsp;When&nbsp;the&nbsp;anomaly_score&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;is&nbsp;higher&nbsp;than&nbsp;a&nbsp;certain&nbsp;value,&nbsp;the&nbsp;request&nbsp;will&nbsp;be&nbsp;deny&nbsp;and<br>
&nbsp;the&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;information&nbsp;is&nbsp;logged.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;But&nbsp;in&nbsp;this&nbsp;way,&nbsp;the&nbsp;logged&nbsp;information&nbsp;did&nbsp;not&nbsp;show&nbsp;us&nbsp;information&nbsp;about&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;the&nbsp;rules&nbsp;which&nbsp;are&nbsp;matched&nbsp;and&nbsp;contributed&nbsp;to&nbsp;the&nbsp;anomaly&nbsp;score&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;(especially&nbsp;the&nbsp;rule&nbsp;id).&nbsp;This&nbsp;is&nbsp;a&nbsp;very&nbsp;useful&nbsp;information.&nbsp;Currently,&nbsp;we&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;use&nbsp;this&nbsp;logs&nbsp;to&nbsp;do&nbsp;some&nbsp;statistics&nbsp;and&nbsp;other&nbsp;things.&nbsp;Do&nbsp;you&nbsp;know&nbsp;any&nbsp;way&lt;br&gt;&amp;gt;&amp;nbsp;&nbsp;to&nbsp;log&nbsp;rule-id&nbsp;of&nbsp;the&nbsp;matched&nbsp;rules&nbsp;to&nbsp;the&nbsp;apache&nbsp;error_log?&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&amp;gt;&nbsp;Please&nbsp;help&nbsp;me.&nbsp;Thanks&nbsp;in&nbsp;advance.&lt;br&gt;&amp;gt;&nbsp;&lt;br&gt;&lt;br&gt;If&nbsp;you&nbsp;want&nbsp;to&nbsp;see&nbsp;which&nbsp;rules&nbsp;matched&nbsp;and&nbsp;contributed&nbsp;to&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;&lt;br&gt;value,&nbsp;then&nbsp;you&nbsp;need&nbsp;to&nbsp;look&nbsp;at&nbsp;the&nbsp;audit&nbsp;log&nbsp;file.&amp;nbsp;&nbsp;All&nbsp;of&nbsp;the&nbsp;rules&nbsp;that&nbsp;&lt;br&gt;matched&nbsp;will&nbsp;be&nbsp;present&nbsp;under&nbsp;Section&nbsp;H.&amp;nbsp;&nbsp;One&nbsp;of&nbsp;the&nbsp;goals&nbsp;of&nbsp;CRS&nbsp;v2&nbsp;was&nbsp;to&nbsp;&lt;br&gt;make&nbsp;the&nbsp;alerts&nbsp;less&nbsp;noisy.&amp;nbsp;&nbsp;Most&nbsp;people&nbsp;just&nbsp;wanted&nbsp;a&nbsp;correlated&nbsp;type&nbsp;of&nbsp;&lt;br&gt;event&nbsp;which&nbsp;would&nbsp;tell&nbsp;them&nbsp;what&nbsp;happened.&lt;br&gt;&lt;br&gt;You&nbsp;bring&nbsp;up&nbsp;a&nbsp;good&nbsp;point&nbsp;though&nbsp;and&nbsp;that&nbsp;is&nbsp;to<br>
&nbsp;include&nbsp;more&nbsp;meta-data&nbsp;within&nbsp;&lt;br&gt;the&nbsp;correlated&nbsp;event.&amp;nbsp;&nbsp;Ivan&nbsp;Ristic&nbsp;brought&nbsp;up&nbsp;a&nbsp;similar&nbsp;issue&nbsp;last&nbsp;week&nbsp;in&nbsp;his&nbsp;&lt;br&gt;CRS&nbsp;review&nbsp;email&nbsp;and&nbsp;this&nbsp;was&nbsp;that&nbsp;the&nbsp;correlated&nbsp;event&nbsp;msg&nbsp;data&nbsp;is&nbsp;only&nbsp;&lt;br&gt;showing&nbsp;the&nbsp;*last*&nbsp;rule&nbsp;msg&nbsp;that&nbsp;triggered.&amp;nbsp;&nbsp;This&nbsp;is&nbsp;due&nbsp;to&nbsp;the&nbsp;current&nbsp;config&nbsp;&lt;br&gt;where&nbsp;a&nbsp;rule&nbsp;match&nbsp;will&nbsp;overwrite&nbsp;the&nbsp;existing&nbsp;msg&nbsp;variable&nbsp;with&nbsp;the&nbsp;current&nbsp;&lt;br&gt;one.&amp;nbsp;&nbsp;A&nbsp;better&nbsp;approach&nbsp;would&nbsp;be&nbsp;too&nbsp;*append*&nbsp;the&nbsp;msg&nbsp;data.&amp;nbsp;&nbsp;To&nbsp;your&nbsp;point&nbsp;-&nbsp;&lt;br&gt;we&nbsp;could&nbsp;also&nbsp;do&nbsp;the&nbsp;same&nbsp;thing&nbsp;with&nbsp;the&nbsp;rule&nbsp;ids.&amp;nbsp;&nbsp;Basically,&nbsp;we&nbsp;could&nbsp;give&nbsp;&lt;br&gt;more&nbsp;meta-data&nbsp;in&nbsp;the&nbsp;correlated&nbsp;event,&nbsp;such&nbsp;as&nbsp;the&nbsp;number&nbsp;of&nbsp;rules&nbsp;that&nbsp;&lt;br&gt;matched&nbsp;and&nbsp;their&nbsp;associated&nbsp;rule&nbsp;ids&nbsp;and/or&nbsp;messages.&lt;br&gt;&lt;br&gt;I&nbsp;will&nbsp;look&nbsp;into&nbsp;this.&lt;br&gt;&lt;br&gt;-Ryan&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;!--&nbsp;cg3.c902.mail.ac4.yahoo.com&nbsp;compressed/chunked&nbsp;Mon&nbsp;Dec&nbsp;&nbsp;7&nbsp;08:27:48&nbsp;PST&nbsp;2009&nbsp;--&gt;<br>
&lt;/div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;hr&nbsp;size=1&gt;&nbsp;&lt;a&nbsp;href=&quot;http://sg.rd.yahoo.com/aa/mail/domainchoice/mail/signature/*http://mail.promotions.yahoo.com/newdomains/aa/&quot;&gt;&nbsp;New&nbsp;Email&nbsp;addresses&nbsp;available&nbsp;on&nbsp;Yahoo!&nbsp;&lt;/a&gt;&nbsp;&lt;br&gt;<br>
Get&nbsp;the&nbsp;Email&nbsp;name&nbsp;you&amp;#39;ve&nbsp;always&nbsp;wanted&nbsp;on&nbsp;the&nbsp;new&nbsp;@ymail&nbsp;and&nbsp;@rocketmail.&lt;br&gt;<br>
Hurry&nbsp;before&nbsp;someone&nbsp;else&nbsp;does!&lt;/body&gt;&lt;/html&gt;
</tt>
