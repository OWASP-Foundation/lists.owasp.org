<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'DejaVu&nbsp;Sans';&nbsp;font-size:9pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;On&nbsp;Monday&nbsp;03&nbsp;August&nbsp;2009&nbsp;12:03:06&nbsp;am&nbsp;Josue&nbsp;Del&nbsp;Valle&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hi,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;am&nbsp;new&nbsp;to&nbsp;mod_security&nbsp;and&nbsp;new&nbsp;to&nbsp;Apache.&nbsp;&nbsp;I've&nbsp;been&nbsp;asked&nbsp;by&nbsp;my&nbsp;employer&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;configure&nbsp;and&nbsp;secure&nbsp;an&nbsp;Apache&nbsp;server&nbsp;that&nbsp;will&nbsp;run&nbsp;on&nbsp;Windows.&nbsp;&nbsp;I've&lt;br&gt;<br>
&amp;gt;&nbsp;been&nbsp;reading&nbsp;about&nbsp;the&nbsp;Core&nbsp;Rules&nbsp;and&nbsp;understand&nbsp;that&nbsp;initially&nbsp;they&nbsp;should&lt;br&gt;<br>
&amp;gt;&nbsp;be&nbsp;set&nbsp;to&nbsp;DetectOnly&nbsp;mode&nbsp;and&nbsp;that&nbsp;I&nbsp;should&nbsp;check&nbsp;my&nbsp;logs&nbsp;for&nbsp;false&lt;br&gt;<br>
&amp;gt;&nbsp;positives&nbsp;before&nbsp;turning&nbsp;them&nbsp;on.&nbsp;&nbsp;What&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;is&nbsp;what&nbsp;I&nbsp;will&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;looking&nbsp;for&nbsp;in&nbsp;the&nbsp;logs.&nbsp;&nbsp;The&nbsp;type&nbsp;of&nbsp;attacks&nbsp;or&nbsp;false&nbsp;positives&nbsp;blocks,&nbsp;&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;How&nbsp;can&nbsp;I&nbsp;identify&nbsp;false&nbsp;positives?&nbsp;&nbsp;For&nbsp;how&nbsp;long&nbsp;should&nbsp;I&nbsp;run&nbsp;it&nbsp;on&lt;br&gt;<br>
&amp;gt;&nbsp;DetectOnly&nbsp;mode?&nbsp;&nbsp;Bottom&nbsp;line,&nbsp;I&nbsp;will&nbsp;really&nbsp;appreciate&nbsp;if&nbsp;someone&nbsp;can&lt;br&gt;<br>
&amp;gt;&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction.&nbsp;&nbsp;Thanks&nbsp;in&nbsp;advance&nbsp;for&nbsp;your&nbsp;help.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Welcome&nbsp;to&nbsp;ModSecurity!&nbsp;&nbsp;As&nbsp;far&nbsp;as&nbsp;the&nbsp;SecRuleEngine&nbsp;goes&nbsp;(http://www.modsecurity.org/documentation/modsecurity-apache/2.5.9/modsecurity2-apache-reference.html#N10A4F)&nbsp;in&nbsp;the&nbsp;older&nbsp;version&nbsp;of&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;(CRS)&nbsp;we&nbsp;certainly&nbsp;did&nbsp;recommend&nbsp;that&nbsp;this&nbsp;be&nbsp;set&nbsp;to&nbsp;DetectionOnly.&nbsp;&nbsp;The&nbsp;rationale&nbsp;for&nbsp;this&nbsp;was&nbsp;so&nbsp;that&nbsp;you&nbsp;would&nbsp;not&nbsp;mistakenly&nbsp;block&nbsp;any&nbsp;legitimate&nbsp;transactions&nbsp;before&nbsp;you&nbsp;had&nbsp;a&nbsp;chance&nbsp;to&nbsp;tune&nbsp;the&nbsp;rules&nbsp;a&nbsp;bit&nbsp;for&nbsp;your&nbsp;environment.&nbsp;&nbsp;In&nbsp;the&nbsp;current&nbsp;CRS&nbsp;v2.0.0,&nbsp;we&nbsp;have&nbsp;changed&nbsp;how&nbsp;the&nbsp;rules&nbsp;work.&nbsp;&nbsp;The&nbsp;SecRuleEngine&nbsp;is&nbsp;set&nbsp;to&nbsp;On&nbsp;(to&nbsp;allow&nbsp;blocking)&nbsp;however&nbsp;the&nbsp;rules&nbsp;all&nbsp;use&nbsp;the&nbsp;&quot;block&quot;&nbsp;action&nbsp;which&nbsp;reference&nbsp;the&nbsp;SecDefaultAction&nbsp;setting&nbsp;(which&nbsp;is&nbsp;set&nbsp;to&nbsp;pass).&nbsp;&nbsp;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Specifically,&nbsp;the&nbsp;rules&nbsp;are&nbsp;now&nbsp;running&nbsp;in&nbsp;a&nbsp;&quot;collaborative&quot;&nbsp;mode&nbsp;and&nbsp;use&nbsp;an&nbsp;anomaly&nbsp;scoring&nbsp;system.&nbsp;&nbsp;Each&nbsp;rule,&nbsp;if&nbsp;it&nbsp;triggers,&nbsp;will&nbsp;increase&nbsp;a&nbsp;transactional&nbsp;anomaly&nbsp;score.&nbsp;&nbsp;At&nbsp;the&nbsp;end&nbsp;of&nbsp;phase:2&nbsp;(the&nbsp;last&nbsp;chance&nbsp;to&nbsp;block&nbsp;the&nbsp;inbound&nbsp;request),&nbsp;you&nbsp;can&nbsp;set&nbsp;an&nbsp;appropriate&nbsp;anomaly&nbsp;score&nbsp;for&nbsp;your&nbsp;site.&nbsp;&nbsp;This&nbsp;lessens&nbsp;the&nbsp;likelihood&nbsp;of&nbsp;false&nbsp;positives.&nbsp;&nbsp;Basically,&nbsp;I&nbsp;would&nbsp;suggest&nbsp;that&nbsp;you&nbsp;review/update&nbsp;the&nbsp;modsecurity_crs_49_enforcement.conf&nbsp;file&nbsp;and&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;anomaly&nbsp;scoring&nbsp;level&nbsp;is&nbsp;set&nbsp;to&nbsp;around&nbsp;20&nbsp;and&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;blocking&nbsp;action.&nbsp;&nbsp;This&nbsp;will&nbsp;allow&nbsp;your&nbsp;rules&nbsp;to&nbsp;generate&nbsp;alerts&nbsp;but&nbsp;not&nbsp;block.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;As&nbsp;for&nbsp;the&nbsp;false&nbsp;positives,&nbsp;&nbsp;I&nbsp;would&nbsp;suggest&nbsp;that&nbsp;you&nbsp;review&nbsp;the&nbsp;Data&nbsp;Format&nbsp;documentation&nbsp;(http://www.modsecurity.org/documentation/modsecurity-apache/2.5.9/modsecurity2-data-formats.html)&nbsp;so&nbsp;that&nbsp;you&nbsp;understand&nbsp;what&nbsp;data&nbsp;is&nbsp;presented.&nbsp;&nbsp;The&nbsp;alert&nbsp;data&nbsp;will&nbsp;tell&nbsp;you&nbsp;what&nbsp;rule&nbsp;matched,&nbsp;where&nbsp;in&nbsp;the&nbsp;transaction&nbsp;the&nbsp;match&nbsp;occurred&nbsp;and&nbsp;what&nbsp;data&nbsp;matched.&nbsp;&nbsp;You&nbsp;can&nbsp;then&nbsp;review&nbsp;the&nbsp;full&nbsp;audit&nbsp;log&nbsp;data&nbsp;of&nbsp;the&nbsp;transaction&nbsp;to&nbsp;confirm&nbsp;if&nbsp;the&nbsp;match&nbsp;was&nbsp;correct&nbsp;or&nbsp;not.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;By&nbsp;the&nbsp;way&nbsp;-&nbsp;the&nbsp;OWASP&nbsp;CRS&nbsp;project&nbsp;site&nbsp;needs&nbsp;to&nbsp;have&nbsp;better&nbsp;information&nbsp;to&nbsp;address&nbsp;your&nbsp;questions.&nbsp;&nbsp;We&nbsp;will&nbsp;update&nbsp;it&nbsp;soon.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Hope&nbsp;this&nbsp;info&nbsp;helps.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;--&nbsp;&lt;br&gt;<br>
Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;<br>
WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;<br>
http://tacticalwebappsec.blogspot.com&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
