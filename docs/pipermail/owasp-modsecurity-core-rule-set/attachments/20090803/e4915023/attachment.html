<tt>
&lt;div&gt;Ryan,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;a&nbsp;whole&nbsp;lot&nbsp;for&nbsp;your&nbsp;detailed&nbsp;explanation. &nbsp;I&nbsp;will do&nbsp;as&nbsp;recommended.  &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Regards,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Josue &nbsp;&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Aug&nbsp;3,&nbsp;2009&nbsp;at&nbsp;10:24&nbsp;AM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ryan.barnett@breach.com&quot;&gt;ryan.barnett@breach.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;<br>
&lt;div&nbsp;style=&quot;FONT-WEIGHT:&nbsp;400;&nbsp;FONT-SIZE:&nbsp;9pt;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;FONT-FAMILY:&nbsp;&amp;#39;DejaVu&nbsp;Sans&amp;#39;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;Monday&nbsp;03&nbsp;August&nbsp;2009&nbsp;12:03:06&nbsp;am&nbsp;Josue&nbsp;Del&nbsp;Valle&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;Hi,&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;I&nbsp;am&nbsp;new&nbsp;to&nbsp;mod_security&nbsp;and&nbsp;new&nbsp;to&nbsp;Apache.&nbsp;I&amp;#39;ve&nbsp;been&nbsp;asked&nbsp;by&nbsp;my&nbsp;employer&lt;br&gt;&amp;gt;&nbsp;to&nbsp;configure&nbsp;and&nbsp;secure&nbsp;an&nbsp;Apache&nbsp;server&nbsp;that&nbsp;will&nbsp;run&nbsp;on&nbsp;Windows.&nbsp;I&amp;#39;ve&lt;br&gt;<br>
&amp;gt;&nbsp;been&nbsp;reading&nbsp;about&nbsp;the&nbsp;Core&nbsp;Rules&nbsp;and&nbsp;understand&nbsp;that&nbsp;initially&nbsp;they&nbsp;should&lt;br&gt;&amp;gt;&nbsp;be&nbsp;set&nbsp;to&nbsp;DetectOnly&nbsp;mode&nbsp;and&nbsp;that&nbsp;I&nbsp;should&nbsp;check&nbsp;my&nbsp;logs&nbsp;for&nbsp;false&lt;br&gt;&amp;gt;&nbsp;positives&nbsp;before&nbsp;turning&nbsp;them&nbsp;on.&nbsp;What&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;is&nbsp;what&nbsp;I&nbsp;will&nbsp;be&lt;br&gt;<br>
&amp;gt;&nbsp;looking&nbsp;for&nbsp;in&nbsp;the&nbsp;logs.&nbsp;The&nbsp;type&nbsp;of&nbsp;attacks&nbsp;or&nbsp;false&nbsp;positives&nbsp;blocks,&nbsp;&lt;br&gt;&amp;gt;&nbsp;How&nbsp;can&nbsp;I&nbsp;identify&nbsp;false&nbsp;positives?&nbsp;For&nbsp;how&nbsp;long&nbsp;should&nbsp;I&nbsp;run&nbsp;it&nbsp;on&lt;br&gt;&amp;gt;&nbsp;DetectOnly&nbsp;mode?&nbsp;Bottom&nbsp;line,&nbsp;I&nbsp;will&nbsp;really&nbsp;appreciate&nbsp;if&nbsp;someone&nbsp;can&lt;br&gt;<br>
&amp;gt;&nbsp;point&nbsp;me&nbsp;in&nbsp;the&nbsp;right&nbsp;direction.&nbsp;Thanks&nbsp;in&nbsp;advance&nbsp;for&nbsp;your&nbsp;help.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;Welcome&nbsp;to&nbsp;ModSecurity!&nbsp;As&nbsp;far&nbsp;as&nbsp;the&nbsp;SecRuleEngine&nbsp;goes&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/documentation/modsecurity-apache/2.5.9/modsecurity2-apache-reference.html#N10A4F&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.modsecurity.org/documentation/modsecurity-apache/2.5.9/modsecurity2-apache-reference.html#N10A4F&lt;/a&gt;)&nbsp;in&nbsp;the&nbsp;older&nbsp;version&nbsp;of&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;(CRS)&nbsp;we&nbsp;certainly&nbsp;did&nbsp;recommend&nbsp;that&nbsp;this&nbsp;be&nbsp;set&nbsp;to&nbsp;DetectionOnly.&nbsp;The&nbsp;rationale&nbsp;for&nbsp;this&nbsp;was&nbsp;so&nbsp;that&nbsp;you&nbsp;would&nbsp;not&nbsp;mistakenly&nbsp;block&nbsp;any&nbsp;legitimate&nbsp;transactions&nbsp;before&nbsp;you&nbsp;had&nbsp;a&nbsp;chance&nbsp;to&nbsp;tune&nbsp;the&nbsp;rules&nbsp;a&nbsp;bit&nbsp;for&nbsp;your&nbsp;environment.&nbsp;In&nbsp;the&nbsp;current&nbsp;CRS&nbsp;v2.0.0,&nbsp;we&nbsp;have&nbsp;changed&nbsp;how&nbsp;the&nbsp;rules&nbsp;work.&nbsp;The&nbsp;SecRuleEngine&nbsp;is&nbsp;set&nbsp;to&nbsp;On&nbsp;(to&nbsp;allow&nbsp;blocking)&nbsp;however&nbsp;the&nbsp;rules&nbsp;all&nbsp;use&nbsp;the&nbsp;&amp;quot;block&amp;quot;&nbsp;action&nbsp;which&nbsp;reference&nbsp;the&nbsp;SecDefaultAction&nbsp;setting&nbsp;(which&nbsp;is&nbsp;set&nbsp;to&nbsp;pass).&nbsp;&lt;br&gt;<br>
<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;Specifically,&nbsp;the&nbsp;rules&nbsp;are&nbsp;now&nbsp;running&nbsp;in&nbsp;a&nbsp;&amp;quot;collaborative&amp;quot;&nbsp;mode&nbsp;and&nbsp;use&nbsp;an&nbsp;anomaly&nbsp;scoring&nbsp;system.&nbsp;Each&nbsp;rule,&nbsp;if&nbsp;it&nbsp;triggers,&nbsp;will&nbsp;increase&nbsp;a&nbsp;transactional&nbsp;anomaly&nbsp;score.&nbsp;At&nbsp;the&nbsp;end&nbsp;of&nbsp;phase:2&nbsp;(the&nbsp;last&nbsp;chance&nbsp;to&nbsp;block&nbsp;the&nbsp;inbound&nbsp;request),&nbsp;you&nbsp;can&nbsp;set&nbsp;an&nbsp;appropriate&nbsp;anomaly&nbsp;score&nbsp;for&nbsp;your&nbsp;site.&nbsp;This&nbsp;lessens&nbsp;the&nbsp;likelihood&nbsp;of&nbsp;false&nbsp;positives.&nbsp;Basically,&nbsp;I&nbsp;would&nbsp;suggest&nbsp;that&nbsp;you&nbsp;review/update&nbsp;the&nbsp;modsecurity_crs_49_enforcement.conf&nbsp;file&nbsp;and&nbsp;make&nbsp;sure&nbsp;that&nbsp;the&nbsp;anomaly&nbsp;scoring&nbsp;level&nbsp;is&nbsp;set&nbsp;to&nbsp;around&nbsp;20&nbsp;and&nbsp;that&nbsp;there&nbsp;is&nbsp;no&nbsp;blocking&nbsp;action.&nbsp;This&nbsp;will&nbsp;allow&nbsp;your&nbsp;rules&nbsp;to&nbsp;generate&nbsp;alerts&nbsp;but&nbsp;not&nbsp;block.&lt;br&gt;<br>
<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;As&nbsp;for&nbsp;the&nbsp;false&nbsp;positives,&nbsp;I&nbsp;would&nbsp;suggest&nbsp;that&nbsp;you&nbsp;review&nbsp;the&nbsp;Data&nbsp;Format&nbsp;documentation&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/documentation/modsecurity-apache/2.5.9/modsecurity2-data-formats.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.modsecurity.org/documentation/modsecurity-apache/2.5.9/modsecurity2-data-formats.html&lt;/a&gt;)&nbsp;so&nbsp;that&nbsp;you&nbsp;understand&nbsp;what&nbsp;data&nbsp;is&nbsp;presented.&nbsp;The&nbsp;alert&nbsp;data&nbsp;will&nbsp;tell&nbsp;you&nbsp;what&nbsp;rule&nbsp;matched,&nbsp;where&nbsp;in&nbsp;the&nbsp;transaction&nbsp;the&nbsp;match&nbsp;occurred&nbsp;and&nbsp;what&nbsp;data&nbsp;matched.&nbsp;You&nbsp;can&nbsp;then&nbsp;review&nbsp;the&nbsp;full&nbsp;audit&nbsp;log&nbsp;data&nbsp;of&nbsp;the&nbsp;transaction&nbsp;to&nbsp;confirm&nbsp;if&nbsp;the&nbsp;match&nbsp;was&nbsp;correct&nbsp;or&nbsp;not.&lt;br&gt;<br>
<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;By&nbsp;the&nbsp;way&nbsp;-&nbsp;the&nbsp;OWASP&nbsp;CRS&nbsp;project&nbsp;site&nbsp;needs&nbsp;to&nbsp;have&nbsp;better&nbsp;information&nbsp;to&nbsp;address&nbsp;your&nbsp;questions.&nbsp;We&nbsp;will&nbsp;update&nbsp;it&nbsp;soon.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;Hope&nbsp;this&nbsp;info&nbsp;helps.&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;--&nbsp;&lt;br&gt;Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;&lt;a&nbsp;href=&quot;http://tacticalwebappsec.blogspot.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://tacticalwebappsec.blogspot.com&lt;/a&gt;&lt;br&gt;<br>
<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
