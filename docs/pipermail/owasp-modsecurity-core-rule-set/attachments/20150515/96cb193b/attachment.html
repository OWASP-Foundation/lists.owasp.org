<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;<br>
<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;12pt;<br>
font-family:Calibri<br>
}<br>
--&gt;&lt;/style&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&nbsp;Barry!&lt;div&gt;Well,&nbsp;it&nbsp;didn't&nbsp;work...&lt;/div&gt;&lt;div&gt;This&nbsp;is&nbsp;what&nbsp;I&nbsp;did:&lt;/div&gt;&lt;div&gt;My&nbsp;mod_security&nbsp;conf&nbsp;and&nbsp;rules&nbsp;files&nbsp;are&nbsp;set&nbsp;up&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;id=&quot;inlineImage0&quot;&nbsp;style=&quot;display:&nbsp;inline-block&quot;&gt;&lt;script&nbsp;type=&quot;jsv#951_&quot;&gt;&lt;/script&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;contenteditable=&quot;true&quot;&gt;&nbsp;&lt;/span&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;style=&quot;display:&nbsp;inline-block&quot;&nbsp;unselectable=&quot;on&quot;&nbsp;contenteditable=&quot;false&quot;&nbsp;class=&quot;inlineImage&quot;&nbsp;initheight=&quot;174&quot;&nbsp;initwidth=&quot;679&quot;&gt;&lt;img&nbsp;src=&quot;cid:inlineImage0&quot;&nbsp;height=&quot;174&quot;&nbsp;width=&quot;679&quot;&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;contenteditable=&quot;true&quot;&gt;&nbsp;&lt;/span&gt;&lt;script&nbsp;type=&quot;jsv/951_&quot;&gt;&lt;/script&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;modsecurity_crs_15_customrules.conf&nbsp;file&nbsp;has&nbsp;only&nbsp;this&nbsp;line:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;@ipMatch&nbsp;999.99.99.99&quot;&nbsp;&quot;id:1000,phase:2,t:none,pass,nolog,ctl:ruleRemoveById=960009&quot;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;restarted&nbsp;Apache,&nbsp;but&nbsp;rule&nbsp;960009&nbsp;still&nbsp;process&nbsp;that&nbsp;IP&nbsp;as&nbsp;source.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;What&nbsp;did&nbsp;I&nbsp;do&nbsp;wrong?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;There&nbsp;is&nbsp;also&nbsp;a&nbsp;file&nbsp;named&nbsp;/usr/local/apache/conf/modsec2.whitelist.conf&nbsp;with&nbsp;just&nbsp;this&nbsp;on&nbsp;it:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&nbsp;ConfigServer&nbsp;ModSecurity&nbsp;whitelist&nbsp;file&lt;/div&gt;&lt;div&gt;&lt;LocationMatch&nbsp;.*&gt;&lt;/div&gt;&lt;div&gt;&lt;/LocationMatch&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;I'm&nbsp;confused,&nbsp;don't&nbsp;know&nbsp;in&nbsp;which&nbsp;files&nbsp;this&nbsp;directive&nbsp;should&nbsp;go&nbsp;or&nbsp;what&nbsp;else&nbsp;should&nbsp;I&nbsp;have&nbsp;done.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;Tks!&lt;/div&gt;&lt;div&gt;All&nbsp;the&nbsp;best!&lt;/div&gt;&lt;div&gt;Luiz&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&gt;&nbsp;From:&nbsp;barry_pollard@hotmail.com&lt;br&gt;&gt;&nbsp;To:&nbsp;asiayaisa@hotmail.com;&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;br&gt;&gt;&nbsp;Subject:&nbsp;RE:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Rule&nbsp;960009&nbsp;generates&nbsp;false&nbsp;positives&nbsp;from&nbsp;my&nbsp;own&nbsp;server&nbsp;IP&lt;br&gt;&gt;&nbsp;Date:&nbsp;Wed,&nbsp;13&nbsp;May&nbsp;2015&nbsp;10:07:24&nbsp;+0100&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;That&nbsp;would&nbsp;work&nbsp;though&nbsp;I&nbsp;personally&nbsp;prefer&nbsp;to&nbsp;use&nbsp;@ipMatch&nbsp;which&nbsp;also&nbsp;allows&nbsp;you&nbsp;to&nbsp;match&nbsp;multiple&nbsp;IPs:&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;@ipMatch&nbsp;XXX.YYY.Z.WWW&nbsp;XXX.YYY.Z.VVVV&quot;&nbsp;&nbsp;&quot;id:1000,phase:2,t:none,pass,nolog,ctl:ruleRemoveById=960009&quot;&nbsp;&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;A&nbsp;few&nbsp;other&nbsp;things&nbsp;to&nbsp;note:&lt;br&gt;&gt;&nbsp;1)&nbsp;960009&nbsp;is&nbsp;a&nbsp;phase&nbsp;2&nbsp;rule&nbsp;and&nbsp;you&nbsp;have&nbsp;specified&nbsp;phase&nbsp;1&nbsp;in&nbsp;your&nbsp;rule&nbsp;below.&nbsp;I'm&nbsp;pretty&nbsp;sure&nbsp;that&nbsp;rules&nbsp;cannot&nbsp;see&nbsp;other&nbsp;rules&nbsp;outside&nbsp;of&nbsp;their&nbsp;phase&nbsp;so&nbsp;it&nbsp;needs&nbsp;to&nbsp;be&nbsp;in&nbsp;the&nbsp;same&nbsp;phase.&nbsp;So&nbsp;I've&nbsp;updated&nbsp;this&nbsp;to&nbsp;phase&nbsp;2&nbsp;in&nbsp;my&nbsp;version&nbsp;above.&lt;br&gt;&gt;&nbsp;2)&nbsp;Your&nbsp;rule&nbsp;must&nbsp;have&nbsp;it's&nbsp;own&nbsp;id&nbsp;(as&nbsp;of&nbsp;ModSecurity&nbsp;2.7)&nbsp;so&nbsp;I've&nbsp;given&nbsp;it&nbsp;an&nbsp;id&nbsp;of&nbsp;1000.&nbsp;Make&nbsp;sure&nbsp;this&nbsp;doesn't&nbsp;clash&nbsp;with&nbsp;any&nbsp;existing&nbsp;rule&nbsp;you&nbsp;have.&nbsp;Principal&nbsp;is&nbsp;anything&nbsp;less&nbsp;than&nbsp;99,999&nbsp;are&nbsp;your&nbsp;own&nbsp;use.&nbsp;See&nbsp;here&nbsp;for&nbsp;more&nbsp;info:&nbsp;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#id&lt;br&gt;&gt;&nbsp;3)&nbsp;You&nbsp;could&nbsp;disable&nbsp;ModSecurity&nbsp;completely&nbsp;for&nbsp;internal&nbsp;addresses&nbsp;with&nbsp;a&nbsp;ctl:ruleEngine=off&nbsp;rule.&nbsp;Personally&nbsp;I&nbsp;don't&nbsp;like&nbsp;that&nbsp;as&nbsp;I&nbsp;want&nbsp;them&nbsp;on&nbsp;for&nbsp;testing&nbsp;purposes&nbsp;so&nbsp;we're&nbsp;not&nbsp;caught&nbsp;out&nbsp;with&nbsp;a&nbsp;rule&nbsp;that&nbsp;only&nbsp;runs&nbsp;in&nbsp;production&nbsp;so&nbsp;think&nbsp;just&nbsp;disabling&nbsp;the&nbsp;specific&nbsp;rules&nbsp;is&nbsp;a&nbsp;better&nbsp;option.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;However&nbsp;I&nbsp;think&nbsp;it&nbsp;would&nbsp;be&nbsp;good&nbsp;to&nbsp;understand&nbsp;why&nbsp;you&nbsp;need&nbsp;to&nbsp;do&nbsp;this&nbsp;at&nbsp;all.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Rule&nbsp;960009&nbsp;checks&nbsp;for&nbsp;requests&nbsp;missing&nbsp;a&nbsp;user&nbsp;agent.&nbsp;All&nbsp;decent&nbsp;browsers&nbsp;send&nbsp;a&nbsp;user&nbsp;agent&nbsp;hence&nbsp;why&nbsp;this&nbsp;rule&nbsp;is&nbsp;in&nbsp;place&nbsp;as&nbsp;the&nbsp;lack&nbsp;of&nbsp;a&nbsp;user&nbsp;agent&nbsp;is&nbsp;probably&nbsp;due&nbsp;to&nbsp;some&nbsp;script&nbsp;or&nbsp;such&nbsp;like,&nbsp;so&nbsp;it&nbsp;is&nbsp;a&nbsp;good&nbsp;rule.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;So&nbsp;why&nbsp;are&nbsp;you&nbsp;getting&nbsp;so&nbsp;many&nbsp;requests&nbsp;from&nbsp;internal&nbsp;addresses&nbsp;without&nbsp;a&nbsp;user&nbsp;agent&nbsp;and&nbsp;should&nbsp;you&nbsp;fix&nbsp;that&nbsp;rather&nbsp;than&nbsp;add&nbsp;the&nbsp;above&nbsp;rule&nbsp;to&nbsp;get&nbsp;around&nbsp;that?&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;I&nbsp;can&nbsp;think&nbsp;of&nbsp;two&nbsp;reasons:&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;1)&nbsp;Monitoring&nbsp;scripts&nbsp;or&nbsp;tools&nbsp;which&nbsp;are&nbsp;not&nbsp;quite&nbsp;as&nbsp;compliant&nbsp;as&nbsp;web&nbsp;browsers.&nbsp;So&nbsp;perhaps&nbsp;change&nbsp;these&nbsp;to&nbsp;also&nbsp;report&nbsp;the&nbsp;user&nbsp;agent&nbsp;as&nbsp;that&nbsp;could&nbsp;be&nbsp;useful&nbsp;information&nbsp;to&nbsp;know&nbsp;(though&nbsp;with&nbsp;third&nbsp;party&nbsp;tools&nbsp;that&nbsp;might&nbsp;not&nbsp;always&nbsp;be&nbsp;possible).&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;2)&nbsp;Needlessly&nbsp;connecting&nbsp;to&nbsp;Apache.&nbsp;We&nbsp;use&nbsp;Apache&nbsp;to&nbsp;server&nbsp;up&nbsp;static&nbsp;pages&nbsp;and&nbsp;also&nbsp;in&nbsp;proxy&nbsp;mode&nbsp;to&nbsp;pass&nbsp;dynamic&nbsp;requests&nbsp;on&nbsp;to&nbsp;an&nbsp;application&nbsp;server.&nbsp;After&nbsp;installing&nbsp;mod&nbsp;security&nbsp;and&nbsp;noticing&nbsp;similar&nbsp;to&nbsp;you,&nbsp;we&nbsp;investigated&nbsp;and&nbsp;discovered&nbsp;some&nbsp;of&nbsp;our&nbsp;dynamic&nbsp;applications&nbsp;were&nbsp;needlessly&nbsp;making&nbsp;calls&nbsp;to&nbsp;Apache,&nbsp;just&nbsp;to&nbsp;connect&nbsp;back&nbsp;to&nbsp;the&nbsp;app&nbsp;server&nbsp;again.&nbsp;It&nbsp;was&nbsp;actually&nbsp;better&nbsp;to&nbsp;change&nbsp;them&nbsp;to&nbsp;connect&nbsp;directly&nbsp;to&nbsp;the&nbsp;app&nbsp;server,&nbsp;which&nbsp;resolved&nbsp;the&nbsp;issue,&nbsp;as&nbsp;well&nbsp;as&nbsp;saving&nbsp;network&nbsp;traffic&nbsp;and&nbsp;a&nbsp;(admittedly&nbsp;small&nbsp;amount&nbsp;of)&nbsp;Apache&nbsp;load.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Thanks,&lt;br&gt;&gt;&nbsp;Barry&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;________________________________&lt;br&gt;&gt;&nbsp;&gt;&nbsp;From:&nbsp;asiayaisa@hotmail.com&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;To:&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Date:&nbsp;Tue,&nbsp;12&nbsp;May&nbsp;2015&nbsp;20:34:22&nbsp;-0300&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Subject:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Rule&nbsp;960009&nbsp;generates&nbsp;false&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;positives&nbsp;from&nbsp;my&nbsp;own&nbsp;server&nbsp;IP&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Hi!&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;don't&nbsp;know&nbsp;if&nbsp;anyone&nbsp;experiences&nbsp;the&nbsp;same&nbsp;issue&nbsp;as&nbsp;us&nbsp;here,&nbsp;but&nbsp;I&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;suppose&nbsp;at&nbsp;least&nbsp;this&nbsp;might&nbsp;contribute&nbsp;to&nbsp;all.&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;installed&nbsp;OWASP&nbsp;rules&nbsp;on&nbsp;a&nbsp;Centos&nbsp;running&nbsp;2&nbsp;Joomla&nbsp;sites&nbsp;with&nbsp;nearly&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;5,000&nbsp;unique&nbsp;visitors&nbsp;a&nbsp;day.&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;I&nbsp;was&nbsp;fortunate&nbsp;enough&nbsp;to&nbsp;identify&nbsp;and&nbsp;disable&nbsp;12&nbsp;rules&nbsp;that&nbsp;delivered&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;a&nbsp;bunch&nbsp;of&nbsp;false&nbsp;positives&nbsp;(one&nbsp;of&nbsp;them&nbsp;locked&nbsp;down&nbsp;the&nbsp;server&nbsp;when&nbsp;one&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;of&nbsp;us&nbsp;in&nbsp;the&nbsp;team&nbsp;submitted&nbsp;a&nbsp;security&nbsp;scan&nbsp;from&nbsp;CSF/LFD...).&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;So,&nbsp;now&nbsp;it&nbsp;is&nbsp;running&nbsp;fine&nbsp;but&nbsp;one&nbsp;rule&nbsp;still&nbsp;delivers&nbsp;near&nbsp;1,000&nbsp;false&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;positives&nbsp;a&nbsp;day&nbsp;and&nbsp;oddly&nbsp;enough&nbsp;having&nbsp;our&nbsp;own&nbsp;server&nbsp;IP&nbsp;as&nbsp;source!&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;And&nbsp;severity&nbsp;level&nbsp;for&nbsp;ALL&nbsp;of&nbsp;the&nbsp;hits&nbsp;are&nbsp;NOTICE.&nbsp;So,&nbsp;this&nbsp;is&nbsp;not&nbsp;so&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;much&nbsp;troublesome,&nbsp;except&nbsp;for&nbsp;the&nbsp;extra&nbsp;load&nbsp;on&nbsp;the&nbsp;server&nbsp;and&nbsp;the&nbsp;log&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;size.&nbsp;I&nbsp;rotate&nbsp;it&nbsp;automatically&nbsp;everynight&nbsp;but&nbsp;it&nbsp;comes&nbsp;out&nbsp;at&nbsp;nearly&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;0,3&nbsp;GB&nbsp;as&nbsp;standard&nbsp;size.&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;So,&nbsp;what&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;do&nbsp;but&nbsp;don't&nbsp;know&nbsp;exactly&nbsp;how&nbsp;is&nbsp;to&nbsp;implent&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;something&nbsp;like&nbsp;this&nbsp;in&nbsp;a&nbsp;file&nbsp;named&nbsp;modsecurity_crs_15_localrules.conf:&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;@streq&nbsp;XXX.YYY.Z.WWW&quot;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&gt;&nbsp;&quot;phase:1,t:none,pass,nolog,ctl:ruleRemoveById=960009&quot;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;where&nbsp;XXX.YYY.Z.WWW&nbsp;is&nbsp;my&nbsp;server's&nbsp;IP&nbsp;address.&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Does&nbsp;anyone&nbsp;know&nbsp;if&nbsp;this&nbsp;is&nbsp;correct&nbsp;and&nbsp;if&nbsp;it&nbsp;can&nbsp;actually&nbsp;work&nbsp;to&nbsp;keep&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;my&nbsp;server&nbsp;out&nbsp;of&nbsp;this&nbsp;rule&nbsp;execution?&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Tks&nbsp;a&nbsp;lot!&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;All&nbsp;the&nbsp;best!&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Luiz&nbsp;Guilherme&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;_______________________________________________&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;Owasp-modsecurity-core-rule-set@lists.owasp.org&nbsp;&lt;br&gt;&gt;&nbsp;&gt;&nbsp;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&nbsp;&lt;br&gt;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
