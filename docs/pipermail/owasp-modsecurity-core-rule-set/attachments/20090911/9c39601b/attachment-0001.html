<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'DejaVu&nbsp;Sans';&nbsp;font-size:9pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;On&nbsp;Friday&nbsp;11&nbsp;September&nbsp;2009&nbsp;11:20:21&nbsp;am&nbsp;OSSEC&nbsp;junkie&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;When&nbsp;I&nbsp;tested&nbsp;this&nbsp;out&nbsp;with&nbsp;our&nbsp;systems,&nbsp;it&nbsp;was&nbsp;not&nbsp;detecting&nbsp;every&nbsp;single&lt;br&gt;<br>
&amp;gt;&nbsp;IIE8&nbsp;XSS&nbsp;attempt&nbsp;I&nbsp;used.&nbsp;It&nbsp;would&nbsp;seem&nbsp;to&nbsp;detect&nbsp;one,&nbsp;then&nbsp;let&nbsp;another&lt;br&gt;<br>
&amp;gt;&nbsp;pass,&nbsp;then&nbsp;detect&nbsp;one,&nbsp;let&nbsp;another&nbsp;pass...&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;What&nbsp;IE8&nbsp;XSS&nbsp;payloads&nbsp;were&nbsp;you&nbsp;using&nbsp;to&nbsp;test?&nbsp;&nbsp;Did&nbsp;you&nbsp;look&nbsp;at&nbsp;the&nbsp;debug&nbsp;log?&nbsp;&nbsp;We&nbsp;would&nbsp;want&nbsp;to&nbsp;see&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;signature&nbsp;issue&nbsp;vs.&nbsp;something&nbsp;related&nbsp;to&nbsp;using&nbsp;setvar/anomaly&nbsp;scoring.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&amp;gt;&nbsp;On&nbsp;Fri,&nbsp;Sep&nbsp;11,&nbsp;2009&nbsp;at&nbsp;8:16&nbsp;AM,&nbsp;Ryan&nbsp;Barnett&nbsp;&amp;lt;rcbarnett@gmail.com&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;On&nbsp;Fri,&nbsp;Sep&nbsp;11,&nbsp;2009&nbsp;at&nbsp;11:10&nbsp;AM,&nbsp;OSSEC&nbsp;junkie&nbsp;&amp;lt;ossec.junkie@gmail.com&amp;gt;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;Not&nbsp;using&nbsp;anomaly&nbsp;scoring&nbsp;at&nbsp;all,&nbsp;just&nbsp;wanted&nbsp;it&nbsp;to&nbsp;be&nbsp;like&nbsp;the&nbsp;old&nbsp;rule&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;set&nbsp;...is&nbsp;that&nbsp;possible?&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;May&nbsp;I&nbsp;ask&nbsp;why?&nbsp;&nbsp;What&nbsp;is&nbsp;it&nbsp;about&nbsp;the&nbsp;anomaly&nbsp;scoring&nbsp;approach&nbsp;that&nbsp;you&nbsp;do&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;not&nbsp;like?&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;On&nbsp;Fri,&nbsp;Sep&nbsp;11,&nbsp;2009&nbsp;at&nbsp;8:03&nbsp;AM,&nbsp;Ryan&nbsp;Barnett&nbsp;&amp;lt;rcbarnett@gmail.com&amp;gt;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;On&nbsp;Fri,&nbsp;Sep&nbsp;11,&nbsp;2009&nbsp;at&nbsp;10:53&nbsp;AM,&nbsp;OSSEC&nbsp;junkie&nbsp;&amp;lt;ossec.junkie@gmail.com&amp;gt;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;I&nbsp;am&nbsp;looking&nbsp;at&nbsp;the&nbsp;rules&nbsp;for&nbsp;the&nbsp;IE8&nbsp;XSS&nbsp;filter&nbsp;and&nbsp;was&nbsp;wondering&nbsp;if&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;we&nbsp;have&nbsp;to&nbsp;use&nbsp;the&nbsp;setvar&nbsp;configuration.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Can&nbsp;we&nbsp;change&nbsp;this:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;SecRule&nbsp;REQUEST_URI_RAW|REQUEST_BODY&nbsp;&quot;(?i:&amp;lt;APPLET[&nbsp;/+\t].*?code[&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;/+\t]*=)&quot;&nbsp;&quot;phase:2,t:none,t:lowercase,block,nolog,auditlog,msg:'IE&nbsp;XSS&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Filters&nbsp;-&nbsp;Attack&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Detected',setvar:'tx.msg=%{rule.msg}',setvar:tx.xss_score=+20,setvar:t&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;x.anomaly_score=+1,setvar:tx.%{&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;rule.id}-WEB_ATTACK/XSS-%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;to&nbsp;look&nbsp;like&nbsp;this?&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;SecRule&nbsp;REQUEST_URI_RAW|REQUEST_BODY&nbsp;&quot;(?i:&amp;lt;APPLET[&nbsp;/+\t].*?code[&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;/+\t]*=)&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;&quot;phase:2,capture,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowe&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;rcase,ctl:auditLogParts=+E,log,msg:'IE&nbsp;XSS&nbsp;Filters&nbsp;-&nbsp;Attack&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Detected',id:'950006',tag:'WEB_ATTACK/XSS',logdata:'%{TX.0}',severity:&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;'2'&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&nbsp;Will&nbsp;that&nbsp;work&nbsp;as&nbsp;I&nbsp;would&nbsp;hope&nbsp;or&nbsp;am&nbsp;I&nbsp;off&nbsp;completely&nbsp;here?&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;What&nbsp;are&nbsp;you&nbsp;&quot;hoping&quot;&nbsp;this&nbsp;will&nbsp;do?&nbsp;&nbsp;The&nbsp;purpose&nbsp;of&nbsp;using&nbsp;the&nbsp;setvar&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;actions&nbsp;is&nbsp;so&nbsp;that&nbsp;anomaly&nbsp;scoring&nbsp;can&nbsp;be&nbsp;used.&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;--&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&amp;gt;&nbsp;http://tacticalwebappsec.blogspot.com/&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&amp;gt;&nbsp;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;--&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;gt;&nbsp;http://tacticalwebappsec.blogspot.com/&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
