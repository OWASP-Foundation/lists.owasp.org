<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'DejaVu&nbsp;Sans';&nbsp;font-size:9pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;On&nbsp;Wednesday&nbsp;12&nbsp;August&nbsp;2009&nbsp;08:54:56&nbsp;pm&nbsp;OSSEC&nbsp;junkie&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;it&nbsp;appears&nbsp;this&nbsp;type&nbsp;of&nbsp;string&nbsp;is&nbsp;getting&nbsp;past&nbsp;ModSecurity,&nbsp;can&nbsp;you&nbsp;help&nbsp;me&lt;br&gt;<br>
&amp;gt;&nbsp;out&nbsp;here?&lt;br&gt;<br>
&amp;gt;&nbsp;%22;}eval%28%27al%27%2b%27ert%28docu%27%2b%27ment.c%27%2b%27ookie%29%27%29;&lt;br&gt;<br>
&amp;gt;function%20a%28%29{var%20a=%22&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;With&nbsp;this&nbsp;string&nbsp;put&nbsp;against&nbsp;one&nbsp;of&nbsp;our&nbsp;parameters,&nbsp;ModSecurity&nbsp;doesnt&nbsp;see&lt;br&gt;<br>
&amp;gt;&nbsp;it.&nbsp;&nbsp;Any&nbsp;advice?&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;I&nbsp;just&nbsp;tested&nbsp;with&nbsp;this&nbsp;request&nbsp;-&nbsp;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;http://www.example.com/&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;cgi-bin/printenv?foo=%22;}eval%28%27al%27%2b%27ert%28docu%27%2b%27ment.c%27%2b%27ookie%29%27%29;function%20a%28%29{var%20a=%22&lt;/span&gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;and&nbsp;this&nbsp;payload&nbsp;is&nbsp;identified&nbsp;by&nbsp;a&nbsp;few&nbsp;different&nbsp;signatures&nbsp;in&nbsp;the&nbsp;modsecurity_crs_41_xss_attacks.conf&nbsp;file.&nbsp;&nbsp;Here&nbsp;are&nbsp;some&nbsp;of&nbsp;the&nbsp;matches&nbsp;from&nbsp;the&nbsp;modsec_audit.log&nbsp;data&nbsp;-&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Message:&nbsp;Pattern&nbsp;match&nbsp;&quot;(?i:[&quot;\'][&nbsp;]*(([^a-z0-9~_:\'&quot;&nbsp;])|(in)).+?(([.].+?)|([\[].*?[\]].*?))=)&quot;&nbsp;at&nbsp;ARGS:foo.&nbsp;[file&nbsp;&quot;/usr/local/apache/conf/mod&lt;br&gt;<br>
security-core-rules/base_rules/modsecurity_crs_41_xss_attacks.conf&quot;]&nbsp;[line&nbsp;&quot;45&quot;]&nbsp;[msg&nbsp;&quot;IE&nbsp;XSS&nbsp;Filters&nbsp;-&nbsp;Attack&nbsp;Detected&quot;]&lt;br&gt;<br>
Message:&nbsp;Pattern&nbsp;match&nbsp;&quot;(?i:[&quot;\'][&nbsp;]*(([^a-z0-9~_:\'&quot;&nbsp;])|(in)).+?\(.*?\))&quot;&nbsp;at&nbsp;ARGS:foo.&nbsp;[file&nbsp;&quot;/usr/local/apache/conf/modsecurity-core-rules/b&lt;br&gt;<br>
ase_rules/modsecurity_crs_41_xss_attacks.conf&quot;]&nbsp;[line&nbsp;&quot;49&quot;]&nbsp;[msg&nbsp;&quot;IE&nbsp;XSS&nbsp;Filters&nbsp;-&nbsp;Attack&nbsp;Detected&quot;]&lt;br&gt;<br>
Message:&nbsp;Pattern&nbsp;match&nbsp;&quot;(fromcharcode|alert|eval)\s*\(&quot;&nbsp;at&nbsp;ARGS:foo.&nbsp;[file&nbsp;&quot;/usr/local/apache/conf/modsecurity-core-rules/base_rules/modsecuri&lt;br&gt;<br>
ty_crs_41_xss_attacks.conf&quot;]&nbsp;[line&nbsp;&quot;414&quot;]&nbsp;[msg&nbsp;&quot;XSS&nbsp;Attack&nbsp;Detected&quot;]&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;A&nbsp;few&nbsp;questions&nbsp;-&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;1)&nbsp;Are&nbsp;you&nbsp;using&nbsp;the&nbsp;latest&nbsp;CRS&nbsp;v2.0.1?&nbsp;&nbsp;We&nbsp;added&nbsp;these&nbsp;Internet&nbsp;Explorer&nbsp;(IE)&nbsp;XSS&nbsp;filters&nbsp;to&nbsp;the&nbsp;2.0.1&nbsp;version.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;2)&nbsp;What&nbsp;is&nbsp;the&nbsp;exact&nbsp;request&nbsp;data?&nbsp;&nbsp;Is&nbsp;this&nbsp;payload&nbsp;sent&nbsp;in&nbsp;a&nbsp;query_string&nbsp;or&nbsp;a&nbsp;post&nbsp;payload?&nbsp;&nbsp;An&nbsp;audit&nbsp;log&nbsp;example&nbsp;would&nbsp;help&nbsp;for&nbsp;testing.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;3)&nbsp;Where&nbsp;did&nbsp;this&nbsp;payload&nbsp;come&nbsp;from?&nbsp;&nbsp;Are&nbsp;you&nbsp;using&nbsp;a&nbsp;particular&nbsp;tool?&nbsp;&nbsp;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;--&nbsp;&lt;br&gt;<br>
Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;<br>
WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;<br>
http://tacticalwebappsec.blogspot.com&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
