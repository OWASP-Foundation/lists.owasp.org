<tt>
&lt;html&nbsp;dir=&quot;ltr&quot;&gt;&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;meta&nbsp;content=&quot;MSHTML&nbsp;6.00.6000.16945&quot;&nbsp;name=&quot;GENERATOR&quot;&gt;<br>
&lt;style&nbsp;title=&quot;owaParaStyle&quot;&gt;&lt;!--P&nbsp;{<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspMARGIN-TOP:&nbsp;0px;&nbsp;MARGIN-BOTTOM:&nbsp;0px<br>
}<br>
--&gt;&lt;/style&gt;<br>
&lt;meta&nbsp;content=&quot;VFPEUAGBSX&quot;&nbsp;name=&quot;SKYPE_FRAMEID&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;ocsi=&quot;x&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;Tahoma&quot;&nbsp;color=&quot;#000000&quot;&nbsp;size=&quot;2&quot;&gt;This&nbsp;doesn't&nbsp;work&nbsp;as&nbsp;SecRuleRemoveByMsg&nbsp;is&nbsp;a&nbsp;global&nbsp;directive&nbsp;and&nbsp;can't&nbsp;be&nbsp;chained&nbsp;with&nbsp;standard&nbsp;SecRules.&amp;nbsp;&nbsp;The&nbsp;easiest&nbsp;thing&nbsp;for&nbsp;you&nbsp;to&nbsp;do&nbsp;is&nbsp;to&nbsp;give&nbsp;this&nbsp;rule&nbsp;a&nbsp;rule&nbsp;ID&nbsp;of&nbsp;your&nbsp;own&nbsp;and&nbsp;then&nbsp;you&nbsp;can<br>
&nbsp;use&nbsp;the&nbsp;ctl&nbsp;action.&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;We&nbsp;will&nbsp;be&nbsp;revamping&nbsp;the&nbsp;CRS&nbsp;this&nbsp;week&nbsp;for&nbsp;v2.0.5&nbsp;and&nbsp;will&nbsp;correct&nbsp;these&nbsp;issues.&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;tahoma&quot;&nbsp;size=&quot;2&quot;&gt;-Ryan&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;font&nbsp;face=&quot;times&nbsp;new&nbsp;roman&quot;&gt;&lt;/font&gt;&amp;nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;id=&quot;divRpF498671&quot;&nbsp;style=&quot;DIRECTION:&nbsp;ltr&quot;&gt;<br>
&lt;hr&nbsp;tabindex=&quot;-1&quot;&gt;<br>
&lt;font&nbsp;face=&quot;Tahoma&quot;&nbsp;size=&quot;2&quot;&gt;&lt;b&gt;From:&lt;/b&gt;&nbsp;owasp-modsecurity-core-rule-set-bounces@lists.owasp.org&nbsp;[owasp-modsecurity-core-rule-set-bounces@lists.owasp.org]&nbsp;On&nbsp;Behalf&nbsp;Of&nbsp;Chris&nbsp;Datfung&nbsp;[chris.datfung@gmail.com]&lt;br&gt;<br>
&lt;b&gt;Sent:&lt;/b&gt;&nbsp;Sunday,&nbsp;January&nbsp;17,&nbsp;2010&nbsp;10:43&nbsp;AM&lt;br&gt;<br>
&lt;b&gt;To:&lt;/b&gt;&nbsp;Ivan&nbsp;Ristic&lt;br&gt;<br>
&lt;b&gt;Cc:&lt;/b&gt;&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;br&gt;<br>
&lt;b&gt;Subject:&lt;/b&gt;&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;rule&nbsp;bypass&lt;br&gt;<br>
&lt;/font&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;rgb(204,204,204)&nbsp;1px&nbsp;solid&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Hi&nbsp;Ivan,&lt;br&gt;<br>
&amp;gt;&nbsp;I'll&nbsp;try&nbsp;the&nbsp;SecRuleRemoveByMsg.&nbsp;As&nbsp;an&nbsp;aside,&nbsp;is&nbsp;there&nbsp;a&nbsp;reason&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;ruleRemoveById&nbsp;is&nbsp;a&nbsp;ctl&nbsp;option&nbsp;but&nbsp;ruleRemoveByMsg&nbsp;is&nbsp;not?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
Yes,&nbsp;there&nbsp;is.&nbsp;SecRuleRemoveBy(Id|Msg)&nbsp;operate&nbsp;at&nbsp;configure-time&nbsp;and&lt;br&gt;<br>
affect&nbsp;the&nbsp;configuration&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;starting&nbsp;point&nbsp;for&nbsp;all&lt;br&gt;<br>
requests.&nbsp;The&nbsp;ctl:ruleRemoveById&nbsp;action&nbsp;is&nbsp;executed&nbsp;on&nbsp;per-transaction&lt;br&gt;<br>
basis&nbsp;and&nbsp;can&nbsp;only&nbsp;affect&nbsp;the&nbsp;transaction&nbsp;in&nbsp;which&nbsp;it&nbsp;executes.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
Hi&nbsp;Ivan,&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;still&nbsp;don't&nbsp;understand&nbsp;why&nbsp;you&nbsp;can't&nbsp;have&nbsp;a&nbsp;ctl:ruleRemoveByMsg&nbsp;action&nbsp;that&nbsp;is&nbsp;executed&nbsp;on&nbsp;a&nbsp;per-transaction&nbsp;basis.&lt;br&gt;<br>
&amp;nbsp;&lt;/div&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;rgb(204,204,204)&nbsp;1px&nbsp;solid&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&amp;gt;&nbsp;Ideally,&nbsp;in&nbsp;this&lt;br&gt;<br>
&amp;gt;&nbsp;case,&nbsp;I'd&nbsp;like&nbsp;to&nbsp;create&nbsp;a&nbsp;single&nbsp;rule&nbsp;that&nbsp;first&nbsp;matches&nbsp;the&nbsp;effected&lt;br&gt;<br>
&amp;gt;&nbsp;parameter&nbsp;and&nbsp;then&nbsp;removes&nbsp;the&nbsp;rule&nbsp;based&nbsp;on&nbsp;the&nbsp;message.&nbsp;I&nbsp;guess&nbsp;I&nbsp;could&lt;br&gt;<br>
&amp;gt;&nbsp;still&nbsp;do&nbsp;that&nbsp;by&nbsp;chaining&nbsp;two&nbsp;rules&nbsp;together.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
Yes,&nbsp;that&nbsp;sounds&nbsp;likely.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
I've&nbsp;been&nbsp;playing&nbsp;around&nbsp;with&nbsp;this&nbsp;and&nbsp;have&nbsp;hit&nbsp;a&nbsp;dead&nbsp;end.&nbsp;I&nbsp;created&nbsp;the&nbsp;following&nbsp;rule:&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_URI&nbsp;&amp;quot;script.cfm&amp;quot;&nbsp;phase:1,t:none,t:urlDecode,t:lowercase,t:normalisePath,chain&lt;br&gt;<br>
SecRule&nbsp;&amp;amp;FILES:Filename&nbsp;&amp;quot;@gt&nbsp;0&amp;quot;&nbsp;chain&lt;br&gt;<br>
SecRuleRemoveByMsg&nbsp;&amp;quot;Attempted&nbsp;multipart\/form-data&nbsp;bypass&amp;quot;&lt;br&gt;<br>
&lt;br&gt;<br>
but&nbsp;whenever&nbsp;that&nbsp;rule&nbsp;is&nbsp;uncommented&nbsp;I&nbsp;get&nbsp;the&nbsp;following&nbsp;error:&lt;br&gt;<br>
&lt;br&gt;<br>
Syntax&nbsp;error&nbsp;on&nbsp;line&nbsp;21&nbsp;of&nbsp;/opt/modsecurity/etc/crs/base_rules/modsecurity_crs_20_protocol_violations.conf:&lt;br&gt;<br>
ModSecurity:&nbsp;Execution&nbsp;phases&nbsp;can&nbsp;only&nbsp;be&nbsp;specified&nbsp;by&nbsp;chain&nbsp;starter&nbsp;rules.&lt;br&gt;<br>
&lt;br&gt;<br>
By&nbsp;commented&nbsp;the&nbsp;rule&nbsp;I&nbsp;added&nbsp;the&nbsp;error&nbsp;goes&nbsp;away.&lt;br&gt;<br>
&amp;nbsp;&lt;/div&gt;<br>
Thanks,&lt;br&gt;<br>
&amp;nbsp;&nbsp;Chris&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
