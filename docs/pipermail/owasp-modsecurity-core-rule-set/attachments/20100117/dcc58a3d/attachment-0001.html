<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Hi&nbsp;Ivan,&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;ll&nbsp;try&nbsp;the&nbsp;SecRuleRemoveByMsg.&nbsp;As&nbsp;an&nbsp;aside,&nbsp;is&nbsp;there&nbsp;a&nbsp;reason&nbsp;that&lt;br&gt;<br>
&amp;gt;&nbsp;ruleRemoveById&nbsp;is&nbsp;a&nbsp;ctl&nbsp;option&nbsp;but&nbsp;ruleRemoveByMsg&nbsp;is&nbsp;not?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Yes,&nbsp;there&nbsp;is.&nbsp;SecRuleRemoveBy(Id|Msg)&nbsp;operate&nbsp;at&nbsp;configure-time&nbsp;and&lt;br&gt;<br>
affect&nbsp;the&nbsp;configuration&nbsp;that&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;a&nbsp;starting&nbsp;point&nbsp;for&nbsp;all&lt;br&gt;<br>
requests.&nbsp;The&nbsp;ctl:ruleRemoveById&nbsp;action&nbsp;is&nbsp;executed&nbsp;on&nbsp;per-transaction&lt;br&gt;<br>
basis&nbsp;and&nbsp;can&nbsp;only&nbsp;affect&nbsp;the&nbsp;transaction&nbsp;in&nbsp;which&nbsp;it&nbsp;executes.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Hi&nbsp;Ivan,&lt;br&gt;&lt;br&gt;I&nbsp;still&nbsp;don&amp;#39;t&nbsp;understand&nbsp;why&nbsp;you&nbsp;can&amp;#39;t&nbsp;have&nbsp;a&nbsp;ctl:ruleRemoveByMsg&nbsp;action&nbsp;that&nbsp;is&nbsp;executed&nbsp;on&nbsp;a&nbsp;per-transaction&nbsp;basis.&lt;br&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&amp;gt;&nbsp;Ideally,&nbsp;in&nbsp;this&lt;br&gt;<br>
&amp;gt;&nbsp;case,&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;create&nbsp;a&nbsp;single&nbsp;rule&nbsp;that&nbsp;first&nbsp;matches&nbsp;the&nbsp;effected&lt;br&gt;<br>
&amp;gt;&nbsp;parameter&nbsp;and&nbsp;then&nbsp;removes&nbsp;the&nbsp;rule&nbsp;based&nbsp;on&nbsp;the&nbsp;message.&nbsp;I&nbsp;guess&nbsp;I&nbsp;could&lt;br&gt;<br>
&amp;gt;&nbsp;still&nbsp;do&nbsp;that&nbsp;by&nbsp;chaining&nbsp;two&nbsp;rules&nbsp;together.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Yes,&nbsp;that&nbsp;sounds&nbsp;likely.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&amp;#39;ve&nbsp;been&nbsp;playing&nbsp;around&nbsp;with&nbsp;this&nbsp;and&nbsp;have&nbsp;hit&nbsp;a&nbsp;dead&nbsp;end.&nbsp;I&nbsp;created&nbsp;the&nbsp;following&nbsp;rule:&lt;br&gt;&lt;br&gt;SecRule&nbsp;REQUEST_URI&nbsp;&amp;quot;script.cfm&amp;quot;&nbsp;phase:1,t:none,t:urlDecode,t:lowercase,t:normalisePath,chain&lt;br&gt;<br>
SecRule&nbsp;&amp;amp;FILES:Filename&nbsp;&amp;quot;@gt&nbsp;0&amp;quot;&nbsp;chain&lt;br&gt;SecRuleRemoveByMsg&nbsp;&amp;quot;Attempted&nbsp;multipart\/form-data&nbsp;bypass&amp;quot;&lt;br&gt;&lt;br&gt;but&nbsp;whenever&nbsp;that&nbsp;rule&nbsp;is&nbsp;uncommented&nbsp;I&nbsp;get&nbsp;the&nbsp;following&nbsp;error:&lt;br&gt;&lt;br&gt;Syntax&nbsp;error&nbsp;on&nbsp;line&nbsp;21&nbsp;of&nbsp;/opt/modsecurity/etc/crs/base_rules/modsecurity_crs_20_protocol_violations.conf:&lt;br&gt;<br>
ModSecurity:&nbsp;Execution&nbsp;phases&nbsp;can&nbsp;only&nbsp;be&nbsp;specified&nbsp;by&nbsp;chain&nbsp;starter&nbsp;rules.&lt;br&gt;&lt;br&gt;By&nbsp;commented&nbsp;the&nbsp;rule&nbsp;I&nbsp;added&nbsp;the&nbsp;error&nbsp;goes&nbsp;away.&lt;br&gt; &lt;/div&gt;Thanks,&lt;br&gt; &nbsp;Chris&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
