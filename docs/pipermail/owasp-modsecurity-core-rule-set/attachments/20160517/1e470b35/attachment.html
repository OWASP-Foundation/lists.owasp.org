<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;&lt;/head&gt;&lt;body&nbsp;dir=&quot;auto&quot;&gt;&lt;div&gt;I&nbsp;would&nbsp;say&nbsp;first&nbsp;thing&nbsp;is&nbsp;to&nbsp;turn&nbsp;blocking&nbsp;off&nbsp;and&nbsp;run&nbsp;in&nbsp;DetectionOnly&nbsp;mode&nbsp;to&nbsp;help&nbsp;you&nbsp;fine&nbsp;tune&nbsp;your&nbsp;rules.&nbsp;To&nbsp;do&nbsp;that&nbsp;update&nbsp;your&nbsp;SecRuleEngine&nbsp;config&nbsp;like&nbsp;so:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;margin-top:&nbsp;0px;&nbsp;padding:&nbsp;5px;&nbsp;border:&nbsp;0px;&nbsp;width:&nbsp;auto;&nbsp;max-height:&nbsp;600px;&nbsp;overflow:&nbsp;auto;&nbsp;word-wrap:&nbsp;normal;&quot;&gt;&lt;code&nbsp;style=&quot;margin:&nbsp;0px;&nbsp;padding:&nbsp;0px;&nbsp;border:&nbsp;0px;&nbsp;white-space:&nbsp;normal;&nbsp;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;font&nbsp;face=&quot;UICTFontTextStyleBody&quot;&gt;SecRuleEngine&nbsp;DetectionOnly&lt;/font&gt;&lt;/code&gt;&lt;/pre&gt;This&nbsp;will&nbsp;of&nbsp;course&nbsp;mean&nbsp;you&nbsp;are&nbsp;not&nbsp;protected&nbsp;but&nbsp;us&nbsp;a&nbsp;necessary&nbsp;step&nbsp;to&nbsp;getting&nbsp;your&nbsp;set&nbsp;up&nbsp;right.&nbsp;Now&nbsp;leave&nbsp;it&nbsp;run&nbsp;for&nbsp;a&nbsp;while&nbsp;and&nbsp;then&nbsp;check&nbsp;the&nbsp;logs&nbsp;for&nbsp;every&nbsp;rule&nbsp;that&nbsp;fired&nbsp;(but&nbsp;did&nbsp;not&nbsp;block&nbsp;this&nbsp;time)&nbsp;and&nbsp;categories&nbsp;them&nbsp;into:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;1)&nbsp;False&nbsp;positive&nbsp;-&nbsp;this&nbsp;request&nbsp;looks&nbsp;to&nbsp;be&nbsp;the&nbsp;sort&nbsp;of&nbsp;request&nbsp;our&nbsp;application&nbsp;expects&nbsp;and&nbsp;ModSecurity&nbsp;should&nbsp;not&nbsp;be&nbsp;alerting&nbsp;on&nbsp;it.&lt;/div&gt;&lt;div&gt;2)&nbsp;Bad&nbsp;request&nbsp;-&nbsp;this&nbsp;request&nbsp;shouldn't&nbsp;be&nbsp;made&nbsp;and&nbsp;ModSecurity&nbsp;was&nbsp;right&nbsp;to&nbsp;block&nbsp;it.&nbsp;This&nbsp;will&nbsp;include&nbsp;bots&nbsp;and&nbsp;scripts&nbsp;that&nbsp;scan&nbsp;websites&nbsp;even&nbsp;if&nbsp;they&nbsp;don't&nbsp;cause&nbsp;any&nbsp;trouble.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;all&nbsp;the&nbsp;1s&nbsp;(and&nbsp;there&nbsp;will&nbsp;be&nbsp;a&nbsp;lot&nbsp;at&nbsp;the&nbsp;beginning)&nbsp;you&nbsp;need&nbsp;to&nbsp;decide&nbsp;how&nbsp;to&nbsp;tweak&nbsp;the&nbsp;rules&nbsp;to&nbsp;not&nbsp;alert&nbsp;for&nbsp;False&nbsp;positives.&nbsp;This&nbsp;involves&nbsp;either&nbsp;turning&nbsp;the&nbsp;rule&nbsp;off&nbsp;completely&nbsp;(using&nbsp;the&nbsp;likes&nbsp;of&nbsp;SecRuleRemoveById),&nbsp;turning&nbsp;it&nbsp;off&nbsp;for&nbsp;particular&nbsp;parameters&nbsp;(using&nbsp;the&nbsp;likes&nbsp;of&nbsp;SecRuleUpdateActionById)&nbsp;or&nbsp;turning&nbsp;it&nbsp;off&nbsp;for&nbsp;particular&nbsp;URLs&nbsp;(this&nbsp;is&nbsp;more&nbsp;complicated&nbsp;aged&nbsp;and&nbsp;can&nbsp;require&nbsp;building&nbsp;a&nbsp;new&nbsp;rule&nbsp;to&nbsp;do&nbsp;this).&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Tuning&nbsp;rules&nbsp;is&nbsp;necessary&nbsp;and,&nbsp;as&nbsp;long&nbsp;as&nbsp;you&nbsp;have&nbsp;a&nbsp;good&nbsp;understanding&nbsp;of&nbsp;what&nbsp;the&nbsp;rules&nbsp;intention&nbsp;is,&nbsp;why&nbsp;it&nbsp;blocked,&nbsp;why&nbsp;that&nbsp;was&nbsp;incorrect&nbsp;thing&nbsp;for&nbsp;it&nbsp;to&nbsp;do&nbsp;then&nbsp;you&nbsp;should&nbsp;tweak&nbsp;and&nbsp;turn&nbsp;them&nbsp;off&nbsp;for&nbsp;certain&nbsp;scenarios.&nbsp;Does&nbsp;that&nbsp;reduce&nbsp;the&nbsp;effectiveness&nbsp;of&nbsp;ModSecurity?&nbsp;Potentially&nbsp;but&nbsp;then&nbsp;if&nbsp;it&nbsp;blocks&nbsp;all&nbsp;sorts&nbsp;of&nbsp;real&nbsp;visitors&nbsp;incorrectly&nbsp;then&nbsp;that's&nbsp;not&nbsp;much&nbsp;use&nbsp;is&nbsp;it!&nbsp;The&nbsp;OWASP&nbsp;CRS&nbsp;is&nbsp;very&nbsp;generic&nbsp;and&nbsp;all&nbsp;the&nbsp;rules&nbsp;will&nbsp;not&nbsp;be&nbsp;appropriate&nbsp;for&nbsp;all&nbsp;websites.&nbsp;By&nbsp;default&nbsp;it&nbsp;blocks&nbsp;too&nbsp;much.&nbsp;There&nbsp;is&nbsp;some&nbsp;work&nbsp;going&nbsp;on&nbsp;to&nbsp;make&nbsp;the&nbsp;default&nbsp;more&nbsp;lenient&nbsp;so&nbsp;you&nbsp;can&nbsp;start&nbsp;off&nbsp;with&nbsp;some&nbsp;protection&nbsp;and&nbsp;ramp&nbsp;up&nbsp;as&nbsp;you&nbsp;see&nbsp;fit&nbsp;rather&nbsp;than&nbsp;current&nbsp;situation&nbsp;where&nbsp;you&nbsp;start&nbsp;with&nbsp;too&nbsp;much&nbsp;protection&nbsp;and&nbsp;have&nbsp;to&nbsp;ramp&nbsp;down.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anyway&nbsp;after&nbsp;you&nbsp;see&nbsp;no&nbsp;more&nbsp;false&nbsp;positives&nbsp;for&nbsp;a&nbsp;while&nbsp;you&nbsp;can&nbsp;turn&nbsp;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;SecRuleEngine&nbsp;back&nbsp;to&nbsp;on.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;can&nbsp;take&nbsp;some&nbsp;time.&nbsp;See&nbsp;my&nbsp;story&nbsp;here&nbsp;to&nbsp;prepare&nbsp;you:&nbsp;&lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/35149264/how-long-do-you-fine-tune-false-positives-with-mod-security-and-owasp-rules/35162976#35162976&quot;&gt;http://stackoverflow.com/questions/35149264/how-long-do-you-fine-tune-false-positives-with-mod-security-and-owasp-rules/35162976#35162976&lt;/a&gt;.&nbsp;A&nbsp;WAF&nbsp;like&nbsp;ModSecurity&nbsp;is,&nbsp;unfortunately,&nbsp;not&nbsp;just&nbsp;a&nbsp;turn&nbsp;it&nbsp;on&nbsp;and&nbsp;it&nbsp;works&nbsp;and&nbsp;you&nbsp;can&nbsp;forget&nbsp;about&nbsp;it&nbsp;solution.&nbsp;It&nbsp;takes&nbsp;a&nbsp;lot&nbsp;of&nbsp;set&nbsp;up&nbsp;to&nbsp;be&nbsp;useful,&nbsp;and&nbsp;then&nbsp;a&nbsp;bit&nbsp;if&nbsp;minding&nbsp;afterwards.&nbsp;Personally&nbsp;I&nbsp;think&nbsp;it's&nbsp;worth&nbsp;it&nbsp;but&nbsp;you&nbsp;also&nbsp;see&nbsp;people&nbsp;online&nbsp;saying&nbsp;WAFs&nbsp;are&nbsp;too&nbsp;much&nbsp;effort&nbsp;for&nbsp;this&nbsp;reason.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Anomaly&nbsp;scoring&nbsp;mode&nbsp;is&nbsp;an&nbsp;interesting&nbsp;one.&nbsp;It&nbsp;basically&nbsp;let's&nbsp;all&nbsp;the&nbsp;rules&nbsp;run&nbsp;and&nbsp;then&nbsp;only&nbsp;blocks&nbsp;if&nbsp;a&nbsp;certain&nbsp;threshold&nbsp;applies.&nbsp;This&nbsp;means&nbsp;a&nbsp;number&nbsp;of&nbsp;unimportant&nbsp;rules&nbsp;can&nbsp;fire.&nbsp;e.g.&nbsp;most&nbsp;browsers&nbsp;send&nbsp;a&nbsp;user&nbsp;agent&nbsp;so&nbsp;no&nbsp;user&nbsp;agent,&nbsp;while&nbsp;it&nbsp;likely&nbsp;won't&nbsp;cause&nbsp;a&nbsp;problem&nbsp;is&nbsp;a&nbsp;flag&nbsp;that&nbsp;this&nbsp;is&nbsp;probably&nbsp;a&nbsp;bad&nbsp;request.&nbsp;If&nbsp;a&nbsp;few&nbsp;of&nbsp;these&nbsp;flags&nbsp;fire&nbsp;on&nbsp;same&nbsp;request&nbsp;then&nbsp;this&nbsp;is&nbsp;highly&nbsp;likely&nbsp;to&nbsp;be&nbsp;a&nbsp;bad&nbsp;request&nbsp;and&nbsp;should&nbsp;be&nbsp;blocked.&nbsp;Some&nbsp;rules&nbsp;(like&nbsp;missing&nbsp;user&nbsp;agent)&nbsp;might&nbsp;have&nbsp;low&nbsp;threshold&nbsp;and&nbsp;so&nbsp;won't&nbsp;block&nbsp;on&nbsp;their&nbsp;own&nbsp;and&nbsp;some&nbsp;will&nbsp;block&nbsp;with&nbsp;just&nbsp;one&nbsp;rule&nbsp;firing&nbsp;if&nbsp;it's&nbsp;obvious&nbsp;this&nbsp;request&nbsp;should&nbsp;not&nbsp;processed.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;While&nbsp;a&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;nomaly&nbsp;scoring&nbsp;is&nbsp;undoubtedly&nbsp;helpful&nbsp;to&nbsp;reduce&nbsp;the&nbsp;number&nbsp;of&nbsp;incorrect&nbsp;blocks,&nbsp;and&nbsp;lots&nbsp;of&nbsp;people&nbsp;use&nbsp;it&nbsp;and&nbsp;recommend&nbsp;it,&nbsp;I'm&nbsp;not&nbsp;a&nbsp;particular&nbsp;fan.&nbsp;I&nbsp;find&nbsp;it&nbsp;makes&nbsp;the&nbsp;log&nbsp;files&nbsp;noisy&nbsp;and&nbsp;confusing&nbsp;to&nbsp;see&nbsp;rules&nbsp;firing&nbsp;and&nbsp;not&nbsp;know&nbsp;if&nbsp;they&nbsp;caused&nbsp;a&nbsp;block&nbsp;or&nbsp;not.&nbsp;I&nbsp;prefer&nbsp;to&nbsp;turn&nbsp;off&nbsp;the&nbsp;low&nbsp;value&nbsp;rules&nbsp;completely&nbsp;and&nbsp;using&nbsp;the&nbsp;original&nbsp;block&nbsp;at&nbsp;first&nbsp;bad&nbsp;attempt&nbsp;mode&nbsp;despite&nbsp;the&nbsp;fact&nbsp;this&nbsp;takes&nbsp;extra&nbsp;work&nbsp;to&nbsp;set&nbsp;up&nbsp;initially&nbsp;and&nbsp;can&nbsp;allow&nbsp;more&nbsp;spam&nbsp;and&nbsp;bad&nbsp;bots&nbsp;through.&nbsp;But&nbsp;each&nbsp;to&nbsp;their&nbsp;own.&nbsp;Will&nbsp;leave&nbsp;Christian&nbsp;to&nbsp;explain&nbsp;how&nbsp;best&nbsp;to&nbsp;set&nbsp;it&nbsp;up&nbsp;if&nbsp;that's&nbsp;the&nbsp;way&nbsp;you&nbsp;want&nbsp;to&nbsp;go.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;Here's&nbsp;some&nbsp;other&nbsp;posts&nbsp;that&nbsp;might&nbsp;help:&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/33676348/extra-sensitive-mod-security-rules-giving-403-forbidden-error&quot;&gt;http://stackoverflow.com/questions/33676348/extra-sensitive-mod-security-rules-giving-403-forbidden-error&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/34478019/keep-modsecurity-enabled-with-symfony-installation-w-cpanel-whm/34484463#34484463&quot;&gt;http://stackoverflow.com/questions/34478019/keep-modsecurity-enabled-with-symfony-installation-w-cpanel-whm/34484463#34484463&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://stackoverflow.com/questions/33989273/modsecurity-excessive-false-positives/34027786#34027786&quot;&gt;http://stackoverflow.com/questions/33989273/modsecurity-excessive-false-positives/34027786#34027786&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;Note&nbsp;this&nbsp;mailing&nbsp;list&nbsp;is&nbsp;awesome&nbsp;and&nbsp;you&nbsp;will&nbsp;get&nbsp;help&nbsp;here&nbsp;but&nbsp;I&nbsp;have&nbsp;also&nbsp;been&nbsp;answering&nbsp;ModSecurity&nbsp;questions&nbsp;on&nbsp;StackOverflow/ServerFault&nbsp;as&nbsp;feel&nbsp;they&nbsp;are&nbsp;better&nbsp;to&nbsp;reference&nbsp;again&nbsp;for&nbsp;common&nbsp;questions&nbsp;like&nbsp;yours.&nbsp;Been&nbsp;meaning&nbsp;to&nbsp;write&nbsp;a&nbsp;friendly,&nbsp;short,&nbsp;beginners&nbsp;containing&nbsp;a&nbsp;lot&nbsp;of&nbsp;the&nbsp;detail&nbsp;here&nbsp;but&nbsp;have&nbsp;a&nbsp;problem&nbsp;keeping&nbsp;my&nbsp;posts&nbsp;short&nbsp;:-)&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;Hope&nbsp;that&nbsp;helps&nbsp;and&nbsp;feel&nbsp;free&nbsp;to&nbsp;ask&nbsp;any&nbsp;questions&nbsp;here.&nbsp;We're&nbsp;a&nbsp;friendly&nbsp;bunch.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;div&gt;Thanks,&lt;/div&gt;&lt;div&gt;Barry&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
