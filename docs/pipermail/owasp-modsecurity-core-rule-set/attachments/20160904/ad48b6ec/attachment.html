<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;dir=&quot;auto&quot;&gt;<br>
&lt;div&gt;Been&nbsp;thinking&nbsp;about&nbsp;this&nbsp;and&nbsp;you've&nbsp;got&nbsp;me&nbsp;intrigued&nbsp;as&nbsp;to&nbsp;whether&nbsp;this&nbsp;was&nbsp;an&nbsp;intentional&nbsp;decision&nbsp;or&nbsp;not...&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;As&nbsp;far&nbsp;as&nbsp;I&nbsp;can&nbsp;see,&nbsp;you&nbsp;are&nbsp;right&nbsp;these&nbsp;could&nbsp;have&nbsp;been&nbsp;written&nbsp;using&nbsp;REQUEST_FILENAME&nbsp;and&nbsp;ARGS&nbsp;rather&nbsp;than&nbsp;REQUEST_URI&nbsp;and&nbsp;REQUEST_BODY.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;ModSecurity&nbsp;is&nbsp;quite&nbsp;flexible&nbsp;and&nbsp;there&nbsp;are&nbsp;a&nbsp;few&nbsp;different&nbsp;ways&nbsp;of&nbsp;doing&nbsp;things.&nbsp;So&nbsp;it&nbsp;can&nbsp;depend&nbsp;on&nbsp;whoever&nbsp;writes&nbsp;the&nbsp;rules&nbsp;as&nbsp;to&nbsp;which&nbsp;version&nbsp;they&nbsp;use.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;This&nbsp;is&nbsp;just&nbsp;a&nbsp;guess,&nbsp;but&nbsp;I&nbsp;wonder&nbsp;if&nbsp;the&nbsp;reason&nbsp;these&nbsp;variables&nbsp;were&nbsp;chosen&nbsp;is&nbsp;hinted&nbsp;at&nbsp;in&nbsp;this&nbsp;line&nbsp;in&nbsp;the&nbsp;manual&nbsp;ModSecurity&nbsp;manual&nbsp;(&lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#REQUEST_BODY&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#REQUEST_BODY&lt;/a&gt;):&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&nbsp;font-style:&nbsp;italic;&nbsp;font-weight:&nbsp;bold;&quot;&gt;There&nbsp;are&nbsp;no&nbsp;default&nbsp;transformation&nbsp;functions,&nbsp;as&nbsp;there&nbsp;were&nbsp;in&nbsp;the&nbsp;first&nbsp;generation&nbsp;of&nbsp;ModSecurity&nbsp;(1.x).&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;and&nbsp;also&nbsp;lines&nbsp;like&nbsp;this:&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;dl&nbsp;style=&quot;box-sizing:&nbsp;border-box;&nbsp;margin-top:&nbsp;0px;&nbsp;margin-bottom:&nbsp;16px;&nbsp;padding:&nbsp;0px;&quot;&gt;<br>
&lt;dt&nbsp;style=&quot;box-sizing:&nbsp;border-box;&nbsp;padding:&nbsp;0px;&nbsp;margin-top:&nbsp;16px;&nbsp;font-style:&nbsp;italic;&nbsp;font-weight:&nbsp;bold;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;Note&nbsp;:&nbsp;Please&nbsp;note&nbsp;that&nbsp;anti-evasion&nbsp;transformations&nbsp;are&nbsp;not&nbsp;used&nbsp;on&nbsp;REQUEST_URI,&nbsp;which&nbsp;means&nbsp;that&nbsp;you&nbsp;will&nbsp;have&nbsp;to&nbsp;specify&nbsp;them&nbsp;in&nbsp;the&nbsp;rules&nbsp;that&nbsp;use&nbsp;this&nbsp;variable.&lt;/span&gt;&lt;/dt&gt;&lt;/dl&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;I'm&nbsp;not&nbsp;sure&nbsp;what&nbsp;the&nbsp;default&nbsp;transformations&nbsp;were&nbsp;in&nbsp;ModSecurity&nbsp;1.x,&nbsp;or&nbsp;if&nbsp;these&nbsp;were&nbsp;the&nbsp;anti-evasion&nbsp;transformations&nbsp;being&nbsp;discussed&nbsp;but&nbsp;wonder&nbsp;that&nbsp;was&nbsp;the&nbsp;reason&nbsp;-&nbsp;as&nbsp;it&nbsp;would&nbsp;prevent&nbsp;these<br>
&nbsp;rules&nbsp;from&nbsp;working&nbsp;if&nbsp;the&nbsp;ARGS&nbsp;were&nbsp;used&nbsp;and&nbsp;default&nbsp;transformations&nbsp;were&nbsp;applied?&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;If&nbsp;you&nbsp;need&nbsp;the&nbsp;ability&nbsp;to&nbsp;override&nbsp;these&nbsp;on&nbsp;certain&nbsp;ARGS&nbsp;(though&nbsp;I&nbsp;think&nbsp;that&nbsp;could&nbsp;be&nbsp;dangerous&nbsp;-&nbsp;and&nbsp;have&nbsp;personally&nbsp;never&nbsp;seen&nbsp;any&nbsp;false&nbsp;positives&nbsp;with&nbsp;these)&nbsp;you&nbsp;could&nbsp;replace&nbsp;them&nbsp;as&nbsp;you&nbsp;see<br>
&nbsp;fit&nbsp;-&nbsp;either&nbsp;directly&nbsp;in&nbsp;the&nbsp;file&nbsp;(not&nbsp;recommended&nbsp;as&nbsp;will&nbsp;be&nbsp;overwritten&nbsp;if&nbsp;you&nbsp;ever&nbsp;upgrade&nbsp;the&nbsp;CRS)&nbsp;or&nbsp;by&nbsp;altering&nbsp;the&nbsp;rules&nbsp;dynamically:&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;#Replace&nbsp;REQUEST_URI&nbsp;with&nbsp;REQUEST_FILENAME&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;SecRuleUpdateTargetById&nbsp;930100&nbsp;REQUEST_URI&nbsp;REQUEST_FILENAME&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;#Also&nbsp;add&nbsp;in&nbsp;ARGS&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;SecRuleUpdateTargetById&nbsp;930100&nbsp;ARGS&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;Or&nbsp;use&nbsp;ctl:ruleRemoveById&nbsp;version&nbsp;to&nbsp;only&nbsp;do&nbsp;this&nbsp;for&nbsp;certain&nbsp;URLs.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;background-color:&nbsp;rgba(255,&nbsp;255,&nbsp;255,&nbsp;0);&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;Thanks,&lt;/div&gt;<br>
&lt;div&gt;Barry&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
On&nbsp;4&nbsp;Sep&nbsp;2016,&nbsp;at&nbsp;18:25,&nbsp;Christian&nbsp;Folini&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&gt;christian.folini@netnea.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&lt;div&gt;&lt;span&gt;On&nbsp;Sun,&nbsp;Sep&nbsp;04,&nbsp;2016&nbsp;at&nbsp;08:08:53AM&nbsp;-0700,&nbsp;Ken&nbsp;Brucker&nbsp;wrote:&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;[&nbsp;Not&nbsp;sure&nbsp;my&nbsp;first&nbsp;try&nbsp;posting&nbsp;made&nbsp;it&nbsp;through,&nbsp;I&nbsp;see&nbsp;it&nbsp;in&nbsp;the&nbsp;archive,&nbsp;but&nbsp;have&nbsp;had&nbsp;no&nbsp;response&nbsp;which&nbsp;I&nbsp;find&nbsp;odd.&nbsp;]&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;I&nbsp;do&nbsp;not&nbsp;think&nbsp;the&nbsp;first&nbsp;inquiry&nbsp;made&nbsp;it&nbsp;through.&nbsp;But&nbsp;this&nbsp;time&nbsp;it&nbsp;did.&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;Thanks&nbsp;for&nbsp;the&nbsp;report.&nbsp;We'll&nbsp;investigate.&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;Cheers,&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;Christian&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;I&nbsp;have&nbsp;V3&nbsp;rules&nbsp;running&nbsp;in&nbsp;a&nbsp;test&nbsp;environment&nbsp;playing&nbsp;with&nbsp;how&nbsp;it&nbsp;interacts&nbsp;with&nbsp;WordPress.&nbsp;My&nbsp;early&nbsp;investigation&nbsp;is&nbsp;showing&nbsp;a&nbsp;few&nbsp;rules&nbsp;that&nbsp;need&nbsp;to&nbsp;be&nbsp;addressed&nbsp;to&nbsp;allow&nbsp;code,&nbsp;sql&nbsp;examples&nbsp;etc.&nbsp;to&nbsp;be&nbsp;included&nbsp;in&nbsp;a&nbsp;post,&nbsp;nothing<br>
&nbsp;overly&nbsp;surprising.&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;I&nbsp;have&nbsp;a&nbsp;question&nbsp;about&nbsp;the&nbsp;construction&nbsp;of&nbsp;rules&nbsp;930100&nbsp;and&nbsp;930110.&nbsp;These&nbsp;rules&nbsp;both&nbsp;examine&nbsp;REQUEST_BODY&nbsp;and&nbsp;REQUEST_HEADERS.&nbsp;Other&nbsp;rules,&nbsp;such&nbsp;as&nbsp;930120&nbsp;use&nbsp;ARGS&nbsp;and&nbsp;ARGS_NAMES,&nbsp;etc.&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;The&nbsp;result&nbsp;is&nbsp;it's&nbsp;not&nbsp;possible&nbsp;to&nbsp;disable&nbsp;930100&nbsp;and&nbsp;930110&nbsp;for&nbsp;specific&nbsp;ARGS&nbsp;where&nbsp;the&nbsp;patterns&nbsp;would&nbsp;be&nbsp;acceptable.&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;What&nbsp;is&nbsp;the&nbsp;motivation&nbsp;for&nbsp;the&nbsp;difference&nbsp;in&nbsp;how&nbsp;these&nbsp;rules&nbsp;are&nbsp;defined?&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;--&nbsp;Ken&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;_______________________________________________&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;--&nbsp;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;a&nbsp;href=&quot;https://www.feistyduck.com/training/modsecurity-training-course&quot;&gt;https://www.feistyduck.com/training/modsecurity-training-course&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&gt;mailto:christian.folini@netnea.com&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;twitter:&nbsp;@ChrFolini&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;_______________________________________________&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;span&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
