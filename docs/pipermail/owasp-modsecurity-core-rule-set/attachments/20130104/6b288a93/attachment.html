<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:break-word;&nbsp;color:rgb(0,0,0);&nbsp;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;&nbsp;font-size:14px&quot;&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;<br>
&lt;div&gt;Matt,&lt;/div&gt;<br>
&lt;div&gt;Comments&nbsp;inline&nbsp;below.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabs&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;ModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Consolas,Courier&nbsp;New,Courier&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:13px&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&nbsp;style=&quot;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;border-bottom:medium&nbsp;none;&nbsp;border-left:medium&nbsp;none;&nbsp;padding-bottom:0in;&nbsp;padding-left:0in;&nbsp;padding-right:0in;&nbsp;border-top:#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;border-right:medium&nbsp;none;&nbsp;padding-top:3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Matt&nbsp;Mitchell&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:mmitchell@backstopsolutions.com&quot;&gt;mmitchell@backstopsolutions.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Friday,&nbsp;January&nbsp;4,&nbsp;2013&nbsp;3:22&nbsp;PM&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;[Owasp-modsecurity-core-rule-set]&nbsp;'Multiple&nbsp;URL&nbsp;Encoding&nbsp;Detected',&nbsp;id:'950109'&nbsp;--&nbsp;am&nbsp;I&nbsp;confused?&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;border-left:#b5c4df&nbsp;5&nbsp;solid;&nbsp;padding:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;margin:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:break-word;&nbsp;color:rgb(0,0,0);&nbsp;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;div&gt;Hi&nbsp;all,&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;in&nbsp;advance&nbsp;for&nbsp;any&nbsp;help&nbsp;you&nbsp;can&nbsp;provide.&nbsp;I'm&nbsp;attempting&nbsp;to&nbsp;configure&nbsp;mod_security&nbsp;and&nbsp;the&nbsp;core&nbsp;rule&nbsp;set&nbsp;to&nbsp;handle&nbsp;traffic&nbsp;for&nbsp;our&nbsp;web&nbsp;application&nbsp;and&nbsp;am&nbsp;getting&nbsp;stuck&nbsp;trying&nbsp;to&nbsp;figure&nbsp;out&nbsp;the&nbsp;intended&nbsp;behavior&nbsp;of&nbsp;rule&nbsp;950107.&nbsp;The&nbsp;problem&nbsp;I'm&nbsp;running<br>
&nbsp;into&nbsp;seems&nbsp;to&nbsp;stem&nbsp;from&nbsp;the&nbsp;fact&nbsp;that&nbsp;a&nbsp;literal&nbsp;%&nbsp;is&nbsp;being&nbsp;URI-encoded&nbsp;inside&nbsp;a&nbsp;query&nbsp;string&nbsp;(done&nbsp;&quot;automagically&quot;&nbsp;by&nbsp;jQuery&nbsp;in&nbsp;my&nbsp;case).&nbsp;As&nbsp;I'm&nbsp;reading&nbsp;rule&nbsp;950109,&nbsp;it&nbsp;looks&nbsp;like<br>
&lt;span&nbsp;style=&quot;font-style:italic&quot;&gt;any&lt;/span&gt;&nbsp;encoded&nbsp;character&nbsp;will&nbsp;cause&nbsp;it&nbsp;to&nbsp;trigger,&nbsp;which&nbsp;seems&nbsp;like&nbsp;not&nbsp;the&nbsp;intent&nbsp;of&nbsp;the&nbsp;rule&nbsp;(based&nbsp;on&nbsp;the&nbsp;name).&nbsp;I'd&nbsp;expect&nbsp;the&nbsp;rule&nbsp;to&nbsp;fire&nbsp;only&nbsp;in&nbsp;the&nbsp;case&nbsp;where&nbsp;the&nbsp;encoded&nbsp;%&nbsp;(%25)&nbsp;were&nbsp;then&nbsp;followed&nbsp;by&nbsp;two&nbsp;more&nbsp;(or<br>
&nbsp;u&#43;4&nbsp;more)&nbsp;digits,&nbsp;which&nbsp;would&nbsp;result&nbsp;from&nbsp;URI-encoding&nbsp;a&nbsp;string&nbsp;twice.&nbsp;While&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the&nbsp;%&nbsp;as&nbsp;%25&nbsp;isn't&nbsp;strictly&nbsp;necessary,&nbsp;I&nbsp;don't&nbsp;think&nbsp;it&nbsp;is,&nbsp;in&nbsp;and&nbsp;of&nbsp;itself,&nbsp;necessarily&nbsp;a&nbsp;problem.&nbsp;Here&nbsp;is&nbsp;an&nbsp;example&nbsp;request:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;GET&nbsp;/searchController.jsp?searchText=%25name&amp;maxResults=50&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;So&nbsp;I&nbsp;suppose&nbsp;I&nbsp;have&nbsp;a&nbsp;three-part&nbsp;question:&lt;/div&gt;<br>
&lt;ol&gt;<br>
&lt;li&gt;What,&nbsp;if&nbsp;anything,&nbsp;am&nbsp;I&nbsp;missing&nbsp;about&nbsp;the&nbsp;intent&nbsp;and&nbsp;implementation&nbsp;of&nbsp;950109?&lt;/li&gt;&lt;/ol&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;<br>
&lt;div&gt;The&nbsp;purpose&nbsp;of&nbsp;this&nbsp;rule&nbsp;is&nbsp;to&nbsp;identify&nbsp;multiple&nbsp;encodings.&nbsp;&nbsp;The&nbsp;key&nbsp;to&nbsp;understanding&nbsp;the&nbsp;rule&nbsp;processing&nbsp;is&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;ARGS&nbsp;collection&nbsp;automatically&nbsp;applies&nbsp;1&nbsp;URL&nbsp;decode&nbsp;to&nbsp;the&nbsp;content&nbsp;before&nbsp;passing&nbsp;to&nbsp;the&nbsp;operator.&nbsp;&nbsp;This&nbsp;is&nbsp;key&nbsp;as&nbsp;it&nbsp;means&nbsp;that<br>
&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;%&nbsp;char&nbsp;following&nbsp;by&nbsp;at&nbsp;least&nbsp;2&nbsp;alpha-numeric&nbsp;chars,&nbsp;then&nbsp;it&nbsp;is&nbsp;probably&nbsp;encoded&nbsp;content&nbsp;remaining.&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&nbsp;style=&quot;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;border-left:#b5c4df&nbsp;5&nbsp;solid;&nbsp;padding:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;margin:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:break-word;&nbsp;color:rgb(0,0,0);&nbsp;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;ol&gt;<br>
&lt;li&gt;If&nbsp;its&nbsp;behavior&nbsp;is&nbsp;deemed&nbsp;to&nbsp;be&nbsp;&quot;correct&quot;,&nbsp;how&nbsp;would&nbsp;you&nbsp;suggest&nbsp;working&nbsp;around&nbsp;this?&nbsp;I&nbsp;have&nbsp;been&nbsp;trying&nbsp;to&nbsp;be&nbsp;surgical&nbsp;about&nbsp;modifying&nbsp;the&nbsp;core&nbsp;rules,&nbsp;only&nbsp;either&nbsp;whitelisting&nbsp;entire&nbsp;endpoints&nbsp;or&nbsp;by&nbsp;removing&nbsp;selected&nbsp;rules&nbsp;by&nbsp;ID&nbsp;after&nbsp;all&nbsp;had&nbsp;been&nbsp;loaded.<br>
&nbsp;I&nbsp;am&nbsp;sure&nbsp;I&nbsp;could&nbsp;re-add&nbsp;a&nbsp;modified&nbsp;version&nbsp;of&nbsp;950109&nbsp;that&nbsp;will&nbsp;not&nbsp;trigger&nbsp;on&nbsp;the&nbsp;particular&nbsp;endpoint&nbsp;in&nbsp;question,&nbsp;but&nbsp;is&nbsp;there&nbsp;a&nbsp;better&nbsp;way?&lt;/li&gt;&lt;/ol&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;think&nbsp;that&nbsp;we&nbsp;might&nbsp;be&nbsp;able&nbsp;to&nbsp;improve&nbsp;the&nbsp;Regex&nbsp;to&nbsp;look&nbsp;for&nbsp;multiple,&nbsp;continued&nbsp;encoding&nbsp;and&nbsp;not&nbsp;just&nbsp;1&nbsp;encoded&nbsp;char&nbsp;such&nbsp;as&nbsp;%25.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;will&nbsp;see&nbsp;about&nbsp;updating&nbsp;the&nbsp;Regex&nbsp;and&nbsp;let&nbsp;the&nbsp;list&nbsp;know.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;-Ryan&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&nbsp;style=&quot;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;border-left:#b5c4df&nbsp;5&nbsp;solid;&nbsp;padding:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;margin:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:break-word;&nbsp;color:rgb(0,0,0);&nbsp;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;ol&gt;<br>
&lt;li&gt;If&nbsp;its&nbsp;behavior&nbsp;is&nbsp;deemed&nbsp;to&nbsp;be&nbsp;incorrect,&nbsp;how&nbsp;should&nbsp;we&nbsp;(I)&nbsp;change&nbsp;it?&lt;/li&gt;&lt;/ol&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;-m&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information<br>
&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
