<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.28.3&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
Hello,&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;Wed,&nbsp;2010-09-08&nbsp;at&nbsp;10:16&nbsp;-0500,&nbsp;Ryan&nbsp;Barnett&nbsp;wrote:<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
On&nbsp;9/8/10&nbsp;10:44&nbsp;AM,&nbsp;&amp;quot;Dirk&nbsp;Caspari&amp;quot;&nbsp;&amp;lt;&lt;A&nbsp;HREF=&quot;mailto:d.caspari@eurodata.de&quot;&gt;d.caspari@eurodata.de&lt;/A&gt;&amp;gt;&nbsp;wrote:<br>
<br>
&amp;gt;&nbsp;--411a3f76-B--<br>
&amp;gt;&nbsp;GET&nbsp;/src/read_body.php?mailbox=INBOX&amp;amp;passed_id=81&amp;amp;startMessage=1&nbsp;HTTP/1.1<br>
&amp;gt;&nbsp;Host:&nbsp;xxx.xxxxxxxx.de<br>
&amp;gt;&nbsp;User-Agent:&nbsp;Mozilla/5.0&nbsp;(X11;&nbsp;U;&nbsp;Linux&nbsp;i686;&nbsp;de-DE;&nbsp;rv:1.9.2.3)<br>
&amp;gt;&nbsp;Gecko/20100423&nbsp;Ubuntu/10.04&nbsp;(lucid)&nbsp;Firefox/3.6.3<br>
&amp;gt;&nbsp;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8<br>
&amp;gt;&nbsp;Accept-Language:&nbsp;de-DE,de;q=0.8,de-de;q=0.6,en-us;q=0.4,en;q=0.2<br>
&amp;gt;&nbsp;Accept-Encoding:&nbsp;gzip,deflate<br>
&amp;gt;&nbsp;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7<br>
&amp;gt;&nbsp;Keep-Alive:&nbsp;115<br>
&amp;gt;&nbsp;Connection:&nbsp;keep-alive<br>
&amp;gt;&nbsp;Referer:&nbsp;<br>
&amp;gt;&nbsp;&lt;A&nbsp;HREF=&quot;https://xxx.xxxxxxxxx.de/src/right_main.php?PG_SHOWALL=0&amp;amp;sort=0&amp;amp;startMessage=1&quot;&gt;https://xxx.xxxxxxxxx.de/src/right_main.php?PG_SHOWALL=0&amp;amp;sort=0&amp;amp;startMessage=1&lt;/A&gt;<br>
&amp;gt;&nbsp;&amp;amp;mailbox=INBOX<br>
&amp;gt;&nbsp;Cookie:&nbsp;xxxxx<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;--411a3f76-H--<br>
&amp;gt;&nbsp;Message:&nbsp;Pattern&nbsp;match&nbsp;&amp;quot;\%(?!$|\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}&amp;quot;&nbsp;at<br>
&amp;gt;&nbsp;ARGS:passed_id.&nbsp;[file<br>
&amp;gt;&nbsp;&amp;quot;/etc/apache2/modsecurity/rules-enabled/modsecurity_crs_20_protocol_violations<br>
&amp;gt;&nbsp;.conf&amp;quot;]&nbsp;<br>
&amp;gt;&nbsp;[line&nbsp;&amp;quot;185&amp;quot;]&nbsp;[id&nbsp;&amp;quot;950109&amp;quot;]&nbsp;[rev&nbsp;&amp;quot;2.0.8&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Multiple&nbsp;URL&nbsp;Encoding<br>
&amp;gt;&nbsp;Detected&amp;quot;]&nbsp;[severity&nbsp;&amp;quot;NOTICE&amp;quot;]&nbsp;[tag&nbsp;&amp;quot;PROTOCOL_VIOLATION/EVASION&amp;quot;]<br>
&amp;gt;&nbsp;Message:&nbsp;Warning.&nbsp;Operator&nbsp;LT&nbsp;matched&nbsp;20&nbsp;at&nbsp;TX:inbound_anomaly_score.<br>
&amp;gt;&nbsp;[file&nbsp;<br>
&amp;gt;&nbsp;&amp;quot;/etc/apache2/modsecurity/rules-enabled/modsecurity_crs_60_correlation.conf&amp;quot;]<br>
&amp;gt;&nbsp;[line&nbsp;&amp;quot;31&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;(Total&nbsp;Inbound&nbsp;Score:&nbsp;5,&nbsp;SQLi=,<br>
&amp;gt;&nbsp;XSS=):&nbsp;Multiple&nbsp;URL&nbsp;Encoding&nbsp;Detected&nbsp;!<br>
&amp;gt;&nbsp;%{matched_var_name}=%{matched_var}&nbsp;!&amp;quot;]<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;Thanks.<br>
&amp;gt;&nbsp;&nbsp;&nbsp;D&nbsp;I&nbsp;R&nbsp;K<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;<br>
&amp;gt;&nbsp;<br>
<br>
Hmm..&nbsp;Looks&nbsp;like&nbsp;the&nbsp;previous&nbsp;version&nbsp;in&nbsp;SVN&nbsp;was&nbsp;missing&nbsp;the&nbsp;parentheses&nbsp;in<br>
the&nbsp;RegEx.&nbsp;&nbsp;Use&nbsp;this&nbsp;latest&nbsp;version&nbsp;-<br>
<br>
&lt;A&nbsp;HREF=&quot;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_r&quot;&gt;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_r&lt;/A&gt;<br>
ules/modsecurity_crs_20_protocol_violations.conf?revision=1535<br>
<br>
<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
The&nbsp;regular&nbsp;expression&nbsp;in&nbsp;rules&nbsp;950107,&nbsp;950109&nbsp;and&nbsp;950108&nbsp;shouldn't&nbsp;instead&nbsp;be&nbsp;something&nbsp;like&nbsp;&amp;quot;\%[0-9a-fA-F]{2}(?![0-9a-fA-F])|\%u[0-9a-fA-F]{4}(?![0-9a-fA-F])&amp;quot;?&lt;BR&gt;<br>
The&nbsp;expression&nbsp;provided&nbsp;will&nbsp;still&nbsp;match&nbsp;for&nbsp;example&nbsp;&amp;quot;%1&amp;quot;&nbsp;and,&nbsp;unless&nbsp;I&nbsp;missed&nbsp;the&nbsp;point&nbsp;on&nbsp;what&nbsp;the&nbsp;rules&nbsp;should&nbsp;do,&nbsp;this&nbsp;would&nbsp;be&nbsp;a&nbsp;false&nbsp;positive.<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&lt;PRE&gt;<br>
<br>
_______________________________________________<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list<br>
&lt;A&nbsp;HREF=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/A&gt;<br>
&lt;A&nbsp;HREF=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/A&gt;<br>
<br>
&lt;/PRE&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
Thanks,&lt;BR&gt;<br>
Lu&amp;#237;s<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
