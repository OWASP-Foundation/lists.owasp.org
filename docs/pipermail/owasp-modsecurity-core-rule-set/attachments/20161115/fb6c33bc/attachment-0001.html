<tt>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Hello.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Here&nbsp;there&#39;s&nbsp;a&nbsp;example&nbsp;where&nbsp;they&nbsp;use&nbsp;chain:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://samhobbs.co.uk/2015/09/example-whitelisting-rules-apache-modsecurity-and-owasp-core-rule-set&quot;&gt;https://samhobbs.co.uk/2015/09/example-whitelisting-rules-apache-modsecurity-and-owasp-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
SecRuleUpdateActionById&nbsp;981175&nbsp;&quot;chain,deny,status:501&quot;&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Have&nbsp;you&nbsp;tried&nbsp;with&nbsp;chain&nbsp;instead?&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Regards&nbsp;&lt;/p&gt;<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;El&nbsp;mar.,&nbsp;15&nbsp;de&nbsp;noviembre&nbsp;de&nbsp;2016&nbsp;17:40,&nbsp;Christian&nbsp;Folini&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&gt;christian.folini@netnea.com&lt;/a&gt;&gt;&nbsp;escribió:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Hi&nbsp;there,&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
On&nbsp;Tue,&nbsp;Nov&nbsp;15,&nbsp;2016&nbsp;at&nbsp;04:44:15PM&nbsp;+0100,&nbsp;Heinrich&nbsp;M.&nbsp;wrote:&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;thank&nbsp;you&nbsp;for&nbsp;your&nbsp;great&nbsp;work!&nbsp;It&nbsp;is&nbsp;just&nbsp;great&nbsp;that&nbsp;there&nbsp;exists&nbsp;an&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;open&nbsp;source&nbsp;WAF&nbsp;and&nbsp;a&nbsp;corresponding&nbsp;ruleset!&nbsp;Thank&nbsp;you.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
You&nbsp;are&nbsp;most&nbsp;welcome.&nbsp;Glad&nbsp;you&nbsp;like&nbsp;it.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;quite&nbsp;new&nbsp;to&nbsp;ModSecurity.&nbsp;Today,&nbsp;I&nbsp;found&nbsp;some&nbsp;time&nbsp;to&nbsp;play&nbsp;around&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;with&nbsp;ModSecurity&nbsp;and&nbsp;the&nbsp;new&nbsp;CRS&nbsp;release&nbsp;in&nbsp;a&nbsp;basic&nbsp;testing&nbsp;setup.&nbsp;I&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;hope&nbsp;that&nbsp;I&nbsp;will&nbsp;be&nbsp;able&nbsp;to&nbsp;introduce&nbsp;ModSec&nbsp;and&nbsp;the&nbsp;CRS3&nbsp;in&nbsp;some&nbsp;small&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;prod&nbsp;environment&nbsp;soon.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
Please&nbsp;keep&nbsp;us&nbsp;posted&nbsp;about&nbsp;your&nbsp;experience.&nbsp;Us,&nbsp;the&nbsp;dev&nbsp;team&nbsp;has&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
years&nbsp;of&nbsp;experience&nbsp;and&nbsp;this&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;big&nbsp;problem&nbsp;as&nbsp;we&nbsp;do&nbsp;not&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
even&nbsp;see&nbsp;the&nbsp;small&nbsp;problems&nbsp;and&nbsp;the&nbsp;many&nbsp;questions&nbsp;that&nbsp;new&nbsp;users&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
like&nbsp;you&nbsp;face.&nbsp;Your&nbsp;perspective&nbsp;is&nbsp;very&nbsp;valuable.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;1.&nbsp;Issue&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;After&nbsp;including&nbsp;the&nbsp;new&nbsp;CRS&nbsp;rule&nbsp;files,&nbsp;apache&nbsp;didn&#39;t&nbsp;fire&nbsp;up.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;journalctl&nbsp;provided&nbsp;the&nbsp;following&nbsp;error&nbsp;messages:&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;[...]&nbsp;Syntax&nbsp;error&nbsp;on&nbsp;line&nbsp;36&nbsp;of&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;/etc/modsecurity/owasp-modsecurity-crs/rules/RESPONSE-950-DATA-LEAKAGES.conf:&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;[...]&nbsp;Error&nbsp;parsing&nbsp;actions:&nbsp;Unknown&nbsp;action:&nbsp;\\&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;Workaround&nbsp;(I&nbsp;don&#39;t&nbsp;know&nbsp;what&nbsp;other&nbsp;effects&nbsp;of&nbsp;this&nbsp;might&nbsp;be...):&nbsp;Adding&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;a&nbsp;space&nbsp;to&nbsp;line&nbsp;36&nbsp;resolved&nbsp;the&nbsp;issue:&nbsp;&quot;t:none,&nbsp;\&quot;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
This&nbsp;is&nbsp;a&nbsp;known&nbsp;issue&nbsp;with&nbsp;older&nbsp;Apache&nbsp;versions.&nbsp;It&nbsp;is&nbsp;documented&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
in&nbsp;the&nbsp;CRS&nbsp;KNOWN_BUGS&nbsp;file:&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;*&nbsp;Apache&nbsp;2.4&nbsp;prior&nbsp;to&nbsp;2.4.11&nbsp;is&nbsp;affected&nbsp;by&nbsp;a&nbsp;bug&nbsp;in&nbsp;parsing&nbsp;multi-line&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp;configuration&nbsp;directives,&nbsp;which&nbsp;causes&nbsp;Apache&nbsp;to&nbsp;fail&nbsp;during&nbsp;startup&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp;with&nbsp;an&nbsp;error&nbsp;such&nbsp;as:&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp; &nbsp;Error&nbsp;parsing&nbsp;actions:&nbsp;Unknown&nbsp;action:&nbsp;\\&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp; &nbsp;Action&nbsp;&#39;configtest&#39;&nbsp;failed.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;...&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp;We&nbsp;advise&nbsp;to&nbsp;upgrade&nbsp;your&nbsp;Apache&nbsp;version.&nbsp;If&nbsp;upgrading&nbsp;is&nbsp;not&nbsp;possible,&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp;we&nbsp;have&nbsp;provided&nbsp;a&nbsp;script&nbsp;in&nbsp;the&nbsp;util/join-multiline-rules&nbsp;directory&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp;which&nbsp;converts&nbsp;the&nbsp;rules&nbsp;into&nbsp;a&nbsp;format&nbsp;that&nbsp;works&nbsp;around&nbsp;the&nbsp;bug.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp;You&nbsp;have&nbsp;to&nbsp;re-run&nbsp;this&nbsp;script&nbsp;whenever&nbsp;you&nbsp;modify&nbsp;or&nbsp;update&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt; &nbsp;the&nbsp;CRS&nbsp;rules.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
Your&nbsp;workaround&nbsp;works&nbsp;equally&nbsp;well.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;2.&nbsp;Issue&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;Changing&nbsp;the&nbsp;blocking&nbsp;actions&nbsp;did&nbsp;not&nbsp;work&nbsp;as&nbsp;documented&nbsp;in&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;RESPONSE-999-EXCLUSION-RULES-AFTER-CRS.conf.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;I&nbsp;tried&nbsp;to&nbsp;use&nbsp;the&nbsp;example &nbsp;&quot;send&nbsp;an&nbsp;error&nbsp;404&quot;&nbsp;(line&nbsp;67&nbsp;and&nbsp;below).&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;With&nbsp;the&nbsp;two&nbsp;rules&nbsp;activated,&nbsp;blocking&nbsp;dind&#39;t&nbsp;work&nbsp;anymore.&nbsp;Removing&nbsp;the&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;&quot;chain&quot;&nbsp;from&nbsp;the&nbsp;actions&nbsp;made&nbsp;blocking&nbsp;work&nbsp;again.&nbsp;The&nbsp;rules&nbsp;then&nbsp;are&nbsp;as&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;follows:&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;SecRuleUpdateActionById&nbsp;949110&nbsp;&quot;t:none,deny,status:404&quot;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&gt;&nbsp;SecRuleUpdateActionById&nbsp;959100&nbsp;&quot;t:none,deny,status:404&quot;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
Ooops.&nbsp;I&nbsp;need&nbsp;to&nbsp;take&nbsp;a&nbsp;look&nbsp;at&nbsp;this.&nbsp;I&#39;ll&nbsp;be&nbsp;back.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
Ahoj,&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
Christian&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
--&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
Worst-case&nbsp;thinking&nbsp;encourages&nbsp;society&nbsp;to&nbsp;adopt&nbsp;fear&nbsp;as&nbsp;of&nbsp;one&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
of&nbsp;the&nbsp;key&nbsp;principles&nbsp;around&nbsp;which&nbsp;the&nbsp;public,&nbsp;the&nbsp;government&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
and&nbsp;various&nbsp;institutions&nbsp;should&nbsp;organise&nbsp;their&nbsp;lives.&nbsp;It&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
institutionalises&nbsp;insecurity&nbsp;and&nbsp;fosters&nbsp;a&nbsp;mood&nbsp;of&nbsp;confusion&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
and&nbsp;powerlessness.&nbsp;Through&nbsp;popularising&nbsp;the&nbsp;belief&nbsp;that&nbsp;worst&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
cases&nbsp;are&nbsp;normal,&nbsp;it&nbsp;also&nbsp;encourages&nbsp;people&nbsp;to&nbsp;feel&nbsp;defenceless&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
and&nbsp;vulnerable&nbsp;to&nbsp;a&nbsp;wide&nbsp;range&nbsp;of&nbsp;future&nbsp;threats.&nbsp;In&nbsp;all&nbsp;but&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
name,&nbsp;it&nbsp;is&nbsp;an&nbsp;invitation&nbsp;to&nbsp;social&nbsp;paralysis.&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
--&nbsp;Frank&nbsp;Furedi&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
_______________________________________________&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;class=&quot;gmail_msg&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;class=&quot;gmail_msg&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&nbsp;class=&quot;gmail_msg&quot;&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
