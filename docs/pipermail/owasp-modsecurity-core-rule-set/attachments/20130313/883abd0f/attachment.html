<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&nbsp;&lt;br&gt;&lt;br&gt;I&nbsp;get&nbsp;an&nbsp;error&nbsp;(XML&nbsp;parsing&nbsp;error:&nbsp;XML:&nbsp;Failed&nbsp;parsing&nbsp;document)&nbsp;when&nbsp;mod_security&nbsp;is&nbsp;checking&nbsp;a&nbsp;multipart/related&nbsp;request.&lt;br&gt;&lt;br&gt;&lt;br&gt;-----------------------&lt;br&gt;POST&nbsp;/ws/services/ServiceHttpSoap11Endpoint/?&nbsp;HTTP/1.0&lt;br&gt;<br>
<br>
Content-Type:&nbsp;multipart/related;&nbsp;type=&quot;text/xml&quot;;&nbsp;start=&quot;&lt;BC681B2A92FBD6F218D4FAE416142A33&gt;&quot;;&nbsp;boundary=&quot;----=_Part_543_922960639.1363199273019&quot;&lt;br&gt;Accept:&nbsp;application/soap+xml,&nbsp;application/dime,&nbsp;multipart/related,&nbsp;text/*&lt;br&gt;<br>
<br>
...&lt;br&gt;&lt;br&gt;------=_Part_543_922960639.1363199273019&lt;br&gt;Content-Type:&nbsp;text/xml;&nbsp;charset=UTF-8&lt;br&gt;Content-Transfer-Encoding:&nbsp;binary&lt;br&gt;Content-Id:&nbsp;&lt;BC681B2A92FBD6F218D4FAE416142A33&gt;&lt;br&gt;&lt;br&gt;&lt;?xml&nbsp;version=&quot;1.0&quot;&nbsp;encoding=&quot;UTF-8&quot;?&gt;&lt;soapenv:Envelope&nbsp;xmlns:soapenv=&quot;&lt;a&nbsp;href=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot;&gt;http://schemas.xmlsoap.org/soap/envelope/&lt;/a&gt;&quot;&nbsp;xmlns:xsd=&quot;&lt;a&nbsp;href=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;http://www.w3.org/2001/XMLSchema&lt;/a&gt;&quot;&nbsp;xmlns:xsi=&quot;&lt;a&nbsp;href=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;http://www.w3.org/2001/XMLSchema-instance&lt;/a&gt;&quot;&gt;&lt;soapenv:Body&gt;...&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;&lt;br&gt;<br>
<br>
------=_Part_543_922960639.1363199273019&lt;br&gt;Content-Type:&nbsp;text/plain&lt;br&gt;Content-Transfer-Encoding:&nbsp;binary&lt;br&gt;Content-Id:&nbsp;&lt;D0A3A1A7FED986556394EFA1A63EB597&gt;&lt;br&gt;&lt;binary&nbsp;content&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;----------------------&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;To&nbsp;me,&nbsp;the&nbsp;problem&nbsp;is&nbsp;that&nbsp;rule&nbsp;900017&nbsp;is&nbsp;matching&nbsp;any&nbsp;&quot;text/xml&quot;&nbsp;doesnt&nbsp;matter&nbsp;where&nbsp;in&nbsp;the Content-Type&nbsp;value.&nbsp;I&nbsp;think&nbsp;that&nbsp;change&nbsp;it&nbsp;to&nbsp;match&nbsp;&quot;^text/xml&quot;&nbsp;will&nbsp;be&nbsp;better.&nbsp;Like:&lt;/div&gt;<br>
<br>
&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;REQUEST_HEADERS:Content-Type&nbsp;&quot;^text/xml&quot;&nbsp;\&lt;/div&gt;&lt;div&gt; &nbsp;&quot;id:&#39;900017&#39;,&nbsp;\&lt;/div&gt;&lt;div&gt; &nbsp;phase:1,&nbsp;\&lt;/div&gt;&lt;div&gt; &nbsp;t:none,t:lowercase,&nbsp;\&lt;/div&gt;&lt;div&gt; &nbsp;nolog,&nbsp;\&lt;/div&gt;<br>
<br>
&lt;div&gt; &nbsp;pass,&nbsp;\&lt;/div&gt;&lt;div&gt; &nbsp;chain&quot;&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;REQBODY_PROCESSOR&nbsp;&quot;!@streq&nbsp;XML&quot;&nbsp;\&lt;/div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&quot;ctl:requestBodyProcessor=XML&quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;<br>
<br>
This&nbsp;sounds&nbsp;correct&nbsp;to&nbsp;you?&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;best&nbsp;regards, &lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style&gt;Klaubert&nbsp;Herr&lt;/div&gt;&lt;div&nbsp;style&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
