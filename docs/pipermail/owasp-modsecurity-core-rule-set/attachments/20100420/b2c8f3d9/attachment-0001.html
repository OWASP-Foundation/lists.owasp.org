<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;<br>
&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#ffffff&quot;&gt;<br>
I&nbsp;think&nbsp;I&nbsp;may&nbsp;have&nbsp;placed&nbsp;the&nbsp;rule&nbsp;before&nbsp;the&nbsp;rule&nbsp;was&nbsp;set.&amp;nbsp;&nbsp;I&nbsp;was<br>
placing&nbsp;the&nbsp;rule&nbsp;in&nbsp;httpd-security2.conf&nbsp;(line&nbsp;2&nbsp;below).&amp;nbsp;&nbsp;It&nbsp;worked&nbsp;for<br>
the&nbsp;&amp;lt;Directory&amp;gt;&nbsp;and&nbsp;&amp;lt;Location&amp;gt;&nbsp;rules&nbsp;but&nbsp;not&nbsp;for&nbsp;the<br>
SecRule&nbsp;REQUEST_URI...&nbsp;line.&amp;nbsp;&nbsp;I&nbsp;copied&nbsp;the&nbsp;line&nbsp;(and&nbsp;commented&nbsp;it&nbsp;out<br>
in&nbsp;the&nbsp;original&nbsp;file)&nbsp;to&nbsp;extra/httpd-exclude-secrules2.conf&nbsp;(line&nbsp;4<br>
below),&nbsp;which&nbsp;I&nbsp;believe&nbsp;to&nbsp;load&nbsp;last,&nbsp;please&nbsp;correct&nbsp;me&nbsp;if&nbsp;I&nbsp;am&nbsp;wrong.&amp;nbsp;<br>
Placing&nbsp;the&nbsp;rule&nbsp;here&nbsp;still&nbsp;did&nbsp;not&nbsp;work.&amp;nbsp;&nbsp;I&nbsp;also&nbsp;tried&nbsp;changing&nbsp;from<br>
REQUEST_URI&nbsp;to&nbsp;REQUEST_FILENAME&nbsp;but&nbsp;that&nbsp;change&nbsp;did&nbsp;not&nbsp;work&nbsp;either.&lt;br&gt;<br>
&lt;u&gt;&lt;br&gt;<br>
FROM&nbsp;hsphere/local/config/httpd2/httpd.conf&lt;/u&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&amp;lt;IfModule&nbsp;security2_module&amp;gt;&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Include&nbsp;/hsphere/local/config/httpd2/modsecurity-core-rules/*.conf&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Include&nbsp;/hsphere/local/config/httpd2/extra/httpd-security2.conf&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Include&nbsp;/hsphere/local/config/httpd2/gotrootrules2/*.conf&lt;br&gt;<br>
&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Include<br>
/hsphere/local/config/httpd2/extra/httpd-exclude-secrules2.conf&lt;br&gt;<br>
&amp;lt;/IfModule&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;rule&nbsp;in&nbsp;question&nbsp;is&nbsp;currently&nbsp;-&nbsp;the&nbsp;rules&nbsp;are&nbsp;on&nbsp;a&nbsp;single&nbsp;line&nbsp;but<br>
may&nbsp;get&nbsp;wrapped&nbsp;in&nbsp;the&nbsp;email.&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;^/contact\_cgi\.php$&quot;<br>
&quot;log,auditlog,pass,ctl:ruleRemoveById=950801,msg:'RC&nbsp;20100420&nbsp;-&nbsp;not&nbsp;an<br>
easy&nbsp;app&nbsp;-&nbsp;contact_cgi.php'&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;was&nbsp;the&nbsp;original&nbsp;rule&nbsp;that&nbsp;I&nbsp;tried&nbsp;to&nbsp;use.&lt;br&gt;<br>
SecRule&nbsp;REQUEST_URI&nbsp;&quot;/contact_cgi.php&quot;<br>
&quot;log,auditlog,pass,ctl:ruleRemoveById=950801,msg:'RC&nbsp;20100420&nbsp;-&nbsp;not&nbsp;an<br>
easy&nbsp;app&nbsp;-&nbsp;contact_cgi.php'&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;another&nbsp;question...&amp;nbsp;&nbsp;what&nbsp;is&nbsp;the&nbsp;&quot;local&nbsp;48&nbsp;exceptions&nbsp;file&quot;?&amp;nbsp;&nbsp;Is<br>
it&nbsp;a&nbsp;specific&nbsp;file&nbsp;that&nbsp;may&nbsp;be&nbsp;missing&nbsp;in&nbsp;our&nbsp;installation&nbsp;or&nbsp;is&nbsp;it&nbsp;a<br>
generic&nbsp;name&nbsp;for&nbsp;a&nbsp;user&nbsp;added&nbsp;exclusion&nbsp;file?&amp;nbsp;<br>
httpd-exclude-secrules2.conf&nbsp;in&nbsp;my&nbsp;case.&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks.&lt;br&gt;<br>
Ryan&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;04/19/2010&nbsp;11:27&nbsp;PM,&nbsp;Jamuse&nbsp;wrote:<br>
&lt;blockquote<br>
&nbsp;cite=&quot;mid:q2q8c1870621004192327if743e925yf13d06be053bc1a6@mail.gmail.com&quot;<br>
&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Did&nbsp;you&nbsp;place&nbsp;the&nbsp;above&nbsp;rule&nbsp;before&nbsp;the&nbsp;950801&nbsp;rule&nbsp;is<br>
set?&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
-&nbsp;J&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Apr&nbsp;20,&nbsp;2010&nbsp;at&nbsp;2:56&nbsp;AM,&nbsp;Ryan&nbsp;Cowell<br>
&nbsp;&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
&nbsp;href=&quot;mailto:ryan@truepath.com&quot;&gt;ryan@truepath.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;<br>
&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;I<br>
thought&nbsp;I&nbsp;had&nbsp;a&nbsp;working&nbsp;rule&nbsp;(below)&nbsp;but&nbsp;found&nbsp;out&nbsp;today&nbsp;that&nbsp;it&nbsp;was&lt;br&gt;<br>
still&nbsp;blocking&nbsp;the&nbsp;users&nbsp;from&nbsp;sending&nbsp;the&nbsp;form&nbsp;and&nbsp;gave&nbsp;the&nbsp;error&lt;br&gt;<br>
message&nbsp;below&nbsp;but&nbsp;did&nbsp;not&nbsp;include&nbsp;the&nbsp;customized&nbsp;message.&nbsp;&amp;nbsp;Any&nbsp;ideas?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
SecRule&nbsp;REQUEST_URI&nbsp;&quot;/contact_cgi.php&quot;&nbsp;\&lt;br&gt;<br>
&amp;nbsp;&quot;log,pass,ctl:ruleRemoveById=950801,msg:'RC&nbsp;20100413&nbsp;-<br>
contact_cgi.php'&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
[Mon&nbsp;Apr&nbsp;19&nbsp;10:49:24&nbsp;2010]&nbsp;[error]&nbsp;[client&nbsp;xx.xxx.xxx.x]&nbsp;ModSecurity:&lt;br&gt;<br>
Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;400&nbsp;(phase&nbsp;2).&nbsp;Invalid&nbsp;UTF-8&nbsp;encoding:&nbsp;invalid&lt;br&gt;<br>
byte&nbsp;value&nbsp;in&nbsp;character&nbsp;at&nbsp;ARGS:submit.&nbsp;[offset&nbsp;&quot;0&quot;]&nbsp;[file&lt;br&gt;<br>
&quot;/hsphere/local/config/httpd2/modsecurity-core-rules/modsecurity_crs_20_protocol_violations.conf&quot;]&lt;br&gt;<br>
[line&nbsp;&quot;67&quot;]&nbsp;[id&nbsp;&quot;950801&quot;]&nbsp;[msg&nbsp;&quot;UTF8&nbsp;Encoding&nbsp;Abuse&nbsp;Attack&nbsp;Attempt&quot;]&lt;br&gt;<br>
[severity&nbsp;&quot;WARNING&quot;]&nbsp;[hostname&nbsp;&quot;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
&nbsp;href=&quot;http://domain.org&quot;&nbsp;target=&quot;_blank&quot;&gt;domain.org&lt;/a&gt;&quot;]&nbsp;[uri<br>
&quot;/contact_cgi.php&quot;]&lt;br&gt;<br>
[unique_id&nbsp;&quot;S8yXpM@eCgMAAFXLPtEAAAAC&quot;]&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
Thanks,&lt;br&gt;<br>
Ryan&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
On&nbsp;04/13/2010&nbsp;06:05&nbsp;AM,&nbsp;Ryan&nbsp;Barnett&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;On&nbsp;Monday&nbsp;12&nbsp;April&nbsp;2010&nbsp;17:24:50&nbsp;Ryan&nbsp;Cowell&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;The&nbsp;commented&nbsp;line&nbsp;did&nbsp;not&nbsp;work,&nbsp;but&nbsp;as&nbsp;far&nbsp;as&nbsp;I&nbsp;can&nbsp;tell,&nbsp;the<br>
syntax&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;should&nbsp;be&nbsp;correct.&nbsp;&amp;nbsp;Rather&nbsp;than&nbsp;disabling&nbsp;the&nbsp;rule&nbsp;entirely,<br>
we&nbsp;would&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;like&nbsp;to&nbsp;maintain&nbsp;a&nbsp;log&nbsp;entry&nbsp;while&nbsp;letting&nbsp;specific&nbsp;files<br>
function&nbsp;as&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;expected.&nbsp;&amp;nbsp;The&nbsp;second&nbsp;line&nbsp;was&nbsp;entered&nbsp;as&nbsp;a&nbsp;temporary&nbsp;fix&nbsp;and<br>
it&nbsp;does&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;ignore&nbsp;the&nbsp;rule&nbsp;for&nbsp;this&nbsp;file.&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;lt;Location&nbsp;/contact_cgi.php&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;#SecRuleUpdateActionById&nbsp;950801<br>
&quot;log,auditlog,pass,msg:'RC&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;20100409&nbsp;-&nbsp;phpBB&nbsp;contact_cgi.php'&quot;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;SecRuleRemoveById&nbsp;950801&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;&amp;lt;/Location&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Thanks&nbsp;for&nbsp;any&nbsp;help.&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;Ryan&lt;br&gt;<br>
&amp;gt;&amp;gt;&nbsp;__&lt;br&gt;<br>
&amp;gt;&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Hey&nbsp;Ryan,&lt;br&gt;<br>
&amp;gt;&nbsp;What&nbsp;CRS&nbsp;version&nbsp;are&nbsp;you&nbsp;using?&nbsp;&amp;nbsp;An&nbsp;example&nbsp;audit&nbsp;log&nbsp;entry&nbsp;would<br>
help.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;A&nbsp;general&nbsp;recommendation&nbsp;is&nbsp;that&nbsp;instead&nbsp;of&nbsp;using&nbsp;Apache&nbsp;scope<br>
directives&nbsp;(Location)&nbsp;you&lt;br&gt;<br>
&amp;gt;&nbsp;can&nbsp;simply&nbsp;specify&nbsp;the&nbsp;proper&nbsp;URL&nbsp;with&nbsp;a&nbsp;standard&nbsp;SecRule<br>
REQUEST_URI...&nbsp;and&nbsp;then&nbsp;use&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;ctl&nbsp;action&nbsp;to&nbsp;disable&nbsp;the&nbsp;rule.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;you&nbsp;are&nbsp;using&nbsp;CRS&nbsp;v2+&nbsp;then&nbsp;you&nbsp;can&nbsp;address&nbsp;these&nbsp;issues&nbsp;in&nbsp;a<br>
local&nbsp;48&nbsp;exceptions&nbsp;file&lt;br&gt;<br>
&amp;gt;&nbsp;that&nbsp;can&nbsp;correct&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;for&nbsp;specific&nbsp;URLs.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;-Ryan&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
--&lt;br&gt;<br>
=================&lt;br&gt;<br>
Ryan&nbsp;Cowell&lt;br&gt;<br>
Truepath&lt;br&gt;<br>
(760)&nbsp;480-8791&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;href=&quot;mailto:ryan@truepath.com&quot;&gt;ryan@truepath.com&lt;/a&gt;&lt;br&gt;<br>
=================&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;<br>
&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;<br>
&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;--&nbsp;<br>
=================<br>
Ryan&nbsp;Cowell<br>
Truepath<br>
(760)&nbsp;480-8791<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:ryan@truepath.com&quot;&gt;ryan@truepath.com&lt;/a&gt;<br>
=================&lt;/pre&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
