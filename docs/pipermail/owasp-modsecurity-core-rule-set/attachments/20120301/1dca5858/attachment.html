<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;&lt;div&gt;I&nbsp;have&nbsp;pushed&nbsp;CRS&nbsp;v2.2.4&nbsp;out&nbsp;to&nbsp;SVN&nbsp;and&nbsp;you&nbsp;can&nbsp;access&nbsp;the&nbsp;updated&nbsp;rule&nbsp;file&nbsp;here&nbsp;-&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_40_generic_attacks.conf?revision=1900&quot;&gt;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_40_generic_attacks.conf?revision=1900&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;updated&nbsp;rule&nbsp;-&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-align:&nbsp;-webkit-auto;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-size-adjust:&nbsp;auto;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;word-wrap:&nbsp;break-word;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;&quot;&gt;SecRule&nbsp;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&nbsp;&quot;[\n\r](?:content-(type|length)|set-cookie|location):&quot;&nbsp;\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;phase:2,rev:'2.2.4',t:none,t:lowercase,capture,ctl:auditLogParts=+E,block,msg:'HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack',id:'950910',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.response_splitting_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/RESPONSE_SPLITTING-%{matched_var_name}=%{tx.0}&quot;&lt;/pre&gt;&lt;/div&gt;&lt;div&gt;-Ryan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&gt;&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0in;&nbsp;PADDING-LEFT:&nbsp;0in;&nbsp;PADDING-RIGHT:&nbsp;0in;&nbsp;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;PADDING-TOP:&nbsp;3pt&quot;&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;&nbsp;Gagandeep&nbsp;Singh&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gagandeepsohi@gmail.com&quot;&gt;gagandeepsohi@gmail.com&lt;/a&gt;&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;&nbsp;Thu,&nbsp;1&nbsp;Mar&nbsp;2012&nbsp;17:15:36&nbsp;+0000&lt;br&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Mod&nbsp;security&nbsp;is&nbsp;not&nbsp;detecting&nbsp;double&nbsp;header's&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;BORDER-LEFT:&nbsp;#b5c4df&nbsp;5&nbsp;solid;&nbsp;PADDING:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;MARGIN:0&nbsp;0&nbsp;0&nbsp;5;&quot;&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Hi&nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;We&nbsp;have&nbsp;configured&nbsp;modsecurity&nbsp;apache_2.6.3&nbsp;and&nbsp;its&nbsp;working&nbsp;fine&nbsp;for&nbsp;most&nbsp;of&nbsp;the&nbsp;cases&nbsp;but&nbsp;we&nbsp;have&nbsp;identified&nbsp;a&nbsp;special&nbsp;attack&nbsp;which&nbsp;is&nbsp;causing&nbsp;a&nbsp;double&nbsp;header&nbsp;injection&nbsp;to&nbsp;the&nbsp;site.&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Example&nbsp;:-&lt;br&gt;&nbsp;&lt;a&nbsp;href=&quot;https://www.xyz.com/%0d%0aLocation:http://www.google.com&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.XYZ.com/%0d%0aLocation:http://www.google.com&lt;/a&gt;&lt;br&gt;<br>
&nbsp;Note&nbsp;-&nbsp;XYZ&nbsp;is&nbsp;any&nbsp;site.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;This&nbsp;generates&nbsp;a&nbsp;Duplicate&nbsp;headers&nbsp;error&nbsp;page&nbsp;which&nbsp;is&nbsp;shown&nbsp;below-&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;Duplicate&nbsp;headers&nbsp;received&nbsp;from&nbsp;the&nbsp;server&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
The&nbsp;response&nbsp;from&nbsp;the&nbsp;server&nbsp;contained&nbsp;duplicate&nbsp;headers.&nbsp;This&nbsp;problem&nbsp;is&nbsp;generally&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;misconfigured&nbsp;website&nbsp;or&nbsp;proxy.&nbsp;Only&nbsp;the&nbsp;website&nbsp;or&nbsp;proxy&nbsp;administrator&nbsp;can&nbsp;fix&nbsp;this&nbsp;issue.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&nbsp;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
&nbsp;Error&nbsp;350&nbsp;(net::ERR_RESPONSE_HEADERS_MULTIPLE_LOCATION):&nbsp;Multiple&nbsp;Location&nbsp;headers&nbsp;received.&nbsp;This&nbsp;is&nbsp;disallowed&nbsp;to&nbsp;protect&nbsp;against&nbsp;HTTP&nbsp;response-splitting&nbsp;attacks.&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;As&nbsp;per&nbsp;the&nbsp;discussion&nbsp;with&nbsp;Bren&nbsp;we&nbsp;came&nbsp;to&nbsp;know&nbsp;that&nbsp;this&nbsp;will&nbsp;be&nbsp;fixed&nbsp;in&nbsp;CRS&nbsp;2.2.4&nbsp;but&nbsp;we&nbsp;need&nbsp;this&nbsp;urgently,&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;get&nbsp;the&nbsp;rule&nbsp;for&nbsp;above&nbsp;issue&nbsp;so&nbsp;we&nbsp;can&nbsp;apply&nbsp;the&nbsp;patch&nbsp;for&nbsp;the&nbsp;time&nbsp;being&nbsp;and&nbsp;will&nbsp;apply&nbsp;2.2.4&nbsp;soon&nbsp;as&nbsp;it&nbsp;becomes&nbsp;available.&nbsp;&nbsp;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Could&nbsp;you&nbsp;please&nbsp;also&nbsp;assist&nbsp;on&nbsp;this,&nbsp;what&nbsp;configuration&nbsp;changes&nbsp;are&nbsp;required&nbsp;to&nbsp;handle&nbsp;this?&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Regards&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Gagandeep&nbsp;Singh&nbsp;&nbsp;Sohi&lt;/div&gt;<br>
_______________________________________________<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;<br>
&lt;/blockquote&gt;&lt;/span&gt;&lt;/body&gt;&lt;/html&gt;<br>

</tt>
