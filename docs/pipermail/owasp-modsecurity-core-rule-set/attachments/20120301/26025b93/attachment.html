<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;The&nbsp;first&nbsp;bit&nbsp;of&nbsp;data&nbsp;that&nbsp;we&nbsp;have&nbsp;about&nbsp;the&nbsp;client&nbsp;is&nbsp;their&nbsp;IP&nbsp;address&nbsp;(either&nbsp;directly&nbsp;or&nbsp;through&nbsp;X-Forwarded-For&nbsp;headers).&nbsp;&nbsp;Before&nbsp;processing&nbsp;any&nbsp;actual&nbsp;HTTP&nbsp;data,&nbsp;we&nbsp;should&nbsp;apply&nbsp;some&nbsp;IP&nbsp;Reputation<br>
&nbsp;Checks.&nbsp;&nbsp;I&nbsp;am&nbsp;thinking&nbsp;of&nbsp;adding&nbsp;in&nbsp;a&nbsp;template&nbsp;rules&nbsp;file&nbsp;that&nbsp;will&nbsp;be&nbsp;executed&nbsp;before&nbsp;the&nbsp;normal&nbsp;modsecurity_crs_20_protocol_violations.conf&nbsp;file.&nbsp;&nbsp;This&nbsp;file&nbsp;will&nbsp;hold&nbsp;the&nbsp;various&nbsp;@rbl&nbsp;checks&nbsp;and&nbsp;the&nbsp;user&nbsp;can&nbsp;select&nbsp;which&nbsp;remote&nbsp;RBL&nbsp;they&nbsp;want&nbsp;to&nbsp;query.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;We&nbsp;do&nbsp;have&nbsp;1&nbsp;@rbl&nbsp;check&nbsp;in&nbsp;the&nbsp;optional_rules/modsecurity_crs_42_comment_spam.conf&nbsp;file&nbsp;but&nbsp;I&nbsp;believe&nbsp;that&nbsp;this&nbsp;should&nbsp;be&nbsp;expanded&nbsp;to&nbsp;query&nbsp;other&nbsp;public&nbsp;RBLs&nbsp;for&nbsp;web-attacker&nbsp;traffic.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;###############################&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;SecRule&nbsp;IP:PREVIOUS_RBL_CHECK&nbsp;&quot;@eq&nbsp;1&quot;&nbsp;&quot;phase:1,id:'981137',t:none,pass,nolog,skipAfter:END_RBL_LOOKUP&quot;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&nbsp;&nbsp;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;@rbl&nbsp;sbl-xbl.spamhaus.org&quot;&nbsp;&quot;phase:1,id:'981138',t:none,pass,nolog,auditlog,msg:'RBL&nbsp;Match&nbsp;for&nbsp;SPAM&nbsp;Source',tag:'AUTOMATION/MALICIOUS',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.automation_score=&#43;%{tx.warning_anomaly_score},setvar:tx.anomaly_score=&#43;%{tx.warning_anomaly_score},setvar:tx.%{rule.id}-AUTOMATION/MALICIOUS-%{matched_var_name}=%{matched_var},setvar:ip.spammer=1,expirevar:ip.spammer=86400,setvar:ip.previous_rbl_check=1,expirevar:ip.previous_rbl_check=86400,skipAfter:END_RBL_CHECK&quot;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&nbsp;&nbsp;SecAction&nbsp;&quot;phase:1,id:'981139',t:none,nolog,pass,setvar:ip.previous_rbl_check=1,expirevar:ip.previous_rbl_check=86400&quot;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;SecMarker&nbsp;END_RBL_LOOKUP&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;###############################&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;These&nbsp;rules&nbsp;will&nbsp;query&nbsp;one&nbsp;of&nbsp;the&nbsp;spamhaus&nbsp;RBLs&nbsp;and&nbsp;it&nbsp;will&nbsp;then&nbsp;save&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;IP&nbsp;persistent&nbsp;storage&nbsp;so&nbsp;it&nbsp;only&nbsp;does&nbsp;an&nbsp;actual&nbsp;DNS&nbsp;lookup&nbsp;once/day&nbsp;to&nbsp;help&nbsp;reduce&nbsp;any&nbsp;perf&nbsp;&nbsp;hit.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;How&nbsp;many&nbsp;people&nbsp;are&nbsp;currently&nbsp;using&nbsp;@rbl&nbsp;checks&nbsp;with&nbsp;ModSecurity?&nbsp;&nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;Would&nbsp;you&nbsp;be&nbsp;interested&nbsp;in&nbsp;using&nbsp;it&nbsp;if&nbsp;this&nbsp;feature&nbsp;was&nbsp;added&nbsp;to&nbsp;the&nbsp;CRS?&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;Let&nbsp;me&nbsp;know&nbsp;what&nbsp;you&nbsp;think.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Consolas,&nbsp;'Courier&nbsp;New',&nbsp;Courier&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-size:&nbsp;13px;&nbsp;&quot;&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabs&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;ModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,<br>
&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic<br>
&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
