<tt>
Thanks Ryan&nbsp;for&nbsp;your&nbsp;help, &lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;FURTHER&nbsp;ISSUE- <br>
its&nbsp;working&nbsp;for&nbsp;HTTP&nbsp;and&nbsp;we&nbsp;got&nbsp;the&nbsp;below&nbsp;response. Our&nbsp;issue&nbsp;is&nbsp;with <br>
HTTPS  as&nbsp;well,&nbsp;this&nbsp;rule&nbsp;is&nbsp;not&nbsp;working&nbsp;for&nbsp;https.&nbsp;Our&nbsp;client&nbsp;has&nbsp;raised&nbsp;a&nbsp;concern&nbsp;for&nbsp;HTTPS.&nbsp;Could&nbsp;you&nbsp;please&nbsp;advise&nbsp;what&nbsp;we&nbsp;can&nbsp;do&nbsp;to&nbsp;enable&nbsp;this&nbsp;for&nbsp;HTTPS&nbsp;as&nbsp;well.&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;Message:&nbsp;Warning.&nbsp;Pattern&nbsp;match&nbsp;&quot;[\n\r](?:content-(type|length)|set-cookie|location):&quot;&nbsp;at&nbsp;REQUEST_FILENAME.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/modsecurity_localrules.conf&quot;]&nbsp;[line&nbsp;&quot;4&quot;]&nbsp;[id&nbsp;&quot;950910&quot;]&nbsp;[rev&nbsp;&quot;2.2.4&quot;]&nbsp;[msg&nbsp;&quot;HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack&quot;]&nbsp;[data&nbsp;&quot;\x0alocation:&quot;]&nbsp;[severity&nbsp;&quot;ALERT&quot;]&lt;/div&gt;<br>
&lt;div&gt;Message:&nbsp;Warning.&nbsp;Pattern&nbsp;match&nbsp;&quot;[\n\r](?:content-(type|length)|set-cookie|location):&quot;&nbsp;at&nbsp;REQUEST_FILENAME.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;]&nbsp;[line&nbsp;&quot;139&quot;]&nbsp;[id&nbsp;&quot;950910&quot;]&nbsp;[rev&nbsp;&quot;2.2.4&quot;]&nbsp;[msg&nbsp;&quot;HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack&quot;]&nbsp;[data&nbsp;&quot;\x0alocation:&quot;]&nbsp;[severity&nbsp;&quot;CRITICAL&quot;]&lt;/div&gt;<br>
&lt;div&gt;Message:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;2).&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_49_enforcement.conf&quot;]&nbsp;[line&nbsp;&quot;25&quot;]&nbsp;[msg&nbsp;&quot;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(score&nbsp;40):&nbsp;HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack&quot;]&lt;/div&gt;<br>
&lt;div&gt;Action:&nbsp;Intercepted&nbsp;(phase&nbsp;2)&lt;/div&gt;&lt;div&gt;Apache-Handler:&nbsp;jakarta-servlet&lt;/div&gt;&lt;div&gt;Stopwatch:&nbsp;1330624314422822&nbsp;1653262&nbsp;(1471&nbsp;1258692&nbsp;-)&lt;/div&gt;&lt;div&gt;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.5.12&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);&nbsp;core&nbsp;ruleset/&lt;a&nbsp;href=&quot;http://2.0.5.&quot;&gt;2.0.5.&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Mar&nbsp;1,&nbsp;2012&nbsp;at&nbsp;5:25&nbsp;PM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:ryan.barnett@owasp.org&quot;&gt;ryan.barnett@owasp.org&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;style=&quot;font-size:14px;font-family:Calibri,sans-serif;word-wrap:break-word&quot;&gt;&lt;div&gt;I&nbsp;have&nbsp;pushed&nbsp;CRS&nbsp;v2.2.4&nbsp;out&nbsp;to&nbsp;SVN&nbsp;and&nbsp;you&nbsp;can&nbsp;access&nbsp;the&nbsp;updated&nbsp;rule&nbsp;file&nbsp;here&nbsp;-&lt;/div&gt;<br>
&lt;div&gt;&lt;a&nbsp;href=&quot;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_40_generic_attacks.conf?revision=1900&quot;&nbsp;target=&quot;_blank&quot;&gt;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_40_generic_attacks.conf?revision=1900&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;updated&nbsp;rule&nbsp;-&lt;/div&gt;&lt;div&gt;&lt;pre&nbsp;style=&quot;line-height:normal;text-indent:0px;letter-spacing:normal;text-align:-webkit-auto;font-variant:normal;text-transform:none;font-style:normal;white-space:pre-wrap;word-wrap:break-word;font-weight:normal;word-spacing:0px&quot;&gt;<br>
SecRule&nbsp;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&nbsp;&quot;[\n\r](?:content-(type|length)|set-cookie|location):&quot;&nbsp;\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;phase:2,rev:&#39;2.2.4&#39;,t:none,t:lowercase,capture,ctl:auditLogParts=+E,block,msg:&#39;HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack&#39;,id:&#39;950910&#39;,logdata:&#39;%{TX.0}&#39;,severity:&#39;2&#39;,setvar:&#39;tx.msg=%{rule.msg}&#39;,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.response_splitting_score=+%{tx.critical_anomaly_score},setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-WEB_ATTACK/RESPONSE_SPLITTING-%{matched_var_name}=%{tx.0}&quot;&lt;/pre&gt;<br>
&lt;/div&gt;&lt;div&gt;-Ryan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;span&gt;&lt;div&nbsp;style=&quot;border-right:medium&nbsp;none;padding-right:0in;padding-left:0in;padding-top:3pt;text-align:left;font-size:11pt;border-bottom:medium&nbsp;none;font-family:Calibri;border-top:#b5c4df&nbsp;1pt&nbsp;solid;padding-bottom:0in;border-left:medium&nbsp;none&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;&nbsp;Gagandeep&nbsp;Singh&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gagandeepsohi@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gagandeepsohi@gmail.com&lt;/a&gt;&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;&nbsp;Thu,&nbsp;1&nbsp;Mar&nbsp;2012&nbsp;17:15:36&nbsp;+0000&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Mod&nbsp;security&nbsp;is&nbsp;not&nbsp;detecting&nbsp;double&nbsp;header&#39;s&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;BORDER-LEFT:#b5c4df&nbsp;5&nbsp;solid;PADDING:0&nbsp;0&nbsp;0&nbsp;5;MARGIN:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Hi &lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;span&nbsp;style=&quot;font-size:14px;font-family:Calibri,sans-serif&quot;&gt;We&nbsp;have&nbsp;configured&nbsp;modsecurity&nbsp;apache_2.6.3&nbsp;and&nbsp;its&nbsp;working&nbsp;fine&nbsp;for&nbsp;most&nbsp;of&nbsp;the&nbsp;cases&nbsp;but&nbsp;we&nbsp;have&nbsp;identified&nbsp;a&nbsp;special&nbsp;attack&nbsp;which&nbsp;is&nbsp;causing&nbsp;a&nbsp;double&nbsp;header&nbsp;injection&nbsp;to&nbsp;the&nbsp;site.&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Example&nbsp;:-&lt;br&gt; &lt;a&nbsp;href=&quot;https://www.xyz.com/%0d%0aLocation:http://www.google.com&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.XYZ.com/%0d%0aLocation:http://www.google.com&lt;/a&gt;&lt;br&gt;<br>
<br>
 Note&nbsp;-&nbsp;XYZ&nbsp;is&nbsp;any&nbsp;site.&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;This&nbsp;generates&nbsp;a&nbsp;Duplicate&nbsp;headers&nbsp;error&nbsp;page&nbsp;which&nbsp;is&nbsp;shown&nbsp;below-&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px&quot;&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;Duplicate&nbsp;headers&nbsp;received&nbsp;from&nbsp;the&nbsp;server&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
<br>
The&nbsp;response&nbsp;from&nbsp;the&nbsp;server&nbsp;contained&nbsp;duplicate&nbsp;headers.&nbsp;This&nbsp;problem&nbsp;is&nbsp;generally&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;misconfigured&nbsp;website&nbsp;or&nbsp;proxy.&nbsp;Only&nbsp;the&nbsp;website&nbsp;or&nbsp;proxy&nbsp;administrator&nbsp;can&nbsp;fix&nbsp;this&nbsp;issue.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt; &lt;/div&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
 Error&nbsp;350&nbsp;(net::ERR_RESPONSE_HEADERS_MULTIPLE_LOCATION):&nbsp;Multiple&nbsp;Location&nbsp;headers&nbsp;received.&nbsp;This&nbsp;is&nbsp;disallowed&nbsp;to&nbsp;protect&nbsp;against&nbsp;HTTP&nbsp;response-splitting&nbsp;attacks.&lt;/blockquote&gt;&lt;/blockquote&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;As&nbsp;per&nbsp;the&nbsp;discussion&nbsp;with&nbsp;Bren&nbsp;we&nbsp;came&nbsp;to&nbsp;know&nbsp;that&nbsp;this&nbsp;will&nbsp;be&nbsp;fixed&nbsp;in&nbsp;CRS&nbsp;2.2.4&nbsp;but&nbsp;we&nbsp;need&nbsp;this&nbsp;urgently,&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;get&nbsp;the&nbsp;rule&nbsp;for&nbsp;above&nbsp;issue&nbsp;so&nbsp;we&nbsp;can&nbsp;apply&nbsp;the&nbsp;patch&nbsp;for&nbsp;the&nbsp;time&nbsp;being&nbsp;and&nbsp;will&nbsp;apply&nbsp;2.2.4&nbsp;soon&nbsp;as&nbsp;it&nbsp;becomes&nbsp;available.&nbsp; &lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Could&nbsp;you&nbsp;please&nbsp;also&nbsp;assist&nbsp;on&nbsp;this,&nbsp;what&nbsp;configuration&nbsp;changes&nbsp;are&nbsp;required&nbsp;to&nbsp;handle&nbsp;this?&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Regards&lt;/div&gt;&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Gagandeep&nbsp;Singh&nbsp; Sohi&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
_______________________________________________<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;<br>
&lt;/blockquote&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&gt;&lt;font&nbsp;color=&quot;#333333&quot;&gt;&lt;strong&gt;Regards,&lt;br&gt;&lt;/strong&gt;&lt;em&gt;Gagandeep&nbsp;Singh&nbsp;Sohi&lt;/em&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#333333&quot;&gt;9717920072&lt;/font&gt;&lt;/em&gt;&lt;/div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
