<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'DejaVu&nbsp;Sans';&nbsp;font-size:9pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;&lt;br&nbsp;/&gt;&lt;br&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Director&nbsp;of&nbsp;Application&nbsp;Security&nbsp;Research&lt;br&gt;<br>
Phone:&nbsp;(703)&nbsp;794-2248&lt;br&gt;<br>
Cell:&nbsp;(703)&nbsp;269-8998&lt;br&gt;<br>
Breach&nbsp;Security,&nbsp;Inc.&lt;br&gt;<br>
2141&nbsp;Palomar&nbsp;Airport&nbsp;Road,&nbsp;Suite&nbsp;200&lt;br&gt;<br>
Carlsbad,&nbsp;CA&nbsp;92011&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.breach.com/&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;text-decoration:&nbsp;underline;&nbsp;color:#0057ae;&quot;&gt;www.breach.com&lt;/span&gt;&lt;/a&gt;&lt;br&gt;<br>
&lt;br&nbsp;/&gt;On&nbsp;Tuesday&nbsp;11&nbsp;August&nbsp;2009&nbsp;06:40:43&nbsp;am&nbsp;Gil&nbsp;Vidals&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;just&nbsp;installed&nbsp;the&nbsp;latest&nbsp;core&nbsp;rules&nbsp;and&nbsp;I&nbsp;see&nbsp;this&nbsp;anomaly&nbsp;score:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&quot;@ge&nbsp;20&quot;&nbsp;\&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;What&nbsp;is&nbsp;the&nbsp;range&nbsp;of&nbsp;the&nbsp;anomaly&nbsp;scores?&nbsp;Does&nbsp;it&nbsp;go&nbsp;from&nbsp;0&nbsp;to&nbsp;100?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I&nbsp;need&nbsp;help&nbsp;in&nbsp;understanding&nbsp;the&nbsp;score&nbsp;and&nbsp;what&nbsp;to&nbsp;set&nbsp;it&nbsp;to.&nbsp;Currently&nbsp;I&lt;br&gt;<br>
&amp;gt;&nbsp;have&nbsp;it&nbsp;set&nbsp;to&nbsp;10.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;only&nbsp;documenation&nbsp;I&nbsp;could&nbsp;find&nbsp;so&nbsp;far&nbsp;is:&lt;br&gt;<br>
&amp;gt;&nbsp;#&nbsp;Uncomment&nbsp;the&nbsp;anomaly&nbsp;sections&nbsp;you&nbsp;wish&nbsp;to&nbsp;use.&lt;br&gt;<br>
&amp;gt;&nbsp;#&nbsp;You&nbsp;should&nbsp;set&nbsp;the&nbsp;score&nbsp;to&nbsp;the&nbsp;proper&nbsp;threshold&nbsp;you&nbsp;would&nbsp;prefer.&nbsp;If&lt;br&gt;<br>
&amp;gt;&nbsp;kept&nbsp;at&nbsp;&quot;@gt&nbsp;0&quot;&nbsp;#&nbsp;it&nbsp;will&nbsp;work&nbsp;similarly&nbsp;to&nbsp;previous&nbsp;Mod&nbsp;CRS&nbsp;rules&nbsp;and&nbsp;will&lt;br&gt;<br>
&amp;gt;&nbsp;create&nbsp;an&nbsp;event&nbsp;in&nbsp;the&nbsp;error_log&nbsp;#&nbsp;file&nbsp;if&nbsp;there&nbsp;are&nbsp;any&nbsp;rules&nbsp;that&nbsp;match.&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;If&nbsp;you&nbsp;would&nbsp;like&nbsp;to&nbsp;lessen&nbsp;the&nbsp;number&nbsp;of&nbsp;events&nbsp;#&nbsp;generated&nbsp;in&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;error_log&nbsp;file,&nbsp;you&nbsp;should&nbsp;increase&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;threshold&nbsp;to&nbsp;#&lt;br&gt;<br>
&amp;gt;&nbsp;something&nbsp;like&nbsp;&quot;@gt&nbsp;20&quot;.&nbsp;&nbsp;This&nbsp;would&nbsp;only&nbsp;generate&nbsp;an&nbsp;event&nbsp;in&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;error_log&nbsp;file&nbsp;if&nbsp;#&nbsp;there&nbsp;are&nbsp;multiple&nbsp;lower&nbsp;severity&nbsp;rule&nbsp;matches&nbsp;or&nbsp;if&lt;br&gt;<br>
&amp;gt;&nbsp;any&nbsp;1&nbsp;higher&nbsp;severity&nbsp;item&nbsp;matches.&nbsp;#&lt;br&gt;<br>
&amp;gt;&nbsp;#&nbsp;You&nbsp;should&nbsp;also&nbsp;set&nbsp;the&nbsp;desired&nbsp;disruptive&nbsp;action&nbsp;(deny,&nbsp;redirect,&lt;br&gt;<br>
&amp;gt;&nbsp;etc...).&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;--Gil&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Hey&nbsp;Gil,&lt;br&gt;<br>
Yeah,&nbsp;the&nbsp;OWASP&nbsp;CRS&nbsp;project&nbsp;-&nbsp;Documentation&nbsp;section&nbsp;will&nbsp;need&nbsp;to&nbsp;be&nbsp;filled&nbsp;out&nbsp;with&nbsp;this&nbsp;type&nbsp;of&nbsp;information&nbsp;about&nbsp;how&nbsp;the&nbsp;anomaly&nbsp;scoring&nbsp;works.&nbsp;&nbsp;Side&nbsp;note&nbsp;-&nbsp;one&nbsp;benefit&nbsp;of&nbsp;moving&nbsp;the&nbsp;CRS&nbsp;to&nbsp;OWASP&nbsp;is&nbsp;that&nbsp;the&nbsp;project&nbsp;is&nbsp;wiki-based&nbsp;now&nbsp;so&nbsp;anyone&nbsp;can&nbsp;help&nbsp;to&nbsp;update&nbsp;the&nbsp;documentation.&nbsp;&nbsp;So,&nbsp;if&nbsp;anyone&nbsp;wants&nbsp;to&nbsp;help&nbsp;out,&nbsp;please&nbsp;jump&nbsp;in!&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;In&nbsp;previous&nbsp;versions&nbsp;of&nbsp;the&nbsp;CRS,&nbsp;each&nbsp;rule&nbsp;was&nbsp;self-contained.&nbsp;&nbsp;This&nbsp;means&nbsp;that&nbsp;the&nbsp;rule&nbsp;would&nbsp;inspect&nbsp;the&nbsp;specified&nbsp;variable/targets&nbsp;with&nbsp;the&nbsp;operator&nbsp;data&nbsp;chosen&nbsp;(usually&nbsp;a&nbsp;regular&nbsp;expression)&nbsp;and&nbsp;then&nbsp;the&nbsp;action&nbsp;list&nbsp;would&nbsp;specify&nbsp;both&nbsp;the&nbsp;logging&nbsp;and&nbsp;blocking&nbsp;settings.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;The&nbsp;idea&nbsp;with&nbsp;new&nbsp;CRS&nbsp;is&nbsp;that&nbsp;we&nbsp;want&nbsp;the&nbsp;rules&nbsp;to&nbsp;be&nbsp;more&nbsp;collaborative&nbsp;meaning&nbsp;that&nbsp;we&nbsp;have&nbsp;decoupled&nbsp;the&nbsp;logging/blocking&nbsp;actions&nbsp;from&nbsp;the&nbsp;rules&nbsp;that&nbsp;do&nbsp;the&nbsp;initial&nbsp;inspection.&nbsp;&nbsp;Most&nbsp;of&nbsp;the&nbsp;inspection&nbsp;rules&nbsp;will&nbsp;issue&nbsp;a&nbsp;setvar&nbsp;to&nbsp;increase&nbsp;the&nbsp;TX&nbsp;anomaly&nbsp;score&nbsp;data&nbsp;for&nbsp;the&nbsp;current&nbsp;transaction&nbsp;and&nbsp;this&nbsp;score&nbsp;will&nbsp;be&nbsp;evaluated&nbsp;at&nbsp;the&nbsp;last&nbsp;possible&nbsp;request&nbsp;blocking&nbsp;point&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;phase:2.&nbsp;&nbsp;The&nbsp;scoring&nbsp;numbers&nbsp;are&nbsp;tied&nbsp;to&nbsp;the&nbsp;severity&nbsp;levels&nbsp;of&nbsp;the&nbsp;issue.&nbsp;&nbsp;Take&nbsp;a&nbsp;look&nbsp;at&nbsp;the&nbsp;updated&nbsp;Severity&nbsp;data&nbsp;from&nbsp;the&nbsp;CHANGELOG&nbsp;file&nbsp;-&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;-&nbsp;Updated&nbsp;Severity&nbsp;Ratings&lt;/span&gt;&lt;br&gt;<br>
&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;severity&nbsp;ratings&nbsp;in&nbsp;the&nbsp;rules&nbsp;have&nbsp;been&nbsp;updated&nbsp;to&nbsp;the&nbsp;following:&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;0:&nbsp;Emergency&nbsp;-&nbsp;is&nbsp;generated&nbsp;from&nbsp;correlation&nbsp;where&nbsp;there&nbsp;is&nbsp;an&nbsp;inbound&nbsp;attack&nbsp;and&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;an&nbsp;outbound&nbsp;leakage.&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;1:&nbsp;Alert&nbsp;-&nbsp;is&nbsp;generated&nbsp;from&nbsp;correlation&nbsp;where&nbsp;there&nbsp;is&nbsp;an&nbsp;inbound&nbsp;attack&nbsp;and&nbsp;an&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outbound&nbsp;application&nbsp;level&nbsp;error.&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;2:&nbsp;Critical&nbsp;-&nbsp;is&nbsp;the&nbsp;highest&nbsp;severity&nbsp;level&nbsp;possible&nbsp;without&nbsp;correlation.&nbsp;&nbsp;It&nbsp;is&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;normally&nbsp;generated&nbsp;by&nbsp;the&nbsp;web&nbsp;attack&nbsp;rules&nbsp;(40&nbsp;level&nbsp;files).&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;3:&nbsp;Error&nbsp;-&nbsp;is&nbsp;generated&nbsp;mostly&nbsp;from&nbsp;outbound&nbsp;leakage&nbsp;rules&nbsp;(50&nbsp;level&nbsp;files).&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;4:&nbsp;Warning&nbsp;-&nbsp;is&nbsp;generated&nbsp;by&nbsp;malicious&nbsp;client&nbsp;rules&nbsp;(35&nbsp;level&nbsp;files).&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;5:&nbsp;Notice&nbsp;-&nbsp;is&nbsp;generated&nbsp;by&nbsp;the&nbsp;Protocol&nbsp;policy&nbsp;and&nbsp;anomaly&nbsp;files.&lt;/span&gt;&lt;/pre&gt;&lt;pre&nbsp;style=&quot;&nbsp;margin-top:0px;&nbsp;margin-bottom:12px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;span&nbsp;style=&quot;&nbsp;font-family:'Courier&nbsp;New,courier';&quot;&gt;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;6:&nbsp;Info&nbsp;-&nbsp;is&nbsp;generated&nbsp;by&nbsp;the&nbsp;search&nbsp;engine&nbsp;clients&nbsp;(55&nbsp;marketing&nbsp;file).&nbsp;&lt;/span&gt;&lt;/pre&gt;The&nbsp;normal&nbsp;web&nbsp;attack&nbsp;categories&nbsp;(such&nbsp;as&nbsp;XSS&nbsp;and&nbsp;SQL&nbsp;Injection,&nbsp;etc...)&nbsp;have&nbsp;a&nbsp;severity&nbsp;of&nbsp;2/Critical&nbsp;and&nbsp;will&nbsp;increase&nbsp;the&nbsp;score&nbsp;by&nbsp;20&nbsp;points.&nbsp;&nbsp;3/Error&nbsp;=&nbsp;15&nbsp;points,&nbsp;4/Warning&nbsp;=&nbsp;10&nbsp;points&nbsp;and&nbsp;5/Notice&nbsp;is&nbsp;5&nbsp;points.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;So,&nbsp;what&nbsp;all&nbsp;of&nbsp;this&nbsp;means,&nbsp;in&nbsp;relation&nbsp;to&nbsp;the&nbsp;modsecurity_49_enforcement.conf&nbsp;file,&nbsp;is&nbsp;that&nbsp;you&nbsp;can&nbsp;set&nbsp;an&nbsp;anomaly&nbsp;scoring&nbsp;threshold&nbsp;that&nbsp;you&nbsp;deem&nbsp;appropriate&nbsp;for&nbsp;your&nbsp;site.&nbsp;&nbsp;These&nbsp;thresholds&nbsp;can&nbsp;control&nbsp;logging&nbsp;and/or&nbsp;blocking.&nbsp;&nbsp;For&nbsp;instance,&nbsp;let's&nbsp;say&nbsp;that&nbsp;you&nbsp;don't&nbsp;really&nbsp;care&nbsp;about&nbsp;clients&nbsp;that&nbsp;are&nbsp;missing&nbsp;1&nbsp;or&nbsp;2&nbsp;request&nbsp;headers&nbsp;(which&nbsp;is&nbsp;something&nbsp;that&nbsp;is&nbsp;flagged&nbsp;in&nbsp;the&nbsp;21&nbsp;protocol&nbsp;anomalies&nbsp;file),&nbsp;then&nbsp;you&nbsp;should&nbsp;set&nbsp;your&nbsp;anomaly&nbsp;score&nbsp;at&nbsp;15.&nbsp;&nbsp;This&nbsp;means&nbsp;that&nbsp;if&nbsp;a&nbsp;client&nbsp;violates&nbsp;any&nbsp;2&nbsp;of&nbsp;the&nbsp;severity&nbsp;5&nbsp;rules,&nbsp;this&nbsp;would&nbsp;only&nbsp;amount&nbsp;to&nbsp;an&nbsp;anomaly&nbsp;score&nbsp;of&nbsp;10.&nbsp;&nbsp;If,&nbsp;however,&nbsp;they&nbsp;violate&nbsp;any&nbsp;3&nbsp;severity&nbsp;5&nbsp;issues,&nbsp;then&nbsp;they&nbsp;would&nbsp;trigger.&nbsp;&nbsp;In&nbsp;the&nbsp;previous&nbsp;CRS,&nbsp;the&nbsp;XSS/SQLi&nbsp;types&nbsp;of&nbsp;rules&nbsp;issued&nbsp;blocking&nbsp;actions&nbsp;so&nbsp;that&nbsp;is&nbsp;why&nbsp;the&nbsp;comment&nbsp;section&nbsp;above&nbsp;mentions&nbsp;setting&nbsp;the&nbsp;score&nbsp;to&nbsp;20.&nbsp;&nbsp;This&nbsp;would&nbsp;result&nbsp;in&nbsp;an&nbsp;anomaly&nbsp;scoring&nbsp;match&nbsp;if&nbsp;*any*&nbsp;severity&nbsp;2&nbsp;rule&nbsp;matches.&lt;br&gt;<br>
&nbsp;&lt;br&gt;<br>
Another&nbsp;item&nbsp;to&nbsp;consider&nbsp;with&nbsp;anomaly&nbsp;scoring&nbsp;and&nbsp;that&nbsp;is&nbsp;that&nbsp;you&nbsp;can&nbsp;actually&nbsp;combine&nbsp;2&nbsp;issues&nbsp;together&nbsp;-&nbsp;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;1)&nbsp;Confidence&nbsp;level&nbsp;in&nbsp;blocking&lt;br&gt;<br>
Due&nbsp;to&nbsp;the&nbsp;fact&nbsp;that&nbsp;we&nbsp;have&nbsp;broken&nbsp;out&nbsp;the&nbsp;highly&nbsp;optimized&nbsp;regex,&nbsp;this&nbsp;means&nbsp;that&nbsp;we&nbsp;have&nbsp;many&nbsp;more&nbsp;individual&nbsp;rules&nbsp;that&nbsp;could&nbsp;possibly&nbsp;contribute&nbsp;to&nbsp;an&nbsp;anomaly&nbsp;score.&nbsp;&nbsp;This&nbsp;means&nbsp;that&nbsp;the&nbsp;*higher*&nbsp;the&nbsp;anomaly&nbsp;score,&nbsp;the&nbsp;more&nbsp;confident&nbsp;you&nbsp;can&nbsp;be&nbsp;that&nbsp;something&nbsp;malicious&nbsp;is&nbsp;being&nbsp;detected.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;2)&nbsp;Handling&nbsp;exceptions&lt;br&gt;<br>
If&nbsp;you&nbsp;are&nbsp;running&nbsp;into&nbsp;a&nbsp;false&nbsp;positive&nbsp;match,&nbsp;for&nbsp;say&nbsp;an&nbsp;XSS&nbsp;attack,&nbsp;against&nbsp;one&nbsp;particular&nbsp;parameter&nbsp;payload&nbsp;in&nbsp;your&nbsp;app,&nbsp;chances&nbsp;are&nbsp;that&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;for&nbsp;it&nbsp;is&nbsp;rather&nbsp;low&nbsp;and&nbsp;is&nbsp;just&nbsp;barely&nbsp;going&nbsp;over&nbsp;it.&nbsp;&nbsp;An&nbsp;exception&nbsp;may&nbsp;be&nbsp;as&nbsp;easy&nbsp;as&nbsp;bumping&nbsp;up&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;by&nbsp;20&nbsp;points.&nbsp;&nbsp;There&nbsp;are&nbsp;other&nbsp;exceptions&nbsp;mechanisms&nbsp;(that&nbsp;we&nbsp;will&nbsp;document&nbsp;later&nbsp;on&nbsp;the&nbsp;OWASP&nbsp;site)&nbsp;that&nbsp;are&nbsp;easy&nbsp;as&nbsp;well&nbsp;but&nbsp;this&nbsp;is&nbsp;the&nbsp;easiest.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;Hopefully&nbsp;this&nbsp;info&nbsp;helps.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;--&nbsp;&lt;br&gt;<br>
Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;<br>
WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;<br>
http://tacticalwebappsec.blogspot.com&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
