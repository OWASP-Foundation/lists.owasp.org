<tt>
Ryan,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;looks&nbsp;great!&nbsp;I&#39;m&nbsp;a&nbsp;big&nbsp;fan&nbsp;of&nbsp;human readable code,&nbsp;and&nbsp;this&nbsp;will&nbsp;be&nbsp;important&nbsp;as&nbsp;users&nbsp;need&nbsp;to&nbsp;analyze&nbsp;false positives.&nbsp;I&nbsp;like&nbsp;it.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Just&nbsp;curious,&nbsp;could&nbsp;this&nbsp;have&nbsp;any&nbsp;impact&nbsp;on performance?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;Best,&lt;br&gt;&lt;br&gt;Matt&nbsp;Thomas&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Founder &lt;/span&gt;&lt;a&nbsp;href=&quot;http://betweenbrain.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;betweenbrain&lt;/a&gt;™&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;arial,&nbsp;sans-serif&quot;&gt;Lead&nbsp;Developer &lt;/font&gt;&lt;a&nbsp;href=&quot;http://construct-framework.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;Construct&nbsp;Template&nbsp;Development&nbsp;Framework&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Phone:&nbsp;203.632.9322&lt;br&gt;<br>
Twitter:&nbsp;@betweenbrain&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-family:arial,sans-serif;font-size:13px;background-color:rgb(255,255,255)&quot;&gt;Github: &lt;/span&gt;&lt;a&nbsp;href=&quot;https://github.com/betweenbrain&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/betweenbrain&lt;/a&gt;&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Mar&nbsp;13,&nbsp;2012&nbsp;at&nbsp;3:49&nbsp;PM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
I&nbsp;am&nbsp;working&nbsp;on&nbsp;updating&nbsp;the&nbsp;current&nbsp;CRS&nbsp;SecRule&nbsp;formatting.&nbsp; The&nbsp;idea&nbsp;is&lt;br&gt;<br>
to&nbsp;make&nbsp;the&nbsp;rules&nbsp;easier&nbsp;to&nbsp;read&nbsp;and&nbsp;understand&nbsp;what&nbsp;is&nbsp;happening,&nbsp;for&lt;br&gt;<br>
example&nbsp;to&nbsp;quickly&nbsp;understand&nbsp;the&nbsp;ACTION&nbsp;line&nbsp;data.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;format&nbsp;is&nbsp;updated&nbsp;to:&lt;br&gt;<br>
&lt;br&gt;<br>
1)&nbsp;Separate&nbsp;the&nbsp;VARIABLE&nbsp;OPERATOR&nbsp;and&nbsp;ACTION&nbsp;sections&nbsp;from&nbsp;each&nbsp;other&nbsp;by&lt;br&gt;<br>
using&nbsp;the&nbsp;Apache&nbsp;\&nbsp;line&nbsp;continuation&nbsp;character.&lt;br&gt;<br>
2)&nbsp;The&nbsp;1st&nbsp;ACTION&nbsp;line&nbsp;starts&nbsp;with&nbsp;the&nbsp;rule&nbsp;ID.&nbsp; This&nbsp;makes&nbsp;it&nbsp;easier&nbsp;to&lt;br&gt;<br>
find&nbsp;rules&nbsp;of&nbsp;interest.&lt;br&gt;<br>
3)&nbsp;The&nbsp;end&nbsp;of&nbsp;the&nbsp;1st&nbsp;ACTION&nbsp;line&nbsp;lists&nbsp;any&nbsp;disruptive&nbsp;actions.&lt;br&gt;<br>
4)&nbsp;Transformation&nbsp;functions&nbsp;have&nbsp;their&nbsp;own&nbsp;line&lt;br&gt;<br>
5)&nbsp;Tags&nbsp;have&nbsp;their&nbsp;own&nbsp;line&lt;br&gt;<br>
6)&nbsp;Meta-actions&nbsp;(such&nbsp;as&nbsp;setvars)&nbsp;have&nbsp;their&nbsp;own&nbsp;line&lt;br&gt;<br>
7)&nbsp;Also&nbsp;including&nbsp;example&nbsp;attack&nbsp;payloads&nbsp;that&nbsp;are&nbsp;detected&nbsp;by&nbsp;the&lt;br&gt;<br>
OPERATOR&nbsp;to&nbsp;help&nbsp;understand&nbsp;what&nbsp;the&nbsp;regex&nbsp;is&nbsp;looking&nbsp;form&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;review/comment&nbsp;on&nbsp;the&nbsp;updated&nbsp;format&nbsp;below.&nbsp; I&nbsp;would&nbsp;like&nbsp;to&nbsp;start&lt;br&gt;<br>
updating&nbsp;the&nbsp;CRS&nbsp;rules&nbsp;to&nbsp;use&nbsp;this&nbsp;format&nbsp;for&nbsp;the&nbsp;3.0&nbsp;version.&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabsModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
#####################################&lt;br&gt;<br>
#&lt;br&gt;<br>
#&nbsp;Example&nbsp;Payloads&nbsp;Detected:&lt;br&gt;<br>
#&nbsp;-------------------------&lt;br&gt;<br>
#&nbsp;&#39;&nbsp;or&nbsp;1=1#&lt;br&gt;<br>
#&nbsp;&#39;)&nbsp;or&nbsp;(&#39;1&#39;=&#39;1--&lt;br&gt;<br>
#&nbsp;1&nbsp;OR&nbsp;\&#39;1\&#39;!=0&lt;br&gt;<br>
#&nbsp;aaa\&#39;&nbsp;or&nbsp;(1)=(1)&nbsp;#!asd&lt;br&gt;<br>
#&nbsp;aaa\&#39;&nbsp;OR&nbsp;(1)&nbsp;IS&nbsp;NOT&nbsp;NULL&nbsp;#!asd&lt;br&gt;<br>
#&nbsp;&#39;&nbsp;=+&nbsp;&#39;&lt;br&gt;<br>
#&nbsp;asd&#39;&nbsp;=-&nbsp;(-&#39;asd&#39;)&nbsp;--&nbsp;-a&lt;br&gt;<br>
#&nbsp;aa&quot;&nbsp;=+&nbsp;-&nbsp;&quot;0&lt;br&gt;<br>
#&nbsp;asd&quot;or-1=&quot;-1&lt;br&gt;<br>
#&nbsp;asd&quot;or!1=&quot;!1&lt;br&gt;<br>
#&nbsp;asd&quot;or!(1)=&quot;1&lt;br&gt;<br>
#&nbsp;asd&quot;&nbsp;or&nbsp;ascii(1)=&quot;49&lt;br&gt;<br>
#&nbsp;asd&#39;&nbsp;or&nbsp;md5(5)^&#39;1&lt;br&gt;<br>
#&nbsp;\&quot;asd&quot;&nbsp;or&nbsp;1=&quot;1&lt;br&gt;<br>
#&nbsp;&#39;&nbsp;or&nbsp;id=&nbsp;1&nbsp;having&nbsp;1&nbsp;#1&nbsp;!&lt;br&gt;<br>
#&nbsp;&#39;&nbsp;or&nbsp;id=&nbsp;2-1&nbsp;having&nbsp;1&nbsp;#1&nbsp;!&lt;br&gt;<br>
#&nbsp;aa&#39;or&nbsp;BINARY&nbsp;1=&nbsp;&#39;1&lt;br&gt;<br>
#&nbsp;aa&#39;like-&#39;aa&lt;br&gt;<br>
#&nbsp;-------------------------&lt;br&gt;<br>
#&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&lt;br&gt;<br>
REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:&lt;br&gt;<br>
/*&nbsp;\&lt;br&gt;<br>
\&lt;br&gt;<br>
&quot;(?i)(?i:\d[\&quot;&#39;`´¹Œ]\s+[\&quot;&#39;`´¹Œ]\s+\d)|(?:^admin\s*?[\&quot;&#39;`´¹Œ]|(\/\*)+[\&quot;&#39;`&lt;br&gt;<br>
´¹Œ]+\s?(?:--|#|\/\*|{)?)|(?:[\&quot;&#39;`´¹Œ]\s*?(x?or|div|like|between|and)[\w\s-&lt;br&gt;<br>
]+\s*?[+&lt;&gt;=(),-]\s*?[\d\&quot;&#39;`´¹Œ])|(?:[\&quot;&#39;`´¹Œ]\s*?[^\w\s]?=\s*?[\&quot;&#39;`´¹Œ])|(?&lt;br&gt;<br>
:[\&quot;&#39;`´¹Œ]\W*?[+=]+\W*?[\&quot;&#39;`´¹Œ])|(?:[\&quot;&#39;`´¹Œ]\s*?[!=|][\d\s!=+-]+.*?[\&quot;&#39;`&lt;br&gt;<br>
´¹Œ(].*?$)|(?:[\&quot;&#39;`´¹Œ]\s*?[!=|][\d\s!=]+.*?\d+$)|(?:[\&quot;&#39;`´¹Œ]\s*?like\W+[\&lt;br&gt;<br>
w\&quot;&#39;`´¹Œ(])|(?:\sis\s*?0\W)|(?:where\s[\s\w\.,-]+\s=)|(?:[\&quot;&#39;`´¹Œ][&lt;&gt;~]+[\&quot;&lt;br&gt;<br>
&#39;`´¹Œ])&quot;&nbsp;\&lt;br&gt;<br>
\&lt;br&gt;<br>
&quot;id:&#39;981244&#39;,msg:&#39;Detects&nbsp;basic&nbsp;SQL&nbsp;authentication&nbsp;bypass&nbsp;attempts&lt;br&gt;<br>
1/3&#39;,logdata:&#39;%{TX.0}&#39;,severity:&#39;2&#39;,phase:2,capture,block,&nbsp;\&lt;br&gt;<br>
t:none,t:urlDecodeUni,&nbsp;\&lt;br&gt;<br>
tag:&#39;WEB_ATTACK/SQLI&#39;,&nbsp;\&lt;br&gt;<br>
setvar:&#39;tx.msg=%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-%{rule.msg}&#39;,&nbsp;\&lt;br&gt;<br>
setvar:&#39;tx.%{tx.msg}-WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}&#39;&nbsp;\&lt;br&gt;<br>
setvar:tx.sql_injection_score=+1,&nbsp;\&lt;br&gt;<br>
setvar:tx.anomaly_score=+%{tx.critical_anomaly_score}&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
