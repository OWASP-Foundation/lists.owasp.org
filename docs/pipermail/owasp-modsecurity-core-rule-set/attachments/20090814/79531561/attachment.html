<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'DejaVu&nbsp;Sans';&nbsp;font-size:9pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;On&nbsp;Thursday&nbsp;13&nbsp;August&nbsp;2009&nbsp;09:42:38&nbsp;pm&nbsp;Junyong&nbsp;Jiang&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Ryan,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Thanks&nbsp;for&nbsp;your&nbsp;reply.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Yes,&nbsp;the&nbsp;client&nbsp;client&nbsp;uses&nbsp;a&nbsp;file&nbsp;upload&nbsp;interface&nbsp;to&nbsp;upload&nbsp;a&nbsp;file,&nbsp;for&lt;br&gt;<br>
&amp;gt;&nbsp;example&nbsp;a.asp.&nbsp;Then&nbsp;he&nbsp;access&nbsp;a.asp&nbsp;and&nbsp;excute&nbsp;the&nbsp;code&nbsp;in&nbsp;a.asp.&nbsp;I&nbsp;do&nbsp;not&lt;br&gt;<br>
&amp;gt;&nbsp;know&nbsp;how&nbsp;to&nbsp;prevent&nbsp;the&nbsp;attack.&nbsp;Can&nbsp;we&nbsp;check&nbsp;the&nbsp;upload-file's&nbsp;type&nbsp;when&lt;br&gt;<br>
&amp;gt;&nbsp;client&nbsp;upload&nbsp;this&nbsp;file?&nbsp;sometimes,&nbsp;the&nbsp;attacker&nbsp;may&nbsp;modify&nbsp;the&nbsp;suffix&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;file&nbsp;for&nbsp;cheating&nbsp;de&nbsp;file-suffix&nbsp;checking.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Could&nbsp;you&nbsp;give&nbsp;me&nbsp;some&nbsp;advice?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;The&nbsp;CRS&nbsp;already&nbsp;has&nbsp;backdoor&nbsp;access&nbsp;rules&nbsp;in&nbsp;the&nbsp;modsecurity_crs_45_trojans.conf&nbsp;file.&nbsp;&nbsp;These&nbsp;rules&nbsp;will&nbsp;identify&nbsp;if/when&nbsp;a&nbsp;client&nbsp;tries&nbsp;to&nbsp;access&nbsp;a&nbsp;backdoor&nbsp;webpage.&nbsp;&nbsp;These&nbsp;rules&nbsp;are&nbsp;important&nbsp;as&nbsp;users&nbsp;can&nbsp;possibly&nbsp;upload&nbsp;these&nbsp;files&nbsp;through&nbsp;non-web&nbsp;protocols&nbsp;(FTP,&nbsp;etc...).&nbsp;&nbsp;In&nbsp;your&nbsp;case,&nbsp;however,&nbsp;you&nbsp;want&nbsp;to&nbsp;prevent&nbsp;the&nbsp;files&nbsp;from&nbsp;being&nbsp;uploaded&nbsp;through&nbsp;the&nbsp;web&nbsp;interface&nbsp;to&nbsp;begin&nbsp;with.&nbsp;&nbsp;What&nbsp;you&nbsp;could&nbsp;possibly&nbsp;do&nbsp;is&nbsp;to&nbsp;take&nbsp;the&nbsp;trojan&nbsp;access&nbsp;rules&nbsp;from&nbsp;the&nbsp;45&nbsp;file&nbsp;and&nbsp;apply&nbsp;the&nbsp;same&nbsp;signatures&nbsp;to&nbsp;the&nbsp;REQUEST_BODY&nbsp;variable&nbsp;instead&nbsp;of&nbsp;RESPONSE_BODY.&nbsp;&nbsp;This&nbsp;may&nbsp;work&nbsp;somewhat&nbsp;but&nbsp;it&nbsp;is&nbsp;not&nbsp;foolproof.&nbsp;&nbsp;If&nbsp;you&nbsp;have&nbsp;some&nbsp;examples&nbsp;of&nbsp;the&nbsp;backdoor&nbsp;html&nbsp;code,&nbsp;you&nbsp;could&nbsp;create&nbsp;some&nbsp;rules&nbsp;based&nbsp;on&nbsp;it.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;-Ryan&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
