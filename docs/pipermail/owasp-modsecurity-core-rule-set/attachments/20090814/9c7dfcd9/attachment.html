<tt>
&lt;div&gt;Ryan,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;for&nbsp;your&nbsp;reply.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Yes,&nbsp;the&nbsp;client client&nbsp;uses&nbsp;a&nbsp;file&nbsp;upload&nbsp;interface to&nbsp;upload&nbsp;a&nbsp;file, for&nbsp;example&nbsp;a.asp.&nbsp;Then&nbsp;he access&nbsp;a.asp&nbsp;and excute&nbsp;the&nbsp;code&nbsp;in&nbsp;a.asp.&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;do&nbsp;not&nbsp;know&nbsp;how&nbsp;to&nbsp;prevent&nbsp;the&nbsp;attack.&nbsp;Can&nbsp;we&nbsp;check&nbsp;the&nbsp;upload-file&amp;#39;s&nbsp;type&nbsp;when&nbsp;client&nbsp;upload&nbsp;this&nbsp;file?&nbsp;sometimes,&nbsp;the&nbsp;attacker&nbsp;may&nbsp;modify&nbsp;the&nbsp;suffix&nbsp;of&nbsp;the&nbsp;file&nbsp;for&nbsp;cheating&nbsp;de&nbsp;file-suffix&nbsp;checking.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Could&nbsp;you&nbsp;give&nbsp;me&nbsp;some&nbsp;advice?&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;br&gt; &lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/8/13&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ryan.barnett@breach.com&quot;&gt;ryan.barnett@breach.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;<br>
&lt;div&nbsp;style=&quot;FONT-WEIGHT:&nbsp;400;&nbsp;FONT-SIZE:&nbsp;9pt;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;FONT-FAMILY:&nbsp;&amp;#39;DejaVu&nbsp;Sans&amp;#39;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;Thursday&nbsp;13&nbsp;August&nbsp;2009&nbsp;05:02:47&nbsp;am&nbsp;Junyong&nbsp;Jiang&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;Dear&nbsp;all,&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Right&nbsp;now,&nbsp;I&nbsp;have&nbsp;a&nbsp;problem&nbsp;with&nbsp;the&nbsp;file&nbsp;upload&nbsp;with&nbsp;trojan&nbsp;horse.&lt;br&gt;&amp;gt;&nbsp;Unfortunately,&nbsp;there&nbsp;are&nbsp;no&nbsp;modsecurity&nbsp;rules&nbsp;for&nbsp;checking&nbsp;the&nbsp;upload-file&lt;br&gt;<br>
&amp;gt;&nbsp;contents,&nbsp;either&nbsp;the&nbsp;file&nbsp;type.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Could&nbsp;some&nbsp;one&nbsp;offer&nbsp;your&nbsp;own&nbsp;testing&nbsp;rules&nbsp;of&nbsp;detecting&nbsp;the&nbsp;&amp;quot;file&nbsp;upload&lt;br&gt;&amp;gt;&nbsp;with&nbsp;trojan&nbsp;horse&amp;quot;&nbsp;behavior&nbsp;for&nbsp;me&nbsp;to&nbsp;study?&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Thanks&nbsp;in&nbsp;advance.&lt;br&gt;<br>
<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;Could&nbsp;you&nbsp;please&nbsp;provide&nbsp;more&nbsp;details&nbsp;about&nbsp;what&nbsp;the&nbsp;issue&nbsp;is?&nbsp;I&nbsp;am&nbsp;guessing&nbsp;that&nbsp;you&nbsp;want&nbsp;to&nbsp;try&nbsp;and&nbsp;identify&nbsp;is&nbsp;a&nbsp;client&nbsp;uses&nbsp;a&nbsp;file&nbsp;upload&nbsp;interface&nbsp;(that&nbsp;your&nbsp;application&nbsp;offers)&nbsp;to&nbsp;upload&nbsp;a&nbsp;webpage&nbsp;that&nbsp;allows&nbsp;for&nbsp;executing&nbsp;OS&nbsp;commands,&nbsp;etc...&nbsp;Is&nbsp;this&nbsp;accurate?&nbsp;&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;--&nbsp;&lt;br&gt;Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;&lt;a&nbsp;href=&quot;http://tacticalwebappsec.blogspot.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://tacticalwebappsec.blogspot.com&lt;/a&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
