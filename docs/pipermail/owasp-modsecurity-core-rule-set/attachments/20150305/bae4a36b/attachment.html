<tt>
<br>
&lt;div&gt;. &lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;mailbox_signature&quot;&gt;<br>
&lt;br&gt;—&lt;br&gt;Sent&nbsp;from&nbsp;my&nbsp;phone&lt;/div&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;p&gt;On&nbsp;Thu,&nbsp;Mar&nbsp;5,&nbsp;2015&nbsp;at&nbsp;4:06&nbsp;AM,&nbsp;owasp-modsecurity-core-rule-set-request@lists.owasp.org&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set-request@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-modsecurity-core-rule-set-request@lists.owasp.org&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;/p&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;&lt;p&gt;Send&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org<br>
&lt;br&gt;&lt;br&gt;To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set<br>
&lt;br&gt;&lt;br&gt;or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;'help'&nbsp;to<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owasp-modsecurity-core-rule-set-request@lists.owasp.org<br>
&lt;br&gt;&lt;br&gt;You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;owasp-modsecurity-core-rule-set-owner@lists.owasp.org<br>
&lt;br&gt;&lt;br&gt;When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific<br>
&lt;br&gt;than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;Owasp-modsecurity-core-rule-set&nbsp;digest...&quot;<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;Today's&nbsp;Topics:<br>
&lt;br&gt;&lt;br&gt;&nbsp;&nbsp;&nbsp;1.&nbsp;ModSecurity&nbsp;cPanel&nbsp;Reporting&nbsp;&nbsp;Capabilities&nbsp;(Chaim&nbsp;Sanders)<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;2.&nbsp;Re:&nbsp;Successful&nbsp;Redirect&nbsp;Attack&nbsp;Scoring&nbsp;only&nbsp;3&nbsp;with&nbsp;Core&nbsp;Rules<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(any&nbsp;clue?)&nbsp;(Christian&nbsp;Folini)<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;----------------------------------------------------------------------<br>
&lt;br&gt;&lt;br&gt;Message:&nbsp;1<br>
&lt;br&gt;Date:&nbsp;Wed,&nbsp;4&nbsp;Mar&nbsp;2015&nbsp;21:36:56&nbsp;+0000<br>
&lt;br&gt;From:&nbsp;Chaim&nbsp;Sanders&nbsp;&lt;CSanders@trustwave.com&gt;<br>
&lt;br&gt;To:&nbsp;&quot;owasp-modsecurity-core-rule-set@lists.owasp.org&quot;<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;owasp-modsecurity-core-rule-set@lists.owasp.org&gt;<br>
&lt;br&gt;Subject:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;ModSecurity&nbsp;cPanel<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Reporting&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Capabilities<br>
&lt;br&gt;Message-ID:<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;F684BDD553BAF1479F5380EDAD3BE37101048EA2@SKYMB1.trustwave.com&gt;<br>
&lt;br&gt;Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;us-ascii&quot;<br>
&lt;br&gt;&lt;br&gt;Are&nbsp;you&nbsp;using&nbsp;OWASP&nbsp;CRS&nbsp;and&nbsp;cPanel?&nbsp;We&nbsp;are&nbsp;happy&nbsp;to&nbsp;announce&nbsp;that&nbsp;cPanel&nbsp;has&nbsp;just&nbsp;added&nbsp;the&nbsp;ability&nbsp;to&nbsp;'Report&nbsp;a&nbsp;Rule'.&nbsp;We&nbsp;are&nbsp;very&nbsp;excited&nbsp;about&nbsp;this&nbsp;new&nbsp;feature&nbsp;because,&nbsp;as&nbsp;we&nbsp;all&nbsp;know,&nbsp;a&nbsp;WAF&nbsp;is&nbsp;only&nbsp;as&nbsp;good&nbsp;as&nbsp;its&nbsp;ruleset.&nbsp;If&nbsp;you&nbsp;are&nbsp;using&nbsp;cPanel&nbsp;with&nbsp;OWASP&nbsp;CRS&nbsp;and&nbsp;you&nbsp;find&nbsp;that&nbsp;a&nbsp;rule&nbsp;is&nbsp;not&nbsp;working&nbsp;correctly&nbsp;we&nbsp;highly&nbsp;encourage&nbsp;you&nbsp;to&nbsp;follow&nbsp;the&nbsp;steps&nbsp;outlined&nbsp;at&nbsp;https://documentation.cpanel.net/display/ALD/ModSecurity+Tools#ModSecurityTools-Reportarule.&nbsp;This&nbsp;will&nbsp;file&nbsp;a&nbsp;report&nbsp;about&nbsp;the&nbsp;rule&nbsp;directly&nbsp;with&nbsp;the&nbsp;ModSecurity&nbsp;team&nbsp;and&nbsp;we&nbsp;will&nbsp;do&nbsp;our&nbsp;best&nbsp;to&nbsp;quickly&nbsp;address&nbsp;the&nbsp;concern.&nbsp;We'd&nbsp;like&nbsp;to&nbsp;thank&nbsp;the&nbsp;cPanel&nbsp;team&nbsp;for&nbsp;going&nbsp;the&nbsp;extra&nbsp;mile&nbsp;in&nbsp;implementing&nbsp;this&nbsp;feature,&nbsp;we&nbsp;really&nbsp;do&nbsp;think&nbsp;it&nbsp;will&nbsp;make&nbsp;everyone&nbsp;more&nbsp;secure.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;using&nbsp;cPanel&nbsp;please&nbsp;remember&nbsp;to&nbsp;open&nbsp;issues&nbsp;on&nbsp;GitHub&nbsp;or&nbsp;email&nbsp;the&nbsp;mailing&nbsp;list&nbsp;if&nbsp;you&nbsp;find&nbsp;a&nbsp;bug.&nbsp;We&nbsp;are&nbsp;always&nbsp;on&nbsp;the&nbsp;lookout&nbsp;for&nbsp;how&nbsp;to&nbsp;improve&nbsp;our&nbsp;rules.<br>
&lt;br&gt;&lt;br&gt;Chaim&nbsp;Sanders<br>
&lt;br&gt;Security&nbsp;Researcher,&nbsp;SpiderLabs<br>
&lt;br&gt;&lt;br&gt;Trustwave&nbsp;|&nbsp;SMART&nbsp;SECURITY&nbsp;ON&nbsp;DEMAND<br>
&lt;br&gt;www.trustwave.com&lt;http://www.trustwave.com/&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;________________________________<br>
&lt;br&gt;&lt;br&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.<br>
&lt;br&gt;--------------&nbsp;next&nbsp;part&nbsp;--------------<br>
&lt;br&gt;An&nbsp;HTML&nbsp;attachment&nbsp;was&nbsp;scrubbed...<br>
&lt;br&gt;URL:&nbsp;&lt;http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150304/ecf963fe/attachment-0001.html&gt;<br>
&lt;br&gt;&lt;br&gt;------------------------------<br>
&lt;br&gt;&lt;br&gt;Message:&nbsp;2<br>
&lt;br&gt;Date:&nbsp;Thu,&nbsp;5&nbsp;Mar&nbsp;2015&nbsp;09:32:56&nbsp;+0100<br>
&lt;br&gt;From:&nbsp;Christian&nbsp;Folini&nbsp;&lt;christian.folini@time-machine.ch&gt;<br>
&lt;br&gt;To:&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org<br>
&lt;br&gt;Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Successful&nbsp;Redirect<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Attack&nbsp;Scoring&nbsp;only&nbsp;3&nbsp;with&nbsp;Core&nbsp;Rules&nbsp;(any&nbsp;clue?)<br>
&lt;br&gt;Message-ID:&nbsp;&lt;20150305083256.GA14398@elias&gt;<br>
&lt;br&gt;Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8<br>
&lt;br&gt;&lt;br&gt;Hi&nbsp;Achim,<br>
&lt;br&gt;&lt;br&gt;Good&nbsp;to&nbsp;hear&nbsp;from&nbsp;you.&nbsp;Unfortunately,&nbsp;nobody&nbsp;else&nbsp;responded.&nbsp;We'll<br>
&lt;br&gt;see&nbsp;how&nbsp;far&nbsp;we&nbsp;can&nbsp;get.<br>
&lt;br&gt;&lt;br&gt;On&nbsp;Tue,&nbsp;Mar&nbsp;03,&nbsp;2015&nbsp;at&nbsp;09:00:35AM&nbsp;+0100,&nbsp;Achim&nbsp;wrote:<br>
&lt;br&gt;&gt;&nbsp;this&nbsp;is&nbsp;a&nbsp;typical&nbsp;&quot;header&nbsp;injection&quot;&nbsp;attack.&nbsp;AFAIK&nbsp;CRS&nbsp;has&nbsp;no&nbsp;spezial<br>
&lt;br&gt;&gt;&nbsp;rules&nbsp;for&nbsp;that.&nbsp;What&nbsp;best&nbsp;fits&nbsp;is&nbsp;the&nbsp;HTTP&nbsp;Response&nbsp;Splitting&nbsp;rule&nbsp;950911,<br>
&lt;br&gt;&gt;&nbsp;but&nbsp;it&nbsp;is&nbsp;far&nbsp;to&nbsp;specific&nbsp;to&nbsp;match&nbsp;in&nbsp;this&nbsp;case.<br>
&lt;br&gt;&lt;br&gt;You&nbsp;hit&nbsp;the&nbsp;nail&nbsp;on&nbsp;the&nbsp;head.&nbsp;We&nbsp;first&nbsp;had&nbsp;a&nbsp;response&nbsp;splitting<br>
&lt;br&gt;vulnerability.&nbsp;Then&nbsp;we&nbsp;lowered&nbsp;the&nbsp;limit&nbsp;(which&nbsp;had&nbsp;been&nbsp;raised&nbsp;by<br>
&lt;br&gt;a&nbsp;sysadmin&nbsp;on&nbsp;his&nbsp;own),&nbsp;then&nbsp;the&nbsp;pen-tester&nbsp;worked&nbsp;around&nbsp;the&nbsp;lower<br>
&lt;br&gt;limit&nbsp;with&nbsp;this&nbsp;redirect&nbsp;vulnerability&nbsp;scoring&nbsp;3&nbsp;on&nbsp;the&nbsp;core&nbsp;ruleset.<br>
&lt;br&gt;&lt;br&gt;&gt;&nbsp;I'd&nbsp;suggest&nbsp;to&nbsp;craft&nbsp;a&nbsp;new&nbsp;set&nbsp;of&nbsp;rules&nbsp;for&nbsp;header&nbsp;injections.<br>
&lt;br&gt;&lt;br&gt;I&nbsp;think&nbsp;that&nbsp;is&nbsp;due.&nbsp;<br>
&lt;br&gt;&lt;br&gt;&gt;&nbsp;Also&nbsp;a&nbsp;variant&nbsp;of&nbsp;your&nbsp;example&nbsp;would&nbsp;be&nbsp;the&nbsp;meta&nbsp;tag,&nbsp;if&nbsp;the&nbsp;aplication<br>
&lt;br&gt;&gt;&nbsp;writes&nbsp;the&nbsp;paramter&nbsp;there.<br>
&lt;br&gt;&lt;br&gt;Agreed.<br>
&lt;br&gt;&lt;br&gt;&gt;&nbsp;In&nbsp;OWASP&nbsp;Top&nbsp;10&nbsp;(2013)&nbsp;this&nbsp;is&nbsp;A1&nbsp;and&nbsp;A10.<br>
&lt;br&gt;&lt;br&gt;dito<br>
&lt;br&gt;&lt;br&gt;So&nbsp;what&nbsp;can&nbsp;we&nbsp;do?&nbsp;I&nbsp;must&nbsp;say&nbsp;I&nbsp;am&nbsp;a&nbsp;bit&nbsp;at&nbsp;loss&nbsp;when&nbsp;thinking&nbsp;about&nbsp;a<br>
&lt;br&gt;good&nbsp;_generic_&nbsp;approach.<br>
&lt;br&gt;&lt;br&gt;(1)&nbsp;Disallow&nbsp;CR/LF&nbsp;in&nbsp;Query-Strings<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;seems&nbsp;do-able,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;help&nbsp;us&nbsp;with&nbsp;request&nbsp;bodies<br>
&lt;br&gt;(2)&nbsp;Disallow&nbsp;CR/LF&nbsp;in&nbsp;Query-Strings&nbsp;and&nbsp;Request&nbsp;Bodies<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;will&nbsp;raise&nbsp;a&nbsp;ton&nbsp;of&nbsp;false&nbsp;positives.&nbsp;But&nbsp;tuning&nbsp;them&nbsp;away<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;on&nbsp;certain&nbsp;input&nbsp;fields&nbsp;could&nbsp;do&nbsp;the&nbsp;job<br>
&lt;br&gt;(3)&nbsp;Disallow&nbsp;CR/LF&nbsp;in&nbsp;Query-Strings&nbsp;and&nbsp;Request&nbsp;Bodies&nbsp;in&nbsp;combination<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;certain&nbsp;keywords<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;might&nbsp;bring&nbsp;less&nbsp;false&nbsp;positives,&nbsp;but&nbsp;&quot;Refresh&quot;&nbsp;is&nbsp;a&nbsp;standard<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;word,&nbsp;so&nbsp;you&nbsp;can&nbsp;not&nbsp;rule&nbsp;them&nbsp;out.<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;What&nbsp;keywords&nbsp;would&nbsp;need&nbsp;to&nbsp;be&nbsp;covered&nbsp;to&nbsp;address&nbsp;the&nbsp;issue?<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;What&nbsp;transformation&nbsp;/&nbsp;escape&nbsp;variants?<br>
&lt;br&gt;(4)&nbsp;Disallow&nbsp;refresh&nbsp;header&nbsp;/&nbsp;meta&nbsp;tag&nbsp;in&nbsp;response&nbsp;phases<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;Will&nbsp;only&nbsp;work&nbsp;when&nbsp;ResponseBodyAccess&nbsp;is&nbsp;enabled.<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;And&nbsp;I&nbsp;think&nbsp;there&nbsp;are&nbsp;are&nbsp;still&nbsp;tons&nbsp;of&nbsp;applications&nbsp;around&nbsp;who<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;redirect&nbsp;applications&nbsp;in&nbsp;this&nbsp;way.&nbsp;-&gt;&nbsp;False&nbsp;Positives<br>
&lt;br&gt;(5)&nbsp;Define&nbsp;a&nbsp;list&nbsp;of&nbsp;allowed&nbsp;redirects,&nbsp;then&nbsp;disallow&nbsp;refresh&nbsp;headers&nbsp;/<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;meta&nbsp;tags&nbsp;not&nbsp;pointing&nbsp;to&nbsp;these&nbsp;hosts/domains.<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;if&nbsp;such&nbsp;a&nbsp;list&nbsp;/&nbsp;variable-to-take-this-list<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;exists&nbsp;in&nbsp;the&nbsp;core&nbsp;rules.&nbsp;It's&nbsp;definitely&nbsp;a&nbsp;pain&nbsp;in&nbsp;the&nbsp;A*&nbsp;to<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;maintain.&nbsp;And&nbsp;the&nbsp;restriction&nbsp;with&nbsp;ResponseBodyAccess<br>
&lt;br&gt;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;(4)&nbsp;applies&nbsp;too.<br>
&lt;br&gt;&lt;br&gt;I&nbsp;am&nbsp;not&nbsp;particularly&nbsp;fond&nbsp;of&nbsp;all&nbsp;these&nbsp;variants&nbsp;and&nbsp;I&nbsp;would&nbsp;appreciate<br>
&lt;br&gt;if&nbsp;somebody&nbsp;had&nbsp;a&nbsp;better&nbsp;idea.<br>
&lt;br&gt;&lt;br&gt;Ahoj,<br>
&lt;br&gt;&lt;br&gt;Christian<br>
&lt;br&gt;&lt;br&gt;P.S.&nbsp;I&nbsp;will&nbsp;talk&nbsp;about&nbsp;practical&nbsp;CRS&nbsp;Tuning&nbsp;in&nbsp;Berne,&nbsp;Switzerland,<br>
&lt;br&gt;next&nbsp;Tuesday,&nbsp;4pm.&nbsp;If&nbsp;anybody&nbsp;wants&nbsp;to&nbsp;join.<br>
&lt;br&gt;More&nbsp;infos&nbsp;here:&nbsp;http://www.sig-switzerland.ch/de/event_bern.php<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;--&nbsp;<br>
&lt;br&gt;Any&nbsp;technology&nbsp;that&nbsp;does&nbsp;not&nbsp;appear&nbsp;magical&nbsp;is&nbsp;insufficiently<br>
&lt;br&gt;advanced.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<br>
&lt;br&gt;--&nbsp;Gregory&nbsp;Benford<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;------------------------------<br>
&lt;br&gt;&lt;br&gt;_______________________________________________<br>
&lt;br&gt;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list<br>
&lt;br&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org<br>
&lt;br&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;End&nbsp;of&nbsp;Owasp-modsecurity-core-rule-set&nbsp;Digest,&nbsp;Vol&nbsp;71,&nbsp;Issue&nbsp;2<br>
&lt;br&gt;**************************************************************<br>
&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;
</tt>
