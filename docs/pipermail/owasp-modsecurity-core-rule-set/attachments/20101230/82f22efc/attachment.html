<tt>
&lt;div&gt;I&nbsp;just&nbsp;change&nbsp;the&nbsp;rule&nbsp;to:&lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;REQUEST_BASENAME&nbsp;&amp;quot;\.(.*)$&amp;quot;&nbsp;&amp;quot;chain,capture,setvar:tx.extension&lt;font&nbsp;style=&quot;BACKGROUND-COLOR:&nbsp;#ff0000&quot;&gt;=.%{tx.1}/&lt;/font&gt;,phase:2,t:none,t:urlDecodeUni,t:lowercase,deny,log,auditlog,msg:&amp;#39;URL&nbsp;file&nbsp;extension&nbsp;is&nbsp;restricted&nbsp;by&nbsp;policy&amp;#39;,&nbsp;severity:&amp;#39;2&amp;#39;,id:&amp;#39;960035&amp;#39;,tag:&amp;#39;POLICY/EXT_RESTRICTED&amp;#39;,tag:&amp;#39;WASCTC/WASC-15&amp;#39;,tag:&amp;#39;OWASP_TOP_10/A7&amp;#39;,tag:&amp;#39;PCI/6.5.10&amp;#39;,logdata:&amp;#39;%{TX.0}&amp;#39;&amp;quot;&lt;br&gt;<br>
       &nbsp;SecRule&nbsp;TX:EXTENSION&nbsp;&amp;quot;@within&nbsp;%{tx.restricted_extensions}&amp;quot;&nbsp;&amp;quot;t:none,setvar:&amp;#39;tx.msg=%{rule.msg}&amp;#39;,setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&gt;rule.id&lt;/a&gt;}-POLICY/EXT_RESTRICTED-%{matched_var_name}=%{matched_var}&amp;quot;&lt;br&gt;<br>
&lt;br&gt;Then&nbsp;it&nbsp;works&nbsp;well.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2010/12/30&nbsp;dreamice&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:dreamice.jiang@gmail.com&quot;&gt;dreamice.jiang@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;<br>
&lt;div&gt;Dear&nbsp;Ryan,&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;just&nbsp;find&nbsp;a&nbsp;bug&nbsp;of&nbsp;the&nbsp;Restricted&nbsp;extensions&nbsp;rule.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;The&nbsp;original&nbsp;rule&nbsp;are:&lt;/div&gt;<br>
&lt;div&gt;setvar:&amp;#39;tx.restricted_extensions=.asa/&nbsp;.asax/&nbsp;.ascx/&nbsp;.axd/&nbsp;.backup/&nbsp;.bak/&nbsp;.bat/&nbsp;.cdx/&nbsp;.cer/&nbsp;.cfg/&nbsp;.cmd/&nbsp;.com/&nbsp;.config/&nbsp;.conf/&nbsp;.cs/&nbsp;.csproj/&nbsp;.csr/&nbsp;.dat/&nbsp;.db/&nbsp;.dbf/&nbsp;.dll/&nbsp;.dos/&nbsp;.htr/&nbsp;.htw/&nbsp;.ida/&nbsp;.idc/&nbsp;.idq/&nbsp;.inc/&nbsp;.ini/&nbsp;.key/&nbsp;.licx/&nbsp;.lnk/&nbsp;.log/&nbsp;.mdb/&nbsp;.old/&nbsp;.pass/&nbsp;.pdb/&nbsp;.pol/&nbsp;.printer/&nbsp;.pwd/&nbsp;.resources/&nbsp;.resx/&nbsp;.sql/&nbsp;.sys/&nbsp;.vb/&nbsp;.vbs/&nbsp;.vbproj/&nbsp;.vsdisco/&nbsp;.webinfo/&nbsp;.xsd/&nbsp;.xsx/&amp;#39;,&nbsp;\&lt;/div&gt;<br>
<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;REQUEST_BASENAME&nbsp;&amp;quot;\.(.*)$&amp;quot;&nbsp;&amp;quot;chain,capture,setvar:tx.extension&lt;font&nbsp;style=&quot;BACKGROUND-COLOR:&nbsp;#ff0000&quot;&gt;=‘.%{tx.1}/’&lt;/font&gt;,phase:2,t:none,t:urlDecodeUni,t:lowercase,deny,log,auditlog,msg:&amp;#39;URL&nbsp;file&nbsp;extension&nbsp;is&nbsp;restricted&nbsp;by&nbsp;policy&amp;#39;,&nbsp;severity:&amp;#39;2&amp;#39;,id:&amp;#39;960035&amp;#39;,tag:&amp;#39;POLICY/EXT_RESTRICTED&amp;#39;,tag:&amp;#39;WASCTC/WASC-15&amp;#39;,tag:&amp;#39;OWASP_TOP_10/A7&amp;#39;,tag:&amp;#39;PCI/6.5.10&amp;#39;,logdata:&amp;#39;%{TX.0}&amp;#39;&amp;quot;&lt;br&gt;<br>
       &nbsp;SecRule&nbsp;TX:EXTENSION&nbsp;&amp;quot;@within&nbsp;%{tx.restricted_extensions}&amp;quot;&nbsp;&amp;quot;t:none,setvar:&amp;#39;tx.msg=%{rule.msg}&amp;#39;,setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id/&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-POLICY/EXT_RESTRICTED-%{matched_var_name}=%{matched_var}&amp;quot;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;test&nbsp;and&nbsp;debug it&nbsp;but&nbsp;this rule&nbsp;does&nbsp;not&nbsp;work&nbsp;right.&nbsp;So&nbsp;I&nbsp;saw&nbsp;that&nbsp;the&nbsp;rule&nbsp;set&nbsp;tx.extension&nbsp;with&nbsp;two&nbsp;more&nbsp;single&nbsp;quote(&amp;#39;&amp;#39;),&nbsp;but&nbsp;the&nbsp;setvar&nbsp;does&nbsp;not&nbsp;set&nbsp;the&nbsp;two&nbsp;single&nbsp;quote.&lt;/div&gt;<br>
&lt;div&gt;For&nbsp;example,&nbsp;if&nbsp;you&nbsp;request&nbsp;the&nbsp;base&nbsp;name&nbsp;test.log,&nbsp;the&nbsp;rule&nbsp;sets&nbsp;the&nbsp;tx.extension&nbsp;with&nbsp;&lt;font&nbsp;style=&quot;BACKGROUND-COLOR:&nbsp;#ff0000&quot;&gt;&amp;#39;.log/&amp;#39;&lt;/font&gt;,&nbsp;but&nbsp;the&nbsp;restrcted_extensions&nbsp;is&nbsp;&lt;font&nbsp;style=&quot;BACKGROUND-COLOR:&nbsp;#ff0000&quot;&gt;.log&lt;/font&gt;,&nbsp;They&nbsp;are&nbsp;not&nbsp;equal&nbsp;and&nbsp;the&nbsp;rule&nbsp;can&nbsp;not&nbsp;be&nbsp;matched.&lt;/div&gt;<br>
<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Wish&nbsp;you&nbsp;do&nbsp;a&nbsp;test&nbsp;and&nbsp;update&nbsp;the&nbsp;rules.&nbsp;Thanks&nbsp;a&nbsp;lot.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Best&nbsp;regards,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;div&gt;dreamice&lt;/div&gt;<br>
&lt;div&gt;2010-12-30&lt;/div&gt;&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
