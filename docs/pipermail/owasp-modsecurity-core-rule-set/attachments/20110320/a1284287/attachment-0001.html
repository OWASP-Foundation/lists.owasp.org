<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,&lt;br&gt;&lt;br&gt;I&amp;#39;m&nbsp;using&nbsp;2.5.13&nbsp;with&nbsp;CRS&nbsp;2.1.1&lt;br&gt;I&amp;#39;ve&nbsp;configured&nbsp;the&nbsp;following:&lt;br&gt;&lt;br&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,&nbsp;\&lt;br&gt;setvar:&amp;#39;tx.brute_force_protected_urls=/protected_url&nbsp;/protected_url2&amp;#39;,&nbsp;\&lt;br&gt;<br>
setvar:&amp;#39;tx.brute_force_burst_time_slice=60&amp;#39;,&nbsp;\&lt;br&gt;setvar:&amp;#39;tx.brute_force_counter_threshold=5&amp;#39;,&nbsp;\&lt;br&gt;setvar:&amp;#39;tx.brute_force_block_timeout=300&amp;#39;&amp;quot;&lt;br&gt;&lt;br&gt;When&nbsp;I&nbsp;test,&nbsp;all&nbsp;the&nbsp;requests&nbsp;get&nbsp;through&nbsp;and&nbsp;not&nbsp;even&nbsp;a&nbsp;message&nbsp;in&nbsp;the&nbsp;logs&nbsp;:(&lt;br&gt;<br>
Here&nbsp;is&nbsp;an&nbsp;excerpt&nbsp;from&nbsp;the&nbsp;debug&nbsp;log:&lt;br&gt;...&lt;br&gt;[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Setting&nbsp;variable:&nbsp;tx.brute_force_protected_urls=/protected_url&nbsp;/protected_url2&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Set&nbsp;variable&nbsp;&amp;quot;tx.brute_force_protected_urls&amp;quot;&nbsp;to&nbsp;&amp;quot;/protected_url&nbsp;/protected_url2&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Setting&nbsp;variable:&nbsp;tx.brute_force_burst_time_slice=60&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Set&nbsp;variable&nbsp;&amp;quot;tx.brute_force_burst_time_slice&amp;quot;&nbsp;to&nbsp;&amp;quot;60&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Setting&nbsp;variable:&nbsp;tx.brute_force_counter_threshold=5&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Set&nbsp;variable&nbsp;&amp;quot;tx.brute_force_counter_threshold&amp;quot;&nbsp;to&nbsp;&amp;quot;5&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Setting&nbsp;variable:&nbsp;tx.brute_force_block_timeout=300&lt;br&gt;[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Set&nbsp;variable&nbsp;&amp;quot;tx.brute_force_block_timeout&amp;quot;&nbsp;to&nbsp;&amp;quot;300&amp;quot;.&lt;br&gt;<br>
...&lt;br&gt;[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Creating&nbsp;collection&nbsp;(name&nbsp;&amp;quot;global&amp;quot;,&nbsp;key&nbsp;&amp;quot;global&amp;quot;).&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Recorded&nbsp;original&nbsp;collection&nbsp;variable:&nbsp;global.UPDATE_COUNTER&nbsp;=&nbsp;&amp;quot;0&amp;quot;&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Added&nbsp;collection&nbsp;&amp;quot;global&amp;quot;&nbsp;to&nbsp;the&nbsp;list.&lt;br&gt;[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Resolved&nbsp;macro&nbsp;%{remote_addr}&nbsp;to:&nbsp;192.168.1.1&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Resolved&nbsp;macro&nbsp;%{tx.ua_hash}&nbsp;to:&nbsp;3dcbbff145dcf13aa6287b931eb296b39b7541ee&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;__expire_KEY&amp;quot;,&nbsp;value&nbsp;&amp;quot;1300615158&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;KEY&amp;quot;,&nbsp;value&nbsp;&amp;quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;TIMEOUT&amp;quot;,&nbsp;value&nbsp;&amp;quot;3600&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;__key&amp;quot;,&nbsp;value&nbsp;&amp;quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;__name&amp;quot;,&nbsp;value&nbsp;&amp;quot;ip&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;CREATE_TIME&amp;quot;,&nbsp;value&nbsp;&amp;quot;1300607334&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;UPDATE_COUNTER&amp;quot;,&nbsp;value&nbsp;&amp;quot;75&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;dos_counter&amp;quot;,&nbsp;value&nbsp;&amp;quot;75&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Read&nbsp;variable:&nbsp;name&nbsp;&amp;quot;LAST_UPDATE_TIME&amp;quot;,&nbsp;value&nbsp;&amp;quot;1300611558&amp;quot;.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Retrieved&nbsp;collection&nbsp;(name&nbsp;&amp;quot;ip&amp;quot;,&nbsp;key&nbsp;&amp;quot;192.168.1.1_3dcbbff145dcf13aa6287b931eb296b39b7541ee&amp;quot;).&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;Recorded&nbsp;original&nbsp;collection&nbsp;variable:&nbsp;ip.UPDATE_COUNTER&nbsp;=&nbsp;&amp;quot;75&amp;quot;&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Added&nbsp;collection&nbsp;&amp;quot;ip&amp;quot;&nbsp;to&nbsp;the&nbsp;list.&lt;br&gt;...&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;/a&gt;]&nbsp;Rule&nbsp;240d78:&nbsp;SecRule&nbsp;&amp;quot;IP:BRUTE_FORCE_BLOCK&amp;quot;&nbsp;&amp;quot;@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:1,log,noauditlog,chain,block,msg:&amp;#39;Brute&nbsp;Force&nbsp;Attack&nbsp;Identified&nbsp;from&nbsp;%{remote_addr}&nbsp;(%{tx.brute_force_block_counter}&nbsp;hits&nbsp;since&nbsp;last&nbsp;alert)&amp;#39;,setvar:ip.brute_force_block_counter=+1&amp;quot;&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Rule&nbsp;returned&nbsp;0.&lt;br&gt;[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;No&nbsp;match,&nbsp;chained&nbsp;-&amp;gt;&nbsp;mode&nbsp;NEXT_CHAIN.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Recipe:&nbsp;Invoking&nbsp;rule&nbsp;244cd8;&nbsp;[file&nbsp;&amp;quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_brute_force.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;27&amp;quot;].&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;/a&gt;]&nbsp;Rule&nbsp;244cd8:&nbsp;SecRule&nbsp;&amp;quot;IP:BRUTE_FORCE_BLOCK&amp;quot;&nbsp;&amp;quot;@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:1,noauditlog,block,nolog,setvar:ip.brute_force_block_counter=+1&amp;quot;&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Rule&nbsp;returned&nbsp;0.&lt;br&gt;[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][9&lt;/a&gt;]&nbsp;No&nbsp;match,&nbsp;not&nbsp;chained&nbsp;-&amp;gt;&nbsp;mode&nbsp;NEXT_RULE.&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Recipe:&nbsp;Invoking&nbsp;rule&nbsp;250338;&nbsp;[file&nbsp;&amp;quot;/opt/www/conf/modsecurity_crs/base_rules/modsecurity_crs_11_dos_protection.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;11&amp;quot;].&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][5&lt;/a&gt;]&nbsp;Rule&nbsp;250338:&nbsp;SecRule&nbsp;&amp;quot;IP:DOS_BLOCK&amp;quot;&nbsp;&amp;quot;@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:1,log,noauditlog,chain,drop,msg:&amp;#39;Denial&nbsp;of&nbsp;Service&nbsp;(DoS)&nbsp;Attack&nbsp;Identified&nbsp;from&nbsp;%{remote_addr}&nbsp;(%{tx.dos_block_counter}&nbsp;hits&nbsp;since&nbsp;last&nbsp;alert)&amp;#39;,setvar:ip.dos_block_counter=+1&amp;quot;&lt;br&gt;<br>
[20/Mar/2011:09:15:56&nbsp;+0000]&nbsp;[&lt;a&nbsp;href=&quot;http://www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&quot;&gt;www.site.com/sid#12b7778][rid#19211a0][/protected_url][4&lt;/a&gt;]&nbsp;Rule&nbsp;returned&nbsp;0.&lt;br&gt;&lt;br&gt;From&nbsp;what&nbsp;I&nbsp;can&nbsp;see,&nbsp;the&nbsp;request&nbsp;never&nbsp;hits&nbsp;the&nbsp;section&nbsp;of&nbsp;rules&nbsp;which&nbsp;should&nbsp;start&nbsp;counting&nbsp;the&nbsp;requests&nbsp;to&nbsp;the&nbsp;protected&nbsp;url.&nbsp;Instead,&nbsp;it&nbsp;skips&nbsp;to&nbsp;the&nbsp;next&nbsp;ruleset?&lt;br&gt;<br>
Thanks&nbsp;in&nbsp;advance,&lt;br&gt;Yonah&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
