<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Hi&nbsp;there,&lt;/b&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;I&nbsp;am&nbsp;facing&nbsp;a&nbsp;problem&nbsp;where&nbsp;I&nbsp;get&lt;b&gt;&nbsp;&quot;&lt;/b&gt;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&quot;&nbsp;debug&nbsp;output&nbsp;when&nbsp;using&nbsp;the&nbsp;dos_protection&nbsp;rule&nbsp;set&nbsp;(&nbsp;&quot;modsecurity_crs_11_dos_protection.conf&quot;).&lt;/div&gt;&lt;ul&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;li&gt;DOS_Protection&nbsp;works&nbsp;as&nbsp;it&nbsp;should,&nbsp;so&nbsp;no&nbsp;issues&nbsp;with&nbsp;that&nbsp;(I&nbsp;have&nbsp;uncommented&nbsp;the&nbsp;relevant&nbsp;lines&nbsp;in&nbsp;the&nbsp;crs_10_setup.conf,&nbsp;as&nbsp;well&nbsp;as&nbsp;properly&nbsp;linked&nbsp;up&nbsp;the&nbsp;crs_11_dos_protection.conf&lt;/li&gt;&lt;li&gt;However,&nbsp;I&nbsp;find&nbsp;that&nbsp;the&nbsp;debug&nbsp;is&nbsp;littered&nbsp;with&nbsp;&lt;b&gt;&quot;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&quot;&lt;/b&gt;&lt;/li&gt;&lt;li&gt;I've&nbsp;realized&nbsp;that&nbsp;this&nbsp;is&nbsp;NOT&nbsp;a&nbsp;problem&nbsp;with&nbsp;INITCOL:IP&nbsp;not&nbsp;being&nbsp;called&nbsp;in&nbsp;the&nbsp;setup&nbsp;conf&nbsp;file&nbsp;--&gt;&nbsp;This&nbsp;works&nbsp;properly&nbsp;(I&nbsp;am&nbsp;using&nbsp;the&nbsp;default&nbsp;crs_10_setup.conf)&lt;/li&gt;&lt;li&gt;The&nbsp;issue&nbsp;ONLY&nbsp;occurs&nbsp;with&nbsp;Apache&nbsp;(internal&nbsp;dummy&nbsp;connection)&nbsp;(see&nbsp;below&nbsp;debug&nbsp;/&nbsp;audit&nbsp;output)&lt;/li&gt;&lt;ul&gt;&lt;li&gt;If&nbsp;you&nbsp;see&nbsp;below&nbsp;Audit&nbsp;Output,&nbsp;it&nbsp;is&nbsp;not&nbsp;a&nbsp;standard&nbsp;&quot;GET&quot;&nbsp;request.&lt;/li&gt;&lt;li&gt;From&nbsp;my&nbsp;understanding,&nbsp;Apache's&nbsp;internal&nbsp;dummy&nbsp;connections&nbsp;are&nbsp;just&nbsp;done&nbsp;by&nbsp;Apache&nbsp;to&nbsp;wake&nbsp;up&nbsp;its&nbsp;child&nbsp;processes.&lt;/li&gt;&lt;/ul&gt;&lt;li&gt;I&nbsp;am&nbsp;puzzled&nbsp;why&nbsp;this&nbsp;happens,&nbsp;because&nbsp;I&nbsp;thought&nbsp;there&nbsp;already&nbsp;is&nbsp;an&nbsp;exception&nbsp;for&nbsp;Apache&nbsp;internal&nbsp;dummy&nbsp;connections&nbsp;in&nbsp;47&nbsp;common_exceptions.conf?&nbsp;&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;Any&nbsp;reason&nbsp;why&nbsp;these&nbsp;dummy&nbsp;connections&nbsp;are&nbsp;still&nbsp;causing&nbsp;the&nbsp;error&nbsp;messages&nbsp;in&nbsp;the&nbsp;debug?&nbsp;And&nbsp;if&nbsp;so,&nbsp;how&nbsp;to&nbsp;solve&nbsp;this&nbsp;issue?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;b&gt;My&nbsp;system:&lt;/b&gt;&lt;/div&gt;&lt;div&gt;-Ubuntu&nbsp;12.04&nbsp;on&nbsp;Amazon&nbsp;EC2&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;-Apache&nbsp;2.6.3&nbsp;Mod_Security&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;-OWASP_CRS/2.2.5.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Debug&nbsp;output:&lt;/b&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;[13/Jul/2012:13:29:46&nbsp;+0000]&nbsp;[ip-XX-XXX-XX-XX.ap-southeast-1.compute.internal/sid#7f40d4a48370][rid#7f40d64c60a0][*][3]&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Audit&nbsp;Output:&lt;/b&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-A--&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;[13/Jul/2012:13:29:46&nbsp;+0000]&nbsp;UAAiygqAUUgAABqMEm0AAAAE&nbsp;127.0.0.1&nbsp;34716&nbsp;127.0.0.1&nbsp;80&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-B--&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;OPTIONS&nbsp;*&nbsp;HTTP/1.0&lt;/div&gt;&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#ff0000&quot;&gt;User-Agent:&nbsp;Apache&nbsp;(internal&nbsp;dummy&nbsp;connection)&lt;/font&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-F--&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;HTTP/1.1&nbsp;200&nbsp;OK&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Content-Length:&nbsp;0&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Connection:&nbsp;close&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-H--&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Message:&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Stopwatch:&nbsp;1342186186315250&nbsp;284&nbsp;(-&nbsp;-&nbsp;-)&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Stopwatch2:&nbsp;1342186186315250&nbsp;284;&nbsp;combined=119,&nbsp;p1=0,&nbsp;p2=0,&nbsp;p3=0,&nbsp;p4=0,&nbsp;p5=118,&nbsp;sr=0,&nbsp;sw=1,&nbsp;l=0,&nbsp;gc=0&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.6.3&nbsp;(http://www.modsecurity.org/);&nbsp;OWASP_CRS/2.2.5;&nbsp;OWASP_CRS/2.2.5.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Server:&nbsp;Apache&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-Z--&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>

</tt>
