<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=Windows-1252&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0in;&nbsp;PADDING-LEFT:&nbsp;0in;&nbsp;PADDING-RIGHT:&nbsp;0in;&nbsp;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;PADDING-TOP:&nbsp;3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;&quot;JPow&nbsp;(powster)&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:powster@gmail.com&quot;&gt;powster@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Fri,&nbsp;13&nbsp;Jul&nbsp;2012&nbsp;10:39:21&nbsp;-0500&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;Ryan&nbsp;Barnett&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rbarnett@trustwave.com&quot;&gt;rbarnett@trustwave.com&lt;/a&gt;&gt;,&nbsp;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;DOS_Protection&nbsp;Problem:&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;BORDER-LEFT:&nbsp;#b5c4df&nbsp;5&nbsp;solid;&nbsp;PADDING:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;MARGIN:0&nbsp;0&nbsp;0&nbsp;5;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Hi&nbsp;Ryan,&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;&lt;br&gt;<br>
&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Thanks&nbsp;for&nbsp;the&nbsp;tip.&nbsp;I&nbsp;tried&nbsp;adding&nbsp;this&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;10_setup.conf:&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;<br>
&lt;div&gt;SecRule&nbsp;REQUEST_LINE&nbsp;&quot;^(GET&nbsp;/|OPTIONS&nbsp;\*)&nbsp;HTTP/1.0$&quot;&nbsp;&quot;phase:1,allow,nolog,chain,t:none&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;^(127\.0\.0\.|\:\:)1$&quot;&nbsp;&quot;chain,&nbsp;t:none&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&quot;^Apache.*\(internal&nbsp;dummy&nbsp;connection\)$&quot;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;would&nbsp;add&nbsp;this&nbsp;before&nbsp;the&nbsp;[[&nbsp;Global&nbsp;and&nbsp;IP&nbsp;Collections&nbsp;]]&nbsp;rules.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Also&nbsp;–&nbsp;is&nbsp;your&nbsp;SecRuleEngine&nbsp;set&nbsp;to&nbsp;On?&nbsp;&nbsp;It&nbsp;needs&nbsp;to&nbsp;be&nbsp;to&nbsp;use&nbsp;the&nbsp;allow&nbsp;action.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;-Ryan&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;BORDER-LEFT:&nbsp;#b5c4df&nbsp;5&nbsp;solid;&nbsp;PADDING:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;MARGIN:0&nbsp;0&nbsp;0&nbsp;5;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Restarted&nbsp;apache&nbsp;and&nbsp;still&nbsp;kept&nbsp;getting:&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;DEBUG:&nbsp;&lt;/b&gt;[13/Jul/2012:15:34:13&nbsp;&#43;0000]&nbsp;[ip-10-128-81-72.ap-southeast-1.compute.internal/sid#7f5fdc6a0370][rid#7f5fdf6310a0][*][3]&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;AUDIT:&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--fe256340-A--&lt;/div&gt;<br>
&lt;div&gt;[13/Jul/2012:15:34:14&nbsp;&#43;0000]&nbsp;UAA-9gqAUUgAAB9cIOwAAAAH&nbsp;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#ff0000&quot;&gt;<br>
127.0.0.1&lt;/font&gt;&nbsp;34888&nbsp;127.0.0.1&nbsp;80&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--fe256340-B--&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#ff0000&quot;&gt;OPTIONS&nbsp;*&nbsp;HTTP/1.0&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;User-Agent:&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#ff0000&quot;&gt;&nbsp;Apache&nbsp;(internal&nbsp;dummy&nbsp;connection)&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--fe256340-F--&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;HTTP/1.1&nbsp;200&nbsp;OK&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Content-Length:&nbsp;0&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Connection:&nbsp;close&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--fe256340-H--&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Message:&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Stopwatch:&nbsp;1342193654146888&nbsp;832&nbsp;(-&nbsp;-&nbsp;-)&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Stopwatch2:&nbsp;1342193654146888&nbsp;832;&nbsp;combined=275,&nbsp;p1=0,&nbsp;p2=0,&nbsp;p3=0,&nbsp;p4=0,&nbsp;p5=274,&nbsp;sr=0,&nbsp;sw=1,&nbsp;l=0,&nbsp;gc=0&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.6.3&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);&nbsp;OWASP_CRS/2.2.5;&nbsp;OWASP_CRS/2.2.5.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Server:&nbsp;Apache&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--fe256340-Z--&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Thinking&nbsp;that&nbsp;maybe&nbsp;the&nbsp;&quot;chaining&quot;&nbsp;of&nbsp;the&nbsp;rules&nbsp;was&nbsp;preventing&nbsp;a&nbsp;match,&nbsp;I&nbsp;tried&nbsp;the&nbsp;following&nbsp;rules,&nbsp;all&nbsp;UNCHAINED&nbsp;(again,&nbsp;appended&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;10_setup.conf)&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;<br>
&lt;div&gt;SecRule&nbsp;REQUEST_LINE&nbsp;&quot;^(GET&nbsp;/|OPTIONS&nbsp;\*)&nbsp;HTTP/1.0$&quot;&nbsp;&quot;phase:1,allow,nolog&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;^(127\.0\.0\.|\:\:)1$&quot;&nbsp;&quot;phase:1,allow,nolog&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&quot;^Apache.*\(internal&nbsp;dummy&nbsp;connection\)$&quot;&nbsp;&quot;phase:1,allow,nolog&quot;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Result:&nbsp;&lt;/b&gt;Still&nbsp;kept&nbsp;getting&nbsp;the&nbsp;same&nbsp;errors.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Am&nbsp;I&nbsp;doing&nbsp;something&nbsp;wrongly?&nbsp;Is&nbsp;appending&nbsp;the&nbsp;rules&nbsp;to&nbsp;10_setup.conf&nbsp;wrong?&lt;/div&gt;<br>
&lt;div&gt;Is&nbsp;there&nbsp;something&nbsp;wrong&nbsp;with&nbsp;the&nbsp;rules,&nbsp;which&nbsp;inadvertently&nbsp;allows&nbsp;the&nbsp;apache&nbsp;internal&nbsp;dummy&nbsp;connection&nbsp;through?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Thank&nbsp;you&nbsp;so&nbsp;much.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;JPow&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0in;&nbsp;PADDING-LEFT:&nbsp;0in;&nbsp;PADDING-RIGHT:&nbsp;0in;&nbsp;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;PADDING-TOP:&nbsp;3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Ryan&nbsp;Barnett&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Friday,&nbsp;July&nbsp;13,&nbsp;2012&nbsp;10:11&nbsp;PM&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;Jingxun&nbsp;Pow&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:powster@gmail.com&quot;&gt;powster@gmail.com&lt;/a&gt;&gt;,&nbsp;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;DOS_Protection&nbsp;Problem:&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;The&nbsp;rules&nbsp;in&nbsp;the&nbsp;47&nbsp;common&nbsp;exceptions&nbsp;file&nbsp;will&nbsp;only&nbsp;adjust&nbsp;the&nbsp;anomaly&nbsp;scores.&nbsp;&nbsp;You&nbsp;could&nbsp;take&nbsp;these&nbsp;rules&nbsp;and&nbsp;place&nbsp;them&nbsp;into&nbsp;local&nbsp;15&nbsp;files&nbsp;and&nbsp;add&nbsp;the&nbsp;&quot;alllow&quot;&nbsp;action&nbsp;to&nbsp;them.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Consolas,&nbsp;'Courier&nbsp;New',&nbsp;Courier&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-size:&nbsp;13px;&nbsp;&quot;&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabs&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;ModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0in;&nbsp;PADDING-LEFT:&nbsp;0in;&nbsp;PADDING-RIGHT:&nbsp;0in;&nbsp;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;PADDING-TOP:&nbsp;3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;&quot;JPow&nbsp;(powster)&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:powster@gmail.com&quot;&gt;powster@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Fri,&nbsp;13&nbsp;Jul&nbsp;2012&nbsp;09:01:11&nbsp;-0500&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;[Owasp-modsecurity-core-rule-set]&nbsp;DOS_Protection&nbsp;Problem:&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;BORDER-LEFT:&nbsp;#b5c4df&nbsp;5&nbsp;solid;&nbsp;PADDING:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;MARGIN:0&nbsp;0&nbsp;0&nbsp;5;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Hi&nbsp;there,&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;&lt;br&gt;<br>
&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;I&nbsp;am&nbsp;facing&nbsp;a&nbsp;problem&nbsp;where&nbsp;I&nbsp;get&lt;b&gt;&nbsp;&quot;&lt;/b&gt;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&quot;&nbsp;debug&nbsp;output&nbsp;when&nbsp;using&nbsp;the&nbsp;dos_protection&nbsp;rule&nbsp;set&nbsp;(&nbsp;&quot;modsecurity_crs_11_dos_protection.conf&quot;).&lt;/div&gt;<br>
&lt;ul&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;<br>
&lt;li&gt;DOS_Protection&nbsp;works&nbsp;as&nbsp;it&nbsp;should,&nbsp;so&nbsp;no&nbsp;issues&nbsp;with&nbsp;that&nbsp;(I&nbsp;have&nbsp;uncommented&nbsp;the&nbsp;relevant&nbsp;lines&nbsp;in&nbsp;the&nbsp;crs_10_setup.conf,&nbsp;as&nbsp;well&nbsp;as&nbsp;properly&nbsp;linked&nbsp;up&nbsp;the&nbsp;crs_11_dos_protection.conf&lt;/li&gt;&lt;li&gt;However,&nbsp;I&nbsp;find&nbsp;that&nbsp;the&nbsp;debug&nbsp;is&nbsp;littered&nbsp;with&nbsp;&lt;b&gt;&quot;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&quot;&lt;/b&gt;&lt;/li&gt;&lt;li&gt;I've&nbsp;realized&nbsp;that&nbsp;this&nbsp;is&nbsp;NOT&nbsp;a&nbsp;problem&nbsp;with&nbsp;INITCOL:IP&nbsp;not&nbsp;being&nbsp;called&nbsp;in&nbsp;the&nbsp;setup&nbsp;conf&nbsp;file&nbsp;--&gt;&nbsp;This&nbsp;works&nbsp;properly&nbsp;(I&nbsp;am&nbsp;using&nbsp;the&nbsp;default&nbsp;crs_10_setup.conf)&lt;/li&gt;&lt;li&gt;The&nbsp;issue&nbsp;ONLY&nbsp;occurs&nbsp;with&nbsp;Apache&nbsp;(internal&nbsp;dummy&nbsp;connection)&nbsp;(see&nbsp;below&nbsp;debug&nbsp;/&nbsp;audit&nbsp;output)<br>
&lt;ul&gt;<br>
&lt;li&gt;If&nbsp;you&nbsp;see&nbsp;below&nbsp;Audit&nbsp;Output,&nbsp;it&nbsp;is&nbsp;not&nbsp;a&nbsp;standard&nbsp;&quot;GET&quot;&nbsp;request.&lt;/li&gt;&lt;li&gt;From&nbsp;my&nbsp;understanding,&nbsp;Apache's&nbsp;internal&nbsp;dummy&nbsp;connections&nbsp;are&nbsp;just&nbsp;done&nbsp;by&nbsp;Apache&nbsp;to&nbsp;wake&nbsp;up&nbsp;its&nbsp;child&nbsp;processes.&lt;/li&gt;&lt;/ul&gt;<br>
&lt;/li&gt;&lt;li&gt;I&nbsp;am&nbsp;puzzled&nbsp;why&nbsp;this&nbsp;happens,&nbsp;because&nbsp;I&nbsp;thought&nbsp;there&nbsp;already&nbsp;is&nbsp;an&nbsp;exception&nbsp;for&nbsp;Apache&nbsp;internal&nbsp;dummy&nbsp;connections&nbsp;in&nbsp;47&nbsp;common_exceptions.conf?&nbsp;&lt;/li&gt;&lt;/ul&gt;<br>
&lt;div&gt;Any&nbsp;reason&nbsp;why&nbsp;these&nbsp;dummy&nbsp;connections&nbsp;are&nbsp;still&nbsp;causing&nbsp;the&nbsp;error&nbsp;messages&nbsp;in&nbsp;the&nbsp;debug?&nbsp;And&nbsp;if&nbsp;so,&nbsp;how&nbsp;to&nbsp;solve&nbsp;this&nbsp;issue?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Thanks!&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;b&gt;My&nbsp;system:&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&gt;-Ubuntu&nbsp;12.04&nbsp;on&nbsp;Amazon&nbsp;EC2&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;-Apache&nbsp;2.6.3&nbsp;Mod_Security&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;-OWASP_CRS/2.2.5.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;&lt;br&gt;<br>
&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Debug&nbsp;output:&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;[13/Jul/2012:13:29:46&nbsp;&#43;0000]&nbsp;[ip-XX-XXX-XX-XX.ap-southeast-1.compute.internal/sid#7f40d4a48370][rid#7f40d64c60a0][*][3]&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;b&gt;Audit&nbsp;Output:&lt;/b&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-A--&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;[13/Jul/2012:13:29:46&nbsp;&#43;0000]&nbsp;UAAiygqAUUgAABqMEm0AAAAE&nbsp;127.0.0.1&nbsp;34716&nbsp;127.0.0.1&nbsp;80&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-B--&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;OPTIONS&nbsp;*&nbsp;HTTP/1.0&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;color=&quot;#ff0000&quot;&gt;User-Agent:&nbsp;Apache&nbsp;(internal&nbsp;dummy&nbsp;connection)&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-F--&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;HTTP/1.1&nbsp;200&nbsp;OK&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Content-Length:&nbsp;0&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Connection:&nbsp;close&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-H--&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Message:&nbsp;Could&nbsp;not&nbsp;set&nbsp;variable&nbsp;&quot;ip.dos_counter&quot;&nbsp;as&nbsp;the&nbsp;collection&nbsp;does&nbsp;not&nbsp;exist.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Stopwatch:&nbsp;1342186186315250&nbsp;284&nbsp;(-&nbsp;-&nbsp;-)&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Stopwatch2:&nbsp;1342186186315250&nbsp;284;&nbsp;combined=119,&nbsp;p1=0,&nbsp;p2=0,&nbsp;p3=0,&nbsp;p4=0,&nbsp;p5=118,&nbsp;sr=0,&nbsp;sw=1,&nbsp;l=0,&nbsp;gc=0&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.6.3&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);&nbsp;OWASP_CRS/2.2.5;&nbsp;OWASP_CRS/2.2.5.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;Server:&nbsp;Apache&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;--695eef13-Z--&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,<br>
&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic<br>
&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,<br>
&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic<br>
&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
