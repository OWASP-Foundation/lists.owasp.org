<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Mon,&nbsp;Sep&nbsp;14,&nbsp;2009&nbsp;at&nbsp;3:43&nbsp;PM,&nbsp;OSSEC&nbsp;junkie&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ossec.junkie@gmail.com&quot;&gt;ossec.junkie@gmail.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
Okay&nbsp;I&nbsp;figured&nbsp;out&nbsp;what&nbsp;the&nbsp;deal&nbsp;was.&nbsp; My&nbsp;account&nbsp;was&nbsp;not&nbsp;authorized&lt;br&gt;<br>
to&nbsp;make&nbsp;changes&nbsp;to&nbsp;mod_security.conf&nbsp;per&nbsp;our&nbsp;FIM&nbsp;application.&lt;br&gt;<br>
Everytime&nbsp;I&nbsp;made&nbsp;the&nbsp;changes&nbsp;to&nbsp;load&nbsp;the&nbsp;/base_rules&nbsp;folder&nbsp;and&lt;br&gt;<br>
restarted&nbsp;Apache,&nbsp;the&nbsp;FIM&nbsp;reverted&nbsp;my&nbsp;mod_security.conf&nbsp;to&nbsp;it&amp;#39;s&lt;br&gt;<br>
original&nbsp;state.&nbsp; Sorry&nbsp;for&nbsp;the&nbsp;confusion,&nbsp;didn&amp;#39;t&nbsp;know&nbsp;my&nbsp;account&lt;br&gt;<br>
wasn&amp;#39;t&nbsp;authorized&nbsp;to&nbsp;make&nbsp;the&nbsp;changes.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;get&nbsp;the&nbsp;detection&nbsp;now&nbsp;with&nbsp;the&nbsp;anomaly&nbsp;scoring,&nbsp;see&nbsp;below:&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;ModSecurity:&nbsp;Warning.&nbsp;Operator&nbsp;GE&nbsp;matched&nbsp;5&nbsp;at&nbsp;TX:anomaly_score.&nbsp;[file&lt;br&gt;<br>
&lt;/div&gt;&amp;quot;/webtier/apache/conf.d/modsecurity/base_rules/modsecurity_crs_60_correlation.conf&amp;quot;]&lt;br&gt;<br>
[line&nbsp;&amp;quot;41&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Transactional&nbsp;Anomaly&nbsp;Score&nbsp;(score&nbsp;101):&nbsp;XSS&nbsp;Attack&lt;br&gt;<br>
Detected&amp;quot;]&nbsp;[hostname&nbsp;&amp;quot;&lt;a&nbsp;href=&quot;http://server21.inside.mycompany.com&quot;&nbsp;target=&quot;_blank&quot;&gt;server21.inside.mycompany.com&lt;/a&gt;&amp;quot;]&nbsp;[uri&lt;br&gt;<br>
&amp;quot;/buy/PizzaPurchase&amp;quot;]&nbsp;[unique_id&nbsp;&amp;quot;Sq6bnwoBBGsAADafGX0AAAAH&amp;quot;]&lt;br&gt;<br>
&lt;br&gt;<br>
Any&nbsp;advice&nbsp;on&nbsp;the&nbsp;proper&nbsp;setting&nbsp;for&nbsp;me&nbsp;to&nbsp;start&nbsp;dropping&nbsp;people&nbsp;who&lt;br&gt;<br>
send&nbsp;a&nbsp;single&nbsp;XSS&nbsp;attack,&nbsp;or&nbsp;any&nbsp;attack&nbsp;in&nbsp;that&nbsp;matter?&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;Check&nbsp;out&nbsp;the&nbsp;examples&nbsp;in&nbsp;the&nbsp;modsecurity_crs_49_enforcement.conf&nbsp;file&nbsp;:) &nbsp;You&nbsp;can&nbsp;do&nbsp;one&nbsp;of&nbsp;two&nbsp;things&nbsp;-&lt;br&gt;&lt;br&gt;1) &nbsp;For&nbsp;XSS&nbsp;attacks,&nbsp;our&nbsp;new&nbsp;rules&nbsp;are&nbsp;including&nbsp;the&nbsp;category&nbsp;tag&nbsp;data&nbsp;in&nbsp;the&nbsp;TX&nbsp;name,&nbsp;so&nbsp;you&nbsp;can&nbsp;uncomment&nbsp;the&nbsp;following&nbsp;rule&nbsp;which&nbsp;will&nbsp;deny/log&nbsp;if&nbsp;the&nbsp;XSS&nbsp;score&nbsp;is&nbsp;more&nbsp;than&nbsp;0&nbsp;-&lt;br&gt;<br>
&lt;br&gt;#&nbsp;Alert&nbsp;on&nbsp;XSS&nbsp;anomalies&lt;br&gt;#&lt;br&gt;#SecRule&nbsp;TX:XSS_SCORE&nbsp;&amp;quot;!@eq&nbsp;0&amp;quot;&nbsp;\&lt;br&gt;#   &nbsp;&amp;quot;phase:2,t:none,log,deny,msg:&amp;#39;XSS&nbsp;Detected&nbsp;(score&nbsp;%{TX.XSS_SCORE}):&nbsp;%{tx.msg}&amp;#39;&amp;quot;&lt;br&gt;&lt;br&gt;2)&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;block&nbsp;when&nbsp;*any*&nbsp;major&nbsp;attack&nbsp;is&nbsp;detected&nbsp;then&nbsp;set&nbsp;the&nbsp;following&nbsp;-&nbsp;&lt;br&gt;<br>
&lt;br&gt;#&nbsp;Alert&nbsp;and&nbsp;Deny&nbsp;on&nbsp;High&nbsp;Anomaly&nbsp;Scores&lt;br&gt;#&lt;br&gt;SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&amp;quot;@ge&nbsp;20&amp;quot;&nbsp;\&lt;br&gt;   &nbsp;&amp;quot;phase:2,t:none,nolog,auditlog,deny,msg:&amp;#39;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(score&nbsp;%{TX.ANOMALY_SCORE}):&nbsp;%{tx.msg}&amp;#39;,setvar:tx.inbound_tx_msg=%{tx.msg}&amp;quot;&lt;br&gt;<br>
&lt;br&gt;This&nbsp;works&nbsp;since&nbsp;all&nbsp;of&nbsp;the&nbsp;XSS,&nbsp;SQL&nbsp;Injection,&nbsp;Remote&nbsp;File&nbsp;Inclusion&nbsp;(RFI)&nbsp;attacks,&nbsp;etc....&nbsp;are&nbsp;set&nbsp;at&nbsp;Severity&nbsp;2&nbsp;and&nbsp;are&nbsp;given&nbsp;an&nbsp;anomaly&nbsp;score&nbsp;of&nbsp;20. &nbsp;So,&nbsp;this&nbsp;rule&nbsp;doesn&amp;#39;t&nbsp;care&nbsp;what&nbsp;the&nbsp;category&nbsp;if&nbsp;the&nbsp;issue&nbsp;is,&nbsp;but&nbsp;only&nbsp;that&nbsp;the&nbsp;score&nbsp;is&nbsp;20&nbsp;or&nbsp;more&nbsp;points. &nbsp;This&nbsp;effectively&nbsp;will&nbsp;deny&nbsp;if&nbsp;either&nbsp;1&nbsp;Severity&nbsp;2&nbsp;rule&nbsp;matches&nbsp;or&nbsp;if&nbsp;there&nbsp;are&nbsp;multiple&nbsp;lower&nbsp;severity&nbsp;issues.&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;&lt;a&nbsp;href=&quot;http://tacticalwebappsec.blogspot.com/&quot;&gt;http://tacticalwebappsec.blogspot.com/&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>

</tt>
