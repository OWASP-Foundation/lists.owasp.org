<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.01&nbsp;Transitional//EN&quot;&gt;<br>
&lt;html&gt;<br>
&lt;head&gt;<br>
&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;content-type&quot;<br>
&nbsp;content=&quot;text/html;&nbsp;charset=ISO-8859-1&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
As&nbsp;referenced&nbsp;earlier&nbsp;(June&nbsp;20&nbsp;by&nbsp;modsec&nbsp;at&nbsp;enosis.com),&nbsp;there&nbsp;is&nbsp;a<br>
setvar&nbsp;error&nbsp;in&nbsp;version&nbsp;1516&nbsp;of&nbsp;this&nbsp;file.&amp;nbsp;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
However,&nbsp;the&nbsp;proposed&nbsp;fix&nbsp;does&nbsp;NOT&nbsp;correct&nbsp;the&nbsp;error.&amp;nbsp;&nbsp;The&nbsp;proposed&nbsp;fix<br>
makes&nbsp;every&nbsp;PHPIDS&nbsp;rule&nbsp;a&nbsp;critical&nbsp;anomaly&nbsp;rule,&nbsp;which&nbsp;does&nbsp;not&nbsp;appear<br>
to&nbsp;be&nbsp;the&nbsp;intent&nbsp;of&nbsp;the&nbsp;PHPIDS&nbsp;rules.&amp;nbsp;&nbsp;This&nbsp;will&nbsp;cause&nbsp;a&nbsp;lot&nbsp;of&nbsp;false<br>
positives&nbsp;if&nbsp;you&nbsp;are&nbsp;using&nbsp;the&nbsp;correlation&nbsp;rules.&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;addition,&nbsp;version&nbsp;1516&nbsp;changes&nbsp;the&nbsp;disruptive&nbsp;action&nbsp;of&nbsp;each&nbsp;of<br>
these&nbsp;rules&nbsp;from&nbsp;pass&nbsp;to&nbsp;block.&amp;nbsp;&nbsp;This&nbsp;interferes&nbsp;with&nbsp;correlation&nbsp;level<br>
behavior.&nbsp;(at&nbsp;least&nbsp;as&nbsp;far&nbsp;as&nbsp;I&nbsp;understand&nbsp;it,&nbsp;please&nbsp;feel&nbsp;free&nbsp;to<br>
correct&nbsp;me&nbsp;if&nbsp;I've&nbsp;got&nbsp;this&nbsp;wrong)&lt;br&gt;<br>
&lt;br&gt;<br>
Version&nbsp;1525&nbsp;attempts&nbsp;to&nbsp;resolve&nbsp;these&nbsp;issues,&nbsp;but&nbsp;I&nbsp;believe&nbsp;it&nbsp;misses<br>
the&nbsp;true&nbsp;problem&nbsp;with&nbsp;the&nbsp;1516&nbsp;version&nbsp;and&nbsp;appears&nbsp;to&nbsp;add&nbsp;a&nbsp;different<br>
version&nbsp;of&nbsp;the&nbsp;same&nbsp;problem.&lt;br&gt;<br>
&lt;br&gt;<br>
Version&nbsp;1525&nbsp;changed:&lt;br&gt;<br>
setvar:%{tx.critical_anomaly_score}&lt;br&gt;<br>
to:&lt;br&gt;<br>
setvar:tx.%{tx.critical_anomaly_score}&lt;br&gt;<br>
&lt;br&gt;<br>
Which&nbsp;appears&nbsp;to&nbsp;throw&nbsp;very&nbsp;similar&nbsp;errors.&nbsp;Looking&nbsp;at&nbsp;previous<br>
versions&nbsp;of&nbsp;this&nbsp;file,&nbsp;it&nbsp;appears&nbsp;to&nbsp;me&nbsp;that&nbsp;the&nbsp;change&nbsp;should&nbsp;be:&lt;br&gt;<br>
setvar:tx.anomaly_score=+n&lt;br&gt;<br>
where&nbsp;n&nbsp;is&nbsp;equal&nbsp;to&nbsp;a&nbsp;weight&nbsp;applied&nbsp;to&nbsp;each&nbsp;PHPIDS&nbsp;rule.&lt;br&gt;<br>
&lt;br&gt;<br>
Version&nbsp;1503&nbsp;of&nbsp;this&nbsp;file&nbsp;contained&nbsp;the&nbsp;the&nbsp;relative&nbsp;weight&nbsp;of&nbsp;each<br>
PHPIDS&nbsp;rule.&nbsp;Attached&nbsp;is&nbsp;a&nbsp;modified<br>
modsecurity_crs_41_phpids_filters.conf&nbsp;file.&amp;nbsp;&nbsp;I&nbsp;took&nbsp;the&nbsp;scoring&nbsp;levels<br>
and&nbsp;pass/block&nbsp;action&nbsp;of&nbsp;version&nbsp;1503&nbsp;of&nbsp;this&nbsp;file&nbsp;and&nbsp;the&nbsp;actual&nbsp;rules<br>
from&nbsp;the&nbsp;1516&nbsp;version.&amp;nbsp;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;version&nbsp;of&nbsp;the&nbsp;file&nbsp;appears&nbsp;to&nbsp;resolve&nbsp;the&nbsp;false-positives&nbsp;caused<br>
by&nbsp;the&nbsp;recommended&nbsp;changes&nbsp;in&nbsp;the&nbsp;June&nbsp;20&nbsp;post,&nbsp;and&nbsp;&quot;plays&nbsp;nice&quot;&nbsp;with<br>
the&nbsp;correlation&nbsp;rules&nbsp;by&nbsp;not&nbsp;forcing&nbsp;every&nbsp;rule&nbsp;to&nbsp;block&nbsp;or&nbsp;exceed&nbsp;the<br>
anomaly&nbsp;score&nbsp;(unless&nbsp;that's&nbsp;the&nbsp;intention&nbsp;of&nbsp;the&nbsp;rule).&lt;br&gt;<br>
&lt;br&gt;<br>
I'm&nbsp;open&nbsp;to&nbsp;suggestions&nbsp;and&nbsp;feedback,&nbsp;but&nbsp;I&nbsp;think&nbsp;I've&nbsp;got&nbsp;this&nbsp;issue<br>
resolved,&nbsp;at&nbsp;least&nbsp;until&nbsp;there's&nbsp;an&nbsp;update&nbsp;to&nbsp;the&nbsp;PHPIDS&nbsp;rules.&amp;nbsp;&nbsp;There<br>
is&nbsp;probably&nbsp;still&nbsp;some&nbsp;work&nbsp;to&nbsp;do&nbsp;on&nbsp;the&nbsp;scripts&nbsp;that&nbsp;convert&nbsp;the<br>
PHPIDS&nbsp;rules&nbsp;into&nbsp;ModSecurity&nbsp;Rules.&lt;br&gt;<br>
&lt;br&gt;<br>
--&nbsp;&lt;br&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&gt;Joshua&nbsp;Gee&lt;br&gt;<br>
&lt;/font&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;moz-signature&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
