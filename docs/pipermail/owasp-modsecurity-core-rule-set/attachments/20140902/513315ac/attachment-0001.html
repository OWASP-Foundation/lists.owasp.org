<tt>
&lt;HTML&gt;&lt;HEAD&gt;&lt;/HEAD&gt;<br>
&lt;BODY&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12pt;&nbsp;FONT-FAMILY:&nbsp;'Calibri';&nbsp;COLOR:&nbsp;#000000&quot;&gt;<br>
&lt;DIV&gt;Dear&nbsp;Josh,&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Thanks&nbsp;you&nbsp;so&nbsp;much&nbsp;for&nbsp;your&nbsp;help,&nbsp;but&nbsp;I&nbsp;think&nbsp;that&nbsp;only&nbsp;for&nbsp;the&nbsp;file&nbsp;name&nbsp;<br>
UploadFiles.aspx,&nbsp;how&nbsp;about&nbsp;globally&nbsp;upload,&nbsp;frankly&nbsp;speaking&nbsp;I&nbsp;try&nbsp;to&nbsp;protect&nbsp;<br>
what&nbsp;ever&nbsp;upload&nbsp;by&nbsp;the&nbsp;hackers&nbsp;from&nbsp;the&nbsp;buggy&nbsp;script&nbsp;of&nbsp;Joomla&nbsp;or&nbsp;Wordpress,&nbsp;<br>
lately&nbsp;I’m&nbsp;facing&nbsp;a&nbsp;lot&nbsp;of&nbsp;trouble&nbsp;were&nbsp;hackers&nbsp;upload&nbsp;their&nbsp;files&nbsp;and&nbsp;run&nbsp;the&nbsp;<br>
script&nbsp;for&nbsp;sending&nbsp;thousands&nbsp;of&nbsp;spam&nbsp;mail.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Please&nbsp;help&nbsp;and&nbsp;Thank&nbsp;you&nbsp;so&nbsp;much&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style='FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;&quot;Calibri&quot;;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline'&gt;<br>
&lt;DIV&nbsp;style=&quot;FONT:&nbsp;10pt&nbsp;tahoma&quot;&gt;<br>
&lt;DIV&gt;&lt;FONT&nbsp;size=3&nbsp;face=Calibri&gt;&lt;/FONT&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;style=&quot;BACKGROUND:&nbsp;#f5f5f5&quot;&gt;<br>
&lt;DIV&nbsp;style=&quot;font-color:&nbsp;black&quot;&gt;&lt;B&gt;From:&lt;/B&gt;&nbsp;&lt;A&nbsp;title=jamuse@owasp.org&nbsp;<br>
href=&quot;mailto:jamuse@owasp.org&quot;&gt;Josh&nbsp;Amishav-Zlatin&lt;/A&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;B&gt;Sent:&lt;/B&gt;&nbsp;Tuesday,&nbsp;September&nbsp;02,&nbsp;2014&nbsp;4:32&nbsp;PM&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;B&gt;To:&lt;/B&gt;&nbsp;&lt;A&nbsp;title=admin@mesra.my&nbsp;href=&quot;mailto:admin@mesra.my&quot;&gt;Mesra.net&nbsp;<br>
CEO&lt;/A&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;B&gt;Cc:&lt;/B&gt;&nbsp;&lt;A&nbsp;title=owasp-modsecurity-core-rule-set@lists.owasp.org&nbsp;<br>
href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;OWASP&nbsp;Mod&nbsp;<br>
Security&lt;/A&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&lt;B&gt;Subject:&lt;/B&gt;&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;(no&nbsp;<br>
subject)&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&nbsp;<br>
style='FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;&quot;Calibri&quot;;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;#000000;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline'&gt;<br>
&lt;DIV&nbsp;dir=ltr&gt;<br>
&lt;DIV&nbsp;class=gmail_extra&gt;<br>
&lt;DIV&nbsp;class=gmail_quote&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;2,&nbsp;2014&nbsp;at&nbsp;3:34&nbsp;AM,&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;SPAN&nbsp;<br>
dir=ltr&gt;&lt;&lt;A&nbsp;href=&quot;mailto:admin@mesra.my&quot;&nbsp;<br>
target=_blank&gt;admin@mesra.my&lt;/A&gt;&gt;&lt;/SPAN&gt;&nbsp;wrote:&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;class=gmail_quote&nbsp;<br>
style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;rgb(204,204,204)&nbsp;1px&nbsp;solid&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12pt;&nbsp;FONT-FAMILY:&nbsp;calibri;&nbsp;COLOR:&nbsp;rgb(0,0,0)&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;<br>
&nbsp;&nbsp;style=&quot;FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;calibri;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;rgb(0,0,0);&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12pt;&nbsp;FONT-FAMILY:&nbsp;calibri;&nbsp;COLOR:&nbsp;rgb(0,0,0)&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Dear&nbsp;All,&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;I’m&nbsp;looking&nbsp;the&nbsp;rule&nbsp;for&nbsp;allow&nbsp;upload&nbsp;for&nbsp;only&nbsp;specific&nbsp;country,&nbsp;for&nbsp;<br>
&nbsp;&nbsp;example&nbsp;I&nbsp;will&nbsp;allow&nbsp;only&nbsp;Japan&nbsp;to&nbsp;upload&nbsp;any&nbsp;type&nbsp;of&nbsp;files&nbsp;to&nbsp;upload&nbsp;and&nbsp;the&nbsp;<br>
&nbsp;&nbsp;rest&nbsp;countries&nbsp;will&nbsp;Access&nbsp;denied.&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BLOCKQUOTE&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Hi,&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;First&nbsp;you&nbsp;need&nbsp;to&nbsp;define&nbsp;where&nbsp;the&nbsp;GeoDB&nbsp;is.&nbsp;This&nbsp;can&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;CRS&nbsp;10&nbsp;<br>
file.&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;SecGeoLookupDb&nbsp;/opt/modsecurity/bin/GeoLiteCity.dat&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Next&nbsp;you&nbsp;need&nbsp;to&nbsp;pass&nbsp;the&nbsp;client's&nbsp;IP&nbsp;address&nbsp;(REMOTE_ADDR)&nbsp;to&nbsp;the&nbsp;<br>
@geoLookup&nbsp;operator&nbsp;via&nbsp;a&nbsp;rule&nbsp;like:&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;@geoLookup&quot;&nbsp;&quot;id:1,phase:1,t:none,pass,nolog&quot;&lt;BR&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Finally&nbsp;you&nbsp;limit&nbsp;access&nbsp;to&nbsp;the&nbsp;upload&nbsp;script&nbsp;(e.g.&nbsp;/UploadFiles.aspx)&nbsp;to&nbsp;<br>
client&nbsp;IP&nbsp;addresses&nbsp;originating&nbsp;in&nbsp;Japan&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;<br>
&lt;DIV&gt;SecRule&nbsp;GEO:COUNTRY_CODE3&nbsp;&quot;!@streq&nbsp;JPN&quot;&nbsp;<br>
&quot;id:2,phase:1,t:none,log,deny,msg:'Client&nbsp;IP&nbsp;not&nbsp;from&nbsp;<br>
Japan',chain&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;REQUEST_URI&nbsp;&quot;@rx&nbsp;/UploadFiles.aspx&quot;&lt;/DIV&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;Note,&nbsp;this&nbsp;was&nbsp;not&nbsp;tested&nbsp;YMMV.&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;-&nbsp;Josh&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&lt;BLOCKQUOTE&nbsp;class=gmail_quote&nbsp;<br>
style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;rgb(204,204,204)&nbsp;1px&nbsp;solid&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12pt;&nbsp;FONT-FAMILY:&nbsp;calibri;&nbsp;COLOR:&nbsp;rgb(0,0,0)&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;<br>
&nbsp;&nbsp;style=&quot;FONT-SIZE:&nbsp;small;&nbsp;TEXT-DECORATION:&nbsp;none;&nbsp;FONT-FAMILY:&nbsp;calibri;&nbsp;FONT-WEIGHT:&nbsp;normal;&nbsp;COLOR:&nbsp;rgb(0,0,0);&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;DISPLAY:&nbsp;inline&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;dir=ltr&gt;<br>
&nbsp;&nbsp;&lt;DIV&nbsp;style=&quot;FONT-SIZE:&nbsp;12pt;&nbsp;FONT-FAMILY:&nbsp;calibri;&nbsp;COLOR:&nbsp;rgb(0,0,0)&quot;&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;&nbsp;&lt;/DIV&gt;<br>
&nbsp;&nbsp;&lt;DIV&gt;Please&nbsp;<br>
&nbsp;&nbsp;help&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;BR&gt;_______________________________________________&lt;BR&gt;Owasp-modsecurity-core-rule-set&nbsp;<br>
&nbsp;&nbsp;mailing&nbsp;list&lt;BR&gt;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/A&gt;&lt;BR&gt;&lt;A&nbsp;<br>
&nbsp;&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;<br>
&nbsp;&nbsp;target=_blank&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/A&gt;&lt;BR&gt;&lt;BR&gt;&lt;/BLOCKQUOTE&gt;&lt;/DIV&gt;<br>
&lt;DIV&gt;&nbsp;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/DIV&gt;&lt;/BODY&gt;&lt;/HTML&gt;<br>

</tt>
