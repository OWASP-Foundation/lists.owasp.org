<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;2,&nbsp;2014&nbsp;at&nbsp;5:52&nbsp;PM,&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:admin@mesra.my&quot;&nbsp;target=&quot;_blank&quot;&gt;admin@mesra.my&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-size:12pt;font-family:Calibri;color:rgb(0,0,0)&quot;&gt;<br>
&lt;div&gt;Dear&nbsp;Josh,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Mind&nbsp;to&nbsp;ask&nbsp;you&nbsp;something,&nbsp;what&nbsp;the&nbsp;different&nbsp;between&nbsp;GEO:COUNTRY_CODE&nbsp;and&nbsp;<br>
GEO:COUNTRY_CODE3&nbsp;?&lt;/div&gt;<br>
&lt;div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ISO&nbsp;country&nbsp;codes&nbsp;come&nbsp;in&nbsp;2&nbsp;digit&nbsp;and&nbsp;3&nbsp;digit&nbsp;variables,&nbsp;so&nbsp;for&nbsp;Japan GEO:COUNTRY_CODE&nbsp;is&nbsp;JP&nbsp;and GEO:COUNTRY_CODE3&nbsp;is&nbsp;JPN.&nbsp;Either&nbsp;variation&nbsp;is&nbsp;fine.&lt;/div&gt;&lt;div&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;-&nbsp;Josh&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-size:12pt;font-family:Calibri;color:rgb(0,0,0)&quot;&gt;&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Please&nbsp;advice.&nbsp;TQ&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;From:&nbsp;Josh&nbsp;Amishav-Zlatin&nbsp;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;<br>
&lt;div&gt;Sent:&nbsp;Tuesday,&nbsp;September&nbsp;02,&nbsp;2014&nbsp;5:51&nbsp;PM&lt;/div&gt;<br>
&lt;div&gt;To:&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;div&gt;Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;(no&nbsp;subject)&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;2,&nbsp;2014&nbsp;at&nbsp;12:42&nbsp;PM,&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;admin@mesra.my&gt;&nbsp;<br>
wrote:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Dear&nbsp;Josh,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;for&nbsp;idea,&nbsp;anyway&nbsp;I&nbsp;found&nbsp;this:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;#&nbsp;Forbid&nbsp;file&nbsp;upload&nbsp;&lt;/div&gt;<br>
&lt;div&gt;SecFilterSelective&nbsp;&quot;HTTP_CONTENT_TYPE&quot;&nbsp;multipart/form-data&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Hi,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;SecFilterSelective&nbsp;is&nbsp;no&nbsp;longer&nbsp;a&nbsp;valid&nbsp;ModSec&nbsp;directive.&nbsp;&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;But&nbsp;how&nbsp;can&nbsp;I&nbsp;combine&nbsp;the&nbsp;rule&nbsp;with&nbsp;country&nbsp;limit&nbsp;?&nbsp;I’m&nbsp;very&nbsp;sorry&nbsp;and&nbsp;I’m&nbsp;<br>
still&nbsp;blur.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;GEO:COUNTRY_CODE3&nbsp;&quot;!@streq&nbsp;JPN&quot;&nbsp;<br>
&quot;id:2,phase:1,t:none,log,deny,msg:&#39;Client&nbsp;IP&nbsp;not&nbsp;from&nbsp;<br>
Japan&#39;,chain&quot;    &nbsp;&lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;REQUEST_HEADERS:Content-Type&nbsp;&quot;multipart/form-data&quot;&nbsp;<br>
t:none,t:lowercase&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;-&nbsp;Josh&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Please&nbsp;help&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;From:&nbsp;Josh&nbsp;Amishav-Zlatin&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Sent:&nbsp;Tuesday,&nbsp;September&nbsp;02,&nbsp;2014&nbsp;5:32&nbsp;PM&lt;/div&gt;<br>
&lt;div&gt;To:&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Cc:&nbsp;OWASP&nbsp;Mod&nbsp;Security&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;(no&nbsp;subject)&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;2,&nbsp;2014&nbsp;at&nbsp;11:38&nbsp;AM,&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;admin@mesra.my&gt;&nbsp;<br>
wrote:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Dear&nbsp;Josh,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Thanks&nbsp;you&nbsp;so&nbsp;much&nbsp;for&nbsp;your&nbsp;help,&nbsp;but&nbsp;I&nbsp;think&nbsp;that&nbsp;only&nbsp;for&nbsp;the&nbsp;file&nbsp;name&nbsp;<br>
UploadFiles.aspx,&nbsp;how&nbsp;about&nbsp;globally&nbsp;upload,&nbsp;&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Hi,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;One&nbsp;way&nbsp;to&nbsp;implement&nbsp;this&nbsp;could&nbsp;be&nbsp;to&nbsp;update&nbsp;the&nbsp;chained&nbsp;rule&nbsp;to&nbsp;search&nbsp;for&nbsp;<br>
the&nbsp;presence&nbsp;of&nbsp;multipart/form-data&nbsp;in&nbsp;the&nbsp;REQUEST_HEADERS:Content-Type&nbsp;variable&nbsp;<br>
instead.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;-&nbsp;Josh&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;frankly&nbsp;speaking&nbsp;I&nbsp;try&nbsp;to&nbsp;protect&nbsp;what&nbsp;ever&nbsp;upload&nbsp;by&nbsp;the&nbsp;hackers&nbsp;from&nbsp;the&nbsp;<br>
buggy&nbsp;script&nbsp;of&nbsp;Joomla&nbsp;or&nbsp;Wordpress,&nbsp;lately&nbsp;I’m&nbsp;facing&nbsp;a&nbsp;lot&nbsp;of&nbsp;trouble&nbsp;were&nbsp;<br>
hackers&nbsp;upload&nbsp;their&nbsp;files&nbsp;and&nbsp;run&nbsp;the&nbsp;script&nbsp;for&nbsp;sending&nbsp;thousands&nbsp;of&nbsp;spam&nbsp;<br>
mail.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Please&nbsp;help&nbsp;and&nbsp;Thank&nbsp;you&nbsp;so&nbsp;much&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;From:&nbsp;Josh&nbsp;Amishav-Zlatin&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Sent:&nbsp;Tuesday,&nbsp;September&nbsp;02,&nbsp;2014&nbsp;4:32&nbsp;PM&lt;/div&gt;<br>
&lt;div&gt;To:&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Cc:&nbsp;OWASP&nbsp;Mod&nbsp;Security&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;(no&nbsp;subject)&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;On&nbsp;Tue,&nbsp;Sep&nbsp;2,&nbsp;2014&nbsp;at&nbsp;3:34&nbsp;AM,&nbsp;Mesra.net&nbsp;CEO&nbsp;&lt;admin@mesra.my&gt;&nbsp;<br>
wrote:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Dear&nbsp;All,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;I’m&nbsp;looking&nbsp;the&nbsp;rule&nbsp;for&nbsp;allow&nbsp;upload&nbsp;for&nbsp;only&nbsp;specific&nbsp;country,&nbsp;for&nbsp;<br>
example&nbsp;I&nbsp;will&nbsp;allow&nbsp;only&nbsp;Japan&nbsp;to&nbsp;upload&nbsp;any&nbsp;type&nbsp;of&nbsp;files&nbsp;to&nbsp;upload&nbsp;and&nbsp;the&nbsp;<br>
rest&nbsp;countries&nbsp;will&nbsp;Access&nbsp;denied.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Hi,&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;First&nbsp;you&nbsp;need&nbsp;to&nbsp;define&nbsp;where&nbsp;the&nbsp;GeoDB&nbsp;is.&nbsp;This&nbsp;can&nbsp;be&nbsp;done&nbsp;in&nbsp;the&nbsp;CRS&nbsp;10&nbsp;<br>
file.&nbsp;&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;SecGeoLookupDb&nbsp;/opt/modsecurity/bin/GeoLiteCity.dat&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Next&nbsp;you&nbsp;need&nbsp;to&nbsp;pass&nbsp;the&nbsp;client&#39;s&nbsp;IP&nbsp;address&nbsp;(REMOTE_ADDR)&nbsp;to&nbsp;the&nbsp;<br>
@geoLookup&nbsp;operator&nbsp;via&nbsp;a&nbsp;rule&nbsp;like:&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;@geoLookup&quot;&nbsp;&quot;id:1,phase:1,t:none,pass,nolog&quot;&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Finally&nbsp;you&nbsp;limit&nbsp;access&nbsp;to&nbsp;the&nbsp;upload&nbsp;script&nbsp;(e.g.&nbsp;/UploadFiles.aspx)&nbsp;to&nbsp;<br>
client&nbsp;IP&nbsp;addresses&nbsp;originating&nbsp;in&nbsp;Japan&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;GEO:COUNTRY_CODE3&nbsp;&quot;!@streq&nbsp;JPN&quot;&nbsp;<br>
&quot;id:2,phase:1,t:none,log,deny,msg:&#39;Client&nbsp;IP&nbsp;not&nbsp;from&nbsp;<br>
Japan&#39;,chain&quot;    &nbsp;&lt;/div&gt;<br>
&lt;div&gt;   &nbsp;SecRule&nbsp;REQUEST_URI&nbsp;&quot;@rx&nbsp;/UploadFiles.aspx&quot;&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Note,&nbsp;this&nbsp;was&nbsp;not&nbsp;tested&nbsp;YMMV.&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;-&nbsp;Josh&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;Please&nbsp;help&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt;_______________________________________________&lt;/div&gt;<br>
&lt;div&gt;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;/div&gt;<br>
&lt;div&gt;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;<br>
&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
