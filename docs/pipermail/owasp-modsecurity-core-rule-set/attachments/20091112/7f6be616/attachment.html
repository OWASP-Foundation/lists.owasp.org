<tt>
<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Ryan,&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;Thanks<br>
for&nbsp;your&nbsp;response.&nbsp;What&nbsp;I&nbsp;was&nbsp;trying&nbsp;to&nbsp;get&nbsp;at&nbsp;and&nbsp;maybe&nbsp;didn't&nbsp;explain<br>
myself&nbsp;very&nbsp;well,&nbsp;is&nbsp;that&nbsp;I'm&nbsp;trying&nbsp;to&nbsp;decide&nbsp;whether&nbsp;or&nbsp;not&nbsp;I&nbsp;should<br>
simply&nbsp;write&nbsp;an&nbsp;exception,&nbsp;or&nbsp;whether&nbsp;or&nbsp;not&nbsp;the&nbsp;false/positive&nbsp;requires<br>
an&nbsp;application&nbsp;code&nbsp;review.&nbsp;Without&nbsp;the&nbsp;rational/documentation&nbsp;behind&nbsp;the<br>
rule&nbsp;that's&nbsp;an&nbsp;extremely&nbsp;difficult&nbsp;call&nbsp;to&nbsp;make.&nbsp;(I.E&nbsp;using&nbsp;the&nbsp;rule&nbsp;I<br>
below&nbsp;as&nbsp;an&nbsp;example&nbsp;which&nbsp;triggered&nbsp;on&nbsp;the&nbsp;word&nbsp;&amp;quot;back&amp;quot;&nbsp;within<br>
the&nbsp;Request_Body.)&nbsp;Or&nbsp;am&nbsp;I&nbsp;simply&nbsp;missing&nbsp;the&nbsp;point&nbsp;and&nbsp;the&nbsp;standard&nbsp;procedure<br>
should&nbsp;simply&nbsp;be&nbsp;to&nbsp;write&nbsp;an&nbsp;exception&nbsp;for&nbsp;each&nbsp;false/positive?&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Best&nbsp;regards&nbsp;Andy&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;table&nbsp;width=100%&gt;<br>
&lt;tr&nbsp;valign=top&gt;<br>
&lt;td&nbsp;width=40%&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;&lt;b&gt;Ryan&nbsp;Barnett&nbsp;&amp;lt;Ryan.Barnett@breach.com&amp;gt;&lt;/b&gt;<br>
&lt;/font&gt;<br>
&lt;p&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;12/11/2009&nbsp;12:14&lt;/font&gt;<br>
&lt;td&nbsp;width=59%&gt;<br>
&lt;table&nbsp;width=100%&gt;<br>
&lt;tr&nbsp;valign=top&gt;<br>
&lt;td&gt;<br>
&lt;div&nbsp;align=right&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;To&lt;/font&gt;&lt;/div&gt;<br>
&lt;td&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;&amp;quot;andy.p.smith@ba.com&amp;quot;&nbsp;&amp;lt;andy.p.smith@ba.com&amp;gt;&lt;br&gt;<br>
&amp;quot;owasp-modsecurity-core-rule-set@lists.owasp.org&amp;quot;&nbsp;&amp;lt;owasp-modsecurity-core-rule-set@lists.owasp.org&amp;gt;&lt;/font&gt;<br>
&lt;tr&nbsp;valign=top&gt;<br>
&lt;td&gt;<br>
&lt;div&nbsp;align=right&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;cc&lt;/font&gt;&lt;/div&gt;<br>
&lt;td&gt;<br>
&lt;tr&nbsp;valign=top&gt;<br>
&lt;td&gt;<br>
&lt;div&nbsp;align=right&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;Subject&lt;/font&gt;&lt;/div&gt;<br>
&lt;td&gt;&lt;font&nbsp;size=1&nbsp;face=&quot;sans-serif&quot;&gt;Re:&nbsp;[Owasp-modsecurity-core-rule-set]<br>
Documentation&lt;/font&gt;&lt;/table&gt;<br>
&lt;br&gt;<br>
&lt;table&gt;<br>
&lt;tr&nbsp;valign=top&gt;<br>
&lt;td&gt;<br>
&lt;td&gt;&lt;/table&gt;<br>
&lt;br&gt;&lt;/table&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;color=#000080&nbsp;face=&quot;Arial&quot;&gt;Andy-&lt;br&gt;<br>
With&nbsp;the&nbsp;current&nbsp;CRS&nbsp;one&nbsp;of&nbsp;our&nbsp;goals&nbsp;was&nbsp;to&nbsp;make&nbsp;it&nbsp;easier&nbsp;for&nbsp;users&nbsp;to<br>
handle&nbsp;false&nbsp;positive&nbsp;changes&nbsp;*externally*&nbsp;from&nbsp;the&nbsp;rules&nbsp;themselves.&nbsp;Most<br>
users&nbsp;did&nbsp;want&nbsp;to&nbsp;edit&nbsp;rules&nbsp;directly&nbsp;for&nbsp;fear&nbsp;of&nbsp;munging&nbsp;a&nbsp;regex&nbsp;or&nbsp;if<br>
they&nbsp;did&nbsp;heavy&nbsp;customizations&nbsp;then&nbsp;they&nbsp;wouldn't&nbsp;want&nbsp;to&nbsp;upgrade&nbsp;;)&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;way&nbsp;we&nbsp;addressed&nbsp;this&nbsp;was&nbsp;to&nbsp;have&nbsp;the&nbsp;rules&nbsp;set&nbsp;TX&nbsp;variables&nbsp;that&nbsp;hold<br>
metadata&nbsp;about&nbsp;the&nbsp;match.&nbsp;With&nbsp;this&nbsp;approach,&nbsp;you&nbsp;can&nbsp;create&nbsp;exceptions<br>
in&nbsp;the&nbsp;48&nbsp;local&nbsp;exceptions&nbsp;file&nbsp;that&nbsp;can&nbsp;inspect&nbsp;TX&nbsp;data&nbsp;for&nbsp;the&nbsp;false<br>
positive&nbsp;match&nbsp;and&nbsp;then&nbsp;simply&nbsp;expire&nbsp;the&nbsp;variable&nbsp;and/or&nbsp;adjust&nbsp;the&nbsp;anomaly<br>
score.&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;your&nbsp;direct&nbsp;question&nbsp;about&nbsp;the&nbsp;intent&nbsp;of&nbsp;this&nbsp;exact&nbsp;rule&nbsp;-&nbsp;this&nbsp;is&nbsp;an<br>
imported&nbsp;phpids&nbsp;rule&nbsp;which&nbsp;was&nbsp;developed&nbsp;from&nbsp;community&nbsp;testing&nbsp;with&nbsp;their<br>
demo&nbsp;page.&nbsp;If&nbsp;you&nbsp;want&nbsp;details&nbsp;about&nbsp;the&nbsp;regex&nbsp;logic&nbsp;-&nbsp;I&nbsp;suggest&nbsp;you&nbsp;pop<br>
it&nbsp;into&nbsp;something&nbsp;like&nbsp;Expresso&nbsp;and&nbsp;it&nbsp;will&nbsp;give&nbsp;info.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Ryan&nbsp;C.&nbsp;Barnett&nbsp;&lt;br&gt;<br>
Director&nbsp;of&nbsp;Application&nbsp;Security&nbsp;Research&nbsp;&lt;br&gt;<br>
Breach&nbsp;Security,&nbsp;Inc.&nbsp;&lt;br&gt;<br>
Ryan.Barnett@Breach.com&nbsp;&lt;br&gt;<br>
www.Breach.com&nbsp;&lt;/font&gt;<br>
&lt;p&gt;<br>
&lt;hr&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;Tahoma&quot;&gt;&lt;b&gt;From&lt;/b&gt;:&nbsp;owasp-modsecurity-core-rule-set-bounces@lists.owasp.org<br>
&lt;b&gt;&lt;br&gt;<br>
To&lt;/b&gt;:&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&nbsp;&lt;b&gt;&lt;br&gt;<br>
Sent&lt;/b&gt;:&nbsp;Thu&nbsp;Nov&nbsp;12&nbsp;06:37:49&nbsp;2009&lt;b&gt;&lt;br&gt;<br>
Subject&lt;/b&gt;:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Documentation&nbsp;&lt;/font&gt;<br>
&lt;p&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
Hi&nbsp;All,&lt;/font&gt;&lt;font&nbsp;size=3&gt;&nbsp;&lt;br&gt;<br>
&lt;/font&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;I&nbsp;am&nbsp;a&nbsp;new&nbsp;to&nbsp;mod_security&nbsp;and&nbsp;have&nbsp;just&nbsp;started<br>
to&nbsp;test&nbsp;some&nbsp;of&nbsp;our&nbsp;external&nbsp;facing&nbsp;applications&nbsp;against&nbsp;the&nbsp;latest&nbsp;realease<br>
of&nbsp;mod_security&nbsp;and&nbsp;the&nbsp;latest&nbsp;OWASP&nbsp;CRS,&nbsp;(2.0.3).&nbsp;Whilst&nbsp;I&nbsp;am&nbsp;seeing&nbsp;a<br>
fair&nbsp;number&nbsp;of&nbsp;false&nbsp;positives,&nbsp;mainly&nbsp;againast&nbsp;Request_Body&nbsp;checking,<br>
which&nbsp;was&nbsp;to&nbsp;be&nbsp;expected,&nbsp;I'm&nbsp;struggling&nbsp;to&nbsp;ascertain&nbsp;what&nbsp;the&nbsp;best&nbsp;path<br>
forward&nbsp;is&nbsp;for&nbsp;each&nbsp;false&nbsp;positive,&nbsp;based&nbsp;on&nbsp;the&nbsp;rational&nbsp;that&nbsp;I&nbsp;don't<br>
know&nbsp;why&nbsp;each&nbsp;rule&nbsp;has&nbsp;been&nbsp;written&nbsp;the&nbsp;way&nbsp;it&nbsp;is.&nbsp;Does&nbsp;anybody&nbsp;know&nbsp;if<br>
there&nbsp;is&nbsp;any&nbsp;documentation,&nbsp;other&nbsp;than&nbsp;just&nbsp;the&nbsp;comments&nbsp;within&nbsp;the&nbsp;ruleset,<br>
which&nbsp;further&nbsp;describe&nbsp;the&nbsp;rational&nbsp;behind&nbsp;the&nbsp;regex&nbsp;and&nbsp;literal&nbsp;expressions<br>
tracked&nbsp;within&nbsp;each&nbsp;rule?&lt;/font&gt;&lt;font&nbsp;size=3&gt;&nbsp;&lt;br&gt;<br>
&lt;/font&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;An&nbsp;example&nbsp;of&nbsp;a&nbsp;rule&nbsp;that&nbsp;seems&nbsp;to&nbsp;be&nbsp;hit&nbsp;a<br>
large&nbsp;number&nbsp;of&nbsp;times&nbsp;is&nbsp;line&nbsp;93&nbsp;from&nbsp;&amp;quot;modsecurity_crs_41_phpids_filters.conf&amp;quot;<br>
&lt;/font&gt;&lt;font&nbsp;size=3&gt;&lt;br&gt;<br>
&lt;/font&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
SecRule&nbsp;REQUEST_BODY|REQUEST_URI_RAW|ARGS|ARGS_NAMES|FILES|FILES_NAMES|XML:/*<br>
&amp;quot;([^*:\s\w,.\/?+-]\s*)?(?&amp;lt;![a-z]\s)(?&amp;lt;![a-z\/_@&amp;gt;\|])(\s*return\s*)?(?:hash|name|href|navigateandfind|source|pathname|close|constructor|port|protocol|assign|replace|back|forward|document|ownerdocument|window|self|parent|frames|_?content|date|cookie|innerhtml|innertext|csstext+?|outerhtml|print|moveby|resizeto|createstylesheet|stylesheets)(?(1)[^\w%\&amp;quot;]|(?:\s*[^@\/\s\w%,.+\-]))&amp;quot;<br>
&amp;quot;phase:2,capture,multiMatch,t:none,t:urlDecodeUni,t:urlDecodeUni,t:htmlEntityDecode,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,nolog,auditlog,msg:'Detects<br>
JavaScript&nbsp;object&nbsp;properties&nbsp;and&nbsp;methods',id:'phpids-17',tag:'WEB_ATTACK',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}&amp;quot;&lt;/font&gt;&lt;font&nbsp;size=3&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;I&nbsp;am&nbsp;finding&nbsp;many&nbsp;url&nbsp;strings&nbsp;that&nbsp;are&nbsp;matching<br>
the&nbsp;literals&nbsp;within&nbsp;this&nbsp;rule&nbsp;and&nbsp;could&nbsp;really&nbsp;do&nbsp;with&nbsp;some&nbsp;documentation<br>
to&nbsp;justify&nbsp;any&nbsp;action&nbsp;that&nbsp;I&nbsp;think&nbsp;is&nbsp;appropriate&nbsp;to&nbsp;my&nbsp;Information&nbsp;Assurance/Security<br>
department.&lt;/font&gt;&lt;font&nbsp;size=3&gt;&nbsp;&lt;br&gt;<br>
&lt;/font&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
Best&nbsp;regards&nbsp;Andy&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------------------------------------------------------------------------------------&lt;br&gt;<br>
Get&nbsp;the&nbsp;best&nbsp;from&nbsp;British&nbsp;Airways&nbsp;at&nbsp;ba.com&lt;br&gt;<br>
http://www.ba.com&lt;/font&gt;<br>
&lt;br&gt;&lt;tt&gt;&lt;font&nbsp;size=3&gt;--&lt;br&gt;<br>
This&nbsp;message&nbsp;is&nbsp;private&nbsp;and&nbsp;confidential&nbsp;and&nbsp;may&nbsp;also&nbsp;be&nbsp;legally&nbsp;privileged.<br>
&amp;nbsp;If&nbsp;you&nbsp;have&nbsp;received&nbsp;this&nbsp;message&nbsp;in&nbsp;error,&nbsp;please&nbsp;email&nbsp;it&nbsp;back<br>
to&nbsp;the&nbsp;sender&nbsp;and&nbsp;immediately&nbsp;permanently&nbsp;delete&nbsp;it&nbsp;from&nbsp;your&nbsp;computer<br>
system.&nbsp;&amp;nbsp;Please&nbsp;do&nbsp;not&nbsp;read,&nbsp;print,&nbsp;re-transmit,&nbsp;store&nbsp;or&nbsp;act&nbsp;in&nbsp;reliance<br>
on&nbsp;it&nbsp;or&nbsp;any&nbsp;attachments.&lt;br&gt;<br>
&lt;br&gt;<br>
British&nbsp;Airways&nbsp;may&nbsp;monitor&nbsp;email&nbsp;traffic&nbsp;data&nbsp;and&nbsp;also&nbsp;the&nbsp;content&nbsp;of<br>
emails,&nbsp;where&nbsp;permitted&nbsp;by&nbsp;law,&nbsp;for&nbsp;the&nbsp;purposes&nbsp;of&nbsp;security&nbsp;and&nbsp;staff<br>
training&nbsp;and&nbsp;in&nbsp;order&nbsp;to&nbsp;prevent&nbsp;or&nbsp;detect&nbsp;unauthorised&nbsp;use&nbsp;of&nbsp;the&nbsp;British<br>
Airways&nbsp;email&nbsp;system.&lt;br&gt;<br>
&lt;br&gt;<br>
Virus&nbsp;checking&nbsp;of&nbsp;emails&nbsp;(including&nbsp;attachments)&nbsp;is&nbsp;the&nbsp;responsibility<br>
of&nbsp;the&nbsp;recipient.&lt;br&gt;<br>
&lt;br&gt;<br>
British&nbsp;Airways&nbsp;Plc&nbsp;is&nbsp;a&nbsp;public&nbsp;limited&nbsp;company&nbsp;registered&nbsp;in&nbsp;England&nbsp;and<br>
Wales.&nbsp;&amp;nbsp;Registered&nbsp;number:&nbsp;1777777.&nbsp;&amp;nbsp;Registered&nbsp;office:&nbsp;Waterside,<br>
PO&nbsp;Box&nbsp;365,&nbsp;Harmondsworth,&nbsp;West&nbsp;Drayton,&nbsp;Middlesex,&nbsp;England,&nbsp;UB7&nbsp;0GB.&lt;br&gt;<br>
&lt;br&gt;<br>
Additional&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;are&nbsp;available&nbsp;on&nbsp;our&nbsp;website:&nbsp;www.ba.com&lt;br&gt;<br>
&lt;/font&gt;&lt;/tt&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------------------------------------------------------------------------------------&lt;br&gt;<br>
Get&nbsp;the&nbsp;best&nbsp;from&nbsp;British&nbsp;Airways&nbsp;at&nbsp;ba.com&lt;br&gt;<br>
http://www.ba.com&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;pre&gt;--<br>
This&nbsp;message&nbsp;is&nbsp;private&nbsp;and&nbsp;confidential&nbsp;and&nbsp;may&nbsp;also&nbsp;be&nbsp;legally&nbsp;privileged.&nbsp;&nbsp;If&nbsp;you&nbsp;have&nbsp;received&nbsp;this&nbsp;message&nbsp;in&nbsp;error,&nbsp;please&nbsp;email&nbsp;it&nbsp;back&nbsp;to&nbsp;the&nbsp;sender&nbsp;and&nbsp;immediately&nbsp;permanently&nbsp;delete&nbsp;it&nbsp;from&nbsp;your&nbsp;computer&nbsp;system.&nbsp;&nbsp;Please&nbsp;do&nbsp;not&nbsp;read,&nbsp;print,&nbsp;re-transmit,&nbsp;store&nbsp;or&nbsp;act&nbsp;in&nbsp;reliance&nbsp;on&nbsp;it&nbsp;or&nbsp;any&nbsp;attachments.<br>
<br>
British&nbsp;Airways&nbsp;may&nbsp;monitor&nbsp;email&nbsp;traffic&nbsp;data&nbsp;and&nbsp;also&nbsp;the&nbsp;content&nbsp;of&nbsp;emails,&nbsp;where&nbsp;permitted&nbsp;by&nbsp;law,&nbsp;for&nbsp;the&nbsp;purposes&nbsp;of&nbsp;security&nbsp;and&nbsp;staff&nbsp;training&nbsp;and&nbsp;in&nbsp;order&nbsp;to&nbsp;prevent&nbsp;or&nbsp;detect&nbsp;unauthorised&nbsp;use&nbsp;of&nbsp;the&nbsp;British&nbsp;Airways&nbsp;email&nbsp;system.<br>
<br>
Virus&nbsp;checking&nbsp;of&nbsp;emails&nbsp;(including&nbsp;attachments)&nbsp;is&nbsp;the&nbsp;responsibility&nbsp;of&nbsp;the&nbsp;recipient.<br>
<br>
British&nbsp;Airways&nbsp;Plc&nbsp;is&nbsp;a&nbsp;public&nbsp;limited&nbsp;company&nbsp;registered&nbsp;in&nbsp;England&nbsp;and&nbsp;Wales.&nbsp;&nbsp;Registered&nbsp;number:&nbsp;1777777.&nbsp;&nbsp;Registered&nbsp;office:&nbsp;Waterside,&nbsp;PO&nbsp;Box&nbsp;365,&nbsp;Harmondsworth,&nbsp;West&nbsp;Drayton,&nbsp;Middlesex,&nbsp;England,&nbsp;UB7&nbsp;0GB.<br>
<br>
Additional&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;are&nbsp;available&nbsp;on&nbsp;our&nbsp;website:&nbsp;www.ba.com<br>

</tt>
