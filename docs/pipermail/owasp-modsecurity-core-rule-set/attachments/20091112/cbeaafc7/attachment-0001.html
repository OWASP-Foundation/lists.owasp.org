<tt>
&lt;p&gt;&lt;font&nbsp;size=2&nbsp;color=navy&nbsp;face=Arial&gt;<br>
Andy-&lt;br&gt;With&nbsp;the&nbsp;current&nbsp;CRS&nbsp;one&nbsp;of&nbsp;our&nbsp;goals&nbsp;was&nbsp;to&nbsp;make&nbsp;it&nbsp;easier&nbsp;for&nbsp;users&nbsp;to&nbsp;handle&nbsp;false&nbsp;positive&nbsp;changes&nbsp;*externally*&nbsp;from&nbsp;the&nbsp;rules&nbsp;themselves.&nbsp;&nbsp;Most&nbsp;users&nbsp;did&nbsp;want&nbsp;to&nbsp;edit&nbsp;rules&nbsp;directly&nbsp;for&nbsp;fear&nbsp;of&nbsp;munging&nbsp;a&nbsp;regex&nbsp;or&nbsp;if&nbsp;they&nbsp;did&nbsp;heavy&nbsp;customizations&nbsp;then&nbsp;they&nbsp;wouldn't&nbsp;want&nbsp;to&nbsp;upgrade&nbsp;;)&lt;br&gt;&lt;br&gt;The&nbsp;way&nbsp;we&nbsp;addressed&nbsp;this&nbsp;was&nbsp;to&nbsp;have&nbsp;the&nbsp;rules&nbsp;set&nbsp;TX&nbsp;variables&nbsp;that&nbsp;hold&nbsp;metadata&nbsp;about&nbsp;the&nbsp;match.&nbsp;&nbsp;With&nbsp;this&nbsp;approach,&nbsp;you&nbsp;can&nbsp;create&nbsp;exceptions&nbsp;in&nbsp;the&nbsp;48&nbsp;local&nbsp;exceptions&nbsp;file&nbsp;that&nbsp;can&nbsp;inspect&nbsp;TX&nbsp;data&nbsp;for&nbsp;the&nbsp;false&nbsp;positive&nbsp;match&nbsp;and&nbsp;then&nbsp;simply&nbsp;expire&nbsp;the&nbsp;variable&nbsp;and/or&nbsp;adjust&nbsp;the&nbsp;anomaly&nbsp;score.&lt;br&gt;&lt;br&gt;To&nbsp;your&nbsp;direct&nbsp;question&nbsp;about&nbsp;the&nbsp;intent&nbsp;of&nbsp;this&nbsp;exact&nbsp;rule&nbsp;-&nbsp;this&nbsp;is&nbsp;an&nbsp;imported&nbsp;phpids&nbsp;rule&nbsp;which&nbsp;was&nbsp;developed&nbsp;from&nbsp;community&nbsp;testing&nbsp;with&nbsp;their&nbsp;demo&nbsp;page.&nbsp;&nbsp;If&nbsp;you&nbsp;want&nbsp;details&nbsp;about&nbsp;the&nbsp;regex&nbsp;logic&nbsp;-&nbsp;I&nbsp;suggest&nbsp;you&nbsp;pop&nbsp;it&nbsp;into&nbsp;something&nbsp;like&nbsp;Expresso&nbsp;and&nbsp;it&nbsp;will&nbsp;give&nbsp;info.&lt;br&gt;&lt;br&gt;&lt;br&gt;Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;Director&nbsp;of&nbsp;Application&nbsp;Security&nbsp;Research&lt;br&gt;Breach&nbsp;Security,&nbsp;Inc.&lt;br&gt;Ryan.Barnett@Breach.com&nbsp;&lt;br&gt;www.Breach.com&nbsp;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;hr&nbsp;size=2&nbsp;width=&quot;100%&quot;&nbsp;align=center&nbsp;tabindex=-1&gt;<br>
&lt;font&nbsp;face=Tahoma&nbsp;size=2&gt;<br>
&lt;b&gt;From&lt;/b&gt;:&nbsp;owasp-modsecurity-core-rule-set-bounces@lists.owasp.org&nbsp;&lt;owasp-modsecurity-core-rule-set-bounces@lists.owasp.org&gt;&lt;br&gt;&lt;b&gt;To&lt;/b&gt;:&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&nbsp;&lt;owasp-modsecurity-core-rule-set@lists.owasp.org&gt;&lt;br&gt;&lt;b&gt;Sent&lt;/b&gt;:&nbsp;Thu&nbsp;Nov&nbsp;12&nbsp;06:37:49&nbsp;2009&lt;br&gt;&lt;b&gt;Subject&lt;/b&gt;:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Documentation&lt;br&gt;&lt;/font&gt;&lt;/p&gt;<br>
<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Hi&nbsp;All,&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;I<br>
am&nbsp;a&nbsp;new&nbsp;to&nbsp;mod_security&nbsp;and&nbsp;have&nbsp;just&nbsp;started&nbsp;to&nbsp;test&nbsp;some&nbsp;of&nbsp;our&nbsp;external<br>
facing&nbsp;applications&nbsp;against&nbsp;the&nbsp;latest&nbsp;realease&nbsp;of&nbsp;mod_security&nbsp;and&nbsp;the<br>
latest&nbsp;OWASP&nbsp;CRS,&nbsp;(2.0.3).&nbsp;Whilst&nbsp;I&nbsp;am&nbsp;seeing&nbsp;a&nbsp;fair&nbsp;number&nbsp;of&nbsp;false&nbsp;positives,<br>
mainly&nbsp;againast&nbsp;Request_Body&nbsp;checking,&nbsp;which&nbsp;was&nbsp;to&nbsp;be&nbsp;expected,&nbsp;I'm&nbsp;struggling<br>
to&nbsp;ascertain&nbsp;what&nbsp;the&nbsp;best&nbsp;path&nbsp;forward&nbsp;is&nbsp;for&nbsp;each&nbsp;false&nbsp;positive,&nbsp;based<br>
on&nbsp;the&nbsp;rational&nbsp;that&nbsp;I&nbsp;don't&nbsp;know&nbsp;why&nbsp;each&nbsp;rule&nbsp;has&nbsp;been&nbsp;written&nbsp;the&nbsp;way<br>
it&nbsp;is.&nbsp;Does&nbsp;anybody&nbsp;know&nbsp;if&nbsp;there&nbsp;is&nbsp;any&nbsp;documentation,&nbsp;other&nbsp;than&nbsp;just<br>
the&nbsp;comments&nbsp;within&nbsp;the&nbsp;ruleset,&nbsp;which&nbsp;further&nbsp;describe&nbsp;the&nbsp;rational&nbsp;behind<br>
the&nbsp;regex&nbsp;and&nbsp;literal&nbsp;expressions&nbsp;tracked&nbsp;within&nbsp;each&nbsp;rule?&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;An<br>
example&nbsp;of&nbsp;a&nbsp;rule&nbsp;that&nbsp;seems&nbsp;to&nbsp;be&nbsp;hit&nbsp;a&nbsp;large&nbsp;number&nbsp;of&nbsp;times&nbsp;is&nbsp;line<br>
93&nbsp;from&nbsp;&amp;quot;modsecurity_crs_41_phpids_filters.conf&amp;quot;&nbsp;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;REQUEST_BODY|REQUEST_URI_RAW|ARGS|ARGS_NAMES|FILES|FILES_NAMES|XML:/*<br>
&amp;quot;([^*:\s\w,.\/?+-]\s*)?(?&amp;lt;![a-z]\s)(?&amp;lt;![a-z\/_@&amp;gt;\|])(\s*return\s*)?(?:hash|name|href|navigateandfind|source|pathname|close|constructor|port|protocol|assign|replace|back|forward|document|ownerdocument|window|self|parent|frames|_?content|date|cookie|innerhtml|innertext|csstext+?|outerhtml|print|moveby|resizeto|createstylesheet|stylesheets)(?(1)[^\w%\&amp;quot;]|(?:\s*[^@\/\s\w%,.+\-]))&amp;quot;<br>
&amp;quot;phase:2,capture,multiMatch,t:none,t:urlDecodeUni,t:urlDecodeUni,t:htmlEntityDecode,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,block,nolog,auditlog,msg:'Detects<br>
JavaScript&nbsp;object&nbsp;properties&nbsp;and&nbsp;methods',id:'phpids-17',tag:'WEB_ATTACK',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+20,setvar:tx.%{rule.id}-WEB_ATTACK-%{matched_var_name}=%{matched_var}&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;I<br>
am&nbsp;finding&nbsp;many&nbsp;url&nbsp;strings&nbsp;that&nbsp;are&nbsp;matching&nbsp;the&nbsp;literals&nbsp;within&nbsp;this<br>
rule&nbsp;and&nbsp;could&nbsp;really&nbsp;do&nbsp;with&nbsp;some&nbsp;documentation&nbsp;to&nbsp;justify&nbsp;any&nbsp;action<br>
that&nbsp;I&nbsp;think&nbsp;is&nbsp;appropriate&nbsp;to&nbsp;my&nbsp;Information&nbsp;Assurance/Security&nbsp;department.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Best&nbsp;regards&nbsp;Andy&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------------------------------------------------------------------------------------&lt;br&gt;<br>
Get&nbsp;the&nbsp;best&nbsp;from&nbsp;British&nbsp;Airways&nbsp;at&nbsp;ba.com&lt;br&gt;<br>
http://www.ba.com&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;pre&gt;--<br>
This&nbsp;message&nbsp;is&nbsp;private&nbsp;and&nbsp;confidential&nbsp;and&nbsp;may&nbsp;also&nbsp;be&nbsp;legally&nbsp;privileged.&nbsp;&nbsp;If&nbsp;you&nbsp;have&nbsp;received&nbsp;this&nbsp;message&nbsp;in&nbsp;error,&nbsp;please&nbsp;email&nbsp;it&nbsp;back&nbsp;to&nbsp;the&nbsp;sender&nbsp;and&nbsp;immediately&nbsp;permanently&nbsp;delete&nbsp;it&nbsp;from&nbsp;your&nbsp;computer&nbsp;system.&nbsp;&nbsp;Please&nbsp;do&nbsp;not&nbsp;read,&nbsp;print,&nbsp;re-transmit,&nbsp;store&nbsp;or&nbsp;act&nbsp;in&nbsp;reliance&nbsp;on&nbsp;it&nbsp;or&nbsp;any&nbsp;attachments.<br>
<br>
British&nbsp;Airways&nbsp;may&nbsp;monitor&nbsp;email&nbsp;traffic&nbsp;data&nbsp;and&nbsp;also&nbsp;the&nbsp;content&nbsp;of&nbsp;emails,&nbsp;where&nbsp;permitted&nbsp;by&nbsp;law,&nbsp;for&nbsp;the&nbsp;purposes&nbsp;of&nbsp;security&nbsp;and&nbsp;staff&nbsp;training&nbsp;and&nbsp;in&nbsp;order&nbsp;to&nbsp;prevent&nbsp;or&nbsp;detect&nbsp;unauthorised&nbsp;use&nbsp;of&nbsp;the&nbsp;British&nbsp;Airways&nbsp;email&nbsp;system.<br>
<br>
Virus&nbsp;checking&nbsp;of&nbsp;emails&nbsp;(including&nbsp;attachments)&nbsp;is&nbsp;the&nbsp;responsibility&nbsp;of&nbsp;the&nbsp;recipient.<br>
<br>
British&nbsp;Airways&nbsp;Plc&nbsp;is&nbsp;a&nbsp;public&nbsp;limited&nbsp;company&nbsp;registered&nbsp;in&nbsp;England&nbsp;and&nbsp;Wales.&nbsp;&nbsp;Registered&nbsp;number:&nbsp;1777777.&nbsp;&nbsp;Registered&nbsp;office:&nbsp;Waterside,&nbsp;PO&nbsp;Box&nbsp;365,&nbsp;Harmondsworth,&nbsp;West&nbsp;Drayton,&nbsp;Middlesex,&nbsp;England,&nbsp;UB7&nbsp;0GB.<br>
<br>
Additional&nbsp;terms&nbsp;and&nbsp;conditions&nbsp;are&nbsp;available&nbsp;on&nbsp;our&nbsp;website:&nbsp;www.ba.com<br>

</tt>
