<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Hello&nbsp;Elmar,&lt;br&gt;&lt;/div&gt;how&nbsp;is&nbsp;your&nbsp;SecRuleEngine&nbsp;directive&nbsp;configured?&lt;br&gt;&lt;/div&gt;If&nbsp;it&#39;s&nbsp;in&nbsp;DetectionOnly,&nbsp;as&nbsp;stated&nbsp;in&nbsp;the&nbsp;manual,&nbsp;in&nbsp;this&nbsp;way&nbsp;the&nbsp;WAF&nbsp;engine&nbsp;&quot;process&nbsp;rules&nbsp;but&nbsp;never&nbsp;executes&nbsp;any&nbsp;disruptive&nbsp;actions&nbsp;(block,&nbsp;deny,&nbsp;drop,&nbsp;allow,&nbsp;proxy&nbsp;and&nbsp;redirect)&quot;;&nbsp;rif.&nbsp;&lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecRuleEngine&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecRuleEngine&lt;/a&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;The&nbsp;rule&nbsp;you&nbsp;are&nbsp;speaking&nbsp;about&nbsp;contains&nbsp;the&nbsp;block&nbsp;(disruptive)&nbsp;action.&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;Please&nbsp;return&nbsp;us&nbsp;your&nbsp;feedback.&lt;br&gt;&lt;br&gt;&lt;/div&gt;Regards&lt;br&gt;&lt;/div&gt;Paolo&nbsp;Luise&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;b&gt;&lt;/b&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;blockquote&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;br&gt;<br>
Hello,&lt;br&gt;<br>
&lt;br&gt;<br>
We&#39;re&nbsp;running&nbsp;mod_security&nbsp;plus&nbsp;current&nbsp;CRS&nbsp;(3.0.0-4)&nbsp;as&nbsp;an&nbsp;Apache&nbsp;module&nbsp;here.&lt;br&gt;<br>
I&nbsp;have&nbsp;set&nbsp;paranoia_mode&nbsp;to&nbsp;2,&nbsp;so&nbsp;the&nbsp;rule&nbsp;in&nbsp;question&nbsp;(950100)&nbsp;fires,&nbsp;and&nbsp;it&lt;br&gt;<br>
should&nbsp;translate&nbsp;all&nbsp;internal&nbsp;errors&nbsp;to&nbsp;403s&nbsp;towards&nbsp;the&nbsp;outside.&lt;br&gt;<br>
&lt;br&gt;<br>
Now,&nbsp;some&nbsp;internal&nbsp;errors&nbsp;(500s)&nbsp;are&nbsp;NOT&nbsp;translated&nbsp;to&nbsp;403s.&nbsp;:-(&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;wonder&nbsp;if&nbsp;anybody&nbsp;else&nbsp;has&nbsp;run&nbsp;into&nbsp;this&nbsp;problem&nbsp;and&nbsp;whether&nbsp;there&nbsp;is&lt;br&gt;<br>
a&nbsp;solution&nbsp;out&nbsp;there.&nbsp;Googling&nbsp;got&nbsp;me&nbsp;nowhere&nbsp;yet.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Obfuscated&nbsp;curl,&nbsp;result&nbsp;and&nbsp;log&nbsp;output&nbsp;is&nbsp;below.&lt;br&gt;<br>
&lt;br&gt;<br>
Thank&nbsp;you&nbsp;for&nbsp;any&nbsp;direction&nbsp;you&nbsp;could&nbsp;point&nbsp;me&nbsp;to,&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;Elmar.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
===&nbsp;Client&nbsp;View&nbsp;===&lt;br&gt;<br>
&lt;br&gt;<br>
curl&nbsp;--insecure&nbsp;-X&nbsp;DELETE&nbsp;https://*****&nbsp;-H&nbsp;&#39;accept:&nbsp;application/json&#39;&nbsp;-H&nbsp;&#39;authorization:&nbsp;Basic&nbsp;*****&#39;&nbsp;-H&nbsp;&#39;cache-control:&nbsp;no-cache&#39;&nbsp;-H&nbsp;...&lt;br&gt;<br>
&lt;br&gt;<br>
--&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
{&quot;httpStatus&quot;:&quot;500&quot;,&quot;message&quot;:&lt;wbr&gt;&quot;Internal&nbsp;Server&nbsp;Error&quot;,&quot;requestURI&quot;:&quot;https://*&lt;wbr&gt;****&quot;}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
===&nbsp;Server&nbsp;View&nbsp;===&lt;br&gt;<br>
&lt;br&gt;<br>
--b962e37c-A--&lt;br&gt;<br>
[15/May/2017:14:03:22&nbsp;+0000]&nbsp;**************&nbsp;10.**.**.**&nbsp;61134&nbsp;10.**.**.**&nbsp;443&lt;br&gt;<br>
--b962e37c-B--&lt;br&gt;<br>
DELETE&nbsp;/*****&nbsp;HTTP/1.1&lt;br&gt;<br>
Host:&nbsp;*****&lt;br&gt;<br>
accept:&nbsp;application/json&lt;br&gt;<br>
authorization:&nbsp;Basic&nbsp;*****&lt;br&gt;<br>
cache-control:&nbsp;no-cache&lt;br&gt;<br>
content-type:&nbsp;application/json&lt;br&gt;<br>
&lt;br&gt;<br>
--b962e37c-F--&lt;br&gt;<br>
HTTP/1.1&nbsp;403&nbsp;Forbidden&lt;br&gt;<br>
Strict-Transport-Security:&nbsp;max-age=31536000;&nbsp;includeSubDomains&lt;br&gt;<br>
X-TrackingId:&nbsp;8ab4dc14-fbd0-4ecd-a2e4-&lt;wbr&gt;5697a67017dc&lt;br&gt;<br>
Vary:&nbsp;Accept-Encoding&lt;br&gt;<br>
Content-Type:&nbsp;application/json&lt;br&gt;<br>
Connection:&nbsp;close&lt;br&gt;<br>
Transfer-Encoding:&nbsp;chunked&lt;br&gt;<br>
&lt;br&gt;<br>
--b962e37c-E--&lt;br&gt;<br>
&lt;br&gt;<br>
--b962e37c-H--&lt;br&gt;<br>
Message:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;4).&nbsp;Pattern&nbsp;match&nbsp;&quot;^5\\d{2}$&quot;&nbsp;at&nbsp;RESPONSE_STATUS.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/&lt;wbr&gt;activated_rules/RESPONSE-950-&lt;wbr&gt;DATA-LEAKAGES.conf&quot;]&nbsp;[line&nbsp;&quot;93&quot;]&nbsp;[id&nbsp;&quot;950100&quot;]&nbsp;[rev&nbsp;&quot;3&quot;]&nbsp;[msg&nbsp;&quot;The&nbsp;Application&nbsp;Returned&nbsp;a&nbsp;500-Level&nbsp;Status&nbsp;Code&quot;]&nbsp;[data&nbsp;&quot;Matched&nbsp;Data:&nbsp;500&nbsp;found&nbsp;within&nbsp;RESPONSE_STATUS:&nbsp;500&quot;]&nbsp;[severity&nbsp;&quot;ERROR&quot;]&nbsp;[ver&nbsp;&quot;OWASP_CRS/3.0.0&quot;]&nbsp;[maturity&nbsp;&quot;9&quot;]&nbsp;[accuracy&nbsp;&quot;9&quot;]&nbsp;[tag&nbsp;&quot;application-multi&quot;]&nbsp;[tag&nbsp;&quot;language-multi&quot;]&nbsp;[tag&nbsp;&quot;platform-multi&quot;]&nbsp;[tag&nbsp;&quot;attack-disclosure&quot;]&nbsp;[tag&nbsp;&quot;WASCTC/WASC-13&quot;]&nbsp;[tag&nbsp;&quot;OWASP_TOP_10/A6&quot;]&nbsp;[tag&nbsp;&quot;PCI/6.5.6&quot;]&nbsp;[tag&nbsp;&quot;paranoia-level/2&quot;]&lt;br&gt;<br>
Message:&nbsp;Warning.&nbsp;Operator&nbsp;GE&nbsp;matched&nbsp;4&nbsp;at&nbsp;TX:outbound_anomaly_score.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/&lt;wbr&gt;activated_rules/RESPONSE-980-&lt;wbr&gt;CORRELATION.conf&quot;]&nbsp;[line&nbsp;&quot;82&quot;]&nbsp;[id&nbsp;&quot;980140&quot;]&nbsp;[msg&nbsp;&quot;Outbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(score&nbsp;4):&nbsp;The&nbsp;Application&nbsp;Returned&nbsp;a&nbsp;500-Level&nbsp;Status&nbsp;Code&quot;]&nbsp;[tag&nbsp;&quot;event-correlation&quot;]&lt;br&gt;<br>
Action:&nbsp;Intercepted&nbsp;(phase&nbsp;4)&lt;br&gt;<br>
Apache-Handler:&nbsp;proxy-server&lt;br&gt;<br>
Stopwatch:&nbsp;1494857002287297&nbsp;207077&nbsp;(-&nbsp;-&nbsp;-)&lt;br&gt;<br>
Stopwatch2:&nbsp;1494857002287297&nbsp;207077;&nbsp;combined=18441,&nbsp;p1=681,&nbsp;p2=14548,&nbsp;p3=1891,&nbsp;p4=724,&nbsp;p5=597,&nbsp;sr=91,&nbsp;sw=0,&nbsp;l=0,&nbsp;gc=0&lt;br&gt;<br>
Response-Body-Transformed:&nbsp;Dechunked&lt;br&gt;<br>
Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.9.1&nbsp;(&lt;a&nbsp;target=&quot;_blank&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;href=&quot;http://www.modsecurity.org/&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);&nbsp;OWASP_CRS/&lt;a&nbsp;target=&quot;_blank&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;href=&quot;http://3.0.0.&quot;&gt;3.0.0.&lt;/a&gt;&lt;br&gt;<br>
Server:&nbsp;Apache&lt;br&gt;<br>
WebApp-Info:&nbsp;&quot;netverify&quot;&nbsp;&quot;-&quot;&nbsp;&quot;-&quot;&lt;br&gt;<br>
Engine-Mode:&nbsp;&quot;ENABLED&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
--b962e37c-Z--&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
==&gt;&nbsp;apache-request.log&nbsp;&lt;==&lt;br&gt;<br>
2017-05-15&nbsp;14:03:22&nbsp;UTC&nbsp;10.**.**.**&nbsp;*****&nbsp;-&nbsp;&quot;DELETE&nbsp;*****&nbsp;HTTP/1.1&quot;&nbsp;500&nbsp;168&nbsp;&quot;-&quot;&nbsp;&quot;*****&quot;&nbsp;1071&nbsp;3634&nbsp;207355&nbsp;on&nbsp;WRm1KgoKGoMAAD-yLjgAAABU&nbsp;-&nbsp;*****&nbsp;TLSv1.2&nbsp;ECDHE-RSA-AES128-GCM-SHA256&nbsp;false&nbsp;128&nbsp;128&nbsp;NULL&nbsp;8ab4dc14-fbd0-4ecd-a2e4-&lt;wbr&gt;5697a67017dc&lt;br&gt;<br>
&lt;br&gt;<br>
==&gt;&nbsp;apache-error.log&nbsp;&lt;==&lt;br&gt;<br>
[Mon&nbsp;May&nbsp;15&nbsp;14:03:22&nbsp;2017]&nbsp;[error]&nbsp;[client&nbsp;10.**.**.**]&nbsp;ModSecurity:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;4).&nbsp;Pattern&nbsp;match&nbsp;&quot;^5\\\\d{2}$&quot;&nbsp;at&nbsp;RESPONSE_STATUS.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/&lt;wbr&gt;activated_rules/RESPONSE-950-&lt;wbr&gt;DATA-LEAKAGES.conf&quot;]&nbsp;[line&nbsp;&quot;93&quot;]&nbsp;[id&nbsp;&quot;950100&quot;]&nbsp;[rev&nbsp;&quot;3&quot;]&nbsp;[msg&nbsp;&quot;The&nbsp;Application&nbsp;Returned&nbsp;a&nbsp;500-Level&nbsp;Status&nbsp;Code&quot;]&nbsp;[data&nbsp;&quot;Matched&nbsp;Data:&nbsp;500&nbsp;found&nbsp;within&nbsp;RESPONSE_STATUS:&nbsp;500&quot;]&nbsp;[severity&nbsp;&quot;ERROR&quot;]&nbsp;[ver&nbsp;&quot;OWASP_CRS/3.0.0&quot;]&nbsp;[maturity&nbsp;&quot;9&quot;]&nbsp;[accuracy&nbsp;&quot;9&quot;]&nbsp;[tag&nbsp;&quot;application-multi&quot;]&nbsp;[tag&nbsp;&quot;language-multi&quot;]&nbsp;[tag&nbsp;&quot;platform-multi&quot;]&nbsp;[tag&nbsp;&quot;attack-disclosure&quot;]&nbsp;[tag&nbsp;&quot;WASCTC/WASC-13&quot;]&nbsp;[tag&nbsp;&quot;OWASP_TOP_10/A6&quot;]&nbsp;[tag&nbsp;&quot;PCI/6.5.6&quot;]&nbsp;[tag&nbsp;&quot;paranoia-level/2&quot;]&nbsp;[hostname&nbsp;&quot;*****&quot;]&nbsp;[uri&nbsp;&quot;/*****&quot;]&nbsp;[unique_id&nbsp;&quot;WRm1KgoKGoMAAD-yLjgAAABU&quot;]&lt;br&gt;<br>
&lt;br&gt;<br>
[Mon&nbsp;May&nbsp;15&nbsp;14:03:22&nbsp;2017]&nbsp;[error]&nbsp;[client&nbsp;10.**.**.**]&nbsp;ModSecurity:&nbsp;Warning.&nbsp;Operator&nbsp;GE&nbsp;matched&nbsp;4&nbsp;at&nbsp;TX:outbound_anomaly_score.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/&lt;wbr&gt;activated_rules/RESPONSE-980-&lt;wbr&gt;CORRELATION.conf&quot;]&nbsp;[line&nbsp;&quot;82&quot;]&nbsp;[id&nbsp;&quot;980140&quot;]&nbsp;[msg&nbsp;&quot;Outbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(score&nbsp;4):&nbsp;The&nbsp;Application&nbsp;Returned&nbsp;a&nbsp;500-Level&nbsp;Status&nbsp;Code&quot;]&nbsp;[tag&nbsp;&quot;event-correlation&quot;]&nbsp;[hostname&nbsp;&quot;*****&quot;]&nbsp;[uri&nbsp;&quot;/*****&quot;]&nbsp;[unique_id&nbsp;&quot;WRm1KgoKGoMAAD-yLjgAAABU&quot;]&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
