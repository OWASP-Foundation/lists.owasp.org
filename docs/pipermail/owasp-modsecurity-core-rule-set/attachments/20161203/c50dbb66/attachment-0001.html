<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Update:&lt;br&gt;&lt;br&gt;I&nbsp;finally&nbsp;persuaded&nbsp;my&nbsp;server&nbsp;vendor&nbsp;to&nbsp;ask&nbsp;cPanel&nbsp;about&nbsp;this&nbsp;and&nbsp;cPanel&nbsp;had&nbsp;this&nbsp;to&nbsp;say:&lt;br&gt;&lt;br&gt;-----&lt;br&gt;&lt;br&gt;I&nbsp;did&nbsp;confirm&nbsp;I&nbsp;am&nbsp;seeing&nbsp;the&nbsp;same&nbsp;issue&nbsp;when&nbsp;attempting&nbsp;to&nbsp;add&nbsp;the&nbsp;rules,&nbsp;which&nbsp;appear&nbsp;to&nbsp;be&nbsp;an&nbsp;issue&nbsp;noted&nbsp;here&nbsp;as&nbsp;well&nbsp;:&nbsp;&lt;br&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/issues/89&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/SpiderLabs/&lt;wbr&gt;ModSecurity/issues/89&lt;/a&gt;&lt;br&gt;&lt;br&gt;This&nbsp;would&nbsp;entail&nbsp;that&nbsp;this&nbsp;requires&nbsp;the&nbsp;configurations&nbsp;be&nbsp;added&nbsp;manually&nbsp;in&nbsp;a&nbsp;separate&nbsp;configuration&nbsp;as&nbsp;you&nbsp;had&nbsp;suggested,&nbsp;which&nbsp;I&nbsp;added&nbsp;in&nbsp;the&nbsp;file&nbsp;the&nbsp;specific&nbsp;rule&nbsp;ID&nbsp;to&nbsp;be&nbsp;updated&nbsp;is&nbsp;present&nbsp;in&nbsp;at&nbsp;/etc/apache2/conf.d/modsec_&lt;wbr&gt;vendor_configs/OWASP/rules/&lt;wbr&gt;REQUEST-20-PROTOCOL-&lt;wbr&gt;ENFORCEMENT.conf&nbsp;and&nbsp;confirmed&nbsp;that&nbsp;it&nbsp;did&nbsp;allow&nbsp;the&nbsp;directive&nbsp;to&nbsp;be&nbsp;added&nbsp;without&nbsp;issue.&lt;br&gt;&lt;br&gt;-----&lt;br&gt;&lt;br&gt;So&nbsp;I&nbsp;added&nbsp;my&nbsp;two&nbsp;SecRuleUpdateTargetById&nbsp;directives&nbsp;to&nbsp;a&nbsp;new&nbsp;file&nbsp;(/etc/apache2/conf.d/modsec_&lt;wbr&gt;vendor_configs/OWASP/&lt;wbr&gt;modsecurity_crs_20_&lt;wbr&gt;customrules.conf)&nbsp;and&nbsp;restarted&nbsp;Apache.&lt;br&gt;&lt;br&gt;Everything&nbsp;works&nbsp;fine&nbsp;now.&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;H/T&nbsp;to Christian&nbsp;Folini&nbsp;and&nbsp;Spork&nbsp;Schivago&nbsp;for&nbsp;some&nbsp;help&nbsp;offlist.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Dec&nbsp;1,&nbsp;2016&nbsp;at&nbsp;5:00&nbsp;PM,&nbsp;Russell&nbsp;Clemings&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:rclemings@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;rclemings@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;I&#39;m&nbsp;having&nbsp;some&nbsp;trouble&nbsp;dealing&nbsp;with&nbsp;two&nbsp;false&nbsp;positives.&nbsp;This&nbsp;is&nbsp;cPanel&#39;s&nbsp;implementation&nbsp;of&nbsp;OWASP&nbsp;ver.3.0.0,&nbsp;as&nbsp;nearly&nbsp;as&nbsp;I&nbsp;can&nbsp;tell&nbsp;(from &lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&gt;/&lt;/span&gt;&lt;a&nbsp;href=&quot;https://nasw2.sciencewriters.us:2087/cpsess2553782837/cgi/configserver/cse.cgi?do=b&amp;p=/etc&quot;&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&nbsp;target=&quot;_blank&quot;&gt;etc&lt;/a&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&gt;/&lt;/span&gt;&lt;a&nbsp;href=&quot;https://nasw2.sciencewriters.us:2087/cpsess2553782837/cgi/configserver/cse.cgi?do=b&amp;p=/etc/apache2&quot;&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&nbsp;target=&quot;_blank&quot;&gt;apache2&lt;/a&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&gt;/&lt;/span&gt;&lt;a&nbsp;href=&quot;https://nasw2.sciencewriters.us:2087/cpsess2553782837/cgi/configserver/cse.cgi?do=b&amp;p=/etc/apache2/conf.d&quot;&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&nbsp;target=&quot;_blank&quot;&gt;conf.d&lt;/a&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&gt;/&lt;/span&gt;&lt;a&nbsp;href=&quot;https://nasw2.sciencewriters.us:2087/cpsess2553782837/cgi/configserver/cse.cgi?do=b&amp;p=/etc/apache2/conf.d/modsec_vendor_configs&quot;&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&nbsp;target=&quot;_blank&quot;&gt;mods&lt;wbr&gt;ec_vendor_configs&lt;/a&gt;&lt;span&nbsp;style=&quot;color:rgb(0,0,0);font-family:arial,helvetica,sans-serif&quot;&gt;/OWASP&lt;/span&gt;/&lt;wbr&gt;modsecurity_crs_10_setup.conf)&lt;wbr&gt;.&nbsp;I&#39;ve&nbsp;masked&nbsp;some&nbsp;possibly&nbsp;sensitive&nbsp;data.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;523939:[Thu&nbsp;Dec&nbsp;01&nbsp;10:25:39.244073&nbsp;2016]&nbsp;[:error]&nbsp;[pid&nbsp;24880]&nbsp;[client&nbsp;xx.xx.xxx.xxx]&nbsp;ModSecurity:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;redirection&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;http://www.example.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.example.com/&lt;/a&gt;&nbsp;using&nbsp;status&nbsp;302&nbsp;(phase&nbsp;2).&nbsp;Pattern&nbsp;match&nbsp;&quot;\\\\%((?!$|\\\\W)|[0-9a-fA-F]&lt;wbr&gt;{2}|u[0-9a-fA-F]{4})&quot;&nbsp;at&nbsp;ARGS:returnUrl.&nbsp;[file&nbsp;&quot;/etc/apache2/conf.d/modsec_&lt;wbr&gt;vendor_configs/OWASP/rules/&lt;wbr&gt;REQUEST-20-PROTOCOL-&lt;wbr&gt;ENFORCEMENT.conf&quot;]&nbsp;[line&nbsp;&quot;219&quot;]&nbsp;[id&nbsp;&quot;950109&quot;]&nbsp;[rev&nbsp;&quot;2&quot;]&nbsp;[msg&nbsp;&quot;Multiple&nbsp;URL&nbsp;Encoding&nbsp;Detected&quot;]&nbsp;[severity&nbsp;&quot;WARNING&quot;]&nbsp;[ver&nbsp;&quot;OWASP_CRS/3.0.0&quot;]&nbsp;[maturity&nbsp;&quot;6&quot;]&nbsp;[accuracy&nbsp;&quot;8&quot;]&nbsp;[tag&nbsp;&quot;Host:&nbsp;&lt;a&nbsp;href=&quot;http://www.example.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.example.com&lt;/a&gt;&quot;]&nbsp;[tag&nbsp;&quot;application-multi&quot;]&nbsp;[tag&nbsp;&quot;language-multi&quot;]&nbsp;[tag&nbsp;&quot;platform-multi&quot;]&nbsp;[tag&nbsp;&quot;attack-protocol&quot;]&nbsp;[tag&nbsp;&quot;OWASP_CRS/PROTOCOL_VIOLATION/&lt;wbr&gt;EVASION&quot;]&nbsp;[hostname&nbsp;&quot;&lt;a&nbsp;href=&quot;http://www.example.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.example.com&lt;/a&gt;&quot;]&nbsp;[uri&nbsp;&quot;/xxx.php&quot;]&nbsp;[unique_id&nbsp;&quot;WEBA83cQjKbwhNpTYWkudQAAAAQ&quot;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;526747:[Thu&nbsp;Dec&nbsp;01&nbsp;10:41:28.958952&nbsp;2016]&nbsp;[:error]&nbsp;[pid&nbsp;26285]&nbsp;[client&nbsp;xx.xx.xxx.xxx]&nbsp;ModSecurity:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;redirection&nbsp;to&nbsp;&lt;a&nbsp;href=&quot;http://www.example.com/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.example.com/&lt;/a&gt;&nbsp;using&nbsp;status&nbsp;302&nbsp;(phase&nbsp;2).&nbsp;Match&nbsp;of&nbsp;&quot;beginsWith&nbsp;%{request_headers.host}&quot;&nbsp;against&nbsp;&quot;TX:1&quot;&nbsp;required.&nbsp;[file&nbsp;&quot;/etc/apache2/conf.d/modsec_&lt;wbr&gt;vendor_configs/OWASP/rules/&lt;wbr&gt;REQUEST-31-APPLICATION-ATTACK-&lt;wbr&gt;RFI.conf&quot;]&nbsp;[line&nbsp;&quot;30&quot;]&nbsp;[id&nbsp;&quot;950120&quot;]&nbsp;[rev&nbsp;&quot;3&quot;]&nbsp;[msg&nbsp;&quot;Possible&nbsp;Remote&nbsp;File&nbsp;Inclusion&nbsp;(RFI)&nbsp;Attack:&nbsp;Off-Domain&nbsp;Reference/Link&quot;]&nbsp;[data&nbsp;&quot;Matched&nbsp;Data:&nbsp;&lt;a&nbsp;href=&quot;https://another.example.com/a/account/validatethirdpartycorporateauthresult?redirectUrl=http:%2F%2Fanother.example.com%2Fa&quot;&nbsp;target=&quot;_blank&quot;&gt;https://another.example.com/a/&lt;wbr&gt;account/&lt;wbr&gt;validatethirdpartycorporateaut&lt;wbr&gt;hresult?redirectUrl=http:%2F%&lt;wbr&gt;2Fanother.example.com%2Fa&lt;/a&gt;&nbsp;found&nbsp;within&nbsp;TX:1:&nbsp;&lt;a&nbsp;href=&quot;http://another.example.com/a/account/validatethirdpartycorporateauthresult?redirectUrl=http:%2F%2Fanother.example.com%2Fa&quot;&nbsp;target=&quot;_blank&quot;&gt;another.example.com/a/account/&lt;wbr&gt;validatethirdpartycorporateaut&lt;wbr&gt;hresult?redirectUrl=http:%2F%&lt;wbr&gt;2Fanother.example.com%2Fa&lt;/a&gt;&quot;]&nbsp;[severity&nbsp;&quot;CRITICAL&quot;]&nbsp;[ver&nbsp;&quot;OWASP_CRS/3.0.0&quot;]&nbsp;[maturity&nbsp;&quot;9&quot;]&nbsp;[accuracy&nbsp;&quot;9&quot;]&nbsp;[tag&nbsp;&quot;Host:&nbsp;&lt;a&nbsp;href=&quot;http://www.example.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.example.com&lt;/a&gt;&quot;]&nbsp;[tag&nbsp;&quot;application-multi&quot;]&nbsp;[tag&nbsp;&quot;language-multi&quot;]&nbsp;[tag&nbsp;&quot;platform-multi&quot;]&nbsp;[tag&nbsp;&quot;attack-remote&nbsp;file&nbsp;inclusion&quot;]&nbsp;[tag&nbsp;&quot;OWASP_CRS/WEB_ATTACK/RFI&quot;]&nbsp;[hostname&nbsp;&quot;&lt;a&nbsp;href=&quot;http://www.example.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.example.com&lt;/a&gt;&quot;]&nbsp;[uri&nbsp;&quot;/xxx.php&quot;]&nbsp;[unique_id&nbsp;&quot;WEBEqF9us8Ws-b6n3kgKmAAAAAI&quot;]&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;ve&nbsp;confirmed&nbsp;that&nbsp;those&nbsp;rules&nbsp;are&nbsp;the&nbsp;problem&nbsp;by&nbsp;temporarily&nbsp;disabling&nbsp;them,&nbsp;but&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;create&nbsp;an&nbsp;exception&nbsp;instead.&nbsp;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;use&nbsp;the&nbsp;&quot;add&nbsp;rule&quot;&nbsp;function&nbsp;in&nbsp;cPanel&#39;s&nbsp;WHM/Security&nbsp;Center/ModSecurity/Tools/Rules&nbsp;List.&nbsp;Here&nbsp;is&nbsp;what&nbsp;I&#39;m&nbsp;trying&nbsp;to&nbsp;add&nbsp;(singly&nbsp;and&nbsp;both&nbsp;at&nbsp;once):&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;SecRuleUpdateTargetById&nbsp;950109&nbsp;!ARGS:&#39;&lt;a&nbsp;href=&quot;http://another.example.com&quot;&nbsp;target=&quot;_blank&quot;&gt;another.example.com&lt;/a&gt;&#39;&lt;/div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;950120&nbsp;!ARGS_NAMES:&#39;&lt;a&nbsp;href=&quot;http://another.example.com&quot;&nbsp;target=&quot;_blank&quot;&gt;another.example.&lt;wbr&gt;com&lt;/a&gt;&#39;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;When&nbsp;I&nbsp;try&nbsp;to&nbsp;save&nbsp;and&nbsp;deploy,&nbsp;here&nbsp;is&nbsp;what&nbsp;I&nbsp;get&nbsp;in&nbsp;the&nbsp;cPanel&nbsp;error&nbsp;log:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;[2016-12-01&nbsp;16:09:21&nbsp;-0500]&nbsp;warn&nbsp;[xml-api]&nbsp;The&nbsp;system&nbsp;failed&nbsp;to&nbsp;deploy&nbsp;the&nbsp;changes&nbsp;for&nbsp;“modsec/modsec2.user.conf”:&nbsp;The&nbsp;system&nbsp;could&nbsp;not&nbsp;validate&nbsp;the&nbsp;new&nbsp;Apache&nbsp;configuration&nbsp;because&nbsp;httpd&nbsp;exited&nbsp;with&nbsp;a&nbsp;nonzero&nbsp;value.&nbsp;Apache&nbsp;produced&nbsp;the&nbsp;following&nbsp;error:&nbsp;AH00526:&nbsp;Syntax&nbsp;error&nbsp;on&nbsp;line&nbsp;1&nbsp;of&nbsp;/etc/apache2/conf.d/modsec/&lt;wbr&gt;modsec2.user.conf:&lt;/div&gt;&lt;div&gt;Updating&nbsp;target&nbsp;by&nbsp;ID&nbsp;with&nbsp;no&nbsp;ruleset&nbsp;in&nbsp;this&nbsp;context&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&#39;ve&nbsp;tried&nbsp;various&nbsp;combinations&nbsp;of&nbsp;single&nbsp;quotes,&nbsp;double&nbsp;quotes,&nbsp;no&nbsp;quotes,&nbsp;but&nbsp;to&nbsp;no&nbsp;avail.&nbsp;It&#39;s&nbsp;up&nbsp;to&nbsp;the&nbsp;server&nbsp;vendor&nbsp;to&nbsp;file&nbsp;a&nbsp;ticket&nbsp;with&nbsp;cPanel&nbsp;and&nbsp;they&nbsp;say&nbsp;it&#39;s&nbsp;not&nbsp;appropriate&nbsp;to&nbsp;do&nbsp;that&nbsp;for&nbsp;a&nbsp;syntax&nbsp;error.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Suggestions?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;did&nbsp;file&nbsp;reports&nbsp;via&nbsp;cPanel&nbsp;earlier&nbsp;today&nbsp;and&nbsp;got&nbsp;auto-replies&nbsp;from &lt;span&nbsp;style=&quot;color:rgb(85,85,85);font-size:12.8px&quot;&gt;&lt;a&nbsp;href=&quot;mailto:security@modsecurity.org&quot;&nbsp;target=&quot;_blank&quot;&gt;security@modsecurity.org&lt;/a&gt;&nbsp;assigning&nbsp;ticket&nbsp;nos.&nbsp;1332&nbsp;and&nbsp;1333,&nbsp;but&nbsp;nothing&nbsp;further.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(85,85,85);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;color:rgb(85,85,85);font-size:12.8px&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;===============================================&lt;br&gt;Russell&nbsp;Clemings&lt;div&gt;&lt;&lt;a&nbsp;href=&quot;mailto:russell@clemings.com&quot;&nbsp;target=&quot;_blank&quot;&gt;russell@clemings.com&lt;/a&gt;&gt;&lt;br&gt;===============================================&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
