<tt>
Thank&nbsp;you&nbsp;Ryan&nbsp;for&nbsp;your&nbsp;suggestions,&nbsp;I&nbsp;will&nbsp;have&nbsp;a&nbsp;try.&lt;br&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/8/15&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ryan.barnett@breach.com&quot;&gt;ryan.barnett@breach.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;<br>
&lt;div&nbsp;style=&quot;FONT-WEIGHT:&nbsp;400;&nbsp;FONT-SIZE:&nbsp;9pt;&nbsp;FONT-STYLE:&nbsp;normal;&nbsp;FONT-FAMILY:&nbsp;&amp;#39;DejaVu&nbsp;Sans&amp;#39;&quot;&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;Thursday&nbsp;13&nbsp;August&nbsp;2009&nbsp;09:42:38&nbsp;pm&nbsp;Junyong&nbsp;Jiang&nbsp;wrote:&lt;br&gt;&amp;gt;&nbsp;Ryan,&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Thanks&nbsp;for&nbsp;your&nbsp;reply.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Yes,&nbsp;the&nbsp;client&nbsp;client&nbsp;uses&nbsp;a&nbsp;file&nbsp;upload&nbsp;interface&nbsp;to&nbsp;upload&nbsp;a&nbsp;file,&nbsp;for&lt;br&gt;<br>
&amp;gt;&nbsp;example&nbsp;a.asp.&nbsp;Then&nbsp;he&nbsp;access&nbsp;a.asp&nbsp;and&nbsp;excute&nbsp;the&nbsp;code&nbsp;in&nbsp;a.asp.&nbsp;I&nbsp;do&nbsp;not&lt;br&gt;&amp;gt;&nbsp;know&nbsp;how&nbsp;to&nbsp;prevent&nbsp;the&nbsp;attack.&nbsp;Can&nbsp;we&nbsp;check&nbsp;the&nbsp;upload-file&amp;#39;s&nbsp;type&nbsp;when&lt;br&gt;&amp;gt;&nbsp;client&nbsp;upload&nbsp;this&nbsp;file?&nbsp;sometimes,&nbsp;the&nbsp;attacker&nbsp;may&nbsp;modify&nbsp;the&nbsp;suffix&nbsp;of&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;file&nbsp;for&nbsp;cheating&nbsp;de&nbsp;file-suffix&nbsp;checking.&lt;br&gt;&amp;gt;&lt;br&gt;&amp;gt;&nbsp;Could&nbsp;you&nbsp;give&nbsp;me&nbsp;some&nbsp;advice?&lt;br&gt;&amp;gt;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/div&gt;The&nbsp;CRS&nbsp;already&nbsp;has&nbsp;backdoor&nbsp;access&nbsp;rules&nbsp;in&nbsp;the&nbsp;modsecurity_crs_45_trojans.conf&nbsp;file.&nbsp;These&nbsp;rules&nbsp;will&nbsp;identify&nbsp;if/when&nbsp;a&nbsp;client&nbsp;tries&nbsp;to&nbsp;access&nbsp;a&nbsp;backdoor&nbsp;webpage.&nbsp;These&nbsp;rules&nbsp;are&nbsp;important&nbsp;as&nbsp;users&nbsp;can&nbsp;possibly&nbsp;upload&nbsp;these&nbsp;files&nbsp;through&nbsp;non-web&nbsp;protocols&nbsp;(FTP,&nbsp;etc...).&nbsp;In&nbsp;your&nbsp;case,&nbsp;however,&nbsp;you&nbsp;want&nbsp;to&nbsp;prevent&nbsp;the&nbsp;files&nbsp;from&nbsp;being&nbsp;uploaded&nbsp;through&nbsp;the&nbsp;web&nbsp;interface&nbsp;to&nbsp;begin&nbsp;with.&nbsp;What&nbsp;you&nbsp;could&nbsp;possibly&nbsp;do&nbsp;is&nbsp;to&nbsp;take&nbsp;the&nbsp;trojan&nbsp;access&nbsp;rules&nbsp;from&nbsp;the&nbsp;45&nbsp;file&nbsp;and&nbsp;apply&nbsp;the&nbsp;same&nbsp;signatures&nbsp;to&nbsp;the&nbsp;REQUEST_BODY&nbsp;variable&nbsp;instead&nbsp;of&nbsp;RESPONSE_BODY.&nbsp;This&nbsp;may&nbsp;work&nbsp;somewhat&nbsp;but&nbsp;it&nbsp;is&nbsp;not&nbsp;foolproof.&nbsp;If&nbsp;you&nbsp;have&nbsp;some&nbsp;examples&nbsp;of&nbsp;the&nbsp;backdoor&nbsp;html&nbsp;code,&nbsp;you&nbsp;could&nbsp;create&nbsp;some&nbsp;rules&nbsp;based&nbsp;on&nbsp;it.&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;-Ryan&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;MARGIN:&nbsp;0px;&nbsp;TEXT-INDENT:&nbsp;0px&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/font&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
