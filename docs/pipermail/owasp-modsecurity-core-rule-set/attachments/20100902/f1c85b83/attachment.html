<tt>
Hi,&lt;br&gt;&lt;br&gt;Thanks&nbsp;for&nbsp;the&nbsp;pointer.&nbsp;I&nbsp;was&nbsp;looking&nbsp;at&nbsp;that&nbsp;very&nbsp;post&nbsp;last&nbsp;night&nbsp;in&nbsp;order&nbsp;to&nbsp;find&nbsp;possible&nbsp;solutions.&nbsp;Looks&nbsp;like&nbsp;I&nbsp;missed&nbsp;the&nbsp;most&nbsp;important&nbsp;part&nbsp;though&nbsp;(the&nbsp;env=http_cookie&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;header&nbsp;line).&nbsp;I&amp;#39;ll&nbsp;take&nbsp;another&nbsp;stab&nbsp;at&nbsp;this&nbsp;tonight&nbsp;and&nbsp;hopefully&nbsp;get&nbsp;it&nbsp;working&nbsp;as&nbsp;desired.&lt;br&gt;<br>
&lt;br&gt;Thanks&nbsp;for&nbsp;the&nbsp;quick&nbsp;reply.&lt;br&gt;&lt;br&gt;Chris&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Sep&nbsp;1,&nbsp;2010&nbsp;at&nbsp;10:48&nbsp;PM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;On&nbsp;9/1/10&nbsp;4:45&nbsp;PM,&nbsp;&amp;quot;Chris&nbsp;John&nbsp;Riley&amp;quot;&nbsp;&amp;lt;lists@c22.cc&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;Hi,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Apologies&nbsp;if&nbsp;this&nbsp;has&nbsp;already&nbsp;been&nbsp;covered,&nbsp;but&nbsp;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;use&nbsp;mod_headers&lt;br&gt;<br>
&amp;gt;&nbsp;to&nbsp;set&nbsp;an&nbsp;additional&nbsp;cookie&nbsp;value&nbsp;based&nbsp;on&nbsp;the&nbsp;results&nbsp;of&nbsp;a&nbsp;mod_security&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule.&nbsp;I&amp;#39;ve&nbsp;tried&nbsp;a&nbsp;number&nbsp;of&nbsp;things,&nbsp;including&nbsp;skip/skipAfter,&nbsp;but&nbsp;nothing&lt;br&gt;<br>
&amp;gt;&nbsp;seems&nbsp;to&nbsp;work&nbsp;for&nbsp;some&nbsp;reason.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Example:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp;SecRule&nbsp;RESPONSE_STATUS&nbsp;&amp;quot;^[345]&amp;quot;&nbsp;&amp;quot;phase:3,skip:1&amp;quot;&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp;header&nbsp;add&nbsp;Set-Cookie&nbsp;&amp;quot;Test=1&amp;quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Any&nbsp;ideas&nbsp;how&nbsp;I&nbsp;can&nbsp;achieve&nbsp;the&nbsp;desired&nbsp;result&nbsp;(setting&nbsp;a&nbsp;cookie&nbsp;only&nbsp;on&nbsp;a&nbsp;200&lt;br&gt;<br>
&amp;gt;&nbsp;status).&nbsp;It&amp;#39;s&nbsp;probably&nbsp;something&nbsp;simple,&nbsp;but&nbsp;darned&nbsp;if&nbsp;I&nbsp;can&nbsp;find&nbsp;it!&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Thanks,&nbsp;and&nbsp;sorry&nbsp;for&nbsp;the&nbsp;noob&nbsp;question.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Hey&nbsp;Chris,&lt;br&gt;<br>
Take&nbsp;a&nbsp;look&nbsp;at&nbsp;this&nbsp;previous&nbsp;blog&nbsp;post&nbsp;that&nbsp;I&nbsp;did&nbsp;which&nbsp;is&nbsp;somewhat&nbsp;related&lt;br&gt;<br>
(having&nbsp;ModSecurity&nbsp;interact&nbsp;with&nbsp;mod_headers)&nbsp;to&nbsp;choose&nbsp;which&nbsp;to&nbsp;fix&lt;br&gt;<br>
outbound&nbsp;set-cookie&nbsp;sessionids&nbsp;that&nbsp;are&nbsp;missing&nbsp;the&nbsp;httponly&nbsp;cookie&nbsp;flag.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl%0Aag.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://blog.modsecurity.org/2008/12/helping-protect-cookies-with-httponly-fl&lt;br&gt;<br>
ag.html&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
Basically&nbsp;you&nbsp;just&nbsp;need&nbsp;to&nbsp;have&nbsp;modsec&nbsp;set&nbsp;and&nbsp;ENV&nbsp;varaible&nbsp;(with&nbsp;the&nbsp;setenv&lt;br&gt;<br>
action)&nbsp;so&nbsp;that&nbsp;Apache&nbsp;can&nbsp;read&nbsp;it&nbsp;and&nbsp;then&nbsp;conditionally&nbsp;use&nbsp;the&nbsp;header&lt;br&gt;<br>
directive&nbsp;if&nbsp;that&nbsp;ENV&nbsp;token&nbsp;is&nbsp;set.&lt;br&gt;<br>
&lt;br&gt;<br>
Hope&nbsp;that&nbsp;helps,&lt;br&gt;<br>
&lt;font&nbsp;color=&quot;#888888&quot;&gt;Ryan&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;--&lt;br&gt;•&nbsp;Chris&nbsp;John&nbsp;Riley&nbsp;•&lt;br&gt;•&nbsp;&lt;a&nbsp;href=&quot;http://blog.c22.cc&quot;&gt;http://blog.c22.cc&lt;/a&gt;&nbsp;•&lt;br&gt;--&lt;br&gt;------------------------------------------&lt;br&gt;All&nbsp;emails&nbsp;ROT-26&nbsp;encrypted&lt;br&gt;<br>
------------------------------------------&lt;br&gt;<br>

</tt>
