<tt>
&lt;div&gt;Thank you Brian!&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;use&nbsp;core&nbsp;rule&nbsp;set&nbsp;version&nbsp;1.6.&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2009/8/29&nbsp;Brian&nbsp;Rectanus&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:Brian.Rectanus@breach.com&quot;&gt;Brian.Rectanus@breach.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;Junyong&nbsp;Jiang&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;PADDING-LEFT:&nbsp;1ex;&nbsp;MARGIN:&nbsp;0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;&nbsp;BORDER-LEFT:&nbsp;#ccc&nbsp;1px&nbsp;solid&quot;&gt;Dear&nbsp;all,&lt;br&gt;I&nbsp;came&nbsp;accros&nbsp;the&nbsp;following&nbsp;problem&nbsp;than&nbsp;I&nbsp;can&amp;#39;t&nbsp;use&nbsp;modsecurity&nbsp;to&lt;br&gt;identify&nbsp;such&nbsp;type&nbsp;of&nbsp;XSS&nbsp;attack:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://192.168.3.144/product.asp?tp=67=%2a%2f%2d%2d%3e%27%22%29%3b%3e%3c%2f%49%66%52%61%4d%65%3e%3c%2f%53%43%72%69%50%74%3e%3c%2f%73%54%79%4c%65%3e%3c%2f%54%69%74%4c%65%3e%3c%2f%74%45%58%74%41%72%65%41%3e%3c%73%63%52%69%50%54%3e%61%6c%65%72%74%28%27%58%73%73%54%65%73%74%27%29%3c%2f%53%63%72%49%50%54%3e&quot;&nbsp;target=&quot;_blank&quot;&gt;http://192.168.3.144/product.asp?tp=67=%2a%2f%2d%2d%3e%27%22%29%3b%3e%3c%2f%49%66%52%61%4d%65%3e%3c%2f%53%43%72%69%50%74%3e%3c%2f%73%54%79%4c%65%3e%3c%2f%54%69%74%4c%65%3e%3c%2f%74%45%58%74%41%72%65%41%3e%3c%73%63%52%69%50%54%3e%61%6c%65%72%74%28%27%58%73%73%54%65%73%74%27%29%3c%2f%53%63%72%49%50%54%3e&lt;/a&gt;&lt;br&gt;<br>
The&nbsp;decoded&nbsp;URL&nbsp;is:&lt;br&gt;&lt;a&nbsp;href=&quot;http://192.168.3.144/product.asp?tp=67=*/--&quot;&nbsp;target=&quot;_blank&quot;&gt;http://192.168.3.144/product.asp?tp=67=*/--&lt;/a&gt;&amp;gt;&amp;#39;&amp;quot;);&amp;gt;&amp;lt;/IfRaMe&amp;gt;&amp;lt;/SCriPt&amp;gt;&amp;lt;/sTyLe&amp;gt;&amp;lt;/TitLe&amp;gt;&amp;lt;/tEXtAreA&amp;gt;&amp;lt;scRiPT&amp;gt;alert(&amp;#39;XssTest&amp;#39;)&amp;lt;/ScrIPT&lt;br&gt;<br>
&amp;lt;&lt;a&nbsp;href=&quot;http://192.168.3.144/product.asp?tp=67=*/--&quot;&nbsp;target=&quot;_blank&quot;&gt;http://192.168.3.144/product.asp?tp=67=*/--&lt;/a&gt;&amp;gt;&amp;#39;&amp;quot;);&amp;gt;&amp;lt;/IfRaMe&amp;gt;&amp;lt;/SCriPt&amp;gt;&amp;lt;/sTyLe&amp;gt;&amp;lt;/TitLe&amp;gt;&amp;lt;/tEXtAreA&amp;gt;&amp;lt;scRiPT&amp;gt;alert(&amp;#39;XssTest&amp;#39;)&amp;lt;/ScrIPT&amp;gt;&amp;gt;&lt;br&gt;<br>
Hope&nbsp;you&nbsp;have&nbsp;good&nbsp;solutions&nbsp;to&nbsp;share&nbsp;with&nbsp;all&nbsp;of&nbsp;us!&lt;br&gt;Thanks&nbsp;a&nbsp;lot!&lt;br&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;1)&nbsp;You&nbsp;did&nbsp;not&nbsp;specify&nbsp;which&nbsp;version&nbsp;of,&nbsp;well,&nbsp;anything&nbsp;you&nbsp;used.&lt;br&gt;2)&nbsp;Are&nbsp;you&nbsp;using&nbsp;the&nbsp;Core&nbsp;Rules?&nbsp; What&nbsp;version?&lt;br&gt;<br>
&lt;br&gt;I&nbsp;cranked&nbsp;up&nbsp;the&nbsp;default&nbsp;CRS&nbsp;2.0.1&nbsp;and&nbsp;it&nbsp;detected&nbsp;this&nbsp;just&nbsp;fine:&lt;br&gt;&lt;br&gt;Message:&nbsp;Pattern&nbsp;match&nbsp;&amp;quot;\balert\b\W*?\(&amp;quot;&nbsp;at&nbsp;TX:pm_xss_data_ARGS:tp.&nbsp;[file&nbsp;&amp;quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;142&amp;quot;]&nbsp;[id&nbsp;&amp;quot;958052&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Cross-site&nbsp;Scripting&nbsp;(XSS)&nbsp;Attack&amp;quot;]&nbsp;[data&nbsp;&amp;quot;alert(&amp;quot;]&nbsp;[severity&nbsp;&amp;quot;CRITICAL&amp;quot;]&nbsp;[tag&nbsp;&amp;quot;WEB_ATTACK/XSS&amp;quot;]&lt;br&gt;<br>
Message:&nbsp;Pattern&nbsp;match&nbsp;&amp;quot;\&amp;lt;&nbsp;?script\b&amp;quot;&nbsp;at&nbsp;TX:pm_xss_data_ARGS:tp.&nbsp;[file&nbsp;&amp;quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;190&amp;quot;]&nbsp;[id&nbsp;&amp;quot;958051&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Cross-site&nbsp;Scripting&nbsp;(XSS)&nbsp;Attack&amp;quot;]&nbsp;[data&nbsp;&amp;quot;&amp;lt;script&amp;quot;]&nbsp;[severity&nbsp;&amp;quot;CRITICAL&amp;quot;]&nbsp;[tag&nbsp;&amp;quot;WEB_ATTACK/XSS&amp;quot;]&lt;br&gt;<br>
Message:&nbsp;Pattern&nbsp;match&nbsp;&amp;quot;&amp;lt;(a|abbr|acronym|address|applet|area|audioscope|b|base|basefront|bdo|bgsound|big|blackface|blink|blockquote|body|bq|br|button|caption|center|cite|code|col|colgroup|comment|dd|del|dfn|dir|div|dl|dt|em|embed|fieldset|fn|font|form|frame|frameset|h1|head|h&nbsp;...&amp;quot;&nbsp;at&nbsp;ARGS:tp.&nbsp;[file&nbsp;&amp;quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;281&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;XSS&nbsp;Attack&nbsp;Detected&amp;quot;]&lt;br&gt;<br>
Message:&nbsp;Pattern&nbsp;match&nbsp;&amp;quot;(fromcharcode|alert|eval)\s*\(&amp;quot;&nbsp;at&nbsp;ARGS:tp.&nbsp;[file&nbsp;&amp;quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_41_xss_attacks.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;373&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;XSS&nbsp;Attack&nbsp;Detected&amp;quot;]&lt;br&gt;<br>
Message:&nbsp;Warning.&nbsp;Operator&nbsp;GE&nbsp;matched&nbsp;5&nbsp;at&nbsp;TX:anomaly_score.&nbsp;[file&nbsp;&amp;quot;/home/brectanus/projects/test/apache/modsecurity-crs_2.0.1/base_rules/modsecurity_crs_60_correlation.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;41&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Transactional&nbsp;Anomaly&nbsp;Score&nbsp;(score&nbsp;61):&nbsp;XSS&nbsp;Attack&nbsp;Detected&amp;quot;]&lt;br&gt;<br>
Action:&nbsp;Intercepted&nbsp;(phase&nbsp;2)&lt;br&gt;&lt;br&gt;-B&lt;br&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;--&nbsp;&lt;br&gt;Brian&nbsp;Rectanus&lt;br&gt;Breach&nbsp;Security&lt;br&gt;&lt;/font&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
