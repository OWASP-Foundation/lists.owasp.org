<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hello,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;i&nbsp;don&#39;t&nbsp;know&nbsp;if&nbsp;it&#39;s&nbsp;necessary&nbsp;to&nbsp;change&nbsp;since&nbsp;all&nbsp;crs&nbsp;rules&nbsp;match&nbsp;the&nbsp;pattern&nbsp;TX:/^\d+\-/.&lt;/div&gt;&lt;div&gt;But&nbsp;if&nbsp;it&#39;s&nbsp;needed&nbsp;to&nbsp;match&nbsp;the&nbsp;original&nbsp;pattern&nbsp;and&nbsp;the&nbsp;new&nbsp;one&nbsp;then&nbsp;we&nbsp;only&nbsp;need&nbsp;to&nbsp;change&nbsp;it&nbsp;to &lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;TX:/^\d+\-/|TX:/^\d/&nbsp;&quot;(.*)&quot;&lt;/div&gt;&lt;div&gt;This&nbsp;Rule&nbsp;would&nbsp;match&nbsp;first&nbsp;the&nbsp;\d+\-/&nbsp;so&nbsp;this&nbsp;would&nbsp;still&nbsp;count&nbsp;when&nbsp;a&nbsp;crs&nbsp;rule&nbsp;is&nbsp;matched&nbsp;but&nbsp;if&nbsp;none&nbsp;matched&nbsp;the&nbsp;/^\d/&nbsp;is&nbsp;there&nbsp;for&nbsp;local&nbsp;rules.&lt;/div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;Best&nbsp;Regards&lt;/div&gt;&lt;div&gt;Michael&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2013/8/8&nbsp;chris&nbsp;derham&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:chris@derham.me.uk&quot;&nbsp;target=&quot;_blank&quot;&gt;chris@derham.me.uk&lt;/a&gt;&gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Ah&nbsp;ok&nbsp;-&nbsp;my&nbsp;bad.&nbsp;Guess&nbsp;I&nbsp;didn&#39;t&nbsp;understand&nbsp;your&nbsp;original&nbsp;post&nbsp;properly&nbsp;:-(&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;what&nbsp;I&nbsp;(now)&nbsp;think&nbsp;you&nbsp;saying&nbsp;is&nbsp;&quot;some&nbsp;of&nbsp;the&nbsp;rules&nbsp;in&lt;br&gt;<br>
modsecurity_crs_41_sql_injection_attacks.conf&nbsp;will&nbsp;no&nbsp;longer&nbsp;work&nbsp;with&lt;br&gt;<br>
anomaly&nbsp;scoring&nbsp;blocking,&nbsp;as&nbsp;they&nbsp;don&#39;t&nbsp;include&lt;br&gt;<br>
&quot;setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-SOMETHING&quot;.&nbsp;I&nbsp;had&nbsp;a&nbsp;look&nbsp;and&nbsp;see&nbsp;that&nbsp;if&nbsp;you&lt;br&gt;<br>
search&nbsp;for&nbsp;&quot;setvar:&#39;tx.%{tx.msg}-&quot;,&nbsp;you&nbsp;will&nbsp;get&nbsp;22&nbsp;hits.&nbsp;My&nbsp;guess&nbsp;is&lt;br&gt;<br>
that&nbsp;you&nbsp;are&nbsp;trying&nbsp;to&nbsp;say&nbsp;that&nbsp;these&nbsp;be&nbsp;changed&nbsp;to&nbsp;become&lt;br&gt;<br>
&quot;setvar:&#39;tx.%{&lt;a&nbsp;href=&quot;http://tx.id&quot;&nbsp;target=&quot;_blank&quot;&gt;tx.id&lt;/a&gt;}-&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
Does&nbsp;that&nbsp;sum&nbsp;up&nbsp;what&nbsp;you&nbsp;are&nbsp;trying&nbsp;to&nbsp;say?&nbsp;That&nbsp;still&nbsp;doesn&#39;t&nbsp;add&nbsp;up&lt;br&gt;<br>
to&nbsp;me.&nbsp;The&nbsp;highlighted&nbsp;change&nbsp;only&nbsp;really&nbsp;altered&nbsp;the&nbsp;regex&nbsp;used&nbsp;-&lt;br&gt;<br>
moving&nbsp;from&nbsp;a&nbsp;number&nbsp;to&nbsp;a&nbsp;number&nbsp;terminated&nbsp;by&nbsp;a&nbsp;space.&nbsp;This&nbsp;won&#39;t&lt;br&gt;<br>
cause&nbsp;the&nbsp;issue&nbsp;you&nbsp;describe.&nbsp;I&nbsp;guess&nbsp;you&nbsp;are&nbsp;saying&nbsp;that&nbsp;since&nbsp;the&lt;br&gt;<br>
last&nbsp;time&nbsp;you&nbsp;coded&nbsp;your&nbsp;rule,&nbsp;this&nbsp;has&nbsp;changed,&nbsp;and&nbsp;this&nbsp;is&nbsp;the&nbsp;last&lt;br&gt;<br>
change&nbsp;on&nbsp;that&nbsp;file?&nbsp;The&nbsp;initial&nbsp;version&nbsp;of&nbsp;the&nbsp;file&nbsp;on&nbsp;14th&nbsp;Sep&nbsp;2012&lt;br&gt;<br>
had&nbsp;the&nbsp;line&nbsp;&quot;SecRule&nbsp;TX:/^\d/&nbsp;&quot;(.*)&quot;&quot;&nbsp;which&nbsp;would&nbsp;still&nbsp;require&lt;br&gt;<br>
&quot;setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-SOMETHING&quot;.&nbsp;I&nbsp;guess&nbsp;you&nbsp;need&nbsp;to&nbsp;explain&nbsp;what&lt;br&gt;<br>
your&nbsp;concern&nbsp;really&nbsp;is&nbsp;-&nbsp;well&nbsp;at&nbsp;least&nbsp;to&nbsp;me.&nbsp;Perhaps&nbsp;everyone&nbsp;else&lt;br&gt;<br>
understands&nbsp;already&nbsp;-&nbsp;sorry&nbsp;for&nbsp;been&nbsp;slow&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&lt;br&gt;<br>
&lt;span&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;font&nbsp;color=&quot;#888888&quot;&gt;&lt;br&gt;<br>
Chris&lt;br&gt;<br>
&lt;/font&gt;&lt;/span&gt;&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
On&nbsp;Thu,&nbsp;Aug&nbsp;8,&nbsp;2013&nbsp;at&nbsp;2:44&nbsp;PM,&nbsp; &lt;&lt;a&nbsp;href=&quot;mailto:rp-modsec-crs-list@bev.net&quot;&gt;rp-modsec-crs-list@bev.net&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;posted&nbsp;the&nbsp;orignal&nbsp;question.&nbsp;But,&nbsp;let&nbsp;me&nbsp;add&nbsp;some&nbsp;clarification.&lt;br&gt;<br>
&gt;&nbsp;Almost&nbsp;all&nbsp;of&nbsp;the&nbsp;stock&nbsp;CRS&nbsp;rules&nbsp;will&nbsp;block&nbsp;in&nbsp;anomaly&nbsp;scoring&nbsp;mode&nbsp;as-is.&lt;br&gt;<br>
&gt;&nbsp;But,&nbsp;there&nbsp;are&nbsp;couple&nbsp;in&nbsp;the&nbsp;SQLi&nbsp;rules&nbsp;(I&nbsp;think)&nbsp;that&nbsp;might&nbsp;not&nbsp;(don&#39;t&lt;br&gt;<br>
&gt;&nbsp;have&nbsp;those&nbsp;handy).&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;other&nbsp;words,&nbsp;if&nbsp;you&nbsp;doing&nbsp;nothing&nbsp;but&nbsp;straight&nbsp;CRS&nbsp;with&nbsp;no&nbsp;local&nbsp;or&lt;br&gt;<br>
&gt;&nbsp;third&lt;br&gt;<br>
&gt;&nbsp;party&nbsp;rules,&nbsp;no&nbsp;problems.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;issue&nbsp;is&nbsp;that&nbsp;local&nbsp;(or&nbsp;possibly&nbsp;non-CRS&nbsp;third&nbsp;party)&nbsp;rules&nbsp;you&#39;ve&nbsp;added&lt;br&gt;<br>
&gt;&nbsp;(on&nbsp;top&nbsp;of&nbsp;CRS)&nbsp;with&nbsp;scoring&nbsp;will&nbsp;need&nbsp;more&nbsp;than&nbsp;just&nbsp;the&nbsp;score&nbsp;now.&nbsp;You&lt;br&gt;<br>
&gt;&nbsp;must&lt;br&gt;<br>
&gt;&nbsp;also&nbsp;have&nbsp;a&nbsp;&quot;setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-SOMETHING&quot;&nbsp;(the&nbsp;need&nbsp;for&nbsp;a&nbsp;dash&nbsp;is&nbsp;what&lt;br&gt;<br>
&gt;&nbsp;effectively&nbsp;got&nbsp;changed).&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;-RP&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
