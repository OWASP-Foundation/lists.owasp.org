<tt>
Hi&nbsp;Ryan,&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;sorry&nbsp;i&nbsp;didn&amp;#39;t&nbsp;mention&nbsp;it&nbsp;before&nbsp;i&nbsp;use&nbsp;this&nbsp;configuration&nbsp;to&nbsp;redirect&nbsp;from&nbsp;port&nbsp;80&nbsp;to&nbsp;443.&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;border-collapse:&nbsp;collapse;&nbsp;font-family:&nbsp;arial,&nbsp;sans-serif;&nbsp;font-size:&nbsp;13px;&nbsp;&quot;&gt;&lt;div&gt;<br>
 RewriteEngine&nbsp;On&lt;/div&gt;&lt;div&gt; RewriteRule&nbsp;^/(.*) &lt;a&nbsp;href=&quot;https://xxx.xxx/&quot;&nbsp;target=&quot;_blank&quot;&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;204);&nbsp;&quot;&gt;https://XXX.xxx/&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/span&gt;Michael&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2011/7/17&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;You&nbsp;might&nbsp;want&nbsp;to&nbsp;try&nbsp;using&nbsp;a&nbsp;mod_rewrite&nbsp;rule&nbsp;for&nbsp;your&nbsp;redirect&nbsp;instead&nbsp;as&nbsp;ModSecurity&nbsp;rules&nbsp;can&nbsp;run&nbsp;before&nbsp;them.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Ryan&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
On&nbsp;Jul&nbsp;16,&nbsp;2011,&nbsp;at&nbsp;10:23&nbsp;PM,&nbsp;&amp;quot;Michael&nbsp;Haas&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:michael.haas10@gmail.com&quot;&gt;michael.haas10@gmail.com&lt;/a&gt;&amp;lt;mailto:&lt;a&nbsp;href=&quot;mailto:michael.haas10@gmail.com&quot;&gt;michael.haas10@gmail.com&lt;/a&gt;&amp;gt;&amp;gt;&nbsp;wrote:&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Hi,&lt;br&gt;<br>
&lt;br&gt;<br>
is&nbsp;it&nbsp;normal&nbsp;that&nbsp;if&nbsp;a&nbsp;redirect&nbsp;is&nbsp;configured&nbsp;in&nbsp;apache&nbsp;that&nbsp;mod_security&nbsp;is&nbsp;not&nbsp;blocking&nbsp;according&nbsp;to&nbsp;it&amp;#39;s&nbsp;rules?&nbsp;It&nbsp;logs&nbsp;the&nbsp;request&nbsp;but&nbsp;the&nbsp;Client&nbsp;is&nbsp;redirected.&lt;br&gt;<br>
&lt;br&gt;<br>
GET&nbsp;/..%5c../&nbsp;HTTP/1.1&lt;br&gt;<br>
Accept:&nbsp;image/gif,&nbsp;image/jpeg,&nbsp;image/pjpeg,&nbsp;image/pjpeg,&nbsp;application/vnd.ms-excel,&nbsp;application/vnd.ms-powerpoint,&nbsp;application/msword,&nbsp;application/x-shockwave-flash,&nbsp;application/security-layer,&nbsp;application/security-capsule,&nbsp;application/x-ms-application,&nbsp;application/x-ms-xbap,&nbsp;application/vnd.ms-xpsdocument,&nbsp;application/xaml+xml,&nbsp;*/*&lt;br&gt;<br>
<br>
Accept-Language:&nbsp;de-at,en-us;q=0.5&lt;br&gt;<br>
User-Agent:&nbsp;Mozilla/4.0&nbsp;(compatible;&nbsp;MSIE......)&lt;br&gt;<br>
Accept-Encoding:&nbsp;gzip,&nbsp;deflate&lt;br&gt;<br>
Host:&nbsp;XXX.xxxx&lt;br&gt;<br>
Connection:&nbsp;Keep-Alive&lt;br&gt;<br>
&lt;br&gt;<br>
--ac9b0025-F--&lt;br&gt;<br>
HTTP/1.1&nbsp;302&nbsp;Found&lt;br&gt;<br>
&lt;/div&gt;Location:&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;https://XXX.xxxx/&quot;&nbsp;target=&quot;_blank&quot;&gt;https://XXX.xxxx/&lt;/a&gt;&amp;gt;&nbsp;&lt;a&nbsp;href=&quot;https://XXX.xxxx/&quot;&nbsp;target=&quot;_blank&quot;&gt;https://XXX.xxxx/&lt;/a&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;Content-Length:&nbsp;208&lt;br&gt;<br>
Keep-Alive:&nbsp;timeout=5,&nbsp;max=100&lt;br&gt;<br>
Connection:&nbsp;Keep-Alive&lt;br&gt;<br>
Content-Type:&nbsp;text/html;&nbsp;charset=iso-8859-1&lt;br&gt;<br>
&lt;br&gt;<br>
--ac9b0025-H--&lt;br&gt;<br>
Message:&nbsp;Pattern&nbsp;match&nbsp;&amp;quot;(?:\x5c|(?:%(?:c(?:0%(?:9v|af)|1%1c)|2(?:5(?:2f|5c)|f)|u221[56]|1u|5c)|\/))(?:%(?:u2024|2e)|\.){2}(?:\x5c|(?:%(?:c(?:0%(?:9v|af)|1%1c)|2(?:5(?:2f|5c)|f)|u221[56]|1u|5c)|\/))&amp;quot;&nbsp;at&nbsp;REQUEST_FILENAME.&nbsp;[file&nbsp;&amp;quot;/test/modsecurity_crs/modsecurity_crs_15_exception.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;19&amp;quot;]&nbsp;[id&nbsp;&amp;quot;1000&amp;quot;]&nbsp;[rev&nbsp;&amp;quot;2.1.2&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Path&nbsp;Traversal&nbsp;Attack&amp;quot;]&nbsp;[severity&nbsp;&amp;quot;CRITICAL&amp;quot;]&lt;br&gt;<br>
<br>
Stopwatch:&nbsp;1310867782439547&nbsp;587&nbsp;(-&nbsp;-&nbsp;-)&lt;br&gt;<br>
&lt;/div&gt;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.5.13&nbsp;(&amp;lt;&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;&amp;gt;&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);&nbsp;core&nbsp;ruleset/&lt;a&nbsp;href=&quot;http://2.1.2.&quot;&nbsp;target=&quot;_blank&quot;&gt;2.1.2.&lt;/a&gt;&amp;lt;&lt;a&nbsp;href=&quot;http://2.1.2&quot;&nbsp;target=&quot;_blank&quot;&gt;http://2.1.2&lt;/a&gt;.&amp;gt;&lt;br&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;Server:&nbsp;Apache&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
If&nbsp;i&nbsp;do&nbsp;this&nbsp;without&nbsp;redirect&nbsp;the&nbsp;Rule&nbsp;blocks&nbsp;with&nbsp;403.&lt;br&gt;<br>
&lt;br&gt;<br>
Thats&nbsp;the&nbsp;Rule&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:PARANOID_MODE&nbsp;&amp;quot;@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;chain,phase:1,rev:&amp;#39;2.1.2&amp;#39;,t:none,ctl:auditLogParts=+E,block,msg:&amp;#39;Path&nbsp;Traversal&nbsp;Attack&amp;#39;,id:&amp;#39;1000&amp;#39;,severity:&amp;#39;2&amp;#39;&amp;quot;&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; SecRule&nbsp;REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&nbsp;&amp;quot;(?:\x5c|(?:%(?:c(?:0%(?:9v|af)|1%1c)|2(?:5(?:2f|5c)|f)|u221[56]|1u|5c)|\/))(?:%(?:u2024|2e)|\.){2}(?:\x5c|(?:%(?:c(?:0%(?:9v|af)|1%1c)|2(?:5(?:2f|5c)|f)|u221[56]|1u|5c)|\/))&amp;quot;&nbsp;\&lt;br&gt;<br>
<br>
&lt;/div&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &amp;quot;t:none,t:lowercase,capture,setvar:&amp;#39;tx.msg=%{rule.msg}&amp;#39;,setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:&amp;#39;tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;&amp;lt;&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;http://rule.id&lt;/a&gt;&amp;gt;}-WEB_ATTACK/DIR_TRAVERSAL-%{matched_var_name}=%{matched_var}&amp;#39;&amp;quot;&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Thanks&nbsp;in&nbsp;Advance&lt;br&gt;<br>
Michael&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;/div&gt;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&amp;lt;mailto:&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&amp;gt;&lt;br&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;________________________________&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
