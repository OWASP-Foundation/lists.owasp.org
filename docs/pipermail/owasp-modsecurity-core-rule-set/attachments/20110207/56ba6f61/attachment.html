<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0&nbsp;TRANSITIONAL//EN&quot;&gt;<br>
&lt;HTML&gt;<br>
&lt;HEAD&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;HTTP-EQUIV=&quot;Content-Type&quot;&nbsp;CONTENT=&quot;text/html;&nbsp;CHARSET=UTF-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;META&nbsp;NAME=&quot;GENERATOR&quot;&nbsp;CONTENT=&quot;GtkHTML/3.28.3&quot;&gt;<br>
&lt;/HEAD&gt;<br>
&lt;BODY&gt;<br>
Hi,&nbsp;we&nbsp;haven't&nbsp;had&nbsp;any&nbsp;luck&nbsp;with&nbsp;this&nbsp;issue,&nbsp;just&nbsp;wondering&nbsp;if&nbsp;anyone&nbsp;else&nbsp;has&nbsp;seen&nbsp;this&nbsp;or&nbsp;knows&nbsp;a&nbsp;solution?&lt;BR&gt;<br>
&lt;BR&gt;<br>
Here&nbsp;is&nbsp;the&nbsp;original&nbsp;email&nbsp;and&nbsp;a&nbsp;response&nbsp;follow&nbsp;up&nbsp;with&nbsp;some&nbsp;suggestions.&lt;BR&gt;<br>
&lt;BR&gt;<br>
Thanks&lt;BR&gt;<br>
-Chris&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
On&nbsp;Wed,&nbsp;2011-01-26&nbsp;at&nbsp;16:37&nbsp;-0800,&nbsp;Chris&nbsp;Swanson&nbsp;wrote:&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Hi,&nbsp;we're&nbsp;having&nbsp;a&nbsp;hard&nbsp;time&nbsp;with&nbsp;the&nbsp;new&nbsp;update(s)&nbsp;and&nbsp;Lua&nbsp;in&nbsp;our&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;testing&nbsp;environment.&nbsp;Here's&nbsp;the&nbsp;error&nbsp;we're&nbsp;seeing&nbsp;in&nbsp;Audit&nbsp;Console,&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;this&nbsp;is&nbsp;opening&nbsp;up&nbsp;a&nbsp;single&nbsp;transaction:&nbsp;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Unknown&amp;nbsp;&nbsp;|&nbsp;Lua:&nbsp;Script&nbsp;execution&nbsp;failed:&nbsp;attempt&nbsp;to&nbsp;call&nbsp;a&nbsp;nil&nbsp;value&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Unknown&amp;nbsp;&nbsp;|&nbsp;Rule&nbsp;processing&nbsp;failed.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;This&nbsp;is&nbsp;happening&nbsp;with&nbsp;modsecurity&nbsp;2.5.13&nbsp;and&nbsp;modsec&nbsp;CRS&nbsp;2.1.1&nbsp;on&nbsp;our&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Debian&nbsp;5&nbsp;servers,&nbsp;apache&nbsp;is&nbsp;configured&nbsp;with:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;./configure&nbsp;--prefix=/usr/local/apache&nbsp;--disable-userdir&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;--enable-rewrite&nbsp;--enable-so&nbsp;--enable-info&nbsp;--enable-status&nbsp;--enable-ssl&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;--enable-cgi&nbsp;--enable-unique-id&nbsp;--enable-mime-magic&nbsp;--with-included-apr&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;--with-pcre=/usr/bin/pcre-config&nbsp;--enable-deflate&nbsp;--enable-expires&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;--enable-headers&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;modsecuirty&nbsp;cofigured&nbsp;with:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;./configure&nbsp;--with-apxs=/usr/local/apache/bin/apxs&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;--with-apr=/usr/local/apache/bin/apr-1-config&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;I've&nbsp;narrowed&nbsp;it&nbsp;down&nbsp;to&nbsp;the&nbsp;include&nbsp;in&nbsp;our&nbsp;http.conf&nbsp;for&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;modsecurity_crs_41_advanced_filters.conf,&nbsp;which&nbsp;was&nbsp;previously&nbsp;working&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;as&nbsp;the&nbsp;phpids&nbsp;rules.&nbsp;Even&nbsp;further,&nbsp;by&nbsp;commenting&nbsp;out&nbsp;this&nbsp;section&nbsp;at&nbsp;the&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;top&nbsp;of&nbsp;the&nbsp;41_advanced_filters&nbsp;file&nbsp;everything&nbsp;works&nbsp;fine:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;#&nbsp;Lua&nbsp;script&nbsp;to&nbsp;normalize&nbsp;input&nbsp;payloads&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;#&nbsp;Based&nbsp;on&nbsp;PHPIDS&nbsp;Converter.php&nbsp;code&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;#&nbsp;Reference&nbsp;the&nbsp;following&nbsp;whitepaper&nbsp;-&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;#&nbsp;&lt;A&nbsp;HREF=&quot;http://docs.google.com/Doc?id=dd7x5smw_17g9cnx2cn&quot;&gt;http://docs.google.com/Doc?id=dd7x5smw_17g9cnx2cn&lt;/A&gt;&amp;nbsp;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;#&nbsp;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecRuleScript&nbsp;../lua/advanced_filter_converter.lua&nbsp;&amp;quot;phase:2,t:none,pass&amp;quot;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecRule&nbsp;TX:/centrifuge_ratio/&nbsp;&amp;quot;.*&amp;quot;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;&amp;quot;phase:2,t:none,log,capture,msg:'Centrifuge&nbsp;Threshold&nbsp;Alert&nbsp;-&nbsp;Ratio&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Value&nbsp;is:&nbsp;%{tx.0}'&amp;quot;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Here&nbsp;is&nbsp;the&nbsp;modsecurity&nbsp;includes&nbsp;in&nbsp;our&nbsp;http.conf&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;#modsecurity&nbsp;Rules&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Include&nbsp;conf/modsecurity.conf&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Include&nbsp;conf/modsecurity-crs_2.1.1/*.conf&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Include&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;conf/modsecurity-crs_2.1.1/experimental_rules/modsecurity_crs_41_advanced_filters.conf&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Include&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;conf/modsecurity-crs_2.1.1/optional_rules/modsecurity_crs_25_cc_known.conf&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Include&nbsp;conf/modsecurity-crs_2.1.1/base_rules/*conf&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;With&nbsp;the&nbsp;same&nbsp;setup&nbsp;and&nbsp;versions&nbsp;Modsecurity/Apache,&nbsp;CRS&nbsp;2.0.10&nbsp;worked&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;perfectly.&nbsp;We&nbsp;could&nbsp;move&nbsp;forward&nbsp;without&nbsp;Lua&nbsp;functionally,&nbsp;but&nbsp;I'm&nbsp;lost&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;as&nbsp;to&nbsp;why&nbsp;such&nbsp;a&nbsp;big&nbsp;addition&nbsp;would&nbsp;be&nbsp;broken&nbsp;from&nbsp;the&nbsp;get-go.&nbsp;Haven't&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;been&nbsp;able&nbsp;to&nbsp;find&nbsp;anyone&nbsp;posting&nbsp;with&nbsp;a&nbsp;similar&nbsp;issue&nbsp;so&nbsp;any&nbsp;help&nbsp;would&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;be&nbsp;greatly&nbsp;appreciated.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Thanks,&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;-Chris&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;A&nbsp;couple&nbsp;questions&nbsp;-&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;1)&nbsp;Did&nbsp;you&nbsp;modify&nbsp;the&nbsp;path&nbsp;to&nbsp;Lua&nbsp;in&nbsp;the&nbsp;script&nbsp;to&nbsp;point&nbsp;to&nbsp;your&nbsp;local&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;version?&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;2)&nbsp;Did&nbsp;you&nbsp;install&nbsp;the&nbsp;additional&nbsp;bitop&nbsp;Lua&nbsp;module?&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;&lt;A&nbsp;HREF=&quot;http://bitop.luajit.org/&quot;&gt;http://bitop.luajit.org/&lt;/A&gt;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;It&nbsp;is&nbsp;specified&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;script&nbsp;in&nbsp;a&nbsp;require&nbsp;statement.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;This&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#808080&quot;&gt;&amp;gt;&nbsp;is&nbsp;needed&nbsp;for&nbsp;the&nbsp;Octal&nbsp;to&nbsp;Decimal&nbsp;conversions.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;I&nbsp;was&nbsp;missing&nbsp;Bitop,&nbsp;I've&nbsp;installed&nbsp;it&nbsp;from&nbsp;source,&nbsp;changed&nbsp;the&nbsp;install&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;path&nbsp;for&nbsp;Debian,&nbsp;and&nbsp;I&nbsp;believe&nbsp;it's&nbsp;working&nbsp;as&nbsp;we&nbsp;can&nbsp;run&nbsp;the&nbsp;included&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;bitbench.lua&nbsp;with&nbsp;no&nbsp;errors.&nbsp;The&nbsp;Lua&nbsp;problem&nbsp;still&nbsp;exists.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;3)&nbsp;What&nbsp;was&nbsp;the&nbsp;request&nbsp;that&nbsp;triggered&nbsp;this&nbsp;error?&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;It&nbsp;triggers&nbsp;on&nbsp;any&nbsp;request,&nbsp;the&nbsp;one&nbsp;I've&nbsp;been&nbsp;using&nbsp;the&nbsp;most&nbsp;is&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;accessing&nbsp;the&nbsp;page&nbsp;via&nbsp;IP&nbsp;instead&nbsp;of&nbsp;hostname,&nbsp;here's&nbsp;a&nbsp;breakdown&nbsp;of&nbsp;all&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;the&nbsp;information&nbsp;regarding&nbsp;the&nbsp;request:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;----------------------&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Alert&nbsp;Messages:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;The&nbsp;following&nbsp;messages&nbsp;have&nbsp;been&nbsp;raised&nbsp;for&nbsp;this&nbsp;event:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Severity&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Rule&nbsp;ID&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Message&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;UNKNOWN&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Lua:&nbsp;Script&nbsp;execution&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;failed:&nbsp;attempt&nbsp;to&nbsp;call&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;a&nbsp;nil&nbsp;value&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Rule-Message:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;UNKNOWN&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Rule&nbsp;processing&nbsp;failed.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Rule-Message:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Rules&nbsp;Section&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;The&nbsp;following&nbsp;rules&nbsp;have&nbsp;been&nbsp;fired&nbsp;for&nbsp;this&nbsp;event:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;nolog&nbsp;pass&nbsp;setvar:tx.anomaly_score_blocking=on&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;nolog&nbsp;pass&nbsp;setvar:tx.critical_anomaly_score=5&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;setvar:tx.error_anomaly_score=4&nbsp;setvar:tx.warning_anomaly_score=3&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;setvar:tx.notice_anomaly_score=2&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;nolog&nbsp;pass&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;setvar:tx.inbound_anomaly_score_level=5&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;nolog&nbsp;pass&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;setvar:tx.outbound_anomaly_score_level=4&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;nolog&nbsp;pass&nbsp;setvar:tx.paranoid_mode=0&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;nolog&nbsp;pass&nbsp;setvar:tx.max_num_args=255&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;nolog&nbsp;pass&nbsp;setvar:'tx.allowed_methods=GET&nbsp;HEAD&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;POST&nbsp;OPTIONS'&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded&nbsp;multipart/form-data&nbsp;text/xml&nbsp;application/xml&nbsp;application/x-amf'&nbsp;setvar:'tx.allowed_http_versions=HTTP/0.9&nbsp;HTTP/1.0&nbsp;HTTP/1.1'&nbsp;setvar:'tx.restricted_extensions=.asa/&nbsp;.asax/&nbsp;.ascx/&nbsp;.axd/&nbsp;.backup/&nbsp;.bak/&nbsp;.bat/&nbsp;.cdx/&nbsp;.cer/&nbsp;.cfg/&nbsp;.cmd/&nbsp;.com/&nbsp;.config/&nbsp;.conf/&nbsp;.cs/&nbsp;.csproj/&nbsp;.csr/&nbsp;.dat/&nbsp;.db/&nbsp;.dbf/&nbsp;.dll/&nbsp;.dos/&nbsp;.htr/&nbsp;.htw/&nbsp;.ida/&nbsp;.idc/&nbsp;.idq/&nbsp;.inc/&nbsp;.ini/&nbsp;.key/&nbsp;.licx/&nbsp;.lnk/&nbsp;.log/&nbsp;.mdb/&nbsp;.old/&nbsp;.pass/&nbsp;.pdb/&nbsp;.pol/&nbsp;.printer/&nbsp;.pwd/&nbsp;.resources/&nbsp;.resx/&nbsp;.sql/&nbsp;.sys/&nbsp;.vb/&nbsp;.vbs/&nbsp;.vbproj/&nbsp;.vsdisco/&nbsp;.webinfo/&nbsp;.xsd/&nbsp;.xsx/'&nbsp;setvar:'tx.restricted_headers=/Lock-Token/&nbsp;/Content-Range/&nbsp;/Translate/&nbsp;/via/&nbsp;/if/'&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;@rx&nbsp;^(.*)$&nbsp;phase:1&nbsp;t:none&nbsp;pass&nbsp;nolog&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;t:sha1&nbsp;t:hexEncode&nbsp;setvar:tx.ua_hash=%{matched_var}&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:1&nbsp;t:none&nbsp;pass&nbsp;nolog&nbsp;initcol:global=global&nbsp;initcol:ip=&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;%{remote_addr}_%{tx.ua_hash}&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;SecAction&nbsp;phase:4&nbsp;t:none&nbsp;nolog&nbsp;skipAfter:END_KNOWN_CC_OUTBOUND_CHECK\&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Request&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;GET&nbsp;/&nbsp;HTTP/1.1&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Host:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;172.16.100.191&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Connection:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;keep-alive&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Accept:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;application/xml,application/xhtml&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;User-Agent:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Mozilla/5.0&nbsp;(X11;&nbsp;U;&nbsp;Linux&nbsp;x86_64;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;en-US)&nbsp;AppleWebKit/534.10&nbsp;(KHTML,&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;like&nbsp;Gecko)&nbsp;Chrome/8.0.552.200&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Safari/534.10&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Accept-Encoding:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;gzip,deflate,sdch&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Accept-Language:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;en-US,en;q=0.8&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Accept-Charset:&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;ISO-8859-1,utf-8;q=0.7,*;q=0.3&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;----------------------&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;You&nbsp;can&nbsp;still&nbsp;run&nbsp;it&nbsp;in&nbsp;this&nbsp;manner&nbsp;but&nbsp;since&nbsp;it&nbsp;will&nbsp;NOT&nbsp;be&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;normalizing&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;data&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;as&nbsp;PHPIDS,&nbsp;there&nbsp;will&nbsp;be&nbsp;a&nbsp;higher&nbsp;%&nbsp;of&nbsp;false&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;positives/false&nbsp;negatives.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;We&nbsp;did&nbsp;put&nbsp;this&nbsp;in&nbsp;the&nbsp;experimental&nbsp;directory&nbsp;after&nbsp;all&nbsp;;)&nbsp;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;True&nbsp;enough!&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&amp;nbsp;&nbsp;Seriously,&nbsp;we&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;need&nbsp;more&nbsp;people&nbsp;to&nbsp;field&nbsp;test&nbsp;this&nbsp;new,&nbsp;advanced&nbsp;functionality.&amp;nbsp;&nbsp;I&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;applaud&nbsp;you&nbsp;for&nbsp;jumping&nbsp;in!&amp;nbsp;&nbsp;Don't&nbsp;give&nbsp;up&nbsp;on&nbsp;it,&nbsp;hopefully&nbsp;we&nbsp;can&nbsp;get&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;it&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;working&nbsp;for&nbsp;you.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#737373&quot;&gt;&amp;gt;&nbsp;-Ryan&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;Glad&nbsp;we&nbsp;can&nbsp;help&nbsp;out,&nbsp;we&nbsp;will&nbsp;keep&nbsp;on&nbsp;it&nbsp;until&nbsp;it's&nbsp;resolved.&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BR&gt;<br>
&lt;TT&gt;&lt;FONT&nbsp;COLOR=&quot;#171717&quot;&gt;-Chris&lt;/FONT&gt;&lt;/TT&gt;&lt;BR&gt;<br>
&lt;BLOCKQUOTE&nbsp;TYPE=CITE&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;BR&gt;<br>
&lt;/BLOCKQUOTE&gt;<br>
&lt;/BODY&gt;<br>
&lt;/HTML&gt;<br>

</tt>
