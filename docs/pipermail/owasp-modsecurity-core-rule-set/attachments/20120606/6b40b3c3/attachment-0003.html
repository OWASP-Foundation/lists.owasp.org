<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=Windows-1252&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;Updated&nbsp;the&nbsp;following&nbsp;section&nbsp;for&nbsp;the&nbsp;SecDefaultAction&nbsp;directive&nbsp;that&nbsp;controls&nbsp;the&nbsp;mode&nbsp;of&nbsp;operation&nbsp;–&nbsp;either&nbsp;self-contained&nbsp;or&nbsp;collaborative&nbsp;detection.&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;--&nbsp;[[&nbsp;Modes&nbsp;of&nbsp;Operation:&nbsp;Self-Contained&nbsp;vs.&nbsp;Collaborative&nbsp;Detection&nbsp;]]&nbsp;-----------------&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;Each&nbsp;detection&nbsp;rule&nbsp;uses&nbsp;the&nbsp;&quot;block&quot;&nbsp;action&nbsp;which&nbsp;will&nbsp;inherit&nbsp;the&nbsp;SecDefaultAction&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;specified&nbsp;below.&nbsp;&nbsp;Your&nbsp;settings&nbsp;here&nbsp;will&nbsp;determine&nbsp;which&nbsp;mode&nbsp;of&nbsp;operation&nbsp;you&nbsp;use.&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;--&nbsp;[[&nbsp;Self-Contained&nbsp;Mode&nbsp;]]&nbsp;--&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;Rules&nbsp;inherit&nbsp;the&nbsp;&quot;deny&quot;&nbsp;disruptive&nbsp;action.&nbsp;&nbsp;The&nbsp;first&nbsp;rule&nbsp;that&nbsp;matches&nbsp;will&nbsp;block.&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;--&nbsp;[[&nbsp;Collaborative&nbsp;Detection&nbsp;Mode&nbsp;]]&nbsp;--&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;This&nbsp;is&nbsp;a&nbsp;&quot;delayed&nbsp;blocking&quot;&nbsp;mode&nbsp;of&nbsp;operation&nbsp;where&nbsp;each&nbsp;matching&nbsp;rule&nbsp;will&nbsp;inherit&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;the&nbsp;&quot;pass&quot;&nbsp;action&nbsp;and&nbsp;will&nbsp;only&nbsp;contribute&nbsp;to&nbsp;anomaly&nbsp;scores.&nbsp;&nbsp;Transactional&nbsp;blocking&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;can&nbsp;be&nbsp;applied&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;--&nbsp;[[&nbsp;Alert&nbsp;Logging&nbsp;Control&nbsp;]]&nbsp;--&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;You&nbsp;have&nbsp;three&nbsp;options&nbsp;-&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;-&nbsp;To&nbsp;log&nbsp;to&nbsp;both&nbsp;the&nbsp;Apache&nbsp;error_log&nbsp;and&nbsp;ModSecurity&nbsp;audit_log&nbsp;file&nbsp;use:&nbsp;&quot;log&quot;&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;-&nbsp;To&nbsp;log&nbsp;*only*&nbsp;to&nbsp;the&nbsp;ModSecurity&nbsp;audit_log&nbsp;file&nbsp;use:&nbsp;&quot;nolog,auditlog&quot;&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;-&nbsp;To&nbsp;log&nbsp;*only*&nbsp;to&nbsp;the&nbsp;Apache&nbsp;error_log&nbsp;file&nbsp;use:&nbsp;&quot;log,noauditlog&quot;&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;Ref:&nbsp;http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html&lt;/div&gt;<br>
&lt;div&gt;#&nbsp;Ref:&nbsp;https://sourceforge.net/apps/mediawiki/mod-security/index.php?title=Reference_Manual#SecDefaultAction&lt;/div&gt;<br>
&lt;div&gt;#&lt;/div&gt;<br>
&lt;div&gt;SecDefaultAction&nbsp;&quot;phase:2,deny,log&quot;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;For&nbsp;discussion&nbsp;purposes,&nbsp;regarding&nbsp;&quot;disruptive&nbsp;actions&quot;,&nbsp;I&nbsp;believe&nbsp;that&nbsp;we&nbsp;should&nbsp;consider&nbsp;responding&nbsp;differently&nbsp;to&nbsp;malicious&nbsp;transactions.&nbsp;&nbsp;Issuing&nbsp;HTTP&nbsp;4xx&nbsp;level&nbsp;response&nbsp;codes&nbsp;are&nbsp;of&nbsp;no&nbsp;help&nbsp;to&nbsp;non-malicious&nbsp;end&nbsp;users&nbsp;who&nbsp;have&nbsp;innocently&nbsp;triggered<br>
&nbsp;an&nbsp;alert&nbsp;and&nbsp;they&nbsp;also&nbsp;&quot;tip&nbsp;the&nbsp;hand&quot;&nbsp;a&nbsp;bit&nbsp;to&nbsp;malicious&nbsp;users&nbsp;that&nbsp;there&nbsp;is&nbsp;some&nbsp;type&nbsp;of&nbsp;separate&nbsp;security&nbsp;layer&nbsp;in&nbsp;place.&nbsp;&nbsp;I&nbsp;am&nbsp;a&nbsp;proponent&nbsp;of&nbsp;trying&nbsp;to&nbsp;make&nbsp;a&nbsp;WAF&nbsp;deployment&nbsp;transparent&nbsp;to&nbsp;the&nbsp;user&nbsp;–&nbsp;meaning&nbsp;that&nbsp;they&nbsp;can&nbsp;decipher&nbsp;when&nbsp;ModSecurity&nbsp;has&nbsp;triggered<br>
&nbsp;an&nbsp;alert&nbsp;vs.&nbsp;if&nbsp;the&nbsp;application&nbsp;itself&nbsp;issues&nbsp;some&nbsp;type&nbsp;of&nbsp;violation.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;For&nbsp;example&nbsp;–&nbsp;oftentimes&nbsp;when&nbsp;an&nbsp;invalid&nbsp;request&nbsp;is&nbsp;received,&nbsp;applications&nbsp;will&nbsp;issue&nbsp;302&nbsp;Redirects&nbsp;back&nbsp;to&nbsp;the&nbsp;previous&nbsp;page&nbsp;or&nbsp;a&nbsp;login&nbsp;page.&nbsp;&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;prose&nbsp;the&nbsp;idea&nbsp;of&nbsp;using&nbsp;the&nbsp;redirect&nbsp;action&nbsp;here&nbsp;within&nbsp;the&nbsp;SecDefaultAction&nbsp;setting&nbsp;and&nbsp;letting<br>
&nbsp;the&nbsp;ModSec&nbsp;Admin&nbsp;choose&nbsp;&lt;span&nbsp;style=&quot;font-weight:&nbsp;bold&quot;&gt;where&lt;/span&gt;&nbsp;to&nbsp;redirect&nbsp;users&nbsp;too&nbsp;when&nbsp;an&nbsp;alert&nbsp;is&nbsp;triggered.&nbsp;&nbsp;Example:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;SecDefaultAction&nbsp;&quot;phase:2,redirect:http://www.example.com/login.php,log&quot;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Comments?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabs&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;ModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,<br>
&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic<br>
&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
