<tt>
&lt;div&gt;-&nbsp;Thanks&nbsp;for&nbsp;the&nbsp;second&nbsp;issue&amp;#39;s&nbsp;solution.&nbsp;It&nbsp;suits&nbsp;me&nbsp;perfectly!&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;-&nbsp;Concerning&nbsp;the&nbsp;first&nbsp;and&nbsp;third&nbsp;issues&nbsp;(as&nbsp;I&nbsp;think&nbsp;that&nbsp;they&amp;#39;ll&nbsp;share&nbsp;the&nbsp;same&nbsp;solution),&nbsp;I&amp;#39;m&nbsp;already&nbsp;using&nbsp;a&nbsp;&amp;quot;SecDefaultAction&amp;quot;&nbsp;that&nbsp;logs&nbsp;everywhere&nbsp;(for&nbsp;log&nbsp;parsing&nbsp;purposes);&nbsp;but&nbsp;suppose&nbsp;I&amp;#39;m&nbsp;in&nbsp;&amp;quot;Detection&amp;quot;&nbsp;mode&nbsp;and&nbsp;I&amp;#39;d&nbsp;like&nbsp;to&nbsp;count&nbsp;the&nbsp;requests&nbsp;that&nbsp;ModSecurity&nbsp;would&nbsp;have&nbsp;rejected&nbsp;if&nbsp;I&nbsp;move&nbsp;to&nbsp;&amp;quot;Blocking&amp;quot;&nbsp;mode.&nbsp;The&nbsp;fast&amp;amp;easy&nbsp;way&nbsp;to&nbsp;do&nbsp;that&nbsp;would&nbsp;be&nbsp;to&nbsp;count&nbsp;lines&nbsp;that&nbsp;contain&nbsp;&amp;quot;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&amp;quot;&nbsp;but&nbsp;it&amp;#39;s&nbsp;currently&nbsp;unreliable&nbsp;as&nbsp;described&nbsp;in&nbsp;my&nbsp;previous&nbsp;e-mail.&lt;div&gt;<br>
The&nbsp;change&nbsp;you&amp;#39;ve&nbsp;brought&nbsp;still&nbsp;doesn&amp;#39;t&nbsp;fix&nbsp;it.&nbsp;What&nbsp;about&nbsp;this?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;webkit-indent-blockquote&quot;&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;&lt;div&gt;&lt;div&gt;#&nbsp;Alert&nbsp;and&nbsp;Block&nbsp;based&nbsp;on&nbsp;Anomaly&nbsp;Scores&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;div&gt;#&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;TX:/^\d+\-/&nbsp;&amp;quot;(.*)&amp;quot;&nbsp;&amp;quot;pass,nolog,capture&amp;quot;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&amp;quot;@gt&nbsp;0&amp;quot;&nbsp;\&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp;&amp;quot;chain,phase:2,id:&amp;#39;981176&amp;#39;,t:none,deny,log,msg:&amp;#39;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(Total&nbsp;Score:&nbsp;%{TX.ANOMALY_SCORE},&nbsp;SQLi=%{TX.SQL_INJECTION_SCORE},&nbsp;XSS=%{TX.XSS_SCORE}):&nbsp;%{tx.msg}&amp;#39;,logdata:&amp;#39;%{tx.0}&amp;#39;,setvar:tx.inbound_tx_msg=%{tx.msg},setvar:tx.inbound_anomaly_score=%{tx.anomaly_score}&amp;quot;&lt;/div&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;TX:ANOMALY_SCORE_BLOCKING&nbsp;&amp;quot;@streq&nbsp;on&amp;quot;&nbsp;chain&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&amp;quot;@ge&nbsp;%{tx.inbound_anomaly_score_level}&amp;quot;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;and&nbsp;as&nbsp;an&nbsp;extra:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;webkit-indent-blockquote&quot;&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;#&nbsp;Alert&nbsp;if&nbsp;Anomaly&nbsp;Score&nbsp;does&nbsp;not&nbsp;exceed&nbsp;the&nbsp;Anomaly&nbsp;Score&nbsp;Level&lt;br&gt;<br>
#&lt;br&gt;SecRule&nbsp;TX:/^\d+\-/&nbsp;&amp;quot;(.*)&amp;quot;&nbsp;&amp;quot;pass,nolog,capture&amp;quot;&lt;br&gt;SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&amp;quot;@gt&nbsp;0&amp;quot;&nbsp;\&lt;br&gt; &nbsp; &nbsp;&amp;quot;chain,phase:2,id:&amp;#39;981176&amp;#39;,t:none,pass,log,msg:&amp;#39;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;(Total&nbsp;Score:&nbsp;%{TX.ANOMALY_SCORE},&nbsp;SQLi=%{TX.SQL_INJECTION_SCORE},&nbsp;XSS=%{TX.XSS_SCORE}):&nbsp;%{tx.msg}&amp;#39;,logdata:&amp;#39;%{tx.0}&amp;#39;,setvar:tx.inbound_tx_msg=%{tx.msg},setvar:tx.inbound_anomaly_score=%{tx.anomaly_score}&amp;quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;TX:ANOMALY_SCORE_BLOCKING&nbsp;&amp;quot;@streq&nbsp;on&amp;quot;&nbsp;chain&lt;br&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&amp;quot;@lt&nbsp;%{tx.inbound_anomaly_score_level}&amp;quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;class=&quot;webkit-indent-blockquote&quot;&nbsp;style=&quot;margin:&nbsp;0&nbsp;0&nbsp;0&nbsp;40px;&nbsp;border:&nbsp;none;&nbsp;padding:&nbsp;0px;&quot;&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;What&nbsp;do&nbsp;you&nbsp;thing&nbsp;of&nbsp;that?&nbsp;Sad&nbsp;that&nbsp;we&nbsp;missed&nbsp;2.2.2&nbsp;for&nbsp;this&nbsp;issues,&nbsp;is&nbsp;there&nbsp;any&nbsp;planned&nbsp;date&nbsp;for&nbsp;the&nbsp;2.2.3&nbsp;?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thanks&nbsp;Ryan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Rm4dillo&lt;/div&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Sep&nbsp;28,&nbsp;2011&nbsp;at&nbsp;10:35&nbsp;PM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex;&quot;&gt;<br>
&lt;br&gt;<br>
From:&nbsp;rm4dillo&nbsp;D&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:rm4dillo@gmail.com&quot;&gt;rm4dillo@gmail.com&lt;/a&gt;&amp;lt;mailto:&lt;a&nbsp;href=&quot;mailto:rm4dillo@gmail.com&quot;&gt;rm4dillo@gmail.com&lt;/a&gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
Date:&nbsp;Wed,&nbsp;28&nbsp;Sep&nbsp;2011&nbsp;12:18:17&nbsp;-0500&lt;br&gt;<br>
To:&nbsp;&amp;quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&amp;lt;mailto:&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&amp;gt;&amp;quot;&nbsp;&amp;lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&amp;lt;mailto:&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&amp;gt;&amp;gt;&lt;br&gt;<br>
<br>
Subject:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;981176&amp;#39;s&nbsp;last&nbsp;matched&nbsp;data&nbsp;issues&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
I&nbsp;have&nbsp;three&nbsp;questions&nbsp;concerning&nbsp;the&nbsp;changes&nbsp;that&nbsp;have&nbsp;been&nbsp;applied&nbsp;to&nbsp;the&nbsp;rule&nbsp;981176&nbsp;in&nbsp;order&nbsp;to&nbsp;add&nbsp;the&nbsp;last&nbsp;matched&nbsp;data&nbsp;in&nbsp;the&nbsp;log&nbsp;line.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;Yeah,&nbsp;these&nbsp;rules&nbsp;in&nbsp;the&nbsp;49&nbsp;inbound&nbsp;blocking&nbsp;file&nbsp;can&nbsp;certainly&nbsp;be&nbsp;improved&nbsp;upon.&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
First,&nbsp;when&nbsp;ModSecurity&nbsp;is&nbsp;in&nbsp;&amp;quot;DetectionOnly&amp;quot;&nbsp;mode,&nbsp;the&nbsp;chained&nbsp;rule&nbsp;(&nbsp;SecRule&nbsp;TX:/^\d/&nbsp;&amp;quot;(.*)&amp;quot;&nbsp;)&nbsp;that&nbsp;has&nbsp;been&nbsp;added&nbsp;is&nbsp;triggered&nbsp;as&nbsp;many&nbsp;times&nbsp;as&nbsp;the&nbsp;number&nbsp;of&nbsp;variable&nbsp;names&nbsp;in&nbsp;the&nbsp;transaction&nbsp;collection&nbsp;that&nbsp;match&nbsp;the&nbsp;&amp;quot;^\d&amp;quot;&nbsp;regular&nbsp;expression.&nbsp;This&nbsp;makes&nbsp;ModSecurity&nbsp;log&nbsp;only&nbsp;one&nbsp;entry&nbsp;when&nbsp;it&amp;#39;s&nbsp;in&nbsp;the&nbsp;&amp;quot;Blocking&amp;quot;&nbsp;mode&nbsp;and&nbsp;lots&nbsp;of&nbsp;entries&nbsp;when&nbsp;in&nbsp;&amp;quot;DetectionOnly&amp;quot;&nbsp;mode.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&lt;/div&gt;This&nbsp;is&nbsp;true&nbsp;however&nbsp;you&nbsp;can&nbsp;control&nbsp;how&nbsp;you&nbsp;want&nbsp;the&nbsp;rules&nbsp;to&nbsp;log&nbsp;by&nbsp;editing&nbsp;the&nbsp;SecDefaultAction&nbsp;within&nbsp;the&nbsp;10&nbsp;config&nbsp;file.&nbsp; If&nbsp;you&nbsp;wan&nbsp;to&nbsp;run&nbsp;in&nbsp;anomaly&nbsp;scoring&nbsp;mode&nbsp;with&nbsp;blocking&nbsp;and&nbsp;less&nbsp;logging,&nbsp;then&nbsp;you&nbsp;can&nbsp;set&nbsp;SecDefaultAction&nbsp;to&nbsp;&amp;quot;pass,nolog,auditlog&amp;quot;&nbsp;and&nbsp;this&nbsp;will&nbsp;mean&nbsp;that&nbsp;each&nbsp;individual&nbsp;SecRule&nbsp;will&nbsp;log&nbsp;an&nbsp;entry&nbsp;to&nbsp;the&nbsp;audit&nbsp;log&nbsp;but&nbsp;only&nbsp;the&nbsp;rules&nbsp;in&nbsp;the&nbsp;40&nbsp;inbound&nbsp;blocking&nbsp;file&nbsp;will&nbsp;log&nbsp;to&nbsp;the&nbsp;Apache&nbsp;error_log.&nbsp; This&nbsp;will&nbsp;give&nbsp;you&nbsp;the&nbsp;overall&nbsp;anomaly&nbsp;score&nbsp;and&nbsp;data&nbsp;on&nbsp;the&nbsp;last&nbsp;rule&nbsp;match.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;want&nbsp;to&nbsp;run&nbsp;in&nbsp;anomaly&nbsp;scoring&nbsp;mode&nbsp;with&nbsp;blocking&nbsp;but&nbsp;to&nbsp;have&nbsp;more&nbsp;logging&nbsp;in&nbsp;the&nbsp;Apache&nbsp;error&nbsp;log,&nbsp;then&nbsp;simply&nbsp;change&nbsp;the&nbsp;SecDefaultAction&nbsp;to&nbsp;&amp;quot;pass,log&amp;quot;&nbsp;and&nbsp;this&nbsp;means&nbsp;that&nbsp;all&nbsp;rules&nbsp;will&nbsp;log&nbsp;to&nbsp;both&nbsp;the&nbsp;audit&nbsp;and&nbsp;error&nbsp;logs.&nbsp; This&nbsp;is&nbsp;more&nbsp;chatty&nbsp;obviously&nbsp;but&nbsp;you&nbsp;will&nbsp;still&nbsp;have&nbsp;all&nbsp;logging.&lt;br&gt;<br>
<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;second&nbsp;issue&nbsp;with&nbsp;this&nbsp;chained&nbsp;rule&nbsp;is&nbsp;that&nbsp;the&nbsp;&amp;quot;^\d&amp;quot;&nbsp;regular&nbsp;expression&nbsp;is&nbsp;not&nbsp;discriminant&nbsp;enough&nbsp;as&nbsp;it&nbsp;matches&nbsp;the&nbsp;&amp;quot;capture&amp;quot;&nbsp;action&nbsp;variables&nbsp;&amp;quot;TX:0&amp;quot;,&nbsp;&amp;quot;TX:1&amp;quot;,&nbsp;...&nbsp;and&nbsp;&amp;quot;TX:9&amp;quot;&nbsp;when&nbsp;in&nbsp;&amp;quot;DetectionOnly&amp;quot;&nbsp;mod.&nbsp;A&nbsp;quick&nbsp;fix&nbsp;to&nbsp;avoid&nbsp;that&nbsp;would&nbsp;be&nbsp;replacing&nbsp;the&nbsp;regular&nbsp;expression&nbsp;by&nbsp;&amp;quot;^/d{2}&amp;quot;.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&lt;/div&gt;Agreed.&nbsp; I&nbsp;updated&nbsp;it&nbsp;to&nbsp;this&nbsp;and&nbsp;it&nbsp;seems&nbsp;to&nbsp;work&nbsp;better&nbsp;-&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:/^\d+\-/&nbsp;&amp;quot;(.*)&amp;quot;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;last&nbsp;issue&nbsp;(still&nbsp;related&nbsp;to&nbsp;this&nbsp;chained&nbsp;rule;&nbsp;I&nbsp;think&nbsp;that&nbsp;I&nbsp;don&amp;#39;t&nbsp;like&nbsp;it&nbsp;much&nbsp;;-)&nbsp;)&nbsp;is&nbsp;that&nbsp;the&nbsp;&amp;quot;matched_var&amp;quot;&nbsp;variable&nbsp;does&nbsp;not&nbsp;really&nbsp;contain&nbsp;the&nbsp;&amp;quot;Last&nbsp;Matched&nbsp;Data&amp;quot;.&nbsp;In&nbsp;&amp;quot;DetectionOnly&amp;quot;&nbsp;mode,&nbsp;it&nbsp;will&nbsp;only&nbsp;be&nbsp;valid&nbsp;for&nbsp;the&nbsp;last&nbsp;logged&nbsp;line&nbsp;as&nbsp;it&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;last&nbsp;matched&nbsp;rule&nbsp;and&nbsp;erroneous&nbsp;for&nbsp;all&nbsp;the&nbsp;other&nbsp;lines&nbsp;(Cf.&nbsp;first&nbsp;issue).&nbsp;In&nbsp;&amp;quot;Blocking&amp;quot;&nbsp;mode&nbsp;(as&nbsp;we&nbsp;log&nbsp;only&nbsp;once&nbsp;then&nbsp;the&nbsp;request&nbsp;is&nbsp;rejected&nbsp;if&nbsp;the&nbsp;score&nbsp;has&nbsp;exceeded)&nbsp;it&nbsp;will&nbsp;contain&nbsp;the&nbsp;matched&nbsp;data&nbsp;of&nbsp;the&nbsp;first&nbsp;rule&nbsp;that&nbsp;matched&nbsp;and&nbsp;the&nbsp;message&nbsp;(tx.msg)&nbsp;of&nbsp;the&nbsp;last&nbsp;one.&lt;br&gt;<br>
<br>
This&nbsp;produces&nbsp;misleading&nbsp;logs&nbsp;as&nbsp;the&nbsp;one&nbsp;below:&lt;br&gt;<br>
&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; [Wed&nbsp;Sep&nbsp;28&nbsp;18:44:53&nbsp;2011]&nbsp;[error]&nbsp;[client&nbsp;::1]&nbsp;ModSecurity:&nbsp;Warning.&nbsp;Pattern&nbsp;match&nbsp;&amp;quot;(.*)&amp;quot;&nbsp;at&nbsp;TX:959073-WEB_ATTACK/SQL_INJECTION-ARGS:test.&nbsp;[file&nbsp;&amp;quot;/etc/modsecurity/activated_rules/modsecurity_crs_49_inbound_blocking.conf&amp;quot;]&nbsp;[line&nbsp;&amp;quot;26&amp;quot;]&nbsp;[id&nbsp;&amp;quot;981176&amp;quot;]&nbsp;[msg&nbsp;&amp;quot;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(Total&nbsp;Score:&nbsp;44,&nbsp;SQLi=15,&nbsp;XSS=30):&nbsp;Last&nbsp;Matched&nbsp;Message:&nbsp;IE&nbsp;XSS&nbsp;Filters&nbsp;-&nbsp;Attack&nbsp;Detected&amp;quot;]&nbsp;[data&nbsp;&amp;quot;Last&nbsp;Matched&nbsp;Data:&nbsp;benchmark(&amp;quot;]&nbsp;[hostname&nbsp;&amp;quot;localhost&amp;quot;]&nbsp;[uri&nbsp;&amp;quot;/&amp;quot;]&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
As&nbsp;most&nbsp;rules&nbsp;use&nbsp;the&nbsp;&amp;quot;capture&amp;quot;&nbsp;action,&nbsp;why&nbsp;don&amp;#39;t&nbsp;we&nbsp;replace&nbsp;the&nbsp;chained&nbsp;rule&nbsp;&amp;quot;hack?&amp;quot;&nbsp;with&nbsp;a&nbsp;simple&nbsp;&amp;quot;logdata:&amp;#39;Last&nbsp;Matched&nbsp;Data:&nbsp;%{tx.0}&amp;quot;.&nbsp;This&nbsp;still&nbsp;would&nbsp;be&nbsp;better&nbsp;but&nbsp;still&nbsp;not&nbsp;perfect&nbsp;as&nbsp;the&nbsp;content&nbsp;will&nbsp;sometimes&nbsp;be&nbsp;erronuous&nbsp;because&nbsp;some&nbsp;rules&nbsp;can&amp;#39;t&nbsp;capture.&nbsp;Or,&nbsp;even&nbsp;cleaner,&nbsp;why&nbsp;don&amp;#39;t&nbsp;we&nbsp;add&nbsp;a&nbsp;&amp;quot;setvar:&amp;#39;tx.last_matched_data=...&amp;quot;&nbsp;in&nbsp;every&nbsp;rule?&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&lt;/div&gt;I&nbsp;updated&nbsp;the&nbsp;rules&nbsp;to&nbsp;use&nbsp;the&nbsp;following.&nbsp; Let&nbsp;me&nbsp;know&nbsp;if&nbsp;this&nbsp;is&nbsp;any&nbsp;better&nbsp;-&lt;br&gt;<br>
&lt;br&gt;<br>
#&nbsp;Alert&nbsp;and&nbsp;Block&nbsp;based&nbsp;on&nbsp;Anomaly&nbsp;Scores&lt;br&gt;<br>
#&lt;br&gt;<br>
SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&amp;quot;@gt&nbsp;0&amp;quot;&nbsp;\&lt;br&gt;<br>
&nbsp; &nbsp; &amp;quot;chain,phase:2,id:&amp;#39;981176&amp;#39;,t:none,deny,log,msg:&amp;#39;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(Total&nbsp;Score:&nbsp;%{TX.ANOMALY_SCORE},&nbsp;SQLi=%{TX.SQL_INJECTION_SCORE},&nbsp;XSS=%{TX.XSS_SCORE}):&nbsp;%{tx.msg}&amp;#39;,logdata:&amp;#39;%{tx.0}&amp;#39;,setvar:tx.inbound_tx_msg=%{tx.msg},setvar:tx.inbound_anomaly_score=%{tx.anomaly_score}&amp;quot;&lt;br&gt;<br>
<br>
&nbsp; &nbsp; &nbsp; &nbsp; SecRule&nbsp;TX:ANOMALY_SCORE&nbsp;&amp;quot;@ge&nbsp;%{tx.inbound_anomaly_score_level}&amp;quot;&nbsp;chain&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SecRule&nbsp;TX:ANOMALY_SCORE_BLOCKING&nbsp;&amp;quot;@streq&nbsp;on&amp;quot;&nbsp;chain&lt;br&gt;<br>
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SecRule&nbsp;TX:/^\d+\-/&nbsp;&amp;quot;(.*)&amp;quot;&nbsp;&amp;quot;capture&amp;quot;&lt;br&gt;<br>
&lt;br&gt;<br>
-Ryan&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Cheers,&lt;br&gt;<br>
&lt;br&gt;<br>
Rm4dillo&lt;br&gt;<br>
&lt;br&gt;<br>
________________________________&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
