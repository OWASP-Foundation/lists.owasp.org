<tt>
&lt;html&nbsp;xmlns:v=&quot;urn:schemas-microsoft-com:vml&quot;&nbsp;xmlns:o=&quot;urn:schemas-microsoft-com:office:office&quot;&nbsp;xmlns:w=&quot;urn:schemas-microsoft-com:office:word&quot;&nbsp;xmlns:m=&quot;http://schemas.microsoft.com/office/2004/12/omml&quot;&nbsp;xmlns=&quot;http://www.w3.org/TR/REC-html40&quot;&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=Content-Type&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;&lt;meta&nbsp;name=Generator&nbsp;content=&quot;Microsoft&nbsp;Word&nbsp;12&nbsp;(filtered&nbsp;medium)&quot;&gt;&lt;!--[if&nbsp;!mso]&gt;&lt;style&gt;v\:*&nbsp;{behavior:url(#default#VML);}<br>
o\:*&nbsp;{behavior:url(#default#VML);}<br>
w\:*&nbsp;{behavior:url(#default#VML);}<br>
.shape&nbsp;{behavior:url(#default#VML);}<br>
&lt;/style&gt;&lt;![endif]--&gt;&lt;style&gt;&lt;!--<br>
/*&nbsp;Font&nbsp;Definitions&nbsp;*/<br>
@font-face<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{font-family:&quot;Cambria&nbsp;Math&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppanose-1:2&nbsp;4&nbsp;5&nbsp;3&nbsp;5&nbsp;4&nbsp;6&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{font-family:Calibri;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppanose-1:2&nbsp;15&nbsp;5&nbsp;2&nbsp;2&nbsp;2&nbsp;4&nbsp;3&nbsp;2&nbsp;4;}<br>
@font-face<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{font-family:Tahoma;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsppanose-1:2&nbsp;11&nbsp;6&nbsp;4&nbsp;3&nbsp;5&nbsp;4&nbsp;4&nbsp;2&nbsp;4;}<br>
/*&nbsp;Style&nbsp;Definitions&nbsp;*/<br>
p.MsoNormal,&nbsp;li.MsoNormal,&nbsp;div.MsoNormal<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{margin:0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-bottom:.0001pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-size:11.0pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;}<br>
a:link,&nbsp;span.MsoHyperlink<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-priority:99;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:blue;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-decoration:underline;}<br>
a:visited,&nbsp;span.MsoHyperlinkFollowed<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-priority:99;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:purple;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsptext-decoration:underline;}<br>
p.MsoAcetate,&nbsp;li.MsoAcetate,&nbsp;div.MsoAcetate<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-priority:99;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-style-link:&quot;Balloon&nbsp;Text&nbsp;Char&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin:0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin-bottom:.0001pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-size:8.0pt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;;}<br>
span.EmailStyle17<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-type:personal-compose;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspcolor:windowtext;}<br>
span.BalloonTextChar<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-name:&quot;Balloon&nbsp;Text&nbsp;Char&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-style-priority:99;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmso-style-link:&quot;Balloon&nbsp;Text&quot;;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspfont-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;;}<br>
.MsoChpDefault<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{mso-style-type:export-only;}<br>
@page&nbsp;WordSection1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{size:8.5in&nbsp;11.0in;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbspmargin:1.0in&nbsp;1.0in&nbsp;1.0in&nbsp;1.0in;}<br>
div.WordSection1<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp{page:WordSection1;}<br>
--&gt;&lt;/style&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapedefaults&nbsp;v:ext=&quot;edit&quot;&nbsp;spidmax=&quot;2050&quot;&nbsp;/&gt;<br>
&lt;/xml&gt;&lt;![endif]--&gt;&lt;!--[if&nbsp;gte&nbsp;mso&nbsp;9]&gt;&lt;xml&gt;<br>
&lt;o:shapelayout&nbsp;v:ext=&quot;edit&quot;&gt;<br>
&lt;o:idmap&nbsp;v:ext=&quot;edit&quot;&nbsp;data=&quot;1&quot;&nbsp;/&gt;<br>
&lt;/o:shapelayout&gt;&lt;/xml&gt;&lt;![endif]--&gt;&lt;/head&gt;&lt;body&nbsp;lang=EN-US&nbsp;link=blue&nbsp;vlink=purple&gt;&lt;div&nbsp;class=WordSection1&gt;&lt;p&nbsp;class=MsoNormal&gt;I&nbsp;am&nbsp;having&nbsp;modsecurity&nbsp;&amp;nbsp;running&nbsp;in&nbsp;a&nbsp;traditional&nbsp;mode&nbsp;but&nbsp;it&amp;#8217;s&nbsp;not&nbsp;blocking&nbsp;attacks.&nbsp;Attached&nbsp;is&nbsp;the&nbsp;transaction&nbsp;log.&nbsp;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;Here&nbsp;is&nbsp;my&nbsp;configuration&nbsp;file.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Core&nbsp;ModSecurity&nbsp;Rule&nbsp;Set&nbsp;ver.2.1.1&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Copyright&nbsp;(C)&nbsp;2006-2011&nbsp;Trustwave&nbsp;All&nbsp;rights&nbsp;reserved.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;The&nbsp;OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;is&nbsp;distributed&nbsp;under&nbsp;GPL&nbsp;version&nbsp;2&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Please&nbsp;see&nbsp;the&nbsp;enclosed&nbsp;LICENCE&nbsp;file&nbsp;for&nbsp;full&nbsp;details.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;---------------------------------------------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;##&nbsp;--&nbsp;Configuration&nbsp;----------------------------------------------------------&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Specify&nbsp;CRS&nbsp;version&nbsp;in&nbsp;the&nbsp;audit&nbsp;logs.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecComponentSignature&nbsp;&amp;quot;core&nbsp;ruleset/2.1.1&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Review&nbsp;your&nbsp;SecRuleEngine&nbsp;settings.&amp;nbsp;&nbsp;If&nbsp;you&nbsp;want&nbsp;to&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;allow&nbsp;blocking,&nbsp;then&nbsp;set&nbsp;it&nbsp;to&nbsp;On&nbsp;however&nbsp;check&nbsp;your&nbsp;SecDefaultAction&nbsp;setting&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;to&nbsp;ensure&nbsp;that&nbsp;it&nbsp;is&nbsp;set&nbsp;appropriately.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecRuleEngine&nbsp;DetectionOnly&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecRuleEngine&nbsp;On&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Mode&nbsp;of&nbsp;Operation&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;You&nbsp;can&nbsp;now&nbsp;choose&nbsp;how&nbsp;you&nbsp;want&nbsp;to&nbsp;run&nbsp;the&nbsp;modsecurity&nbsp;rules&nbsp;-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Anomaly&nbsp;Scoring&nbsp;vs.&nbsp;Traditional&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Each&nbsp;detection&nbsp;rule&nbsp;uses&nbsp;the&nbsp;&amp;quot;block&amp;quot;&nbsp;action&nbsp;which&nbsp;will&nbsp;inherit&nbsp;the&nbsp;SecDefaultAction&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;specified&nbsp;below.&amp;nbsp;&nbsp;Your&nbsp;settings&nbsp;here&nbsp;will&nbsp;determine&nbsp;which&nbsp;mode&nbsp;of&nbsp;operation&nbsp;you&nbsp;use.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Traditional&nbsp;mode&nbsp;is&nbsp;the&nbsp;current&nbsp;default&nbsp;setting&nbsp;and&nbsp;it&nbsp;uses&nbsp;&amp;quot;deny&amp;quot;&nbsp;(you&nbsp;can&nbsp;set&nbsp;any&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;disruptive&nbsp;action&nbsp;you&nbsp;wish)&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;If&nbsp;you&nbsp;want&nbsp;to&nbsp;run&nbsp;the&nbsp;rules&nbsp;in&nbsp;Anomaly&nbsp;Scoring&nbsp;mode&nbsp;(where&nbsp;blocking&nbsp;is&nbsp;delayed&nbsp;until&nbsp;the&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;end&nbsp;of&nbsp;the&nbsp;request&nbsp;phase&nbsp;and&nbsp;rules&nbsp;contribute&nbsp;to&nbsp;an&nbsp;anomaly&nbsp;score)&nbsp;then&nbsp;set&nbsp;the&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;SecDefaultAction&nbsp;to&nbsp;&amp;quot;pass&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;You&nbsp;can&nbsp;also&nbsp;decide&nbsp;how&nbsp;you&nbsp;want&nbsp;to&nbsp;handle&nbsp;logging&nbsp;actions.&amp;nbsp;&nbsp;You&nbsp;have&nbsp;three&nbsp;options&nbsp;-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;To&nbsp;log&nbsp;to&nbsp;both&nbsp;the&nbsp;Apache&nbsp;error_log&nbsp;and&nbsp;ModSecurity&nbsp;audit_log&nbsp;file&nbsp;use&nbsp;-&nbsp;log&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;To&nbsp;log&nbsp;*only*&nbsp;to&nbsp;the&nbsp;ModSecurity&nbsp;audit_log&nbsp;file&nbsp;use&nbsp;-&nbsp;nolog,auditlog&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;To&nbsp;log&nbsp;*only*&nbsp;to&nbsp;the&nbsp;Apache&nbsp;error_log&nbsp;file&nbsp;use&nbsp;-&nbsp;log,noauditlog&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecDefaultAction&nbsp;&amp;quot;phase:2,deny,log&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Anomaly&nbsp;Scoring&nbsp;Block&nbsp;Mode&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;This&nbsp;is&nbsp;a&nbsp;collaborative&nbsp;detection&nbsp;mode&nbsp;where&nbsp;each&nbsp;rule&nbsp;will&nbsp;increment&nbsp;an&nbsp;overall&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;anomaly&nbsp;score&nbsp;the&nbsp;transaction.&nbsp;The&nbsp;scores&nbsp;are&nbsp;then&nbsp;evaluated&nbsp;in&nbsp;the&nbsp;following&nbsp;files:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Inbound&nbsp;anomaly&nbsp;score&nbsp;-&nbsp;checked&nbsp;in&nbsp;the&nbsp;modsecurity_crs_49_inbound_blocking.conf&nbsp;file&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Outbound&nbsp;anomaly&nbsp;score&nbsp;-&nbsp;checked&nbsp;in&nbsp;the&nbsp;modsecurity_crs_59_outbound_blocking.conf&nbsp;file&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;If&nbsp;you&nbsp;do&nbsp;not&nbsp;want&nbsp;to&nbsp;use&nbsp;anomaly&nbsp;scoring&nbsp;mode,&nbsp;then&nbsp;comment&nbsp;out&nbsp;this&nbsp;line.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.anomaly_score_blocking=on&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Anomaly&nbsp;Scoring&nbsp;Severity&nbsp;Levels&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;These&nbsp;are&nbsp;the&nbsp;default&nbsp;scoring&nbsp;points&nbsp;for&nbsp;each&nbsp;severity&nbsp;level.&amp;nbsp;&nbsp;You&nbsp;may&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;adjust&nbsp;these&nbsp;to&nbsp;you&nbsp;liking.&amp;nbsp;&nbsp;These&nbsp;settings&nbsp;will&nbsp;be&nbsp;used&nbsp;in&nbsp;macro&nbsp;expansion&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;in&nbsp;the&nbsp;rules&nbsp;to&nbsp;increment&nbsp;the&nbsp;anomaly&nbsp;scores&nbsp;when&nbsp;rules&nbsp;match.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;These&nbsp;are&nbsp;the&nbsp;default&nbsp;Severity&nbsp;ratings&nbsp;(with&nbsp;anomaly&nbsp;scores)&nbsp;of&nbsp;the&nbsp;individual&nbsp;rules&nbsp;-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;2:&nbsp;Critical&nbsp;-&nbsp;Anomaly&nbsp;Score&nbsp;of&nbsp;5.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Is&nbsp;the&nbsp;highest&nbsp;severity&nbsp;level&nbsp;possible&nbsp;without&nbsp;correlation.&amp;nbsp;&nbsp;It&nbsp;is&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;normally&nbsp;generated&nbsp;by&nbsp;the&nbsp;web&nbsp;attack&nbsp;rules&nbsp;(40&nbsp;level&nbsp;files).&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;3:&nbsp;Error&nbsp;-&nbsp;Anomaly&nbsp;Score&nbsp;of&nbsp;4.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Is&nbsp;generated&nbsp;mostly&nbsp;from&nbsp;outbound&nbsp;leakage&nbsp;rules&nbsp;(50&nbsp;level&nbsp;files).&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;4:&nbsp;Warning&nbsp;-&nbsp;Anomaly&nbsp;Score&nbsp;of&nbsp;3.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Is&nbsp;generated&nbsp;by&nbsp;malicious&nbsp;client&nbsp;rules&nbsp;(35&nbsp;level&nbsp;files).&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;-&nbsp;5:&nbsp;Notice&nbsp;-&nbsp;Anomaly&nbsp;Score&nbsp;of&nbsp;2.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&nbsp;Is&nbsp;generated&nbsp;by&nbsp;the&nbsp;Protocol&nbsp;policy&nbsp;and&nbsp;anomaly&nbsp;files.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:tx.critical_anomaly_score=5,&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:tx.error_anomaly_score=4,&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:tx.warning_anomaly_score=3,&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:tx.notice_anomaly_score=2&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Anomaly&nbsp;Scoring&nbsp;Threshold&nbsp;Levels&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;These&nbsp;variables&nbsp;are&nbsp;used&nbsp;in&nbsp;macro&nbsp;expansion&nbsp;in&nbsp;the&nbsp;49&nbsp;inbound&nbsp;blocking&nbsp;and&nbsp;59&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;outbound&nbsp;blocking&nbsp;files.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;**MUST&nbsp;HAVE**&nbsp;ModSecurity&nbsp;v2.5.12&nbsp;or&nbsp;higher&nbsp;to&nbsp;use&nbsp;macro&nbsp;expansion&nbsp;in&nbsp;numeric&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;operators.&amp;nbsp;&nbsp;If&nbsp;you&nbsp;have&nbsp;an&nbsp;earlier&nbsp;version,&nbsp;edit&nbsp;the&nbsp;49/59&nbsp;files&nbsp;directly&nbsp;to&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;set&nbsp;the&nbsp;appropriate&nbsp;anomaly&nbsp;score&nbsp;levels.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;You&nbsp;should&nbsp;set&nbsp;the&nbsp;score&nbsp;to&nbsp;the&nbsp;proper&nbsp;threshold&nbsp;you&nbsp;would&nbsp;prefer.&nbsp;If&nbsp;set&nbsp;to&nbsp;&amp;quot;5&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;it&nbsp;will&nbsp;work&nbsp;similarly&nbsp;to&nbsp;previous&nbsp;Mod&nbsp;CRS&nbsp;rules&nbsp;and&nbsp;will&nbsp;create&nbsp;an&nbsp;event&nbsp;in&nbsp;the&nbsp;error_log&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;file&nbsp;if&nbsp;there&nbsp;are&nbsp;any&nbsp;rules&nbsp;that&nbsp;match.&amp;nbsp;&nbsp;If&nbsp;you&nbsp;would&nbsp;like&nbsp;to&nbsp;lessen&nbsp;the&nbsp;number&nbsp;of&nbsp;events&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;generated&nbsp;in&nbsp;the&nbsp;error_log&nbsp;file,&nbsp;you&nbsp;should&nbsp;increase&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;threshold&nbsp;to&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;something&nbsp;like&nbsp;&amp;quot;20&amp;quot;.&amp;nbsp;&nbsp;This&nbsp;would&nbsp;only&nbsp;generate&nbsp;an&nbsp;event&nbsp;in&nbsp;the&nbsp;error_log&nbsp;file&nbsp;if&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;there&nbsp;are&nbsp;multiple&nbsp;lower&nbsp;severity&nbsp;rule&nbsp;matches&nbsp;or&nbsp;if&nbsp;any&nbsp;1&nbsp;higher&nbsp;severity&nbsp;item&nbsp;matches.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_level=5&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_level=4&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Paranoid&nbsp;Mode&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;There&nbsp;are&nbsp;many&nbsp;different&nbsp;transactional&nbsp;variables&nbsp;that&nbsp;can&nbsp;be&nbsp;inspected&nbsp;for&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;attacks.&amp;nbsp;&nbsp;Some&nbsp;variables,&nbsp;such&nbsp;as&nbsp;ARGS,&nbsp;has&nbsp;the&nbsp;best&nbsp;false&nbsp;negative/false&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;positive&nbsp;ratio&nbsp;where&nbsp;it&nbsp;will&nbsp;catch&nbsp;the&nbsp;vast&nbsp;majority&nbsp;of&nbsp;attack&nbsp;payloads&nbsp;and&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;not&nbsp;have&nbsp;a&nbsp;high&nbsp;false&nbsp;positive&nbsp;rate.&amp;nbsp;&nbsp;This&nbsp;is&nbsp;also&nbsp;true&nbsp;for&nbsp;some&nbsp;security&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;checks&nbsp;such&nbsp;as&nbsp;@validateByteRange&nbsp;checks&nbsp;where&nbsp;we&nbsp;are&nbsp;initially&nbsp;only&nbsp;inspecting&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;for&nbsp;Nul&nbsp;Bytes.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;There&nbsp;are,&nbsp;however,&nbsp;some&nbsp;possibilities&nbsp;for&nbsp;false&nbsp;negative&nbsp;issues&nbsp;with&nbsp;inspecting&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;parsed&nbsp;data&nbsp;and&nbsp;this&nbsp;could&nbsp;lead&nbsp;to&nbsp;missed&nbsp;attacks.&amp;nbsp;&nbsp;If&nbsp;you&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;want&nbsp;to&nbsp;lessen&nbsp;the&nbsp;chances&nbsp;for&nbsp;false&nbsp;negatives,&nbsp;then&nbsp;you&nbsp;should&nbsp;enable&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;&amp;quot;Paranoid&nbsp;Mode&amp;quot;&nbsp;processing&nbsp;by&nbsp;setting&nbsp;the&nbsp;following&nbsp;line&nbsp;to&nbsp;1.&amp;nbsp;&nbsp;This&nbsp;will&nbsp;process&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;additional&nbsp;rules&nbsp;that&nbsp;are&nbsp;inspecting&nbsp;variables&nbsp;with&nbsp;a&nbsp;higher&nbsp;false&nbsp;positive&nbsp;rate.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.paranoid_mode=0&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;HTTP&nbsp;Policy&nbsp;Settings&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Set&nbsp;the&nbsp;following&nbsp;policy&nbsp;settings&nbsp;here&nbsp;and&nbsp;they&nbsp;will&nbsp;be&nbsp;propagated&nbsp;to&nbsp;the&nbsp;23&nbsp;rules&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;file&nbsp;(modsecurity_common_23_request_limits.conf)&nbsp;by&nbsp;using&nbsp;macro&nbsp;expansion.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;If&nbsp;you&nbsp;run&nbsp;into&nbsp;false&nbsp;positives,&nbsp;you&nbsp;can&nbsp;adjust&nbsp;the&nbsp;settings&nbsp;here.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Only&nbsp;the&nbsp;max&nbsp;number&nbsp;of&nbsp;args&nbsp;is&nbsp;uncommented&nbsp;by&nbsp;default&nbsp;as&nbsp;there&nbsp;are&nbsp;a&nbsp;high&nbsp;rate&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;of&nbsp;false&nbsp;positives.&amp;nbsp;&nbsp;Uncomment&nbsp;the&nbsp;items&nbsp;you&nbsp;wish&nbsp;to&nbsp;set.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;##&nbsp;Maximum&nbsp;number&nbsp;of&nbsp;arguments&nbsp;in&nbsp;request&nbsp;limited&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.max_num_args=255&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;##&nbsp;Limit&nbsp;argument&nbsp;name&nbsp;length&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.arg_name_length=100&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;##&nbsp;Limit&nbsp;value&nbsp;name&nbsp;length&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.arg_length=400&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;##&nbsp;Limit&nbsp;arguments&nbsp;total&nbsp;length&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.total_arg_length=64000&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;##&nbsp;Individual&nbsp;file&nbsp;size&nbsp;is&nbsp;limited&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.max_file_size=1048576&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;##&nbsp;Combined&nbsp;file&nbsp;size&nbsp;is&nbsp;limited&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.combined_file_sizes=1048576&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;HTTP&nbsp;Policy&nbsp;Settings&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Set&nbsp;the&nbsp;following&nbsp;policy&nbsp;settings&nbsp;here&nbsp;and&nbsp;they&nbsp;will&nbsp;be&nbsp;propagated&nbsp;to&nbsp;the&nbsp;30&nbsp;rules&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;file&nbsp;(modsecurity_crs_30_http_policy.conf)&nbsp;by&nbsp;using&nbsp;macro&nbsp;expansion.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;If&nbsp;you&nbsp;run&nbsp;into&nbsp;false&nbsp;positves,&nbsp;you&nbsp;can&nbsp;adjust&nbsp;the&nbsp;settings&nbsp;here.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:'tx.allowed_methods=GET&nbsp;HEAD&nbsp;POST&nbsp;OPTIONS',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded&nbsp;multipart/form-data&nbsp;text/xml&nbsp;application/xml&nbsp;applic&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;ation/x-amf',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:'tx.allowed_http_versions=HTTP/0.9&nbsp;HTTP/1.0&nbsp;HTTP/1.1',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:'tx.restricted_extensions=.asa/&nbsp;.asax/&nbsp;.ascx/&nbsp;.axd/&nbsp;.backup/&nbsp;.bak/&nbsp;.bat/&nbsp;.cdx/&nbsp;.cer/&nbsp;.cfg/&nbsp;.cmd/&nbsp;.com/&nbsp;.config/&nbsp;.conf/&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&nbsp;.cs/&nbsp;.csproj/&nbsp;.csr/&nbsp;.dat/&nbsp;.db/&nbsp;.dbf/&nbsp;.dll/&nbsp;.dos/&nbsp;.htr/&nbsp;.htw/&nbsp;.ida/&nbsp;.idc/&nbsp;.idq/&nbsp;.inc/&nbsp;.ini/&nbsp;.key/&nbsp;.licx/&nbsp;.lnk/&nbsp;.log/&nbsp;.mdb/&nbsp;.o&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;ld/&nbsp;.pass/&nbsp;.pdb/&nbsp;.pol/&nbsp;.printer/&nbsp;.pwd/&nbsp;.resources/&nbsp;.resx/&nbsp;.sql/&nbsp;.sys/&nbsp;.vb/&nbsp;.vbs/&nbsp;.vbproj/&nbsp;.vsdisco/&nbsp;.webinfo/&nbsp;.xsd/&nbsp;.xsx/',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;setvar:'tx.restricted_headers=/Proxy-Connection/&nbsp;/Lock-Token/&nbsp;/Content-Range/&nbsp;/Translate/&nbsp;/via/&nbsp;/if/'&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Brute&nbsp;Force&nbsp;Protection&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;If&nbsp;you&nbsp;are&nbsp;using&nbsp;the&nbsp;Brute&nbsp;Force&nbsp;Protection&nbsp;rule&nbsp;set,&nbsp;then&nbsp;uncomment&nbsp;the&nbsp;following&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;lines&nbsp;and&nbsp;set&nbsp;the&nbsp;following&nbsp;variables:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-&nbsp;Protected&nbsp;URLs:&nbsp;resources&nbsp;to&nbsp;protect&nbsp;(e.g.&nbsp;login&nbsp;pages)&nbsp;-&nbsp;set&nbsp;to&nbsp;your&nbsp;login&nbsp;page&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-&nbsp;Burst&nbsp;Time&nbsp;Slice&nbsp;Interval:&nbsp;time&nbsp;interval&nbsp;window&nbsp;to&nbsp;monitor&nbsp;for&nbsp;bursts&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-&nbsp;Request&nbsp;Threshold:&nbsp;request&nbsp;#&nbsp;threshold&nbsp;to&nbsp;trigger&nbsp;a&nbsp;burst&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-&nbsp;Block&nbsp;Period:&nbsp;temporary&nbsp;block&nbsp;timeout&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#setvar:'tx.brute_force_protected_urls=/login.jsp&nbsp;/partner_login.php',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#setvar:'tx.brute_force_burst_time_slice=60',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#setvar:'tx.brute_force_counter_threshold=10',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#setvar:'tx.brute_force_block_timeout=300'&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;DoS&nbsp;Protection&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;If&nbsp;you&nbsp;are&nbsp;using&nbsp;the&nbsp;DoS&nbsp;Protection&nbsp;rule&nbsp;set,&nbsp;then&nbsp;uncomment&nbsp;the&nbsp;following&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;lines&nbsp;and&nbsp;set&nbsp;the&nbsp;following&nbsp;variables:&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-&nbsp;Burst&nbsp;Time&nbsp;Slice&nbsp;Interval:&nbsp;time&nbsp;interval&nbsp;window&nbsp;to&nbsp;monitor&nbsp;for&nbsp;bursts&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-&nbsp;Request&nbsp;Threshold:&nbsp;request&nbsp;#&nbsp;threshold&nbsp;to&nbsp;trigger&nbsp;a&nbsp;burst&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-&nbsp;Block&nbsp;Period:&nbsp;temporary&nbsp;block&nbsp;timeout&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#setvar:'tx.dos_burst_time_slice=60',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#setvar:'tx.dos_counter_threshold=100',&nbsp;\&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#setvar:'tx.dos_block_timeout=600'&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Check&nbsp;UTF&nbsp;enconding&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;We&nbsp;only&nbsp;want&nbsp;to&nbsp;apply&nbsp;this&nbsp;check&nbsp;if&nbsp;UTF-8&nbsp;encoding&nbsp;is&nbsp;actually&nbsp;used&nbsp;by&nbsp;the&nbsp;site,&nbsp;otherwise&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;it&nbsp;will&nbsp;result&nbsp;in&nbsp;false&nbsp;positives.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Uncomment&nbsp;this&nbsp;line&nbsp;if&nbsp;your&nbsp;site&nbsp;uses&nbsp;UTF8&nbsp;encoding&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#SecAction&nbsp;&amp;quot;phase:1,t:none,nolog,pass,setvar:tx.crs_validate_utf8_encoding=1&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;-=[&nbsp;Global&nbsp;and&nbsp;IP&nbsp;Collections&nbsp;]=-&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;Create&nbsp;both&nbsp;Global&nbsp;and&nbsp;IP&nbsp;collections&nbsp;for&nbsp;rules&nbsp;to&nbsp;use&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;There&nbsp;are&nbsp;some&nbsp;CRS&nbsp;rules&nbsp;that&nbsp;assume&nbsp;that&nbsp;these&nbsp;two&nbsp;collections&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&nbsp;have&nbsp;already&nbsp;been&nbsp;initiated.&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;#&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&amp;quot;^(.*)$&amp;quot;&nbsp;&amp;quot;phase:1,t:none,pass,nolog,t:sha1,t:hexEncode,setvar:tx.ua_hash=%{matched_var}&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;SecAction&nbsp;&amp;quot;phase:1,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remote_addr}_%{tx.ua_hash}&amp;quot;&lt;o:p&gt;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;b&gt;&lt;span&nbsp;style='font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:black'&gt;&lt;img&nbsp;width=109&nbsp;height=32&nbsp;id=&quot;Picture_x0020_1&quot;&nbsp;src=&quot;cid:image001.jpg@01CBC859.10ED1AD0&quot;&nbsp;alt=&quot;cid:image001.jpg@01CAE6AE.875FA210&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/b&gt;&lt;b&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:black'&gt;Abdellah&nbsp;Tantan&lt;br&gt;&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:black'&gt;Systems&nbsp;Engineer&nbsp;/&nbsp;Application&nbsp;Developer&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt'&gt;&lt;img&nbsp;width=9&nbsp;height=11&nbsp;id=&quot;Picture_x0020_2&quot;&nbsp;src=&quot;cid:image002.jpg@01CBC859.10ED1AD0&quot;&nbsp;alt=&quot;cid:image002.jpg@01CAE6AE.875FA210&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:black'&gt;&amp;nbsp;&nbsp;phone:&nbsp;712.388.2132&nbsp;ext.&nbsp;1001&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt'&gt;&lt;img&nbsp;width=9&nbsp;height=11&nbsp;id=&quot;Picture_x0020_3&quot;&nbsp;src=&quot;cid:image002.jpg@01CBC859.10ED1AD0&quot;&nbsp;alt=&quot;cid:image002.jpg@01CAE6AE.875FA210&quot;&gt;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:black'&gt;&amp;nbsp;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#006600'&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:green'&gt;&lt;a&nbsp;href=&quot;mailto:adtantan@paydq.com&quot;&gt;&lt;span&nbsp;style='color:green'&gt;adtantan@paydq.com&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#006600'&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:black'&gt;25&nbsp;Main&nbsp;Place,&nbsp;Suite&nbsp;400&nbsp;Council&nbsp;Bluffs,&nbsp;IA&nbsp;51503-0790&nbsp;&lt;/span&gt;&lt;span&nbsp;style='font-size:8.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;color:#058451'&gt;&lt;a&nbsp;href=&quot;http://www.paydq.com/&quot;&nbsp;title=&quot;blocked::http://www.paydq.com/&quot;&gt;&lt;span&nbsp;style='color:#058451'&gt;&lt;br&gt;&lt;/span&gt;&lt;span&nbsp;style='color:#058451'&gt;www&lt;/span&gt;&lt;span&nbsp;style='color:green'&gt;.paydq.co&lt;/span&gt;&lt;span&nbsp;style='color:#058451'&gt;m&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;span&nbsp;style='font-size:12.0pt;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;'&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;p&nbsp;class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
