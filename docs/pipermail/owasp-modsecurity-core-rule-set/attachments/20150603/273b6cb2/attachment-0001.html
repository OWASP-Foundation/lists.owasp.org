<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=windows-1252&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Le&nbsp;03/06/2015&nbsp;16:22,&nbsp;Charles&nbsp;Farinella<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;écrit :&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote<br>
cite=&quot;mid:CAAyjSBQdchMa0OmHA_-Wtf2Braye=vLo=tBYps7Mx-sdnRJUCA@mail.gmail.com&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;Thanks&nbsp;for&nbsp;the&nbsp;suggestions,&nbsp;but&nbsp;I&nbsp;don't&nbsp;think<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;either&nbsp;of&nbsp;these&nbsp;will&nbsp;solve&nbsp;our&nbsp;problem<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;permanently.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;'nolog'&nbsp;option&nbsp;is&nbsp;rule&nbsp;or&nbsp;status&nbsp;code&nbsp;dependent<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;we&nbsp;want&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;*no*&nbsp;request&nbsp;bodies<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;are&nbsp;ever&nbsp;printed&nbsp;to&nbsp;the&nbsp;Nginx&nbsp;log.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;'SecAuditLogParts'&nbsp;option&nbsp;seems&nbsp;to&nbsp;only&nbsp;affect<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;what&nbsp;gets&nbsp;sent&nbsp;to&nbsp;the&nbsp;audit&nbsp;logs,&nbsp;we've&nbsp;tried&nbsp;this. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mod_security&nbsp;docs&nbsp;say&nbsp;that&nbsp;&quot;Messages&nbsp;at&nbsp;levels&nbsp;1-3&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*always*&nbsp;copied&nbsp;to&nbsp;the&nbsp;Apache&nbsp;error&nbsp;log.&quot;  &nbsp;We&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assuming&nbsp;that&nbsp;this&nbsp;applies&nbsp;equally&nbsp;to&nbsp;Nginx&nbsp;logs,&nbsp;and<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;is&nbsp;what&nbsp;we&nbsp;need&nbsp;to&nbsp;address.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;have&nbsp;clients&nbsp;sending&nbsp;credit&nbsp;card&nbsp;numbers&nbsp;in&nbsp;request<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bodies&nbsp;and&nbsp;they&nbsp;are&nbsp;triggering&nbsp;mod_security&nbsp;SQL<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;injection&nbsp;rules&nbsp;which&nbsp;then&nbsp;write&nbsp;these&nbsp;bodies&nbsp;to&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nginx&nbsp;logs&nbsp;exposing&nbsp;the&nbsp;CC&nbsp;number.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;know&nbsp;that&nbsp;we&nbsp;can&nbsp;disable&nbsp;these&nbsp;specific&nbsp;rules,&nbsp;but&nbsp;are<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;afraid&nbsp;that&nbsp;at&nbsp;some&nbsp;future&nbsp;time,&nbsp;or&nbsp;after&nbsp;an&nbsp;upgrade,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;these&nbsp;or&nbsp;some&nbsp;other&nbsp;rules&nbsp;will&nbsp;be&nbsp;triggered&nbsp;again&nbsp;exposing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sensitive&nbsp;information.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Does&nbsp;OWASP&nbsp;have&nbsp;a&nbsp;&quot;best&nbsp;practices&quot;&nbsp;procedure&nbsp;for&nbsp;protecting<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this&nbsp;kind&nbsp;of&nbsp;data&nbsp;in&nbsp;a&nbsp;PCI&nbsp;environment?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;How&nbsp;can&nbsp;we&nbsp;prevent&nbsp;*all*&nbsp;level&nbsp;1-3&nbsp;messages&nbsp;from&nbsp;being<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sent&nbsp;to&nbsp;the&nbsp;Nginx&nbsp;log?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Thanks&nbsp;again&nbsp;for&nbsp;your&nbsp;help.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--charlie&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Hello&nbsp;Charlie,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;had&nbsp;the&nbsp;exact&nbsp;same&nbsp;issue&nbsp;at&nbsp;my&nbsp;workplace,&nbsp;and&nbsp;I&nbsp;found&nbsp;a&nbsp;semi<br>
&nbsp;&nbsp;&nbsp;&nbsp;solution&nbsp;only&nbsp;:&nbsp;disable&nbsp;logging&nbsp;of&nbsp;rules,&nbsp;and&nbsp;add&nbsp;a&nbsp;new&nbsp;rule&nbsp;to&nbsp;log<br>
&nbsp;&nbsp;&nbsp;&nbsp;only&nbsp;final&nbsp;result&nbsp;of&nbsp;anomaly&nbsp;score&nbsp;with&nbsp;last&nbsp;matched&nbsp;rule&nbsp;ID&nbsp;(see<br>
&nbsp;&nbsp;&nbsp;&nbsp;attached&nbsp;15-custom-config.conf).&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Now&nbsp;remains&nbsp;the&nbsp;audit&nbsp;rules&nbsp;adding&nbsp;specifically&nbsp;audit&nbsp;flags&nbsp;we&nbsp;don't<br>
&nbsp;&nbsp;&nbsp;&nbsp;want,&nbsp;so&nbsp;I&nbsp;made&nbsp;a&nbsp;script&nbsp;and&nbsp;run&nbsp;it&nbsp;against&nbsp;my&nbsp;rules&nbsp;directory&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;generate&nbsp;an&nbsp;additionnal&nbsp;rule&nbsp;file&nbsp;included&nbsp;AT&nbsp;THE&nbsp;END&nbsp;(99-xxx).&nbsp;It<br>
&nbsp;&nbsp;&nbsp;&nbsp;generates&nbsp;something&nbsp;like&nbsp;that&nbsp;(script&nbsp;is&nbsp;attached):&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&gt;SecRuleUpdateActionById&nbsp;950120<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ctl:auditLogParts=-E,chain&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[...]&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRuleUpdateActionById&nbsp;973337&nbsp;nolog&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[...]&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRuleUpdateActionById&nbsp;981205&nbsp;&quot;logdata:'Matched&nbsp;rules:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{tx.counter};&nbsp;Rule&nbsp;list:&nbsp;%{matched_rule-1}&nbsp;%{matched_rule-2}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{matched_rule-3}&nbsp;%{matched_rule-4}&nbsp;%{matched_rule-5}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{matched_rule-6}&nbsp;%{matched_rule-7}&nbsp;%{matched_rule-8}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{matched_rule-9}&nbsp;%{matched_rule-10}&nbsp;%{matched_rule-11}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{matched_rule-12}&nbsp;%{matched_rule-13}&nbsp;%{matched_rule-14}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{matched_rule-15}&nbsp;%{matched_rule-16}&nbsp;%{matched_rule-17}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{matched_rule-18}&nbsp;%{matched_rule-19}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;%{matched_rule-20}',log,auditlog&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;some&nbsp;rules,&nbsp;the&nbsp;keyword&nbsp;&quot;chain&quot;&nbsp;is&nbsp;specified.&nbsp;In&nbsp;fact&nbsp;current<br>
&nbsp;&nbsp;&nbsp;&nbsp;modsecurity&nbsp;needs&nbsp;us&nbsp;to&nbsp;specify&nbsp;again&nbsp;this&nbsp;keyword&nbsp;when&nbsp;we&nbsp;update&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;chained&nbsp;action.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;last&nbsp;parts&nbsp;here&nbsp;are&nbsp;an&nbsp;attempt&nbsp;to&nbsp;fetch&nbsp;the&nbsp;rule&nbsp;IDs&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;matched&nbsp;since&nbsp;they&nbsp;don't&nbsp;get&nbsp;logged.&nbsp;Although&nbsp;it&nbsp;doesn't&nbsp;work,&nbsp;but<br>
&nbsp;&nbsp;&nbsp;&nbsp;keep&nbsp;it&nbsp;so&nbsp;it&nbsp;replaces&nbsp;the&nbsp;logdata&nbsp;of&nbsp;these&nbsp;rules,&nbsp;which&nbsp;can&nbsp;contain<br>
&nbsp;&nbsp;&nbsp;&nbsp;sensitive&nbsp;information.&nbsp;It&nbsp;was&nbsp;coupled&nbsp;with&nbsp;a&nbsp;rule&nbsp;included&nbsp;before<br>
&nbsp;&nbsp;&nbsp;&nbsp;all&nbsp;(20-track-ids.conf)&nbsp;containing&nbsp;only&nbsp;this&nbsp;(currently&nbsp;disabled)&nbsp;:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;#SecRule&nbsp;TX:/^\d/&nbsp;&quot;.&quot;<br>
&quot;phase:2,id:'45',t:none,nolog,noauditlog,pass,setvar:tx.counter=+1,setvar:tx.matched_rule-%{tx.counter}=%{matched_var_name}&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I'm&nbsp;interested&nbsp;by&nbsp;feedback&nbsp;if&nbsp;you&nbsp;manage&nbsp;to&nbsp;log&nbsp;a&nbsp;list&nbsp;of&nbsp;matched<br>
&nbsp;&nbsp;&nbsp;&nbsp;rule&nbsp;ids&nbsp;!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;we&nbsp;don't&nbsp;get&nbsp;that&nbsp;much&nbsp;information&nbsp;of&nbsp;matched&nbsp;rules,&nbsp;except<br>
&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;the&nbsp;request&nbsp;get&nbsp;blocked,&nbsp;I&nbsp;added&nbsp;some&nbsp;rules&nbsp;which&nbsp;kinda&nbsp;copies<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;blocking&nbsp;rule&nbsp;(without&nbsp;the&nbsp;block&nbsp;part&nbsp;of&nbsp;course)&nbsp;from<br>
&nbsp;&nbsp;&nbsp;&nbsp;base_rules/modsecurity_crs_49_inbound_blocking.conf&nbsp;when&nbsp;the&nbsp;anomaly<br>
&nbsp;&nbsp;&nbsp;&nbsp;score&nbsp;is&nbsp;not&nbsp;exceeded.&nbsp;See&nbsp;attached&nbsp;99-log-low-anomalies.conf.&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;you&nbsp;can&nbsp;see&nbsp;in&nbsp;the&nbsp;99-&nbsp;file,&nbsp;I&nbsp;also&nbsp;had&nbsp;to&nbsp;alter&nbsp;the&nbsp;last&nbsp;matched<br>
&nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;variable&nbsp;when&nbsp;SecRule&nbsp;was&nbsp;matching&nbsp;a&nbsp;parameter&nbsp;containing<br>
&nbsp;&nbsp;&nbsp;&nbsp;sensitive&nbsp;data.&nbsp;We&nbsp;use&nbsp;JSON&nbsp;parsing&nbsp;so&nbsp;we&nbsp;can&nbsp;use&nbsp;that,&nbsp;but&nbsp;XML<br>
&nbsp;&nbsp;&nbsp;&nbsp;parsing&nbsp;does&nbsp;not&nbsp;provide&nbsp;parameter&nbsp;name,&nbsp;so&nbsp;I&nbsp;hope&nbsp;you're&nbsp;in&nbsp;REST<br>
&nbsp;&nbsp;&nbsp;&nbsp;API&nbsp;and&nbsp;not&nbsp;SOAP.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;result&nbsp;is&nbsp;:&nbsp;we&nbsp;always&nbsp;get&nbsp;a&nbsp;summary&nbsp;of&nbsp;what&nbsp;happened&nbsp;when&nbsp;score<br>
&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;not&nbsp;0,&nbsp;with&nbsp;the&nbsp;ID&nbsp;of&nbsp;last&nbsp;matched&nbsp;rule,&nbsp;but&nbsp;not&nbsp;all&nbsp;the&nbsp;IDs.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Maybe&nbsp;modsecurity&nbsp;/&nbsp;OWASP&nbsp;team&nbsp;could&nbsp;make&nbsp;a&nbsp;PCI&nbsp;compliant&nbsp;version&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;rules&nbsp;/&nbsp;software,&nbsp;because&nbsp;it&nbsp;is&nbsp;indeed&nbsp;hard&nbsp;to&nbsp;work&nbsp;with&nbsp;as&nbsp;it<br>
&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;when&nbsp;you&nbsp;need&nbsp;to&nbsp;avoid&nbsp;sensitive&nbsp;data&nbsp;being&nbsp;logged.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;hope&nbsp;I&nbsp;didn't&nbsp;forget&nbsp;anything,&nbsp;and&nbsp;it&nbsp;helps&nbsp;you&nbsp;on&nbsp;your<br>
&nbsp;&nbsp;&nbsp;&nbsp;modsecurity&nbsp;journey&nbsp;^^&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;--&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Loïc&nbsp;Gomez&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
