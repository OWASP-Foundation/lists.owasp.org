<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;The&nbsp;rules&nbsp;work&nbsp;the&nbsp;same&nbsp;whether&nbsp;the&nbsp;port&nbsp;is&nbsp;80&nbsp;or&nbsp;443.&nbsp;&nbsp;There&nbsp;must&nbsp;be&nbsp;something&nbsp;else&nbsp;going.&nbsp;&nbsp;I&nbsp;see&nbsp;you&nbsp;are&nbsp;using&nbsp;jakarta-servlet.&nbsp;&nbsp;Perhaps&nbsp;this&nbsp;handler&nbsp;is&nbsp;working&nbsp;differently&nbsp;for&nbsp;HTTPS&nbsp;traffic.&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;font&nbsp;class=&quot;Apple-style-span&quot;&nbsp;face=&quot;Consolas,&nbsp;'Courier&nbsp;New',&nbsp;Courier&quot;&gt;&lt;span&nbsp;class=&quot;Apple-style-span&quot;&nbsp;style=&quot;font-size:&nbsp;13px;&quot;&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabs&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;ModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0in;&nbsp;PADDING-LEFT:&nbsp;0in;&nbsp;PADDING-RIGHT:&nbsp;0in;&nbsp;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;PADDING-TOP:&nbsp;3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Gagandeep&nbsp;Singh&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gagandeepsohi@gmail.com&quot;&gt;gagandeepsohi@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Fri,&nbsp;2&nbsp;Mar&nbsp;2012&nbsp;05:53:15&nbsp;-0600&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;Ryan&nbsp;Barnett&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rbarnett@trustwave.com&quot;&gt;rbarnett@trustwave.com&lt;/a&gt;&gt;,&nbsp;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Mod&nbsp;security&nbsp;is&nbsp;not&nbsp;detecting&nbsp;double&nbsp;header's&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;BORDER-LEFT:&nbsp;#b5c4df&nbsp;5&nbsp;solid;&nbsp;PADDING:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;MARGIN:0&nbsp;0&nbsp;0&nbsp;5;&quot;&gt;<br>
We&nbsp;have&nbsp;validated&nbsp;that&nbsp;A&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;pache&nbsp;Include&nbsp;directives&nbsp;is&nbsp;in&nbsp;the&nbsp;core&nbsp;directives.&nbsp;When&nbsp;we&nbsp;are&nbsp;trying&nbsp;a&lt;b&gt;&nbsp;SQL&nbsp;injection&lt;/b&gt;&nbsp;on&nbsp;HTTPS&nbsp;it&nbsp;detects&nbsp;the&nbsp;attack&nbsp;and&nbsp;throws&nbsp;an&nbsp;exception.This&nbsp;means&nbsp;&nbsp;mod-security<br>
&nbsp;and&nbsp;CRS&nbsp;is&nbsp;working&nbsp;for&nbsp;HTTPS&nbsp;as&nbsp;well.&lt;/span&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;In&nbsp;case&nbsp;of&nbsp;double&nbsp;header&nbsp;this&nbsp;is&nbsp;not&nbsp;working&nbsp;for&nbsp;HTTPS.&nbsp;Do&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;any&nbsp;changes&nbsp;in&nbsp;rule&nbsp;set?&lt;/span&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:14px&quot;&gt;Regards&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,sans-serif&quot;&gt;&lt;span&nbsp;style=&quot;font-size:14px&quot;&gt;Gagandeep&lt;br&gt;<br>
&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Thu,&nbsp;Mar&nbsp;1,&nbsp;2012&nbsp;at&nbsp;6:40&nbsp;PM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-size:14px;font-family:Calibri,sans-serif;word-wrap:break-word&quot;&gt;<br>
&lt;div&gt;How&nbsp;do&nbsp;you&nbsp;have&nbsp;the&nbsp;CRS&nbsp;conf&nbsp;files&nbsp;activated&nbsp;in&nbsp;Apache&nbsp;for&nbsp;the&nbsp;port&nbsp;80&nbsp;server?&nbsp;&nbsp;If&nbsp;you&nbsp;are&nbsp;using&nbsp;Apache&nbsp;Includes,&nbsp;then&nbsp;you&nbsp;should&nbsp;include&nbsp;them&nbsp;also&nbsp;within&nbsp;your&nbsp;HTTPS/443&nbsp;vhost&nbsp;container.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;other&nbsp;option&nbsp;is,&nbsp;if&nbsp;you&nbsp;want&nbsp;to&nbsp;run&nbsp;the&nbsp;CRS&nbsp;for&nbsp;all&nbsp;HTTP&nbsp;and&nbsp;HTTPS&nbsp;sites,&nbsp;is&nbsp;to&nbsp;specify&nbsp;the&nbsp;Apache&nbsp;Include&nbsp;directives&nbsp;in&nbsp;the&nbsp;core&nbsp;directives&nbsp;location&nbsp;instead&nbsp;of&nbsp;further&nbsp;down&nbsp;within&nbsp;specific&nbsp;vhost&nbsp;containers.&nbsp;&nbsp;This&nbsp;will&nbsp;propagate&nbsp;to&nbsp;all&nbsp;vhosts.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
Ryan&nbsp;Barnett&lt;br&gt;<br>
Trustwave&nbsp;SpiderLabs&lt;/span&gt;&lt;/font&gt;<br>
&lt;div&gt;&lt;font&nbsp;face=&quot;Calibri,Verdana,Helvetica,Arial&quot;&gt;&lt;span&nbsp;style=&quot;font-size:11pt&quot;&gt;ModSecurity&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;CRS&nbsp;Project&nbsp;Leader&lt;/span&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&gt;<br>
&lt;div&nbsp;style=&quot;border-right:medium&nbsp;none;padding-right:0in;padding-left:0in;padding-top:3pt;text-align:left;font-size:11pt;border-bottom:medium&nbsp;none;font-family:Calibri;border-top:#b5c4df&nbsp;1pt&nbsp;solid;padding-bottom:0in;border-left:medium&nbsp;none&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Gagandeep&nbsp;Singh&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gagandeepsohi@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gagandeepsohi@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Thu,&nbsp;1&nbsp;Mar&nbsp;2012&nbsp;18:03:47&nbsp;&#43;0000&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ryan.barnett@owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;ryan.barnett@owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Mod&nbsp;security&nbsp;is&nbsp;not&nbsp;detecting&nbsp;double&nbsp;header's&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;style=&quot;BORDER-LEFT:#b5c4df&nbsp;5&nbsp;solid;PADDING:0&nbsp;0&nbsp;0&nbsp;5;MARGIN:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;Thanks&nbsp;Ryan&nbsp;for&nbsp;your&nbsp;help,&nbsp;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;FURTHER&nbsp;ISSUE-&nbsp;&nbsp;its&nbsp;working&nbsp;for&nbsp;HTTP&nbsp;and&nbsp;we&nbsp;got&nbsp;the&nbsp;below&nbsp;response.&nbsp;Our&nbsp;issue&nbsp;is&nbsp;with&nbsp;&nbsp;HTTPS&nbsp;&nbsp;as&nbsp;well,&nbsp;this&nbsp;rule&nbsp;is&nbsp;not&nbsp;working&nbsp;for&nbsp;https.&nbsp;Our&nbsp;client&nbsp;has&nbsp;raised&nbsp;a&nbsp;concern&nbsp;for&nbsp;HTTPS.&nbsp;Could&nbsp;you&nbsp;please&nbsp;advise&nbsp;what&nbsp;we&nbsp;can&nbsp;do&nbsp;to&nbsp;enable&nbsp;this&nbsp;for&nbsp;HTTPS<br>
&nbsp;as&nbsp;well.&lt;br&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;div&gt;Message:&nbsp;Warning.&nbsp;Pattern&nbsp;match&nbsp;&quot;[\n\r](?:content-(type|length)|set-cookie|location):&quot;&nbsp;at&nbsp;REQUEST_FILENAME.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/modsecurity_localrules.conf&quot;]&nbsp;[line&nbsp;&quot;4&quot;]&nbsp;[id&nbsp;&quot;950910&quot;]&nbsp;[rev&nbsp;&quot;2.2.4&quot;]&nbsp;[msg&nbsp;&quot;HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack&quot;]&nbsp;[data<br>
&nbsp;&quot;\x0alocation:&quot;]&nbsp;[severity&nbsp;&quot;ALERT&quot;]&lt;/div&gt;<br>
&lt;div&gt;Message:&nbsp;Warning.&nbsp;Pattern&nbsp;match&nbsp;&quot;[\n\r](?:content-(type|length)|set-cookie|location):&quot;&nbsp;at&nbsp;REQUEST_FILENAME.&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;]&nbsp;[line&nbsp;&quot;139&quot;]&nbsp;[id&nbsp;&quot;950910&quot;]&nbsp;[rev&nbsp;&quot;2.2.4&quot;]&nbsp;[msg&nbsp;&quot;HTTP&nbsp;Response<br>
&nbsp;Splitting&nbsp;Attack&quot;]&nbsp;[data&nbsp;&quot;\x0alocation:&quot;]&nbsp;[severity&nbsp;&quot;CRITICAL&quot;]&lt;/div&gt;<br>
&lt;div&gt;Message:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;2).&nbsp;[file&nbsp;&quot;/etc/httpd/modsecurity.d/base_rules/modsecurity_crs_49_enforcement.conf&quot;]&nbsp;[line&nbsp;&quot;25&quot;]&nbsp;[msg&nbsp;&quot;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(score&nbsp;40):&nbsp;HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack&quot;]&lt;/div&gt;<br>
&lt;div&gt;Action:&nbsp;Intercepted&nbsp;(phase&nbsp;2)&lt;/div&gt;<br>
&lt;div&gt;Apache-Handler:&nbsp;jakarta-servlet&lt;/div&gt;<br>
&lt;div&gt;Stopwatch:&nbsp;1330624314422822&nbsp;1653262&nbsp;(1471&nbsp;1258692&nbsp;-)&lt;/div&gt;<br>
&lt;div&gt;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.5.12&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);&nbsp;core&nbsp;ruleset/&lt;a&nbsp;href=&quot;http://2.0.5.&quot;&nbsp;target=&quot;_blank&quot;&gt;2.0.5.&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;Thu,&nbsp;Mar&nbsp;1,&nbsp;2012&nbsp;at&nbsp;5:25&nbsp;PM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:ryan.barnett@owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;ryan.barnett@owasp.org&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-size:14px;font-family:Calibri,sans-serif;word-wrap:break-word&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;div&gt;I&nbsp;have&nbsp;pushed&nbsp;CRS&nbsp;v2.2.4&nbsp;out&nbsp;to&nbsp;SVN&nbsp;and&nbsp;you&nbsp;can&nbsp;access&nbsp;the&nbsp;updated&nbsp;rule&nbsp;file&nbsp;here&nbsp;-&lt;/div&gt;<br>
&lt;div&gt;&lt;a&nbsp;href=&quot;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_40_generic_attacks.conf?revision=1900&quot;&nbsp;target=&quot;_blank&quot;&gt;http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/base_rules/modsecurity_crs_40_generic_attacks.conf?revision=1900&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;updated&nbsp;rule&nbsp;-&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;pre&nbsp;style=&quot;line-height:normal;text-indent:0px;letter-spacing:normal;text-align:-webkit-auto;font-variant:normal;text-transform:none;font-style:normal;white-space:pre-wrap;word-wrap:break-word;font-weight:normal;word-spacing:0px&quot;&gt;SecRule&nbsp;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&nbsp;&quot;[\n\r](?:content-(type|length)|set-cookie|location):&quot;&nbsp;\<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;phase:2,rev:'2.2.4',t:none,t:lowercase,capture,ctl:auditLogParts=&#43;E,block,msg:'HTTP&nbsp;Response&nbsp;Splitting&nbsp;Attack',id:'950910',logdata:'%{TX.0}',severity:'2',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=&#43;%{tx.critical_anomaly_score},setvar:tx.response_splitting_score=&#43;%{tx.critical_anomaly_score},setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-WEB_ATTACK/RESPONSE_SPLITTING-%{matched_var_name}=%{tx.0}&quot;&lt;/pre&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;-Ryan&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;span&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;div&nbsp;style=&quot;border-right:medium&nbsp;none;padding-right:0in;padding-left:0in;padding-top:3pt;text-align:left;font-size:11pt;border-bottom:medium&nbsp;none;font-family:Calibri;border-top:#b5c4df&nbsp;1pt&nbsp;solid;padding-bottom:0in;border-left:medium&nbsp;none&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Gagandeep&nbsp;Singh&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gagandeepsohi@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;gagandeepsohi@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Thu,&nbsp;1&nbsp;Mar&nbsp;2012&nbsp;17:15:36&nbsp;&#43;0000&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;[Owasp-modsecurity-core-rule-set]&nbsp;Mod&nbsp;security&nbsp;is&nbsp;not&nbsp;detecting&nbsp;double&nbsp;header's&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;style=&quot;BORDER-LEFT:#b5c4df&nbsp;5&nbsp;solid;PADDING:0&nbsp;0&nbsp;0&nbsp;5;MARGIN:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Hi&nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;We&nbsp;have&nbsp;configured&nbsp;modsecurity&nbsp;apache_2.6.3&nbsp;and&nbsp;its&nbsp;working&nbsp;fine&nbsp;for&nbsp;most&nbsp;of&nbsp;the&nbsp;cases&nbsp;but&nbsp;we&nbsp;have&nbsp;identified&nbsp;a&nbsp;special&nbsp;attack&nbsp;which&nbsp;is&nbsp;causing&nbsp;a&nbsp;double&nbsp;header&nbsp;injection&nbsp;to&nbsp;the&nbsp;site.&lt;/span&gt;&lt;br&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;<br>
&lt;br&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Example&nbsp;:-&lt;br&gt;<br>
&nbsp;&lt;a&nbsp;href=&quot;https://www.xyz.com/%0d%0aLocation:http://www.google.com&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.XYZ.com/%0d%0aLocation:http://www.google.com&lt;/a&gt;&lt;br&gt;<br>
&nbsp;Note&nbsp;-&nbsp;XYZ&nbsp;is&nbsp;any&nbsp;site.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;This&nbsp;generates&nbsp;a&nbsp;Duplicate&nbsp;headers&nbsp;error&nbsp;page&nbsp;which&nbsp;is&nbsp;shown&nbsp;below-&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px&quot;&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
Duplicate&nbsp;headers&nbsp;received&nbsp;from&nbsp;the&nbsp;server&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
The&nbsp;response&nbsp;from&nbsp;the&nbsp;server&nbsp;contained&nbsp;duplicate&nbsp;headers.&nbsp;This&nbsp;problem&nbsp;is&nbsp;generally&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;misconfigured&nbsp;website&nbsp;or&nbsp;proxy.&nbsp;Only&nbsp;the&nbsp;website&nbsp;or&nbsp;proxy&nbsp;administrator&nbsp;can&nbsp;fix&nbsp;this&nbsp;issue.&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;div&gt;&nbsp;&lt;/div&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
&nbsp;Error&nbsp;350&nbsp;(net::ERR_RESPONSE_HEADERS_MULTIPLE_LOCATION):&nbsp;Multiple&nbsp;Location&nbsp;headers&nbsp;received.&nbsp;This&nbsp;is&nbsp;disallowed&nbsp;to&nbsp;protect&nbsp;against&nbsp;HTTP&nbsp;response-splitting&nbsp;attacks.&lt;/blockquote&gt;<br>
&lt;/blockquote&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;As&nbsp;per&nbsp;the&nbsp;discussion&nbsp;with&nbsp;Bren&nbsp;we&nbsp;came&nbsp;to&nbsp;know&nbsp;that&nbsp;this&nbsp;will&nbsp;be&nbsp;fixed&nbsp;in&nbsp;CRS&nbsp;2.2.4&nbsp;but&nbsp;we&nbsp;need&nbsp;this&nbsp;urgently,&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;get&nbsp;the&nbsp;rule&nbsp;for&nbsp;above&nbsp;issue&nbsp;so&nbsp;we&nbsp;can&nbsp;apply&nbsp;the&nbsp;patch&nbsp;for&nbsp;the&nbsp;time<br>
&nbsp;being&nbsp;and&nbsp;will&nbsp;apply&nbsp;2.2.4&nbsp;soon&nbsp;as&nbsp;it&nbsp;becomes&nbsp;available.&nbsp;&nbsp;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Could&nbsp;you&nbsp;please&nbsp;also&nbsp;assist&nbsp;on&nbsp;this,&nbsp;what&nbsp;configuration&nbsp;changes&nbsp;are&nbsp;required&nbsp;to&nbsp;handle&nbsp;this?&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Regards&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri,sans-serif;font-size:14px&quot;&gt;Gagandeep&nbsp;Singh&nbsp;&nbsp;Sohi&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
_______________________________________________&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;<br>
Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;br&nbsp;clear=&quot;all&quot;&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
--&nbsp;&lt;br&gt;<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#333333&quot;&gt;&lt;strong&gt;Regards,&lt;br&gt;<br>
&lt;/strong&gt;&lt;em&gt;Gagandeep&nbsp;Singh&nbsp;Sohi&lt;/em&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#333333&quot;&gt;9717920072&lt;/font&gt;&lt;/em&gt;&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;<br>
&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,<br>
&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic<br>
&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;br&nbsp;clear=&quot;all&quot;&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
--&nbsp;&lt;br&gt;<br>
&lt;div&gt;&lt;font&nbsp;color=&quot;#333333&quot;&gt;&lt;strong&gt;Regards,&lt;br&gt;<br>
&lt;/strong&gt;&lt;em&gt;Gagandeep&nbsp;Singh&nbsp;Sohi&lt;/em&gt;&lt;/font&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;em&gt;&lt;font&nbsp;color=&quot;#333333&quot;&gt;9717920072&lt;/font&gt;&lt;/em&gt;&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,<br>
&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic<br>
&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
