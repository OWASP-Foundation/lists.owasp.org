<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;Agreed&nbsp;and&nbsp;we&nbsp;do&nbsp;that&nbsp;already&nbsp;with&nbsp;chained&nbsp;rules&nbsp;within&nbsp;the&nbsp;CRS.&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;-Ryan&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0in;&nbsp;PADDING-LEFT:&nbsp;0in;&nbsp;PADDING-RIGHT:&nbsp;0in;&nbsp;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;PADDING-TOP:&nbsp;3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Josh&nbsp;Amishav-Zlatin&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:jamuse@gmail.com&quot;&gt;jamuse@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Wed,&nbsp;14&nbsp;Mar&nbsp;2012&nbsp;03:41:00&nbsp;-0500&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;Ryan&nbsp;Barnett&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:rbarnett@trustwave.com&quot;&gt;rbarnett@trustwave.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Cc:&nbsp;&lt;/span&gt;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;[Rule&nbsp;Update&nbsp;-&nbsp;Discussion&nbsp;Thread]&nbsp;Updated&nbsp;Rule&nbsp;Formatting&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;BORDER-LEFT:&nbsp;#b5c4df&nbsp;5&nbsp;solid;&nbsp;PADDING:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;MARGIN:0&nbsp;0&nbsp;0&nbsp;5;&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Mar&nbsp;13,&nbsp;2012&nbsp;at&nbsp;4:49&nbsp;PM,&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;&lt;a&nbsp;href=&quot;mailto:RBarnett@trustwave.com&quot;&nbsp;target=&quot;_blank&quot;&gt;RBarnett@trustwave.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
I&nbsp;am&nbsp;working&nbsp;on&nbsp;updating&nbsp;the&nbsp;current&nbsp;CRS&nbsp;SecRule&nbsp;formatting.&nbsp;&nbsp;The&nbsp;idea&nbsp;is&lt;br&gt;<br>
to&nbsp;make&nbsp;the&nbsp;rules&nbsp;easier&nbsp;to&nbsp;read&nbsp;and&nbsp;understand&nbsp;what&nbsp;is&nbsp;happening,&nbsp;for&lt;br&gt;<br>
example&nbsp;to&nbsp;quickly&nbsp;understand&nbsp;the&nbsp;ACTION&nbsp;line&nbsp;data.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;format&nbsp;is&nbsp;updated&nbsp;to:&lt;br&gt;<br>
&lt;br&gt;<br>
1)&nbsp;Separate&nbsp;the&nbsp;VARIABLE&nbsp;OPERATOR&nbsp;and&nbsp;ACTION&nbsp;sections&nbsp;from&nbsp;each&nbsp;other&nbsp;by&lt;br&gt;<br>
using&nbsp;the&nbsp;Apache&nbsp;\&nbsp;line&nbsp;continuation&nbsp;character.&lt;br&gt;<br>
2)&nbsp;The&nbsp;1st&nbsp;ACTION&nbsp;line&nbsp;starts&nbsp;with&nbsp;the&nbsp;rule&nbsp;ID.&nbsp;&nbsp;This&nbsp;makes&nbsp;it&nbsp;easier&nbsp;to&lt;br&gt;<br>
find&nbsp;rules&nbsp;of&nbsp;interest.&lt;br&gt;<br>
3)&nbsp;The&nbsp;end&nbsp;of&nbsp;the&nbsp;1st&nbsp;ACTION&nbsp;line&nbsp;lists&nbsp;any&nbsp;disruptive&nbsp;actions.&lt;br&gt;<br>
4)&nbsp;Transformation&nbsp;functions&nbsp;have&nbsp;their&nbsp;own&nbsp;line&lt;br&gt;<br>
5)&nbsp;Tags&nbsp;have&nbsp;their&nbsp;own&nbsp;line&lt;br&gt;<br>
6)&nbsp;Meta-actions&nbsp;(such&nbsp;as&nbsp;setvars)&nbsp;have&nbsp;their&nbsp;own&nbsp;line&lt;br&gt;<br>
7)&nbsp;Also&nbsp;including&nbsp;example&nbsp;attack&nbsp;payloads&nbsp;that&nbsp;are&nbsp;detected&nbsp;by&nbsp;the&lt;br&gt;<br>
OPERATOR&nbsp;to&nbsp;help&nbsp;understand&nbsp;what&nbsp;the&nbsp;regex&nbsp;is&nbsp;looking&nbsp;form&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;review/comment&nbsp;on&nbsp;the&nbsp;updated&nbsp;format&nbsp;below.&nbsp;&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;start&lt;br&gt;<br>
updating&nbsp;the&nbsp;CRS&nbsp;rules&nbsp;to&nbsp;use&nbsp;this&nbsp;format&nbsp;for&nbsp;the&nbsp;3.0&nbsp;version.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Hi&nbsp;Ryan,&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;I&nbsp;like&nbsp;new&nbsp;format.&nbsp;IMHO,&nbsp;we&nbsp;can&nbsp;improve&nbsp;readable&nbsp;a&nbsp;bit&nbsp;further&nbsp;by&nbsp;adding&nbsp;indentation&nbsp;to&nbsp;all&nbsp;lines&nbsp;that&nbsp;do&nbsp;not&nbsp;start&nbsp;a&nbsp;rule.&nbsp;That&nbsp;especially&nbsp;helps&nbsp;locate&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;various&nbsp;rules&nbsp;within&nbsp;a&nbsp;chained&nbsp;rule.&nbsp;For&nbsp;example:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;SecRule&nbsp;ARGS&nbsp;test1&nbsp;&quot;id:123,phase:2,block,chain,&nbsp;\&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;setvar:tx.sql_injection_score=&#43;1,&nbsp;\&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;setvar:tx.anomaly_score=&#43;%{tx.critical_anomaly_score}&quot;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;ARGS&nbsp;test2&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;--&lt;/div&gt;<br>
&lt;div&gt;&nbsp;-&nbsp;Josh&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,<br>
&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic<br>
&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
