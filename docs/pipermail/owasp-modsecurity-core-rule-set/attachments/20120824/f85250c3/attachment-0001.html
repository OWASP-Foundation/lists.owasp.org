<tt>
Hey&nbsp;people,&nbsp;good&nbsp;afternoon!&lt;br&gt;&lt;br&gt;I&#39;m&nbsp;trying&nbsp;to&nbsp;Add&nbsp;a&nbsp;new&nbsp;negative&nbsp;policy&nbsp;rule&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/blog/archives/2007/02/handling_false.html&quot;&gt;http://www.modsecurity.org/blog/archives/2007/02/handling_false.html&lt;/a&gt;),&nbsp;because&nbsp;am&nbsp;facing&nbsp;false&nbsp;positve&nbsp;with&nbsp;the&nbsp;rule&nbsp;970901.&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;b&gt;##&nbsp;log&lt;br&gt;&lt;br&gt;&lt;/b&gt;[Fri&nbsp;Aug&nbsp;24&nbsp;13:44:57&nbsp;2012]&nbsp;[error]&nbsp;[client&nbsp;192.168.21.10]&nbsp;ModSecurity:&nbsp;Rule&nbsp;2d8f030&nbsp;[id&nbsp;&quot;950901&quot;][file&nbsp;&quot;/etc/httpd/conf.d/modsecurity/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;][line&nbsp;&quot;77&quot;]&nbsp;-&nbsp;Execution&nbsp;error&nbsp;-&nbsp;PCRE&nbsp;limits&nbsp;exceeded&nbsp;(-8):&nbsp;(null).&nbsp;[hostname&nbsp;&quot;10.1.125.204&quot;]&nbsp;[uri&nbsp;&quot;/sites/all/themes/fsa/img/icone-seta.jpg&quot;]&nbsp;[unique_id&nbsp;&quot;UDeviX8AAAEAAHXIAy0AAAAA&quot;]&lt;br&gt;<br>
<br>
[Fri&nbsp;Aug&nbsp;24&nbsp;13:44:57&nbsp;2012]&nbsp;[error]&nbsp;[client&nbsp;192.168.21.10]&nbsp;ModSecurity:&nbsp;Rule&nbsp;2d8f030&nbsp;[id&nbsp;&quot;950901&quot;][file&nbsp;&quot;/etc/httpd/conf.d/modsecurity/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;][line&nbsp;&quot;77&quot;]&nbsp;-&nbsp;Execution&nbsp;error&nbsp;-&nbsp;PCRE&nbsp;limits&nbsp;exceeded&nbsp;(-8):&nbsp;(null).&nbsp;[hostname&nbsp;&quot;10.1.125.204&quot;]&nbsp;[uri&nbsp;&quot;/sites/all/themes/fsa/img/icone-seta.jpg&quot;]&nbsp;[unique_id&nbsp;&quot;UDeviX8AAAEAAHXIAy0AAAAA&quot;]&lt;br&gt;<br>
<br>
[Fri&nbsp;Aug&nbsp;24&nbsp;13:44:57&nbsp;2012]&nbsp;[error]&nbsp;[client&nbsp;192.168.21.10]&nbsp;ModSecurity:&nbsp;Rule&nbsp;2d8f030&nbsp;[id&nbsp;&quot;950901&quot;][file&nbsp;&quot;/etc/httpd/conf.d/modsecurity/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;][line&nbsp;&quot;77&quot;]&nbsp;-&nbsp;Execution&nbsp;error&nbsp;-&nbsp;PCRE&nbsp;limits&nbsp;exceeded&nbsp;(-8):&nbsp;(null).&nbsp;[hostname&nbsp;&quot;10.1.125.204&quot;]&nbsp;[uri&nbsp;&quot;/sites/all/themes/fsa/img/onda-fsa.png&quot;]&nbsp;[unique_id&nbsp;&quot;UDeviX8AAAEAAHXPDFoAAAAF&quot;]&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;br&gt;&lt;b&gt;##&nbsp;log&nbsp;in&nbsp;verbose&nbsp;mode:&lt;/b&gt;&lt;br&gt;&lt;br&gt;[24/Aug/2012:13:24:52&nbsp;--0300]&nbsp;[&lt;a&nbsp;href=&quot;http://192.168.21.10/sid#1526d30][rid#27f7510][/][5&quot;&gt;192.168.21.10/sid#1526d30][rid#27f7510][/][5&lt;/a&gt;]&nbsp;Rule&nbsp;116d418:&nbsp;SecRule&nbsp;&quot;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot;&nbsp;&quot;@rx&nbsp;(?:(?:[\\;\\|\\`]\\W*?\\bcc|\\b(wget|curl))\\b|\\/cc(?:[\\&#39;\&quot;\\|\\;\\`\\-\\s]|$))&quot;&nbsp;&quot;phase:2,log,rev:2.2.5,capture,t:none,t:normalisePath,t:lowercase,ctl:auditLogParts=+E,msg:&#39;System&nbsp;Command&nbsp;Injection&#39;,id:950907,tag:WEB_ATTACK/COMMAND_INJECTION,tag:WASCTC/WASC-31,tag:OWASP_TOP_10/A1,tag:PCI/6.5.2,logdata:%{TX.0},severity:2,setvar:tx.msg=%{rule.msg},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.command_injection_score=+%{tx.critical_anomaly_score},setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&gt;rule.id&lt;/a&gt;}-WEB_ATTACK/COMMAND_INJECTION-%{matched_var_name}=%{tx.0},skipAfter:END_COMMAND_INJECTION1&quot;&lt;br&gt;<br>
<br>
[24/Aug/2012:13:24:52&nbsp;--0300]&nbsp;[&lt;a&nbsp;href=&quot;http://192.168.21.10/sid#1526d30][rid#27f7510][/][4&quot;&gt;192.168.21.10/sid#1526d30][rid#27f7510][/][4&lt;/a&gt;]&nbsp;Expanded&nbsp;&quot;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML:/*&quot;&nbsp;to&nbsp;&quot;REQUEST_COOKIES:SESSc2ec4f8fae0f9b49b1219031f3052c40|REQUEST_COOKIES:SESS988f6dde2396798ae2237ef1db71fdb8|REQUEST_COOKIES:SESS8677ac936d1934b4e08580e4b78c02d0|REQUEST_COOKIES:SESS4922cbb0a9f1bcd7dd450637560249a3|REQUEST_COOKIES:__utma|REQUEST_COOKIES:__utmz|REQUEST_COOKIES:SESSe8a50359f7869c256a51e29f93548645|REQUEST_COOKIES:pma_lang|REQUEST_COOKIES:SESS448430042d094f8dddea85b752fc6947|REQUEST_COOKIES:phpMyAdmin|REQUEST_COOKIES:__utmc|REQUEST_COOKIES:has_js|REQUEST_COOKIES_NAMES:SESSc2ec4f8fae0f9b49b1219031f3052c40|REQUEST_COOKIES_NAMES:SESS988f6dde2396798ae2237ef1db71fdb8|REQUEST_COOKIES_NAMES:SESS8677ac936d1934b4e08580e4b78c02d0|REQUEST_COOKIES_NAMES:SESS4922cbb0a9f1bcd7dd450637560249a3|REQUEST_COOKIES_NAMES:__utma|REQUEST_COOKIES_NAMES:__utmz|REQUEST_COOKIES_NAMES:SESSe8a50359f7869c256a51e29f93548645|REQUEST_COOKIES_NAMES:pma_lang|REQUEST_COOKIES_NAMES:SESS448430042d094f8dddea85b752fc6947|REQUEST_COOKIES_NAMES:php&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;br&gt;***************************************&lt;br&gt;&lt;br&gt;&lt;br&gt;So,&nbsp;I&nbsp;created&nbsp;a&nbsp;file&nbsp;called&nbsp;modsecurity_crs_61_custom_rules.conf&nbsp;and&nbsp;I&nbsp;inserted&nbsp;the&nbsp;rule&nbsp;(see&nbsp;bellow)&nbsp;on&nbsp;it:&lt;br&gt;&lt;br&gt;&lt;br&gt;SecRule&nbsp;REQUEST_COOKIES|REQUEST_COOKIES_NAMES|REQUEST_FILENAME|ARGS_NAMES|ARGS|XML|&lt;br&gt;<br>
<br>
!REQUEST_HEADERS:Cookie|REQUEST_COOKIES|REQUEST_COOKIES_NAMES|!REQUEST_COOKIES_NAMES:/^SESS$/:/*&lt;br&gt;&quot;(?i:([\s&#39;\&quot;`Â´Ã¢(\)]*)?([\d\w]+)([\s&#39;\&quot;`Â´Ã¢(\)]*)?(?:=|&lt;=&gt;|r?like|sounds\s+like|regexp)([\s&#39;\&quot;`Â´Ã¢(\)]*)?([\s&#39;\&quot;`Â´Ã¢(\)]*)?([\d\w]+)([\s&#39;\&quot;`Â´Ã¢(\)]*)?(?:!=|&lt;=|&gt;=|&lt;&gt;|&lt;|&gt;|\^|is\s+not|not\s+likgexp)([\s&#39;\&quot;`Â´Ã¢(\)]*)?(?!\6)([\d\w]+))&quot;&nbsp;\&lt;br&gt;<br>
<br>
       &nbsp;&quot;phase:2,rev:&#39;2.2.5&#39;,capture,multiMatch,t:none,t:urlDecodeUni,t:replaceComments,ctl:auditLogParts=+E,block,msg:&#39;SQL&nbsp;Injection&nbsp;Attack&#39;,id:&#39;1&#39;,logdata:&#39;%{TX.0}&#39;,severity:&#39;2&#39;,tag:&#39;WEB_ATTACK/SQL_INJECTION&#39;,tag:&#39;WASCTC/WASC-19&#39;,tag:&#39;OWASP_TOP_10/A1&#39;,tag:&#39;OWASP_AppSensor/CIE1&#39;,tag:&#39;PCI/6.5.2&#39;,setvar:&#39;tx.msg=%{rule.msg}&#39;,setvar:tx.sql_injection_score=+%{tx.critical_anomaly_score},setvar:tx.anomaly_score=+%{tx.critical_anomaly_score},setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&gt;rule.id&lt;/a&gt;}-WEB_ATTACK/SQL_INJECTION-%{matched_var_name}=%{tx.0}&quot;&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;br&gt;&lt;br&gt;####&lt;br&gt;&lt;br&gt;&lt;b&gt;[root@myserver&nbsp;httpd]#&nbsp;/etc/init.d/httpd&nbsp;start&lt;/b&gt;&lt;br&gt;Starting&nbsp;httpd:&nbsp;Syntax&nbsp;error&nbsp;on&nbsp;line&nbsp;10&nbsp;of&nbsp;/etc/httpd/conf.d/modsecurity/base_rules/modsecurity_crs_61_custom_rules.conf:&lt;br&gt;SecRule&nbsp;takes&nbsp;two&nbsp;or&nbsp;three&nbsp;arguments,&nbsp;rule&nbsp;target,&nbsp;operator&nbsp;and&nbsp;optional&nbsp;action&nbsp;list&lt;br&gt;<br>
<br>
                                                          &nbsp;[FAILED]&lt;br&gt;&lt;br&gt;What&nbsp;I&#39;m&nbsp;doing&nbsp;wrong&nbsp;in&nbsp;this&nbsp;rule&nbsp;?&lt;br&gt;&lt;br&gt;many&nbsp;thanks!&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;<br>

</tt>
