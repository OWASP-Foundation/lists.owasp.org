<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:georgia,serif;color:rgb(7,55,99)&quot;&gt;Hi &lt;span&nbsp;style=&quot;font-size:12.8000001907349px;font-weight:bold;white-space:nowrap;font-family:arial,sans-serif;color:rgb(34,34,34)&quot;&gt;Joshua,&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:georgia,serif;color:rgb(7,55,99)&quot;&gt;Thank&nbsp;you&nbsp;for&nbsp;your&nbsp;reply&nbsp;it&#39;s&nbsp;clear.&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:georgia,serif;color:rgb(7,55,99)&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:georgia,serif;color:rgb(7,55,99)&quot;&gt;Barry&nbsp;thank&nbsp;you&nbsp;for&nbsp;your comprehensive&nbsp;explanation&nbsp;:)&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_default&quot;&nbsp;style=&quot;font-family:georgia,serif;color:rgb(7,55,99)&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2015-04-04&nbsp;22:13&nbsp;GMT+01:00&nbsp;Barry&nbsp;Pollard&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:barry_pollard@hotmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;barry_pollard@hotmail.com&lt;/a&gt;&gt;&lt;/span&gt;:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;I&nbsp;agree&nbsp;with&nbsp;Joshua&nbsp;that&nbsp;it&#39;s&nbsp;better&nbsp;to&nbsp;do&nbsp;this&nbsp;from&nbsp;within&nbsp;ModSecurity.&nbsp;This&nbsp;is&nbsp;because&nbsp;LocationMatch&nbsp;runs&nbsp;AFTER&nbsp;the&nbsp;phase&nbsp;1&nbsp;ModSecurity&nbsp;rules&nbsp;so&nbsp;that&#39;s&nbsp;the&nbsp;only&nbsp;option&nbsp;for&nbsp;adjusting&nbsp;phase&nbsp;1&nbsp;rules.&nbsp;Now&nbsp;this&nbsp;particular&nbsp;example&nbsp;is&nbsp;a&nbsp;phase&nbsp;2&nbsp;rule,&nbsp;however&nbsp;so&nbsp;LocationMatch&nbsp;should&nbsp;work&nbsp;but&nbsp;nice&nbsp;to&nbsp;be&nbsp;consistent&nbsp;so&nbsp;you&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;worry&nbsp;about&nbsp;which&nbsp;phase&nbsp;the&nbsp;rule&nbsp;is&nbsp;for.&lt;br&gt;<br>
&lt;br&gt;<br>
Joshua&#39;s&nbsp;suggestion&nbsp;is&nbsp;also&nbsp;better,&nbsp;as&nbsp;it&nbsp;only&nbsp;removes&nbsp;the&nbsp;request&nbsp;argument&nbsp;from&nbsp;the&nbsp;rule&nbsp;checking&nbsp;rather&nbsp;than&nbsp;turning&nbsp;it&nbsp;off&nbsp;completely&nbsp;for&nbsp;all&nbsp;arguments,&nbsp;cookies...etc.&lt;br&gt;<br>
&lt;br&gt;<br>
Anyway,&nbsp;as&nbsp;it&#39;s&nbsp;a&nbsp;phase&nbsp;2&nbsp;rule,&nbsp;what&nbsp;you&nbsp;did&nbsp;should&nbsp;work&nbsp;if&nbsp;you&nbsp;wanted&nbsp;to&nbsp;do&nbsp;it&nbsp;that&nbsp;way.&nbsp;I&nbsp;suspect&nbsp;the&nbsp;reason&nbsp;it&nbsp;is&nbsp;not&nbsp;working&nbsp;in&nbsp;LocationMatch,&nbsp;is&nbsp;that&nbsp;you&nbsp;are&nbsp;removing&nbsp;the&nbsp;rule&nbsp;BEFORE&nbsp;it&#39;s&nbsp;been&nbsp;defined&nbsp;in&nbsp;the&nbsp;config:&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecRuleRemoveById&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#SecRuleRemoveById&lt;/a&gt;&lt;br&gt;<br>
&quot;Note&nbsp;:&nbsp;This&nbsp;directive&nbsp;must&nbsp;be&nbsp;specified&nbsp;after&nbsp;the&nbsp;rule&nbsp;in&nbsp;which&nbsp;it&nbsp;is&nbsp;disabling.&nbsp;This&nbsp;should&nbsp;be&nbsp;used&nbsp;within&nbsp;local&nbsp;custom&nbsp;rule&nbsp;files&nbsp;that&nbsp;are&nbsp;processed&nbsp;after&nbsp;third&nbsp;party&nbsp;rule&nbsp;sets.&nbsp;Example&nbsp;file&nbsp;-&nbsp;modsecurity_crs_60_customrules.conf.&quot;&lt;br&gt;<br>
If&nbsp;you&nbsp;load&nbsp;the&nbsp;ModSecurity&nbsp;rules,&nbsp;and&nbsp;then&nbsp;do&nbsp;the&nbsp;LocationMatch&nbsp;it&nbsp;should&nbsp;work&nbsp;so&nbsp;check&nbsp;that.&nbsp;Still&nbsp;advise&nbsp;you&nbsp;do&nbsp;it&nbsp;Joshua&#39;s&nbsp;way&nbsp;though&nbsp;for&nbsp;the&nbsp;reasons&nbsp;given. &lt;br&gt;<br>
&lt;br&gt;<br>
Thanks,&lt;br&gt;<br>
Barry&lt;br&gt;<br>
&lt;br&gt;<br>
________________________________&lt;br&gt;<br>
&gt;&nbsp;From:&nbsp;&lt;a&nbsp;href=&quot;mailto:jroback@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;jroback@gmail.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;Date:&nbsp;Sat,&nbsp;4&nbsp;Apr&nbsp;2015&nbsp;20:49:44&nbsp;+0000&lt;br&gt;<br>
&gt;&nbsp;To:&nbsp;&lt;a&nbsp;href=&quot;mailto:ilyassikai@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ilyassikai@gmail.com&lt;/a&gt;;&nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;False&nbsp;positives&nbsp;Web&nbsp;services&lt;br&gt;<br>
&lt;span&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;This&nbsp;may&nbsp;be&nbsp;an&nbsp;older&nbsp;way&nbsp;to&nbsp;get&nbsp;the&nbsp;job&nbsp;done,&nbsp;but&nbsp;I&nbsp;typically&nbsp;would&lt;br&gt;<br>
&gt;&nbsp;whitelist&nbsp;that&nbsp;specific&nbsp;Argument&nbsp;in&nbsp;a&nbsp;rule.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;SecRule&nbsp;REQUEST_URI&nbsp;&quot;@beginsWith&nbsp;/webservice&quot;&nbsp;&quot;phase:1,t:none,t:lowercase,pass,nolog,ctl:ruleRemoveTargetById=950901;ARGS:request&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;On&nbsp;Sat,&nbsp;Apr&nbsp;4,&nbsp;2015&nbsp;at&nbsp;1:49&nbsp;AM&nbsp;Ilyass&nbsp;Kaouam&lt;br&gt;<br>
&lt;/span&gt;&lt;span&gt;&gt;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ilyassikai@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ilyassikai@gmail.com&lt;/a&gt;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:ilyassikai@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ilyassikai@gmail.com&lt;/a&gt;&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hi,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Wa&nbsp;have&nbsp;this&nbsp;request&nbsp;for&nbsp;a&nbsp;web&nbsp;service&nbsp;:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;&lt;a&nbsp;href=&quot;http://www.mywebsite.com/webservice?request=%3Cxmlrequest%3E%3Cheader%3E%3Cutilisateur%3Exxx%3C/utilisateur%3E%3Cmotdepasse%3Exxx%3C/motdepasse%3E%3Crequete%3Esearch%3C/requete%3E%3Clangage%3EFR%3C/langage%3E%3Cpays%3Exx%3C/pays%3E%3C/header%3E%3Cbody%3E%3Cnbrparpage%3Exx%3C/nbrparpage%3E%3Cpage%3E2%3C/page%3E%3Ctyperecherche%3Exx%3C/typerecherche%3E%3C/body%3E%3C/xmlrequest%3E&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.mywebsite.com/webservice?request=%3Cxmlrequest%3E%3Cheader%3E%3Cutilisateur%3Exxx%3C/utilisateur%3E%3Cmotdepasse%3Exxx%3C/motdepasse%3E%3Crequete%3Esearch%3C/requete%3E%3Clangage%3EFR%3C/langage%3E%3Cpays%3Exx%3C/pays%3E%3C/header%3E%3Cbody%3E%3Cnbrparpage%3Exx%3C/nbrparpage%3E%3Cpage%3E2%3C/page%3E%3Ctyperecherche%3Exx%3C/typerecherche%3E%3C/body%3E%3C/xmlrequest%3E&lt;/a&gt;&lt;&lt;a&nbsp;href=&quot;http://www.mywebsite.com/webservice?request=%3cxmlrequest%3e%3cheader%3e%3cutilisateur%3exxx%3c/utilisateur%3e%3cmotdepasse%3exxx%3c/motdepasse%3e%3crequete%3esearch%3c/requete%3e%3clangage%3eFR%3c/langage%3e%3cpays%3exx%3c/pays%3e%3c/header%3e%3cbody%3e%3cnbrparpage%3exx%3c/nbrparpage%3e%3cpage%3e2%3c/page%3e%3ctyperecherche%3exx%3c/typerecherche%3e%3c/body%3e%3c/xmlrequest%3e&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.mywebsite.com/webservice?request=%3cxmlrequest%3e%3cheader%3e%3cutilisateur%3exxx%3c/utilisateur%3e%3cmotdepasse%3exxx%3c/motdepasse%3e%3crequete%3esearch%3c/requete%3e%3clangage%3eFR%3c/langage%3e%3cpays%3exx%3c/pays%3e%3c/header%3e%3cbody%3e%3cnbrparpage%3exx%3c/nbrparpage%3e%3cpage%3e2%3c/page%3e%3ctyperecherche%3exx%3c/typerecherche%3e%3c/body%3e%3c/xmlrequest%3e&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&gt;&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;​mod_security&nbsp;forbidden&nbsp;this&nbsp;request&nbsp;log&nbsp;:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;​&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Message:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;2).&nbsp;Pattern&nbsp;match&lt;br&gt;<br>
&gt;&nbsp;&quot;(?i:([\\s&#39;\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\b([\\d\\w]++)([\\s&#39;\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)(?:(?:=|&lt;=&gt;|r?like|sounds\\s+like|regexp)([\\s&#39;\&quot;`\xc2\xb4\xe2\x80\x99\xe2\x80\x98\\(\\)]*?)\\2\\b|(?:!=|&lt;=|&gt;=|&lt;&gt;|&lt;|&gt;|\\^|is\\s+not&lt;br&gt;<br>
&gt;&nbsp;...&quot;&nbsp;at&nbsp;ARGS:request.&nbsp;[file&lt;br&gt;<br>
&gt;&nbsp;&quot;/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_41_sql_injection_attacks.conf&quot;]&lt;br&gt;<br>
&gt;&nbsp;[line&nbsp;&quot;77&quot;]&nbsp;[id&nbsp;&quot;950901&quot;]&nbsp;[rev&nbsp;&quot;2&quot;]&nbsp;[msg&nbsp;&quot;SQL&nbsp;Injection&nbsp;Attack:&nbsp;SQL&lt;br&gt;<br>
&gt;&nbsp;Tautology&nbsp;Detected.&quot;]&nbsp;[data&nbsp;&quot;Matched&nbsp;Data:&nbsp;utilisateur&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;​xxxx&lt;br&gt;<br>
&gt;&nbsp;found&nbsp;within&nbsp;ARGS:request:&nbsp;&lt;xmlrequest&gt;&lt;header&gt;&lt;utilisateur&gt;&lt;br&gt;<br>
&gt;&nbsp;​xxxx&lt;br&gt;<br>
&gt;&nbsp;&lt;/utilisateur&gt;&lt;motdepasse&gt;&lt;br&gt;<br>
&gt;&nbsp;​xxxx&lt;br&gt;<br>
&gt;&nbsp;&lt;/motdepasse&gt;&lt;requete&gt;search&lt;/requete&gt;&lt;langage&gt;&lt;br&gt;<br>
&gt;&nbsp;​xx&lt;br&gt;<br>
&gt;&nbsp;&lt;/langage&gt;&lt;pays&gt;&lt;br&gt;<br>
&gt;&nbsp;​xxx&lt;br&gt;<br>
&gt;&nbsp;&lt;/pays&gt;&lt;/header&gt;&lt;body&gt;&lt;nbrparpage&gt;10&lt;/nbrparpage&gt;&lt;page&gt;2&lt;/page&gt;&lt;typerecherche&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Action:&nbsp;Intercepted&nbsp;(phase&nbsp;2)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Apache-Handler:&nbsp;proxy-server&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Stopwatch:&nbsp;1427968010902873&nbsp;5141&nbsp;(-&nbsp;-&nbsp;-)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Stopwatch2:&nbsp;1427968010902873&nbsp;5141;&nbsp;combined=1880,&nbsp;p1=97,&nbsp;p2=1759,&nbsp;p3=0,&lt;br&gt;<br>
&gt;&nbsp;p4=0,&nbsp;p5=24,&nbsp;sr=26,&nbsp;sw=0,&nbsp;l=0,&nbsp;gc=0&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Response-Body-Transformed:&nbsp;Dechunked&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.7.3&nbsp;(&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.modsecurity.org/&lt;/a&gt;);&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;OWASP_CRS/&lt;a&nbsp;href=&quot;http://2.2.9.&quot;&nbsp;target=&quot;_blank&quot;&gt;2.2.9.&lt;/a&gt;&lt;&lt;a&nbsp;href=&quot;http://2.2.9&quot;&nbsp;target=&quot;_blank&quot;&gt;http://2.2.9&lt;/a&gt;.&gt;&lt;br&gt;<br>
&lt;span&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;Server:&nbsp;Apache&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Engine-Mode:&nbsp;&quot;ENABLED&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;​I&nbsp;tired&nbsp;:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;LocationMatch&nbsp;/webservice&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;SecRuleRemoveByID&nbsp;950901&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;/LocationMatch&gt;&nbsp;​&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;​But&nbsp;I&lt;br&gt;<br>
&gt;&nbsp;&#39;m&nbsp;afraid​&lt;br&gt;<br>
&gt;&nbsp;​&nbsp;its&nbsp;not&nbsp;​&lt;br&gt;<br>
&gt;&nbsp;Safely&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;How&nbsp;I&nbsp;can&nbsp;allow&nbsp;my&nbsp;web&nbsp;services&nbsp;Safely&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;​&nbsp;?&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Thank&nbsp;you.​&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;/span&gt;&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;mailto:&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&gt;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;<br>
&lt;/div&gt;&lt;/div&gt;<br>

</tt>
