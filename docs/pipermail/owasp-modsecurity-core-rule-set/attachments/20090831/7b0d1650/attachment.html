<tt>
&lt;!DOCTYPE&nbsp;HTML&nbsp;PUBLIC&nbsp;&quot;-//W3C//DTD&nbsp;HTML&nbsp;4.0//EN&quot;&nbsp;&quot;http://www.w3.org/TR/REC-html40/strict.dtd&quot;&gt;&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;name=&quot;qrichtext&quot;&nbsp;content=&quot;1&quot;&nbsp;/&gt;&lt;style&nbsp;type=&quot;text/css&quot;&gt;p,&nbsp;li&nbsp;{&nbsp;white-space:&nbsp;pre-wrap;&nbsp;}&lt;/style&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;&nbsp;font-family:'DejaVu&nbsp;Sans';&nbsp;font-size:9pt;&nbsp;font-weight:400;&nbsp;font-style:normal;&quot;&gt;What&nbsp;is&nbsp;the&nbsp;request?&nbsp;&nbsp;I&nbsp;looking&nbsp;at&nbsp;Section&nbsp;K&nbsp;of&nbsp;the&nbsp;matched&nbsp;rules,&nbsp;it&nbsp;doesn't&nbsp;look&nbsp;like&nbsp;any&nbsp;rule&nbsp;matched&nbsp;that&nbsp;triggered&nbsp;a&nbsp;400&nbsp;Bad&nbsp;Request&nbsp;status&nbsp;code.&nbsp;&nbsp;I&nbsp;would&nbsp;look&nbsp;in&nbsp;the&nbsp;error_log&nbsp;file&nbsp;to&nbsp;see&nbsp;why&nbsp;Apache&nbsp;triggered&nbsp;this&nbsp;status&nbsp;code.&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;--&lt;br&gt;<br>
Ryan&nbsp;C.&nbsp;Barnett&lt;br&gt;<br>
WASC&nbsp;Distributed&nbsp;Open&nbsp;Proxy&nbsp;Honeypot&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
OWASP&nbsp;ModSecurity&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;Project&nbsp;Leader&lt;br&gt;<br>
Tactical&nbsp;Web&nbsp;Application&nbsp;Security&lt;br&gt;<br>
http://tacticalwebappsec.blogspot.com&lt;br&gt;<br>
&lt;br&nbsp;/&gt;On&nbsp;Monday&nbsp;31&nbsp;August&nbsp;2009&nbsp;03:13:01&nbsp;pm&nbsp;Claude.Durocher@mcccf.gouv.qc.ca&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;Hello,&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Hi&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;I'm&nbsp;using&nbsp;v2.01&nbsp;of&nbsp;core&nbsp;rules&nbsp;and&nbsp;I'm&nbsp;getting&nbsp;false&nbsp;positives&nbsp;with&nbsp;Domino&lt;br&gt;<br>
&amp;gt;&nbsp;Web&nbsp;Access&nbsp;(Apache&nbsp;set&nbsp;up&nbsp;as&nbsp;a&nbsp;reverse&nbsp;proxy).&nbsp;How&nbsp;can&nbsp;I&nbsp;correct&nbsp;this.&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Here's&nbsp;a&nbsp;sample&nbsp;:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;HTTP/1.0&nbsp;400&nbsp;Bad&nbsp;Request&lt;br&gt;<br>
&amp;gt;&nbsp;Expires:&nbsp;Tue,&nbsp;01&nbsp;Jan&nbsp;1980&nbsp;06:00:00&nbsp;GMT&lt;br&gt;<br>
&amp;gt;&nbsp;Content-Type:&nbsp;text/html&lt;br&gt;<br>
&amp;gt;&nbsp;Content-Language:&nbsp;fr&lt;br&gt;<br>
&amp;gt;&nbsp;Cache-control:&nbsp;no-cache&lt;br&gt;<br>
&amp;gt;&nbsp;Vary:&nbsp;Accept-Encoding,User-Agent&lt;br&gt;<br>
&amp;gt;&nbsp;Content-Encoding:&nbsp;gzip&lt;br&gt;<br>
&amp;gt;&nbsp;Connection:&nbsp;close&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;--c68d233e-H--&lt;br&gt;<br>
&amp;gt;&nbsp;Apache-Handler:&nbsp;proxy-server&lt;br&gt;<br>
&amp;gt;&nbsp;Stopwatch:&nbsp;1251739580252930&nbsp;106828&nbsp;(1268&nbsp;82911&nbsp;-)&lt;br&gt;<br>
&amp;gt;&nbsp;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.5.9&nbsp;(http://www.modsecurity.org/);&nbsp;core&lt;br&gt;<br>
&amp;gt;&nbsp;ruleset/2.0.1.&lt;br&gt;<br>
&amp;gt;&nbsp;Server:&nbsp;Apache/2.2.10&nbsp;(Linux/SUSE)&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;--c68d233e-K--&lt;br&gt;<br>
&amp;gt;&nbsp;SecAction&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:1,status:403,t:none,pass,nolog,initcol:global=global,initcol:ip=%{re&lt;br&gt;<br>
&amp;gt;mote_addr}&quot;&nbsp;SecRule&nbsp;&quot;REQUEST_FILENAME|ARGS|ARGS_NAMES|REQUEST_HEADERS|&lt;br&gt;<br>
&amp;gt;&nbsp;XML:/*|!REQUEST_HEADERS:Referer&quot;&nbsp;&quot;@pmFromFile&lt;br&gt;<br>
&amp;gt;&nbsp;modsecurity_40_generic_attacks.data&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:2,status:403,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhit&lt;br&gt;<br>
&amp;gt;eSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=&lt;br&gt;<br>
&amp;gt;&nbsp;+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule&nbsp;&quot;REQUEST_FILENAME|ARGS|ARGS_NAMES|REQUEST_HEADERS|&lt;br&gt;<br>
&amp;gt;&nbsp;XML:/*|!REQUEST_HEADERS:Referer&quot;&nbsp;&quot;@pmFromFile&lt;br&gt;<br>
&amp;gt;&nbsp;modsecurity_40_generic_attacks.data&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:2,status:403,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhit&lt;br&gt;<br>
&amp;gt;eSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=&lt;br&gt;<br>
&amp;gt;&nbsp;+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule&nbsp;&quot;REQUEST_FILENAME|ARGS|ARGS_NAMES|REQUEST_HEADERS|&lt;br&gt;<br>
&amp;gt;&nbsp;XML:/*|!REQUEST_HEADERS:Referer&quot;&nbsp;&quot;@pmFromFile&lt;br&gt;<br>
&amp;gt;&nbsp;modsecurity_40_generic_attacks.data&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:2,status:403,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhit&lt;br&gt;<br>
&amp;gt;eSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=&lt;br&gt;<br>
&amp;gt;&nbsp;+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule&nbsp;&quot;&amp;amp;TX:/SQL_INJECTION/&quot;&nbsp;&quot;@eq&nbsp;0&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:2,status:403,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;SecAction&nbsp;&quot;phase:2,status:403,nolog,skipAfter:END_XSS_REGEX&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule&nbsp;&quot;REQUEST_FILENAME&quot;&nbsp;&quot;!@pmFromFile&lt;br&gt;<br>
&amp;gt;&nbsp;modsecurity_46_et_sql_injection.data&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:2,status:403,nolog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normal&lt;br&gt;<br>
&amp;gt;isePathWin,skipAfter:END_ET_SQLI_RULES&quot;&nbsp;SecRule&nbsp;&quot;REQUEST_FILENAME&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;!@pmFromFile&nbsp;modsecurity_46_et_web_rules.data&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:2,status:403,nolog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:normal&lt;br&gt;<br>
&amp;gt;isePathWin,skipAfter:END_SNORT_RULES&quot;&nbsp;SecRule&nbsp;&quot;RESPONSE_BODY&quot;&nbsp;&quot;!@pmFromFile&lt;br&gt;<br>
&amp;gt;&nbsp;modsecurity_50_outbound.data&quot;&lt;br&gt;<br>
&amp;gt;&nbsp;&quot;phase:4,status:403,t:none,t:urlDecodeUni,t:htmlEntityDecode,nolog,allow&quot;&lt;br&gt;<br>
&lt;p&nbsp;style=&quot;-qt-paragraph-type:empty;&nbsp;margin-top:0px;&nbsp;margin-bottom:0px;&nbsp;margin-left:0px;&nbsp;margin-right:0px;&nbsp;-qt-block-indent:0;&nbsp;text-indent:0px;&nbsp;-qt-user-state:0;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
