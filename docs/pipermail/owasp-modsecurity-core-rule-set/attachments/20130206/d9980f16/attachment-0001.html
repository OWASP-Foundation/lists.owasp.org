<tt>
&lt;html&gt;&lt;body&gt;&lt;div&nbsp;style=&quot;color:#000;&nbsp;background-color:#fff;&nbsp;font-family:arial,&nbsp;helvetica,&nbsp;sans-serif;font-size:12pt&quot;&gt;&lt;div&gt;Hello,&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;I&nbsp;currently&nbsp;use&nbsp;mod-security&nbsp;rules&nbsp;from&nbsp;Atomicorp&nbsp;.&nbsp;The&nbsp;utf-8&nbsp;rules&nbsp;are&nbsp;about&nbsp;6&nbsp;month&nbsp;old&nbsp;and&nbsp;looks&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;#UTF&nbsp;abuse&nbsp;protection&nbsp;&lt;br&gt;SecRule&nbsp;RESPONSE_HEADERS:Content-Type&nbsp;&quot;charset=utf-8&quot;<br>
&nbsp;\&lt;br&gt;&quot;phase:3,t:none,pass,nolog,setvar:global.utf8_encoding_used=1&quot;&lt;br&gt;SecRule&nbsp;GLOBAL:UTF8_ENCODING_USED&nbsp;&quot;@eq&nbsp;1&quot;&nbsp;&quot;chain,phase:2,t:none,auditlog,status:400,msg:'Atomicorp.com&nbsp;-&nbsp;FREE&nbsp;UNSUPPORTED&nbsp;DELAYED&nbsp;FEED&nbsp;-&nbsp;WAF&nbsp;Rules:&nbsp;UTF8&nbsp;Encoding&nbsp;Abuse&nbsp;Attack&nbsp;Attempt',id:'390620',rev:3,severity:'7'&quot;&lt;br&gt;SecRule&nbsp;REQUEST_FILENAME|ARGS|ARGS_NAMES|!ARGS:/text/|!ARGS:/txt/&nbsp;&quot;@validateUtf8Encoding&quot;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;I&nbsp;found&nbsp;reports&nbsp;about&nbsp;this&nbsp;to&nbsp;be&nbsp;buggy&nbsp;and&nbsp;I&nbsp;played&nbsp;with&nbsp;it&nbsp;a&nbsp;little&nbsp;,&nbsp;the&nbsp;behavior&nbsp;looks&nbsp;like&nbsp;this:&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,<br>
&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;1.&nbsp;&nbsp;the&nbsp;first&nbsp;rule&nbsp;is&nbsp;setting&nbsp;the&nbsp;global.utf8_encoding_used=1&nbsp;,&nbsp;when&nbsp;RESPONSE_HEADERS&nbsp;contains&nbsp;charset=utf-8&nbsp;.(actually&nbsp;one&nbsp;of&nbsp;my&nbsp;servers&nbsp;send&nbsp;charset=UTF=8&nbsp;and&nbsp;the&nbsp;variable&nbsp;was&nbsp;never&nbsp;set,&nbsp;that&nbsp;is&nbsp;why&nbsp;I&nbsp;had&nbsp;different&nbsp;behavior)&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;2.&nbsp;the&nbsp;second&nbsp;rule,&nbsp;during&nbsp;phase&nbsp;2,&nbsp;if&nbsp;global.utf8_encoding_used=1&nbsp;and&nbsp;the&nbsp;third&nbsp;rule&nbsp;is&nbsp;a&nbsp;match&nbsp;,&nbsp;then&nbsp;status=400&nbsp;is&nbsp;returned&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;This&nbsp;looks&nbsp;like&nbsp;it's&nbsp;generating&nbsp;some<br>
&nbsp;false&nbsp;positives&nbsp;(reacting&nbsp;to&nbsp;&amp;nbsp&nbsp;%C2%A0%)&nbsp;but&nbsp;it&nbsp;also&nbsp;behaves&nbsp;OK,&nbsp;for&nbsp;instance&nbsp;when&nbsp;bytes&nbsp;are&nbsp;missing,&nbsp;this&nbsp;is&nbsp;exactly&nbsp;what&nbsp;@validateUtf8Encoding&nbsp;is&nbsp;doing.&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;Also&nbsp;I&nbsp;noticed&nbsp;that&nbsp;the&nbsp;approach&nbsp;on&nbsp;the&nbsp;new&nbsp;AtomiCorp&nbsp;and&nbsp;on&nbsp;Owasp&nbsp;is&nbsp;not&nbsp;so&nbsp;intrusive&nbsp;,&nbsp;rather&nbsp;it&nbsp;just&nbsp;logging&nbsp;..&nbsp;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;What&nbsp;do&nbsp;more&nbsp;experienced&nbsp;people&nbsp;think?&nbsp;Maybe&nbsp;I&nbsp;am&nbsp;not&nbsp;looking&nbsp;where&nbsp;I&nbsp;should.&nbsp;Can&nbsp;you&nbsp;help&nbsp;me&nbsp;in&nbsp;giving&nbsp;me&nbsp;some&nbsp;directions?&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;<br>
&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;Thank&nbsp;you.&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;16px;&nbsp;font-family:&nbsp;arial,helvetica,sans-serif;&nbsp;background-color:&nbsp;transparent;&nbsp;font-style:&nbsp;normal;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
