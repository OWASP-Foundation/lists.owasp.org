<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi&lt;div&gt;Which&nbsp;version&nbsp;of&nbsp;modsecurity&nbsp;do&nbsp;you&nbsp;use?&lt;/div&gt;&lt;div&gt;We&nbsp;experienced&nbsp;a&nbsp;lot&nbsp;of&nbsp;this&nbsp;with&nbsp;modsecurity_nginx_refactoring&nbsp;branch! &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;good&nbsp;luck&lt;/div&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;On&nbsp;Sun,&nbsp;Jun&nbsp;17,&nbsp;2018&nbsp;at&nbsp;12:03&nbsp;PM&nbsp;Quinn&nbsp;Comendant&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:quinn@strangecode.com&quot;&gt;quinn@strangecode.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;I&#39;m&nbsp;getting&nbsp;the&nbsp;famous&nbsp;MSC_PCRE_LIMITS_EXCEEDED&nbsp;error&nbsp;on&nbsp;a&nbsp;specific&nbsp;request,&nbsp;and&nbsp;not&nbsp;able&nbsp;to&nbsp;circumvent&nbsp;it&nbsp;by&nbsp;raising&nbsp;the&nbsp;SecPcreMatchLimit&nbsp;value;&nbsp;I&#39;ve&nbsp;raised&nbsp;it&nbsp;to&nbsp;SecPcreMatchLimit&nbsp;10000000&nbsp;(ten&nbsp;million!)&nbsp;and&nbsp;it&#39;s&nbsp;still&nbsp;blocked.&lt;br&gt;<br>
&lt;br&gt;<br>
Looks&nbsp;to&nbsp;me&nbsp;like&nbsp;a&nbsp;broken&nbsp;regex.&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
1.&nbsp;So&nbsp;maybe&nbsp;this&nbsp;is&nbsp;a&nbsp;bug&nbsp;report.&nbsp;Can&nbsp;you&nbsp;guys&nbsp;confirm&nbsp;the&nbsp;issue,&nbsp;based&nbsp;on&nbsp;the&nbsp;data&nbsp;included&nbsp;below?&lt;br&gt;<br>
&lt;br&gt;<br>
2.&nbsp;How&nbsp;do&nbsp;I&nbsp;find&nbsp;which&nbsp;rule&nbsp;has&nbsp;the&nbsp;regex&nbsp;blocking&nbsp;this&nbsp;request?&nbsp;(I&nbsp;don&#39;t&nbsp;mean&nbsp;rule&nbsp;200004,&nbsp;which&nbsp;blocks&nbsp;MSC_*,&nbsp;I&nbsp;mean&nbsp;the&nbsp;rule&nbsp;with&nbsp;the&nbsp;broken&nbsp;regex&nbsp;that&nbsp;caused&nbsp;too&nbsp;much&nbsp;recursion.&lt;br&gt;<br>
&lt;br&gt;<br>
error_log:&lt;br&gt;<br>
[Fri&nbsp;Jun&nbsp;15&nbsp;23:26:43.506695&nbsp;2018]&nbsp;[:error]&nbsp;[pid&nbsp;22588]&nbsp;[client&nbsp;&lt;a&nbsp;href=&quot;http://1.2.3.4:54790&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;1.2.3.4:54790&lt;/a&gt;]&nbsp;[client&nbsp;1.2.3.4]&nbsp;ModSecurity:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;2).&nbsp;Match&nbsp;of&nbsp;&quot;streq&nbsp;0&quot;&nbsp;against&nbsp;&quot;TX:MSC_PCRE_LIMITS_EXCEEDED&quot;&nbsp;required.&nbsp;[file&nbsp;&quot;/etc/httpd/conf.d/mod_security.conf&quot;]&nbsp;[line&nbsp;&quot;43&quot;]&nbsp;[id&nbsp;&quot;200004&quot;]&nbsp;[msg&nbsp;&quot;ModSecurity&nbsp;internal&nbsp;error&nbsp;flagged:&nbsp;TX:MSC_PCRE_LIMITS_EXCEEDED&quot;]&nbsp;[hostname&nbsp;&quot;&lt;a&nbsp;href=&quot;http://www.example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;www.example.com&lt;/a&gt;&quot;]&nbsp;[uri&nbsp;&quot;/cp/orders.php&quot;]&nbsp;[unique_id&nbsp;&quot;WyRLM2JpNbHeGYomo7lCxQAAAAU&quot;],&nbsp;referer:&nbsp;&lt;a&nbsp;href=&quot;https://www.example.com/order/new&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.example.com/order/new&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
OS:&nbsp;&lt;br&gt;<br>
CentOS&nbsp;Linux&nbsp;release&nbsp;7.5.1804&nbsp;(Core)&lt;br&gt;<br>
&lt;br&gt;<br>
Software&nbsp;versions:&lt;br&gt;<br>
httpd-2.4.6-80.el7.centos.x86_64&lt;br&gt;<br>
mod_security-2.9.2-1.el7.x86_64&lt;br&gt;<br>
mod_security_crs-2.2.9-1.el7.noarch&lt;br&gt;<br>
&lt;br&gt;<br>
Config:&lt;br&gt;<br>
$&nbsp;sudo&nbsp;grep&nbsp;-r&nbsp;SecPcreMatchLimit&nbsp;/etc/httpd&lt;br&gt;<br>
/etc/httpd/conf.d/mod_security.conf: &nbsp; &nbsp;SecPcreMatchLimit&nbsp;10000000&lt;br&gt;<br>
/etc/httpd/conf.d/mod_security.conf: &nbsp; &nbsp;SecPcreMatchLimitRecursion&nbsp;10000000&lt;br&gt;<br>
&lt;br&gt;<br>
Request:&lt;br&gt;<br>
The&nbsp;request&nbsp;causing&nbsp;the&nbsp;error,&nbsp;as&nbsp;a&nbsp;curl&nbsp;command:&nbsp;&lt;a&nbsp;href=&quot;https://pastebin.com/raw/fymAQtsJ&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://pastebin.com/raw/fymAQtsJ&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
curl&nbsp;&#39;&lt;a&nbsp;href=&quot;https://www.example.com/order/confirm&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.example.com/order/confirm&lt;/a&gt;&#39;&nbsp;-H&nbsp;&#39;Connection:&nbsp;keep-alive&#39;&nbsp;-H&nbsp;&#39;Pragma:&nbsp;no-cache&#39;&nbsp;-H&nbsp;&#39;Cache-Control:&nbsp;no-cache&#39;&nbsp;-H&nbsp;&#39;Origin:&nbsp;&lt;a&nbsp;href=&quot;https://www.example.com&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.example.com&lt;/a&gt;&#39;&nbsp;-H&nbsp;&#39;Upgrade-Insecure-Requests:&nbsp;1&#39;&nbsp;-H&nbsp;&#39;DNT:&nbsp;1&#39;&nbsp;-H&nbsp;&#39;Content-Type:&nbsp;application/x-www-form-urlencoded&#39;&nbsp;-H&nbsp;&#39;User-Agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;&nbsp;Intel&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;10_13_5)&nbsp;AppleWebKit/537.36&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Chrome/67.0.3396.87&nbsp;Safari/537.36&#39;&nbsp;-H&nbsp;&#39;Accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&#39;&nbsp;-H&nbsp;&#39;Referer:&nbsp;&lt;a&nbsp;href=&quot;https://www.example.com/order/new&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.example.com/order/new&lt;/a&gt;&#39;&nbsp;-H&nbsp;&#39;Accept-Encoding:&nbsp;gzip,&nbsp;deflate,&nbsp;br&#39;&nbsp;-H&nbsp;&#39;Accept-Language:&nbsp;en-US,en;q=0.9,es;q=0.8&#39;&nbsp;-H&nbsp;&#39;Cookie:&nbsp;_prefs-login-username=%22%22;&nbsp;_session=sgj9tdvgrc26m57atct02niat3&#39;&nbsp;--data&nbsp;&lt;br&gt;<br>
&#39;csrf_token=1528995053-BrkRHVojxjfm5jmXVrK08SjLCo33daL2lHOPjosXweGZihQptAuqSwAKE6aNoWup&amp;op=confirm&amp;contdrugs-store=%5B%7B%22id%22%3A%221i75f9wlcaa2a6c7%22%2C%22ndc%22%3A%228576453101%22%2C%22description%22%3A%22TORGUGESIC-SA%22%2C%22strength%22%3A%222MG%2FML%22%2C%22dosage%22%3A%22Injection%22%2C%22package_size%22%3A%2210%22%2C%22units_of_measure%22%3A%22ml%22%2C%22quantity%22%3A%221%22%2C%22quantity_units%22%3A%22full+packages%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75fwwk6yf2c487%22%2C%22ndc%22%3A%22641228941%22%2C%22description%22%3A%22DIAZEPAM%22%2C%22strength%22%3A%225+MG%2FML%22%2C%22dosage%22%3A%22Solution%22%2C%22package_size%22%3A%2210%22%2C%22units_of_measure%22%3A%22ml%22%2C%22quantity%22%3A%221%22%2C%22quantity_units%22%3A%22full+packages%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75ftk3c0393b6a%22%2C%22ndc%22%3A%22856203310%22%2C%22description%22%3A%22TORBUTROL%22%2C%22strength%22%3A%2210MG%5C%5CML%22%2C%22dosage%22%3A%22Injection%22%2C%22packag&lt;br&gt;<br>
&lt;br&gt;<br>
e_size%22%3A%2210%22%2C%22units_of_measure%22%3A%22ml%22%2C%22quantity%22%3A%222.5%22%2C%22quantity_units%22%3A%22ml%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75eew2wa8940aa%22%2C%22ndc%22%3A%221169507021%22%2C%22description%22%3A%22KETAMINE+HCL%22%2C%22strength%22%3A%2210MG%2FML%22%2C%22dosage%22%3A%22Injection%22%2C%22package_size%22%3A%2210%22%2C%22units_of_measure%22%3A%22ml%22%2C%22quantity%22%3A%222.29%22%2C%22quantity_units%22%3A%22ml%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75ezq4k0a504cd%22%2C%22ndc%22%3A%226157008101%22%2C%22description%22%3A%22TUSSIGON%22%2C%22strength%22%3A%221.5+MG-5+MG%22%2C%22dosage%22%3A%22Tablet%22%2C%22package_size%22%3A%22100%22%2C%22units_of_measure%22%3A%22ea%22%2C%22quantity%22%3A%223%22%2C%22quantity_units%22%3A%22full+packages%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75f28rfw2ed68a%22%2C%22ndc%22%3A%226157008101%22%2C%22description%22%3A%22TUSSIGON%22%2C%22strength%22%3A%221.5+MG-5+MG%22%2C%22dosage%22%3A%22T&lt;br&gt;<br>
&lt;br&gt;<br>
ablet%22%2C%22package_size%22%3A%22100%22%2C%22units_of_measure%22%3A%22ea%22%2C%22quantity%22%3A%2268%22%2C%22quantity_units%22%3A%22ea%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75f5nnbwc3419d%22%2C%22ndc%22%3A%22856202660%22%2C%22description%22%3A%22BUTORPHANOL%22%2C%22strength%22%3A%225MG%22%2C%22dosage%22%3A%22Tablet%22%2C%22package_size%22%3A%22100%22%2C%22units_of_measure%22%3A%22ea%22%2C%22quantity%22%3A%2290%22%2C%22quantity_units%22%3A%22ea%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75ec40m257e4e4%22%2C%22ndc%22%3A%221169507021%22%2C%22description%22%3A%22KETAMINE+HCL%22%2C%22strength%22%3A%2210MG%2FML%22%2C%22dosage%22%3A%22Injection%22%2C%22package_size%22%3A%2210%22%2C%22units_of_measure%22%3A%22ml%22%2C%22quantity%22%3A%226%22%2C%22quantity_units%22%3A%22full+packages%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75fzeyre2104f3%22%2C%22ndc%22%3A%22641228941%22%2C%22description%22%3A%22DIAZEPAM%22%2C%22strength%22%3A%225+MG%2FML%22%2C%22dosage%&lt;br&gt;<br>
&lt;br&gt;<br>
22%3A%22Solution%22%2C%22package_size%22%3A%2210%22%2C%22units_of_measure%22%3A%22ml%22%2C%22quantity%22%3A%222.65%22%2C%22quantity_units%22%3A%22ml%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75g2unoy141ce6%22%2C%22ndc%22%3A%22409321312%22%2C%22description%22%3A%22DIAZEPAM%22%2C%22strength%22%3A%225+MG%2FML%22%2C%22dosage%22%3A%22Solution%22%2C%22package_size%22%3A%2210%22%2C%22units_of_measure%22%3A%22ml%22%2C%22quantity%22%3A%224%22%2C%22quantity_units%22%3A%22ml%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75gviq9434b93c%22%2C%22ndc%22%3A%224945278751%22%2C%22description%22%3A%22TRAMADOL+HCL%22%2C%22strength%22%3A%22Powder%22%2C%22dosage%22%3A%22Powder%22%2C%22package_size%22%3A%221%22%2C%22units_of_measure%22%3A%22gm%22%2C%22quantity%22%3A%220.125%22%2C%22quantity_units%22%3A%22gm%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75gztlgcfa0ae6%22%2C%22ndc%22%3A%224945278751%22%2C%22description%22%3A%22TRAMADOL+HCL%22%2C%22strength%22%3A%22Powder%22%2C%22dosa&lt;br&gt;<br>
&lt;br&gt;<br>
ge%22%3A%22Powder%22%2C%22package_size%22%3A%221%22%2C%22units_of_measure%22%3A%22gm%22%2C%22quantity%22%3A%220.125%22%2C%22quantity_units%22%3A%22gm%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75h329z80f8112%22%2C%22ndc%22%3A%224945278751%22%2C%22description%22%3A%22TRAMADOL+HCL%22%2C%22strength%22%3A%22Powder%22%2C%22dosage%22%3A%22Powder%22%2C%22package_size%22%3A%221%22%2C%22units_of_measure%22%3A%22gm%22%2C%22quantity%22%3A%220.125%22%2C%22quantity_units%22%3A%22gm%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75hdpo0u382057%22%2C%22ndc%22%3A%224945278751%22%2C%22description%22%3A%22TRAMADOL+HCL%22%2C%22strength%22%3A%22Powder%22%2C%22dosage%22%3A%22Powder%22%2C%22package_size%22%3A%221%22%2C%22units_of_measure%22%3A%22gm%22%2C%22quantity%22%3A%220.06875%22%2C%22quantity_units%22%3A%22gm%22%2C%22notes%22%3A%22%22%7D%2C%7B%22id%22%3A%221i75he25ro68cccb%22%2C%22ndc%22%3A%226516262710%22%2C%22description%22%3A%22TRAMADOL+HYDROCHLORIDE%22%2C%22strength%22%3A%2250+&lt;br&gt;<br>
&lt;br&gt;<br>
MG%22%2C%22dosage%22%3A%22Tablet%22%2C%22package_size%22%3A%22100%22%2C%22units_of_measure%22%3A%22ea%22%2C%22quantity%22%3A%2250.75%22%2C%22quantity_units%22%3A%22ea%22%2C%22notes%22%3A%22%22%7D%5D&amp;pharmwaste-store=%5B%5D&amp;contdrugs_weight=8&amp;pharmwaste_weight=0&amp;box_h=5&amp;box_l=5&amp;box_w=5&#39;&nbsp;--compressed&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
