<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=Windows-1252&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:break-word;&nbsp;color:rgb(0,0,0);&nbsp;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;This&nbsp;regex&nbsp;was&nbsp;modified&nbsp;a&nbsp;long&nbsp;time&nbsp;ago&nbsp;to&nbsp;help&nbsp;prevent&nbsp;false&nbsp;positives&nbsp;when&nbsp;the&nbsp;@validateUrlEncoding&nbsp;operator&nbsp;was&nbsp;used&nbsp;-&nbsp;&lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#validateUrlEncoding&quot;&gt;https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#validateUrlEncoding&lt;/a&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Without&nbsp;this&nbsp;–&nbsp;the&nbsp;operator&nbsp;would&nbsp;throw&nbsp;errors&nbsp;when&nbsp;it&nbsp;saw&nbsp;any&nbsp;%&nbsp;sign&nbsp;with&nbsp;other&nbsp;chars&nbsp;after&nbsp;it&nbsp;other&nbsp;than&nbsp;the&nbsp;normal&nbsp;ranges.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;We&nbsp;will&nbsp;look&nbsp;to&nbsp;improve&nbsp;it&nbsp;for&nbsp;CRS&nbsp;v3.0.0.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;Ryan&nbsp;Barnett&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.5pt;&nbsp;font-family:Arial,sans-serif&quot;&gt;Lead&nbsp;Security&nbsp;Researcher,&nbsp;SpiderLabs&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif;&nbsp;font-size:10.5pt&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;Trustwave&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:10.5pt;&nbsp;font-family:Arial,sans-serif&quot;&gt;&nbsp;|&nbsp;SMART&nbsp;SECURITY&nbsp;ON&nbsp;DEMAND&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;http://www.trustwave.com/&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.5pt&quot;&gt;www.trustwave.com&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;border-bottom:medium&nbsp;none;&nbsp;border-left:medium&nbsp;none;&nbsp;padding-bottom:0in;&nbsp;padding-left:0in;&nbsp;padding-right:0in;&nbsp;border-top:#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;border-right:medium&nbsp;none;&nbsp;padding-top:3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Ty&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:ty733420@gmail.com&quot;&gt;ty733420@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Tuesday,&nbsp;April&nbsp;1,&nbsp;2014&nbsp;11:17&nbsp;AM&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;[Owasp-modsecurity-core-rule-set]&nbsp;&quot;multiple&nbsp;URL&nbsp;encoding&quot;&nbsp;matching&nbsp;unexpectedly&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;border-left:#b5c4df&nbsp;5&nbsp;solid;&nbsp;padding:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;margin:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;know&nbsp;this&nbsp;rule&nbsp;(950109)&nbsp;has&nbsp;been&nbsp;brought&nbsp;up&nbsp;on&nbsp;this&nbsp;list&nbsp;before&nbsp;because&nbsp;posters&nbsp;were&nbsp;confused&nbsp;by&nbsp;its&nbsp;behavior&nbsp;for&nbsp;various&nbsp;reasons.&nbsp;&nbsp;I'm&nbsp;also&nbsp;by&nbsp;something&nbsp;very&nbsp;specific&nbsp;about&nbsp;it&nbsp;and&nbsp;so&nbsp;I'll&nbsp;get&nbsp;right&nbsp;to&nbsp;the&nbsp;point:<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;If&nbsp;this&nbsp;string&nbsp;(before&nbsp;URL&nbsp;encoding)&nbsp;appears&nbsp;in&nbsp;a&nbsp;parameter,&nbsp;the&nbsp;rule&nbsp;matches:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;hello%0dworld&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Which&nbsp;is&nbsp;expected,&nbsp;and&nbsp;I&nbsp;understand&nbsp;(percent&nbsp;followed&nbsp;by&nbsp;two&nbsp;potentially&nbsp;hex&nbsp;characters).&nbsp;&nbsp;What&nbsp;I&nbsp;don't&nbsp;understand&nbsp;is&nbsp;why&nbsp;this&nbsp;string:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;hello%world&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;also&nbsp;causes&nbsp;the&nbsp;rule&nbsp;to&nbsp;match,&nbsp;and&nbsp;I&nbsp;don't&nbsp;understand&nbsp;that&nbsp;(the&nbsp;following&nbsp;characters&nbsp;are&nbsp;not&nbsp;hexadecimal).&nbsp;&nbsp;Looking&nbsp;at&nbsp;the&nbsp;regex,&nbsp;it&nbsp;would&nbsp;appear&nbsp;it's&nbsp;been&nbsp;written&nbsp;to&nbsp;look&nbsp;specifically&nbsp;for&nbsp;hex&nbsp;characters&nbsp;(and&nbsp;their&nbsp;unicode&nbsp;equivalent):&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;SecRule&nbsp;ARGS&nbsp;&quot;\%((?!$|\W)|&lt;span&nbsp;style=&quot;background-color:rgb(255,0,0)&quot;&gt;[0-9a-fA-F&lt;/span&gt;]{2}|u[0-9a-fA-F]{4})&quot;&nbsp;\&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;But&nbsp;clearly&nbsp;it&nbsp;matches&nbsp;non-hex&nbsp;characters&nbsp;as&nbsp;well.&nbsp;&nbsp;Am&nbsp;I&nbsp;misunderstanding&nbsp;how&nbsp;the&nbsp;rule&nbsp;should&nbsp;work,&nbsp;or&nbsp;is&nbsp;there&nbsp;a&nbsp;problem&nbsp;with&nbsp;the&nbsp;rule's&nbsp;regex?&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Thanks,&lt;/div&gt;<br>
&lt;div&gt;Ty&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information<br>
&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
