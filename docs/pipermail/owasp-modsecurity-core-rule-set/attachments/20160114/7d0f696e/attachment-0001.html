<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=gb2312&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&gt;<br>
&lt;div&gt;Hi&nbsp;eenis,&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;(?:something)&nbsp;&nbsp;means&nbsp;do&nbsp;not&nbsp;capture&nbsp;the&nbsp;values&nbsp;that&nbsp;matched&nbsp;something,&nbsp;kind&nbsp;of&nbsp;save&nbsp;it&nbsp;for&nbsp;later&nbsp;so&nbsp;you&nbsp;may&nbsp;use&nbsp;it,&nbsp;the&nbsp;less&nbsp;you&nbsp;capture&nbsp;things&nbsp;you&nbsp;don't&nbsp;need&nbsp;the&nbsp;better&nbsp;it&nbsp;is&nbsp;for&nbsp;performance.&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;Regards,&nbsp;&lt;/div&gt;<br>
&lt;div&gt;Manuel&nbsp;&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;id=&quot;composer_signature&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-size:85%;&nbsp;color:#575757&quot;&gt;Envoy¨¦&nbsp;de&nbsp;mon&nbsp;Galaxy&nbsp;S5&nbsp;4G&#43;&nbsp;Orange&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
--------&nbsp;Original&nbsp;message&nbsp;--------&lt;br&gt;<br>
From:&nbsp;Denis&nbsp;Kolegov&nbsp;&lt;d.n.kolegov@gmail.com&gt;&nbsp;&lt;br&gt;<br>
Date:&nbsp;14/01/2016&nbsp;00:10&nbsp;(GMT&#43;01:00)&nbsp;&lt;br&gt;<br>
To:&nbsp;achim@owasp.org&nbsp;&lt;br&gt;<br>
Cc:&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&nbsp;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;LDAP&nbsp;injection&nbsp;rule&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;Hi.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;It&nbsp;seems&nbsp;my&nbsp;question&nbsp;was&nbsp;not&nbsp;clear.&lt;br&gt;<br>
I&nbsp;asked&nbsp;about&nbsp;logic&nbsp;of&nbsp;regular&nbsp;expression.&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;What&nbsp;is&nbsp;a&nbsp;purpose&nbsp;of&nbsp;first&nbsp;part&nbsp;of&nbsp;RE&nbsp;where&nbsp;it&nbsp;checks&nbsp;string&nbsp;beginning&nbsp;with&nbsp;'('?&lt;/p&gt;<br>
&lt;p&nbsp;dir=&quot;ltr&quot;&gt;(?:\((?:\W*?(?:objectc(?:ategory|lass)|homedirectory|[gu]idnumber|cn)\b\W*?=|[^\w\x80-\xFF]*?[\!\&amp;\|][^\w\x80-\xFF]*?\())<br>
&lt;br&gt;<br>
Thanks.&lt;br&gt;<br>
---&lt;br&gt;<br>
Denis&nbsp;Kolegov&lt;/p&gt;<br>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;14&nbsp;§Á§ß§Ó&nbsp;2016&nbsp;§Ô.&nbsp;3:18&nbsp;§á§à§Ý§î§Ù§à§Ó§Ñ§ä§Ö§Ý§î&nbsp;&quot;Achim&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:achim@owasp.org&quot;&gt;achim@owasp.org&lt;/a&gt;&gt;&nbsp;§ß§Ñ§á§Ú§ã§Ñ§Ý:&lt;br&nbsp;type=&quot;attribution&quot;&gt;<br>
&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;&nbsp;border-left:1px&nbsp;#ccc&nbsp;solid;&nbsp;padding-left:1ex&quot;&gt;<br>
Hi&nbsp;Denis,&lt;br&gt;<br>
&lt;br&gt;<br>
the&nbsp;round&nbsp;brackets&nbsp;in&nbsp;RE&nbsp;are&nbsp;used&nbsp;to&nbsp;group,&nbsp;in&nbsp;particular&nbsp;to&nbsp;group&nbsp;variants.&lt;br&gt;<br>
If&nbsp;they&nbsp;should&nbsp;be&nbsp;a&nbsp;literal&nbsp;character,&nbsp;they&nbsp;need&nbsp;to&nbsp;be&nbsp;escaped&nbsp;with&nbsp;a&lt;br&gt;<br>
\&nbsp;(backslash).&lt;br&gt;<br>
&lt;br&gt;<br>
Said&nbsp;this,&nbsp;you&nbsp;see&nbsp;both&nbsp;usages&nbsp;--&nbsp;(&nbsp;as&nbsp;grouping&nbsp;meta&nbsp;character,&nbsp;and&nbsp;\(&nbsp;as&lt;br&gt;<br>
literal&nbsp;character&nbsp;--&nbsp;in&nbsp;your&nbsp;visualized&nbsp;picture.&nbsp;You&nbsp;see&nbsp;the&nbsp;literal&nbsp;\(&lt;br&gt;<br>
one&nbsp;only,&nbsp;but&nbsp;not&nbsp;the&nbsp;grouping&nbsp;(&nbsp;in&nbsp;the&nbsp;picture.&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;LDAP&nbsp;round&nbsp;brackets&nbsp;are&nbsp;a&nbsp;core&nbsp;syntax&nbsp;element.&lt;br&gt;<br>
&lt;br&gt;<br>
Does&nbsp;this&nbsp;help?&lt;br&gt;<br>
Achim&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;13.01.2016&nbsp;12:21,&nbsp;Denis&nbsp;Kolegov&nbsp;wrote:&lt;br&gt;<br>
&gt;&nbsp;Hello&nbsp;All.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;am&nbsp;working&nbsp;on&nbsp;RE&nbsp;for&nbsp;LDAP&nbsp;injection.&lt;br&gt;<br>
&gt;&nbsp;Could&nbsp;anybody&nbsp;explain&nbsp;the&nbsp;structure&nbsp;of&nbsp;the&nbsp;LDAP&nbsp;injection&nbsp;detection&nbsp;rule?&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;<br>
https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_40_generic_attacks.conf&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Its&nbsp;regular&nbsp;expression&nbsp;is&nbsp;the&nbsp;following:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;(?:\((?:\W*?(?:objectc(?:ategory|lass)|homedirectory|[gu]idnumber|cn)\b\W*?=|[^\w\x80-\xFF]*?[\!\&amp;\|][^\w\x80-\xFF]*?\()|\)[^\w\x80-\xFF]*?\([^\w\x80-\xFF]*?[\!\&amp;\|])&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;See&nbsp;regular&nbsp;expression&nbsp;visualizer&nbsp;(&lt;a&nbsp;href=&quot;https://jex.im/regulex&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://jex.im/regulex&lt;/a&gt;)&nbsp;screenshot&nbsp;&nbsp;in&lt;br&gt;<br>
&gt;&nbsp;the&nbsp;attachment.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;My&nbsp;questions:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;1.&nbsp;&nbsp;What&nbsp;is&nbsp;the&nbsp;purpose&nbsp;of&nbsp;RE&nbsp;after&nbsp;'('&nbsp;character?&nbsp;Which&nbsp;context&nbsp;is&lt;br&gt;<br>
&gt;&nbsp;supposed&nbsp;there?&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;found&nbsp;the&nbsp;following&nbsp;vectors:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Alonso-Parada&nbsp;vectors:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;foo)(sn=100&lt;br&gt;<br>
&gt;&nbsp;foo)(&amp;)&lt;br&gt;<br>
&gt;&nbsp;documents)(security_level=*))(&amp;(directory=documents&lt;br&gt;<br>
&gt;&nbsp;printer)(uid=*)&lt;br&gt;<br>
&gt;&nbsp;printer)(department=fa*)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;printer)(department=*fa*)&lt;br&gt;<br>
&gt;&nbsp;*)(objectClass=*))(&amp;(objectClass=void&lt;br&gt;<br>
&gt;&nbsp;*)(objectClass=users))(&amp;(objectClass=foo&lt;br&gt;<br>
&gt;&nbsp;void)(objectClass=users))(&amp;(objectClass=void)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Exploit&nbsp;DB:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;ka0x)(|(homedirectory=*)&lt;br&gt;<br>
&gt;&nbsp;5faa0382d747b754)(sn=*&lt;br&gt;<br>
&gt;&nbsp;5faa0382d747b754)!(sn=*&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Burp:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;eb9adbd87d)(sn=*&lt;br&gt;<br>
&gt;&nbsp;eb9adbd87d)!(sn=*&lt;br&gt;<br>
&gt;&nbsp;*)(sn=*&lt;br&gt;<br>
&gt;&nbsp;*)!(sn=*&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;2.&nbsp;&nbsp;Some&nbsp;trivial&nbsp;LDAPi&nbsp;vectors&nbsp;are&nbsp;not&nbsp;detected.&nbsp;For&nbsp;example,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;printer)(uid=*)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;from&nbsp;Alonso-Parada&nbsp;slides&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://www.blackhat.com/presentations/bh-europe-08/Alonso-Parada/Whitepaper/bh-eu-08-alonso-parada-WP.pdf&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;<br>
https://www.blackhat.com/presentations/bh-europe-08/Alonso-Parada/Whitepaper/bh-eu-08-alonso-parada-WP.pdf&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Thanks.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;_______________________________________________&lt;br&gt;<br>
&gt;&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;<br>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;hr&gt;<br>
&lt;span&nbsp;lang=&quot;EN-US&quot;&nbsp;style=&quot;font-style:italic;font-size:10.0pt;font-family:<br>
&quot;Arial&quot;,&quot;sans-serif&quot;;color:maroon;mso-ansi-language:EN-US&quot;&gt;This&nbsp;message&nbsp;and&nbsp;any&nbsp;attachments&nbsp;are&nbsp;intended&nbsp;solely&nbsp;for&nbsp;the&nbsp;addressees&nbsp;and&nbsp;may&nbsp;contain&nbsp;confidential&nbsp;information.&nbsp;Any&nbsp;unauthorized<br>
&nbsp;use&nbsp;or&nbsp;disclosure,&nbsp;either&nbsp;whole&nbsp;or&nbsp;partial,&nbsp;is&nbsp;prohibited.&lt;br&gt;<br>
E-mails&nbsp;are&nbsp;susceptible&nbsp;to&nbsp;alteration.&nbsp;Our&nbsp;company&nbsp;shall&nbsp;not&nbsp;be&nbsp;liable&nbsp;for&nbsp;the&nbsp;message&nbsp;if&nbsp;altered,&nbsp;changed&nbsp;or&nbsp;falsified.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient&nbsp;of&nbsp;this&nbsp;message,&nbsp;please&nbsp;delete&nbsp;it&nbsp;and&nbsp;notify&nbsp;the&nbsp;sender.&lt;br&gt;<br>
Although&nbsp;all&nbsp;reasonable&nbsp;efforts&nbsp;have&nbsp;been&nbsp;made&nbsp;to&nbsp;keep&nbsp;this&nbsp;transmission&nbsp;free&nbsp;from&nbsp;viruses,&nbsp;the&nbsp;sender&nbsp;will&nbsp;not&nbsp;be&nbsp;liable&nbsp;for&nbsp;damages&nbsp;caused&nbsp;by&nbsp;a&nbsp;transmitted&nbsp;virus.&lt;/span&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
