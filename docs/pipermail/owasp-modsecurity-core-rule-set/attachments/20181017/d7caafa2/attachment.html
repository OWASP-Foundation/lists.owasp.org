<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hey&nbsp;guys,&nbsp;hoping&nbsp;you&nbsp;can&nbsp;help&nbsp;me&nbsp;out&nbsp;with&nbsp;a&nbsp;issue&nbsp;I&#39;m&nbsp;having.&nbsp;I&#39;m&nbsp;running&nbsp;OWASP&nbsp;v3&nbsp;with&nbsp;libmodsecurity&nbsp;3.0&nbsp;on&nbsp;top&nbsp;of&nbsp;nginx-1.15.3&nbsp;via&nbsp;Modsecurity-nginx.&nbsp;I&#39;m&nbsp;experiencing&nbsp;false&nbsp;positives&nbsp;of&nbsp;this&nbsp;variety&nbsp;with&nbsp;some&nbsp;regularity.&nbsp;A&nbsp;given&nbsp;request&nbsp;will&nbsp;be&nbsp;403&#39;d,&nbsp;but&nbsp;when&nbsp;I&nbsp;check&nbsp;modsec_audit.log,&nbsp;the&nbsp;only&nbsp;rule&nbsp;violations&nbsp;logged&nbsp;are&nbsp;the&nbsp;two&nbsp;&quot;inbound&nbsp;anomaly&nbsp;score&nbsp;exceeded&quot;&nbsp;codes.&nbsp;The&nbsp;rule&nbsp;that&nbsp;was&nbsp;presumably&nbsp;violated&nbsp;leading&nbsp;to&nbsp;the&nbsp;anomaly&nbsp;score&nbsp;being&nbsp;incremented&nbsp;is&nbsp;not&nbsp;logged&nbsp;at&nbsp;all.&nbsp;Here&#39;s&nbsp;an&nbsp;example:&lt;br&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;---S4x9aI9l---A--&lt;br&gt;[17/Oct/2018:11:41:19&nbsp;-0400]&nbsp;153979087991.549389&nbsp;[ip]&nbsp;61929&nbsp;[ip]&nbsp;443&lt;br&gt;---S4x9aI9l---B--&lt;br&gt;POST&nbsp;/path/file.php?args=args&nbsp;HTTP/2.0&lt;br&gt;accept-encoding:&nbsp;gzip,&nbsp;deflate,&nbsp;br&lt;br&gt;cookie:&nbsp;PHPSESSID=xyz;&nbsp;notBot=notBot;&nbsp;_ga=xyz;&nbsp;73d45a3f924337c011d46201c4a77d88c8b17afce961417c3e4fb7bbce09a31a=0thocmt2erfgbcpmrts35lqgh1;&nbsp;SideMenu=0;&nbsp;SearchLocation=49316;&nbsp;_gid=GA1.2.1268970541.1539790780;&nbsp;Me=xyz;&nbsp;_gat_UA-1302423-1=1&lt;br&gt;accept:&nbsp;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8&lt;br&gt;cache-control:&nbsp;max-age=0&lt;br&gt;user-agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;&nbsp;Intel&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;10_13_6)&nbsp;AppleWebKit/537.36&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Chrome/69.0.3497.100&nbsp;Safari/537.36&lt;br&gt;content-type:&nbsp;multipart/form-data;&nbsp;boundary=----WebKitFormBoundaryCoCuOxmv7pZRNW9G&lt;br&gt;upgrade-insecure-requests:&nbsp;1&lt;br&gt;referer:&nbsp;&lt;a&nbsp;href=&quot;https://www.mydomain.com/path/file.php?args=args&quot;&gt;https://www.mydomain.com/path/file.php?args=args&lt;/a&gt;&lt;br&gt;origin:&nbsp;&lt;a&nbsp;href=&quot;https://www.mydomain.com&quot;&gt;https://www.mydomain.com&lt;/a&gt;&lt;br&gt;content-length:&nbsp;1033&lt;br&gt;host:&nbsp;&lt;a&nbsp;href=&quot;http://www.mydomain.com&quot;&gt;www.mydomain.com&lt;/a&gt;&lt;br&gt;accept-language:&nbsp;en-US,en;q=0.9&lt;br&gt;---S4x9aI9l---D--&lt;br&gt;---S4x9aI9l---E--&lt;br&gt;&lt;html&gt;\x0d\x0a&lt;head&gt;&lt;title&gt;403&nbsp;Forbidden&lt;/title&gt;&lt;/head&gt;\x0d\x0a&lt;body&nbsp;bgcolor=&quot;white&quot;&gt;\x0d\x0a&lt;center&gt;&lt;h1&gt;403&nbsp;Forbidden&lt;/h1&gt;&lt;/center&gt;\x0d\x0a&lt;hr&gt;&lt;center&gt;nginx/1.15.3&lt;/center&gt;\x0d\x0a&lt;/body&gt;\x0d\x0a&lt;/html&gt;\x0d\x0a&lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;\x0d\x0a&lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;\x0d\x0a&lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;\x0d\x0a&lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;\x0d\x0a&lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;\x0d\x0a&lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;\x0d\x0a&lt;br&gt;---S4x9aI9l---F--&lt;br&gt;HTTP/2.0&nbsp;403&lt;br&gt;Server:&nbsp;nginx/1.15.3&lt;br&gt;Date:&nbsp;Wed,&nbsp;17&nbsp;Oct&nbsp;2018&nbsp;15:41:19&nbsp;GMT&lt;br&gt;Content-Length:&nbsp;571&lt;br&gt;Content-Type:&nbsp;text/html&lt;br&gt;Connection:&nbsp;close&lt;br&gt;---S4x9aI9l---H--&lt;br&gt;ModSecurity:&nbsp;Access&nbsp;denied&nbsp;with&nbsp;code&nbsp;403&nbsp;(phase&nbsp;2).&nbsp;Matched&nbsp;&quot;Operator&nbsp;`Ge&#39;&nbsp;with&nbsp;parameter&nbsp;`5&#39;&nbsp;against&nbsp;variable&nbsp;`TX:ANOMALY_SCORE&#39;&nbsp;(Value:&nbsp;`5&#39;&nbsp;)&nbsp;[file&nbsp;&quot;/usr/local/owasp-modsecurity-crs-3.0.0/rules/REQUEST-949-BLOCKING-EVALUATION.conf&quot;]&nbsp;[line&nbsp;&quot;36&quot;]&nbsp;[id&nbsp;&quot;949110&quot;]&nbsp;[rev&nbsp;&quot;&quot;]&nbsp;[msg&nbsp;&quot;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(Total&nbsp;Score:&nbsp;5)&quot;]&nbsp;[data&nbsp;&quot;&quot;]&nbsp;[severity&nbsp;&quot;2&quot;]&nbsp;[ver&nbsp;&quot;&quot;]&nbsp;[maturity&nbsp;&quot;0&quot;]&nbsp;[accuracy&nbsp;&quot;0&quot;]&nbsp;[tag&nbsp;&quot;application-multi&quot;]&nbsp;[tag&nbsp;&quot;language-multi&quot;]&nbsp;[tag&nbsp;&quot;platform-multi&quot;]&nbsp;[tag&nbsp;&quot;attack-generic&quot;]&nbsp;[hostname&nbsp;&quot;173.167.228.139&quot;]&nbsp;[uri&nbsp;&quot;/path/file.php&quot;]&nbsp;[unique_id&nbsp;&quot;153979087991.549389&quot;]&nbsp;[ref&nbsp;&quot;&quot;]&lt;br&gt;ModSecurity:&nbsp;Warning.&nbsp;Matched&nbsp;&quot;Operator&nbsp;`Ge&#39;&nbsp;with&nbsp;parameter&nbsp;`5&#39;&nbsp;against&nbsp;variable&nbsp;`TX:INBOUND_ANOMALY_SCORE&#39;&nbsp;(Value:&nbsp;`5&#39;&nbsp;)&nbsp;[file&nbsp;&quot;/usr/local/owasp-modsecurity-crs-3.0.0/rules/RESPONSE-980-CORRELATION.conf&quot;]&nbsp;[line&nbsp;&quot;61&quot;]&nbsp;[id&nbsp;&quot;980130&quot;]&nbsp;[rev&nbsp;&quot;&quot;]&nbsp;[msg&nbsp;&quot;Inbound&nbsp;Anomaly&nbsp;Score&nbsp;Exceeded&nbsp;(Total&nbsp;Inbound&nbsp;Score:&nbsp;5&nbsp;-&nbsp;SQLI=0,XSS=5,RFI=0,LFI=0,RCE=0,PHPI=0,HTTP=0,SESS=0):&nbsp;XSS&nbsp;Filter&nbsp;-&nbsp;Category&nbsp;5:&nbsp;Disallowed&nbsp;HTML&nbsp;Attributes&quot;]&nbsp;[data&nbsp;&quot;&quot;]&nbsp;[severity&nbsp;&quot;0&quot;]&nbsp;[ver&nbsp;&quot;&quot;]&nbsp;[maturity&nbsp;&quot;0&quot;]&nbsp;[accuracy&nbsp;&quot;0&quot;]&nbsp;[tag&nbsp;&quot;event-correlation&quot;]&nbsp;[hostname&nbsp;&quot;173.167.228.139&quot;]&nbsp;[uri&nbsp;&quot;/path/file.php&quot;]&nbsp;[unique_id&nbsp;&quot;153979087991.549389&quot;]&nbsp;[ref&nbsp;&quot;&quot;]&lt;br&gt;---S4x9aI9l---I--&lt;br&gt;---S4x9aI9l---J--&lt;br&gt;---S4x9aI9l---Z--&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;I&nbsp;know&nbsp;what&nbsp;the&nbsp;issue&nbsp;is&nbsp;-&nbsp;the&nbsp;user&nbsp;is&nbsp;submitting&nbsp;a&nbsp;text&nbsp;field&nbsp;containing&nbsp;HTML&nbsp;tags&nbsp;-&nbsp;but&nbsp;I&#39;m&nbsp;not&nbsp;sure&nbsp;precisely&nbsp;which&nbsp;rule&nbsp;is&nbsp;being&nbsp;triggered,&nbsp;so&nbsp;I&nbsp;can&#39;t&nbsp;figure&nbsp;out&nbsp;how&nbsp;to&nbsp;write&nbsp;a&nbsp;custom&nbsp;rule&nbsp;that&nbsp;disables&nbsp;it&nbsp;for&nbsp;that&nbsp;particular&nbsp;argument.&nbsp;Any&nbsp;help&nbsp;in&nbsp;either&nbsp;determining&nbsp;which&nbsp;rule&nbsp;was&nbsp;triggered&nbsp;or&nbsp;ensuring&nbsp;the&nbsp;rule&nbsp;is&nbsp;logged&nbsp;would&nbsp;be&nbsp;much&nbsp;appreciated.&nbsp;If&nbsp;more&nbsp;information&nbsp;would&nbsp;be&nbsp;helpful,&nbsp;just&nbsp;ask,&nbsp;I&#39;m&nbsp;happy&nbsp;to&nbsp;provide&nbsp;whatever&nbsp;I&nbsp;can.&lt;br&gt;&lt;br&gt;Thanks,&lt;/div&gt;&lt;div&gt;Jonah&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
