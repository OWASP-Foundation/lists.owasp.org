<tt>
&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;Em&nbsp;28/01/2015&nbsp;06:16,&nbsp;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set-request@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set-request@lists.owasp.org&lt;/a&gt;&gt;&nbsp;escreveu:&lt;br&nbsp;type=&quot;attribution&quot;&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Send&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&nbsp;submissions&nbsp;to&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
To&nbsp;subscribe&nbsp;or&nbsp;unsubscribe&nbsp;via&nbsp;the&nbsp;World&nbsp;Wide&nbsp;Web,&nbsp;visit&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
or,&nbsp;via&nbsp;email,&nbsp;send&nbsp;a&nbsp;message&nbsp;with&nbsp;subject&nbsp;or&nbsp;body&nbsp;&#39;help&#39;&nbsp;to&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set-request@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set-request@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
You&nbsp;can&nbsp;reach&nbsp;the&nbsp;person&nbsp;managing&nbsp;the&nbsp;list&nbsp;at&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set-owner@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set-owner@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
When&nbsp;replying,&nbsp;please&nbsp;edit&nbsp;your&nbsp;Subject&nbsp;line&nbsp;so&nbsp;it&nbsp;is&nbsp;more&nbsp;specific&lt;br&gt;<br>
than&nbsp;&quot;Re:&nbsp;Contents&nbsp;of&nbsp;Owasp-modsecurity-core-rule-set&nbsp;digest...&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Today&#39;s&nbsp;Topics:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; 1.&nbsp;Re:&nbsp;Legitimate&nbsp;traffic&nbsp;being&nbsp;blocked&nbsp;(Chaim&nbsp;Sanders)&lt;br&gt;<br>
 &nbsp; 2.&nbsp;Re:&nbsp;Legitimate&nbsp;traffic&nbsp;being &nbsp; &nbsp; &nbsp;blocked&nbsp;(Jacob&nbsp;Lear)&lt;br&gt;<br>
 &nbsp; 3.&nbsp;problem&nbsp;executing&nbsp;external&nbsp;bash &nbsp; script&nbsp;(Sabin&nbsp;Ranjit)&lt;br&gt;<br>
 &nbsp; 4.&nbsp;Re:&nbsp;problem&nbsp;executing&nbsp;external &nbsp; &nbsp;bash&nbsp;script&nbsp;(Sabin&nbsp;Ranjit)&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
----------------------------------------------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;1&lt;br&gt;<br>
Date:&nbsp;Tue,&nbsp;27&nbsp;Jan&nbsp;2015&nbsp;15:56:49&nbsp;+0000&lt;br&gt;<br>
From:&nbsp;Chaim&nbsp;Sanders&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:CSanders@trustwave.com&quot;&gt;CSanders@trustwave.com&lt;/a&gt;&gt;&lt;br&gt;<br>
To:&nbsp;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Legitimate&nbsp;traffic&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;being&nbsp;blocked&lt;br&gt;<br>
Message-ID:&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:F684BDD553BAF1479F5380EDAD3BE371F77877@SKYMB1.trustwave.com&quot;&gt;F684BDD553BAF1479F5380EDAD3BE371F77877@SKYMB1.trustwave.com&lt;/a&gt;&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;iso-8859-1&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
Hello&nbsp;Jacob&nbsp;sorry&nbsp;for&nbsp;the&nbsp;slow&nbsp;response,&lt;br&gt;<br>
Based&nbsp;on&nbsp;your&nbsp;log&nbsp;file&nbsp;it&nbsp;seems&nbsp;clear&nbsp;that&nbsp;you&nbsp;are&nbsp;using&nbsp;an&nbsp;out&nbsp;dated&nbsp;version&nbsp;of&nbsp;CRS.&nbsp;Updating&nbsp;may&nbsp;fix&nbsp;*some*&nbsp;of&nbsp;the&nbsp;false&nbsp;positives&nbsp;you&nbsp;are&nbsp;facing.&nbsp;Upon&nbsp;inspecting&nbsp;your&nbsp;log&nbsp;the&nbsp;following&nbsp;rules&nbsp;are&nbsp;being&nbsp;triggered:&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;Detects&nbsp;concatenated&nbsp;basic&nbsp;SQL&nbsp;Injection&nbsp;and&nbsp;SQLLFI&nbsp;attempts&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;Request&nbsp;from&nbsp;Known&nbsp;SPAM&nbsp;Source&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;Restricted&nbsp;SQL&nbsp;Character&nbsp;anomaly&nbsp;detection&nbsp;alert&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;SQL&nbsp;Injection&nbsp;Attack:&nbsp;SQL&nbsp;Operator&nbsp;Detected&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;Request&nbsp;content&nbsp;type&nbsp;is&nbsp;not&nbsp;allowed&nbsp;by&nbsp;policy&lt;br&gt;<br>
It&nbsp;is&nbsp;possible&nbsp;that&nbsp;some&nbsp;or&nbsp;all&nbsp;of&nbsp;these&nbsp;are&nbsp;false&nbsp;positives&nbsp;based&nbsp;on&nbsp;how&nbsp;the&nbsp;application&nbsp;is&nbsp;functioning.&nbsp;I&nbsp;suggest&nbsp;you&nbsp;follow&nbsp;the&nbsp;guidance&nbsp;set&nbsp;forth&nbsp;in&nbsp;the&nbsp;following&nbsp;blog&nbsp;post&nbsp;(&lt;a&nbsp;href=&quot;http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html&lt;/a&gt;)&nbsp;in&nbsp;order&nbsp;to&nbsp;analyze&nbsp;these&nbsp;events.&nbsp;If&nbsp;you&nbsp;are&nbsp;having&nbsp;additional&nbsp;issues&nbsp;please&nbsp;be&nbsp;sure&nbsp;to&nbsp;reach&nbsp;out&nbsp;and&nbsp;we&nbsp;will&nbsp;try&nbsp;to&nbsp;address&nbsp;them&nbsp;as&nbsp;best&nbsp;as&nbsp;possible.&nbsp;Thanks!&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Chaim&nbsp;Sanders&lt;br&gt;<br>
Security&nbsp;Researcher,&nbsp;SpiderLabs&lt;br&gt;<br>
&lt;br&gt;<br>
Trustwave&nbsp;|&nbsp;SMART&nbsp;SECURITY&nbsp;ON&nbsp;DEMAND&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.trustwave.com&quot;&nbsp;target=&quot;_blank&quot;&gt;www.trustwave.com&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
-----Original&nbsp;Message-----&lt;br&gt;<br>
From:&nbsp;Ryan&nbsp;Barnett&lt;br&gt;<br>
Sent:&nbsp;Tuesday,&nbsp;January&nbsp;27,&nbsp;2015&nbsp;10:04&nbsp;AM&lt;br&gt;<br>
To:&nbsp;Chaim&nbsp;Sanders&lt;br&gt;<br>
Subject:&nbsp;FW:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Legitimate&nbsp;traffic&nbsp;being&nbsp;blocked&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;1/23/15,&nbsp;6:20&nbsp;PM,&nbsp;&quot;Jacob&nbsp;Lear&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:jacob@fosterclub.com&quot;&gt;jacob@fosterclub.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;Hello,&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;I&nbsp;am&nbsp;working&nbsp;on&nbsp;setting&nbsp;up&nbsp;better&nbsp;security&nbsp;for&nbsp;my&nbsp;Debian&nbsp;6&nbsp;server.&nbsp;I&nbsp;am&lt;br&gt;<br>
&gt;new&nbsp;to&nbsp;ModSecurity&nbsp;and&nbsp;OWASP&nbsp;Core&nbsp;Rules.&nbsp;The&nbsp;problem&nbsp;that&nbsp;I&#39;m&nbsp;having&nbsp;is&lt;br&gt;<br>
&gt;that&nbsp;it&nbsp;is&nbsp;blocking&nbsp;legitimate&nbsp;traffic&nbsp;and&nbsp;I&nbsp;don&#39;t&nbsp;understand&nbsp;why&nbsp;or&lt;br&gt;<br>
&gt;how&nbsp;to&nbsp;fix&nbsp;it.&nbsp;Can&nbsp;somebody&nbsp;help&nbsp;me?&nbsp;Here&nbsp;is&nbsp;some&nbsp;pretty&nbsp;detailed&lt;br&gt;<br>
&gt;information&nbsp;about&nbsp;my&nbsp;environment&nbsp;and&nbsp;my&nbsp;problem.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;Apache2&nbsp;is&nbsp;my&nbsp;webserver&nbsp;and&nbsp;it&nbsp;is&nbsp;installed&nbsp;from&nbsp;the&nbsp;Debian&nbsp;package.&lt;br&gt;<br>
&gt;The&nbsp;version&nbsp;is&nbsp;2.2.16-6+squeeze14.&nbsp;I&#39;m&nbsp;using&nbsp;the&nbsp;Worker&nbsp;MPM.&lt;br&gt;<br>
&gt;I&nbsp;installed&nbsp;ModSecurity&nbsp;from&nbsp;the&nbsp;Debian&nbsp;package.&nbsp;The&nbsp;version&nbsp;is:&lt;br&gt;<br>
&gt;2.5.12-1+squeeze4&lt;br&gt;<br>
&gt;Per&nbsp;the&nbsp;recommendation&nbsp;of&nbsp;an&nbsp;article&nbsp;I&nbsp;found&nbsp;online,&nbsp;I&nbsp;installed&nbsp;OWASP&lt;br&gt;<br>
&gt;2.2.5-0.&nbsp;I&nbsp;had&nbsp;initially&nbsp;tried&nbsp;the&nbsp;most&nbsp;recent&nbsp;version&nbsp;of&nbsp;OWASP&nbsp;but&lt;br&gt;<br>
&gt;this&nbsp;gave&nbsp;me&nbsp;errors&nbsp;(due&nbsp;to&nbsp;my&nbsp;version&nbsp;of&nbsp;ModSecurity).&lt;br&gt;<br>
&gt;I&#39;m&nbsp;using&nbsp;PHP&nbsp;compiled&nbsp;from&nbsp;source,&nbsp;version&nbsp;5.4.24.&lt;br&gt;<br>
&gt;I&#39;m&nbsp;using&nbsp;PHP-FPM&nbsp;FastCGI.&lt;br&gt;<br>
&gt;I&#39;m&nbsp;using&nbsp;MySQL&nbsp;5.1.73-1+deb6u1.&lt;br&gt;<br>
&gt;I&#39;m&nbsp;using&nbsp;Memcached&nbsp;2.1.0.&lt;br&gt;<br>
&gt;ZendOpcode&nbsp;Cache&nbsp;7.0.3&nbsp;is&nbsp;installed.&lt;br&gt;<br>
&gt;Website&nbsp;is&nbsp;built&nbsp;using&nbsp;the&nbsp;Drupal&nbsp;CMS,&nbsp;version&nbsp;7.28.&lt;br&gt;<br>
&gt;All&nbsp;non-SSL&nbsp;traffic&nbsp;is&nbsp;redirected&nbsp;to&nbsp;SSL.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;I&nbsp;had&nbsp;some&nbsp;troubles&nbsp;getting&nbsp;Apache2&nbsp;to&nbsp;pass&nbsp;the&nbsp;configtest&nbsp;but&nbsp;I&nbsp;was&lt;br&gt;<br>
&gt;able&nbsp;to&nbsp;find&nbsp;the&nbsp;proper&nbsp;configuration&nbsp;changes&nbsp;needed&nbsp;via&nbsp;Google&lt;br&gt;<br>
&gt;searching.&nbsp;I&nbsp;enabled&nbsp;all&nbsp;of&nbsp;the&nbsp;rules&nbsp;as&nbsp;per&nbsp;the&nbsp;INSTALL&nbsp;instructions&lt;br&gt;<br>
&gt;included&nbsp;in&nbsp;OWASP&nbsp;CRS.&nbsp;I&nbsp;also&nbsp;enabled&nbsp;the&nbsp;experimental&nbsp;Brute&nbsp;Force,&lt;br&gt;<br>
&gt;DOS,&nbsp;and&nbsp;Slow&nbsp;DOS&nbsp;rules&nbsp;(these&nbsp;don&#39;t&nbsp;appear&nbsp;to&nbsp;be&nbsp;causing&nbsp;any&nbsp;issues.)&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;I&nbsp;set&nbsp;ModSecurity&nbsp;to&nbsp;&quot;On&quot;&nbsp;mode&nbsp;but&nbsp;quickly&nbsp;got&nbsp;complaints&nbsp;from&nbsp;our&lt;br&gt;<br>
&gt;staff&nbsp;being&nbsp;blocked&nbsp;by&nbsp;it.&nbsp;So&nbsp;now&nbsp;it&nbsp;is&nbsp;in&nbsp;&quot;DetectionOnly&quot;&nbsp;mode.&nbsp;I&lt;br&gt;<br>
&gt;looked&nbsp;in&nbsp;the&nbsp;AuditLog&nbsp;but&nbsp;didn&#39;t&nbsp;see&nbsp;anything&nbsp;helpful&nbsp;in&nbsp;there&nbsp;(just&nbsp;a&lt;br&gt;<br>
&gt;bunch&nbsp;of&nbsp;stuff&nbsp;about&nbsp;cookies&nbsp;--&nbsp;perhaps&nbsp;because&nbsp;things&nbsp;in&nbsp;the&nbsp;10&nbsp;setup&lt;br&gt;<br>
&gt;file&nbsp;are&nbsp;set&nbsp;to&nbsp;nolog?).&nbsp;However,&nbsp;the&nbsp;Apache2&nbsp;SSL&nbsp;Error&nbsp;log&nbsp;shows&nbsp;a&nbsp;lot&lt;br&gt;<br>
&gt;of&nbsp;information&nbsp;about&nbsp;the&nbsp;block&nbsp;attempts.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;Our&nbsp;staff&nbsp;users&nbsp;are&nbsp;connecting&nbsp;from&nbsp;the&nbsp;IP&nbsp;address&nbsp;63.227.218.204,&nbsp;so&nbsp;I&lt;br&gt;<br>
&gt;filtered&nbsp;the&nbsp;SSL&nbsp;Error&nbsp;Log&nbsp;to&nbsp;dump&nbsp;all&nbsp;entries&nbsp;with&nbsp;that&nbsp;IP&nbsp;address&nbsp;to&lt;br&gt;<br>
&gt;a&nbsp;separate&nbsp;file.&nbsp;All&nbsp;of&nbsp;the&nbsp;warnings/errors&nbsp;in&nbsp;this&nbsp;log&nbsp;are&nbsp;legitimate&lt;br&gt;<br>
&gt;traffic.&nbsp;So&nbsp;I&nbsp;need&nbsp;help&nbsp;tuning&nbsp;ModSecurity&nbsp;and&nbsp;OWASP&nbsp;to&nbsp;permit&nbsp;this&lt;br&gt;<br>
&gt;traffic.&nbsp;I&#39;ve&nbsp;attached&nbsp;the&nbsp;log&nbsp;file&nbsp;to&nbsp;this&nbsp;post.&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&quot;&nbsp;target=&quot;_blank&quot;&gt;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&lt;/a&gt;&lt;br&gt;<br>
&gt;GhD&lt;br&gt;<br>
&gt;Vv7Jp46g&amp;s=5&amp;u=https%3a%2f%2fwww%2efosterclub%2ecom%2fsites%2fdefault%2&lt;br&gt;<br>
&gt;ffi&lt;br&gt;<br>
&gt;les%2ffile%2foutput%2elog&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;I&nbsp;have&nbsp;also&nbsp;attached&nbsp;my&nbsp;modsecurity.conf&nbsp;file&nbsp;and&nbsp;my&lt;br&gt;<br>
&gt;modsecurity_crs_10_setup.conf&nbsp;file.&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&quot;&nbsp;target=&quot;_blank&quot;&gt;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&lt;/a&gt;&lt;br&gt;<br>
&gt;GhD&lt;br&gt;<br>
&gt;Ns5sp46Q&amp;s=5&amp;u=https%3a%2f%2fwww%2efosterclub%2ecom%2fsites%2fdefault%2&lt;br&gt;<br>
&gt;ffi&lt;br&gt;<br>
&gt;les%2ffile%2fmodsecurity%2econf&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&quot;&nbsp;target=&quot;_blank&quot;&gt;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&lt;/a&gt;&lt;br&gt;<br>
&gt;GhG&lt;br&gt;<br>
&gt;Vrusp95w&amp;s=5&amp;u=https%3a%2f%2fwww%2efosterclub%2ecom%2fsites%2fdefault%2&lt;br&gt;<br>
&gt;ffi&nbsp;les%2ffile%2fmodsecurity%5fcrs%5f10%5fsetup%2econf&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;I&nbsp;would&nbsp;very&nbsp;much&nbsp;appreciate&nbsp;any&nbsp;help&nbsp;anyone&nbsp;can&nbsp;offer.&nbsp;Please&nbsp;let&nbsp;me&lt;br&gt;<br>
&gt;know&nbsp;if&nbsp;you&nbsp;need&nbsp;any&nbsp;additional&nbsp;information.&nbsp;Thanks!&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;--&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;Jacob&nbsp;Lear&lt;br&gt;<br>
&gt;Web&nbsp;Administrator&lt;br&gt;<br>
&gt;FosterClub,&nbsp;Inc.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;---&lt;br&gt;<br>
&gt;This&nbsp;email&nbsp;has&nbsp;been&nbsp;checked&nbsp;for&nbsp;viruses&nbsp;by&nbsp;Avast&nbsp;antivirus&nbsp;software.&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&quot;&nbsp;target=&quot;_blank&quot;&gt;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&lt;/a&gt;&lt;br&gt;<br>
&gt;GhG&nbsp;Ey688p7w&amp;s=5&amp;u=http%3a%2f%2fwww%2eavast%2ecom&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;_______________________________________________&lt;br&gt;<br>
&gt;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&lt;a&nbsp;href=&quot;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&quot;&nbsp;target=&quot;_blank&quot;&gt;http://scanmail.trustwave.com/?c=4062&amp;d=rNzC1FWzzHEEgobdigSUf2LNp5DNTN-&lt;/a&gt;&lt;br&gt;<br>
&gt;GhG&lt;br&gt;<br>
&gt;Q65sp85w&amp;s=5&amp;u=https%3a%2f%2flists%2eowasp%2eorg%2fmailman%2flistinfo%2&lt;br&gt;<br>
&gt;fow&lt;br&gt;<br>
&gt;asp-modsecurity-core-rule-set&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
________________________________&lt;br&gt;<br>
&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;2&lt;br&gt;<br>
Date:&nbsp;Tue,&nbsp;27&nbsp;Jan&nbsp;2015&nbsp;18:41:09&nbsp;-0800&lt;br&gt;<br>
From:&nbsp;Jacob&nbsp;Lear&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:jacob@fosterclub.com&quot;&gt;jacob@fosterclub.com&lt;/a&gt;&gt;&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Legitimate&nbsp;traffic&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;being &nbsp; blocked&lt;br&gt;<br>
Message-ID:&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:54C84C45.6030009@fosterclub.com&quot;&gt;54C84C45.6030009@fosterclub.com&lt;/a&gt;&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=utf-8;&nbsp;format=flowed&lt;br&gt;<br>
&lt;br&gt;<br>
Hi&nbsp;Chaim,&lt;br&gt;<br>
&lt;br&gt;<br>
thanks&nbsp;for&nbsp;the&nbsp;response.&nbsp;I&nbsp;actually&nbsp;did&nbsp;stumble&nbsp;across&nbsp;that&nbsp;blog&nbsp;post&lt;br&gt;<br>
and&nbsp;tried&nbsp;to&nbsp;write&nbsp;some&nbsp;exceptions&nbsp;to&nbsp;get&nbsp;things&nbsp;working.&nbsp;There&nbsp;are&nbsp;SO&lt;br&gt;<br>
many&nbsp;exceptions&nbsp;needed&nbsp;though!&nbsp;I&nbsp;think&nbsp;I&nbsp;will&nbsp;try&nbsp;removing&nbsp;the&nbsp;DEB/RPM&lt;br&gt;<br>
of&nbsp;ModSecurity&nbsp;and&nbsp;try&nbsp;installing&nbsp;it&nbsp;from&nbsp;source.&nbsp;That&nbsp;way&nbsp;I&nbsp;will&nbsp;be&lt;br&gt;<br>
able&nbsp;to&nbsp;install&nbsp;the&nbsp;most&nbsp;recent&nbsp;version&nbsp;of&nbsp;CRS.&lt;br&gt;<br>
&lt;br&gt;<br>
So&nbsp;far&nbsp;this&nbsp;is&nbsp;what&nbsp;I&#39;ve&nbsp;written&nbsp;for&nbsp;exceptions.&nbsp;Am&nbsp;I&nbsp;doing&nbsp;it&nbsp;correctly??&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;modsecurity_crs_15_customerules.conf:&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@rx&nbsp;/node/*/edit&quot;&lt;br&gt;<br>
&quot;phase:1,t:none,nolog,pass,ctl:ruleRemoveById=981173&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@streq&nbsp;/civicrm/contribute/search&quot;&lt;br&gt;<br>
&quot;phase:1,t:none,nolog,pass,ctl:ruleRemoveById=981173&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@streq&nbsp;/civicrm/ajax/inline&quot;&lt;br&gt;<br>
&quot;phase:1,t:none,nolog,pass,ctl:ruleRemoveById=981173&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
In&nbsp;modsecurity_crs_48_local_exceptions.conf:&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@rx&nbsp;/node/*/edit&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;TX:&#39;/^960010/&#39;&nbsp;&quot;@streq&nbsp;Item&nbsp;1=1&quot;&nbsp;&quot;chain,t:none&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@rx&nbsp;/node/*/edit&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;TX:&#39;/^950109/&#39;&nbsp;&quot;@streq&nbsp;Item&nbsp;1=1&quot;&nbsp;&quot;chain,t:none&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-2&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^950901.*ARGS:body[und][0][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^960024.*ARGS:body[und][0][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^960024.*ARGS:metatags[title][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^960024.*ARGS:metatags[title][default]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981257.*ARGS:body[und][0][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981245.*ARGS:body[und][0][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981245.*ARGS:metatags[dcterms.rights][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981245.*ARGS:metatags[dcterms.rights][default]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981245.*ARGS:metatags[copyright][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981245.*ARGS:metatags[copyright][default]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981243.*ARGS:metatags[dcterms.rights][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981243.*ARGS:metatags[dcterms.rights][default]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981243.*ARGS:metatags[copyright][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981243.*ARGS:metatags[copyright][default]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973300.*ARGS:body[und][0][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973304.*ARGS:body[und][0][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973333.*ARGS:body[und][0][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973302.*ARGS:metatags[dcterms.format][value]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973302.*ARGS:metatags[dcterms.format][default]/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@streq&nbsp;/modules/statistics/statistics.php&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;TX:&#39;/^960010/&#39;&nbsp;&quot;@streq&nbsp;Item&nbsp;1=1&quot;&nbsp;&quot;chain,t:none&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@streq&nbsp;/ckeditor/xss&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;TX:&#39;/^960010/&#39;&nbsp;&quot;@streq&nbsp;Item&nbsp;1=1&quot;&nbsp;&quot;chain,t:none&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;@streq&nbsp;/ckeditor/xss&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;TX:&#39;/^950109/&#39;&nbsp;&quot;@streq&nbsp;Item&nbsp;1=1&quot;&nbsp;&quot;chain,t:none&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-2&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^950901.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^960024.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981173.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981257.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981245.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973300.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973304.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^973333.*ARGS:text/&#39;&nbsp;&quot;.*&quot;&nbsp;&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981172.*REQUEST_COOKIES:CHOCOLATECHIPSSL/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-3&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981247.*ARGS:crmasmSelect0/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981247.*ARGS:crmasmSelect1/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981247.*ARGS:crmasmSelect2/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981247.*ARGS:crmasmSelect3/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;TX:&#39;/^981247.*ARGS:crmasmSelect4/&#39;&nbsp;&quot;.*&quot;&lt;br&gt;<br>
&quot;chain,phase:2,t:none,nolog,pass&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; SecRule&nbsp;MATCHED_VAR_NAME&nbsp;&quot;TX\:(.*)&quot;&lt;br&gt;<br>
&quot;capture,t:none,setvar:!tx.%{tx.1},setvar:tx.anomaly_score=-5&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
--&lt;br&gt;<br>
&lt;br&gt;<br>
Jacob&nbsp;Lear&lt;br&gt;<br>
Web&nbsp;Administrator&lt;br&gt;<br>
FosterClub,&nbsp;Inc.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
---&lt;br&gt;<br>
This&nbsp;email&nbsp;has&nbsp;been&nbsp;checked&nbsp;for&nbsp;viruses&nbsp;by&nbsp;Avast&nbsp;antivirus&nbsp;software.&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.avast.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.avast.com&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;3&lt;br&gt;<br>
Date:&nbsp;Wed,&nbsp;28&nbsp;Jan&nbsp;2015&nbsp;13:27:57&nbsp;+0545&lt;br&gt;<br>
From:&nbsp;Sabin&nbsp;Ranjit&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:think.sabin@gmail.com&quot;&gt;think.sabin@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;href=&quot;mailto:mod-security-users@lists.sourceforge.net&quot;&gt;mod-security-users@lists.sourceforge.net&lt;/a&gt;,&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;problem&nbsp;executing&nbsp;external&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;bash &nbsp; &nbsp;script&lt;br&gt;<br>
Message-ID:&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;CAE9Kp-Ybfvhs8BEsPaR==&lt;a&nbsp;href=&quot;mailto:Pi06-AT8pi7MxLm73A%2B%2BDpj%2BfFfgA@mail.gmail.com&quot;&gt;Pi06-AT8pi7MxLm73A++Dpj+fFfgA@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;utf-8&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
hi,&lt;br&gt;<br>
I&#39;m&nbsp;trying&nbsp;to&nbsp;send&nbsp;email&nbsp;when&nbsp;specific&nbsp;rule&nbsp;get&nbsp;matched&nbsp;in&nbsp;the&nbsp;modsecurity&lt;br&gt;<br>
but&nbsp;the&nbsp;modsecurity&nbsp;gives&nbsp;execution&nbsp;error&nbsp;in&nbsp;the&nbsp;mod_audit.log.&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;have&nbsp;written&nbsp;my&nbsp;own&nbsp;test&nbsp;rule&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&quot;FAKE-USER&quot;&lt;br&gt;<br>
&quot;chain,deny,log,exec:/root/send_alert_email_fake-user.sh,id:1234123455&quot;&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;^192\.168\.203\.141&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
and&nbsp;my&nbsp;script&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
#!/bin/sh&lt;br&gt;<br>
echo&nbsp;&quot;Fake&nbsp;user&nbsp;tried&nbsp;to&nbsp;access&nbsp;the&nbsp;web&nbsp;application&quot;&nbsp;|mail&nbsp;-s&nbsp;&quot;local&nbsp;server&lt;br&gt;<br>
under&nbsp;attack&quot;&nbsp;&lt;a&nbsp;href=&quot;mailto:user@user.com&quot;&gt;user@user.com&lt;/a&gt;&lt;br&gt;<br>
echo&nbsp;Done.&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;mod_audit.log&nbsp;is&nbsp;giving&nbsp;this&nbsp;message&nbsp;and&nbsp;email&nbsp;is&nbsp;being&nbsp;send.&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;Exec:&nbsp;Execution&nbsp;failed&nbsp;while&nbsp;reading&nbsp;output:&lt;br&gt;<br>
/root/send_alert_email_fake-user.sh&nbsp;(End&nbsp;of&nbsp;file&nbsp;found)&lt;br&gt;<br>
Message:&nbsp;Failed&nbsp;to&nbsp;execute:&nbsp;/root/send_alert_email_fake-user.sh&lt;br&gt;<br>
Message:&nbsp;Warning.&nbsp;Pattern&nbsp;match&nbsp;&quot;^192\\.168\\.203\\.141&quot;&nbsp;at&nbsp;REMOTE_ADDR.&lt;br&gt;<br>
[file&lt;br&gt;<br>
&quot;/usr/share/modsecurity-crs/activated_rules/check_user_agent_email.conf&quot;]&lt;br&gt;<br>
[line&nbsp;&quot;1&quot;]&nbsp;[id&nbsp;&quot;1234123455&quot;]&lt;br&gt;<br>
&lt;br&gt;<br>
Please&nbsp;help&nbsp;me&nbsp;to&nbsp;fix&nbsp;this?&nbsp;I&#39;m&nbsp;also&nbsp;referencing&nbsp;ModSecurity&nbsp;2.5&nbsp;by&nbsp;Magnus&lt;br&gt;<br>
Mischel.&lt;br&gt;<br>
&lt;br&gt;<br>
thanks.&lt;br&gt;<br>
--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
An&nbsp;HTML&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
URL:&nbsp;&lt;&lt;a&nbsp;href=&quot;http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150128/286d00f4/attachment-0001.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150128/286d00f4/attachment-0001.html&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
Message:&nbsp;4&lt;br&gt;<br>
Date:&nbsp;Wed,&nbsp;28&nbsp;Jan&nbsp;2015&nbsp;13:54:26&nbsp;+0545&lt;br&gt;<br>
From:&nbsp;Sabin&nbsp;Ranjit&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:think.sabin@gmail.com&quot;&gt;think.sabin@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
To:&nbsp;&lt;a&nbsp;href=&quot;mailto:mod-security-users@lists.sourceforge.net&quot;&gt;mod-security-users@lists.sourceforge.net&lt;/a&gt;,&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
Subject:&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;problem&nbsp;executing&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;external &nbsp; &nbsp; &nbsp; &nbsp;bash&nbsp;script&lt;br&gt;<br>
Message-ID:&lt;br&gt;<br>
 &nbsp; &nbsp; &nbsp; &nbsp;&lt;CAE9Kp-Y52o=&lt;a&nbsp;href=&quot;mailto:Gt5dU_aMk3QuPrpvu26FzLLKoZ7Z7u0sSMV9C3Q@mail.gmail.com&quot;&gt;Gt5dU_aMk3QuPrpvu26FzLLKoZ7Z7u0sSMV9C3Q@mail.gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
Content-Type:&nbsp;text/plain;&nbsp;charset=&quot;utf-8&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
email&nbsp;is&nbsp;not&nbsp;being&nbsp;send.&lt;br&gt;<br>
&lt;br&gt;<br>
On&nbsp;Wed,&nbsp;Jan&nbsp;28,&nbsp;2015&nbsp;at&nbsp;1:27&nbsp;PM,&nbsp;Sabin&nbsp;Ranjit&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:think.sabin@gmail.com&quot;&gt;think.sabin@gmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;hi,&lt;br&gt;<br>
&gt;&nbsp;I&#39;m&nbsp;trying&nbsp;to&nbsp;send&nbsp;email&nbsp;when&nbsp;specific&nbsp;rule&nbsp;get&nbsp;matched&nbsp;in&nbsp;the&nbsp;modsecurity&lt;br&gt;<br>
&gt;&nbsp;but&nbsp;the&nbsp;modsecurity&nbsp;gives&nbsp;execution&nbsp;error&nbsp;in&nbsp;the&nbsp;mod_audit.log.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;have&nbsp;written&nbsp;my&nbsp;own&nbsp;test&nbsp;rule&nbsp;like&nbsp;this:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&quot;FAKE-USER&quot;&lt;br&gt;<br>
&gt;&nbsp;&quot;chain,deny,log,exec:/root/send_alert_email_fake-user.sh,id:1234123455&quot;&lt;br&gt;<br>
&gt; &nbsp; &nbsp; &nbsp; &nbsp; SecRule&nbsp;REMOTE_ADDR&nbsp;&quot;^192\.168\.203\.141&quot;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;and&nbsp;my&nbsp;script&nbsp;looks&nbsp;like&nbsp;this:&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;#!/bin/sh&lt;br&gt;<br>
&gt;&nbsp;echo&nbsp;&quot;Fake&nbsp;user&nbsp;tried&nbsp;to&nbsp;access&nbsp;the&nbsp;web&nbsp;application&quot;&nbsp;|mail&nbsp;-s&nbsp;&quot;local&lt;br&gt;<br>
&gt;&nbsp;server&nbsp;under&nbsp;attack&quot;&nbsp;&lt;a&nbsp;href=&quot;mailto:user@user.com&quot;&gt;user@user.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;echo&nbsp;Done.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;The&nbsp;mod_audit.log&nbsp;is&nbsp;giving&nbsp;this&nbsp;message&nbsp;and&nbsp;email&nbsp;is&nbsp;being&nbsp;send.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Message:&nbsp;Exec:&nbsp;Execution&nbsp;failed&nbsp;while&nbsp;reading&nbsp;output:&lt;br&gt;<br>
&gt;&nbsp;/root/send_alert_email_fake-user.sh&nbsp;(End&nbsp;of&nbsp;file&nbsp;found)&lt;br&gt;<br>
&gt;&nbsp;Message:&nbsp;Failed&nbsp;to&nbsp;execute:&nbsp;/root/send_alert_email_fake-user.sh&lt;br&gt;<br>
&gt;&nbsp;Message:&nbsp;Warning.&nbsp;Pattern&nbsp;match&nbsp;&quot;^192\\.168\\.203\\.141&quot;&nbsp;at&nbsp;REMOTE_ADDR.&lt;br&gt;<br>
&gt;&nbsp;[file&lt;br&gt;<br>
&gt;&nbsp;&quot;/usr/share/modsecurity-crs/activated_rules/check_user_agent_email.conf&quot;]&lt;br&gt;<br>
&gt;&nbsp;[line&nbsp;&quot;1&quot;]&nbsp;[id&nbsp;&quot;1234123455&quot;]&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;Please&nbsp;help&nbsp;me&nbsp;to&nbsp;fix&nbsp;this?&nbsp;I&#39;m&nbsp;also&nbsp;referencing&nbsp;ModSecurity&nbsp;2.5&nbsp;by&nbsp;Magnus&lt;br&gt;<br>
&gt;&nbsp;Mischel.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&nbsp;thanks.&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
&gt;&lt;br&gt;<br>
--------------&nbsp;next&nbsp;part&nbsp;--------------&lt;br&gt;<br>
An&nbsp;HTML&nbsp;attachment&nbsp;was&nbsp;scrubbed...&lt;br&gt;<br>
URL:&nbsp;&lt;&lt;a&nbsp;href=&quot;http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150128/75131767/attachment.html&quot;&nbsp;target=&quot;_blank&quot;&gt;http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20150128/75131767/attachment.html&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
------------------------------&lt;br&gt;<br>
&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
End&nbsp;of&nbsp;Owasp-modsecurity-core-rule-set&nbsp;Digest,&nbsp;Vol&nbsp;69,&nbsp;Issue&nbsp;3&lt;br&gt;<br>
**************************************************************&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>

</tt>
