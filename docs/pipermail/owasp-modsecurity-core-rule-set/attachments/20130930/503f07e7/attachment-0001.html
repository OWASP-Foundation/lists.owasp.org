<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;After&nbsp;years&nbsp;of&nbsp;running&nbsp;WAFs&nbsp;using&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;I&nbsp;wanted&nbsp;a&nbsp;way&nbsp;to&nbsp;detect&lt;br&gt;&lt;div&gt;&lt;div&gt;known&nbsp;malicious&nbsp;users&nbsp;before&nbsp;they&nbsp;get&nbsp;a&nbsp;chance&nbsp;to&nbsp;send&nbsp;their&nbsp;attack&nbsp;payloads.&lt;/div&gt;&lt;div&gt;Normally,&nbsp;when&nbsp;an&nbsp;attacker&nbsp;sends&nbsp;their&nbsp;payload,&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;request&nbsp;are&nbsp;checked&nbsp;via&nbsp;ModSecurity&nbsp;using&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;(CRS).&nbsp;The&nbsp;CRS&nbsp;is&nbsp;essentially&nbsp;a&nbsp;large&nbsp;black&nbsp;list&nbsp;which&nbsp;means&nbsp;that&nbsp;the&nbsp;payload&nbsp;either&nbsp;matches&nbsp;or&nbsp;passes.&nbsp;There &lt;/div&gt;<br>
&lt;div&gt;is&nbsp;no&nbsp;middle&nbsp;ground.&nbsp;Attackers&nbsp;normally&nbsp;perform&nbsp;reconnaissance&nbsp;before&nbsp;they&lt;/div&gt;&lt;div&gt;attack&nbsp;which&nbsp;may&nbsp;or&nbsp;may&nbsp;not&nbsp;contain&nbsp;malicious&nbsp;payloads.&nbsp;Ideally&nbsp;we&nbsp;want&nbsp;to&nbsp;stop&lt;/div&gt;&lt;div&gt;known&nbsp;malicious&nbsp;attackers&nbsp;as&nbsp;early&nbsp;as&nbsp;possible,&nbsp;i.e.&nbsp;via&nbsp;an&nbsp;IP&nbsp;reputation &lt;/div&gt;<br>
&lt;div&gt;background&nbsp;check,&nbsp;and&nbsp;not&nbsp;wait&nbsp;for&nbsp;them&nbsp;to&nbsp;send&nbsp;their&nbsp;attack.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;As&nbsp;a&nbsp;result,&nbsp;I&nbsp;started&nbsp;on&nbsp;the&nbsp;Open&nbsp;Fraud&nbsp;Detection&nbsp;Project&nbsp;(OFDEP)&nbsp;which&nbsp;aims&nbsp;at &lt;/div&gt;&lt;div&gt;providing&nbsp;a&nbsp;free&nbsp;community&nbsp;supported&nbsp;API&nbsp;that&nbsp;ModSecurity&nbsp;can&nbsp;query&nbsp;to&nbsp;receive&lt;/div&gt;<br>
&lt;div&gt;a&nbsp;score&nbsp;indicating&nbsp;the&nbsp;odds&nbsp;that&nbsp;a&nbsp;given&nbsp;user&nbsp;/&nbsp;transaction&nbsp;is&nbsp;bad.&nbsp;The&nbsp;WAF&nbsp;can&lt;/div&gt;&lt;div&gt;then&nbsp;make&nbsp;a&nbsp;decision&nbsp;on&nbsp;how&nbsp;to&nbsp;proceed&nbsp;based&nbsp;on&nbsp;the&nbsp;score.&nbsp;At&nbsp;the&nbsp;moment&nbsp;the&lt;/div&gt;&lt;div&gt;API&nbsp;is&nbsp;Beta&nbsp;quality&nbsp;and&nbsp;supports&nbsp;IP,&nbsp;email&nbsp;address&nbsp;and&nbsp;username&nbsp;lookups.&nbsp;Query&lt;/div&gt;<br>
&lt;div&gt;results&nbsp;are&nbsp;currently&nbsp;returned&nbsp;in&nbsp;XML&nbsp;but&nbsp;JSON&nbsp;will&nbsp;be&nbsp;supported&nbsp;shortly.&nbsp;The &lt;/div&gt;&lt;div&gt;most&nbsp;common&nbsp;use&nbsp;cases&nbsp;that&nbsp;I&nbsp;tried&nbsp;to&nbsp;cover&nbsp;are:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;o&nbsp;IP&nbsp;reputation&lt;/div&gt;&lt;div&gt;o&nbsp;comment&nbsp;spam&lt;/div&gt;&lt;div&gt;o&nbsp;account&nbsp;creation&nbsp;fraud&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;For&nbsp;specific&nbsp;API&nbsp;details&nbsp;see:&nbsp;&lt;a&nbsp;href=&quot;http://wafsec.com/api.html&quot;&gt;http://wafsec.com/api.html&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;--&lt;/div&gt;&lt;div&gt; -&nbsp;Josh&lt;/div&gt;&lt;/div&gt;<br>

</tt>
