<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;12pt;<br>
font-family:Calibri<br>
}<br>
--&gt;&lt;/style&gt;&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;There&nbsp;is&nbsp;not&nbsp;an&nbsp;entry&nbsp;listed&nbsp;in&nbsp;the&nbsp;event&nbsp;log&nbsp;for&nbsp;a&nbsp;missing&nbsp;file.&nbsp;&nbsp;&lt;/span&gt;&lt;BR&gt;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&nbsp;&lt;br&gt;I&nbsp;gave&nbsp;&quot;IIS&nbsp;AppPool\DefaultAppPool&quot;&nbsp;full&nbsp;control&nbsp;over&nbsp;the&nbsp;data&nbsp;files&nbsp;as&nbsp;I'm&nbsp;using&nbsp;IIS&nbsp;7.5.&nbsp;&nbsp;Same&nbsp;result.&lt;BR&gt;&nbsp;&lt;br&gt;I&nbsp;also&nbsp;tried&nbsp;adding&nbsp;&quot;Network&nbsp;Service&quot;,&nbsp;even&nbsp;through&nbsp;I'm&nbsp;pretty&nbsp;sure&nbsp;that&nbsp;is&nbsp;wrong.&nbsp;&nbsp;Still&nbsp;no&nbsp;love.&lt;br&gt;&nbsp;&lt;br&gt;Bill&lt;br&gt;&lt;/span&gt;&lt;br&gt;&nbsp;&lt;BR&gt;&lt;div&gt;&lt;div&nbsp;id=&quot;SkyDrivePlaceholder&quot;&gt;&lt;/div&gt;&lt;hr&nbsp;id=&quot;stopSpelling&quot;&gt;From:&nbsp;Greg.Wroblewski@microsoft.com&lt;br&gt;To:&nbsp;RBarnett@trustwave.com;&nbsp;consume_@hotmail.com&lt;br&gt;CC:&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;br&gt;Subject:&nbsp;RE:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;@pmFromFile&nbsp;fails&nbsp;when&nbsp;using&nbsp;IIS&nbsp;along&nbsp;with&nbsp;modsecurity&nbsp;2.7.0-RC2&lt;br&gt;Date:&nbsp;Thu,&nbsp;9&nbsp;Aug&nbsp;2012&nbsp;23:21:55&nbsp;+0000&lt;br&gt;&lt;br&gt;<br>
<br>
<br>
<br>
&lt;style&gt;&lt;!--<br>
.ExternalClass&nbsp;.ecxshape<br>
{;}<br>
--&gt;&lt;/style&gt;&lt;style&gt;&lt;!--<br>
.ExternalClass&nbsp;p.ecxMsoNormal,&nbsp;.ExternalClass&nbsp;li.ecxMsoNormal,&nbsp;.ExternalClass&nbsp;div.ecxMsoNormal<br>
{margin-bottom:.0001pt;font-size:12.0pt;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;;}<br>
.ExternalClass&nbsp;a:link,&nbsp;.ExternalClass&nbsp;span.ecxMsoHyperlink<br>
{color:blue;text-decoration:underline;}<br>
.ExternalClass&nbsp;a:visited,&nbsp;.ExternalClass&nbsp;span.ecxMsoHyperlinkFollowed<br>
{color:purple;text-decoration:underline;}<br>
.ExternalClass&nbsp;p<br>
{margin-right:0in;margin-left:0in;font-size:12.0pt;font-family:&quot;Times&nbsp;New&nbsp;Roman&quot;,&quot;serif&quot;;}<br>
.ExternalClass&nbsp;span.ecxEmailStyle18<br>
{font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:#1F497D;}<br>
.ExternalClass&nbsp;.ecxMsoChpDefault<br>
{font-size:10.0pt;}<br>
@page&nbsp;WordSection1<br>
{size:8.5in&nbsp;11.0in;}<br>
.ExternalClass&nbsp;div.ecxWordSection1<br>
{page:WordSection1;}<br>
<br>
--&gt;&lt;/style&gt;<br>
<br>
<br>
&lt;div&nbsp;class=&quot;ecxWordSection1&quot;&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&nbsp;font-family:&nbsp;&quot;Calibri&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;11pt;'&gt;This&nbsp;is&nbsp;really&nbsp;an&nbsp;APR&nbsp;bug&nbsp;(we&nbsp;should&nbsp;report&nbsp;it&nbsp;or&nbsp;create&nbsp;a&nbsp;workaround),&nbsp;but&nbsp;the&nbsp;problem&nbsp;is&nbsp;in&nbsp;the&nbsp;file&nbsp;permissions.&nbsp;Read&nbsp;access&nbsp;to&nbsp;everyone&nbsp;is&nbsp;not&nbsp;enough,&nbsp;proper<br>
&nbsp;ACLs&nbsp;must&nbsp;be&nbsp;set&nbsp;as&nbsp;well.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&nbsp;font-family:&nbsp;&quot;Calibri&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;11pt;'&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&nbsp;font-family:&nbsp;&quot;Calibri&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;11pt;'&gt;When&nbsp;the&nbsp;file&nbsp;does&nbsp;not&nbsp;exist&nbsp;this&nbsp;error&nbsp;gets&nbsp;logged&nbsp;in&nbsp;the&nbsp;event&nbsp;log:&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&nbsp;font-family:&nbsp;&quot;Calibri&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;11pt;'&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;lime;&nbsp;font-family:&nbsp;&quot;Segoe&nbsp;UI&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;9pt;'&gt;Syntax&nbsp;error&nbsp;in&nbsp;config&nbsp;file&nbsp;c:\inetpub\wwwroot\test.conf,&nbsp;line&nbsp;47:&nbsp;Error&nbsp;creating&nbsp;rule:&nbsp;Could&nbsp;not&nbsp;open&nbsp;phrase&nbsp;file&nbsp;&quot;c:\inetpub\wwwroot\modsecurity_35_scanners.data&quot;:<br>
&nbsp;The&nbsp;system&nbsp;cannot&nbsp;find&nbsp;the&nbsp;file&nbsp;specified.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;lime;&nbsp;font-family:&nbsp;&quot;Segoe&nbsp;UI&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;9pt;'&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;lime;&nbsp;font-family:&nbsp;&quot;Calibri&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;11pt;'&gt;So&nbsp;you&nbsp;can&nbsp;see&nbsp;when&nbsp;it’s&nbsp;a&nbsp;permission&nbsp;issue&nbsp;or&nbsp;a&nbsp;path&nbsp;issue.&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;lime;&nbsp;font-family:&nbsp;&quot;Segoe&nbsp;UI&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;9pt;'&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;lime;&nbsp;font-family:&nbsp;&quot;Segoe&nbsp;UI&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;9pt;'&gt;Greg&lt;/span&gt;&lt;span&nbsp;style='color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&nbsp;font-family:&nbsp;&quot;Calibri&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;11pt;'&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;rgb(31,&nbsp;73,&nbsp;125);&nbsp;font-family:&nbsp;&quot;Calibri&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;11pt;'&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;border-width:&nbsp;1pt&nbsp;medium&nbsp;medium;&nbsp;border-style:&nbsp;solid&nbsp;none&nbsp;none;&nbsp;border-color:&nbsp;rgb(181,&nbsp;196,&nbsp;223)&nbsp;currentColor&nbsp;currentColor;&nbsp;padding:&nbsp;3pt&nbsp;0in&nbsp;0in;&quot;&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;b&gt;&lt;span&nbsp;style='font-family:&nbsp;&quot;Tahoma&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;10pt;'&gt;From:&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style='font-family:&nbsp;&quot;Tahoma&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;10pt;'&gt;&nbsp;Ryan&nbsp;Barnett&nbsp;[mailto:RBarnett@trustwave.com]<br>
&lt;br&gt;<br>
&lt;b&gt;Sent:&lt;/b&gt;&nbsp;Thursday,&nbsp;August&nbsp;9,&nbsp;2012&nbsp;2:45&nbsp;PM&lt;br&gt;<br>
&lt;b&gt;To:&lt;/b&gt;&nbsp;Bill&nbsp;Roemhild&lt;br&gt;<br>
&lt;b&gt;Cc:&lt;/b&gt;&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org;&nbsp;Greg&nbsp;Wroblewski&nbsp;(SPARROW)&lt;br&gt;<br>
&lt;b&gt;Subject:&lt;/b&gt;&nbsp;Re:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;@pmFromFile&nbsp;fails&nbsp;when&nbsp;using&nbsp;IIS&nbsp;along&nbsp;with&nbsp;modsecurity&nbsp;2.7.0-RC2&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;style=&quot;margin-bottom:&nbsp;12pt;&quot;&nbsp;class=&quot;ecxMsoNormal&quot;&gt;You&nbsp;might&nbsp;want&nbsp;to&nbsp;try&nbsp;and&nbsp;specify&nbsp;a&nbsp;full&nbsp;path&nbsp;to&nbsp;the&nbsp;.data&nbsp;file.&nbsp;&lt;/p&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;--&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;Ryan&nbsp;Barnett&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;Researcher&nbsp;Lead&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;Trustwave&nbsp;-&nbsp;SpiderLabs&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;style=&quot;margin-bottom:&nbsp;12pt;&quot;&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;br&gt;<br>
On&nbsp;Aug&nbsp;9,&nbsp;2012,&nbsp;at&nbsp;5:39&nbsp;PM,&nbsp;Bill&nbsp;Roemhild&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:consume_@hotmail.com&quot;&gt;consume_@hotmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;style=&quot;margin-bottom:&nbsp;5pt;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;I've&nbsp;been&nbsp;playing&nbsp;around&nbsp;with&nbsp;modsecurity&nbsp;2.7.0-RC2&nbsp;for&nbsp;IIS&nbsp;along&nbsp;with&nbsp;the&nbsp;OWASP&nbsp;rules.&nbsp;&nbsp;When&nbsp;running&nbsp;any&nbsp;rule&nbsp;set&nbsp;that&nbsp;calls&nbsp;for&nbsp;a&nbsp;data&nbsp;file&nbsp;through&nbsp;@pmFromFile&nbsp;the&nbsp;application&nbsp;pool&nbsp;crashes.&nbsp;&nbsp;I've&nbsp;given&nbsp;read&nbsp;access&nbsp;to&nbsp;'Everyone'&nbsp;on&nbsp;the<br>
&nbsp;data&nbsp;files&nbsp;being&nbsp;read&nbsp;without&nbsp;success.&nbsp;Anyone&nbsp;else&nbsp;run&nbsp;into&nbsp;this&nbsp;problem?&nbsp;&lt;br&gt;<br>
&nbsp;&lt;br&gt;<br>
&nbsp;&lt;br&gt;<br>
Rule:&lt;br&gt;<br>
SecRule&nbsp;REQUEST_HEADERS:User-Agent&nbsp;&quot;@pmFromFile&nbsp;modsecurity_35_scanners.data&quot;&nbsp;\&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;phase:2,rev:'2.2.5',t:none,t:lowercase,block,msg:'Request&nbsp;Indicates&nbsp;a&nbsp;Security&nbsp;Scanner&nbsp;Scanned&nbsp;the&nbsp;Site',id:'990002',tag:'AUTOMATION/SECURITY_SCANNER',tag:'WASCTC/WASC-21',tag:'OWASP_TOP_10/A7',tag:'PCI/6.5.10',severity:'4',setvar:'tx.msg=%{rule.msg}',setvar:tx.anomaly_score=+%{tx.warning_anomaly_score},setvar:tx.automation_score=+%{tx.warning_anomaly_score},setvar:tx.%{rule.id}-AUTOMATION/SECURITY_SCANNER-%{matched_var_name}=%{matched_var}&quot;&lt;br&gt;<br>
&nbsp;&lt;br&gt;<br>
Crash:&lt;br&gt;<br>
w3wp.exe&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;7.5.7601.17514&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;4ce7afa2&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;libapr-1.dll&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;1.4.5.0&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;500eaf34&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;c0000005&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;00000000000099f8&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;1e08&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;01cd7675752af369&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;c:\windows\system32\inetsrv\w3wp.exe&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;C:\Windows\system32\inetsrv\libapr-1.dll&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;b4147ab9-e268-11e1-82b3-4437e66c2115&nbsp;&lt;br&gt;<br>
&nbsp;&lt;br&gt;<br>
&nbsp;&lt;br&gt;<br>
&nbsp;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;blockquote&nbsp;style=&quot;margin-bottom:&nbsp;5pt;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&nbsp;&lt;/p&gt;<br>
&lt;div&nbsp;style=&quot;text-align:&nbsp;center;&quot;&nbsp;class=&quot;ecxMsoNormal&quot;&nbsp;align=&quot;center&quot;&gt;<br>
&lt;hr&nbsp;align=&quot;center&quot;&nbsp;SIZE=&quot;3&quot;&nbsp;width=&quot;100%&quot;&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;ecxMsoNormal&quot;&gt;&lt;span&nbsp;style='color:&nbsp;gray;&nbsp;font-family:&nbsp;&quot;Arial&quot;,&quot;sans-serif&quot;;&nbsp;font-size:&nbsp;7.5pt;'&gt;This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,<br>
&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;STRICTLY&nbsp;PROHIBITED.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy<br>
&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;&lt;/div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
