<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;Hello,&lt;br&gt;&lt;br&gt;I&#39;m<br>
&nbsp;updating&nbsp;CRS&nbsp;versions,&nbsp;and&nbsp;see&nbsp;just&nbsp;over&nbsp;20&nbsp;newer&nbsp;rules&nbsp;in&nbsp;CRS_41_sqli&nbsp;<br>
that&nbsp;name&nbsp;a&nbsp;tx&nbsp;variable&nbsp;(the&nbsp;one&nbsp;that&#39;s&nbsp;set&nbsp;equal&nbsp;to&nbsp;%{tx.0})&nbsp;using&nbsp;a&nbsp;<br>
different&nbsp;format&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;rules&nbsp;in&nbsp;the&nbsp;CRS&nbsp;(e.g.&nbsp;rule&nbsp;<br>
id:981243).&nbsp;The&nbsp;value&nbsp;of&nbsp;%{tx.msg}&nbsp;is&nbsp;added&nbsp;to&nbsp;the&nbsp;variable&nbsp;name,&nbsp;<br>
instead&nbsp;of&nbsp;just&nbsp;%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;},<br>
&nbsp;which&nbsp;seems&nbsp;a&nbsp;bit&nbsp;unnecessary,&nbsp;and&nbsp;not&nbsp;quite&nbsp;as&nbsp;clean.&nbsp;This&nbsp;variable&nbsp;is<br>
&nbsp;usually&nbsp;used&nbsp;to&nbsp;check&nbsp;that&nbsp;a&nbsp;rule&nbsp;matched&nbsp;a&nbsp;particular&nbsp;parameter&nbsp;prior&nbsp;<br>
to&nbsp;adjusting &nbsp;the&nbsp;anomaly&nbsp;score,&nbsp;so&nbsp;this&nbsp;creates&nbsp;some&nbsp;inconsistencies&nbsp;<br>
when&nbsp;writing&nbsp;score&nbsp;adjustments,&nbsp;since&nbsp;%{tx.msg}&nbsp;contains&nbsp;spaces.&lt;br&gt;<br>
&lt;br&gt;&lt;br&gt;The&nbsp;variable&nbsp;is&nbsp;typically&nbsp;named&nbsp;like&nbsp;this:&lt;br&gt;&lt;br&gt;&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}&lt;br&gt;&lt;br&gt;&lt;/div&gt;<br>
And&nbsp;a&nbsp;typical&nbsp;score&nbsp;adjustment&nbsp;would&nbsp;look&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;SecRule&nbsp;&amp;TX:981243-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar&nbsp;&quot;@ge&nbsp;1&quot;&nbsp;&quot;setvar:tx.anomaly_score=-%{tx.critical_anomaly_score}&quot;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;/div&gt;With&nbsp;this&nbsp;handful&nbsp;of&nbsp;newer&nbsp;rules,&nbsp;the&nbsp;variable&nbsp;is&nbsp;named&nbsp;like&nbsp;this:&lt;br&gt;<br>
<br>
  &nbsp;   &nbsp;&lt;br&gt;&lt;div&gt;&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;setvar:tx.%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}&lt;br&gt;&lt;br&gt;&lt;/div&gt;The<br>
&nbsp;only&nbsp;way&nbsp;I&nbsp;could&nbsp;figure&nbsp;to&nbsp;write&nbsp;a&nbsp;score&nbsp;adjustment&nbsp;for&nbsp;these&nbsp;was&nbsp;with&nbsp;<br>
regex&nbsp;(note:&nbsp;the&nbsp;regex&nbsp;wouldn&#39;t&nbsp;work&nbsp;with&nbsp;metacharacters,&nbsp;like&nbsp;\s&nbsp;for&nbsp;a&nbsp;<br>
space),&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;SecRule&nbsp;&amp;TX:&#39;/981243-Detects.classic.SQL.injection.probings.2/2-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar/&#39;&nbsp;&quot;@ge&nbsp;1&quot;&nbsp;&quot;setvar:tx.anomaly_score=-%{tx.critical_&lt;br&gt;<br>
<br>
anomaly_score}&quot;&lt;br&gt;&lt;/div&gt;&lt;br&gt;&lt;br&gt;Is&nbsp;there&nbsp;any&nbsp;reason&nbsp;the&nbsp;format&nbsp;for&nbsp;<br>
this&nbsp;has&nbsp;changed,&nbsp;or&nbsp;is&nbsp;different&nbsp;for&nbsp;these&nbsp;rules?&nbsp;Is&nbsp;there&nbsp;a&nbsp;cleaner&nbsp;or<br>
&nbsp;more&nbsp;consistent&nbsp;way&nbsp;to&nbsp;write&nbsp;adjustments&nbsp;for&nbsp;these&nbsp;rules?&lt;br&gt;&lt;br&gt;Thanks&nbsp;in&nbsp;advance,&lt;br&gt;<br>
Dusty&lt;/div&gt;<br>

</tt>
