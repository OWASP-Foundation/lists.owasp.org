<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=us-ascii&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:break-word;&nbsp;color:rgb(0,0,0);&nbsp;font-size:14px;&nbsp;font-family:Calibri,sans-serif&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;That&nbsp;is&nbsp;a&nbsp;bug&nbsp;and&nbsp;is&nbsp;why&nbsp;this&nbsp;is&nbsp;labeled&nbsp;as&nbsp;a&nbsp;&quot;dev&quot;&nbsp;branch&nbsp;:)&nbsp;&nbsp;I&nbsp;fixed&nbsp;it&nbsp;and&nbsp;just&nbsp;pushed&nbsp;an&nbsp;update&nbsp;to&nbsp;GitHub&nbsp;is&nbsp;you&nbsp;want&nbsp;to&nbsp;pull&nbsp;it&nbsp;down.&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;Ryan&nbsp;Barnett&lt;/span&gt;&lt;/b&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.5pt;&nbsp;font-family:Arial,sans-serif&quot;&gt;Senior&nbsp;Lead&nbsp;Security&nbsp;Researcher,&nbsp;SpiderLabs&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif;&nbsp;font-size:10.5pt&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;Trustwave&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:10.5pt;&nbsp;font-family:Arial,sans-serif&quot;&gt;&nbsp;|&nbsp;SMART&nbsp;SECURITY&nbsp;ON&nbsp;DEMAND&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:0in&nbsp;0in&nbsp;0.0001pt;&nbsp;font-size:11pt&quot;&gt;&lt;span&nbsp;style=&quot;font-family:Arial,sans-serif&quot;&gt;&lt;a&nbsp;href=&quot;http://www.trustwave.com/&quot;&gt;&lt;span&nbsp;style=&quot;font-size:10.5pt&quot;&gt;www.trustwave.com&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;border-bottom:medium&nbsp;none;&nbsp;border-left:medium&nbsp;none;&nbsp;padding-bottom:0in;&nbsp;padding-left:0in;&nbsp;padding-right:0in;&nbsp;border-top:#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;border-right:medium&nbsp;none;&nbsp;padding-top:3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Riemann&nbsp;Riemann&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:riemann913@gmail.com&quot;&gt;riemann913@gmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Thursday,&nbsp;June&nbsp;5,&nbsp;2014&nbsp;1:01&nbsp;PM&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;[Owasp-modsecurity-core-rule-set]&nbsp;Why&nbsp;are&nbsp;some&nbsp;newer&nbsp;rules&nbsp;formatted&nbsp;differently&nbsp;in&nbsp;crs_41_sqli?&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;blockquote&nbsp;id=&quot;MAC_OUTLOOK_ATTRIBUTION_BLOCKQUOTE&quot;&nbsp;style=&quot;border-left:#b5c4df&nbsp;5&nbsp;solid;&nbsp;padding:0&nbsp;0&nbsp;0&nbsp;5;&nbsp;margin:0&nbsp;0&nbsp;0&nbsp;5&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;<br>
&lt;div&gt;Hello,&lt;br&gt;<br>
&lt;br&gt;<br>
I'm&nbsp;updating&nbsp;CRS&nbsp;versions,&nbsp;and&nbsp;see&nbsp;just&nbsp;over&nbsp;20&nbsp;newer&nbsp;rules&nbsp;in&nbsp;CRS_41_sqli&nbsp;that&nbsp;name&nbsp;a&nbsp;tx&nbsp;variable&nbsp;(the&nbsp;one&nbsp;that's&nbsp;set&nbsp;equal&nbsp;to&nbsp;%{tx.0})&nbsp;using&nbsp;a&nbsp;different&nbsp;format&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;rules&nbsp;in&nbsp;the&nbsp;CRS&nbsp;(e.g.&nbsp;rule&nbsp;id:981243).&nbsp;The&nbsp;value&nbsp;of&nbsp;%{tx.msg}&nbsp;is&nbsp;added&nbsp;to<br>
&nbsp;the&nbsp;variable&nbsp;name,&nbsp;instead&nbsp;of&nbsp;just&nbsp;%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;},&nbsp;which&nbsp;seems&nbsp;a&nbsp;bit&nbsp;unnecessary,&nbsp;and&nbsp;not&nbsp;quite&nbsp;as&nbsp;clean.&nbsp;This&nbsp;variable&nbsp;is&nbsp;usually&nbsp;used&nbsp;to&nbsp;check&nbsp;that&nbsp;a&nbsp;rule&nbsp;matched&nbsp;a&nbsp;particular&nbsp;parameter&nbsp;prior&nbsp;to&nbsp;adjusting&nbsp;&nbsp;the&nbsp;anomaly<br>
&nbsp;score,&nbsp;so&nbsp;this&nbsp;creates&nbsp;some&nbsp;inconsistencies&nbsp;when&nbsp;writing&nbsp;score&nbsp;adjustments,&nbsp;since&nbsp;%{tx.msg}&nbsp;contains&nbsp;spaces.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
The&nbsp;variable&nbsp;is&nbsp;typically&nbsp;named&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;setvar:tx.%{&lt;a&nbsp;href=&quot;http://rule.id&quot;&nbsp;target=&quot;_blank&quot;&gt;rule.id&lt;/a&gt;}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
And&nbsp;a&nbsp;typical&nbsp;score&nbsp;adjustment&nbsp;would&nbsp;look&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;SecRule&nbsp;&amp;TX:981243-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar&nbsp;&quot;@ge&nbsp;1&quot;&nbsp;&quot;setvar:tx.anomaly_score=-%{tx.critical_anomaly_score}&quot;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
With&nbsp;this&nbsp;handful&nbsp;of&nbsp;newer&nbsp;rules,&nbsp;the&nbsp;variable&nbsp;is&nbsp;named&nbsp;like&nbsp;this:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;setvar:tx.%{tx.msg}-OWASP_CRS/WEB_ATTACK/SQLI-%{matched_var_name}=%{tx.0}&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
The&nbsp;only&nbsp;way&nbsp;I&nbsp;could&nbsp;figure&nbsp;to&nbsp;write&nbsp;a&nbsp;score&nbsp;adjustment&nbsp;for&nbsp;these&nbsp;was&nbsp;with&nbsp;regex&nbsp;(note:&nbsp;the&nbsp;regex&nbsp;wouldn't&nbsp;work&nbsp;with&nbsp;metacharacters,&nbsp;like&nbsp;\s&nbsp;for&nbsp;a&nbsp;space),&nbsp;like&nbsp;this:&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;margin-left:40px&quot;&gt;SecRule&nbsp;&amp;TX:'/981243-Detects.classic.SQL.injection.probings.2/2-OWASP_CRS/WEB_ATTACK/SQLI-ARGS:foobar/'&nbsp;&quot;@ge&nbsp;1&quot;&nbsp;&quot;setvar:tx.anomaly_score=-%{tx.critical_&lt;br&gt;<br>
anomaly_score}&quot;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;<br>
Is&nbsp;there&nbsp;any&nbsp;reason&nbsp;the&nbsp;format&nbsp;for&nbsp;this&nbsp;has&nbsp;changed,&nbsp;or&nbsp;is&nbsp;different&nbsp;for&nbsp;these&nbsp;rules?&nbsp;Is&nbsp;there&nbsp;a&nbsp;cleaner&nbsp;or&nbsp;more&nbsp;consistent&nbsp;way&nbsp;to&nbsp;write&nbsp;adjustments&nbsp;for&nbsp;these&nbsp;rules?&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;in&nbsp;advance,&lt;br&gt;<br>
Dusty&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information<br>
&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/HTML&gt;<br>
<br>

</tt>
