<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=windows-1252&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;Hi&nbsp;Richard&nbsp;and&nbsp;others,&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Actually&nbsp;your&nbsp;original&nbsp;query&nbsp;(passing&nbsp;“select&nbsp;A&nbsp;from&nbsp;B”)&nbsp;might&nbsp;even&nbsp;be&nbsp;successful&nbsp;in&nbsp;some&nbsp;cases.&nbsp;For&nbsp;instance,&nbsp;in&nbsp;MySQL,&nbsp;you&nbsp;can&nbsp;have&nbsp;a&nbsp;subquery.&nbsp;However&nbsp;it&nbsp;must&nbsp;appear&nbsp;in&nbsp;parentheses.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;For&nbsp;instance&nbsp;this&nbsp;is&nbsp;a&nbsp;valid&nbsp;query:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;select&nbsp;*&nbsp;from&nbsp;user&nbsp;where&nbsp;id=(select&nbsp;id&nbsp;from&nbsp;user&nbsp;where&nbsp;admin=1)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;So&nbsp;if&nbsp;an&nbsp;application&nbsp;developer&nbsp;does&nbsp;the&nbsp;following,&nbsp;your&nbsp;statement&nbsp;might&nbsp;get&nbsp;executed:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;select&nbsp;*&nbsp;from&nbsp;user&nbsp;where&nbsp;id=(injected_parameter)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Now,&nbsp;the&nbsp;libinjection&nbsp;in&nbsp;ModSec&nbsp;2.9&nbsp;still&nbsp;tries&nbsp;to&nbsp;do&nbsp;something.&nbsp;It&nbsp;doesn’t&nbsp;think&nbsp;this&nbsp;is&nbsp;SQLi:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&quot;select&nbsp;id&nbsp;from&nbsp;user”&nbsp;(your&nbsp;example)&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;“delete&nbsp;from&nbsp;foo&quot;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;But&nbsp;it&nbsp;does&nbsp;think&nbsp;the&nbsp;following&nbsp;strings&nbsp;are&nbsp;SQLi:&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&quot;(select&nbsp;id&nbsp;from&nbsp;user)”&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&quot;select&nbsp;id&nbsp;from&nbsp;user&nbsp;where&nbsp;admin=1”&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&quot;select&nbsp;id&nbsp;from&nbsp;user&nbsp;where&nbsp;password&nbsp;is&nbsp;null”&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;It’s&nbsp;still&nbsp;bit&nbsp;of&nbsp;a&nbsp;black&nbsp;box,&nbsp;but&nbsp;I’m&nbsp;collecting&nbsp;many&nbsp;samples&nbsp;and&nbsp;I&nbsp;plan&nbsp;to&nbsp;report&nbsp;any&nbsp;possible&nbsp;coverage&nbsp;test&nbsp;caseas&nbsp;upstream.&nbsp;I&nbsp;think&nbsp;your&nbsp;example&nbsp;is&nbsp;an&nbsp;interesting&nbsp;one&nbsp;that&nbsp;may&nbsp;not&nbsp;cause&nbsp;too&nbsp;many&nbsp;vulnerabilities,&nbsp;but&nbsp;an&nbsp;application&nbsp;that&nbsp;accepts&nbsp;full&nbsp;queries&nbsp;is&nbsp;still&nbsp;very&nbsp;hazardous&nbsp;so&nbsp;in&nbsp;my&nbsp;opinion&nbsp;ideally&nbsp;libinjection&nbsp;should&nbsp;trigger&nbsp;on&nbsp;it.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Cheers!&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;WH&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;11&nbsp;Feb&nbsp;2016,&nbsp;at&nbsp;18:50,&nbsp;Richard&nbsp;Lin&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:hongpinglin@hotmail.com&quot;&nbsp;class=&quot;&quot;&gt;hongpinglin@hotmail.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Thanks&nbsp;&lt;span&nbsp;style=&quot;font-family:&nbsp;Calibri;&nbsp;font-size:&nbsp;14.6667px;&quot;&nbsp;class=&quot;&quot;&gt;Chaim&nbsp;and&nbsp;&lt;/span&gt;Christian&nbsp;and&nbsp;I&nbsp;agree&nbsp;that&nbsp;it&nbsp;is&nbsp;bad&nbsp;that&nbsp;a&nbsp;user&nbsp;controls&nbsp;a&nbsp;SQL&nbsp;statement.&nbsp;&nbsp;I&nbsp;think&nbsp;libinjection&nbsp;covered&nbsp;'Where'&nbsp;and&nbsp;'Like'&nbsp;clause&nbsp;as&nbsp;you&nbsp;mentioned.&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;Calibri;&nbsp;font-size:&nbsp;12pt;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&nbsp;class=&quot;&quot;&gt;I&nbsp;am&nbsp;trying&nbsp;to&nbsp;judge&nbsp;if&nbsp;libinjection&nbsp;missed&nbsp;a&nbsp;category&nbsp;of&nbsp;attacking&nbsp;model&nbsp;in&nbsp;which&nbsp;the&nbsp;user's&nbsp;input&nbsp;is&nbsp;an&nbsp;independent&nbsp;SQLs&nbsp;which&nbsp;can&nbsp;be&nbsp;invoked&nbsp;by&nbsp;themselves&nbsp;(i.e,&nbsp;without&nbsp;prefix&nbsp;of&nbsp;&quot;1&nbsp;UNION&quot;,&nbsp;'1&nbsp;or&quot;,&nbsp;&quot;1&nbsp;and&quot;,&nbsp;etc)&nbsp;&nbsp;If&nbsp;that&nbsp;is&nbsp;the&nbsp;case,&nbsp;I&nbsp;would&nbsp;consider&nbsp;to&nbsp;propose&nbsp;a&nbsp;patch.&nbsp;But&nbsp;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;how&nbsp;careless&nbsp;developers&nbsp;can&nbsp;directly&nbsp;take&nbsp;the&nbsp;input&nbsp;as&nbsp;SQL&nbsp;itself.&nbsp;That&nbsp;sounds&nbsp;too&nbsp;naive&nbsp;to&nbsp;be&nbsp;believed&nbsp;:)&lt;/span&gt;&lt;div&nbsp;style=&quot;font-family:&nbsp;Calibri;&nbsp;font-size:&nbsp;16px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&quot;&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;<br>
&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;auto;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;auto;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;style=&quot;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-family:&nbsp;'Lucida&nbsp;Grande';&nbsp;font-style:&nbsp;normal;&nbsp;font-variant:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;line-height:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-align:&nbsp;-webkit-auto;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;--&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;Walter&nbsp;Hop&nbsp;|&nbsp;PGP&nbsp;key:&nbsp;&lt;a&nbsp;href=&quot;https://lifeforms.nl/pgp&quot;&nbsp;class=&quot;&quot;&gt;https://lifeforms.nl/pgp&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>
<br>
&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
