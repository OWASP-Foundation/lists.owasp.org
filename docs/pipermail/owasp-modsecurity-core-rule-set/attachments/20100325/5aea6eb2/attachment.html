<tt>
<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Hi&nbsp;-&nbsp;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;I'm&nbsp;upgrading&nbsp;from&nbsp;Core&nbsp;Rules&nbsp;1.x&nbsp;to<br>
2.0.6,&nbsp;and&nbsp;for&nbsp;the&nbsp;life&nbsp;of&nbsp;me&nbsp;I&nbsp;can't&nbsp;figure&nbsp;out&nbsp;whats&nbsp;blocking&nbsp;a&nbsp;bunch<br>
of&nbsp;requests&nbsp;going&nbsp;to&nbsp;images,&nbsp;css&nbsp;and&nbsp;auxilary&nbsp;files&nbsp;after&nbsp;I&nbsp;set&nbsp;my&nbsp;secdefaultaction<br>
from&nbsp;pass&nbsp;--&amp;gt;&nbsp;fail.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;I'm&nbsp;running&nbsp;modsec&nbsp;2.5.12&nbsp;on&nbsp;httpd&nbsp;2.2.14<br>
on&nbsp;redhat&nbsp;4&nbsp;in&nbsp;a&nbsp;proxy&nbsp;situation.&nbsp;&amp;nbsp;Below&nbsp;is&nbsp;the&nbsp;audit&nbsp;log&nbsp;of&nbsp;a&nbsp;failed<br>
transaction.&nbsp;&amp;nbsp;I've&nbsp;scrubbed&nbsp;some&nbsp;cookies,&nbsp;IPs&nbsp;and&nbsp;such.&nbsp;&amp;nbsp;Many<br>
of&nbsp;the&nbsp;rules&nbsp;that&nbsp;it&nbsp;matched&nbsp;on&nbsp;don't&nbsp;make&nbsp;sense&nbsp;-&nbsp;for&nbsp;instance&nbsp;two&nbsp;seem<br>
to&nbsp;reference&nbsp;content&nbsp;in&nbsp;my&nbsp;GET,&nbsp;but&nbsp;as&nbsp;you&nbsp;can&nbsp;see&nbsp;from&nbsp;the&nbsp;audit&nbsp;log&nbsp;-<br>
that&nbsp;is&nbsp;not&nbsp;true.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;basically,&nbsp;I&nbsp;switch&nbsp;from&nbsp;SecDefaultAction<br>
&amp;quot;phase:2,pass&amp;quot;&nbsp;to&nbsp;SecDefaultAction&nbsp;&amp;quot;phase:2,deny&amp;quot;&nbsp;and<br>
things&nbsp;blow&nbsp;up.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Thanks&nbsp;in&nbsp;advance.&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;--c7bc2307-A--&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;[25/Mar/2010:15:17:52&nbsp;--0400]&nbsp;S6u24KwQx3QAAD98Wq4AAAAF<br>
xxxxxx&nbsp;4913&nbsp;xxxxxxx&nbsp;8081&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;--c7bc2307-B--&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;GET&nbsp;/portal/page/portal/EC_Images/Navigation/SHADOW_WHITE.gif<br>
HTTP/1.1&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Host:&nbsp;portaltest.xxxxxxxxxxxx&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;User-Agent:&nbsp;Mozilla/5.0&nbsp;(Windows;&nbsp;U;<br>
Windows&nbsp;NT&nbsp;5.1;&nbsp;en-US;&nbsp;rv:1.9.2.2)&nbsp;Gecko/20100316&nbsp;Firefox/3.6.2&nbsp;(.NET&nbsp;CLR<br>
3.5.30729)&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Accept:&nbsp;image/png,image/*;q=0.8,*/*;q=0.5&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Accept-Language:&nbsp;en-us,en;q=0.5&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Accept-Encoding:&nbsp;gzip,deflate&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Accept-Charset:&nbsp;ISO-8859-1,utf-8;q=0.7,*;q=0.7&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Keep-Alive:&nbsp;115&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Connection:&nbsp;keep-alive&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Referer:&nbsp;https://portaltest.xxxxxxxxx&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Cookie:&nbsp;ZZZZZZZZZZZZZ&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Cache-Control:&nbsp;max-age=0&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;--c7bc2307-F--&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;HTTP/1.1&nbsp;403&nbsp;Forbidden&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Last-Modified:&nbsp;Wed,&nbsp;28&nbsp;May&nbsp;2008&nbsp;15:12:28<br>
GMT&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;ETag:&nbsp;&amp;quot;1958230-432-44e4bd7454f00&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Accept-Ranges:&nbsp;bytes&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Vary:&nbsp;User-Agent&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Keep-Alive:&nbsp;timeout=15,&nbsp;max=199&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Connection:&nbsp;Keep-Alive&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Transfer-Encoding:&nbsp;chunked&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Content-Type:&nbsp;text/html&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;--c7bc2307-H--&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Action:&nbsp;Intercepted&nbsp;(phase&nbsp;4)&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Stopwatch:&nbsp;1269544672616177&nbsp;32476&nbsp;(1886<br>
4785&nbsp;-)&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Producer:&nbsp;ModSecurity&nbsp;for&nbsp;Apache/2.5.12<br>
(http://www.modsecurity.org/);&nbsp;core&nbsp;ruleset/2.0.6.&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;Server:&nbsp;Apache/2.2.14&nbsp;(Unix)&nbsp;mod_ssl/2.2.14<br>
OpenSSL/0.9.7a&nbsp;mod_jk/1.2.28&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;--c7bc2307-K--&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecAction&nbsp;&amp;quot;phase:1,auditlog,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remote_addr}&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecAction&nbsp;&amp;quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.paranoid_mode=0&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecAction&nbsp;&amp;quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.inbound_anomaly_score_level=20&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecAction&nbsp;&amp;quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.outbound_anomaly_score_level=15&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecAction&nbsp;&amp;quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.critical_anomaly_score=20,setvar:tx.error_anomaly_score=15,setvar:tx.warning_anomaly_score=10,setvar:tx.notice_anomaly_score=5&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecAction&nbsp;&amp;quot;phase:1,auditlog,t:none,nolog,pass,setvar:tx.max_num_args=255&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecAction&nbsp;&amp;quot;phase:1,auditlog,t:none,nolog,pass,setvar:'tx.allowed_methods=GET<br>
HEAD&nbsp;POST&nbsp;OPTIONS',setvar:'tx.allowed_request_content_type=application/x-www-form-urlencoded<br>
multipart/form-data&nbsp;text/xml&nbsp;application/xml',setvar:'tx.allowed_http_versions=HTTP/0.9<br>
HTTP/1.0&nbsp;HTTP/1.1',setvar:'tx.restricted_extensions=.asa&nbsp;.asax&nbsp;.ascx&nbsp;.axd<br>
.backup&nbsp;.bak&nbsp;.bat&nbsp;.cdx&nbsp;.cer&nbsp;.cfg&nbsp;.cmd&nbsp;.com&nbsp;.config&nbsp;.conf&nbsp;.cs&nbsp;.csproj&nbsp;.csr<br>
.dat&nbsp;.db&nbsp;.dbf&nbsp;.dll&nbsp;.dos&nbsp;.htr&nbsp;.htw&nbsp;.ida&nbsp;.idc&nbsp;.idq&nbsp;.inc&nbsp;.ini&nbsp;.key&nbsp;.licx&nbsp;.lnk<br>
.log&nbsp;.mdb&nbsp;.old&nbsp;.pass&nbsp;.pdb&nbsp;.pol&nbsp;.printer&nbsp;.pwd&nbsp;.resources&nbsp;.resx&nbsp;.sql&nbsp;.sys<br>
.vb&nbsp;.vbs&nbsp;.vbproj&nbsp;.vsdisco&nbsp;.webinfo&nbsp;.xsd&nbsp;.xsx',setvar:'tx.restricted_headers=Lock-Token<br>
Content-Range&nbsp;Translate&nbsp;via&nbsp;if'&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;REQUEST_METHOD&amp;quot;&nbsp;&amp;quot;@rx<br>
^(?:GET|HEAD)$&amp;quot;&nbsp;&amp;quot;phase:2,chain,rev:2.0.6,t:none,pass,nolog,auditlog,msg:'GET<br>
or&nbsp;HEAD&nbsp;requests&nbsp;with&nbsp;bodies',severity:2,id:960011,tag:PROTOCOL_VIOLATION/EVASION,tag:WASCTC/WASC-21,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,tag:http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.3&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;&amp;amp;REQUEST_HEADERS:Content-Type&amp;quot;<br>
&amp;quot;@eq&nbsp;0&amp;quot;&nbsp;&amp;quot;phase:2,deny,chain,rev:2.0.6,t:none,nolog,auditlog,msg:'Request<br>
Containing&nbsp;Content,&nbsp;but&nbsp;Missing&nbsp;Content-Type&nbsp;header',id:960904,severity:5&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;&amp;amp;TX:MAX_NUM_ARGS&amp;quot;<br>
&amp;quot;@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:2,chain,t:none,pass,nolog,auditlog,msg:'Too<br>
many&nbsp;arguments&nbsp;in&nbsp;request',id:960335,severity:4,rev:2.0.6&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;REQUEST_BASENAME&amp;quot;<br>
&amp;quot;@rx&nbsp;\\.(.*)$&amp;quot;&nbsp;&amp;quot;phase:2,chain,capture,t:none,t:urlDecodeUni,t:lowercase,pass,nolog,auditlog,msg:'URL<br>
file&nbsp;extension&nbsp;is&nbsp;restricted&nbsp;by&nbsp;policy',severity:2,id:960035,tag:POLICY/EXT_RESTRICTED,tag:WASCTC/WASC-15,tag:OWASP_TOP_10/A7,tag:PCI/6.5.10,logdata:%{TX.0}&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;TX:PARANOID_MODE&amp;quot;<br>
&amp;quot;!@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:2,t:none,nolog,skipAfter:END_SESSION_FIXATION&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;TX:PARANOID_MODE&amp;quot;<br>
&amp;quot;!@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:2,t:none,nolog,skipAfter:END_FILE_INJECTION&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;TX:PARANOID_MODE&amp;quot;<br>
&amp;quot;!@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:2,t:none,nolog,skipAfter:END_COMMAND_ACCESS&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;TX:PARANOID_MODE&amp;quot;<br>
&amp;quot;!@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:2,t:none,nolog,skipAfter:END_COMMAND_INJECTION&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;TX:PARANOID_MODE&amp;quot;<br>
&amp;quot;!@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:2,rev:2.0.6,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;TX:PARANOID_MODE&amp;quot;<br>
&amp;quot;!@eq&nbsp;1&amp;quot;&nbsp;&amp;quot;phase:2,t:none,nolog,skipAfter:END_XSS_CHECK&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;RESPONSE_BODY&amp;quot;&nbsp;&amp;quot;!@pm<br>
iframe&amp;quot;&nbsp;&amp;quot;phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,t:lowercase,nolog,skipAfter:END_IFRAME_CHECK&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;SecRule&nbsp;&amp;quot;RESPONSE_BODY&amp;quot;&nbsp;&amp;quot;!@pmFromFile<br>
modsecurity_50_outbound.data&amp;quot;&nbsp;&amp;quot;phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,nolog,skipAfter:END_OUTBOUND_CHECK&amp;quot;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&nbsp;face=&quot;sans-serif&quot;&gt;--c7bc2307-Z--&lt;/font&gt;
</tt>
