<tt>
<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;Hi&nbsp;-&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;I'm&nbsp;upgrading&nbsp;from&nbsp;Core&nbsp;Rules&nbsp;1.x&nbsp;to&nbsp;2.0.6,&nbsp;and&nbsp;for&nbsp;the&nbsp;life&nbsp;of&nbsp;me<br>
I&lt;br&gt;<br>
&amp;gt;&nbsp;can't&nbsp;figure&nbsp;out&nbsp;whats&nbsp;blocking&nbsp;a&nbsp;bunch&nbsp;of&nbsp;requests&nbsp;going&nbsp;to&nbsp;images,&lt;br&gt;<br>
&amp;gt;&nbsp;css&nbsp;and&nbsp;auxilary&nbsp;files&nbsp;after&nbsp;I&nbsp;set&nbsp;my&nbsp;secdefaultaction&nbsp;from&nbsp;pass&nbsp;--&amp;gt;<br>
fail.&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;I'm&nbsp;running&nbsp;modsec&nbsp;2.5.12&nbsp;on&nbsp;httpd&nbsp;2.2.14&nbsp;on&nbsp;redhat&nbsp;4&nbsp;in&nbsp;a&nbsp;proxy&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;situation.&nbsp;&amp;nbsp;Below&nbsp;is&nbsp;the&nbsp;audit&nbsp;log&nbsp;of&nbsp;a&nbsp;failed&nbsp;transaction.&nbsp;&amp;nbsp;I've<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;scrubbed&nbsp;some&nbsp;cookies,&nbsp;IPs&nbsp;and&nbsp;such.&nbsp;&amp;nbsp;Many&nbsp;of&nbsp;the&nbsp;rules&nbsp;that<br>
it&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;matched&nbsp;on&nbsp;don't&nbsp;make&nbsp;sense&nbsp;-&nbsp;for&nbsp;instance&nbsp;two&nbsp;seem&nbsp;to&nbsp;reference&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;content&nbsp;in&nbsp;my&nbsp;GET,&nbsp;but&nbsp;as&nbsp;you&nbsp;can&nbsp;see&nbsp;from&nbsp;the&nbsp;audit&nbsp;log&nbsp;-&nbsp;that&nbsp;is<br>
not&nbsp;true.&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;basically,&nbsp;I&nbsp;switch&nbsp;from&nbsp;SecDefaultAction&nbsp;&amp;quot;phase:2,pass&amp;quot;<br>
to&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;SecDefaultAction&nbsp;&amp;quot;phase:2,deny&amp;quot;&nbsp;and&nbsp;things&nbsp;blow&nbsp;up.&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;Thanks&nbsp;in&nbsp;advance.&nbsp;&lt;br&gt;<br>
&amp;gt;&nbsp;&lt;br&gt;<br>
[...skipped...]&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule&nbsp;&amp;quot;RESPONSE_BODY&amp;quot;&nbsp;&amp;quot;!@pmFromFile&nbsp;modsecurity_50_outbound.data&amp;quot;<br>
&lt;br&gt;<br>
&amp;gt;&nbsp;&amp;quot;phase:4,rev:2.0.6,t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,&lt;br&gt;<br>
&amp;gt;&nbsp;nolog,skipAfter:END_OUTBOUND_CHECK&amp;quot;&nbsp;&lt;br&gt;<br>
&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;Hmmm...&nbsp;Strange.&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;It&nbsp;seems&nbsp;that&nbsp;a&nbsp;part&nbsp;of&nbsp;the&nbsp;bug&nbsp;with&nbsp;id&nbsp;&amp;quot;CORERULES-36&amp;quot;<br>
is&nbsp;still&nbsp;in&nbsp;place.&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;Just&nbsp;checked&nbsp;modsecurity_crs_50_outbound.conf&nbsp;and<br>
it&nbsp;looks&nbsp;like&nbsp;it's&nbsp;still&nbsp;missing&nbsp;default&nbsp;action&nbsp;in&nbsp;this&nbsp;rule.&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;We've&nbsp;got&nbsp;the&nbsp;same&nbsp;behaviour&nbsp;with&nbsp;2.0.5&nbsp;rules&nbsp;until<br>
we've&nbsp;added&nbsp;a&nbsp;&amp;quot;pass&amp;quot;&nbsp;default&nbsp;action&nbsp;to&nbsp;this&nbsp;rule.&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;So&nbsp;the&nbsp;corrected&nbsp;rule&nbsp;should&nbsp;look&nbsp;like&nbsp;the&nbsp;following:&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;SecRule&nbsp;RESPONSE_BODY&nbsp;&amp;quot;!@pmFromFile&nbsp;modsecurity_50_outbound.data&amp;quot;<br>
\&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;nbsp;&nbsp;&amp;quot;phase:4,rev:'2.0.6',t:none,capture,t:urlDecodeUni,t:htmlEntityDecode,pass,nolog,skipAfter:END_OUTBOUND_CHECK&amp;quot;&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;Strange&nbsp;though.&nbsp;Maybe&nbsp;Ryan&nbsp;can&nbsp;comment&nbsp;on&nbsp;this.&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;wbr&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;&lt;font&nbsp;size=2&gt;&lt;tt&gt;Artyom&lt;/tt&gt;&lt;/font&gt;<br>
&lt;br&gt;
</tt>
