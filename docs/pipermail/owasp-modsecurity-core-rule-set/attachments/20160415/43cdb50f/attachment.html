<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=iso-8859-1&quot;&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&quot;&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;You&nbsp;know,&nbsp;I&nbsp;should&nbsp;have&nbsp;thought&nbsp;about&nbsp;this&nbsp;to&nbsp;begin&nbsp;with&nbsp;but&nbsp;that&nbsp;makes&nbsp;perfect&nbsp;sense&nbsp;&#8212;&nbsp;Barry,&nbsp;good&nbsp;eye!&nbsp;There&nbsp;is&nbsp;an&nbsp;open&nbsp;ticket&nbsp;right&nbsp;now&nbsp;for&nbsp;indicating&nbsp;when&nbsp;there&nbsp;is&nbsp;a&nbsp;base64&nbsp;decoding&nbsp;issue,&nbsp;this&nbsp;will&nbsp;be&nbsp;included&nbsp;within&nbsp;ModSecurityv3.&nbsp;Generally&nbsp;spaces<br>
&nbsp;are&nbsp;not&nbsp;valid&nbsp;Base64&nbsp;chars&nbsp;and&nbsp;would&nbsp;have&nbsp;resulted&nbsp;in&nbsp;such&nbsp;a&nbsp;fix&nbsp;firing&nbsp;and&nbsp;saved&nbsp;us&nbsp;all&nbsp;a&nbsp;little&nbsp;bit&nbsp;of&nbsp;headache.&nbsp;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;--&nbsp;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:&nbsp;0cm&nbsp;0cm&nbsp;0.0001pt;&nbsp;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman',&nbsp;serif;&quot;&gt;<br>
&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(0,&nbsp;143,&nbsp;197);&quot;&gt;Chaim&nbsp;Sanders&lt;/span&gt;&lt;/b&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(0,&nbsp;143,&nbsp;197);&quot;&gt;&nbsp;&nbsp;&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:&nbsp;0cm&nbsp;0cm&nbsp;0.0001pt;&nbsp;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman',&nbsp;serif;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(88,&nbsp;89,&nbsp;91);&quot;&gt;Security&nbsp;Researcher&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:&nbsp;0cm&nbsp;0cm&nbsp;0.0001pt;&nbsp;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman',&nbsp;serif;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(88,&nbsp;89,&nbsp;91);&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:&nbsp;0cm&nbsp;0cm&nbsp;0.0001pt;&nbsp;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman',&nbsp;serif;&quot;&gt;<br>
&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(0,&nbsp;143,&nbsp;197);&quot;&gt;Trustwave&lt;/span&gt;&lt;/b&gt;&lt;b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(88,&nbsp;89,&nbsp;91);&quot;&gt;&nbsp;&lt;/span&gt;&lt;/b&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(88,&nbsp;89,&nbsp;91);&quot;&gt;|&nbsp;SMART<br>
&nbsp;SECURITY&nbsp;ON&nbsp;DEMAND&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:&nbsp;0cm&nbsp;0cm&nbsp;0.0001pt;&nbsp;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman',&nbsp;serif;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;font-family:&nbsp;Arial,&nbsp;sans-serif;&nbsp;color:&nbsp;rgb(88,&nbsp;89,&nbsp;91);&quot;&gt;&lt;a&nbsp;href=&quot;http://www.trustwave.com/&quot;&nbsp;style=&quot;color:&nbsp;purple;&quot;&gt;www.trustwave.com&lt;/a&gt;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;11pt;&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;p&nbsp;class=&quot;MsoNormal&quot;&nbsp;style=&quot;margin:&nbsp;0cm&nbsp;0cm&nbsp;0.0001pt;&nbsp;font-size:&nbsp;12pt;&nbsp;font-family:&nbsp;'Times&nbsp;New&nbsp;Roman',&nbsp;serif;&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-size:&nbsp;10.5pt;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&quot;&gt;&nbsp;&lt;/span&gt;&lt;/p&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;span&nbsp;id=&quot;OLK_SRC_BODY_SECTION&quot;&gt;<br>
&lt;div&nbsp;style=&quot;font-family:Calibri;&nbsp;font-size:11pt;&nbsp;text-align:left;&nbsp;color:black;&nbsp;BORDER-BOTTOM:&nbsp;medium&nbsp;none;&nbsp;BORDER-LEFT:&nbsp;medium&nbsp;none;&nbsp;PADDING-BOTTOM:&nbsp;0in;&nbsp;PADDING-LEFT:&nbsp;0in;&nbsp;PADDING-RIGHT:&nbsp;0in;&nbsp;BORDER-TOP:&nbsp;#b5c4df&nbsp;1pt&nbsp;solid;&nbsp;BORDER-RIGHT:&nbsp;medium&nbsp;none;&nbsp;PADDING-TOP:&nbsp;3pt&quot;&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;From:&nbsp;&lt;/span&gt;Barry&nbsp;Pollard&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:barry_pollard@hotmail.com&quot;&gt;barry_pollard@hotmail.com&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Date:&nbsp;&lt;/span&gt;Friday,&nbsp;April&nbsp;15,&nbsp;2016&nbsp;at&nbsp;8:29&nbsp;AM&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;To:&nbsp;&lt;/span&gt;&quot;Mansell,&nbsp;Gary&quot;&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:gary.mansell@ricardo.com&quot;&gt;gary.mansell@ricardo.com&lt;/a&gt;&gt;,&nbsp;Chaim&nbsp;Sanders&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:csanders@trustwave.com&quot;&gt;csanders@trustwave.com&lt;/a&gt;&gt;,&nbsp;&quot;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&quot;<br>
&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&gt;&lt;br&gt;<br>
&lt;span&nbsp;style=&quot;font-weight:bold&quot;&gt;Subject:&nbsp;&lt;/span&gt;RE:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;use&nbsp;modsecurity&nbsp;rules&nbsp;to&nbsp;prevent&nbsp;logins&nbsp;by&nbsp;specific&nbsp;user&nbsp;accounts?&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&nbsp;class=&quot;hmmessage&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;12pt;<br>
font-family:Calibri<br>
}<br>
--&gt;&lt;/style&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;OK&nbsp;so&nbsp;the&nbsp;audit&nbsp;log&nbsp;shows&nbsp;shows&nbsp;this&nbsp;in&nbsp;your&nbsp;header:<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;Authorization:&nbsp;Basic&nbsp;Z3JtYXdjYWRtaW46dGVzdA==&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&gt;The&nbsp;value&nbsp;of&nbsp;the&nbsp;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Authorization&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;header&nbsp;is&nbsp;therefore&nbsp;&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Basic&nbsp;Z3JtYXdjYWRtaW46dGVzdA==&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&quot;&nbsp;which&nbsp;cannot&nbsp;be&nbsp;base64<br>
&nbsp;decoded&nbsp;due&nbsp;to&nbsp;that&nbsp;initial&nbsp;&quot;Basic&nbsp;&quot;&nbsp;part&nbsp;which&nbsp;is&nbsp;not&nbsp;Base&nbsp;64&nbsp;encoded.&nbsp;This&nbsp;is&nbsp;what&nbsp;you&nbsp;are&nbsp;supposed&nbsp;to&nbsp;send&nbsp;so&nbsp;nothing&nbsp;wrong&nbsp;with&nbsp;your&nbsp;header,&nbsp;but&nbsp;it&nbsp;explains&nbsp;why&nbsp;your&nbsp;rule&nbsp;is&nbsp;not&nbsp;working&nbsp;as&nbsp;ModSecurity&nbsp;does&nbsp;not&nbsp;know&nbsp;you&nbsp;only&nbsp;want&nbsp;to&nbsp;base64&nbsp;decode&nbsp;part&nbsp;of<br>
&nbsp;the&nbsp;header.&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;So&nbsp;you&nbsp;need&nbsp;to&nbsp;write&nbsp;a&nbsp;chained&nbsp;rule&nbsp;to&nbsp;capture&nbsp;the&nbsp;actual&nbsp;base64&nbsp;encoded&nbsp;part&nbsp;using&nbsp;backets&nbsp;and&nbsp;&quot;capture&quot;&nbsp;and&nbsp;then&nbsp;base&nbsp;64&nbsp;decode&nbsp;the&nbsp;TX:1&nbsp;variable&nbsp;which&nbsp;is&nbsp;captured:&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;<br>
&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;<br>
&lt;div&gt;SecRule&nbsp;&quot;REQUEST_HEADERS:Authorization&quot;&nbsp;&quot;^Basic&nbsp;(.*)$&quot;&nbsp;&quot;phase:1,id:1003,log,capture,chai&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;n,deny,status:403&quot;&lt;/span&gt;&lt;/div&gt;<br>
&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;TX:1&nbsp;&quot;@contains&nbsp;admin&quot;&nbsp;&quot;t:base64Decode&quot;&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;I've&nbsp;tested&nbsp;this&nbsp;and&nbsp;it&nbsp;seems&nbsp;to&nbsp;work.&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Thanks,&lt;/div&gt;<br>
&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Barry&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;div&gt;&gt;&nbsp;From:&nbsp;&lt;a&nbsp;href=&quot;mailto:Gary.Mansell@ricardo.com&quot;&gt;Gary.Mansell@ricardo.com&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;To:&nbsp;&lt;a&nbsp;href=&quot;mailto:barry_pollard@hotmail.com&quot;&gt;barry_pollard@hotmail.com&lt;/a&gt;;&nbsp;&lt;a&nbsp;href=&quot;mailto:csanders@trustwave.com&quot;&gt;<br>
csanders@trustwave.com&lt;/a&gt;;&nbsp;&lt;a&nbsp;href=&quot;mailto:owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;<br>
owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&gt;&nbsp;Subject:&nbsp;RE:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;use&nbsp;modsecurity&nbsp;rules&nbsp;to&nbsp;prevent&nbsp;logins&nbsp;by&nbsp;specific&nbsp;user&nbsp;accounts?&lt;br&gt;<br>
&gt;&nbsp;Date:&nbsp;Fri,&nbsp;15&nbsp;Apr&nbsp;2016&nbsp;10:37:16&nbsp;&#43;0000&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;I&nbsp;added&nbsp;the&nbsp;rule,&nbsp;cleared&nbsp;the&nbsp;logs&nbsp;and&nbsp;logged&nbsp;in&nbsp;again&nbsp;with&nbsp;the&nbsp;grmawcadmin&nbsp;user&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&gt;&nbsp;Here&nbsp;are&nbsp;the&nbsp;updated&nbsp;logs&nbsp;as&nbsp;requested.&lt;br&gt;<br>
&gt;&nbsp;&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/div&gt;<br>
&lt;/span&gt;&lt;br&gt;<br>
&lt;hr&gt;<br>
&lt;font&nbsp;face=&quot;Arial&quot;&nbsp;color=&quot;Gray&quot;&nbsp;size=&quot;1&quot;&gt;&lt;br&gt;<br>
This&nbsp;transmission&nbsp;may&nbsp;contain&nbsp;information&nbsp;that&nbsp;is&nbsp;privileged,&nbsp;confidential,&nbsp;and/or&nbsp;exempt&nbsp;from&nbsp;disclosure&nbsp;under&nbsp;applicable&nbsp;law.&nbsp;If&nbsp;you&nbsp;are&nbsp;not&nbsp;the&nbsp;intended&nbsp;recipient,&nbsp;you&nbsp;are&nbsp;hereby&nbsp;notified&nbsp;that&nbsp;any&nbsp;disclosure,&nbsp;copying,&nbsp;distribution,&nbsp;or&nbsp;use&nbsp;of&nbsp;the&nbsp;information<br>
&nbsp;contained&nbsp;herein&nbsp;(including&nbsp;any&nbsp;reliance&nbsp;thereon)&nbsp;is&nbsp;strictly&nbsp;prohibited.&nbsp;If&nbsp;you&nbsp;received&nbsp;this&nbsp;transmission&nbsp;in&nbsp;error,&nbsp;please&nbsp;immediately&nbsp;contact&nbsp;the&nbsp;sender&nbsp;and&nbsp;destroy&nbsp;the&nbsp;material&nbsp;in&nbsp;its&nbsp;entirety,&nbsp;whether&nbsp;in&nbsp;electronic&nbsp;or&nbsp;hard&nbsp;copy&nbsp;format.&lt;br&gt;<br>
&lt;/font&gt;<br>
&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
