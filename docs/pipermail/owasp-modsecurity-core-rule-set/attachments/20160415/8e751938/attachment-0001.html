<tt>
&lt;html&gt;<br>
&lt;head&gt;<br>
&lt;/head&gt;<br>
&lt;body&nbsp;class='hmmessage'&gt;&lt;div&nbsp;dir='ltr'&gt;<br>
<br>
&lt;style&gt;&lt;!--<br>
.hmmessage&nbsp;P<br>
{<br>
margin:0px;<br>
padding:0px<br>
}<br>
body.hmmessage<br>
{<br>
font-size:&nbsp;12pt;<br>
font-family:Calibri<br>
}<br>
--&gt;&lt;/style&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;OK&nbsp;so&nbsp;the&nbsp;audit&nbsp;log&nbsp;shows&nbsp;shows&nbsp;this&nbsp;in&nbsp;your&nbsp;header:&lt;div&gt;&lt;br&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;Authorization:&nbsp;Basic&nbsp;Z3JtYXdjYWRtaW46dGVzdA==&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;The&nbsp;value&nbsp;of&nbsp;the&nbsp;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Authorization&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;header&nbsp;is&nbsp;therefore&nbsp;&quot;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Basic&nbsp;Z3JtYXdjYWRtaW46dGVzdA==&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&quot;&nbsp;which&nbsp;cannot&nbsp;be&nbsp;base64&nbsp;decoded&nbsp;due&nbsp;to&nbsp;that&nbsp;initial&nbsp;&quot;Basic&nbsp;&quot;&nbsp;part&nbsp;which&nbsp;is&nbsp;not&nbsp;Base&nbsp;64&nbsp;encoded.&nbsp;This&nbsp;is&nbsp;what&nbsp;you&nbsp;are&nbsp;supposed&nbsp;to&nbsp;send&nbsp;so&nbsp;nothing&nbsp;wrong&nbsp;with&nbsp;your&nbsp;header,&nbsp;but&nbsp;it&nbsp;explains&nbsp;why&nbsp;your&nbsp;rule&nbsp;is&nbsp;not&nbsp;working&nbsp;as&nbsp;ModSecurity&nbsp;does&nbsp;not&nbsp;know&nbsp;you&nbsp;only&nbsp;want&nbsp;to&nbsp;base64&nbsp;decode&nbsp;part&nbsp;of&nbsp;the&nbsp;header.&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;So&nbsp;you&nbsp;need&nbsp;to&nbsp;write&nbsp;a&nbsp;chained&nbsp;rule&nbsp;to&nbsp;capture&nbsp;the&nbsp;actual&nbsp;base64&nbsp;encoded&nbsp;part&nbsp;using&nbsp;backets&nbsp;and&nbsp;&quot;capture&quot;&nbsp;and&nbsp;then&nbsp;base&nbsp;64&nbsp;decode&nbsp;the&nbsp;TX:1&nbsp;variable&nbsp;which&nbsp;is&nbsp;captured:&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;&quot;REQUEST_HEADERS:Authorization&quot;&nbsp;&quot;^Basic&nbsp;(.*)$&quot;&nbsp;&quot;phase:1,id:1003,log,capture,chai&lt;span&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;n,deny,status:403&quot;&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SecRule&nbsp;TX:1&nbsp;&quot;@contains&nbsp;admin&quot;&nbsp;&quot;t:base64Decode&quot;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;I've&nbsp;tested&nbsp;this&nbsp;and&nbsp;it&nbsp;seems&nbsp;to&nbsp;work.&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Thanks,&lt;/div&gt;&lt;div&nbsp;style=&quot;font-size:&nbsp;12pt;&quot;&gt;Barry&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;br&gt;&lt;div&gt;&gt;&nbsp;From:&nbsp;Gary.Mansell@ricardo.com&lt;br&gt;&gt;&nbsp;To:&nbsp;barry_pollard@hotmail.com;&nbsp;csanders@trustwave.com;&nbsp;owasp-modsecurity-core-rule-set@lists.owasp.org&lt;br&gt;&gt;&nbsp;Subject:&nbsp;RE:&nbsp;[Owasp-modsecurity-core-rule-set]&nbsp;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;use&nbsp;modsecurity&nbsp;rules&nbsp;to&nbsp;prevent&nbsp;logins&nbsp;by&nbsp;specific&nbsp;user&nbsp;accounts?&lt;br&gt;&gt;&nbsp;Date:&nbsp;Fri,&nbsp;15&nbsp;Apr&nbsp;2016&nbsp;10:37:16&nbsp;+0000&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;I&nbsp;added&nbsp;the&nbsp;rule,&nbsp;cleared&nbsp;the&nbsp;logs&nbsp;and&nbsp;logged&nbsp;in&nbsp;again&nbsp;with&nbsp;the&nbsp;grmawcadmin&nbsp;user&lt;br&gt;&gt;&nbsp;&lt;br&gt;&gt;&nbsp;Here&nbsp;are&nbsp;the&nbsp;updated&nbsp;logs&nbsp;as&nbsp;requested.&lt;br&gt;&gt;&nbsp;&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;&lt;/body&gt;<br>
&lt;/html&gt;
</tt>
