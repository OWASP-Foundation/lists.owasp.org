<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Thanks&nbsp;Christian,&nbsp;I&nbsp;appreciate&nbsp;your&nbsp;help!&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Aug&nbsp;16,&nbsp;2017&nbsp;at&nbsp;12:46&nbsp;AM,&nbsp;Christian&nbsp;Folini&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&nbsp;target=&quot;_blank&quot;&gt;christian.folini@netnea.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;Do&nbsp;you&nbsp;have&nbsp;a&nbsp;paper&nbsp;copy&nbsp;of&nbsp;the&nbsp;book?&nbsp;If&nbsp;not,&nbsp;then&nbsp;please&nbsp;give&nbsp;me&nbsp;your&lt;br&gt;<br>
address&nbsp;and&nbsp;I&nbsp;will&nbsp;have&nbsp;a&nbsp;copy&nbsp;be&nbsp;sent&nbsp;your&nbsp;way.&nbsp;Ironically,&nbsp;it&nbsp;will&lt;br&gt;<br>
come&nbsp;with&nbsp;the&nbsp;bug,&nbsp;but&nbsp;I&nbsp;really&nbsp;appreciate&nbsp;people&nbsp;submitting&nbsp;errors&nbsp;the&lt;br&gt;<br>
encounter&nbsp;in&nbsp;the&nbsp;book.&lt;span&nbsp;class=&quot;gmail-&quot;&gt;&lt;br&gt;&lt;/span&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&#39;s&nbsp;not&nbsp;necessary,&nbsp;thanks&nbsp;for&nbsp;the&nbsp;offer.&nbsp;I&#39;ve&nbsp;already&nbsp;got&nbsp;the&nbsp;electronic&nbsp;version,&nbsp;and&nbsp;the&nbsp;paper&nbsp;copy&nbsp;is&nbsp;shipping&nbsp;as&nbsp;we&nbsp;speak&nbsp;:)&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left:1px&nbsp;solid&nbsp;rgb(204,204,204);padding-left:1ex&quot;&gt;&lt;span&nbsp;class=&quot;gmail-&quot;&gt;<br>
&gt;&nbsp;If&nbsp;you&nbsp;have&nbsp;any&nbsp;ideas&nbsp;on&nbsp;how&nbsp;to&nbsp;further&nbsp;restrict&nbsp;it&nbsp;so&nbsp;I&nbsp;can&nbsp;rule&nbsp;the&nbsp;SQLi&lt;br&gt;<br>
&gt;&nbsp;rules&nbsp;for&nbsp;only&nbsp;one&nbsp;page&nbsp;+&nbsp;parameter&nbsp;combo,&nbsp;I&#39;m&nbsp;interested&nbsp;to&nbsp;know!&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/span&gt;With&nbsp;ctl:ruleUpdateTargetById&nbsp;being&nbsp;no&nbsp;longer&nbsp;an&nbsp;option,&nbsp;we&nbsp;need&nbsp;a&lt;br&gt;<br>
different&nbsp;approach.&nbsp;This&nbsp;is&nbsp;turning&nbsp;more&nbsp;and&nbsp;more&nbsp;into&nbsp;a&nbsp;wild&nbsp;hack,&nbsp;but&lt;br&gt;<br>
let&#39;s&nbsp;try&nbsp;out&nbsp;the&nbsp;following:&lt;br&gt;<br>
&lt;br&gt;<br>
-&nbsp;Remove&nbsp;all&nbsp;the&nbsp;ARGS&nbsp;at&nbsp;startup&nbsp;time&lt;br&gt;<br>
-&nbsp;Add&nbsp;ARGS:SearchTerm&nbsp;at&nbsp;startup&nbsp;time&lt;br&gt;<br>
-&nbsp;Remove&nbsp;SearchTerm&nbsp;from&nbsp;all&nbsp;paths&nbsp;but&nbsp;/product/search&nbsp;at&nbsp;runtime&lt;br&gt;<br>
 &nbsp;-&gt;&nbsp;&quot;!@beginsWith&nbsp;/product/search&quot;&lt;br&gt;<br>
&lt;br&gt;<br>
Good&nbsp;luck&nbsp;and&nbsp;please&nbsp;report&nbsp;back!&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;That&nbsp;works&nbsp;well.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&#39;s&nbsp;my&nbsp;canonical&nbsp;&quot;How&nbsp;you&nbsp;run&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&#39;s&nbsp;SQLi&nbsp;rules&nbsp;only&nbsp;on&nbsp;vulnerable&nbsp;pages&nbsp;and&nbsp;parameters&quot;&nbsp;for&nbsp;historical&nbsp;/&nbsp;archival&nbsp;reference:&lt;/div&gt;&lt;div&gt;&lt;br&gt;These&nbsp;rules&nbsp;disable&nbsp;the&nbsp;SQL&nbsp;injection&nbsp;rules&nbsp;in&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;v3,&nbsp;except&nbsp;for&nbsp;two&nbsp;parameters:&nbsp;&quot;SearchTerm&quot;&nbsp;and&nbsp;&quot;foo&quot;.&nbsp;This&nbsp;is&nbsp;done&nbsp;at&nbsp;configuration&nbsp;time,&nbsp;so&nbsp;the&nbsp;SecRuleUpdateTargetByID&nbsp;statements&nbsp;have&nbsp;to&nbsp;go&nbsp;after&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;is&nbsp;included.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Then&nbsp;at&nbsp;runtime,&nbsp;we&nbsp;narrow&nbsp;down&nbsp;the&nbsp;list&nbsp;of&nbsp;pages&nbsp;that&nbsp;the&nbsp;SQLi&nbsp;rules&nbsp;are&nbsp;run&nbsp;against,&nbsp;by&nbsp;removing&nbsp;the&nbsp;two&nbsp;parameters&nbsp;&quot;SearchTerm&quot;&nbsp;and&nbsp;&quot;foo&quot;&nbsp;depending&nbsp;on&nbsp;which&nbsp;URL&nbsp;is&nbsp;being&nbsp;requested.&nbsp;As&nbsp;this&nbsp;is&nbsp;at&nbsp;runtime,&nbsp;these&nbsp;two&nbsp;rules&nbsp;need&nbsp;to&nbsp;go&nbsp;before&nbsp;the&nbsp;Core&nbsp;Rule&nbsp;Set&nbsp;rules&nbsp;are&nbsp;included,&nbsp;so&nbsp;that&nbsp;the&nbsp;change&nbsp;to&nbsp;their&nbsp;Target&nbsp;is&nbsp;done&nbsp;before&nbsp;they&nbsp;run.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;#&nbsp;Rutime:&nbsp;Only&nbsp;run&nbsp;the&nbsp;SQLi&nbsp;rules&nbsp;against&nbsp;SearchTerm&nbsp;if&nbsp;on&nbsp;the&nbsp;Product&nbsp;Search&nbsp;page&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;!@beginsWith&nbsp;/product/search&quot;&nbsp;\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp;&quot;id:2011,phase:2,\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;pass,nolog,\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;t:none,t:lowercase,t:normalisePath,\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;ctl:ruleRemoveTargetById=942100-942999;ARGS:SearchTerm&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;#&nbsp;Runtime:&nbsp;Only&nbsp;run&nbsp;the&nbsp;SQLi&nbsp;rules&nbsp;against&nbsp;argument&nbsp;foo&nbsp;if&nbsp;on&nbsp;the&nbsp;About&nbsp;page&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;blockquote&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;40px;border:none;padding:0px&quot;&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;REQUEST_FILENAME&nbsp;&quot;!@beginsWith&nbsp;/home/about&quot;&nbsp;\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp;&quot;id:2012,phase:2,\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;pass,nolog,\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;t:none,t:lowercase,t:normalisePath,\&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt; &nbsp; &nbsp; &nbsp; &nbsp;ctl:ruleRemoveTargetById=942100-942999;ARGS:foo&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;Include&nbsp;modsecurity/crs-setup.conf&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;Include&nbsp;crs/*.conf&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;#&nbsp;Configure-Time:&nbsp;Disable&nbsp;CRS&#39;s&nbsp;SQLi&nbsp;rules:&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!REQUEST_COOKIES&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!REQUEST_COOKIES_NAMES&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!ARGS_NAMES&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!ARGS&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;!XML&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;#&nbsp;Configure-Time:&nbsp;Only&nbsp;test&nbsp;SQLi&nbsp;for&nbsp;the&nbsp;SearchTerm&nbsp;&amp;&nbsp;foo&nbsp;parameters&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;ARGS:SearchTerm&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;SecRuleUpdateTargetByID&nbsp;942100-942999&nbsp;&quot;ARGS:foo&quot;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;div&gt;#&nbsp;(Jump&nbsp;back&nbsp;up&nbsp;to&nbsp;ID&nbsp;2011&nbsp;and&nbsp;2012&nbsp;above&nbsp;the&nbsp;include&nbsp;for&nbsp;CRS,&nbsp;to&nbsp;see&nbsp;the&nbsp;rest&nbsp;of&nbsp;the&nbsp;rules)&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;appreciate&nbsp;your&nbsp;help&nbsp;getting&nbsp;this&nbsp;working. &lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Cheers,&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Kirk&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
