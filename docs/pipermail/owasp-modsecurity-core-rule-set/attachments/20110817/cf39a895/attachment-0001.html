<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=windows-1252&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;http-equiv=&quot;Content-Type&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Me&nbsp;too&nbsp;-&nbsp;I'm&nbsp;seeing&nbsp;981248&nbsp;and&nbsp;981173&nbsp;trigger&nbsp;on&nbsp;cookies&nbsp;containing<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;7or&quot;&nbsp;and&nbsp;&quot;8Or&quot;&nbsp;(ie&nbsp;&quot;8or&quot;).&nbsp;Sounds&nbsp;like&nbsp;there's&nbsp;a&nbsp;bunch&nbsp;of&nbsp;rules<br>
&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;are&nbsp;triggering&nbsp;on&nbsp;3-char&nbsp;matches&nbsp;-&nbsp;that&nbsp;is&nbsp;waaaaay&nbsp;too&nbsp;small&nbsp;-<br>
&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;FP&nbsp;rate&nbsp;is&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;large!&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(I&nbsp;just&nbsp;joined&nbsp;today&nbsp;and&nbsp;the&nbsp;very&nbsp;first&nbsp;email&nbsp;I&nbsp;see&nbsp;is&nbsp;about&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;very&nbsp;problem&nbsp;I&nbsp;just&nbsp;joined&nbsp;the&nbsp;list&nbsp;about.&nbsp;Freaky)&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Jason&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;17/08/11&nbsp;15:34,&nbsp;Paul&nbsp;McGarry&nbsp;wrote:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote<br>
cite=&quot;mid:CAPrE0SYFrFRfGrCmiCV2vfYYPUatkMJJiMH1d=F4dpg-dFY63g@mail.gmail.com&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charset=windows-1252&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;name=&quot;Generator&quot;&nbsp;content=&quot;MS&nbsp;Exchange&nbsp;Server&nbsp;version<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5.7654.12&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;[Owasp-modsecurity-core-rule-set]&nbsp;981242&nbsp;SQL&nbsp;Injection<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;detectionfalse&nbsp;positives?&lt;/title&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;!--&nbsp;Converted&nbsp;from&nbsp;text/plain&nbsp;format&nbsp;--&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;&lt;font&nbsp;size=&quot;2&quot;&gt;Hi&nbsp;all,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;am&nbsp;seeing&nbsp;quite&nbsp;a&nbsp;lot&nbsp;of&nbsp;false&nbsp;positives&nbsp;on&nbsp;SQL&nbsp;injection<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;errors.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;of&nbsp;them&nbsp;is&nbsp;rule&nbsp;981242&nbsp;which&nbsp;is&nbsp;objecting&nbsp;to&nbsp;a&nbsp;cookie:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;test=asfnsdh2fub9tl6gt0mand504&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;regex:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(\&quot;|'|`|´|’|‘)\s*x?or|div|like|between|and\s*(\&quot;|'|`|´|’|‘)?\d&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;on&nbsp;&quot;and5&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1)&nbsp;Is&nbsp;the&nbsp;regex&nbsp;missing&nbsp;some&nbsp;grouping?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;As&nbsp;written&nbsp;it&nbsp;seems&nbsp;that&nbsp;(x)or&nbsp;is&nbsp;being&nbsp;treated&nbsp;differently<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;than&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;div/like/between/and,&nbsp;ie&nbsp;the&nbsp;(x)or&nbsp;case&nbsp;requires&nbsp;one&nbsp;of&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;quote&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;characters&nbsp;before&nbsp;it&nbsp;while&nbsp;the&nbsp;others&nbsp;don't.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Should&nbsp;that&nbsp;part&nbsp;of&nbsp;the&nbsp;regex&nbsp;be:&lt;br&gt;<br>
(\&quot;|'|`|´|’|‘)\s*(?:x?or|div|like|between|and)\s*(\&quot;|'|`|´|’|‘)?\d&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;Should&nbsp;&quot;and&quot;&nbsp;being&nbsp;followed&nbsp;directly&nbsp;by&nbsp;a&nbsp;number,&nbsp;without<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;space&nbsp;or&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;quote,&nbsp;be&nbsp;a&nbsp;match?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;my&nbsp;SQL&nbsp;server&nbsp;(Postgres)&nbsp;I&nbsp;think&nbsp;&quot;and5&quot;&nbsp;would&nbsp;be&nbsp;a&nbsp;syntax<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error&nbsp;(as&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;opposed&nbsp;to&nbsp;&quot;and'5&quot;&nbsp;or&nbsp;&quot;and&nbsp;5&quot;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Would:&lt;br&gt;<br>
(\&quot;|'|`|´|’|‘)\s*(?:x?or|div|like|between|and)(?:(\&quot;|'|`|´|’|‘)|\s+(\&quot;|'|`|´|’|‘)?)\d&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be&nbsp;a&nbsp;tighter&nbsp;match?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Paul&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_______________________________________________&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;<br>
href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/font&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;class=&quot;moz-signature&quot;&nbsp;cols=&quot;72&quot;&gt;--&nbsp;<br>
Cheers<br>
<br>
Jason&nbsp;Haar<br>
Information&nbsp;Security&nbsp;Manager,&nbsp;Trimble&nbsp;Navigation&nbsp;Ltd.<br>
Phone:&nbsp;+1&nbsp;408&nbsp;481&nbsp;8171<br>
PGP&nbsp;Fingerprint:&nbsp;7A2E&nbsp;0407&nbsp;C9A6&nbsp;CAF6&nbsp;2B9F&nbsp;8422&nbsp;C063&nbsp;5EBB&nbsp;FE1D&nbsp;66D1<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
