<tt>
Good&nbsp;news.&nbsp;Can&nbsp;you&nbsp;share&nbsp;some&nbsp;information&nbsp;in&nbsp;advance:)&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;2010/3/23&nbsp;Ryan&nbsp;Barnett&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:ryan.barnett@breach.com&quot;&gt;ryan.barnett@breach.com&lt;/a&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;On&nbsp;Tuesday&nbsp;23&nbsp;March&nbsp;2010&nbsp;11:16:03&nbsp;Chris&nbsp;Datfung&nbsp;wrote:&lt;br&gt;<br>
&amp;gt;&nbsp;I&amp;#39;m&nbsp;trying&nbsp;to&nbsp;implement&nbsp;CSRF&nbsp;protection&nbsp;in&nbsp;an&nbsp;app&nbsp;based&nbsp;on&nbsp;Ryan&amp;#39;s&nbsp;example&lt;br&gt;<br>
&amp;gt;&nbsp;from&nbsp;the&nbsp;WAF&nbsp;Patching&nbsp;Challenge&nbsp;Whitepaper.&nbsp;My&nbsp;app&nbsp;uses&nbsp;a&nbsp;dynamic&nbsp;session&lt;br&gt;<br>
&amp;gt;&nbsp;token&nbsp;name&nbsp;where&nbsp;only&nbsp;the&nbsp;first&nbsp;four&nbsp;characters&nbsp;(SESS)&nbsp;are&nbsp;static.&nbsp;An&lt;br&gt;<br>
&amp;gt;&nbsp;example&nbsp;cookie&nbsp;name&nbsp;is:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;SESSbe7bfb0d134fa57e567359f4e62cf41d&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;The&nbsp;problem&nbsp;I&nbsp;have&nbsp;is&nbsp;how&nbsp;to&nbsp;implement&nbsp;this&nbsp;rule:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule&nbsp;&amp;amp;ARGS&nbsp;&amp;quot;@ge&nbsp;1&amp;quot;&nbsp;&amp;quot;chain,phase:2,t:none,deny,log,msg:&amp;#39;CSRF&nbsp;Attack&lt;br&gt;<br>
&amp;gt;&nbsp;Detected&nbsp;-&nbsp;Invalid&nbsp;Token.&amp;#39;&amp;quot;&lt;br&gt;<br>
&amp;gt;&nbsp; SecRule&nbsp;ARGS:MODSEC_CSRF_TOKEN&nbsp;&amp;quot;!@streq&nbsp;%{request_cookies.jsessionid}&amp;quot;&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;How&nbsp;do&nbsp;I&nbsp;compare&nbsp;MODSEC_CSRF_TOKEN&nbsp;to&nbsp;a&nbsp;cookie&nbsp;name&nbsp;where&nbsp;I&nbsp;only&nbsp;know&nbsp;the&lt;br&gt;<br>
&amp;gt;&nbsp;the&nbsp;first&nbsp;four&nbsp;characters.&nbsp;I&nbsp;tried:&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;SecRule&nbsp;ARGS:MODSEC_CSRF_TOKEN&nbsp;&amp;quot;!@streq&nbsp;%{request_cookies./^SESS/}&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;but&nbsp;that&nbsp;obviously&nbsp;didn&amp;#39;t&nbsp;work.&nbsp;Any&nbsp;ideas&nbsp;how&nbsp;I&nbsp;can&nbsp;do&nbsp;this?&lt;br&gt;<br>
&amp;gt;&lt;br&gt;<br>
&amp;gt;&nbsp;Thanks&lt;br&gt;<br>
&amp;gt;&nbsp; &nbsp;Chris&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;How&nbsp;appropriate&nbsp;as&nbsp;I&nbsp;was&nbsp;getting&nbsp;ready&nbsp;to&nbsp;send&nbsp;out&nbsp;some&nbsp;announcements&nbsp;soon&nbsp;that&nbsp;we&nbsp;will&nbsp;be&lt;br&gt;<br>
migrating&nbsp;some&nbsp;of&nbsp;the&nbsp;commercial&nbsp;Enhanced&nbsp;Rule&nbsp;Set&nbsp;(ERS)&nbsp;items&nbsp;to&nbsp;the&nbsp;CRS&nbsp;and&nbsp;CSRF&lt;br&gt;<br>
protection&nbsp;rules&nbsp;are&nbsp;one&nbsp;of&nbsp;them&nbsp;:)&lt;br&gt;<br>
&lt;br&gt;<br>
Once&nbsp;I&nbsp;add&nbsp;these&nbsp;rules&nbsp;to&nbsp;the&nbsp;CRS,&nbsp;I&nbsp;will&nbsp;send&nbsp;a&nbsp;note&nbsp;to&nbsp;the&nbsp;OWASP&nbsp;CRS&nbsp;mail-list&nbsp;with&lt;br&gt;<br>
usage&nbsp;info.&lt;br&gt;<br>
&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
-Ryan&lt;br&gt;<br>
_______________________________________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
