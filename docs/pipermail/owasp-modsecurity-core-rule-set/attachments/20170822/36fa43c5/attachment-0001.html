<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;If&nbsp;you&nbsp;are&nbsp;using&nbsp;ModSecurity&nbsp;2.x&nbsp;on&nbsp;Nginx&nbsp;there&nbsp;are&nbsp;known&nbsp;issues&nbsp;with&nbsp;request&nbsp;body&nbsp;processing&nbsp;in&nbsp;many&nbsp;situations,&nbsp;make&nbsp;sure&nbsp;to&nbsp;try&nbsp;2.9.2.&nbsp;ModSecurity&nbsp;3.x&nbsp;is&nbsp;being&nbsp;developed&nbsp;to&nbsp;solve&nbsp;these&nbsp;issues. &lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Aug&nbsp;22,&nbsp;2017&nbsp;at&nbsp;12:55&nbsp;PM,&nbsp;Georgi&nbsp;Georgiev&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:georgi@serversolution.info&quot;&nbsp;target=&quot;_blank&quot;&gt;georgi@serversolution.info&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;&lt;div&nbsp;style=&quot;word-wrap:break-word&quot;&gt;As&nbsp;I&nbsp;read&nbsp;I&nbsp;think&nbsp;the&nbsp;problem&nbsp;is&nbsp;related&nbsp;to&nbsp;this.&nbsp;Don’t&nbsp;you&nbsp;think&nbsp;so?&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://www.bountysource.com/issues/1573623-nginx-with-modsecurity-post-request-gives-500-error&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.bountysource.com/&lt;wbr&gt;issues/1573623-nginx-with-&lt;wbr&gt;modsecurity-post-request-&lt;wbr&gt;gives-500-error&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;div&gt;On&nbsp;Aug&nbsp;22,&nbsp;2017,&nbsp;at&nbsp;7:53&nbsp;PM,&nbsp;Christian&nbsp;Folini&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&nbsp;target=&quot;_blank&quot;&gt;christian.folini@netnea.com&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;m_-4269040028389741475Apple-interchange-newline&quot;&gt;&lt;div&gt;&lt;div&gt;Hey&nbsp;Georgi,&lt;br&gt;&lt;br&gt;The&lt;br&gt;&lt;br&gt;&quot;Message:&nbsp;Audit&nbsp;log:&nbsp;Failed&nbsp;to&nbsp;lock&nbsp;global&nbsp;mutex:&nbsp;Permission&nbsp;denied&quot;&lt;br&gt;&lt;br&gt;in&nbsp;combination&nbsp;with&nbsp;the&nbsp;SecRequestBodyAccess&nbsp;is&nbsp;a&nbsp;bad&nbsp;sign.&lt;br&gt;&lt;br&gt;You&nbsp;should&nbsp;try&nbsp;and&nbsp;solve&nbsp;that&nbsp;permission&nbsp;problem.&nbsp;I&nbsp;would&nbsp;not&nbsp;be&lt;br&gt;surprised&nbsp;if&nbsp;it&nbsp;would&nbsp;be&nbsp;linked.&lt;br&gt;&lt;br&gt;Ahoj,&lt;br&gt;&lt;br&gt;Christian&lt;br&gt;&lt;br&gt;&lt;br&gt;On&nbsp;Tue,&nbsp;Aug&nbsp;22,&nbsp;2017&nbsp;at&nbsp;07:27:11PM&nbsp;+0300,&nbsp;Georgi&nbsp;Georgiev&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&nbsp;  If&nbsp;I&nbsp;comment&nbsp;this&nbsp;line&nbsp;everything&nbsp;works:&lt;br&gt;&nbsp;  SecRequestBodyAccess&nbsp;On&lt;br&gt;&nbsp;  But&nbsp;this&nbsp;should&nbsp;be&nbsp;enabled.&nbsp;Any&nbsp;suggestions?&lt;br&gt;&lt;br&gt;&nbsp;    On&nbsp;Aug&nbsp;22,&nbsp;2017,&nbsp;at&nbsp;6:16&nbsp;PM,&nbsp;Georgi&nbsp;Georgiev&lt;br&gt;&nbsp;    &lt;&lt;a&nbsp;href=&quot;mailto:georgi@serversolution.info&quot;&nbsp;target=&quot;_blank&quot;&gt;georgi@serversolution.&lt;wbr&gt;info&lt;/a&gt;&gt;&nbsp;wrote:&lt;br&gt;&nbsp;    Hello,&lt;br&gt;&nbsp;    If&nbsp;I&nbsp;enable&nbsp;crs&nbsp;for&nbsp;this&nbsp;domain&nbsp;on&nbsp;the&nbsp;Joomla&nbsp;search&nbsp;of&nbsp;the&nbsp;site&nbsp;it&lt;br&gt;&nbsp;    returns&nbsp;400&nbsp;bad&nbsp;request,&nbsp;but&nbsp;the&nbsp;modsec&nbsp;is&nbsp;in&nbsp;detection&nbsp;only&nbsp;mode.&nbsp;No&lt;br&gt;&nbsp;    rule&nbsp;is&nbsp;matched&nbsp;as&nbsp;I&nbsp;see.&nbsp;If&nbsp;I&nbsp;turn&nbsp;off&nbsp;the&nbsp;modsec&nbsp;everything&nbsp;is&nbsp;ok.&lt;br&gt;&nbsp;    This&nbsp;is&nbsp;the&nbsp;audit&nbsp;log&nbsp;if&nbsp;it&nbsp;helps:&nbsp;&lt;br&gt;&nbsp;    [22/Aug/2017:17:08:15&nbsp;+0300]&nbsp;IcAcAcVcAcccAcAcAAxcAcAc&nbsp;77.70.108.119&lt;br&gt;&nbsp;    53428&nbsp;127.0.0.1&nbsp;80&lt;br&gt;&nbsp;    --bc7c6349-B--&lt;br&gt;&nbsp;    POST&nbsp;/index.php&nbsp;HTTP/2.0&lt;br&gt;&nbsp;    host:&nbsp;&lt;a&nbsp;href=&quot;http://www.plevensport.eu&quot;&nbsp;target=&quot;_blank&quot;&gt;www.plevensport.eu&lt;/a&gt;&lt;br&gt;&nbsp;    content-length:&nbsp;86&lt;br&gt;&nbsp;    cache-control:&nbsp;max-age=0&lt;br&gt;&nbsp;    origin:&nbsp;&lt;a&nbsp;href=&quot;https://www.plevensport.eu&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.plevensport.eu&lt;/a&gt;&lt;br&gt;&nbsp;    upgrade-insecure-requests:&nbsp;1&lt;br&gt;&nbsp;    user-agent:&nbsp;Mozilla/5.0&nbsp;(Macintosh;&nbsp;Intel&nbsp;Mac&nbsp;OS&nbsp;X&nbsp;10_12_5)&lt;br&gt;&nbsp;    AppleWebKit/537.36&nbsp;(KHTML,&nbsp;like&nbsp;Gecko)&nbsp;Chrome/60.0.3112.101&lt;br&gt;&nbsp;    Safari/537.36&lt;br&gt;&nbsp;    content-type:&nbsp;application/x-www-form-&lt;wbr&gt;urlencoded&lt;br&gt;&nbsp;    accept:&lt;br&gt;&nbsp;    text/html,application/&lt;wbr&gt;xhtml+xml,application/xml;q=0.&lt;wbr&gt;9,image/webp,image/apng,*/*;q=&lt;wbr&gt;0.8&lt;br&gt;&nbsp;    referer:&nbsp;&lt;a&nbsp;href=&quot;https://www.plevensport.eu/index.php&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.plevensport.eu/&lt;wbr&gt;index.php&lt;/a&gt;&lt;br&gt;&nbsp;    accept-encoding:&nbsp;gzip,&nbsp;deflate,&nbsp;br&lt;br&gt;&nbsp;    accept-language:&nbsp;en-US,en;q=0.8&lt;br&gt;&nbsp;    cookie:&lt;br&gt;&nbsp;    &lt;wbr&gt;53f8f9fad3d3789bffbdbce160246b&lt;wbr&gt;7e=&lt;wbr&gt;3b72edc95ab809ce6dc6b3755305ad&lt;wbr&gt;f1;&lt;br&gt;&nbsp;    __utmt=1;&nbsp;_c=y;&lt;br&gt;&nbsp;    __utma=155943930.&lt;wbr&gt;1578748701.1503409083.&lt;wbr&gt;1503409083.1503409083.1;&lt;br&gt;&nbsp;    __utmb=155943930.9.10.&lt;wbr&gt;1503409083;&nbsp;__utmc=155943930;&lt;br&gt;&nbsp;    __utmz=155943930.&lt;wbr&gt;1503409083.1.1.utmcsr=(direct)&lt;wbr&gt;|utmccn=(direct)|utmcmd=(none)&lt;br&gt;&nbsp;    --bc7c6349-C--&lt;br&gt;&nbsp;    searchword=%D0%BF%D0%BB%&lt;wbr&gt;D0%B5%D0%B2%D0%B5%D0%BD&amp;task=&lt;wbr&gt;search&amp;option=com_search&amp;&lt;wbr&gt;Itemid=1&lt;br&gt;&nbsp;    --bc7c6349-F--&lt;br&gt;&nbsp;    HTTP/1.1&nbsp;400&lt;br&gt;&nbsp;    Server:&nbsp;ws-httpd&lt;br&gt;&nbsp;    Content-Type:&nbsp;text/html&lt;br&gt;&nbsp;    Content-Length:&nbsp;568&lt;br&gt;&nbsp;    Connection:&nbsp;close&lt;br&gt;&nbsp;    --bc7c6349-E--&lt;br&gt;&nbsp;    &lt;html&gt;&lt;br&gt;&nbsp;    &lt;head&gt;&lt;title&gt;400&nbsp;Bad&nbsp;Request&lt;/title&gt;&lt;/head&gt;&lt;br&gt;&nbsp;    &lt;body&nbsp;bgcolor=&quot;white&quot;&gt;&lt;br&gt;&nbsp;    &lt;center&gt;&lt;h1&gt;400&nbsp;Bad&nbsp;Request&lt;/h1&gt;&lt;/center&gt;&lt;br&gt;&nbsp;    &lt;hr&gt;&lt;center&gt;nginx&lt;/center&gt;&lt;br&gt;&nbsp;    &lt;/body&gt;&lt;br&gt;&nbsp;    &lt;/html&gt;&lt;br&gt;&nbsp;    &lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;&lt;br&gt;&nbsp;    &lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;&lt;br&gt;&nbsp;    &lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;&lt;br&gt;&nbsp;    &lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;&lt;br&gt;&nbsp;    &lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;&lt;br&gt;&nbsp;    &lt;!--&nbsp;a&nbsp;padding&nbsp;to&nbsp;disable&nbsp;MSIE&nbsp;and&nbsp;Chrome&nbsp;friendly&nbsp;error&nbsp;page&nbsp;--&gt;&lt;br&gt;&nbsp;    --bc7c6349-H--&lt;br&gt;&nbsp;    Message:&nbsp;Audit&nbsp;log:&nbsp;Failed&nbsp;to&nbsp;lock&nbsp;global&nbsp;mutex:&nbsp;Permission&nbsp;denied&lt;br&gt;&nbsp;    Apache-Handler:&nbsp;IIS&lt;br&gt;&nbsp;    Stopwatch:&nbsp;1503410895000281&nbsp;417063&nbsp;(-&nbsp;-&nbsp;-)&lt;br&gt;&nbsp;    Stopwatch2:&nbsp;1503410895000281&nbsp;417063;&nbsp;combined=44304,&nbsp;p1=732,&nbsp;p2=42473,&lt;br&gt;&nbsp;    p3=47,&nbsp;p4=723,&nbsp;p5=229,&nbsp;sr=148,&nbsp;sw=100,&nbsp;l=0,&nbsp;gc=0&lt;br&gt;&nbsp;    Response-Body-Transformed:&nbsp;Dechunked&lt;br&gt;&nbsp;    Producer:&nbsp;ModSecurity&nbsp;for&nbsp;nginx&nbsp;(STABLE)/2.9.1&lt;br&gt;&nbsp;    (&lt;a&nbsp;href=&quot;http://www.modsecurity.org/&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.modsecurity.&lt;wbr&gt;org/&lt;/a&gt;);&nbsp;OWASP_CRS/&lt;a&nbsp;href=&quot;http://3.0.2.&quot;&nbsp;target=&quot;_blank&quot;&gt;3.0.2.&lt;/a&gt;&lt;br&gt;&nbsp;    Server:&nbsp;ModSecurity&nbsp;Standalone&lt;br&gt;&nbsp;    Engine-Mode:&nbsp;&quot;ENABLED&quot;&lt;br&gt;&nbsp;    --bc7c6349-Z--&lt;br&gt;&nbsp;    As&nbsp;itâ**s&nbsp;not&nbsp;exactly&nbsp;error&nbsp;which&nbsp;can&nbsp;occur&nbsp;because&nbsp;of&nbsp;modsec&nbsp;but&nbsp;itâ**s&lt;br&gt;&nbsp;    obviously&nbsp;the&nbsp;problem&nbsp;what&nbsp;can&nbsp;be&nbsp;the&nbsp;reason?&nbsp;Some&nbsp;directive?&lt;br&gt;&nbsp;    __________________________&lt;wbr&gt;_____________________&lt;br&gt;&nbsp;    Owasp-modsecurity-core-&lt;wbr&gt;rule-set&nbsp;mailing&nbsp;list&lt;br&gt;&nbsp;    &lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-&lt;wbr&gt;rule-set@lists.owasp.org&lt;/a&gt;&lt;br&gt;&nbsp;    &lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/&lt;wbr&gt;mailman/listinfo/owasp-&lt;wbr&gt;modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;______________________________&lt;wbr&gt;_________________&lt;br&gt;Owasp-modsecurity-core-rule-&lt;wbr&gt;set&nbsp;mailing&nbsp;list&lt;br&gt;&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Owasp-modsecurity-core-rule-&lt;wbr&gt;set@lists.owasp.org&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/&lt;wbr&gt;mailman/listinfo/owasp-&lt;wbr&gt;modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;&lt;br&gt;--&nbsp;&lt;br&gt;ModSecurity&nbsp;courses&nbsp;Oct&nbsp;2017&nbsp;in&nbsp;London&nbsp;and&nbsp;Zurich&lt;br&gt;&lt;a&nbsp;href=&quot;https://www.feistyduck.com/training/modsecurity-training-course&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.feistyduck.com/&lt;wbr&gt;training/modsecurity-training-&lt;wbr&gt;course&lt;/a&gt;&lt;br&gt;&lt;a&nbsp;href=&quot;https://www.feistyduck.com/books/modsecurity-handbook/&quot;&nbsp;target=&quot;_blank&quot;&gt;https://www.feistyduck.com/&lt;wbr&gt;books/modsecurity-handbook/&lt;/a&gt;&lt;br&gt;mailto:&lt;a&nbsp;href=&quot;mailto:christian.folini@netnea.com&quot;&nbsp;target=&quot;_blank&quot;&gt;christian.folini@&lt;wbr&gt;netnea.com&lt;/a&gt;&lt;br&gt;twitter:&nbsp;@ChrFolini&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;br&gt;______________________________&lt;wbr&gt;_________________&lt;br&gt;<br>
Owasp-modsecurity-core-rule-&lt;wbr&gt;set&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Owasp-modsecurity-core-rule-set@lists.owasp.org&quot;&gt;Owasp-modsecurity-core-rule-&lt;wbr&gt;set@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set&quot;&nbsp;rel=&quot;noreferrer&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/&lt;wbr&gt;mailman/listinfo/owasp-&lt;wbr&gt;modsecurity-core-rule-set&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;--&nbsp;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_signature&quot;&nbsp;data-smartmail=&quot;gmail_signature&quot;&gt;--&nbsp;&lt;br&gt;Chaim&nbsp;Sanders&lt;br&gt;&lt;a&nbsp;href=&quot;http://www.ChaimSanders.com&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.ChaimSanders.com&lt;/a&gt;&lt;br&gt;&lt;/div&gt;<br>
&lt;/div&gt;<br>

</tt>
