<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Apr&nbsp;1,&nbsp;2014&nbsp;at&nbsp;5:17&nbsp;PM,&nbsp;Ty&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:ty733420@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;ty733420@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0px&nbsp;0px&nbsp;0px&nbsp;0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex&quot;&gt;<br>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;I&nbsp;know&nbsp;this&nbsp;rule&nbsp;(950109)&nbsp;has&nbsp;been&nbsp;brought&nbsp;up&nbsp;on&nbsp;this&nbsp;list&nbsp;before&nbsp;because&nbsp;posters&nbsp;were&nbsp;confused&nbsp;by&nbsp;its&nbsp;behavior&nbsp;for&nbsp;various&nbsp;reasons.&nbsp; I&#39;m&nbsp;also&nbsp;by&nbsp;something&nbsp;very&nbsp;specific&nbsp;about&nbsp;it&nbsp;and&nbsp;so&nbsp;I&#39;ll&nbsp;get&nbsp;right&nbsp;to&nbsp;the&nbsp;point:&lt;div&gt;<br>
<br>
&lt;br&gt;&lt;/div&gt;&lt;div&gt;If&nbsp;this&nbsp;string&nbsp;(before&nbsp;URL&nbsp;encoding)&nbsp;appears&nbsp;in&nbsp;a&nbsp;parameter,&nbsp;the&nbsp;rule&nbsp;matches:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;hello%0dworld&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Which&nbsp;is&nbsp;expected,&nbsp;and&nbsp;I&nbsp;understand&nbsp;(percent&nbsp;followed&nbsp;by&nbsp;two&nbsp;potentially&nbsp;hex&nbsp;characters).&nbsp; What&nbsp;I&nbsp;don&#39;t&nbsp;understand&nbsp;is&nbsp;why&nbsp;this&nbsp;string:&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;hello%world&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;also&nbsp;causes&nbsp;the&nbsp;rule&nbsp;to&nbsp;match,&nbsp;and&nbsp;I&nbsp;don&#39;t&nbsp;understand&nbsp;that&nbsp;(the&nbsp;following&nbsp;characters&nbsp;are&nbsp;not&nbsp;hexadecimal).&nbsp; Looking&nbsp;at&nbsp;the&nbsp;regex,&nbsp;it&nbsp;would&nbsp;appear&nbsp;it&#39;s&nbsp;been&nbsp;written&nbsp;to&nbsp;look&nbsp;specifically&nbsp;for&nbsp;hex&nbsp;characters&nbsp;(and&nbsp;their&nbsp;unicode&nbsp;equivalent):&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;SecRule&nbsp;ARGS&nbsp;&quot;\%((?!$|\W)|&lt;span&nbsp;style=&quot;background-color:rgb(255,0,0)&quot;&gt;[0-9a-fA-F&lt;/span&gt;]{2}|u[0-9a-fA-F]{4})&quot;&nbsp;\&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;But&nbsp;clearly&nbsp;it&nbsp;matches&nbsp;non-hex&nbsp;characters&nbsp;as&nbsp;well.&nbsp; Am&nbsp;I&nbsp;misunderstanding&nbsp;how&nbsp;the&nbsp;rule&nbsp;should&nbsp;work,&nbsp;or&nbsp;is&nbsp;there&nbsp;a&nbsp;problem&nbsp;with&nbsp;the&nbsp;rule&#39;s&nbsp;regex?&lt;/div&gt;<br>
<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;is&nbsp;a&nbsp;bad&nbsp;regex.&nbsp; It&nbsp;says:&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Match&nbsp;a&nbsp;&quot;%&quot;&nbsp;followed&nbsp;by&nbsp;(NOT&nbsp;(end&nbsp;of&nbsp;string&nbsp;OR&nbsp;non-word&nbsp;char))&nbsp;OR&nbsp;2&nbsp;hex&nbsp;chars&nbsp;OR&nbsp;&quot;u&quot;&nbsp;+&nbsp;4&nbsp;hex&nbsp;chars&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Which&nbsp;matches&nbsp;&quot;%w&quot;&nbsp;(e.g.,&nbsp;&quot;%&quot;&nbsp;followed&nbsp;by&nbsp;NOT&nbsp;a&nbsp;non-word&nbsp;char;&nbsp;&quot;%&quot;&nbsp;followed&nbsp;by&nbsp;any&nbsp;word&nbsp;character,&nbsp;which&nbsp;&quot;w&quot;&nbsp;is)&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;think&nbsp;you&nbsp;want&nbsp;something&nbsp;like:&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt; &quot;\%(&lt;span&nbsp;style=&quot;background-color:rgb(255,0,0)&quot;&gt;[0-9a-fA-F&lt;/span&gt;]{2}|[uU][0-9a-fA-F]{4})&quot;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;I&nbsp;am&nbsp;not&nbsp;sure&nbsp;the&nbsp;intention&nbsp;of&nbsp;(?!$|\W),&nbsp;but&nbsp;I&nbsp;assume&nbsp;it&nbsp;was&nbsp;added&nbsp;to&nbsp;resolve&nbsp;some&nbsp;FP.&lt;/div&gt;<br>
&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-B&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
