<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] rule 920350 - &quot;host header is a numeric ip address&quot; - redirect loop using default 3.0.0 conf
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20rule%20920350%20-%20%22host%20header%20is%0A%20a%20numeric%20ip%20address%22%20-%20redirect%20loop%20using%20default%203.0.0%20conf&In-Reply-To=%3C20160605201405.GB31305%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002178.html">
   <LINK REL="Next"  HREF="002180.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] rule 920350 - &quot;host header is a numeric ip address&quot; - redirect loop using default 3.0.0 conf</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20rule%20920350%20-%20%22host%20header%20is%0A%20a%20numeric%20ip%20address%22%20-%20redirect%20loop%20using%20default%203.0.0%20conf&In-Reply-To=%3C20160605201405.GB31305%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] rule 920350 - &quot;host header is a numeric ip address&quot; - redirect loop using default 3.0.0 conf">christian.folini at netnea.com
       </A><BR>
    <I>Sun Jun  5 20:14:05 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002178.html">[Owasp-modsecurity-core-rule-set] rule 920350 - &quot;host header is	a numeric ip address&quot; - redirect loop using default 3.0.0 conf
</A></li>
        <LI>Next message: <A HREF="002180.html">[Owasp-modsecurity-core-rule-set] rule 920350 - &quot;host header is a numeric ip address&quot; - redirect loop using default 3.0.0 conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2179">[ date ]</a>
              <a href="thread.html#2179">[ thread ]</a>
              <a href="subject.html#2179">[ subject ]</a>
              <a href="author.html#2179">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi there,

Ryan replaced the &quot;deny&quot; with the redirect in commit
commit 85d96d18f35f4aac1799965df7e87c8998ab17ba
on Jan 29, 2014 with the commit message:
&quot;Updating Risk Groups, LFI/SQLi Rules and Anomaly Scoring&quot;

$&gt; git diff  d743fd2 85d96d1
...
+# -- [[ Disruptive Action Control ]] --
+# The default action is to issue a 302 redirect sending the client back to the main
+# index page.
 #
-SecDefaultAction &quot;phase:1,deny,log&quot;
-
+# -- [[ Host Meta-Data ]] --
+# The tag action will include the Host header data in the alert, which helps to identify
+# which Vhost triggered the rule.
+#
+SecDefaultAction &quot;phase:1,log,redirect:'<A HREF="http://%{request_headers.host">http://%{request_headers.host</A>}/',tag:'Host: %{request_headers.host}'&quot;
+SecDefaultAction &quot;phase:2,log,redirect:'<A HREF="http://%{request_headers.host">http://%{request_headers.host</A>}/',tag:'Host: %{request_headers.host}'&quot;
...

Does anybody remember anything about Ryan's reasoning for this new 
default? Outside of it being a default and people better define a
correct value for themselves?

Personally, I am all for a default deny policy.
I am also not sure, I want the proposed that with every alert.

Ahoj,

Christian


-- 
People demand freedom of speech as a compensation for the freedom 
of thought which they seldom use.
-- Soren Kierkegaard
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002178.html">[Owasp-modsecurity-core-rule-set] rule 920350 - &quot;host header is	a numeric ip address&quot; - redirect loop using default 3.0.0 conf
</A></li>
	<LI>Next message: <A HREF="002180.html">[Owasp-modsecurity-core-rule-set] rule 920350 - &quot;host header is a numeric ip address&quot; - redirect loop using default 3.0.0 conf
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2179">[ date ]</a>
              <a href="thread.html#2179">[ thread ]</a>
              <a href="subject.html#2179">[ subject ]</a>
              <a href="author.html#2179">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
