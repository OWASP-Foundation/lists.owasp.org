<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20ESAPI%20HTTP%20request%20validation%0A%20and%20ModSecurity%20CRS%20rules%20for%20XSS&In-Reply-To=%3C20160305050152.GA4718%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002038.html">
   <LINK REL="Next"  HREF="002040.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20ESAPI%20HTTP%20request%20validation%0A%20and%20ModSecurity%20CRS%20rules%20for%20XSS&In-Reply-To=%3C20160305050152.GA4718%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS">christian.folini at netnea.com
       </A><BR>
    <I>Sat Mar  5 05:01:52 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002038.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
        <LI>Next message: <A HREF="002040.html">[Owasp-modsecurity-core-rule-set] New Community Leaders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2039">[ date ]</a>
              <a href="thread.html#2039">[ thread ]</a>
              <a href="subject.html#2039">[ subject ]</a>
              <a href="author.html#2039">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,

On Fri, Mar 04, 2016 at 10:33:05PM +0000, Hiranmayi Palanki wrote:
&gt;<i> Thank you for your response. I will indeed share the recipe, if at all this route is pursued.
</I>
Great. We could put it into the OWASP wiki.

&gt;<i> Based on your response, I'm deriving that sending all parts of the
</I>&gt;<i> HTTP request (header, cookie, query string..etc) in its entirety
</I>&gt;<i> through either a whitelist or a blacklist is ok. But, it does not make
</I>&gt;<i> sense to validate the HTTP request header, cookie, query string with a
</I>&gt;<i> blacklist and the HTTP scheme, uri path, context path etc. through a
</I>&gt;<i> whitelist.
</I>
I'd say to send it all through a blacklist first _and_ through a
whitelist afterwards works fine. I'm doing it for a couple of sites
and it works nicely.

Ahoj,

Christian


&gt;<i> 
</I>&gt;<i> Thanks. Hiranmayi Palanki.
</I>&gt;<i> 
</I>&gt;<i> -----Original Message----- From: Christian Folini
</I>&gt;<i> [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>] Sent: Friday, March 04, 2016 3:27
</I>&gt;<i> PM To: Hiranmayi Palanki Cc:
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A> Subject: Re:
</I>&gt;<i> [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and
</I>&gt;<i> ModSecurity CRS rules for XSS
</I>&gt;<i> 
</I>&gt;<i> Dear Hiranmayi Palanki,
</I>&gt;<i> 
</I>&gt;<i> I am not familiar with the ESAPI HTTP whitelisting, but I do know it's
</I>&gt;<i> a helpful security layer. Combining ModSec with other defense methods
</I>&gt;<i> makes a lot of sense with regards to security in depth etc.
</I>&gt;<i> 
</I>&gt;<i> The price is certainly the complexity and the additional source for
</I>&gt;<i> false positives. So it depends on your security needs. I have
</I>&gt;<i> sympathies for the double approach.
</I>&gt;<i> 
</I>&gt;<i> On Fri, Mar 04, 2016 at 05:53:32PM +0000, Hiranmayi Palanki wrote:
</I>&gt;<i> &gt; 2.      Is it overkill to enable both ESAPI HTTP whitelist
</I>&gt;<i> &gt; validation and ModSecurity XSS blacklist regex patterns?
</I>&gt;<i> 
</I>&gt;<i> I do combine CRS with whitelisting at times. I include the CRS first,
</I>&gt;<i> perform the anomaly score checking for the incoming request and if
</I>&gt;<i> everything looks good, the whitelisting takes a closer look at every
</I>&gt;<i> detail of the http request.
</I>&gt;<i> 
</I>&gt;<i> &gt; 3.      Does it make sense to split some parts of the HTTP request
</I>&gt;<i> &gt; to go through the ESAPI canonicalize and HTTP validation rules and
</I>&gt;<i> &gt; split some parts of the HTTP request (e.g. query string) to traverse
</I>&gt;<i> &gt; through ModSecurity?
</I>&gt;<i> 
</I>&gt;<i> That sounds quite crazy and bloody complicated. I do not see the
</I>&gt;<i> benefit, honestly. However, the craziness of the idea intrigues me.
</I>&gt;<i> Should you manage to pull this off, would you care to share the recipe
</I>&gt;<i> with us?
</I>&gt;<i> 
</I>&gt;<i> &gt; 4.      Has anybody implemented both whitelist (through ESAPI HTTP
</I>&gt;<i> &gt; validation) and blacklist regular expression pattern matching at the
</I>&gt;<i> &gt; same time? If so, do you have an opinion on this combined approach?
</I>&gt;<i> 
</I>&gt;<i> Not me, sorry.
</I>&gt;<i> 
</I>&gt;<i> Best,
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> -- The greatest obstacle to being heroic is the doubt whether one may
</I>&gt;<i> not be going to prove one's self a fool; the truest heroism is, to
</I>&gt;<i> resist the doubt; and the profoundest wisdom, to know when it ought to
</I>&gt;<i> be resisted, and when to be obeyed.  -- Nathaniel Hawthorne
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> American Express made the following annotations
</I>&gt;<i> ******************************************************************************
</I>&gt;<i> &quot;This message and any attachments are solely for the intended
</I>&gt;<i> recipient and may contain confidential or privileged information. If
</I>&gt;<i> you are not the intended recipient, any disclosure, copying, use, or
</I>&gt;<i> distribution of the information included in this message and any
</I>&gt;<i> attachments is prohibited. If you have received this communication in
</I>&gt;<i> error, please notify us by reply e-mail and immediately and
</I>&gt;<i> permanently delete this message and any attachments. Thank you.&quot;
</I>&gt;<i> 
</I>&gt;<i> American Express a ajout&#233; le commentaire suivant le Ce courrier et
</I>&gt;<i> toute pi&#232;ce jointe qu'il contient sont r&#233;serv&#233;s au seul destinataire
</I>&gt;<i> indiqu&#233; et peuvent renfermer des renseignements confidentiels et
</I>&gt;<i> privil&#233;gi&#233;s. Si vous n'&#234;tes pas le destinataire pr&#233;vu, toute
</I>&gt;<i> divulgation, duplication, utilisation ou distribution du courrier ou
</I>&gt;<i> de toute pi&#232;ce jointe est interdite. Si vous avez re&#231;u cette
</I>&gt;<i> communication par erreur, veuillez nous en aviser par courrier et
</I>&gt;<i> d&#233;truire imm&#233;diatement le courrier et les pi&#232;ces jointes. Merci.
</I>&gt;<i> 
</I>&gt;<i> ******************************************************************************
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002038.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
	<LI>Next message: <A HREF="002040.html">[Owasp-modsecurity-core-rule-set] New Community Leaders
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2039">[ date ]</a>
              <a href="thread.html#2039">[ thread ]</a>
              <a href="subject.html#2039">[ subject ]</a>
              <a href="author.html#2039">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
