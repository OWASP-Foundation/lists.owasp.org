<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20ESAPI%20HTTP%20request%20validation%0A%20and%20ModSecurity%20CRS%20rules%20for%20XSS&In-Reply-To=%3C6131a70de069414090a0085b77eade1e%40BY1PR93MB0086.024d.mgd.msft.net%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002037.html">
   <LINK REL="Next"  HREF="002039.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS</H1>
    <B>Hiranmayi Palanki</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20ESAPI%20HTTP%20request%20validation%0A%20and%20ModSecurity%20CRS%20rules%20for%20XSS&In-Reply-To=%3C6131a70de069414090a0085b77eade1e%40BY1PR93MB0086.024d.mgd.msft.net%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS">Hiranmayi.Palanki at aexp.com
       </A><BR>
    <I>Fri Mar  4 22:33:05 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002037.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
        <LI>Next message: <A HREF="002039.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2038">[ date ]</a>
              <a href="thread.html#2038">[ thread ]</a>
              <a href="subject.html#2038">[ subject ]</a>
              <a href="author.html#2038">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Christian,

Thank you for your response. I will indeed share the recipe, if at all this route is pursued.

The ESAPI HTTP white list validation is an open source library from OWASP. It provides white list input validation and output encoding amongst many of its features. 

The challenge is that developers are hesitant to remove this OWASP ESAPI library, given that it is offering white list HTTP request input validation. I'm interested in plugging-in ModSecurity XSS rules, and therefore the combined approach is coming into play.

Based on your response, I'm deriving that sending all parts of the HTTP request (header, cookie, query string..etc) in its entirety through either a whitelist or a blacklist is ok. But, it does not make sense to validate the HTTP request header, cookie, query string with a blacklist and the HTTP scheme, uri path, context path etc. through a whitelist.

Thanks. Hiranmayi Palanki.

-----Original Message-----
From: Christian Folini [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>] 
Sent: Friday, March 04, 2016 3:27 PM
To: Hiranmayi Palanki
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Subject: Re: [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS

Dear Hiranmayi Palanki,

I am not familiar with the ESAPI HTTP whitelisting, but I do know it's a helpful security layer. Combining ModSec with other defense methods makes a lot of sense with regards to security in depth etc.

The price is certainly the complexity and the additional source for false positives. So it depends on your security needs. I have sympathies for the double approach.

On Fri, Mar 04, 2016 at 05:53:32PM +0000, Hiranmayi Palanki wrote:
&gt;<i> 2.      Is it overkill to enable both ESAPI HTTP whitelist validation and ModSecurity XSS blacklist regex patterns?
</I>
I do combine CRS with whitelisting at times. I include the CRS first, perform the anomaly score checking for the incoming request and if everything looks good, the whitelisting takes a closer look at every detail of the http request.

&gt;<i> 3.      Does it make sense to split some parts of the HTTP request to go through the ESAPI canonicalize and HTTP validation rules and split some parts of the HTTP request (e.g. query string) to traverse through ModSecurity?
</I>
That sounds quite crazy and bloody complicated. I do not see the benefit, honestly. However, the craziness of the idea intrigues me.
Should you manage to pull this off, would you care to share the recipe with us?

&gt;<i> 4.      Has anybody implemented both whitelist (through ESAPI HTTP validation) and blacklist regular expression pattern matching at the same time? If so, do you have an opinion on this combined approach?
</I>
Not me, sorry.

Best,

Christian

--
The greatest obstacle to being heroic is the doubt whether one may not be going to prove one's self a fool; the truest heroism is, to resist the doubt; and the profoundest wisdom, to know when it ought to be resisted, and when to be obeyed.
-- Nathaniel Hawthorne


American Express made the following annotations
******************************************************************************
&quot;This message and any attachments are solely for the intended recipient and may contain confidential or privileged information. If you are not the intended recipient, any disclosure, copying, use, or distribution of the information included in this message and any attachments is prohibited. If you have received this communication in error, please notify us by reply e-mail and immediately and permanently delete this message and any attachments. Thank you.&quot;

American Express a ajout&#233; le commentaire suivant le Ce courrier et toute pi&#232;ce jointe qu'il contient sont r&#233;serv&#233;s au seul destinataire indiqu&#233; et peuvent renfermer des 
renseignements confidentiels et privil&#233;gi&#233;s. Si vous n'&#234;tes pas le destinataire pr&#233;vu, toute divulgation, duplication, utilisation ou distribution du courrier ou de toute pi&#232;ce jointe est interdite. Si vous avez re&#231;u cette communication par erreur, veuillez nous en aviser par courrier et d&#233;truire imm&#233;diatement le courrier et les pi&#232;ces jointes. Merci.

******************************************************************************
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002037.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
	<LI>Next message: <A HREF="002039.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2038">[ date ]</a>
              <a href="thread.html#2038">[ thread ]</a>
              <a href="subject.html#2038">[ subject ]</a>
              <a href="author.html#2038">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
