<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20mode%20phase%202&In-Reply-To=%3C20160307194937.GA29848%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002064.html">
   <LINK REL="Next"  HREF="002070.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Paranoia mode phase 2</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Paranoia%20mode%20phase%202&In-Reply-To=%3C20160307194937.GA29848%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Paranoia mode phase 2">christian.folini at netnea.com
       </A><BR>
    <I>Mon Mar  7 19:49:37 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002064.html">[Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
</A></li>
        <LI>Next message: <A HREF="002070.html">[Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2067">[ date ]</a>
              <a href="thread.html#2067">[ thread ]</a>
              <a href="subject.html#2067">[ subject ]</a>
              <a href="author.html#2067">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Good evening everybody,

The first runs with No&#235;l's patch look promising. I checked the
rules and they are all there and they work correctly, as far
as I checked.

Here is a screenshot of a diff of the various alerts triggered with
paranoia level 1 and paranoia level 2. <A HREF="http://imgur.com/AZcCijQ">http://imgur.com/AZcCijQ</A> (PL 2 in
pull request #2 has 20 additional rules when compared to PL 1)-

And here is a graph of anomaly scores distribution for PL 1 and PL 2. Nice
to see the peak being shifted to higher anomaly score due to additional
alerts.  <A HREF="http://imgur.com/xMkULKe">http://imgur.com/xMkULKe</A>

I am unsure about the best tag for the rules. Right now, they appear
as follows in the error-log:

[2016-03-07 17:50:31.720874] [-:error] 127.0.0.1:38796 Vt2xV38AAQEAABpA0R0AAAAW [client 127.0.0.1] ModSecurity: Warning. Pattern match &quot;(?i:(?:,.*?[)\\\\da-f\\&quot;'`][\\&quot;'`](?:[\\&quot;'`].*?[\\&quot;'`]|\\\\Z|[^\\&quot;'`]+))|(?:\\\\Wselect.+\\\\W*?from)|((?:select|create|rename|truncate|load|alter|delete|update|insert|desc)\\\\s*?\\\\(\\\\s*?space\\\\s*?\\\\())&quot; at ARGS:Authorization. [file &quot;/opt/modsecurity-core-rules-3.0rc1-paranoia/REQUEST-42-APPLICATION-ATTACK-SQLI.conf&quot;] [line &quot;593&quot;] [id &quot;942200&quot;] [rev &quot;2&quot;] [msg &quot;Detects MySQL comment-/space-obfuscated injections and backtick termination&quot;] [data &quot;Matched Data: , response=\\x22ae9f86d6beaa3f9ecb9a5b7e072a4138\\x22, nonce= found within ARGS:Authorization: Digest username=\\x22admin\\x22, response=\\x22ae9f86d6beaa3f9ecb9a5b7e072a4138\\x22, nonce=\\x222b089ba7985a883ab2eddcd3539a6c94\\x22, realm=\\x22adminRealm\\x22, uri=\\x22/servlet/admin\\x22&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-mutli&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-sqli&quot;] [tag &quot;OWASP_CRS/WEB_ATTACK/SQL_INJECTION&quot;] [tag &quot;paranoia-level/2&quot;] [hostname &quot;localhost&quot;] [uri &quot;/servlet/admin&quot;] [unique_id &quot;Vt2xV38AAQEAABpA0R0AAAAW&quot;]

The tag is thus: [tag &quot;paranoia-level/2&quot;]

Thoughts?

Best,

Christian

On Sun, Mar 06, 2016 at 09:40:33PM +0100, Christian Folini wrote:
&gt;<i> Thanks No&#235;l, that looks better. :)
</I>&gt;<i> 
</I>&gt;<i> I'll check it carefully in the next days. Would be pleased if more
</I>&gt;<i> people could give it a spin.
</I>&gt;<i> 
</I>&gt;<i> Ahoj,
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Sun, Mar 06, 2016 at 08:18:45PM +0100, No&#235;l Zindel wrote:
</I>&gt;<i> &gt; Walter, Christian,
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; thanks for the assistance. I wasn&#8217;t quite sure if the 100 commits and 15k lines of changed code in my initial request were just an overall statistic ;)
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; As it seems, I really only forgot to base my pull request on the 3.0.0-rc1 branch. Unfortunately it&#8217;s required to create a new pull request, since there&#8217;s no way to adjust the merge target for an existing one.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; My PR should be fixed now and we&#8217;re good to go: <A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300">https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300</A> &lt;<A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300">https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/300</A>&gt;.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; And thanks, Walter, for sharing your workflow.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; Cheers,
</I>&gt;<i> &gt; No&#235;l
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; &gt; On 06 Mar 2016, at 18:43, Walter Hop &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">modsec at spam.lifeforms.nl</A>&gt; wrote:
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Just in case anyone is interested, this is the procedure I normally follow for pull requests:
</I>&gt;<i> &gt; &gt; <A HREF="https://gist.github.com/lifeforms/c8778a05bf0385c7f391">https://gist.github.com/lifeforms/c8778a05bf0385c7f391</A> &lt;<A HREF="https://gist.github.com/lifeforms/c8778a05bf0385c7f391">https://gist.github.com/lifeforms/c8778a05bf0385c7f391</A>&gt;
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; I&#8217;ve created a pull request here just to test, though Christian may review and accept it :) I&#8217;ll need the file in there so I can easily add to it when working on the PHP rules. We&#8217;ll convert them to use Chaim&#8217;s tool when it&#8217;s ready.
</I>&gt;<i> &gt; &gt; <A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299">https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299</A> &lt;<A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299">https://github.com/SpiderLabs/owasp-modsecurity-crs/pull/299</A>&gt;
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Cheers!
</I>&gt;<i> &gt; &gt; WH
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; --
</I>&gt;<i> &gt; &gt; Walter Hop | PGP key: <A HREF="https://lifeforms.nl/pgp">https://lifeforms.nl/pgp</A> &lt;<A HREF="https://lifeforms.nl/pgp">https://lifeforms.nl/pgp</A>&gt;
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt; &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>


&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: signature.asc
Type: application/pgp-signature
Size: 181 bytes
Desc: Digital signature
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160307/254febe1/attachment.pgp">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160307/254febe1/attachment.pgp</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002064.html">[Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
</A></li>
	<LI>Next message: <A HREF="002070.html">[Owasp-modsecurity-core-rule-set] Paranoia mode phase 2
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2067">[ date ]</a>
              <a href="thread.html#2067">[ thread ]</a>
              <a href="subject.html#2067">[ subject ]</a>
              <a href="author.html#2067">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
