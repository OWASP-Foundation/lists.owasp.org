<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20ESAPI%20HTTP%20request%20validation%0A%20and%20ModSecurity%20CRS%20rules%20for%20XSS&In-Reply-To=%3C20160304202642.GA27081%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002036.html">
   <LINK REL="Next"  HREF="002038.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20ESAPI%20HTTP%20request%20validation%0A%20and%20ModSecurity%20CRS%20rules%20for%20XSS&In-Reply-To=%3C20160304202642.GA27081%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS">christian.folini at netnea.com
       </A><BR>
    <I>Fri Mar  4 20:26:42 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002036.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and	ModSecurity CRS rules for XSS
</A></li>
        <LI>Next message: <A HREF="002038.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2037">[ date ]</a>
              <a href="thread.html#2037">[ thread ]</a>
              <a href="subject.html#2037">[ subject ]</a>
              <a href="author.html#2037">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Hiranmayi Palanki,

I am not familiar with the ESAPI HTTP whitelisting, but I do know it's a
helpful security layer. Combining ModSec with other defense methods
makes a lot of sense with regards to security in depth etc.

The price is certainly the complexity and the additional source for
false positives. So it depends on your security needs. I have
sympathies for the double approach.

On Fri, Mar 04, 2016 at 05:53:32PM +0000, Hiranmayi Palanki wrote:
&gt;<i> 2.      Is it overkill to enable both ESAPI HTTP whitelist validation and ModSecurity XSS blacklist regex patterns?
</I>
I do combine CRS with whitelisting at times. I include the CRS first,
perform the anomaly score checking for the incoming request and if 
everything looks good, the whitelisting takes a closer look at every
detail of the http request.

&gt;<i> 3.      Does it make sense to split some parts of the HTTP request to go through the ESAPI canonicalize and HTTP validation rules and split some parts of the HTTP request (e.g. query string) to traverse through ModSecurity?
</I>
That sounds quite crazy and bloody complicated. I do not see the
benefit, honestly. However, the craziness of the idea intrigues me.
Should you manage to pull this off, would you care to share the
recipe with us?

&gt;<i> 4.      Has anybody implemented both whitelist (through ESAPI HTTP validation) and blacklist regular expression pattern matching at the same time? If so, do you have an opinion on this combined approach?
</I>
Not me, sorry.

Best,

Christian

-- 
The greatest obstacle to being heroic is the doubt whether one may not
be going to prove one's self a fool; the truest heroism is, to resist
the doubt; and the profoundest wisdom, to know when it ought to be
resisted, and when to be obeyed.
-- Nathaniel Hawthorne
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002036.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and	ModSecurity CRS rules for XSS
</A></li>
	<LI>Next message: <A HREF="002038.html">[Owasp-modsecurity-core-rule-set] ESAPI HTTP request validation and ModSecurity CRS rules for XSS
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2037">[ date ]</a>
              <a href="thread.html#2037">[ thread ]</a>
              <a href="subject.html#2037">[ subject ]</a>
              <a href="author.html#2037">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
