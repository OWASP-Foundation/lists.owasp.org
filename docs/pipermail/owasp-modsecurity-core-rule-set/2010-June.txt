From ryan.barnett at breach.com  Fri Jun  4 14:51:24 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Fri, 4 Jun 2010 14:51:24 -0400
Subject: [Owasp-modsecurity-core-rule-set] Announcing CRS v2.0.7
Message-ID: <201006041451.25085.ryan.barnett@breach.com>

http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project#tab=Download

This update has a number of improvements, most notably the inclusion of new experimental 
protection rules for CSRF and Application Defects (missing HTTPOnly flag and identifying 
apps that are not properly output encoding/escaping user-supplied data).  See my previous 
Blackhat presos for more info - 
http://www.blackhat.com/html/bh-dc-09/bh-dc-09-archives.html#Barnett

Note that this release includes the rules-updater.pl script in the /util directory and we 
have activated the CRS rules repository on the www.modsecurity.org site so you can now 
auto-download the rules.  Read the README file in the /util directory for usage info.

--------------------------
Version 2.0.7 - 06/4/2010
--------------------------

Improvements:
- Added CSRF Protection Ruleset which will use Content Injection to add javascript to
  specific outbound data and then validate the csrf token on subsequent requests.
- Added new Application Defect Ruleset which will identify/fix missing HTTPOnly cookie
  flags
- Added Experimental XSS/Missing Output Escaping Ruleset which looks for user supplied
  data being echoed back to user unchanged.
- Added rules-updater.pl script and configuration file to allow users to automatically
  download CRS rules from the CRS rules repository. 
- Added new SQLi keyword for ciel() and reverse() functions.
- Updated the PHPIDS filters

Bug Fixes:
- Fixed false positives for Request Header Name matching in the 30 file by 
  adding boundary characters.  
- Added missing pass actions to @pmFromFile prequalifier rules
- Added backslash to SQLi regex
  https://www.modsecurity.org/tracker/browse/CORERULES-41
- Fixed hard coded anomaly score in PHPIDS filter file
  https://www.modsecurity.org/tracker/browse/CORERULES-45 
- Fixed restricted_extension false positive by adding boundary characters 

--
Ryan C. Barnett
WASC Web Hacking Incident Database Project Leader
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
http://tacticalwebappsec.blogspot.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100604/3a5c718c/attachment.html 

From ryan.barnett at breach.com  Fri Jun  4 16:56:46 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Fri, 4 Jun 2010 16:56:46 -0400
Subject: [Owasp-modsecurity-core-rule-set] Announcing CRS v2.0.7
In-Reply-To: <201006041451.25085.ryan.barnett@breach.com>
References: <201006041451.25085.ryan.barnett@breach.com>
Message-ID: <201006041656.46463.ryan.barnett@breach.com>

Had an issue with the new CSRF file in the 2.0.7 archive.  Please use the version in SVN -

http://mod-security.svn.sourceforge.net/viewvc/mod-
security/crs/trunk/optional_rules/modsecurity_crs_43_csrf_protection.conf

-Ryan

On Friday 04 June 2010 14:51:24 Ryan Barnett wrote:
> http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Pro
> ject#tab=Download
> 
> This update has a number of improvements, most notably the inclusion of new
> experimental protection rules for CSRF and Application Defects (missing
> HTTPOnly flag and identifying apps that are not properly output
> encoding/escaping user-supplied data). See my previous Blackhat presos for
> more info -
> 
> http://www.blackhat.com/html/bh-dc-09/bh-dc-09-archives.html#Barnett
> 
> Note that this release includes the rules-updater.pl script in the /util
> directory and we have activated the CRS rules repository on the
> www.modsecurity.org site so you can now auto-download the rules. Read the
> README file in the /util directory for usage info.
> 
> --------------------------
> 
> Version 2.0.7 - 06/4/2010
> 
> --------------------------
> 
> Improvements:
> 
> - Added CSRF Protection Ruleset which will use Content Injection to add
> javascript to
> 
> specific outbound data and then validate the csrf token on subsequent
> requests.
> 
> - Added new Application Defect Ruleset which will identify/fix missing
> HTTPOnly cookie
> 
> flags
> 
> - Added Experimental XSS/Missing Output Escaping Ruleset which looks for
> user supplied
> 
> data being echoed back to user unchanged.
> 
> - Added rules-updater.pl script and configuration file to allow users to
> automatically
> 
> download CRS rules from the CRS rules repository.
> 
> - Added new SQLi keyword for ciel() and reverse() functions.
> 
> - Updated the PHPIDS filters
> 
> Bug Fixes:
> 
> - Fixed false positives for Request Header Name matching in the 30 file by
> 
> adding boundary characters.
> 
> - Added missing pass actions to @pmFromFile prequalifier rules
> 
> - Added backslash to SQLi regex
> 
> https://www.modsecurity.org/tracker/browse/CORERULES-41
> 
> - Fixed hard coded anomaly score in PHPIDS filter file
> 
> https://www.modsecurity.org/tracker/browse/CORERULES-45
> 
> - Fixed restricted_extension false positive by adding boundary characters
> 
> --
> 
> Ryan C. Barnett
> 
> WASC Web Hacking Incident Database Project Leader
> 
> WASC Distributed Open Proxy Honeypot Project Leader
> 
> OWASP ModSecurity Core Rule Set Project Leader
> 
> http://tacticalwebappsec.blogspot.com
-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100604/60e956d3/attachment-0001.html 

From modsec at enosis.com  Sun Jun 20 20:28:12 2010
From: modsec at enosis.com (modsec at enosis.com)
Date: Sun, 20 Jun 2010 17:28:12 -0700
Subject: [Owasp-modsecurity-core-rule-set] setvar error in 2.0.7
	crs_41_phpids_filters
Message-ID: <E1OQUs0-00022U-Mi@h-74-0-39-116.snfccasy.covad.net>

Message: Asked to set variable "nn", but no collection name specified.

Throughout the subject CRS there's this problematic construct 
(setvar is missing the collection name):
  setvar:%{tx.critical_anomaly_score}

Plausable replacement: 
  setvar:tx.anomaly_score=+%{tx.critical_anomaly_score}


From rcbarnett at gmail.com  Mon Jun 21 15:51:41 2010
From: rcbarnett at gmail.com (Ryan Barnett)
Date: Mon, 21 Jun 2010 15:51:41 -0400
Subject: [Owasp-modsecurity-core-rule-set] setvar error in 2.0.7
	crs_41_phpids_filters
In-Reply-To: <E1OQUs0-00022U-Mi@h-74-0-39-116.snfccasy.covad.net>
References: <E1OQUs0-00022U-Mi@h-74-0-39-116.snfccasy.covad.net>
Message-ID: <201006211551.41981.rcbarnett@gmail.com>

Ah, good catch.  I will update the phpids converter script to fix it.

--
Ryan C. Barnett
WASC Web Hacking Incident Database Project Leader
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
http://tacticalwebappsec.blogspot.com

On Sunday 20 June 2010 20:28:12 modsec at enosis.com wrote:
> Message: Asked to set variable "nn", but no collection name specified.
> 
> Throughout the subject CRS there's this problematic construct
> (setvar is missing the collection name):
>   setvar:%{tx.critical_anomaly_score}
> 
> Plausable replacement:
>   setvar:tx.anomaly_score=+%{tx.critical_anomaly_score}
> 
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

From nc1500 at yahoo.com  Sat Jun 26 20:09:38 2010
From: nc1500 at yahoo.com (N C)
Date: Sat, 26 Jun 2010 17:09:38 -0700 (PDT)
Subject: [Owasp-modsecurity-core-rule-set] text/xml;
	charset=UTF-8 triggering rule 960010
Message-ID: <245211.81922.qm@web111607.mail.gq1.yahoo.com>

I'm seeing rule 960010 of core ruleset/2.0.5 being triggered on requests with "text/xml;charset=UTF-8" content-type.

Content-Type: text/xml;charset=UTF-8

[id "960010"]
[msg "Request content type is not allowed by policy"]
[data "text/xml;charset=UTF-8"]

Given that tx.allowed_request_content_type in modsecurity_crs_10_config.conf includes text/xml as an allowed type, I wouldn't expect these requests to trigger the rule.

Why is this rule being triggered?



      


From jodelvalle at braishfield.com  Tue Jun 29 13:01:31 2010
From: jodelvalle at braishfield.com (Josue Del Valle)
Date: Tue, 29 Jun 2010 13:01:31 -0400
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS 2.0.7
	logging
Message-ID: <65D9A9F334ED8A48B9E6108528349EC70C34F7D0@hercules.braishfield.local>

Hello,

 

I am a fully qualified armature on Mod_Security who is having trouble
configuring logging for mod_security.

 

I noticed the modsecurity_crs_10_config.conf is missing the logging
settings.  How can I set up logging?

 

Do I have to copy this to the modsecurity_crs_10_config.conf file?

 

## -- Logging
----------------------------------------------------------------

 

# Whether to log requests to the ModSecurity audit log.

#

# By default, only requests that trigger a ModSecurity events (as
detected 

# by) or a serer error are logged ("RelevantOnly"). This is a reasonable


# setting. Full logging can be set by using # "on". If the system is
used 

# for protection only and no logging is desired (not reccomended)
logging can 

# be turned of using "off"

#

# NOTE It is also possible to configure forensic logging on the

#      per request basis using the "auditlog" and "noauditlog" rule

#      actions.

#

# TODO The default rule set logs requests that generate a 404 "file not
found"

#      response. These events are interesting, but may log a lot of
information.

#      you may consider removing it by setting SecAuditLogRelevantStatus

#      to "^(?:5|4\d[^4])".

#

SecAuditEngine RelevantOnly

SecAuditLogRelevantStatus "^(?:5|4(?!04))"

 

# Log files structure

#

# You can select to log all events to a single log file (set
SecAuditLogType to 

# "Serial") or to log each request to a separate file (set it to
"Concurrent"). 

# The former is usually easier to use, but if full logging is required
or if 

# the protected system supports a large transaction volume the later may

# be a better option.

#

# TODO Set the SecAuditLog (for "Serial" logging) or
SecAuditLogStorageDir (for

#      "Concurrent" logging).

#

# TODO If you change from "Serial" to "Concurrent" uncomment the 

#      SecAuditLogStorageDir directive and make sure the direcory
specified 

#      exists and has write permissions for the Apache user. 

 

SecAuditLogType Serial

SecAuditLog logs/modsec_audit.log

# SecAuditLogStorageDir logs/modsec_audit

 

# Select what portions of the request to log

#

# Modify the string by adding any of the letter below to it:

# A - audit log header (mandatory)

# B - request headers

# C - request body (present only if the request body exists and
ModSecurity is 

#     configured to intercept it)

# E - intermediary response body (present only if ModSecurity is
configured to 

#     intercept response bodies, and if the audit log engine is
configured to 

#     record it). Intermediary response body is the same as the actual
response 

#     body unless ModSecurity intercepts the intermediary response body,
in 

#     which case the actual response body will contain the error message


#     (either the Apache default error message, or the ErrorDocument
page).

# F - final response headers (excluding the Date and Server headers,
which are 

#     always added by Apache in the late stage of content delivery).

# H - audit log trailer

# I - This part is a replacement for part C. It will log the same data
as C in 

#     all cases except when multipart/form-data encoding in used. In
this case 

#     it will log a fake application/x-www-form-urlencoded body that
contains 

#     the information about parameters but not about the files. This is
handy 

#     if you don't want to have (often large) files stored in your audit
logs.

# Z - final boundary, signifies the end of the entry (mandatory)

 

SecAuditLogParts "ABIFHKZ"

 

# Create a separate log to monitor performance.

#

# TODO Performance monitoring only works with Apache 2.x. You need

#      to add mod_unique_id and mod_logio to your configuration. Then

#      uncomment the following two lines.

#

# LogFormat "%V %h %t %{UNIQUE_ID}e \"%r\" %>s %X | %I %O |
%<{mod_security-time1}n %<{mod_security-time2}n %<{mod_security-time3}n
%D" mperformance

# CustomLog logs/modsec_performance.log mperformance

 

# Custom application access log.

#

# TODO You should consider creating a custom access log. It could
contain

#      the performance metrics from above, but should also record the

#      session ID for every request. That would make it possible to

#      list all requests performed as part of a session.

#

#      One custom log should be used per application but if you want

#      multiple applications to share one log file make sure each

#      line includes a unique application ID (unless the hostname is

#      sufficient for differentiation).

 

Regards,

 

Josue Del Valle <mailto:jodelvalle at braishfield.com> 

 





Coverage cannot be assumed to be bound, altered or canceled without confirmation from an authorized representative of Braishfield Associates, Inc.


DISCLAIMER:

CONFIDENTIALITY NOTICE: Braishfield Associates, Inc. would like you to know that the information contained in this communication, including attachments is privileged and confidential. It is intended only for the exclusive use of the addressee. If the reader of this message is not the intended recipient, or the employee or agent responsible for delivering it to the intended recipient, you are hereby notified that any dissemination, distribution or copying of this communication is strictly prohibited. Insurance coverage can not be bound, amended or changed via an e-mail message without knowledge or consent from the insuring carrier. If you have received this communication in error please notify us by telephone immediately at (407) 825-9911 or e-mail disclaimer at braishfield.com. Thank you.

-------------- next part --------------
An HTML attachment was scrubbed...
URL: https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20100629/625a3ac8/attachment.html 

From ryan.barnett at breach.com  Tue Jun 29 13:12:32 2010
From: ryan.barnett at breach.com (Ryan Barnett)
Date: Tue, 29 Jun 2010 13:12:32 -0400
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS
	2.0.7 logging
In-Reply-To: <65D9A9F334ED8A48B9E6108528349EC70C34F7D0@hercules.braishfield.local>
References: <65D9A9F334ED8A48B9E6108528349EC70C34F7D0@hercules.braishfield.local>
Message-ID: <201006291312.32537.ryan.barnett@breach.com>

On Tuesday 29 June 2010 13:01:31 Josue Del Valle wrote:
> Hello,
> 
> I am a fully qualified armature on Mod_Security who is having trouble
> configuring logging for mod_security.
> 
> I noticed the modsecurity_crs_10_config.conf is missing the logging
> settings.  How can I set up logging?
> 
> Do I have to copy this to the modsecurity_crs_10_config.conf file?
> 

We used to have all of these configs in the CRS 10 file however the more we thought about 
this the more we realized that mixing ModSecurity configuration and the CRS rules was not a 
good idea.  There are many directives that should be the responsibility of the Mod Admin 
and not the CRS rule writers.  So, we removed these directives from the most recent CRS. 

You should have a separate file for holding these other Mod directives (like the ones you 
listed below) so that any updates to the CRS does not overwrite them.

-Ryan

> ## -- Logging
> ----------------------------------------------------------------
> 
> # Whether to log requests to the ModSecurity audit log.
> #
> # By default, only requests that trigger a ModSecurity events (as detected
> # by) or a serer error are logged ("RelevantOnly"). This is a reasonable
> # setting. Full logging can be set by using # "on". If the system is used
> # for protection only and no logging is desired (not reccomended) logging
> can # be turned of using "off"
> #
> # NOTE It is also possible to configure forensic logging on the
> #      per request basis using the "auditlog" and "noauditlog" rule
> #      actions.
> #
> # TODO The default rule set logs requests that generate a 404 "file not
> found" #      response. These events are interesting, but may log a lot of
> information. #      you may consider removing it by setting
> SecAuditLogRelevantStatus #      to "^(?:5|4\d[^4])".
> #
> SecAuditEngine RelevantOnly
> SecAuditLogRelevantStatus "^(?:5|4(?!04))"
> 
> # Log files structure
> #
> # You can select to log all events to a single log file (set
> SecAuditLogType to # "Serial") or to log each request to a separate file
> (set it to "Concurrent"). # The former is usually easier to use, but if
> full logging is required or if # the protected system supports a large
> transaction volume the later may # be a better option.
> #
> # TODO Set the SecAuditLog (for "Serial" logging) or SecAuditLogStorageDir
> (for #      "Concurrent" logging).
> #
> # TODO If you change from "Serial" to "Concurrent" uncomment the
> #      SecAuditLogStorageDir directive and make sure the direcory specified
> #      exists and has write permissions for the Apache user.
> 
> SecAuditLogType Serial
> SecAuditLog logs/modsec_audit.log
> # SecAuditLogStorageDir logs/modsec_audit
> 
> # Select what portions of the request to log
> #
> # Modify the string by adding any of the letter below to it:
> # A - audit log header (mandatory)
> # B - request headers
> # C - request body (present only if the request body exists and ModSecurity
> is #     configured to intercept it)
> # E - intermediary response body (present only if ModSecurity is configured
> to #     intercept response bodies, and if the audit log engine is
> configured to #     record it). Intermediary response body is the same as
> the actual response #     body unless ModSecurity intercepts the
> intermediary response body, in #     which case the actual response body
> will contain the error message #     (either the Apache default error
> message, or the ErrorDocument page). # F - final response headers
> (excluding the Date and Server headers, which are #     always added by
> Apache in the late stage of content delivery). # H - audit log trailer
> # I - This part is a replacement for part C. It will log the same data as C
> in #     all cases except when multipart/form-data encoding in used. In
> this case #     it will log a fake application/x-www-form-urlencoded body
> that contains #     the information about parameters but not about the
> files. This is handy #     if you don't want to have (often large) files
> stored in your audit logs. # Z - final boundary, signifies the end of the
> entry (mandatory)
> 
> SecAuditLogParts "ABIFHKZ"
> 
> # Create a separate log to monitor performance.
> #
> # TODO Performance monitoring only works with Apache 2.x. You need
> #      to add mod_unique_id and mod_logio to your configuration. Then
> #      uncomment the following two lines.
> #
> # LogFormat "%V %h %t %{UNIQUE_ID}e \"%r\" %>s %X | %I %O |
> %<{mod_security-time1}n %<{mod_security-time2}n %<{mod_security-time3}n
> %D" mperformance # CustomLog logs/modsec_performance.log mperformance
> 
> # Custom application access log.
> #
> # TODO You should consider creating a custom access log. It could contain
> #      the performance metrics from above, but should also record the
> #      session ID for every request. That would make it possible to
> #      list all requests performed as part of a session.
> #
> #      One custom log should be used per application but if you want
> #      multiple applications to share one log file make sure each
> #      line includes a unique application ID (unless the hostname is
> #      sufficient for differentiation).
> 
> Regards,
> 
> Josue Del Valle<mailto:jodelvalle at braishfield.com>
> 
> 
> 
> 
> Coverage cannot be assumed to be bound, altered or canceled without
> confirmation from an authorized representative of Braishfield Associates,
> Inc.
> 
> 
> 
> DISCLAIMER:
> 
> CONFIDENTIALITY NOTICE: Braishfield Associates, Inc. would like you to know
> that the information contained in this communication, including
> attachments is privileged and confidential. It is intended only for the
> exclusive use of the addressee. If the reader of this message is not the
> intended recipient, or the employee or agent responsible for delivering it
> to the intended recipient, you are hereby notified that any dissemination,
> distribution or copying of this communication is strictly prohibited.
> Insurance coverage can not be bound, amended or changed via an e-mail
> message without knowledge or consent from the insuring carrier. If you
> have received this communication in error please notify us by telephone
> immediately at (407) 825-9911 or e-mail
> disclaimer at braishfield.com<mailto:disclaimer at braishfield.com>. Thank you.

From jodelvalle at braishfield.com  Tue Jun 29 13:18:30 2010
From: jodelvalle at braishfield.com (Josue Del Valle)
Date: Tue, 29 Jun 2010 13:18:30 -0400
Subject: [Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS
	2.0.7 logging
In-Reply-To: <201006291312.32537.ryan.barnett@breach.com>
References: <65D9A9F334ED8A48B9E6108528349EC70C34F7D0@hercules.braishfield.local>
	<201006291312.32537.ryan.barnett@breach.com>
Message-ID: <65D9A9F334ED8A48B9E6108528349EC70C34F7D1@hercules.braishfield.local>

So if put all the directives in a file and call it for example, logging.conf all I have to do is to put that file with the rest of the configuration files?

Could I just copy/paste the directives from my previous email and put them in the file or is there something else I have to add to make it work?

Regards,
?
Josue Del Valle

-----Original Message-----
From: Ryan Barnett [mailto:ryan.barnett at breach.com] 
Sent: Tuesday, June 29, 2010 1:13 PM
To: owasp-modsecurity-core-rule-set at lists.owasp.org
Cc: Josue Del Valle
Subject: Re: [Owasp-modsecurity-core-rule-set] Mod_Security 2.5.12 / CRS 2.0.7 logging

On Tuesday 29 June 2010 13:01:31 Josue Del Valle wrote:
> Hello,
> 
> I am a fully qualified armature on Mod_Security who is having trouble
> configuring logging for mod_security.
> 
> I noticed the modsecurity_crs_10_config.conf is missing the logging
> settings.  How can I set up logging?
> 
> Do I have to copy this to the modsecurity_crs_10_config.conf file?
> 

We used to have all of these configs in the CRS 10 file however the more we thought about 
this the more we realized that mixing ModSecurity configuration and the CRS rules was not a 
good idea.  There are many directives that should be the responsibility of the Mod Admin 
and not the CRS rule writers.  So, we removed these directives from the most recent CRS. 

You should have a separate file for holding these other Mod directives (like the ones you 
listed below) so that any updates to the CRS does not overwrite them.

-Ryan

> ## -- Logging
> ----------------------------------------------------------------
> 
> # Whether to log requests to the ModSecurity audit log.
> #
> # By default, only requests that trigger a ModSecurity events (as detected
> # by) or a serer error are logged ("RelevantOnly"). This is a reasonable
> # setting. Full logging can be set by using # "on". If the system is used
> # for protection only and no logging is desired (not reccomended) logging
> can # be turned of using "off"
> #
> # NOTE It is also possible to configure forensic logging on the
> #      per request basis using the "auditlog" and "noauditlog" rule
> #      actions.
> #
> # TODO The default rule set logs requests that generate a 404 "file not
> found" #      response. These events are interesting, but may log a lot of
> information. #      you may consider removing it by setting
> SecAuditLogRelevantStatus #      to "^(?:5|4\d[^4])".
> #
> SecAuditEngine RelevantOnly
> SecAuditLogRelevantStatus "^(?:5|4(?!04))"
> 
> # Log files structure
> #
> # You can select to log all events to a single log file (set
> SecAuditLogType to # "Serial") or to log each request to a separate file
> (set it to "Concurrent"). # The former is usually easier to use, but if
> full logging is required or if # the protected system supports a large
> transaction volume the later may # be a better option.
> #
> # TODO Set the SecAuditLog (for "Serial" logging) or SecAuditLogStorageDir
> (for #      "Concurrent" logging).
> #
> # TODO If you change from "Serial" to "Concurrent" uncomment the
> #      SecAuditLogStorageDir directive and make sure the direcory specified
> #      exists and has write permissions for the Apache user.
> 
> SecAuditLogType Serial
> SecAuditLog logs/modsec_audit.log
> # SecAuditLogStorageDir logs/modsec_audit
> 
> # Select what portions of the request to log
> #
> # Modify the string by adding any of the letter below to it:
> # A - audit log header (mandatory)
> # B - request headers
> # C - request body (present only if the request body exists and ModSecurity
> is #     configured to intercept it)
> # E - intermediary response body (present only if ModSecurity is configured
> to #     intercept response bodies, and if the audit log engine is
> configured to #     record it). Intermediary response body is the same as
> the actual response #     body unless ModSecurity intercepts the
> intermediary response body, in #     which case the actual response body
> will contain the error message #     (either the Apache default error
> message, or the ErrorDocument page). # F - final response headers
> (excluding the Date and Server headers, which are #     always added by
> Apache in the late stage of content delivery). # H - audit log trailer
> # I - This part is a replacement for part C. It will log the same data as C
> in #     all cases except when multipart/form-data encoding in used. In
> this case #     it will log a fake application/x-www-form-urlencoded body
> that contains #     the information about parameters but not about the
> files. This is handy #     if you don't want to have (often large) files
> stored in your audit logs. # Z - final boundary, signifies the end of the
> entry (mandatory)
> 
> SecAuditLogParts "ABIFHKZ"
> 
> # Create a separate log to monitor performance.
> #
> # TODO Performance monitoring only works with Apache 2.x. You need
> #      to add mod_unique_id and mod_logio to your configuration. Then
> #      uncomment the following two lines.
> #
> # LogFormat "%V %h %t %{UNIQUE_ID}e \"%r\" %>s %X | %I %O |
> %<{mod_security-time1}n %<{mod_security-time2}n %<{mod_security-time3}n
> %D" mperformance # CustomLog logs/modsec_performance.log mperformance
> 
> # Custom application access log.
> #
> # TODO You should consider creating a custom access log. It could contain
> #      the performance metrics from above, but should also record the
> #      session ID for every request. That would make it possible to
> #      list all requests performed as part of a session.
> #
> #      One custom log should be used per application but if you want
> #      multiple applications to share one log file make sure each
> #      line includes a unique application ID (unless the hostname is
> #      sufficient for differentiation).
> 
> Regards,
> 
> Josue Del Valle<mailto:jodelvalle at braishfield.com>
> 
> 
> 
> 
> Coverage cannot be assumed to be bound, altered or canceled without
> confirmation from an authorized representative of Braishfield Associates,
> Inc.
> 
> 
> 
> DISCLAIMER:
> 
> CONFIDENTIALITY NOTICE: Braishfield Associates, Inc. would like you to know
> that the information contained in this communication, including
> attachments is privileged and confidential. It is intended only for the
> exclusive use of the addressee. If the reader of this message is not the
> intended recipient, or the employee or agent responsible for delivering it
> to the intended recipient, you are hereby notified that any dissemination,
> distribution or copying of this communication is strictly prohibited.
> Insurance coverage can not be bound, amended or changed via an e-mail
> message without knowledge or consent from the insuring carrier. If you
> have received this communication in error please notify us by telephone
> immediately at (407) 825-9911 or e-mail
> disclaimer at braishfield.com<mailto:disclaimer at braishfield.com>. Thank you.

