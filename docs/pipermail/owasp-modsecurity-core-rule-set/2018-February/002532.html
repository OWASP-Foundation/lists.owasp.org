<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Error creating rule: Unknown variable: pk_ref)/
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Error%20creating%20rule%3A%20Unknown%0A%20variable%3A%20pk_ref%29/&In-Reply-To=%3C20180208050402.b6rmfctvvrc2b4cx%40leander%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002531.html">
   <LINK REL="Next"  HREF="002533.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Error creating rule: Unknown variable: pk_ref)/</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Error%20creating%20rule%3A%20Unknown%0A%20variable%3A%20pk_ref%29/&In-Reply-To=%3C20180208050402.b6rmfctvvrc2b4cx%40leander%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Error creating rule: Unknown variable: pk_ref)/">christian.folini at netnea.com
       </A><BR>
    <I>Thu Feb  8 05:04:02 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="002531.html">[Owasp-modsecurity-core-rule-set] Error creating rule: Unknown	variable: pk_ref)/
</A></li>
        <LI>Next message: <A HREF="002533.html">[Owasp-modsecurity-core-rule-set] Error creating rule: Unknown variable: pk_ref)/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2532">[ date ]</a>
              <a href="thread.html#2532">[ thread ]</a>
              <a href="subject.html#2532">[ subject ]</a>
              <a href="author.html#2532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hey Jeroen,

This is an ancient bug actually:

<A HREF="https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/181">https://github.com/SpiderLabs/owasp-modsecurity-crs/issues/181</A>

It is fixed since the release of CRS 3.

Given you base on my tutorial which follows that version, I do not know
how you could encounter it.

Regs,

Christian

On Wed, Feb 07, 2018 at 01:51:17PM +0000, Wisse J.S. (Jeroen) wrote:
&gt;<i>    Hello all,
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    I get the following error message in Windows event viewer when i try to
</I>&gt;<i>    launch apache with the core ruleset enabled:
</I>&gt;<i> 
</I>&gt;<i>    Error creating rule: Unknown variable: pk_ref)/
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    I am using the following tutorial to setup apache and mod_security:
</I>&gt;<i> 
</I>&gt;<i>    [1]<A HREF="https://www.netnea.com/cms/apache-tutorial-7_including-modsecurity-c">https://www.netnea.com/cms/apache-tutorial-7_including-modsecurity-c</A>
</I>&gt;<i>    ore-rules/
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    HTTPD &#8211;V:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    Server version: Apache/2.4.23 (Win64)
</I>&gt;<i> 
</I>&gt;<i>    Apache Lounge VC11 Server built:   Jul  8 2016 11:33:36
</I>&gt;<i> 
</I>&gt;<i>    Server's Module Magic Number: 20120211:61
</I>&gt;<i> 
</I>&gt;<i>    Server loaded:  APR 1.5.2, APR-UTIL 1.5.4
</I>&gt;<i> 
</I>&gt;<i>    Compiled using: APR 1.5.2, APR-UTIL 1.5.4
</I>&gt;<i> 
</I>&gt;<i>    Architecture:   64-bit
</I>&gt;<i> 
</I>&gt;<i>    Server MPM:     WinNT
</I>&gt;<i> 
</I>&gt;<i>      threaded:     yes (fixed thread count)
</I>&gt;<i> 
</I>&gt;<i>        forked:     no
</I>&gt;<i> 
</I>&gt;<i>    Server compiled with....
</I>&gt;<i> 
</I>&gt;<i>    -D APR_HAS_SENDFILE
</I>&gt;<i> 
</I>&gt;<i>    -D APR_HAS_MMAP
</I>&gt;<i> 
</I>&gt;<i>    -D APR_HAVE_IPV6 (IPv4-mapped addresses disabled)
</I>&gt;<i> 
</I>&gt;<i>    -D APR_HAS_OTHER_CHILD
</I>&gt;<i> 
</I>&gt;<i>    -D AP_HAVE_RELIABLE_PIPED_LOGS
</I>&gt;<i> 
</I>&gt;<i>    -D DYNAMIC_MODULE_LIMIT=256
</I>&gt;<i> 
</I>&gt;<i>    -D HTTPD_ROOT=&quot;/apache&quot;
</I>&gt;<i> 
</I>&gt;<i>    -D SUEXEC_BIN=&quot;/apache/bin/suexec&quot;
</I>&gt;<i> 
</I>&gt;<i>    -D DEFAULT_PIDLOG=&quot;logs/httpd.pid&quot;
</I>&gt;<i> 
</I>&gt;<i>    -D DEFAULT_SCOREBOARD=&quot;logs/apache_runtime_status&quot;
</I>&gt;<i> 
</I>&gt;<i>    -D DEFAULT_ERRORLOG=&quot;logs/error.log&quot;
</I>&gt;<i> 
</I>&gt;<i>    -D AP_TYPES_CONFIG_FILE=&quot;conf/mime.types&quot;
</I>&gt;<i> 
</I>&gt;<i>    -D SERVER_CONFIG_FILE=&quot;conf/httpd.conf&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    HTTPD &#8211;M:
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    Loaded Modules:
</I>&gt;<i> 
</I>&gt;<i>    core_module (static)
</I>&gt;<i> 
</I>&gt;<i>    win32_module (static)
</I>&gt;<i> 
</I>&gt;<i>    mpm_winnt_module (static)
</I>&gt;<i> 
</I>&gt;<i>    http_module (static)
</I>&gt;<i> 
</I>&gt;<i>    so_module (static)
</I>&gt;<i> 
</I>&gt;<i>    access_compat_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    actions_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    alias_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    allowmethods_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    asis_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    auth_basic_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    authn_core_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    authn_file_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    authz_core_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    authz_groupfile_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    authz_host_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    authz_user_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    autoindex_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    env_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    headers_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    include_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    isapi_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    log_config_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    mime_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    negotiation_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    setenvif_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    socache_shmcb_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    proxy_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    proxy_http_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    logio_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    unique_id_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    ssl_module (shared)
</I>&gt;<i> 
</I>&gt;<i>    security2_module (shared)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    Does anyone have any idea how I can fix this issue? I tried searching
</I>&gt;<i>    google but could not find a solution.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    Met vriendelijke groet,
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    Jeroen Wisse | GIS infrastructuur ontwikkeling en beheer
</I>&gt;<i> 
</I>&gt;<i>    T. +31 118 631725 | E. [2]<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">js.wisse at zeeland.nl</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i>    cid:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">image001.png at 01D1E102.89F8E770</A>
</I>&gt;<i> 
</I>&gt;<i>    Provinciehuis | Abdij 6, 4331 BK Middelburg | +31 118 631011
</I>&gt;<i>    Postbus 6001, 4330 LA Middelburg | [3]www.zeeland.nl | [4]@provzeeland
</I>&gt;<i>    | [5]facebook.com/provinciezeeland | [6]instagram.com/provinciezeeland
</I>&gt;<i>    | [7]dataportaal.zeeland.nl
</I>&gt;<i> 
</I>&gt;<i> References
</I>&gt;<i> 
</I>&gt;<i>    1. <A HREF="https://www.netnea.com/cms/apache-tutorial-7_including-modsecurity-core-rules/">https://www.netnea.com/cms/apache-tutorial-7_including-modsecurity-core-rules/</A>
</I>&gt;<i>    2. mailto:/
</I>&gt;<i>    3. <A HREF="http://www.zeeland.nl/">http://www.zeeland.nl/</A>
</I>&gt;<i>    4. <A HREF="https://twitter.com/provzeeland">https://twitter.com/provzeeland</A>
</I>&gt;<i>    5. <A HREF="https://www.facebook.com/provinciezeeland">https://www.facebook.com/provinciezeeland</A>
</I>&gt;<i>    6. <A HREF="https://www.instagram.com/provinciezeeland/">https://www.instagram.com/provinciezeeland/</A>
</I>&gt;<i>    7. <A HREF="https://dataportaal.zeeland.nl/">https://dataportaal.zeeland.nl/</A>
</I>


&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>

-- 
<A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
<A HREF="https://www.feistyduck.com/books/modsecurity-handbook/">https://www.feistyduck.com/books/modsecurity-handbook/</A>
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
twitter: @ChrFolini
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002531.html">[Owasp-modsecurity-core-rule-set] Error creating rule: Unknown	variable: pk_ref)/
</A></li>
	<LI>Next message: <A HREF="002533.html">[Owasp-modsecurity-core-rule-set] Error creating rule: Unknown variable: pk_ref)/
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2532">[ date ]</a>
              <a href="thread.html#2532">[ thread ]</a>
              <a href="subject.html#2532">[ subject ]</a>
              <a href="author.html#2532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
