<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Probl&#232;me with False Positives
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%0A%09%3D%3Futf-8%3Fq%3FProbl%3DC3%3DA8me_with_Fa%3F%3D%20%3D%3Futf-8%3Fq%3Flse_Positives%3F%3D&In-Reply-To=%3CCAC%2BO4mHTMrtVNjGtCJz9VOPaGw6V%2Bc5kfaW-F%2BC0JnxoW%3DQE5Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001574.html">
   <LINK REL="Next"  HREF="001576.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Probl&#232;me with False Positives</H1>
    <B>Josh Amishav-Zlatin</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%0A%09%3D%3Futf-8%3Fq%3FProbl%3DC3%3DA8me_with_Fa%3F%3D%20%3D%3Futf-8%3Fq%3Flse_Positives%3F%3D&In-Reply-To=%3CCAC%2BO4mHTMrtVNjGtCJz9VOPaGw6V%2Bc5kfaW-F%2BC0JnxoW%3DQE5Q%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Probl&#232;me with False Positives">jamuse at owasp.org
       </A><BR>
    <I>Thu Jun 26 12:44:40 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="001574.html">[Owasp-modsecurity-core-rule-set] Probl&#232;me with False Positives
</A></li>
        <LI>Next message: <A HREF="001576.html">[Owasp-modsecurity-core-rule-set] Probl&#232;me with False Positives
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1575">[ date ]</a>
              <a href="thread.html#1575">[ thread ]</a>
              <a href="subject.html#1575">[ subject ]</a>
              <a href="author.html#1575">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Thu, Jun 26, 2014 at 3:19 PM, Ilyass Kaouam &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ilyassikai at gmail.com</A>&gt; wrote:

&gt;<i> Hi guys.
</I>&gt;<i>
</I>&gt;<i> I not understand why modsecurity blocking my request with the character
</I>&gt;<i> &quot;&#224;&quot; in french.
</I>&gt;<i> log:
</I>&gt;<i>
</I>
Hi Ilyass,

Take a look at the SecUnicodeCodePage and SecUnicodeMapFile directives. For
more information see:

<A HREF="http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html">http://blog.spiderlabs.com/2012/08/waf-normalization-and-i18n.html</A>

--
 - Josh





&gt;<i>
</I>&gt;<i> *--169a1612-A--*
</I>&gt;<i>
</I>&gt;<i> *[26/Jun/2014:11:48:57 +0200] U6vsiX8AAAEAAEkNI7cAAAAQ *
</I>&gt;<i>
</I>&gt;<i> *--169a1612-B--*
</I>&gt;<i>
</I>&gt;<i> *POST /beta/societe-xxxxxr HTTP/1.1*
</I>&gt;<i>
</I>&gt;<i> *Host: www.xxxx.xx*
</I>&gt;<i>
</I>&gt;<i> *User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:30.0) Gecko/20100101
</I>&gt;<i> Firefox/30.0*
</I>&gt;<i>
</I>&gt;<i> *Accept: */**
</I>&gt;<i>
</I>&gt;<i> *Accept-Language: fr,fr-fr;q=0.8,en-us;q=0.5,en;q=0.3*
</I>&gt;<i>
</I>&gt;<i> *Accept-Encoding: gzip, deflate*
</I>&gt;<i>
</I>&gt;<i> *Content-Type: application/x-www-form-urlencoded; charset=UTF-8*
</I>&gt;<i>
</I>&gt;<i> *X-Requested-With: XMLHttpRequest*
</I>&gt;<i>
</I>&gt;<i> *Referer: <A HREF="http://www.xxx.xxx/beta/societe-xxxx">http://www.xxx.xxx/beta/societe-xxxx</A>
</I>&gt;<i> &lt;<A HREF="http://www.xxx.xxx/beta/societe-xxxx">http://www.xxx.xxx/beta/societe-xxxx</A>&gt;*
</I>&gt;<i>
</I>&gt;<i> *Content-Length: 760*
</I>&gt;<i>
</I>&gt;<i> *Cookie: JSESSIONID=DC9410B3998A7E973EDBA0ED638F5B40;
</I>&gt;<i> __utma=111125463.1374472637.1403014671.1403719512.1403772965.34;
</I>&gt;<i> __utmz=111125463.1403435014.17.3.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided);
</I>&gt;<i> __utmb=111125463.24.10.1403772965; __utmc=111125463;
</I>&gt;<i> JSESSIONID=EB7E51CFBA0B811E9335731DA6A26A08*
</I>&gt;<i>
</I>&gt;<i> *Connection: keep-alive*
</I>&gt;<i>
</I>&gt;<i> *Pragma: no-cache*
</I>&gt;<i>
</I>&gt;<i> *Cache-Control: no-cache*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  *--169a1612-C--*
</I>&gt;<i>
</I>&gt;<i> *codeAction=1&amp;entid=367928&amp;bilid=321761&amp;idMkt=672&amp;denomination=&amp;capital=10+000+&amp;activite=PRODUCTION+DES+FILMS+CINEMATOGRAPHIQUES+ET+AUDIOVISEUL&amp;effectif=0&amp;effectifCadre=0&amp;segmentEffectif=1&amp;dateContribution=17%2F08%2F13+%C3%A0+15%3A41&amp;loginUser=nabilchant%40hotmail.fr
</I>&gt;<i> &lt;<A HREF="http://40hotmail.fr">http://40hotmail.fr</A>&gt;&amp;emailUser=nabilchant%40hotmail.fr
</I>&gt;<i> &lt;<A HREF="http://40hotmail.fr">http://40hotmail.fr</A>&gt;&amp;id=672&amp;denomination_validator=&amp;rc_validator=&amp;tribunal_validator=&amp;fmj_validator=&amp;capital_validator=&amp;adresse_validator=&amp;ville_validator=&amp;activite_validator=&amp;effectif_validator=&amp;segmentEffectif_validator=&amp;effectifCadre_validator=&amp;telfaxmailweb_734=on&amp;telfaxmailweb_734_validator=1&amp;data_734=0610357910&amp;type_734=1&amp;idMktTelfaxmailweb_734=0&amp;telfaxmailweb_735=on&amp;telfaxmailweb_735_validator=1&amp;data_735=0633327850&amp;type_735=1&amp;idMktTelfaxmailweb_735=0&amp;statut=1&amp;remarque=*
</I>&gt;<i>
</I>&gt;<i> *--169a1612-F--*
</I>&gt;<i>
</I>&gt;<i> *HTTP/1.1 403 Forbidden*
</I>&gt;<i>
</I>&gt;<i> *Content-Length: 245*
</I>&gt;<i>
</I>&gt;<i> *Connection: close*
</I>&gt;<i>
</I>&gt;<i> *Content-Type: text/html; charset=iso-8859-1*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  *--169a1612-E--*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  *--169a1612-H--*
</I>&gt;<i>
</I>&gt;<i> *Message: Access denied with code 403 (phase 2). Pattern match &quot;\\W{4,}&quot;
</I>&gt;<i> at ARGS:dateContribution. [file
</I>&gt;<i> &quot;/etc/httpd/modsecurity-crs/base_rules/modsecurity_crs_40_generic_attacks.conf&quot;]
</I>&gt;<i> [line &quot;37&quot;] [id &quot;960024&quot;] [rev &quot;2&quot;] [msg &quot;Meta-Character Anomaly Detection
</I>&gt;<i> Alert - Repetative Non-Word Characters&quot;] [data &quot;Matched Data:  \xc3\xa0
</I>&gt;<i> found within ARGS:dateContribution: 17/08/13 \xc3\xa0 15:41&quot;] [ver
</I>&gt;<i> &quot;OWASP_CRS/2.2.9&quot;] [maturity &quot;9&quot;] [accuracy &quot;8&quot;]*
</I>&gt;<i>
</I>&gt;<i> *Action: Intercepted (phase 2)*
</I>&gt;<i>
</I>&gt;<i> *Apache-Handler: proxy-server*
</I>&gt;<i>
</I>&gt;<i> *Stopwatch: 1403776137380257 11043 (- - -)*
</I>&gt;<i>
</I>&gt;<i> *Stopwatch2: 1403776137380257 11043; combined=642, p1=224, p2=399, p3=0,
</I>&gt;<i> p4=0, p5=19, sr=37, sw=0, l=0, gc=0*
</I>&gt;<i>
</I>&gt;<i> *Response-Body-Transformed: Dechunked*
</I>&gt;<i>
</I>&gt;<i> *Producer: ModSecurity for Apache/2.7.3 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>
</I>&gt;<i> &lt;<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>&gt;); OWASP_CRS/2.2.9. &lt;<A HREF="http://2.2.9.">http://2.2.9.</A>&gt;*
</I>&gt;<i>
</I>&gt;<i> *Server: Apache*
</I>&gt;<i>
</I>&gt;<i> *Engine-Mode: &quot;ENABLED&quot;*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  *--169a1612-Z--*
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>  how to allow these types of characters.
</I>&gt;<i> thank you.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140626/7591886d/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140626/7591886d/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001574.html">[Owasp-modsecurity-core-rule-set] Probl&#232;me with False Positives
</A></li>
	<LI>Next message: <A HREF="001576.html">[Owasp-modsecurity-core-rule-set] Probl&#232;me with False Positives
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1575">[ date ]</a>
              <a href="thread.html#1575">[ thread ]</a>
              <a href="subject.html#1575">[ subject ]</a>
              <a href="author.html#1575">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
