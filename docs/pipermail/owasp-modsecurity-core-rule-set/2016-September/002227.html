<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20CRS%20v3.0%20False%20Positive%0A%09rule%20920120&In-Reply-To=%3CD7A71DF0-C75A-4E81-B02D-AFC85F43DD4B%40pumastudios.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002231.html">
   <LINK REL="Next"  HREF="002232.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120</H1>
    <B>Ken Brucker</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20CRS%20v3.0%20False%20Positive%0A%09rule%20920120&In-Reply-To=%3CD7A71DF0-C75A-4E81-B02D-AFC85F43DD4B%40pumastudios.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120">ken at pumastudios.com
       </A><BR>
    <I>Sun Sep  4 15:26:37 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002231.html">[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules 930100, 930110 definitions
</A></li>
        <LI>Next message: <A HREF="002232.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2227">[ date ]</a>
              <a href="thread.html#2227">[ thread ]</a>
              <a href="subject.html#2227">[ subject ]</a>
              <a href="author.html#2227">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Playing with OWASP CRS v3.0 and have a false positive on rule 920120.

The application is Picasa (no longer available from Google). During file uploads it produces the failing pattern when communicating with the target website. I have no control over the application end of this and there's no hope for a fix from Google since they have dropped the product. It does still work however so I continue to use it.

I'm disabling this rule for this user agent using:

SecRule REQUEST_HEADERS:User-Agent &quot;@beginsWith Picasa/3.&quot; &quot;id:1010,phase:1,t:none,nolog,pass,ctl:ruleRemoveById=920120&quot;


Here's the entry from the audit log:

--93ede52c-A--
[04/Sep/2016:07:57:20 --0700] V8w2UH8AAAEAADHQvy0AAABV 192.168.56.1 64619 192.16
8.56.101 80
--93ede52c-B--
POST /picasa_album_uploader/upload HTTP/1.1
Host: wpdev.local
Accept: */*
Accept-Encoding: gzip
Content-Length: 117779
Content-Type: multipart/form-data; boundary=---------------------------98E77E01B
348
Cookie: wordpress_logged_in_bdc5a801bed99bd8e2693412031c90e0=thor%7C1473173832%7
COzgZxmia5N6cIlq8cByzDuXNOUtUG8ksqAsyHg12XMA%7Cd70c349c19dfc0274e629711840a30937
a640e3c6f07362d76dab9bac3b58e68; wordpress_test_cookie=WP+Cookie+check
Connection: keep-alive
User-Agent: Picasa/3.9.141.306 (gzip)

--93ede52c-I--
picasa%2dalbum%2duploader%2dupload%2dimages=48fd37703c&amp;%5fwp%5fhttp%5freferer=%2
fpicasa%5falbum%5fuploader%2fminibrowser&amp;size=on&amp;title%5b%5d=IMG%5f5306%2eJPG&amp;ca
ption%5b%5d=&amp;description%5b%5d=
--93ede52c-F--
HTTP/1.1 403 Forbidden
Content-Length: 237
Connection: close
Content-Type: text/html; charset=iso-8859-1

--93ede52c-E--

--93ede52c-H--
Message: Warning. Pattern match &quot;['\&quot;;=]&quot; at FILES_NAMES:<A HREF="http://localhost:63391/">http://localhost:63391/</A>
d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f122032b.jpg?size=1024. [file &quot;/v
agrant/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line
 &quot;108&quot;] [id &quot;920120&quot;] [rev &quot;1&quot;] [msg &quot;Attempted multipart/form-data bypass&quot;] [da
ta &quot;<A HREF="http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f12203">http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f12203</A>
2b.jpg?size=1024&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] 
[accuracy &quot;7&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-m
ulti&quot;] [tag &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ&quot;] 
[tag &quot;CAPEC-272&quot;]
Message: Access denied with code 403 (phase 2). Operator GE matched 5 at TX:anom
aly_score. [file &quot;/vagrant/owasp-modsecurity-crs/rules/REQUEST-949-BLOCKING-EVAL
UATION.conf&quot;] [line &quot;53&quot;] [id &quot;949110&quot;] [msg &quot;Inbound Anomaly Score Exceeded (To
tal Score: 5)&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-m
ulti&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-generic&quot;]
Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file &quot;/vag
rant/owasp-modsecurity-crs/rules/RESPONSE-980-CORRELATION.conf&quot;] [line &quot;73&quot;] [id
 &quot;980130&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total Inbound Score: 5 - SQLI=0
,XSS=0,RFI=0,LFI=0,RCE=0,PHPI=0,HTTP=0,SESS=0): Attempted multipart/form-data by
pass&quot;] [tag &quot;event-correlation&quot;]
Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
ty: %s%s [uri &quot;%s&quot;]%s
Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
ty: %s%s [uri &quot;%s&quot;]%s
Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
ty: %s%s [uri &quot;%s&quot;]%s
Action: Intercepted (phase 2)
Stopwatch: 1473001040658089 39084 (- - -)
Stopwatch2: 1473001040658089 39084; combined=2811, p1=201, p2=2420, p3=0, p4=0, 
p5=189, sr=27, sw=1, l=0, gc=0
Response-Body-Transformed: Dechunked
Producer: ModSecurity for Apache/2.9.1 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); OWASP_CRS/
3.0.0.
Server: Apache/2.4.23 (Ubuntu)
Engine-Mode: &quot;ENABLED&quot;

--93ede52c-J--
4,116587,&quot;IMG_5306.JPG&quot;,&quot;&lt;Unknown ContentType&gt;&quot;
Total,116587

--93ede52c-Z--

-- Ken
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160904/3bfd8158/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160904/3bfd8158/attachment.html</A>&gt;
</PRE>






<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002231.html">[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules 930100, 930110 definitions
</A></li>
	<LI>Next message: <A HREF="002232.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2227">[ date ]</a>
              <a href="thread.html#2227">[ thread ]</a>
              <a href="subject.html#2227">[ subject ]</a>
              <a href="author.html#2227">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
