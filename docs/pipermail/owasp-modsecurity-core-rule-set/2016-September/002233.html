<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20CRS%20v3.0%20False%20Positive%0A%09rule%20920120&In-Reply-To=%3C1F8F8EA7-ECBA-4FC0-A6B8-1DD267E0389E%40pumastudios.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002232.html">
   <LINK REL="Next"  HREF="002234.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120</H1>
    <B>Ken Brucker</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20CRS%20v3.0%20False%20Positive%0A%09rule%20920120&In-Reply-To=%3C1F8F8EA7-ECBA-4FC0-A6B8-1DD267E0389E%40pumastudios.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120">ken at pumastudios.com
       </A><BR>
    <I>Mon Sep  5 15:05:51 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002232.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120
</A></li>
        <LI>Next message: <A HREF="002234.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2233">[ date ]</a>
              <a href="thread.html#2233">[ thread ]</a>
              <a href="subject.html#2233">[ subject ]</a>
              <a href="author.html#2233">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Christian,

Here's a redacted version that includes the C bit minus the content of the jpg file itself. I've added this to a github issue.

-- Ken

--0c41777f-A--
[05/Sep/2016:06:56:20 --0700] V815hH8AAAEAAFYB3d0AAABQ 192.168.56.1 62686 192.16
8.56.101 80
--0c41777f-B--
POST /picasa_album_uploader/upload HTTP/1.1
Host: wpdev.local
Accept: */*
Accept-Encoding: gzip
Content-Length: 134956
Content-Type: multipart/form-data; boundary=---------------------------482C81C09
614
Cookie: wordpress_logged_in_bdc5a801bed99bd8e2693412031c90e0=thor%7C1473256578%7
CqBvxoWnF7B59roUjZK1ypaRxJ6uqqhXJoKkgE1bUfGQ%7C0d1f9bd3868cf2a2df1330248d35e3689
623535f486e66910a9700ae4c2c16dd; wordpress_test_cookie=WP+Cookie+check
Connection: keep-alive
User-Agent: Picasa/3.9.141.306 (gzip)

--0c41777f-C--
-----------------------------482C81C09614
Content-Disposition: form-data; name=&quot;picasa-album-uploader-upload-images&quot;
Content-Type: text/plain; charset=utf-8

0349e21fed
-----------------------------482C81C09614
Content-Disposition: form-data; name=&quot;_wp_http_referer&quot;
Content-Type: text/plain; charset=utf-8

/picasa_album_uploader/minibrowser
-----------------------------482C81C09614
Content-Disposition: form-data; name=&quot;size&quot;
Content-Type: text/plain; charset=utf-8

on
-----------------------------482C81C09614
Content-Disposition: form-data; name=&quot;<A HREF="http://localhost:62667/2d1afc4dac01219e865">http://localhost:62667/2d1afc4dac01219e865</A>
92ecb3f4a9d8e/image/2fa2bc77befd46db.jpg?size=1024&quot;; filename=&quot;IMG_6822.JPG&quot;
Content-Type: image/jpeg
 
[ Redacted ]

-----------------------------482C81C09614
Content-Disposition: form-data; name=&quot;title[]&quot;
Content-Type: text/plain; charset=utf-8

IMG_6822.JPG
-----------------------------482C81C09614
Content-Disposition: form-data; name=&quot;caption[]&quot;
Content-Type: text/plain; charset=utf-8


-----------------------------482C81C09614
Content-Disposition: form-data; name=&quot;description[]&quot;
Content-Type: text/plain; charset=utf-8

Deer in Austin
-----------------------------482C81C09614--

--0c41777f-F--
HTTP/1.1 403 Forbidden
Content-Length: 237
Connection: close
Content-Type: text/html; charset=iso-8859-1

--0c41777f-H--
Message: Warning. Pattern match &quot;['\&quot;;=]&quot; at FILES_NAMES:<A HREF="http://localhost:62667/">http://localhost:62667/</A>
2d1afc4dac01219e86592ecb3f4a9d8e/image/2fa2bc77befd46db.jpg?size=1024. [file &quot;/vagrant/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line &quot;108&quot;] [id &quot;920120&quot;] [rev &quot;1&quot;] [msg &quot;Attempted multipart/form-data bypass&quot;] [data &quot;<A HREF="http://localhost:62667/2d1afc4dac01219e86592ecb3f4a9d8e/image/2fa2bc77befd46db.jpg?size=1024">http://localhost:62667/2d1afc4dac01219e86592ecb3f4a9d8e/image/2fa2bc77befd46db.jpg?size=1024</A>&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] [accuracy &quot;7&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ&quot;] [tag &quot;CAPEC-272&quot;]
Message: Access denied with code 403 (phase 2). Operator GE matched 5 at TX:anomaly_score. [file &quot;/vagrant/owasp-modsecurity-crs/rules/REQUEST-949-BLOCKING-EVALUATION.conf&quot;] [line &quot;53&quot;] [id &quot;949110&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total Score: 5)&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-generic&quot;]
Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file &quot;/vagrant/owasp-modsecurity-crs/rules/RESPONSE-980-CORRELATION.conf&quot;] [line &quot;73&quot;] [id &quot;980130&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total Inbound Score: 5 - SQLI=0,XSS=0,RFI=0,LFI=0,RCE=0,PHPI=0,HTTP=0,SESS=0): Attempted multipart/form-data bypass&quot;] [tag &quot;event-correlation&quot;]
Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecurity: %s%s [uri &quot;%s&quot;]%s
Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecurity: %s%s [uri &quot;%s&quot;]%s
Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecurity: %s%s [uri &quot;%s&quot;]%s
Action: Intercepted (phase 2)
Stopwatch: 1473083780329702 6475 (- - -)
Stopwatch2: 1473083780329702 6475; combined=2451, p1=208, p2=2078, p3=0, p4=0, p5=164, sr=26, sw=1, l=0, gc=0
Producer: ModSecurity for Apache/2.9.1 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); OWASP_CRS/3.0.0.
Server: Apache/2.4.23 (Ubuntu)
Engine-Mode: &quot;ENABLED&quot;

--0c41777f-J--
4,133750,&quot;IMG_6822.JPG&quot;,&quot;&lt;Unknown ContentType&gt;&quot;
Total,133750

--0c41777f-Z--


&gt;<i> On Sep 5, 2016, at 4:09 AM, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt; wrote:
</I>&gt;<i> 
</I>&gt;<i> Hello Ken,
</I>&gt;<i> 
</I>&gt;<i> Classical False Positive.
</I>&gt;<i> 
</I>&gt;<i> You have your audit log parts configured to include only the I part.
</I>&gt;<i> I think the uploaded filename in question is
</I>&gt;<i> <A HREF="http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f122032b.jpg?size=1024">http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f122032b.jpg?size=1024</A>
</I>&gt;<i> 
</I>&gt;<i> But could you please show us the C part - or dump the full traffic,
</I>&gt;<i> we this becomes visible.
</I>&gt;<i> 
</I>&gt;<i> And then, would you please open an issue on github for this?
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> 
</I>&gt;<i> Christian
</I>&gt;<i> 
</I>&gt;<i> On Sun, Sep 04, 2016 at 08:26:37AM -0700, Ken Brucker wrote:
</I>&gt;&gt;<i> Playing with OWASP CRS v3.0 and have a false positive on rule 920120.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> The application is Picasa (no longer available from Google). During file uploads it produces the failing pattern when communicating with the target website. I have no control over the application end of this and there's no hope for a fix from Google since they have dropped the product. It does still work however so I continue to use it.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I'm disabling this rule for this user agent using:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> SecRule REQUEST_HEADERS:User-Agent &quot;@beginsWith Picasa/3.&quot; &quot;id:1010,phase:1,t:none,nolog,pass,ctl:ruleRemoveById=920120&quot;
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Here's the entry from the audit log:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --93ede52c-A--
</I>&gt;&gt;<i> [04/Sep/2016:07:57:20 --0700] V8w2UH8AAAEAADHQvy0AAABV 192.168.56.1 64619 192.16
</I>&gt;&gt;<i> 8.56.101 80
</I>&gt;&gt;<i> --93ede52c-B--
</I>&gt;&gt;<i> POST /picasa_album_uploader/upload HTTP/1.1
</I>&gt;&gt;<i> Host: wpdev.local
</I>&gt;&gt;<i> Accept: */*
</I>&gt;&gt;<i> Accept-Encoding: gzip
</I>&gt;&gt;<i> Content-Length: 117779
</I>&gt;&gt;<i> Content-Type: multipart/form-data; boundary=---------------------------98E77E01B
</I>&gt;&gt;<i> 348
</I>&gt;&gt;<i> Cookie: wordpress_logged_in_bdc5a801bed99bd8e2693412031c90e0=thor%7C1473173832%7
</I>&gt;&gt;<i> COzgZxmia5N6cIlq8cByzDuXNOUtUG8ksqAsyHg12XMA%7Cd70c349c19dfc0274e629711840a30937
</I>&gt;&gt;<i> a640e3c6f07362d76dab9bac3b58e68; wordpress_test_cookie=WP+Cookie+check
</I>&gt;&gt;<i> Connection: keep-alive
</I>&gt;&gt;<i> User-Agent: Picasa/3.9.141.306 (gzip)
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --93ede52c-I--
</I>&gt;&gt;<i> picasa%2dalbum%2duploader%2dupload%2dimages=48fd37703c&amp;%5fwp%5fhttp%5freferer=%2
</I>&gt;&gt;<i> fpicasa%5falbum%5fuploader%2fminibrowser&amp;size=on&amp;title%5b%5d=IMG%5f5306%2eJPG&amp;ca
</I>&gt;&gt;<i> ption%5b%5d=&amp;description%5b%5d=
</I>&gt;&gt;<i> --93ede52c-F--
</I>&gt;&gt;<i> HTTP/1.1 403 Forbidden
</I>&gt;&gt;<i> Content-Length: 237
</I>&gt;&gt;<i> Connection: close
</I>&gt;&gt;<i> Content-Type: text/html; charset=iso-8859-1
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --93ede52c-E--
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --93ede52c-H--
</I>&gt;&gt;<i> Message: Warning. Pattern match &quot;['\&quot;;=]&quot; at FILES_NAMES:<A HREF="http://localhost:63391/">http://localhost:63391/</A>
</I>&gt;&gt;<i> d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f122032b.jpg?size=1024. [file &quot;/v
</I>&gt;&gt;<i> agrant/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line
</I>&gt;&gt;<i> &quot;108&quot;] [id &quot;920120&quot;] [rev &quot;1&quot;] [msg &quot;Attempted multipart/form-data bypass&quot;] [da
</I>&gt;&gt;<i> ta &quot;<A HREF="http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f12203">http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f12203</A>
</I>&gt;&gt;<i> 2b.jpg?size=1024&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] 
</I>&gt;&gt;<i> [accuracy &quot;7&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-m
</I>&gt;&gt;<i> ulti&quot;] [tag &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ&quot;] 
</I>&gt;&gt;<i> [tag &quot;CAPEC-272&quot;]
</I>&gt;&gt;<i> Message: Access denied with code 403 (phase 2). Operator GE matched 5 at TX:anom
</I>&gt;&gt;<i> aly_score. [file &quot;/vagrant/owasp-modsecurity-crs/rules/REQUEST-949-BLOCKING-EVAL
</I>&gt;&gt;<i> UATION.conf&quot;] [line &quot;53&quot;] [id &quot;949110&quot;] [msg &quot;Inbound Anomaly Score Exceeded (To
</I>&gt;&gt;<i> tal Score: 5)&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-m
</I>&gt;&gt;<i> ulti&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-generic&quot;]
</I>&gt;&gt;<i> Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file &quot;/vag
</I>&gt;&gt;<i> rant/owasp-modsecurity-crs/rules/RESPONSE-980-CORRELATION.conf&quot;] [line &quot;73&quot;] [id
</I>&gt;&gt;<i> &quot;980130&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total Inbound Score: 5 - SQLI=0
</I>&gt;&gt;<i> ,XSS=0,RFI=0,LFI=0,RCE=0,PHPI=0,HTTP=0,SESS=0): Attempted multipart/form-data by
</I>&gt;&gt;<i> pass&quot;] [tag &quot;event-correlation&quot;]
</I>&gt;&gt;<i> Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
</I>&gt;&gt;<i> ty: %s%s [uri &quot;%s&quot;]%s
</I>&gt;&gt;<i> Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
</I>&gt;&gt;<i> ty: %s%s [uri &quot;%s&quot;]%s
</I>&gt;&gt;<i> Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
</I>&gt;&gt;<i> ty: %s%s [uri &quot;%s&quot;]%s
</I>&gt;&gt;<i> Action: Intercepted (phase 2)
</I>&gt;&gt;<i> Stopwatch: 1473001040658089 39084 (- - -)
</I>&gt;&gt;<i> Stopwatch2: 1473001040658089 39084; combined=2811, p1=201, p2=2420, p3=0, p4=0, 
</I>&gt;&gt;<i> p5=189, sr=27, sw=1, l=0, gc=0
</I>&gt;&gt;<i> Response-Body-Transformed: Dechunked
</I>&gt;&gt;<i> Producer: ModSecurity for Apache/2.9.1 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); OWASP_CRS/
</I>&gt;&gt;<i> 3.0.0.
</I>&gt;&gt;<i> Server: Apache/2.4.23 (Ubuntu)
</I>&gt;&gt;<i> Engine-Mode: &quot;ENABLED&quot;
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --93ede52c-J--
</I>&gt;&gt;<i> 4,116587,&quot;IMG_5306.JPG&quot;,&quot;&lt;Unknown ContentType&gt;&quot;
</I>&gt;&gt;<i> Total,116587
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> --93ede52c-Z--
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> -- Ken
</I>&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> <A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
</I>&gt;<i> mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
</I>&gt;<i> twitter: @ChrFolini
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160905/b44e4fa9/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160905/b44e4fa9/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002232.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120
</A></li>
	<LI>Next message: <A HREF="002234.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2233">[ date ]</a>
              <a href="thread.html#2233">[ thread ]</a>
              <a href="subject.html#2233">[ subject ]</a>
              <a href="author.html#2233">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
