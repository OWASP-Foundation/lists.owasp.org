<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20CRS%20v3.0%20False%20Positive%0A%20rule%20920120&In-Reply-To=%3C20160905110959.GB14654%40elias%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002227.html">
   <LINK REL="Next"  HREF="002233.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120</H1>
    <B>Christian Folini</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20OWASP%20CRS%20v3.0%20False%20Positive%0A%20rule%20920120&In-Reply-To=%3C20160905110959.GB14654%40elias%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive rule 920120">christian.folini at netnea.com
       </A><BR>
    <I>Mon Sep  5 11:09:59 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002227.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120
</A></li>
        <LI>Next message: <A HREF="002233.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2232">[ date ]</a>
              <a href="thread.html#2232">[ thread ]</a>
              <a href="subject.html#2232">[ subject ]</a>
              <a href="author.html#2232">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello Ken,

Classical False Positive.

You have your audit log parts configured to include only the I part.
I think the uploaded filename in question is
<A HREF="http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f122032b.jpg?size=1024">http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f122032b.jpg?size=1024</A>

But could you please show us the C part - or dump the full traffic,
we this becomes visible.

And then, would you please open an issue on github for this?

Cheers,

Christian

On Sun, Sep 04, 2016 at 08:26:37AM -0700, Ken Brucker wrote:
&gt;<i> Playing with OWASP CRS v3.0 and have a false positive on rule 920120.
</I>&gt;<i> 
</I>&gt;<i> The application is Picasa (no longer available from Google). During file uploads it produces the failing pattern when communicating with the target website. I have no control over the application end of this and there's no hope for a fix from Google since they have dropped the product. It does still work however so I continue to use it.
</I>&gt;<i> 
</I>&gt;<i> I'm disabling this rule for this user agent using:
</I>&gt;<i> 
</I>&gt;<i> SecRule REQUEST_HEADERS:User-Agent &quot;@beginsWith Picasa/3.&quot; &quot;id:1010,phase:1,t:none,nolog,pass,ctl:ruleRemoveById=920120&quot;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Here's the entry from the audit log:
</I>&gt;<i> 
</I>&gt;<i> --93ede52c-A--
</I>&gt;<i> [04/Sep/2016:07:57:20 --0700] V8w2UH8AAAEAADHQvy0AAABV 192.168.56.1 64619 192.16
</I>&gt;<i> 8.56.101 80
</I>&gt;<i> --93ede52c-B--
</I>&gt;<i> POST /picasa_album_uploader/upload HTTP/1.1
</I>&gt;<i> Host: wpdev.local
</I>&gt;<i> Accept: */*
</I>&gt;<i> Accept-Encoding: gzip
</I>&gt;<i> Content-Length: 117779
</I>&gt;<i> Content-Type: multipart/form-data; boundary=---------------------------98E77E01B
</I>&gt;<i> 348
</I>&gt;<i> Cookie: wordpress_logged_in_bdc5a801bed99bd8e2693412031c90e0=thor%7C1473173832%7
</I>&gt;<i> COzgZxmia5N6cIlq8cByzDuXNOUtUG8ksqAsyHg12XMA%7Cd70c349c19dfc0274e629711840a30937
</I>&gt;<i> a640e3c6f07362d76dab9bac3b58e68; wordpress_test_cookie=WP+Cookie+check
</I>&gt;<i> Connection: keep-alive
</I>&gt;<i> User-Agent: Picasa/3.9.141.306 (gzip)
</I>&gt;<i> 
</I>&gt;<i> --93ede52c-I--
</I>&gt;<i> picasa%2dalbum%2duploader%2dupload%2dimages=48fd37703c&amp;%5fwp%5fhttp%5freferer=%2
</I>&gt;<i> fpicasa%5falbum%5fuploader%2fminibrowser&amp;size=on&amp;title%5b%5d=IMG%5f5306%2eJPG&amp;ca
</I>&gt;<i> ption%5b%5d=&amp;description%5b%5d=
</I>&gt;<i> --93ede52c-F--
</I>&gt;<i> HTTP/1.1 403 Forbidden
</I>&gt;<i> Content-Length: 237
</I>&gt;<i> Connection: close
</I>&gt;<i> Content-Type: text/html; charset=iso-8859-1
</I>&gt;<i> 
</I>&gt;<i> --93ede52c-E--
</I>&gt;<i> 
</I>&gt;<i> --93ede52c-H--
</I>&gt;<i> Message: Warning. Pattern match &quot;['\&quot;;=]&quot; at FILES_NAMES:<A HREF="http://localhost:63391/">http://localhost:63391/</A>
</I>&gt;<i> d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f122032b.jpg?size=1024. [file &quot;/v
</I>&gt;<i> agrant/owasp-modsecurity-crs/rules/REQUEST-920-PROTOCOL-ENFORCEMENT.conf&quot;] [line
</I>&gt;<i>  &quot;108&quot;] [id &quot;920120&quot;] [rev &quot;1&quot;] [msg &quot;Attempted multipart/form-data bypass&quot;] [da
</I>&gt;<i> ta &quot;<A HREF="http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f12203">http://localhost:63391/d8edaf7f8a66068039906ecb9d04c451/image/7c2c6d05f12203</A>
</I>&gt;<i> 2b.jpg?size=1024&quot;] [severity &quot;CRITICAL&quot;] [ver &quot;OWASP_CRS/3.0.0&quot;] [maturity &quot;9&quot;] 
</I>&gt;<i> [accuracy &quot;7&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-multi&quot;] [tag &quot;platform-m
</I>&gt;<i> ulti&quot;] [tag &quot;attack-protocol&quot;] [tag &quot;OWASP_CRS/PROTOCOL_VIOLATION/INVALID_REQ&quot;] 
</I>&gt;<i> [tag &quot;CAPEC-272&quot;]
</I>&gt;<i> Message: Access denied with code 403 (phase 2). Operator GE matched 5 at TX:anom
</I>&gt;<i> aly_score. [file &quot;/vagrant/owasp-modsecurity-crs/rules/REQUEST-949-BLOCKING-EVAL
</I>&gt;<i> UATION.conf&quot;] [line &quot;53&quot;] [id &quot;949110&quot;] [msg &quot;Inbound Anomaly Score Exceeded (To
</I>&gt;<i> tal Score: 5)&quot;] [severity &quot;CRITICAL&quot;] [tag &quot;application-multi&quot;] [tag &quot;language-m
</I>&gt;<i> ulti&quot;] [tag &quot;platform-multi&quot;] [tag &quot;attack-generic&quot;]
</I>&gt;<i> Message: Warning. Operator GE matched 5 at TX:inbound_anomaly_score. [file &quot;/vag
</I>&gt;<i> rant/owasp-modsecurity-crs/rules/RESPONSE-980-CORRELATION.conf&quot;] [line &quot;73&quot;] [id
</I>&gt;<i>  &quot;980130&quot;] [msg &quot;Inbound Anomaly Score Exceeded (Total Inbound Score: 5 - SQLI=0
</I>&gt;<i> ,XSS=0,RFI=0,LFI=0,RCE=0,PHPI=0,HTTP=0,SESS=0): Attempted multipart/form-data by
</I>&gt;<i> pass&quot;] [tag &quot;event-correlation&quot;]
</I>&gt;<i> Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
</I>&gt;<i> ty: %s%s [uri &quot;%s&quot;]%s
</I>&gt;<i> Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
</I>&gt;<i> ty: %s%s [uri &quot;%s&quot;]%s
</I>&gt;<i> Apache-Error: [file &quot;apache2_util.c&quot;] [line 271] [level 3] [client %s] ModSecuri
</I>&gt;<i> ty: %s%s [uri &quot;%s&quot;]%s
</I>&gt;<i> Action: Intercepted (phase 2)
</I>&gt;<i> Stopwatch: 1473001040658089 39084 (- - -)
</I>&gt;<i> Stopwatch2: 1473001040658089 39084; combined=2811, p1=201, p2=2420, p3=0, p4=0, 
</I>&gt;<i> p5=189, sr=27, sw=1, l=0, gc=0
</I>&gt;<i> Response-Body-Transformed: Dechunked
</I>&gt;<i> Producer: ModSecurity for Apache/2.9.1 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>); OWASP_CRS/
</I>&gt;<i> 3.0.0.
</I>&gt;<i> Server: Apache/2.4.23 (Ubuntu)
</I>&gt;<i> Engine-Mode: &quot;ENABLED&quot;
</I>&gt;<i> 
</I>&gt;<i> --93ede52c-J--
</I>&gt;<i> 4,116587,&quot;IMG_5306.JPG&quot;,&quot;&lt;Unknown ContentType&gt;&quot;
</I>&gt;<i> Total,116587
</I>&gt;<i> 
</I>&gt;<i> --93ede52c-Z--
</I>&gt;<i> 
</I>&gt;<i> -- Ken
</I>
&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>

-- 
<A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
twitter: @ChrFolini
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002227.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120
</A></li>
	<LI>Next message: <A HREF="002233.html">[Owasp-modsecurity-core-rule-set] OWASP CRS v3.0 False Positive	rule 920120
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2232">[ date ]</a>
              <a href="thread.html#2232">[ thread ]</a>
              <a href="subject.html#2232">[ subject ]</a>
              <a href="author.html#2232">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
