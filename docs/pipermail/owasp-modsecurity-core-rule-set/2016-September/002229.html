<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules 930100, 930110 definitions
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20Version%203.0%20RC1%20Rules%0A%20930100%2C%20930110%20definitions&In-Reply-To=%3CVI1PR06MB147127F66859ED4BD035653782E70%40VI1PR06MB1471.eurprd06.prod.outlook.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="002228.html">
   <LINK REL="Next"  HREF="002230.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules 930100, 930110 definitions</H1>
    <B>Barry Pollard</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20CRS%20Version%203.0%20RC1%20Rules%0A%20930100%2C%20930110%20definitions&In-Reply-To=%3CVI1PR06MB147127F66859ED4BD035653782E70%40VI1PR06MB1471.eurprd06.prod.outlook.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules 930100, 930110 definitions">barry_pollard at hotmail.com
       </A><BR>
    <I>Sun Sep  4 17:43:30 UTC 2016</I>
    <P><UL>
        <LI>Previous message: <A HREF="002228.html">[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules 930100, 930110 definitions
</A></li>
        <LI>Next message: <A HREF="002230.html">[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules	930100, 930110 definitions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2229">[ date ]</a>
              <a href="thread.html#2229">[ thread ]</a>
              <a href="subject.html#2229">[ subject ]</a>
              <a href="author.html#2229">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Been thinking about this and you've got me intrigued as to whether this was an intentional decision or not...

As far as I can see, you are right these could have been written using REQUEST_FILENAME and ARGS rather than REQUEST_URI and REQUEST_BODY.

ModSecurity is quite flexible and there are a few different ways of doing things. So it can depend on whoever writes the rules as to which version they use.

This is just a guess, but I wonder if the reason these variables were chosen is hinted at in this line in the manual ModSecurity manual (<A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#REQUEST_BODY">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#REQUEST_BODY</A>):

There are no default transformation functions, as there were in the first generation of ModSecurity (1.x).

and also lines like this:

Note : Please note that anti-evasion transformations are not used on REQUEST_URI, which means that you will have to specify them in the rules that use this variable.
I'm not sure what the default transformations were in ModSecurity 1.x, or if these were the anti-evasion transformations being discussed but wonder that was the reason - as it would prevent these rules from working if the ARGS were used and default transformations were applied?

If you need the ability to override these on certain ARGS (though I think that could be dangerous - and have personally never seen any false positives with these) you could replace them as you see fit - either directly in the file (not recommended as will be overwritten if you ever upgrade the CRS) or by altering the rules dynamically:

#Replace REQUEST_URI with REQUEST_FILENAME
SecRuleUpdateTargetById 930100 REQUEST_URI REQUEST_FILENAME

#Also add in ARGS
SecRuleUpdateTargetById 930100 ARGS

Or use ctl:ruleRemoveById version to only do this for certain URLs.

Thanks,
Barry

On 4 Sep 2016, at 18:25, Christian Folini &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>&gt;&gt; wrote:

On Sun, Sep 04, 2016 at 08:08:53AM -0700, Ken Brucker wrote:
[ Not sure my first try posting made it through, I see it in the archive, but have had no response which I find odd. ]

I do not think the first inquiry made it through. But this time it did.

Thanks for the report. We'll investigate.

Cheers,

Christian


I have V3 rules running in a test environment playing with how it interacts with WordPress. My early investigation is showing a few rules that need to be addressed to allow code, sql examples etc. to be included in a post, nothing overly surprising.

I have a question about the construction of rules 930100 and 930110. These rules both examine REQUEST_BODY and REQUEST_HEADERS. Other rules, such as 930120 use ARGS and ARGS_NAMES, etc.

The result is it's not possible to disable 930100 and 930110 for specific ARGS where the patterns would be acceptable.

What is the motivation for the difference in how these rules are defined?

-- Ken

_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>


--
<A HREF="https://www.feistyduck.com/training/modsecurity-training-course">https://www.feistyduck.com/training/modsecurity-training-course</A>
mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">christian.folini at netnea.com</A>
twitter: @ChrFolini
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160904/ad48b6ec/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20160904/ad48b6ec/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="002228.html">[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules 930100, 930110 definitions
</A></li>
	<LI>Next message: <A HREF="002230.html">[Owasp-modsecurity-core-rule-set] CRS Version 3.0 RC1 Rules	930100, 930110 definitions
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2229">[ date ]</a>
              <a href="thread.html#2229">[ thread ]</a>
              <a href="subject.html#2229">[ subject ]</a>
              <a href="author.html#2229">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
