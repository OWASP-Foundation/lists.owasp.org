From rm4dillo at gmail.com  Fri Nov  9 14:13:43 2012
From: rm4dillo at gmail.com (rm4dillo D)
Date: Fri, 9 Nov 2012 15:13:43 +0100
Subject: [Owasp-modsecurity-core-rule-set] [BUGFIX]
 "modsecurity_crs_41_xss_attacks.conf" performance optimization test not
 working
Message-ID: <CAAzXPXByRw5C8NHfAAWh4nCYxwdEE0gKfRaG2QSzzsGwUdmV8Q@mail.gmail.com>

Hi,

The "base_rules/modsecurity_crs_41_xss_attacks.conf" rules file starts with
a smart rule that checks the presence of some keywords (Ex. script
javascript...) and depending on the result, it decides to run deeper rules
or just skip them. The problem is that the conditional "skip" never works
because it tests the "pm_xss_score" variable which is not initialized.

    SecRule TX:PM_XSS_SCORE "@eq 0"
"phase:2,id:'981018',t:none,pass,skipAfter:END_XSS_CHECK,nolog"

To fix this, I just directive this at the beginning of the file:

    SecAction
"phase:2,rev:'2.2.5',t:none,pass,nolog,setvar:tx.pm_xss_score=0"

It would be nice to fix this in the next core rule set release.

Thank you in advance.

Rm4dillo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121109/23d11620/attachment.html>

From benwilliams+owasp at joobworld.com  Sun Nov 11 21:15:43 2012
From: benwilliams+owasp at joobworld.com (Ben WIlliams)
Date: Mon, 12 Nov 2012 10:15:43 +1300
Subject: [Owasp-modsecurity-core-rule-set] patch for 2.2.5 CRS
	modsecurity_crs_16_session_hijacking.conf
Message-ID: <CANfYGQ=Pvudhhp0aO7P7H+8w5MZ=0yR4H9i1ibrTD7D9wsyf6A@mail.gmail.com>

Here are a couple of fixes I've made to the session hijacking CRS
2.2.5 rules in use with modsecurity 2.6.8.
Some of our cookie names have been changed, so ASPSESSIONIDXXX did not
match in RESPONSE_HEADERS:/Set-Cookie2?/ but did match in
REQUEST_COOKIES.

Also there is a bug related to comparisons on collection keys that do
not exist. When a request contains a cookie that has not been saved to
the SESSION collection before, the intention is for tx.anomaly_score
to be incremented by 5 (critical) and the rest of the checks skipped,
but this does not happen. Any test on a collection key that does not
exist always returns false. This means the test on SESSION:VALID "!@eq
1" returns false, when the intention is for it to return true if the
session cookie has not been seen before.  And the following rules in
the block are run which triggers 981059,981060,981061 to return true
since it is a new session collection withou ip_hash or ua_hash keys.

--
Ben
-------------- next part --------------
A non-text attachment was scrubbed...
Name: modsecurity_crs_16_session_hijacking.conf.patch
Type: application/octet-stream
Size: 2187 bytes
Desc: not available
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121112/7c94fbc7/attachment.obj>

From ryan.barnett at owasp.org  Sun Nov 11 21:59:01 2012
From: ryan.barnett at owasp.org (Ryan Barnett)
Date: Sun, 11 Nov 2012 16:59:01 -0500
Subject: [Owasp-modsecurity-core-rule-set] patch for 2.2.5 CRS
	modsecurity_crs_16_session_hijacking.conf
In-Reply-To: <CANfYGQ=Pvudhhp0aO7P7H+8w5MZ=0yR4H9i1ibrTD7D9wsyf6A@mail.gmail.com>
References: <CANfYGQ=Pvudhhp0aO7P7H+8w5MZ=0yR4H9i1ibrTD7D9wsyf6A@mail.gmail.com>
Message-ID: <992A1639-FF7F-4A47-A6AD-103C924E5761@owasp.org>

Ben,
Please follow the steps here to submit a GitHub Pull request for updates -

http://www.modsecurity.org/developers/#GitHub

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


On Nov 11, 2012, at 4:15 PM, Ben WIlliams <benwilliams+owasp at joobworld.com> wrote:

> Here are a couple of fixes I've made to the session hijacking CRS
> 2.2.5 rules in use with modsecurity 2.6.8.
> Some of our cookie names have been changed, so ASPSESSIONIDXXX did not
> match in RESPONSE_HEADERS:/Set-Cookie2?/ but did match in
> REQUEST_COOKIES.
> 
> Also there is a bug related to comparisons on collection keys that do
> not exist. When a request contains a cookie that has not been saved to
> the SESSION collection before, the intention is for tx.anomaly_score
> to be incremented by 5 (critical) and the rest of the checks skipped,
> but this does not happen. Any test on a collection key that does not
> exist always returns false. This means the test on SESSION:VALID "!@eq
> 1" returns false, when the intention is for it to return true if the
> session cookie has not been seen before.  And the following rules in
> the block are run which triggers 981059,981060,981061 to return true
> since it is a new session collection withou ip_hash or ua_hash keys.
> 
> --
> Ben
> <modsecurity_crs_16_session_hijacking.conf.patch>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set

From avi at greensmoke.net  Wed Nov 14 14:41:58 2012
From: avi at greensmoke.net (Avi Rosenblatt)
Date: Wed, 14 Nov 2012 16:41:58 +0200
Subject: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
Message-ID: <BA4A3A7C-BC82-4B92-BB51-3EC2CFFAEFF0@greensmoke.net>

Hi,
I have configured the CRS to use anomaly scoring and raised the inbound score level in order to reduce false positives. I'm currently running our server in detectiononly mode and I'm getting error log and audit log messages for any rule match regardless of score. Is there a way to only log messages when a threshold has been reached. Thanx in advance for the help.

Avi

From RBarnett at trustwave.com  Wed Nov 14 17:09:04 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 14 Nov 2012 17:09:04 +0000
Subject: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
In-Reply-To: <BA4A3A7C-BC82-4B92-BB51-3EC2CFFAEFF0@greensmoke.net>
Message-ID: <01987910BF74B341B5890120BCCE77DF091832@SKYMB1.trustwave.com>

Please refer to this blog post -
http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v
s-anomaly-scoring-detection-modes.html

Specifically the section on "Alert Management - Correlated Events".

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


On 11/14/12 9:41 AM, "Avi Rosenblatt" <avi at greensmoke.net> wrote:

>Hi,
>I have configured the CRS to use anomaly scoring and raised the inbound
>score level in order to reduce false positives. I'm currently running our
>server in detectiononly mode and I'm getting error log and audit log
>messages for any rule match regardless of score. Is there a way to only
>log messages when a threshold has been reached. Thanx in advance for the
>help.
>
>Avi
>_______________________________________________
>Owasp-modsecurity-core-rule-set mailing list
>Owasp-modsecurity-core-rule-set at lists.owasp.org
>https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>


________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From avi at greensmoke.net  Wed Nov 14 18:38:41 2012
From: avi at greensmoke.net (Avi Rosenblatt)
Date: Wed, 14 Nov 2012 20:38:41 +0200
Subject: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
In-Reply-To: <01987910BF74B341B5890120BCCE77DF091832@SKYMB1.trustwave.com>
References: <01987910BF74B341B5890120BCCE77DF091832@SKYMB1.trustwave.com>
Message-ID: <A6EEFB2F-2189-48CA-93D3-F0C999616C02@greensmoke.net>

Thanx for the response.
I used that blog post as a guide and set SecDefaultAction to "phase:2,pass,nolog,auditlog" but I still get apache log messages for rule matches even though their score is below the threshold.
By the way I am using v2.2.5 of the owasp CSR.
Thanx
Avi

On 2012-11-14, at 7:09 PM, Ryan Barnett <RBarnett at trustwave.com> wrote:

> Please refer to this blog post -
> http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v
> s-anomaly-scoring-detection-modes.html
> 
> Specifically the section on "Alert Management - Correlated Events".
> 
> --
> Ryan Barnett
> Lead Security Researcher
> Trustwave - SpiderLabs
> 
> 
> On 11/14/12 9:41 AM, "Avi Rosenblatt" <avi at greensmoke.net> wrote:
> 
>> Hi,
>> I have configured the CRS to use anomaly scoring and raised the inbound
>> score level in order to reduce false positives. I'm currently running our
>> server in detectiononly mode and I'm getting error log and audit log
>> messages for any rule match regardless of score. Is there a way to only
>> log messages when a threshold has been reached. Thanx in advance for the
>> help.
>> 
>> Avi
>> _______________________________________________
>> Owasp-modsecurity-core-rule-set mailing list
>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>> 
> 
> 
> ________________________________
> 
> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
> 

Avi Rosenblatt
IT Manager
avi at greensmoke.net
305-600-4362
-------------------------
Green Smoke, Inc. USA
It's Electric?

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121114/b506d1da/attachment.html>

From avi at greensmoke.net  Thu Nov 15 10:38:46 2012
From: avi at greensmoke.net (Avi Rosenblatt)
Date: Thu, 15 Nov 2012 12:38:46 +0200
Subject: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
In-Reply-To: <A6EEFB2F-2189-48CA-93D3-F0C999616C02@greensmoke.net>
References: <01987910BF74B341B5890120BCCE77DF091832@SKYMB1.trustwave.com>
	<A6EEFB2F-2189-48CA-93D3-F0C999616C02@greensmoke.net>
Message-ID: <2DA840B3-6408-4042-BF8C-421B2C04C71A@greensmoke.net>

Perhaps I should clarify what I'm looking for.
I would like mod security to be quiet unless the anomaly score threshold is met. When met, there should be one line in the apache error log indicating such and the audit log should multiple 'Message:'s in the 'H' section describing the rules that contributed to the score.

Thanx
Avi

On 2012-11-14, at 8:38 PM, Avi Rosenblatt <avi at greensmoke.net> wrote:

> Thanx for the response.
> I used that blog post as a guide and set SecDefaultAction to "phase:2,pass,nolog,auditlog" but I still get apache log messages for rule matches even though their score is below the threshold.
> By the way I am using v2.2.5 of the owasp CSR.
> Thanx
> Avi
> 
> On 2012-11-14, at 7:09 PM, Ryan Barnett <RBarnett at trustwave.com> wrote:
> 
>> Please refer to this blog post -
>> http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v
>> s-anomaly-scoring-detection-modes.html
>> 
>> Specifically the section on "Alert Management - Correlated Events".
>> 
>> --
>> Ryan Barnett
>> Lead Security Researcher
>> Trustwave - SpiderLabs
>> 
>> 
>> On 11/14/12 9:41 AM, "Avi Rosenblatt" <avi at greensmoke.net> wrote:
>> 
>>> Hi,
>>> I have configured the CRS to use anomaly scoring and raised the inbound
>>> score level in order to reduce false positives. I'm currently running our
>>> server in detectiononly mode and I'm getting error log and audit log
>>> messages for any rule match regardless of score. Is there a way to only
>>> log messages when a threshold has been reached. Thanx in advance for the
>>> help.
>>> 
>>> Avi
>>> _______________________________________________
>>> Owasp-modsecurity-core-rule-set mailing list
>>> Owasp-modsecurity-core-rule-set at lists.owasp.org
>>> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>>> 
>> 
>> 
>> ________________________________
>> 
>> This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
>> 
> 
> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121115/a113bbfc/attachment-0001.html>

From RBarnett at trustwave.com  Thu Nov 15 14:23:50 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Thu, 15 Nov 2012 14:23:50 +0000
Subject: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
In-Reply-To: <2DA840B3-6408-4042-BF8C-421B2C04C71A@greensmoke.net>
Message-ID: <01987910BF74B341B5890120BCCE77DF0922B0@SKYMB1.trustwave.com>

Understood.  You will want to disable rule ID 981203 in the 60 correlation file - https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_60_correlation.conf

Add a custom rule file called modsecurity_crs_99_custom.conf and add in - SecRuleRemoveById 981203

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


From: Avi Rosenblatt <avi at greensmoke.net<mailto:avi at greensmoke.net>>
Date: Thursday, November 15, 2012 5:38 AM
To: Ryan Barnett <rbarnett at trustwave.com<mailto:rbarnett at trustwave.com>>, "owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>" <owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:owasp-modsecurity-core-rule-set at lists.owasp.org>>
Subject: Re: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging

Perhaps I should clarify what I'm looking for.
I would like mod security to be quiet unless the anomaly score threshold is met. When met, there should be one line in the apache error log indicating such and the audit log should multiple 'Message:'s in the 'H' section describing the rules that contributed to the score.

Thanx
Avi

On 2012-11-14, at 8:38 PM, Avi Rosenblatt <avi at greensmoke.net<mailto:avi at greensmoke.net>> wrote:

Thanx for the response.
I used that blog post as a guide and set SecDefaultAction to "phase:2,pass,nolog,auditlog" but I still get apache log messages for rule matches even though their score is below the threshold.
By the way I am using v2.2.5 of the owasp CSR.
Thanx
Avi

On 2012-11-14, at 7:09 PM, Ryan Barnett <RBarnett at trustwave.com<mailto:RBarnett at trustwave.com>> wrote:

Please refer to this blog post -
http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-v
s-anomaly-scoring-detection-modes.html

Specifically the section on "Alert Management - Correlated Events".

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


On 11/14/12 9:41 AM, "Avi Rosenblatt" <avi at greensmoke.net<mailto:avi at greensmoke.net>> wrote:

Hi,
I have configured the CRS to use anomaly scoring and raised the inbound
score level in order to reduce false positives. I'm currently running our
server in detectiononly mode and I'm getting error log and audit log
messages for any rule match regardless of score. Is there a way to only
log messages when a threshold has been reached. Thanx in advance for the
help.

Avi
_______________________________________________
Owasp-modsecurity-core-rule-set mailing list
Owasp-modsecurity-core-rule-set at lists.owasp.org<mailto:Owasp-modsecurity-core-rule-set at lists.owasp.org>
https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set



________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.




________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121115/4dcac0d6/attachment.html>

From ivakili at yahoo.com  Sun Nov 18 11:26:50 2012
From: ivakili at yahoo.com (Iman Vakili)
Date: Sun, 18 Nov 2012 03:26:50 -0800 (PST)
Subject: [Owasp-modsecurity-core-rule-set] Stopwatch2
Message-ID: <1353238010.52389.YahooMailNeo@web164904.mail.bf1.yahoo.com>

Hi;

I couldn't find any documentation about "Stopwatch2" in the H section of logs,
for example:?
Stopwatch2: 1353183173116803 7758; combined=5944, p1=1119, p2=4812, p3=0, p4=0, p5=11, sr=199, sw=2, l=0, gc=0
can someone describe sr-sw-gc parts?

thanks in advance
best regards
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121118/ff3d9350/attachment.html>

From jamuse at gmail.com  Sun Nov 18 12:16:33 2012
From: jamuse at gmail.com (Josh Amishav-Zlatin)
Date: Sun, 18 Nov 2012 14:16:33 +0200
Subject: [Owasp-modsecurity-core-rule-set] Stopwatch2
In-Reply-To: <1353238010.52389.YahooMailNeo@web164904.mail.bf1.yahoo.com>
References: <1353238010.52389.YahooMailNeo@web164904.mail.bf1.yahoo.com>
Message-ID: <CANnPkik+M66oz+Kbz5+Ot5g12yd9aqb8N+uL364X7FPxjgnBmw@mail.gmail.com>

On Sun, Nov 18, 2012 at 1:26 PM, Iman Vakili <ivakili at yahoo.com> wrote:

> Hi;
>
> I couldn't find any documentation about "Stopwatch2" in the H section of
> logs,
> for example:
> Stopwatch2: 1353183173116803 7758; combined=5944, p1=1119, p2=4812, p3=0,
> p4=0, p5=11, sr=199, sw=2, l=0, gc=0
> can someone describe sr-sw-gc parts?
>
>
Hi Iman,

sr and sw measure the time spent reading from (sr) and writing to (sw)
persistent storage. The gc part measures the time spent on garbage
collection.

--
 - Josh



>  thanks in advance
> best regards
>
>
>
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121118/af938673/attachment.html>

From gnets1 at yahoo.co.uk  Sun Nov 18 12:29:28 2012
From: gnets1 at yahoo.co.uk (Gene)
Date: Sun, 18 Nov 2012 12:29:28 +0000 (GMT)
Subject: [Owasp-modsecurity-core-rule-set] Basic questions;
	Anomaly Scoring & id's
Message-ID: <1353241768.74808.YahooMailNeo@web132203.mail.ird.yahoo.com>



Hello,

I'm trying out current OWASP core rule set and have some basic questions first (no doubt lots more later!)

This article from 2010 about 'Anomaly Scoring' is referenced quite a lot:
http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html

in the article there are references to 'Anomaly Scoring' and to examples
But in the 10_conf.example file things seem to have shifted somewhat in 2 years
So am I correct that:
'Anomaly Scoring' has now become 'Collaborative Detection Scoring'

Also in that article it mentions unblocking a rule at end of modsecurity_crs_49_inbound_blocking.conf
However doing that results in this error:
'Starting httpd: Syntax error on line 34 of /etc/httpd/modsecurity.d/modsecurity_crs_49_inbound_blocking.conf:'
'ModSecurity: No action id present within the rule'

I'm pretty sure I read that all rules now require an 'id' (?)
Incrementing by 1 from rules above it to give id:981177 doesnt work:
'ModSecurity: Found another rule with the same id'

So what is method to get an id for this rule? any other rule?

thanks

Gene

From avi at greensmoke.net  Sun Nov 18 14:28:22 2012
From: avi at greensmoke.net (Avi Rosenblatt)
Date: Sun, 18 Nov 2012 16:28:22 +0200
Subject: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
In-Reply-To: <01987910BF74B341B5890120BCCE77DF0922B0@SKYMB1.trustwave.com>
References: <01987910BF74B341B5890120BCCE77DF0922B0@SKYMB1.trustwave.com>
Message-ID: <B36594F9-48E0-41AC-9E75-136BE799AA05@greensmoke.net>

That works for the error log. Thanx.
The issue i'm having now is that the audit log is still very chatty. It's still logging all rule matches.
Thanx
Avi

On 2012-11-15, at 4:23 PM, Ryan Barnett <RBarnett at trustwave.com> wrote:

> Understood.  You will want to disable rule ID 981203 in the 60 correlation file - https://github.com/SpiderLabs/owasp-modsecurity-crs/blob/master/base_rules/modsecurity_crs_60_correlation.conf
> 
> Add a custom rule file called modsecurity_crs_99_custom.conf and add in - SecRuleRemoveById 981203
> 
> --
> Ryan Barnett
> Lead Security Researcher
> Trustwave - SpiderLabs
> 
> 
> From: Avi Rosenblatt <avi at greensmoke.net>
> Date: Thursday, November 15, 2012 5:38 AM
> To: Ryan Barnett <rbarnett at trustwave.com>, "owasp-modsecurity-core-rule-set at lists.owasp.org" <owasp-modsecurity-core-rule-set at lists.owasp.org>
> Subject: Re: [Owasp-modsecurity-core-rule-set] Anomaly Scoring logging
> 
>> Perhaps I should clarify what I'm looking for.
>> I would like mod security to be quiet unless the anomaly score threshold is met. When met, there should be one line in the apache error log indicating such and the audit log should multiple 'Message:'s in the 'H' section describing the rules that contributed to the score.
>> 
>> Thanx
>> Avi
>> 

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121118/f2c360fa/attachment.html>

From avi at greensmoke.net  Wed Nov 21 16:02:27 2012
From: avi at greensmoke.net (Avi Rosenblatt)
Date: Wed, 21 Nov 2012 18:02:27 +0200
Subject: [Owasp-modsecurity-core-rule-set] PCRE limits error
Message-ID: <38A0007C-91DF-43CF-BB55-ECF98BA33C25@greensmoke.net>

Hi,
I'm getting a lot of 'PCRE limits exceeded' specifically with modsecurity_crs_41_sql_injection_attacks.conf line 77 (owasp crs v2.2.5)
Some of the hits are legitimate and some are attacks. If the attack gets this error, does that mean it's not blocked(I'm currently running in DetectionOnly mode)? I'm playing with the PCRE limits config params and at 50,000 I'm still getting this message.
Thanx in advance for the help.

Avi Rosenblatt

From RBarnett at trustwave.com  Wed Nov 21 16:16:11 2012
From: RBarnett at trustwave.com (Ryan Barnett)
Date: Wed, 21 Nov 2012 16:16:11 +0000
Subject: [Owasp-modsecurity-core-rule-set] PCRE limits error
In-Reply-To: <38A0007C-91DF-43CF-BB55-ECF98BA33C25@greensmoke.net>
References: <38A0007C-91DF-43CF-BB55-ECF98BA33C25@greensmoke.net>
Message-ID: <4E4EA836-4D0A-42B3-B22F-1FC1A2C6B3CA@trustwave.com>

If you are using ModSecurity v2.7.x then I suggest you use the latest OWASP CRS as I fixed many of the greedy regexs - http://spiderlabs.github.com/owasp-modsecurity-crs/

--
Ryan Barnett
Lead Security Researcher
Trustwave - SpiderLabs


On Nov 21, 2012, at 11:11 AM, "Avi Rosenblatt" <avi at greensmoke.net> wrote:

> Hi,
> I'm getting a lot of 'PCRE limits exceeded' specifically with modsecurity_crs_41_sql_injection_attacks.conf line 77 (owasp crs v2.2.5)
> Some of the hits are legitimate and some are attacks. If the attack gets this error, does that mean it's not blocked(I'm currently running in DetectionOnly mode)? I'm playing with the PCRE limits config params and at 50,000 I'm still getting this message.
> Thanx in advance for the help.
>
> Avi Rosenblatt
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>

________________________________

This transmission may contain information that is privileged, confidential, and/or exempt from disclosure under applicable law. If you are not the intended recipient, you are hereby notified that any disclosure, copying, distribution, or use of the information contained herein (including any reliance thereon) is STRICTLY PROHIBITED. If you received this transmission in error, please immediately contact the sender and destroy the material in its entirety, whether in electronic or hard copy format.


From avi at greensmoke.net  Wed Nov 21 16:34:27 2012
From: avi at greensmoke.net (Avi Rosenblatt)
Date: Wed, 21 Nov 2012 18:34:27 +0200
Subject: [Owasp-modsecurity-core-rule-set] PCRE limits error
In-Reply-To: <4E4EA836-4D0A-42B3-B22F-1FC1A2C6B3CA@trustwave.com>
References: <38A0007C-91DF-43CF-BB55-ECF98BA33C25@greensmoke.net>
	<4E4EA836-4D0A-42B3-B22F-1FC1A2C6B3CA@trustwave.com>
Message-ID: <8010024285462226649@unknownmsgid>

I am currently running modsecurity 2.6.8. Do you know where I can get
an rpm for modsecurity 2.7?

Thanx

From cybernaut at xrun.org  Wed Nov 21 16:39:41 2012
From: cybernaut at xrun.org (cybernaut at xrun.org)
Date: Thu, 22 Nov 2012 00:39:41 +0800
Subject: [Owasp-modsecurity-core-rule-set] PCRE limits error
In-Reply-To: <8010024285462226649@unknownmsgid>
References: <38A0007C-91DF-43CF-BB55-ECF98BA33C25@greensmoke.net>
	<4E4EA836-4D0A-42B3-B22F-1FC1A2C6B3CA@trustwave.com>
	<8010024285462226649@unknownmsgid>
Message-ID: <d560cb808815df904f75a99530d9809f@xrun.org>

Hi

Use the EPEL (Extra Packages for Enterprise) testing repository or the 
following URL:
http://koji.fedoraproject.org/koji/packageinfo?packageID=2556

Cheers

On 2012-11-22 00:34, Avi Rosenblatt wrote:
> I am currently running modsecurity 2.6.8. Do you know where I can get
> an rpm for modsecurity 2.7?
>
> Thanx
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> 
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set


From benwilliams+owasp at joobworld.com  Wed Nov 21 22:34:22 2012
From: benwilliams+owasp at joobworld.com (Ben WIlliams)
Date: Thu, 22 Nov 2012 11:34:22 +1300
Subject: [Owasp-modsecurity-core-rule-set] Basic questions;
 Anomaly Scoring & id's
In-Reply-To: <1353241768.74808.YahooMailNeo@web132203.mail.ird.yahoo.com>
References: <1353241768.74808.YahooMailNeo@web132203.mail.ird.yahoo.com>
Message-ID: <CANfYGQneAA6b2goTTKznCfiEp+PMa-05PH+kL8T1FWY_vJ2y9A@mail.gmail.com>

It's because modsecurity 2.7 requires id on each rule but the CRS don't
have ids on every rule. I'm unaware of a convention for choosing rule
numbers, maybe just choose any id number that is not currently used.


On Mon, Nov 19, 2012 at 1:29 AM, Gene <gnets1 at yahoo.co.uk> wrote:

>
>
> Hello,
>
> I'm trying out current OWASP core rule set and have some basic questions
> first (no doubt lots more later!)
>
> This article from 2010 about 'Anomaly Scoring' is referenced quite a lot:
>
> http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html
>
> in the article there are references to 'Anomaly Scoring' and to examples
> But in the 10_conf.example file things seem to have shifted somewhat in 2
> years
> So am I correct that:
> 'Anomaly Scoring' has now become 'Collaborative Detection Scoring'
>
> Also in that article it mentions unblocking a rule at end of
> modsecurity_crs_49_inbound_blocking.conf
> However doing that results in this error:
> 'Starting httpd: Syntax error on line 34 of
> /etc/httpd/modsecurity.d/modsecurity_crs_49_inbound_blocking.conf:'
> 'ModSecurity: No action id present within the rule'
>
> I'm pretty sure I read that all rules now require an 'id' (?)
> Incrementing by 1 from rules above it to give id:981177 doesnt work:
> 'ModSecurity: Found another rule with the same id'
>
> So what is method to get an id for this rule? any other rule?
>
> thanks
>
> Gene
> _______________________________________________
> Owasp-modsecurity-core-rule-set mailing list
> Owasp-modsecurity-core-rule-set at lists.owasp.org
> https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121122/e36b69ce/attachment.html>

From avi at greensmoke.net  Thu Nov 22 12:31:29 2012
From: avi at greensmoke.net (Avi Rosenblatt)
Date: Thu, 22 Nov 2012 14:31:29 +0200
Subject: [Owasp-modsecurity-core-rule-set] PCRE limits error
Message-ID: <67B3B17C-946A-4728-9CAC-D90AC52624BF@greensmoke.net>

Thanx for all the responses.

From jwilliams20122 at gmail.com  Wed Nov 28 22:43:29 2012
From: jwilliams20122 at gmail.com (John Williams)
Date: Wed, 28 Nov 2012 16:43:29 -0600
Subject: [Owasp-modsecurity-core-rule-set] ModSecurity 2.7.1 Build on Centos
	5
Message-ID: <CAOS2KANRMG3PNd64L4=LC6=6S1NnDwB1HSmu-FsNoqc4gP_sRA@mail.gmail.com>

Hello,

I have an issue with building the modsecurity binary (v2.7.1) on Centos
5.8, I receive the following error: checking if libxm2 is at least v2.6.29,
no 2.6.26.

The latest version from Centos is 2.6.26-2.1.15, does any know if they have
applied the necessary backports, or is it missing functionality added in
2.6.29?

Thank you,
J
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121128/1d7cdc87/attachment.html>

From benwilliams+owasp at joobworld.com  Fri Nov 30 22:31:19 2012
From: benwilliams+owasp at joobworld.com (Ben WIlliams)
Date: Sat, 1 Dec 2012 11:31:19 +1300
Subject: [Owasp-modsecurity-core-rule-set] json
Message-ID: <CANfYGQmDuNwaXKsbR=cDydhh2XneibnZDXvCzhNdt2egOKAmWw@mail.gmail.com>

Hi,
I am interested to know how other modsecurity CRS users handle json
requests? Since there is no processor for JSON to break it down into ARGS,
the JSON is compared as one long string which causes a lot of false
positives for SQLi, etc.
My approach so far has been to disable the CRS rules that cause false
positives on JSON.
Has anyone tried luajson or a json schema library to do validation?

thanks
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20121201/714d3956/attachment.html>

