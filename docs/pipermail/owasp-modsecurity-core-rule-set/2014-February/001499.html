<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Rule without an ID
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20without%20an%20ID&In-Reply-To=%3CCAPF6YCmFTymmJOf_rk9A3refuLcy24r%2BcWRwLwt9a4T-bpXvyA%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="001500.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Rule without an ID</H1>
    <B>Paolo Luise</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-modsecurity-core-rule-set%5D%20Rule%20without%20an%20ID&In-Reply-To=%3CCAPF6YCmFTymmJOf_rk9A3refuLcy24r%2BcWRwLwt9a4T-bpXvyA%40mail.gmail.com%3E"
       TITLE="[Owasp-modsecurity-core-rule-set] Rule without an ID">paolo.luiseit at gmail.com
       </A><BR>
    <I>Sun Feb  9 10:34:40 UTC 2014</I>
    <P><UL>
        
        <LI>Next message: <A HREF="001500.html">[Owasp-modsecurity-core-rule-set] Disabling SQL injection rules for	content editing URLs?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1499">[ date ]</a>
              <a href="thread.html#1499">[ thread ]</a>
              <a href="subject.html#1499">[ subject ]</a>
              <a href="author.html#1499">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi Phil,
you can enable the &quot;K&quot; section in the auditlog parts which are logged,
using the SecAuditLogParts directive (please refer to documentation for
more details:
<A HREF="https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecAuditLogParts">https://github.com/SpiderLabs/ModSecurity/wiki/Reference-Manual#wiki-SecAuditLogParts</A>
)

If this still doesn't help you, try to enable the debug with the 4 level,
using the directives SecDebugLog and SecDebugLevel.
Since the debug task generates a lot of rows in the log file, I usually
selectively enable it in a rule with the ctl action. In your case it may be
something like this:

SecRule REQUEST_URI &quot;/transmission/rpc&quot;
&quot;phase:1,id:999999,ctl:debugLogLevel=+4,nolog,noauditlog&quot;

When you enable debug and send a request, you will find in the debug log
lines like this one:

[09/Feb/2014:10:10:03 +0000] [hostname/sid#15cfa68][rid#21ff7e0][*][4]
Recipe: Invoking rule 1b8be28; [file
&quot;/usr/local/modsecurity/rules/current/activated_rules/modsecurity_crs_60_correlation.conf&quot;]
[line &quot;40&quot;] [id &quot;981205&quot;].

Analyzing this file you can find which rule matches and in what file they
are.

Anyway, you can also find useful this old Ryan Barnett's post
<A HREF="http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html">http://blog.spiderlabs.com/2011/08/modsecurity-advanced-topic-of-the-week-exception-handling.html</A>

Have a nice day
Paolo



&gt;<i> Message: 1
</I>&gt;<i> Date: Wed, 29 Jan 2014 11:48:34 +0000
</I>&gt;<i> From: Phill Watkins &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">phill.watkins at gmail.com</A>&gt;
</I>&gt;<i> To: OWASP CRS Mailing List
</I>&gt;<i>         &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> Subject: [Owasp-modsecurity-core-rule-set] Rule without an ID
</I>&gt;<i> Message-ID:
</I>&gt;<i>         &lt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">CAONsccVCsKLpO-GbU5DFYNUbuh9fEMs-WRXHhXtD7DqbA4NhyQ at mail.gmail.com</A>&gt;
</I>&gt;<i> Content-Type: text/plain; charset=&quot;iso-8859-1&quot;
</I>&gt;<i>
</I>&gt;<i> Hi,
</I>&gt;<i>
</I>&gt;<i> I'm having difficulty discovering which rule is causing a false positive
</I>&gt;<i> because it doesn't display an ID in the message.
</I>&gt;<i>
</I>&gt;<i> To give a bit of background, I'm accessing the Transmission BitTorrent web
</I>&gt;<i> client via a reverse proxy.
</I>&gt;<i>
</I>&gt;<i> Yesterday I decided to replace the aging interface with a better one
</I>&gt;<i> (Shift). In doing so I've had to disable a number of rules related to SQL
</I>&gt;<i> injection which is being caused by the web interface requesting/sending
</I>&gt;<i> information to the RPC interface (also behind the proxy).
</I>&gt;<i>
</I>&gt;<i> Here is a message from the apache error log:
</I>&gt;<i>
</I>&gt;<i> [Tue Jan 28 12:37:43 2014] [error] [client hidden] ModSecurity: Access
</I>&gt;<i> denied with code 403 (phase 2). Pattern match
</I>&gt;<i>
</I>&gt;<i> &quot;\\\\b(?i:having)\\\\b\\\\s+(\\\\d{1,10}|'[^=]{1,10}')\\\\s*?[=&lt;&gt;]|(?i:\\\\bexecute(\\\\s{1,5}[\\\\w\\\\.$]{1,5}\\\\s{0,3})?\\\\()|\\\\bhaving\\\\b
</I>&gt;<i> ?(?:\\\\d{1,10}|[\\\\'\\&quot;][^=]{1,10}[\\\\'\\&quot;])
</I>&gt;<i>
</I>&gt;<i> ?[=&lt;&gt;]+|(?i:\\\\bcreate\\\\s+?table.{0,20}?\\\\()|(?i:\\\\blike\\\\W*?char\\\\W*?\\\\()|(?i:(?:(select(.*
</I>&gt;<i> ...&quot; at
</I>&gt;<i>
</I>&gt;<i> ARGS_NAMES:{&quot;method&quot;:&quot;torrent-get&quot;,&quot;arguments&quot;:{&quot;ids&quot;:[1],&quot;fields&quot;:[&quot;activityDate&quot;,&quot;addedDate&quot;,&quot;bandwidthPriority&quot;,&quot;comment&quot;,&quot;corruptEver&quot;,&quot;creator&quot;,&quot;display&quot;,&quot;dateCreated&quot;,&quot;desiredAvailable&quot;,&quot;doneDate&quot;,&quot;downloadDir&quot;,&quot;downloadedEver&quot;,&quot;downloadLimit&quot;,&quot;downloadLimited&quot;,&quot;error&quot;,&quot;errorString&quot;,&quot;eta&quot;,&quot;files&quot;,&quot;fileStats&quot;,&quot;hashString&quot;,&quot;haveUnchecked&quot;,&quot;haveValid&quot;,&quot;honorsSessionLimits&quot;,&quot;id&quot;,&quot;index&quot;,&quot;isFinished&quot;,&quot;isPrivate&quot;,&quot;isStalled&quot;,&quot;leftUntilDone&quot;,&quot;location&quot;,&quot;magnetLink&quot;,&quot;manualAnnounceTime&quot;,&quot;maxConnectedPeers&quot;,&quot;metadataPercentComplete&quot;,&quot;name&quot;,&quot;peer-limit&quot;,&quot;peers&quot;,&quot;peersConnected&quot;,&quot;peersFrom&quot;,&quot;peersGettingFromUs&quot;,&quot;peersSendingToUs&quot;,&quot;percentDone&quot;,&quot;pieces&quot;,&quot;pieceCount&quot;,&quot;pieceSize&quot;,&quot;priorities&quot;,&quot;queuePosition
</I>&gt;<i> [hostname &quot;hidden&quot;] [uri &quot;/transmission/rpc&quot;] [unique_id
</I>&gt;<i> &quot;Uuekl38AAQEAAGl0A0wAAAAF&quot;]
</I>&gt;<i>
</I>&gt;<i> Here is the related audit log:
</I>&gt;<i>
</I>&gt;<i> --c0e6d529-A--
</I>&gt;<i> [28/Jan/2014:12:37:43 +0000] Uuekl38AAQEAAGl0A0wAAAAF hidden 59127 hidden
</I>&gt;<i> 443
</I>&gt;<i> --c0e6d529-B--
</I>&gt;<i> POST /transmission/rpc HTTP/1.1
</I>&gt;<i> Host: hidden
</I>&gt;<i> Connection: keep-alive
</I>&gt;<i> Content-Length: 1095
</I>&gt;<i> Authorization: Basic hidden
</I>&gt;<i> Origin: <A HREF="https://hidden">https://hidden</A>
</I>&gt;<i> User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like
</I>&gt;<i> Gecko) Chrome/32.0.1700.77 Safari/537.36
</I>&gt;<i> Content-type: application/x-www-form-urlencoded; charset=UTF-8
</I>&gt;<i> Accept: text/javascript, text/html, application/xml, text/xml, */*
</I>&gt;<i> X-Prototype-Version: 1.7.1
</I>&gt;<i> X-Requested-With: XMLHttpRequest
</I>&gt;<i> X-Transmission-Session-Id: KoILIz4o114SctLDgPVavN2EghQIxpbbXp49cBsSjVw8JVny
</I>&gt;<i> Referer: <A HREF="https://hidden/transmission/web/">https://hidden/transmission/web/</A>
</I>&gt;<i> Accept-Encoding: gzip,deflate,sdch
</I>&gt;<i> Accept-Language: en-GB,en-US;q=0.8,en;q=0.6
</I>&gt;<i> Cookie: compact_display_state=false
</I>&gt;<i>
</I>&gt;<i> --c0e6d529-C--
</I>&gt;<i>
</I>&gt;<i> {&quot;method&quot;:&quot;torrent-get&quot;,&quot;arguments&quot;:{&quot;ids&quot;:[1],&quot;fields&quot;:[&quot;activityDate&quot;,&quot;addedDate&quot;,&quot;bandwidthPriority&quot;,&quot;comment&quot;,&quot;corruptEver&quot;,&quot;creator&quot;,&quot;display&quot;,&quot;dateCreated&quot;,&quot;desiredAvailable&quot;,&quot;doneDate&quot;,&quot;downloadDir&quot;,&quot;downloadedEver&quot;,&quot;downloadLimit&quot;,&quot;downloadLimited&quot;,&quot;error&quot;,&quot;errorString&quot;,&quot;eta&quot;,&quot;files&quot;,&quot;fileStats&quot;,&quot;hashString&quot;,&quot;haveUnchecked&quot;,&quot;haveValid&quot;,&quot;honorsSessionLimits&quot;,&quot;id&quot;,&quot;index&quot;,&quot;isFinished&quot;,&quot;isPrivate&quot;,&quot;isStalled&quot;,&quot;leftUntilDone&quot;,&quot;location&quot;,&quot;magnetLink&quot;,&quot;manualAnnounceTime&quot;,&quot;maxConnectedPeers&quot;,&quot;metadataPercentComplete&quot;,&quot;name&quot;,&quot;peer-limit&quot;,&quot;peers&quot;,&quot;peersConnected&quot;,&quot;peersFrom&quot;,&quot;peersGettingFromUs&quot;,&quot;peersSendingToUs&quot;,&quot;percentDone&quot;,&quot;pieces&quot;,&quot;pieceCount&quot;,&quot;pieceSize&quot;,&quot;priorities&quot;,&quot;queuePosition&quot;,&quot;rateDownload&quot;,&quot;rateUpload&quot;,&quot;recheckProgress&quot;,&quot;secondsDownloading&quot;,&quot;secondsSeeding&quot;,&quot;seedIdleLimit&quot;,&quot;seedIdleMode&quot;,&quot;seedRatioLimit&quot;,&quot;seedRatioMode&quot;,&quot;selected&quot;,&quot;sizeWhenDone&quot;,&quot;startDate&quot;,&quot;status&quot;,&quot;trackers&quot;,&quot;trackerAdd&quot;,&quot;trackerRemove&quot;,&quot;trackerReplace&quot;,&quot;trackerStats&quot;,&quot;totalSize&quot;,&quot;torrentFil!
</I>&gt;<i>
</I>&gt;<i>  e&quot;,&quot;uploadedEver&quot;,&quot;uploadLimit&quot;,&quot;uploadLimited&quot;,&quot;uploadRatio&quot;,&quot;wanted&quot;,&quot;webseeds&quot;,&quot;webseedsSendingToUs&quot;]}}
</I>&gt;<i> --c0e6d529-F--
</I>&gt;<i> HTTP/1.1 403 Forbidden
</I>&gt;<i> Vary: Accept-Encoding
</I>&gt;<i> Content-Encoding: gzip
</I>&gt;<i> Content-Length: 183
</I>&gt;<i> Keep-Alive: timeout=5, max=33
</I>&gt;<i> Connection: Keep-Alive
</I>&gt;<i> Content-Type: text/html; charset=iso-8859-1
</I>&gt;<i>
</I>&gt;<i> --c0e6d529-E--
</I>&gt;<i> &lt;!DOCTYPE HTML PUBLIC &quot;-//IETF//DTD HTML 2.0//EN&quot;&gt;
</I>&gt;<i> &lt;html&gt;&lt;head&gt;
</I>&gt;<i> &lt;title&gt;403 Forbidden&lt;/title&gt;
</I>&gt;<i> &lt;/head&gt;&lt;body&gt;
</I>&gt;<i> &lt;h1&gt;Forbidden&lt;/h1&gt;
</I>&gt;<i> &lt;p&gt;You don't have permission to access /transmission/rpc
</I>&gt;<i> on this server.&lt;/p&gt;
</I>&gt;<i> &lt;/body&gt;&lt;/html&gt;
</I>&gt;<i>
</I>&gt;<i> --c0e6d529-H--
</I>&gt;<i> Message: Access denied with code 403 (phase 2). Pattern match
</I>&gt;<i>
</I>&gt;<i> &quot;\\b(?i:having)\\b\\s+(\\d{1,10}|'[^=]{1,10}')\\s*?[=&lt;&gt;]|(?i:\\bexecute(\\s{1,5}[\\w\\.$]{1,5}\\s{0,3})?\\()|\\bhaving\\b
</I>&gt;<i> ?(?:\\d{1,10}|[\\'\&quot;][^=]{1,10}[\\'\&quot;])
</I>&gt;<i>
</I>&gt;<i> ?[=&lt;&gt;]+|(?i:\\bcreate\\s+?table.{0,20}?\\()|(?i:\\blike\\W*?char\\W*?\\()|(?i:(?:(select(.*
</I>&gt;<i> ...&quot; at
</I>&gt;<i>
</I>&gt;<i> ARGS_NAMES:{&quot;method&quot;:&quot;torrent-get&quot;,&quot;arguments&quot;:{&quot;ids&quot;:[1],&quot;fields&quot;:[&quot;activityDate&quot;,&quot;addedDate&quot;,&quot;bandwidthPriority&quot;,&quot;comment&quot;,&quot;corruptEver&quot;,&quot;creator&quot;,&quot;display&quot;,&quot;dateCreated&quot;,&quot;desiredAvailable&quot;,&quot;doneDate&quot;,&quot;downloadDir&quot;,&quot;downloadedEver&quot;,&quot;downloadLimit&quot;,&quot;downloadLimited&quot;,&quot;error&quot;,&quot;errorString&quot;,&quot;eta&quot;,&quot;files&quot;,&quot;fileStats&quot;,&quot;hashString&quot;,&quot;haveUnchecked&quot;,&quot;haveValid&quot;,&quot;honorsSessionLimits&quot;,&quot;id&quot;,&quot;index&quot;,&quot;isFinished&quot;,&quot;isPrivate&quot;,&quot;isStalled&quot;,&quot;leftUntilDone&quot;,&quot;location&quot;,&quot;magnetLink&quot;,&quot;manualAnnounceTime&quot;,&quot;maxConnectedPeers&quot;,&quot;metadataPercentComplete&quot;,&quot;name&quot;,&quot;peer-limit&quot;,&quot;peers&quot;,&quot;peersConnected&quot;,&quot;peersFrom&quot;,&quot;peersGettingFromUs&quot;,&quot;peersSendingToUs&quot;,&quot;percentDone&quot;,&quot;pieces&quot;,&quot;pieceCount&quot;,&quot;pieceSize&quot;,&quot;priorities&quot;,&quot;queuePosition
</I>&gt;<i> Action: Intercepted (phase 2)
</I>&gt;<i> Apache-Handler: proxy-server
</I>&gt;<i> Stopwatch: 1390912663932099 11850 (- - -)
</I>&gt;<i> Stopwatch2: 1390912663932099 11850; combined=8383, p1=338, p2=7959, p3=0,
</I>&gt;<i> p4=0, p5=86, sr=68, sw=0, l=0, gc=0
</I>&gt;<i> Response-Body-Transformed: Dechunked
</I>&gt;<i> Producer: ModSecurity for Apache/2.7.5 (<A HREF="http://www.modsecurity.org/">http://www.modsecurity.org/</A>);
</I>&gt;<i> OWASP_CRS/2.2.8.
</I>&gt;<i> Server: Apache
</I>&gt;<i>
</I>&gt;<i> Any help would be greatly appreciated.
</I>&gt;<i>
</I>&gt;<i> Thanks.
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-modsecurity-core-rule-set mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Owasp-modsecurity-core-rule-set at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> End of Owasp-modsecurity-core-rule-set Digest, Vol 58, Issue 1
</I>&gt;<i> **************************************************************
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140209/910fd67d/attachment.html">http://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20140209/910fd67d/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="001500.html">[Owasp-modsecurity-core-rule-set] Disabling SQL injection rules for	content editing URLs?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1499">[ date ]</a>
              <a href="thread.html#1499">[ thread ]</a>
              <a href="subject.html#1499">[ subject ]</a>
              <a href="author.html#1499">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
