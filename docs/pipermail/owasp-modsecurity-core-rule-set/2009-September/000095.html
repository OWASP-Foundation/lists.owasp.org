<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] Question About Rule	Configuration!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Question%20About%20Rule%0A%09Configuration%21&In-Reply-To=cba0286a0909111426q67461045waccf520beae9596d%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000094.html">
   <LINK REL="Next"  HREF="000096.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] Question About Rule	Configuration!</H1>
    <B>OSSEC junkie</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20Question%20About%20Rule%0A%09Configuration%21&In-Reply-To=cba0286a0909111426q67461045waccf520beae9596d%40mail.gmail.com"
       TITLE="[Owasp-modsecurity-core-rule-set] Question About Rule	Configuration!">ossec.junkie at gmail.com
       </A><BR>
    <I>Sun Sep 13 02:38:39 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000094.html">[Owasp-modsecurity-core-rule-set] CRS version 2.0.2 Released
</A></li>
        <LI>Next message: <A HREF="000096.html">[Owasp-modsecurity-core-rule-set] Question About Rule	Configuration!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95">[ date ]</a>
              <a href="thread.html#95">[ thread ]</a>
              <a href="subject.html#95">[ subject ]</a>
              <a href="author.html#95">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm testing this with Firefox and Chrome using this payload,
1%22;}eval%28%27al%27%2b%27ert%28docu%27%2b%27ment.c%27%2b%27ookie%29%27%29;function%20a%28%29{var%20a=%22

But it never gets caught, even with the phpids filters applied, did
not modify them, left as is.

The only time it gets caught is when my browser changes the payload
to: 1&quot;;}eval('al'%2b'ert(docu'%2b'ment.c'%2b'ookie)');function%20a(){var%20a=&quot;

Then ModSecurity picks it up, but every other time I try with the 1%22
... payload...it just gets right past ModSecurity..any ideas?


On Fri, Sep 11, 2009 at 2:26 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">rcbarnett at gmail.com</A>&gt; wrote:
&gt;<i> On Fri, Sep 11, 2009 at 12:26 PM, OSSEC junkie &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">ossec.junkie at gmail.com</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Thanks for that, I'll be looking for the updated core rule set today.
</I>&gt;&gt;<i> I appreciate it!
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i> I haven't packaged the whole new 2.0.2 CRS archive up yet - but you can
</I>&gt;<i> download the new phpids rules file here -
</I>&gt;<i> <A HREF="https://mod-security.svn.sourceforge.net/svnroot/mod-security/crs/trunk/base_rules/modsecurity_crs_41_phpids_filters.conf">https://mod-security.svn.sourceforge.net/svnroot/mod-security/crs/trunk/base_rules/modsecurity_crs_41_phpids_filters.conf</A>
</I>&gt;<i>
</I>&gt;<i> Test this one out against your example payloads and verify that they are
</I>&gt;<i> caught.
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Ryan C. Barnett
</I>&gt;<i> WASC Distributed Open Proxy Honeypot Project Leader
</I>&gt;<i> OWASP ModSecurity Core Rule Set Project Leader
</I>&gt;<i> Tactical Web Application Security
</I>&gt;<i> <A HREF="http://tacticalwebappsec.blogspot.com/">http://tacticalwebappsec.blogspot.com/</A>
</I>&gt;<i>
</I>&gt;<i>
</I></PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000094.html">[Owasp-modsecurity-core-rule-set] CRS version 2.0.2 Released
</A></li>
	<LI>Next message: <A HREF="000096.html">[Owasp-modsecurity-core-rule-set] Question About Rule	Configuration!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95">[ date ]</a>
              <a href="thread.html#95">[ thread ]</a>
              <a href="subject.html#95">[ subject ]</a>
              <a href="author.html#95">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
