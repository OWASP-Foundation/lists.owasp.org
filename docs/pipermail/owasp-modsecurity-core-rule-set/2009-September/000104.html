<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] about one rule of SQL	injection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20about%20one%20rule%20of%20SQL%0A%09injection&In-Reply-To=8A1B4B015C52A54886DF15E9A97C7FB9F7298E4E%40MONET.utopiasystems.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000103.html">
   <LINK REL="Next"  HREF="000105.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] about one rule of SQL	injection</H1>
    <B>Junyong Jiang</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20about%20one%20rule%20of%20SQL%0A%09injection&In-Reply-To=8A1B4B015C52A54886DF15E9A97C7FB9F7298E4E%40MONET.utopiasystems.net"
       TITLE="[Owasp-modsecurity-core-rule-set] about one rule of SQL	injection">dreamice.jiang at gmail.com
       </A><BR>
    <I>Tue Sep 22 10:57:24 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000103.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL injection
</A></li>
        <LI>Next message: <A HREF="000105.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104">[ date ]</a>
              <a href="thread.html#104">[ thread ]</a>
              <a href="subject.html#104">[ subject ]</a>
              <a href="author.html#104">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Thanks Ryan!
My request is:<A HREF="http://192.168.3.144/show.asp?id=0+0+0+1299">http://192.168.3.144/show.asp?id=0+0+0+1299</A>
My debug log has been modified of the coding, so I past the audit log here.
I think this is more detaild.
--9cddd82d-A--
[&quot;2009-09-22 22:54:04&quot;] SrjlDH8AAAEAAEzOOaEAAAAA 192.168.3.12 63822
192.168.3.144 80
--9cddd82d-B--
GET /show.asp?id=0+0+0+1299 HTTP/1.1
Accept: */*
Accept-Language: zh-cn
UA-CPU: x86
Accept-Encoding: gzip, deflate
User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR
1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)
Host: 192.168.3.144
Connection: Keep-Alive
Cookie: ASPSESSIONIDQATCQSCQ=MLHDBIGANDOGNEILOKBJEMCD
--9cddd82d-F--
HTTP/1.1 403 Forbidden
Keep-Alive: timeout=5
Connection: Keep-Alive
Transfer-Encoding: chunked
Content-Type: text/html; charset=iso-8859-1
--9cddd82d-E--
 &lt;font face=&quot;&#9618;&#9618;&#9618;&#9618;&quot; size=2&gt;
&lt;p&gt;Microsoft OLE DB Provider for SQL Server&lt;/font&gt; &lt;font face=&quot;&#9618;&#9618;&#9618;&#9618;&quot;
size=2&gt;&#9618;&#9618;&#9618;&#9618; '80040e14'&lt;/font&gt;
&lt;p&gt;
??????2009/9/22 Ryan Barnett ?&lt;Ryan.Ba&lt;font face=&quot;&#9618;&#9618;&#9618;&#9618;&quot; size=2&gt;&#9618;&#9618; 1 &#9618;&#9618;: '0'
&#9618;&#9618;&#9618;&#9618;&#9618;&#9618;&#9618;?&#9618;&#9618;&#9618;&#9618;&lt;/font&gt;
&lt;p&gt;
&lt;font face=&quot;&#9618;&#9618;&#9618;&#9618;&quot; size=2&gt;/show.asp&lt;/font&gt;&lt;font face=&quot;&#9618;&#9618;&#9618;&#9618;&quot; size=2&gt;&#9618;&#9618;&#9618;&#9618;
6&lt;/font&gt;
--9cddd82d-H--
Message: Access denied&quot;,500009,&quot;61&quot;,NULL,&quot;ERROR&quot;,3,&quot;31&quot;,NULL,NULL,403
Action: Intercepted (phase 4)
Apache-Handler: proxy-server
Stopwatch: 1253631244583806 129146 (1662 117667 -)
Response-Body-Transformed: Dechunked
Producer: Security for Apache/2.5.7 (<A HREF="http://www.dbappsecurity.com.cn/">http://www.dbappsecurity.com.cn/</A>); core
ruleset/2.0.1.
Server: Apache/2.2.10 (Unix) mod_ssl/2.2.10 OpenSSL/0.9.8b
--9cddd82d-K--
SecAction
&quot;phase:1,auditlog,t:none,pass,nolog,initcol:global=global,initcol:ip=%{remote_addr}&quot;
SecRule &quot;REQUEST_METHOD&quot; &quot;@rx ^(?:GET|HEAD)$&quot;
&quot;phase:2,chain,t:none,deny,log,auditlog,status:400,msg:3,severity:2,id:200004,tag:2&quot;
SecRule &quot;&amp;REQUEST_HEADERS:Content-Type&quot; &quot;@eq 0&quot;
&quot;phase:2,chain,t:none,log,deny,auditlog,msg:19,id:210008,tag:4,severity:4&quot;
SecRule &quot;ARGS_NAMES&quot; &quot;@rx .*&quot;
&quot;phase:2,auditlog,chain,t:none,nolog,pass,capture,setvar:tx.%{matched_var_name}=+1&quot;
SecRule &quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;
&quot;@pmFromFile dbapp_40_generic_attacks.data&quot;
&quot;phase:2,auditlog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;
SecRule &quot;REQUEST_URI|REQUEST_BODY|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;
&quot;@pmFromFile dbapp_40_generic_attacks.data&quot;
&quot;phase:2,auditlog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:compressWhiteSpace,t:lowercase,nolog,pass,setvar:tx.pm_score=+1,setvar:tx.pm_data_%{matched_var_name}=%{matched_var}&quot;
SecRule &quot;&amp;TX:/SQL_INJECTION/&quot; &quot;@eq 0&quot;
&quot;phase:2,auditlog,t:none,nolog,skipAfter:END_SQL_INJECTION_WEAK&quot;
SecRule &quot;REQUEST_FILENAME|ARGS|ARGS_NAMES|REQUEST_HEADERS|XML:/*|!REQUEST_HEADERS:Referer&quot;
&quot;@pm insert xp_enumdsn infile openrowset nvarchar autonomous_transaction
print data_type or outfile inner shutdown tbcreator @@version xp_filelist
sp_prepare sql_longvarchar xp_regenumkeys xp_loginconfig xp_dirtree ifnull
sp_addextendedproc xp_regaddmultistring delete sp_sqlexec and sp_oacreate
sp_execute cast xp_ntsec xp_regdeletekey drop varchar xp_execresultset
having utl_file xp_regenumvalues xp_terminate xp_availablemedia
xp_regdeletevalue dumpfile isnull sql_variant select 'sa'
xp_regremovemultistring xp_makecab 'msdasql' xp_cmdshell openquery
sp_executesql 'sqloledb' dbms_java 'dbo' utl_http sp_makewebtask benchmark
xp_regread xp_regwrite&quot;
&quot;phase:2,auditlog,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:replaceComments,t:compressWhiteSpace,t:lowercase,nolog,skip:1&quot;
SecAction &quot;phase:2,auditlog,nolog,skipAfter:END_XSS_REGEX&quot;
SecRule &quot;RESPONSE_STATUS&quot; &quot;@rx ^5\\d{2}$&quot;
&quot;phase:4,t:none,ctl:auditLogParts=+E,deny,log,auditlog,msg:61,id:500009,tag:31,severity:3,setvar:tx.msg=%{rule.msg},setvar:tx.anomaly_score=+15,setvar:tx.%{
rule.id}-AVAILABILITY/APP_NOT_AVAIL-%{matched_var_name}=%{matched_var}&quot;
--9cddd82d-Z--


breach.com&gt;????You needto look at the modsecurit

&gt;<i> bug log (modsec_debug.log).?????Ryan C. Barnett??Director of Appl
</I>&gt;<i>
</I>&gt;<i> on Security Res
</I>&gt;<i> rch??Breach Security, Inc.??Ryan.Barnett@
</I>&gt;<i> each.com???www.Breach
</I>&gt;<i> om?????________________
</I>&gt;<i> ___________??_ &lt;<A HREF="http://www.breach.com/">http://www.breach.com/</A>&gt;
</I>&gt;<i>
</I>&gt;<i> rom: Junyong Jiang??To: Ryan Bne
</I>&gt;<i> ?Cc: ?owasp-modsecu
</I>&gt;<i> ty-core-rule-??s
</I>&gt;<i> @liss.owasp.org???Sent: Tue Sep 10:49:50 2009??Sub&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> t: Re: [Owasp-modsecurity-core
</I>&gt;<i> ule-??set] about one rule of SQL injection???This is my accesss
</I>&gt;<i> log:??192.168.
</I>&gt;<i>
</I>&gt;<i> - - [22/Sep/2009:22:47:
</I>&gt;<i> +0800] &quot;GET product.asp?tp=0+0+0+1234 HTTP/1.1&quot; .....??192.168.3.12 - -
</I>&gt;<i> [22/Sep/2009:22:47:
</I>&gt;<i> +0800] &quot;GET product.asp?tp=0+0+0+1234 HTTP/1.1&quot; .....&quot;-&quot; &quot;Mozilla/4.0
</I>&gt;<i> (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322; .NET CLR
</I>&gt;<i> 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)&quot;?????
</I>&gt;<i> <A HREF="http://www.example.com/??product.">http://www.example.com/??product.</A>
</I>&gt;<i>
</I>&gt;<i> p=0+0+0+1234????2009/9/ Ryan Barnett &lt;?Ryan.Barn&lt;<A HREF="http://www.example.com/product.asp?tp=0+0+0+1234">http://www.example.com/product.asp?tp=0+0+0+1234</A>&gt;
</I>&gt;<i> breach.com?&lt;??mailto:?<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryn.Barnett at breach.com</A>??? &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at breach.com</A>&gt;&gt;?Did
</I>&gt;<i> yo look at the debug log &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at breach.com</A>&gt;ve
</I>&gt;<i> )? It will show you how the data looks after the transformation functions
</I>&gt;<i> when the operator is applied.??????Ryan C. Barnett??Director of App
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> on Security Res
</I>&gt;<i> rch??Breach Security, Inc.??Ryan.Barnett@
</I>&gt;<i> each.com????www.Breac
</I>&gt;<i> com?&lt;?<A HREF="http://www.??brea">http://www.??brea</A>
</I>&gt;<i> om/?&gt;????_____ &lt;<A HREF="http://www.breach.com/">http://www.breach.com/</A>&gt;_____________________??&lt;<A HREF="http://www.breach.com/">http://www.breach.com/</A>&gt;
</I>&gt;<i> _
</I>&gt;<i>
</I>&gt;<i> om: ?owasp-modsecurity-core-ru-?
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">et-bouces at lists.owasp.org</A>?&lt;??mailt?owasp-modsecurity-core-??r&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">lset-bouces at lists.owasp.</A>??org?&gt;To: ?owasp-modsecurity-core-re-?&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt;
</I>&gt;<i> s
</I>&gt;<i> @liss.owasp.org?&lt;mailto:?owa??spodsecurity-core-rul&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> -set@??lstswasp.org?&gt;??????Sent: Tue Sep2 10:34:32 2009&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
</I>&gt;<i> ?
</I>&gt;<i>  t: [Owasp-modsecurity-core-rul
</I>&gt;<i> ??set] about one rule of SQL injection??Dear all,????I want write a modsec
</I>&gt;<i>
</I>&gt;<i> y rule to
</I>&gt;<i>
</I>&gt;<i> ect such SQL injection like:???<A HREF="http://www.example.com/??product.as">http://www.example.com/??product.as</A>
</I>&gt;<i> p=0+0+0+1234???the corrt request is: ?<A HREF="http://www&lt;http://www.example.com/product.asp?tp=0+0+0+1234">http://www&lt;http://www.example.com/product.asp?tp=0+0+0+1234</A>&gt;
</I>&gt;<i> ample.com/??product.asp?p=1234???I write the ru as:??SecRule QUERY&lt;<A HREF="http://www.example.com/product.asp?tp=1234">http://www.example.com/product.asp?tp=1234</A>&gt;
</I>&gt;<i> RING|ARGS|ARGS_NAMES
</I>&gt;<i> ?REQUEST_FILENAME &quot;0\+0&quot; \??      &quot;phe:2,capture,t:none,t:??ur
</I>&gt;<i> ecodeUni,t:??htmlEntityDecode,t:replaceComments:??compressWhiteSpa,t:??lowercase,ctluditLogParts=+??E,denlog,auditlog,msg:'sql
</I>&gt;<i> injecti',id:'410135',tag:'??SQL_INJECTION',logdata:'%{TX.??0}',serity:'2'&quot;????But
</I>&gt;<i> it does notork. Could you ex
</I>&gt;<i>
</I>&gt;<i> n that what is wrong with my rule?????Thanks in advance.?????????????
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090922/e1f6d28d/attachment.html">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090922/e1f6d28d/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000103.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL injection
</A></li>
	<LI>Next message: <A HREF="000105.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104">[ date ]</a>
              <a href="thread.html#104">[ thread ]</a>
              <a href="subject.html#104">[ subject ]</a>
              <a href="author.html#104">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
