<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-modsecurity-core-rule-set] about one rule of SQL injection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20about%20one%20rule%20of%20SQL%0A%20injection&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000102.html">
   <LINK REL="Next"  HREF="000104.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-modsecurity-core-rule-set] about one rule of SQL injection</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-modsecurity-core-rule-set%40lists.owasp.org?Subject=%5BOwasp-modsecurity-core-rule-set%5D%20about%20one%20rule%20of%20SQL%0A%20injection&In-Reply-To="
       TITLE="[Owasp-modsecurity-core-rule-set] about one rule of SQL injection">Ryan.Barnett at breach.com
       </A><BR>
    <I>Tue Sep 22 10:51:32 EDT 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="000102.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL	injection
</A></li>
        <LI>Next message: <A HREF="000104.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL	injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103">[ date ]</a>
              <a href="thread.html#103">[ thread ]</a>
              <a href="subject.html#103">[ subject ]</a>
              <a href="author.html#103">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>You need to look at the modsecurity debug log (modsec_debug.log).

Ryan C. Barnett
Director of Application Security Research
Breach Security, Inc.
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at Breach.com</A>
www.Breach.com

________________________________
From: Junyong Jiang
To: Ryan Barnett
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>
Sent: Tue Sep 22 10:49:50 2009
Subject: Re: [Owasp-modsecurity-core-rule-set] about one rule of SQL injection

This is my accesss log:
192.168.3.12 - - [22/Sep/2009:22:47:58 +0800] &quot;GET product.asp?tp=0+0+0+1234 HTTP/1.1&quot; .....
192.168.3.12 - - [22/Sep/2009:22:47:58 +0800] &quot;GET product.asp?tp=0+0+0+1234 HTTP/1.1&quot; .....&quot;-&quot; &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022)&quot;

<A HREF="http://www.example.com/product.asp?tp=0+0+0+1234">http://www.example.com/product.asp?tp=0+0+0+1234</A>
2009/9/22 Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at breach.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at breach.com</A>&gt;&gt;
Did you look at the debug log (level 9)? It will show you how the data looks after the transformation functions when the operator is applied.


Ryan C. Barnett
Director of Application Security Research
Breach Security, Inc.
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">Ryan.Barnett at Breach.com</A>
www.Breach.com&lt;<A HREF="http://www.breach.com/">http://www.breach.com/</A>&gt;

________________________________
From: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set-bounces at lists.owasp.org</A>&gt;
To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">owasp-modsecurity-core-rule-set at lists.owasp.org</A>&gt;
Sent: Tue Sep 22 10:34:32 2009
Subject: [Owasp-modsecurity-core-rule-set] about one rule of SQL injection

Dear all,

I want write a modsecurity rule to detect such SQL injection like:
<A HREF="http://www.example.com/product.asp?tp=0+0+0+1234">http://www.example.com/product.asp?tp=0+0+0+1234</A>
the correct request is: <A HREF="http://www.example.com/product.asp?tp=1234">http://www.example.com/product.asp?tp=1234</A>
I write the rule as:
SecRule QUERY_STRING|ARGS|ARGS_NAMES|REQUEST_FILENAME &quot;0\+0&quot; \
       &quot;phase:2,capture,t:none,t:urlDecodeUni,t:htmlEntityDecode,t:replaceComments,t:compressWhiteSpace,t:lowercase,ctl:auditLogParts=+E,deny,log,auditlog,msg:'sql injection',id:'410135',tag:'SQL_INJECTION',logdata:'%{TX.0}',severity:'2'&quot;

But it does not work. Could you explain that what is wrong with my rule?

Thanks in advance.

-------------- next part --------------
A non-text attachment was scrubbed...
Name: winmail.dat
Type: application/ms-tnef
Size: 5910 bytes
Desc: not available
Url : <A HREF="https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090922/3bac45c6/attachment-0001.bin">https://lists.owasp.org/pipermail/owasp-modsecurity-core-rule-set/attachments/20090922/3bac45c6/attachment-0001.bin</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000102.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL	injection
</A></li>
	<LI>Next message: <A HREF="000104.html">[Owasp-modsecurity-core-rule-set] about one rule of SQL	injection
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#103">[ date ]</a>
              <a href="thread.html#103">[ thread ]</a>
              <a href="subject.html#103">[ subject ]</a>
              <a href="author.html#103">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-modsecurity-core-rule-set">More information about the Owasp-modsecurity-core-rule-set
mailing list</a><br>
</body></html>
