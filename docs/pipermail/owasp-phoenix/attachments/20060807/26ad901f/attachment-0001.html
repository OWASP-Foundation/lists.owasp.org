<tt>
<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;font&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;All&nbsp;-&nbsp;&lt;/font&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;font&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;Is&nbsp;it&nbsp;possible&nbsp;to&nbsp;locally&nbsp;install&nbsp;another<br>
domain's&nbsp;SSL&nbsp;certificate&nbsp;and&nbsp;effectively&nbsp;impersonate&nbsp;the&nbsp;domain&nbsp;without<br>
receiving&nbsp;certificate&nbsp;errors?&lt;/font&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;font&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;Mike,&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;<br>
Storing&nbsp;an&nbsp;encryption&nbsp;key&nbsp;on&nbsp;the&nbsp;server&nbsp;in&nbsp;a&nbsp;hosted&nbsp;environment&nbsp;usually<br>
means&nbsp;that&nbsp;it&nbsp;is&nbsp;written&nbsp;to&nbsp;a&nbsp;file,&nbsp;which&nbsp;can&nbsp;be&nbsp;located&nbsp;within&nbsp;the<br>
web&nbsp;root&nbsp;itself&nbsp;(for&nbsp;many&nbsp;hosts). &nbsp;Hosts&nbsp;may&nbsp;provide&nbsp;a&nbsp;separate,&nbsp;additional&nbsp;directory<br>
that&nbsp;is&nbsp;not&nbsp;relative&nbsp;to&nbsp;the&nbsp;website's&nbsp;root&nbsp;for&nbsp;storage. &nbsp;However,&nbsp;this&nbsp;situation<br>
still&nbsp;allows&nbsp;your&nbsp;application&nbsp;to&nbsp;be&nbsp;copied&nbsp;with&nbsp;the&nbsp;appropriate&nbsp;key<br>
file&nbsp;and&nbsp;executed&nbsp;elsewhere. &nbsp;For&nbsp;shared&nbsp;Windows-based&nbsp;hosting,&nbsp;access&nbsp;to&nbsp;the&nbsp;server's&nbsp;registry&nbsp;is&nbsp;rarely&nbsp;allowed. &nbsp;The&nbsp;separate,&nbsp;private,&nbsp;and&nbsp;secure&nbsp;local&nbsp;directory&nbsp;is&nbsp;an&nbsp;excellent&nbsp;additional&nbsp;measure&nbsp;of&nbsp;securing&nbsp;keys.&lt;/font&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;font&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;*I&nbsp;am&nbsp;attempting&nbsp;to&nbsp;identify&nbsp;multiple&nbsp;solutions&nbsp;that&nbsp;might&nbsp;allow&nbsp;an&nbsp;application&nbsp;to&nbsp;reliably&nbsp;and&nbsp;securely&nbsp;identify&nbsp;itself&nbsp;and&nbsp;it's&nbsp;execution&nbsp;context. &nbsp;I&nbsp;am&nbsp;attempting&nbsp;to&nbsp;identify&nbsp;as&nbsp;many&nbsp;solutions&nbsp;as&nbsp;possible&nbsp;between&nbsp;&quot;store&nbsp;a&nbsp;key&nbsp;somewhere,&nbsp;somehow&quot;&nbsp;and&nbsp;&quot;read&nbsp;the&nbsp;server's&nbsp;physical&nbsp;serial&nbsp;number&quot;.&lt;br&nbsp;/&gt;&lt;/font&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;font&nbsp;face=&quot;arial&quot;&nbsp;size=&quot;2&quot;&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;Eric&nbsp;Swanson&lt;br&nbsp;/&gt;http://www.ericis.com/&lt;/font&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;font&nbsp;face=&quot;Tahoma,&nbsp;Arial,&nbsp;Sans-Serif&quot;&nbsp;size=&quot;2&quot;&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;hr&nbsp;align=&quot;center&quot;&nbsp;size=&quot;2&quot;&nbsp;width=&quot;100%&quot;&nbsp;/&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;b&gt;From&lt;/b&gt;:&nbsp;mikeiscool&nbsp;&amp;lt;michaelslists@gmail.com&amp;gt;&lt;br&nbsp;/&gt;&lt;b&gt;Sent&lt;/b&gt;:&nbsp;Monday,&nbsp;August&nbsp;07,&nbsp;2006&nbsp;5:01&nbsp;PM&lt;br&nbsp;/&gt;&lt;b&gt;To&lt;/b&gt;:&nbsp;email@iseric.com&lt;br&nbsp;/&gt;&lt;b&gt;Subject&lt;/b&gt;:&nbsp;SPAM-LOW:&nbsp;&nbsp;Re:&nbsp;[Owasp-dotnet]&nbsp;Application&nbsp;and&nbsp;Execution&nbsp;Context&nbsp;Identities&lt;/font&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;<br>
&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&lt;br&nbsp;/&gt;On&nbsp;8/8/06,&nbsp;Eric&nbsp;Swanson&nbsp;&lt;email@iseric.com&gt;&nbsp;wrote:&lt;br&nbsp;/&gt;&amp;gt;&nbsp;&nbsp;I&nbsp;have&nbsp;been&nbsp;researching&nbsp;issues&nbsp;with&nbsp;validating&nbsp;application&nbsp;identity&nbsp;and&lt;br&nbsp;/&gt;&amp;gt;&nbsp;execution&nbsp;context&nbsp;(environment)&nbsp;recently.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;What&nbsp;are&nbsp;your&nbsp;thoughts/comments/suggestions/etc?&lt;br&nbsp;/&gt;&amp;gt;&nbsp;(interested&nbsp;in&nbsp;platform&nbsp;independant&nbsp;solutions&nbsp;as&nbsp;well&nbsp;as&nbsp;specific&lt;br&nbsp;/&gt;&amp;gt;&nbsp;guidelines/toolkits/libraries/software/etc.)&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;One&nbsp;of&nbsp;the&nbsp;most&nbsp;difficult&nbsp;scenarios&nbsp;I&nbsp;have&nbsp;brainstormed&nbsp;has&nbsp;been:&lt;br&nbsp;/&gt;&amp;gt;&nbsp;A&nbsp;client&nbsp;has&nbsp;a&nbsp;Microsoft-based&nbsp;website&nbsp;hosted&nbsp;by&nbsp;a&nbsp;3rd&nbsp;party.&nbsp;&nbsp;The&nbsp;host&lt;br&nbsp;/&gt;&amp;gt;&nbsp;exposes&nbsp;a&nbsp;SQL&nbsp;Server&nbsp;database&nbsp;so&nbsp;that&nbsp;the&nbsp;client&nbsp;can&nbsp;connect&nbsp;remotely.&nbsp;&nbsp;The&lt;br&nbsp;/&gt;&amp;gt;&nbsp;client's&nbsp;website&nbsp;stores&nbsp;a&nbsp;single&nbsp;encrypted&nbsp;connection&nbsp;string&nbsp;to&nbsp;communicate&lt;br&nbsp;/&gt;&amp;gt;&nbsp;with&nbsp;the&nbsp;database.&nbsp;&nbsp;Now,&nbsp;if&nbsp;an&nbsp;attacker&nbsp;were&nbsp;to&nbsp;obtain&nbsp;all&nbsp;of&nbsp;the&nbsp;website's&lt;br&nbsp;/&gt;&amp;gt;&nbsp;files,&nbsp;they&nbsp;could&nbsp;execute&nbsp;the&nbsp;application&nbsp;from&nbsp;a&nbsp;completely&nbsp;different&lt;br&nbsp;/&gt;&amp;gt;&nbsp;domain,&nbsp;including&nbsp;writing&nbsp;their&nbsp;own&nbsp;code&nbsp;to&nbsp;interface&nbsp;with&nbsp;the&nbsp;application.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;*This&nbsp;example&nbsp;can&nbsp;be&nbsp;extended&nbsp;to&nbsp;any&nbsp;publically&nbsp;exposed&nbsp;service&nbsp;that&lt;br&nbsp;/&gt;&amp;gt;&nbsp;requires&nbsp;authentication&nbsp;parameters,&nbsp;but&nbsp;relies&nbsp;on&nbsp;the&nbsp;application&nbsp;to&nbsp;provide&lt;br&nbsp;/&gt;&amp;gt;&nbsp;them&nbsp;without&nbsp;requiring&nbsp;user&nbsp;interaction&nbsp;(web&nbsp;services,&nbsp;XML-RPC,&nbsp;AJAX,&lt;br&nbsp;/&gt;&amp;gt;&nbsp;remoting,&nbsp;etc.).&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;I&nbsp;have&nbsp;identified&nbsp;a&nbsp;couple&nbsp;of&nbsp;ways&nbsp;to&nbsp;help&nbsp;protect&nbsp;an&nbsp;application&nbsp;from&lt;br&nbsp;/&gt;&amp;gt;&nbsp;out-of-context&nbsp;execution,&nbsp;but&nbsp;none&nbsp;of&nbsp;them&nbsp;are&nbsp;fail-safe:&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;Store&nbsp;and&nbsp;communicate&nbsp;an&nbsp;application&nbsp;identifier&nbsp;somewhere&nbsp;other&nbsp;than&nbsp;the&lt;br&nbsp;/&gt;&amp;gt;&nbsp;website&nbsp;file&nbsp;system&nbsp;that&nbsp;the&nbsp;website&nbsp;code&nbsp;can&nbsp;access.&nbsp;&nbsp;This&nbsp;may&nbsp;not&nbsp;be&lt;br&nbsp;/&gt;&amp;gt;&nbsp;possible&nbsp;in&nbsp;many&nbsp;hosted&nbsp;environments.&nbsp;&nbsp;This&nbsp;also&nbsp;does&nbsp;not&nbsp;protect&nbsp;your&lt;br&nbsp;/&gt;&amp;gt;&nbsp;application&nbsp;from&nbsp;someone&nbsp;with&nbsp;access&nbsp;to&nbsp;this&nbsp;&quot;secret&quot;&nbsp;location,&nbsp;or&nbsp;a&lt;br&nbsp;/&gt;&amp;gt;&nbsp;compromised&nbsp;system.&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;Store&nbsp;and&nbsp;communicate&nbsp;a&nbsp;list&nbsp;of&nbsp;trusted&nbsp;domains&nbsp;and&nbsp;IPs.&nbsp;&nbsp;These&nbsp;can&nbsp;be&lt;br&nbsp;/&gt;&amp;gt;&nbsp;spoofed.&nbsp;&nbsp;Web&nbsp;farms&nbsp;and&nbsp;network&nbsp;communications&nbsp;can&nbsp;also&nbsp;introduce&nbsp;elements&lt;br&nbsp;/&gt;&amp;gt;&nbsp;of&nbsp;complexity.&lt;br&nbsp;/&gt;&amp;gt;&nbsp;&nbsp;Additionally,&nbsp;many&nbsp;programmers&nbsp;do&nbsp;not&nbsp;take&nbsp;the&nbsp;time&nbsp;to&nbsp;secure&nbsp;execution&nbsp;of&lt;br&nbsp;/&gt;&amp;gt;&nbsp;their&nbsp;code&nbsp;in&nbsp;a&nbsp;web&nbsp;environment&nbsp;(i.e.&nbsp;once&nbsp;someone&nbsp;obtains&nbsp;the&nbsp;website's&lt;br&nbsp;/&gt;&amp;gt;&nbsp;code&nbsp;they&nbsp;often&nbsp;have&nbsp;&quot;free&nbsp;reign&quot;&nbsp;over&nbsp;the&nbsp;code's&nbsp;execution).&nbsp;&nbsp;As&nbsp;you&nbsp;can&lt;br&nbsp;/&gt;&amp;gt;&nbsp;see,&nbsp;the&nbsp;concern&nbsp;isn't&nbsp;simply&nbsp;the&nbsp;application-supplied&nbsp;authentication&lt;br&nbsp;/&gt;&amp;gt;&nbsp;credentials&nbsp;(like&nbsp;a&nbsp;database&nbsp;connection&nbsp;string),&nbsp;but&nbsp;the&nbsp;direct&nbsp;manipulation&lt;br&nbsp;/&gt;&amp;gt;&nbsp;of&nbsp;an&nbsp;application's&nbsp;code&nbsp;execution&nbsp;(like&nbsp;writing&nbsp;a&nbsp;custom&nbsp;class&nbsp;to&lt;br&nbsp;/&gt;&amp;gt;&nbsp;initialize&nbsp;the&nbsp;website's&nbsp;data&nbsp;access&nbsp;layer&nbsp;and&nbsp;carry&nbsp;out&nbsp;a&nbsp;series&nbsp;of&lt;br&nbsp;/&gt;&amp;gt;&nbsp;unsavory&nbsp;commands).&lt;br&nbsp;/&gt;&amp;gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;Ideally,&nbsp;all&nbsp;of&nbsp;a&nbsp;website's&nbsp;support&nbsp;services&nbsp;(databases,&nbsp;application&nbsp;server&lt;br&nbsp;/&gt;&amp;gt;&nbsp;APIs,&nbsp;etc.)&nbsp;would&nbsp;only&nbsp;be&nbsp;exposed&nbsp;on&nbsp;an&nbsp;internal&nbsp;network&nbsp;not&nbsp;available&nbsp;to&lt;br&nbsp;/&gt;&amp;gt;&nbsp;the&nbsp;public&nbsp;so&nbsp;that&nbsp;communications&nbsp;inherently&nbsp;depend&nbsp;on&nbsp;internal&nbsp;execution&lt;br&nbsp;/&gt;&amp;gt;&nbsp;context.&nbsp;&nbsp;However,&nbsp;the&nbsp;reality&nbsp;is&nbsp;much&nbsp;different.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;As&nbsp;usual&nbsp;the&nbsp;answer&nbsp;to&nbsp;how&nbsp;to&nbsp;secure&nbsp;a&nbsp;hardcoded&nbsp;file&nbsp;is&nbsp;to&nbsp;keep&nbsp;the&lt;br&nbsp;/&gt;password&nbsp;of&nbsp;the&nbsp;server.&nbsp;If&nbsp;your&nbsp;attack&nbsp;scenario&nbsp;is&nbsp;someone&nbsp;stealing&lt;br&nbsp;/&gt;the&nbsp;source&nbsp;code&nbsp;[i.e&nbsp;some&nbsp;file&nbsp;download&nbsp;attack,&nbsp;or&nbsp;stolen&nbsp;backup&nbsp;tapes&lt;br&nbsp;/&gt;or&nbsp;something],&nbsp;then&nbsp;it's&nbsp;trivial&nbsp;to&nbsp;protect&nbsp;it&nbsp;with&nbsp;a&nbsp;required&nbsp;'server&lt;br&nbsp;/&gt;initialisation'&nbsp;phase.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;That&nbsp;is,&nbsp;until&nbsp;you&nbsp;have&nbsp;visit:&nbsp;https://foo/setKey.whatever&nbsp;and&nbsp;entered&lt;br&nbsp;/&gt;in&nbsp;the&nbsp;application&nbsp;key,&nbsp;the&nbsp;system&nbsp;cannot&nbsp;run.&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;The&nbsp;app&nbsp;will&nbsp;then&nbsp;use&nbsp;the&nbsp;key,&nbsp;decrypt&nbsp;the&nbsp;connection&nbsp;string&nbsp;or&lt;br&nbsp;/&gt;whatever&nbsp;else,&nbsp;and&nbsp;then&nbsp;release&nbsp;the&nbsp;key.&nbsp;We&nbsp;can&nbsp;then&nbsp;narrow&nbsp;the&nbsp;attack&lt;br&nbsp;/&gt;scenario&nbsp;down&nbsp;to&nbsp;someone&nbsp;accessing&nbsp;a&nbsp;live&nbsp;running&nbsp;server&nbsp;and&nbsp;copying&lt;br&nbsp;/&gt;the&nbsp;runtime&nbsp;to&nbsp;disk,&nbsp;or&nbsp;finding&nbsp;the&nbsp;connection&nbsp;string&nbsp;in&nbsp;memory.&nbsp;Alot&lt;br&nbsp;/&gt;harder&nbsp;then&nbsp;simplying&nbsp;getting&nbsp;source&nbsp;files&nbsp;...&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&amp;gt;&nbsp;Eric&nbsp;Swanson&lt;br&nbsp;/&gt;&amp;gt;&nbsp;http://www.ericis.com/&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;--&nbsp;mic&lt;br&nbsp;/&gt;&lt;br&nbsp;/&gt;&lt;/email@iseric.com&gt;<br>

</tt>
