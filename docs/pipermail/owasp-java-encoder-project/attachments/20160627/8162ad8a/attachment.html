<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=utf-8&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Hello,&lt;/span&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;am&nbsp;using&nbsp;the&nbsp;Java&nbsp;Encoder&nbsp;library&nbsp;in&nbsp;order&nbsp;to&nbsp;protect&nbsp;an&nbsp;application&nbsp;against&nbsp;XSS&nbsp;and&nbsp;I&nbsp;have&nbsp;a&nbsp;specific&nbsp;question&nbsp;since&nbsp;I&nbsp;have&nbsp;a&nbsp;payload&nbsp;that&nbsp;gets&nbsp;executed&nbsp;in&nbsp;the&nbsp;URL.&nbsp;I’ve&nbsp;tried&nbsp;all&nbsp;different&nbsp;ways&nbsp;to&nbsp;encode&nbsp;but&nbsp;still&nbsp;have&nbsp;the&nbsp;problem:&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;The&nbsp;user&nbsp;enters&nbsp;an&nbsp;URL&nbsp;in&nbsp;a&nbsp;field&nbsp;and&nbsp;these&nbsp;are&nbsp;the&nbsp;2&nbsp;cases&nbsp;I&nbsp;am&nbsp;testing:&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;URL&nbsp;1:&nbsp;&lt;a&nbsp;href=&quot;https://www.google.com/&quot;&nbsp;class=&quot;&quot;&gt;https://www.google.com&lt;/a&gt;&nbsp;—&gt;&nbsp;I&nbsp;would&nbsp;like&nbsp;to&nbsp;redirect&nbsp;to&nbsp;this&nbsp;page&nbsp;by&nbsp;using&nbsp;&lt;a&gt;&nbsp;html&nbsp;element&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;URL&nbsp;2:&nbsp;javascript:alert(‘hi’)//&lt;a&nbsp;href=&quot;http://www.google.com/&quot;&nbsp;class=&quot;&quot;&gt;www.google.com&lt;/a&gt;&nbsp;—&gt;&nbsp;I&nbsp;would&nbsp;like&nbsp;this&nbsp;alert&nbsp;popup&nbsp;not&nbsp;to&nbsp;execute&nbsp;in&nbsp;the&nbsp;browser.&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;so&nbsp;I&nbsp;tried&nbsp;&nbsp;in&nbsp;the&nbsp;servlet:&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Printer&nbsp;out&nbsp;=&nbsp;response.getWritter();&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println&nbsp;(“&lt;html&gt;&lt;body&gt;”);&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;String&nbsp;web&nbsp;=&nbsp;request&nbsp;.getParameter(“site”);&nbsp;&nbsp;//&nbsp;this&nbsp;is&nbsp;where&nbsp;I&nbsp;have&nbsp;the&nbsp;URL&nbsp;value&nbsp;entered&nbsp;by&nbsp;user&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;tried:&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println(“Site&nbsp;:&nbsp;&lt;a&nbsp;href=\””&nbsp;+&nbsp;Encode.forHtmlAttribute(web)&nbsp;+&nbsp;“\”&gt;”&nbsp;+&nbsp;web&nbsp;+&nbsp;&nbsp;“&lt;/a&gt;”);&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;—&gt;&nbsp;the&nbsp;output&nbsp;works&nbsp;fine&nbsp;for&nbsp;URL&nbsp;1&nbsp;because&nbsp;it&nbsp;redirects&nbsp;to&nbsp;google&nbsp;site&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;URL&nbsp;2&nbsp;because&nbsp;the&nbsp;popup&nbsp;gets&nbsp;executed.&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;tried:&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println(“Site&nbsp;:&nbsp;&lt;a&nbsp;href=\””&nbsp;+&nbsp;Encode.forUriComponent(web)&nbsp;+&nbsp;“\”&gt;”&nbsp;+&nbsp;Encode.forHtml(web)&nbsp;+&nbsp;&nbsp;“&lt;/a&gt;”);&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;—&gt;&nbsp;the&nbsp;output&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;URL&nbsp;1&nbsp;because&nbsp;it&nbsp;gives&nbsp;404&nbsp;resource&nbsp;not&nbsp;found&nbsp;for&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;&nbsp;&lt;/span&gt;&lt;a&nbsp;href=&quot;https://www.google.com/&quot;&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;https://www.google.com&lt;/a&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;when&nbsp;I&nbsp;click&nbsp;on&nbsp;the&nbsp;link&nbsp;(&nbsp;it&nbsp;redirects&nbsp;to&nbsp;https%3A%2F%&lt;/span&gt;&lt;a&nbsp;href=&quot;http://2fwww.google.com/&quot;&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;2Fwww.google.com&lt;/a&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;)&nbsp;but&nbsp;it&nbsp;works&nbsp;fine&nbsp;for&nbsp;URL&nbsp;2&nbsp;because&nbsp;the&nbsp;alert&nbsp;popup&nbsp;does&nbsp;not&nbsp;execute.&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;tried:&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println(“Site&nbsp;:&nbsp;&lt;a&nbsp;href=\””&nbsp;+&nbsp;Encode.forHtmlAttribute(web)&nbsp;+&nbsp;“\”&gt;”&nbsp;+&nbsp;Encode.forUri(web)&nbsp;+&nbsp;&nbsp;“&lt;/a&gt;”);&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;—&gt;&nbsp;the&nbsp;output&nbsp;works&nbsp;fine&nbsp;for&nbsp;URL&nbsp;1&nbsp;because&nbsp;it&nbsp;redirects&nbsp;to&nbsp;google&nbsp;site,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;URL&nbsp;2&nbsp;because&nbsp;the&nbsp;alert&nbsp;popup&nbsp;gets&nbsp;executed.&nbsp;(&nbsp;I&nbsp;also&nbsp;tried&nbsp;Encode.forUriComponent()&nbsp;instead&nbsp;of&nbsp;Encode.forUri()&nbsp;and&nbsp;got&nbsp;same&nbsp;result&nbsp;)&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Please,&nbsp;How&nbsp;could&nbsp;I&nbsp;protect&nbsp;the&nbsp;URL&nbsp;so&nbsp;the&nbsp;javascript&nbsp;popup&nbsp;does&nbsp;not&nbsp;execute&nbsp;for&nbsp;URL&nbsp;2&nbsp;and&nbsp;it&nbsp;redirects&nbsp;for&nbsp;URL1?&nbsp;Any&nbsp;help,&nbsp;will&nbsp;be&nbsp;greatly&nbsp;appreciated&nbsp;.&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Thank&nbsp;you&nbsp;very&nbsp;much&nbsp;for&nbsp;your&nbsp;guidance&nbsp;and&nbsp;opinions.&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/span&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Merly&nbsp;Knox&nbsp;&lt;/span&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
