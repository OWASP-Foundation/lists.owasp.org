<tt>
&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html&nbsp;charset=windows-1252&quot;&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&quot;&nbsp;class=&quot;&quot;&gt;Thank&nbsp;you&nbsp;very&nbsp;much&nbsp;for&nbsp;the&nbsp;help,&nbsp;yes,&nbsp;I&nbsp;think&nbsp;combining&nbsp;input&nbsp;validation&nbsp;and&nbsp;output&nbsp;encoding&nbsp;is&nbsp;the&nbsp;best&nbsp;way&nbsp;to&nbsp;protect&nbsp;against&nbsp;XSS&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;I&nbsp;will&nbsp;use&nbsp;your&nbsp;recommendation.&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Aloha&nbsp;&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;Merly&lt;/div&gt;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;div&gt;&lt;blockquote&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;On&nbsp;Jun&nbsp;27,&nbsp;2016,&nbsp;at&nbsp;8:18&nbsp;PM,&nbsp;Jim&nbsp;Manico&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:jim.manico@owasp.org&quot;&nbsp;class=&quot;&quot;&gt;jim.manico@owasp.org&lt;/a&gt;&gt;&nbsp;wrote:&lt;/div&gt;&lt;br&nbsp;class=&quot;Apple-interchange-newline&quot;&gt;&lt;div&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;content=&quot;text/html;&nbsp;charset=windows-1252&quot;&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;&lt;div&nbsp;bgcolor=&quot;#FFFFFF&quot;&nbsp;text=&quot;#000000&quot;&nbsp;class=&quot;&quot;&gt;&lt;p&nbsp;class=&quot;&quot;&gt;To&nbsp;safely&nbsp;render&nbsp;untrusted&nbsp;URL's&nbsp;you&nbsp;need&nbsp;a&nbsp;combination&nbsp;of<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validation&nbsp;(to&nbsp;remove&nbsp;evil&nbsp;schemes&nbsp;like&nbsp;javascript:)&nbsp;and&nbsp;escaping.&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;&lt;p&nbsp;class=&quot;&quot;&gt;1)&nbsp;First&nbsp;validate&nbsp;to&nbsp;ensure&nbsp;unsafe&nbsp;schemes&nbsp;and&nbsp;other&nbsp;nonsense&nbsp;is<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rejected.&nbsp;Here&nbsp;is&nbsp;some&nbsp;code&nbsp;to&nbsp;get&nbsp;you&nbsp;started&nbsp;here.&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;public&nbsp;static&nbsp;String&nbsp;validateURL(String&nbsp;rawURI)&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;throws&nbsp;ValidationException&nbsp;{&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;throws&nbsp;URISyntaxException&nbsp;if&nbsp;invalid&nbsp;URI&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;URI&nbsp;uri&nbsp;=&nbsp;new&nbsp;URI(rawURI);&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;don't&nbsp;allow&nbsp;relative&nbsp;uris&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!uri.isAbsolute())&nbsp;throw&nbsp;new&nbsp;ValidationException(&quot;not&nbsp;an<br>
&nbsp;&nbsp;&nbsp;&nbsp;absolute&nbsp;uri&quot;);&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;don't&nbsp;allows&nbsp;javascript&nbsp;urls,&nbsp;etc…&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((!&quot;http&quot;.equals(uri.getScheme())&nbsp;&amp;&amp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;(!&quot;https&quot;.equals(uri.getScheme()))&nbsp;throw&nbsp;new<br>
&nbsp;&nbsp;&nbsp;&nbsp;ValidationException(&quot;http&nbsp;or&nbsp;https&nbsp;urls&nbsp;are&nbsp;only&nbsp;accepted&quot;;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;who&nbsp;legitimately&nbsp;uses&nbsp;user-infos&nbsp;in&nbsp;their&nbsp;urls?!?&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(uri.getUserInfo()&nbsp;!=&nbsp;null)&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;throw&nbsp;new&nbsp;ValidationException(&quot;this&nbsp;can&nbsp;only&nbsp;be&nbsp;trouble&quot;);&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;normalize&nbsp;to&nbsp;get&nbsp;rid&nbsp;of&nbsp;'.'&nbsp;and&nbsp;'..'&nbsp;path&nbsp;components&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;uri&nbsp;=&nbsp;uri.normalize();&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check:&nbsp;uri.getHost()&nbsp;against&nbsp;whitelist/blacklist?&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;check:&nbsp;uri.getPort()&nbsp;for&nbsp;shenanigans?&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;uri.toASCIIString();&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;2)&nbsp;Next&nbsp;escape&nbsp;that&nbsp;URL&nbsp;based&nbsp;on&nbsp;the&nbsp;content&nbsp;of&nbsp;use.&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;looks&nbsp;good&nbsp;to&nbsp;me.&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println(“Site&nbsp;:&nbsp;&lt;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;href=\””&nbsp;+&nbsp;Encode.forHtmlAttribute(web)&nbsp;+&nbsp;“\”&gt;”&nbsp;+&nbsp;web&nbsp;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;“&lt;/a&gt;”);&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Aloha,&nbsp;Jim&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;On&nbsp;6/28/16&nbsp;2:31&nbsp;AM,&nbsp;Merly&nbsp;Knox&nbsp;wrote:&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;cite=&quot;mid:38BEB96A-9463-4DC5-8FF6-8E017A83F98B@gmail.com&quot;&nbsp;type=&quot;cite&quot;&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;charset=windows-1252&quot;&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Hello,&lt;/span&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;am&nbsp;using<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;Java&nbsp;Encoder&nbsp;library&nbsp;in&nbsp;order&nbsp;to&nbsp;protect&nbsp;an&nbsp;application<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;against&nbsp;XSS&nbsp;and&nbsp;I&nbsp;have&nbsp;a&nbsp;specific&nbsp;question&nbsp;since&nbsp;I&nbsp;have&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;payload&nbsp;that&nbsp;gets&nbsp;executed&nbsp;in&nbsp;the&nbsp;URL.&nbsp;I’ve&nbsp;tried&nbsp;all<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;different&nbsp;ways&nbsp;to&nbsp;encode&nbsp;but&nbsp;still&nbsp;have&nbsp;the&nbsp;problem:&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;The&nbsp;user<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;enters&nbsp;an&nbsp;URL&nbsp;in&nbsp;a&nbsp;field&nbsp;and&nbsp;these&nbsp;are&nbsp;the&nbsp;2&nbsp;cases&nbsp;I&nbsp;am<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;testing:&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;URL&nbsp;1:&nbsp;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;href=&quot;https://www.google.com/&quot;&nbsp;class=&quot;&quot;&gt;&lt;/a&gt;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.google.com/&quot;&gt;https://www.google.com&lt;/a&gt;&nbsp;—&gt;&nbsp;I&nbsp;would&nbsp;like&nbsp;to<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;redirect&nbsp;to&nbsp;this&nbsp;page&nbsp;by&nbsp;using&nbsp;&lt;a&gt;&nbsp;html&nbsp;element&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;URL&nbsp;2:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;javascript:alert(%E2%80%98hi%E2%80%99)//&quot;&gt;javascript:alert(‘hi’)//&lt;/a&gt;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;href=&quot;http://www.google.com/&quot;&nbsp;class=&quot;&quot;&gt;www.google.com&lt;/a&gt;&nbsp;—&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;would&nbsp;like&nbsp;this&nbsp;alert&nbsp;popup&nbsp;not&nbsp;to&nbsp;execute&nbsp;in&nbsp;the&nbsp;browser.&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;so&nbsp;I&nbsp;tried<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;in&nbsp;the&nbsp;servlet:&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Printer&nbsp;out<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;response.getWritter();&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(“&lt;html&gt;&lt;body&gt;”);&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;String&nbsp;web&nbsp;=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;request&nbsp;.getParameter(“site”);&nbsp;&nbsp;//&nbsp;this&nbsp;is&nbsp;where&nbsp;I&nbsp;have&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;URL&nbsp;value&nbsp;entered&nbsp;by&nbsp;user&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;tried:&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println(“Site<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&lt;a&nbsp;href=\””&nbsp;+&nbsp;Encode.forHtmlAttribute(web)&nbsp;+&nbsp;“\”&gt;”&nbsp;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;web&nbsp;+&nbsp;&nbsp;“&lt;/a&gt;”);&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;—&gt;&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;works&nbsp;fine&nbsp;for&nbsp;URL&nbsp;1&nbsp;because&nbsp;it&nbsp;redirects&nbsp;to&nbsp;google<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;site&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;URL&nbsp;2&nbsp;because&nbsp;the&nbsp;popup&nbsp;gets<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;executed.&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;tried:&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println(“Site<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&lt;a&nbsp;href=\””&nbsp;+&nbsp;Encode.forUriComponent(web)&nbsp;+&nbsp;“\”&gt;”&nbsp;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode.forHtml(web)&nbsp;+&nbsp;&nbsp;“&lt;/a&gt;”);&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;—&gt;&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;URL&nbsp;1&nbsp;because&nbsp;it&nbsp;gives&nbsp;404&nbsp;resource<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;not&nbsp;found&nbsp;for&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;&nbsp;&lt;/span&gt;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;href=&quot;https://www.google.com/&quot;&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;/a&gt;&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://www.google.com/&quot;&gt;https://www.google.com&lt;/a&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;when&nbsp;I&nbsp;click&nbsp;on&nbsp;the&nbsp;link&nbsp;(<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;redirects&nbsp;to&nbsp;https%3A%2F%&lt;/span&gt;&lt;a&nbsp;moz-do-not-send=&quot;true&quot;&nbsp;href=&quot;http://2fwww.google.com/&quot;&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14px;&quot;&gt;2Fwww.google.com&lt;/a&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;&nbsp;&lt;/span&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;)&nbsp;but<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;works&nbsp;fine&nbsp;for&nbsp;URL&nbsp;2&nbsp;because&nbsp;the&nbsp;alert&nbsp;popup&nbsp;does&nbsp;not<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute.&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;I&nbsp;tried:&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;out.println(“Site<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;&lt;a&nbsp;href=\””&nbsp;+&nbsp;Encode.forHtmlAttribute(web)&nbsp;+&nbsp;“\”&gt;”&nbsp;+<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encode.forUri(web)&nbsp;+&nbsp;&nbsp;“&lt;/a&gt;”);&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&nbsp;class=&quot;&quot;&gt;—&gt;&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;output&nbsp;works&nbsp;fine&nbsp;for&nbsp;URL&nbsp;1&nbsp;because&nbsp;it&nbsp;redirects&nbsp;to&nbsp;google<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;site,&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;work&nbsp;for&nbsp;URL&nbsp;2&nbsp;because&nbsp;the&nbsp;alert&nbsp;popup<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gets&nbsp;executed.&nbsp;(&nbsp;I&nbsp;also&nbsp;tried&nbsp;Encode.forUriComponent()&nbsp;instead<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;Encode.forUri()&nbsp;and&nbsp;got&nbsp;same&nbsp;result&nbsp;)&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Please,&nbsp;How<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;could&nbsp;I&nbsp;protect&nbsp;the&nbsp;URL&nbsp;so&nbsp;the&nbsp;javascript&nbsp;popup&nbsp;does&nbsp;not<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute&nbsp;for&nbsp;URL&nbsp;2&nbsp;and&nbsp;it&nbsp;redirects&nbsp;for&nbsp;URL1?&nbsp;Any&nbsp;help,&nbsp;will&nbsp;be<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;greatly&nbsp;appreciated&nbsp;.&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Thank&nbsp;you<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;very&nbsp;much&nbsp;for&nbsp;your&nbsp;guidance&nbsp;and&nbsp;opinions.&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;&quot;&gt;&lt;span&nbsp;class=&quot;&quot;&nbsp;style=&quot;font-size:&nbsp;14px;&quot;&gt;Merly&nbsp;Knox&nbsp;&lt;/span&gt;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;fieldset&nbsp;class=&quot;mimeAttachmentHeader&quot;&gt;&lt;/fieldset&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&nbsp;class=&quot;&quot;&gt;_______________________________________________<br>
Owasp-java-encoder-project&nbsp;mailing&nbsp;list<br>
&lt;a&nbsp;class=&quot;moz-txt-link-abbreviated&quot;&nbsp;href=&quot;mailto:Owasp-java-encoder-project@lists.owasp.org&quot;&gt;Owasp-java-encoder-project@lists.owasp.org&lt;/a&gt;<br>
&lt;a&nbsp;class=&quot;moz-txt-link-freetext&quot;&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project&quot;&gt;https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project&lt;/a&gt;<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&nbsp;class=&quot;&quot;&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&nbsp;class=&quot;&quot;&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;
</tt>
