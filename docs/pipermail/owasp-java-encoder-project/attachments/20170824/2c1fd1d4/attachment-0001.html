<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;Le&nbsp;24/08/2017&nbsp;à&nbsp;15:53,&nbsp;Matt&nbsp;Seil&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;écrit :&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
cite=&quot;mid:CADYkqj5jCqTvM7=4JCWsia7CTOc=emiNQ99Xr-KFDjXbi9BiUQ@mail.gmail.com&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Hi,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;I&nbsp;do&nbsp;work&nbsp;on&nbsp;ESAPI's&nbsp;encoder&nbsp;and&nbsp;decoder.  &lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;I&nbsp;can&nbsp;tell&nbsp;you&nbsp;this&nbsp;for&nbsp;sure,&nbsp;2.0.1&nbsp;is&nbsp;extremely<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;outdated.  &lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;And&nbsp;after&nbsp;having&nbsp;worked&nbsp;on&nbsp;ESAPI's&nbsp;encoder,&nbsp;I&nbsp;know&nbsp;for&nbsp;that<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;when&nbsp;dealing&nbsp;with&nbsp;HTML&nbsp;entities,&nbsp;we&nbsp;typically&nbsp;encode<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;human-readable&nbsp;escapes&nbsp;when&nbsp;available,&nbsp;and&nbsp;use&nbsp;hex&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;everything&nbsp;else. &nbsp;I&nbsp;say&nbsp;typically&nbsp;because&nbsp;this&nbsp;is&nbsp;what&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;current&nbsp;encoder&nbsp;produces&nbsp;for&nbsp;your&nbsp;script&nbsp;tag&nbsp;input:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&nbsp;style=&quot;color:rgb(33,33,33);font-size:13px&quot;&gt;&lt;script&gt;&lt;/script&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&amp;&lt;&gt;'/&quot;!$&lt;/span&gt; &lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt; &lt;br&gt;<br>
&amp;lt;script&amp;gt;&amp;lt;&amp;#x2f;script&amp;gt;&amp;#x20;&amp;#x7c;&amp;#x20;&amp;amp;&amp;lt;&amp;gt;&amp;#x27;&amp;#x2f;&amp;quot;&amp;#x21;&amp;#x24;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;Hex&nbsp;only&nbsp;has&nbsp;an&nbsp;advantage&nbsp;when&nbsp;dealing&nbsp;with&nbsp;non-BMP&nbsp;code<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;points&nbsp;as&nbsp;well&nbsp;as&nbsp;any&nbsp;character&nbsp;set&nbsp;larger&nbsp;than&nbsp;Latin&nbsp;1.<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Browsers&nbsp;render&nbsp;either&nbsp;human&nbsp;readable&nbsp;and&nbsp;hex&nbsp;escapes&nbsp;equally<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;well. &nbsp; &lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&gt;What&nbsp;makes&nbsp;you&nbsp;think&nbsp;that&nbsp;&amp;lt;&nbsp;is&nbsp;weaker&nbsp;than &lt;span<br>
style=&quot;color:rgb(102,102,102);font-family:DDG_ProximaNova,DDG_ProximaNova_UI_0,DDG_ProximaNova_UI_1,DDG_ProximaNova_UI_2,DDG_ProximaNova_UI_3,DDG_ProximaNova_UI_4,DDG_ProximaNova_UI_5,DDG_ProximaNova_UI_6,&quot;Proxima<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nova&quot;,&quot;Helvetica&nbsp;Neue&quot;,Helvetica,&quot;Segoe<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UI&quot;,&quot;Nimbus&nbsp;Sans&nbsp;L&quot;,&quot;Liberation<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sans&quot;,&quot;Open<br>
Sans&quot;,FreeSans,Arial,sans-serif;font-size:14.4px;background-color:rgb(242,242,242)&quot;&gt;&amp;#60;&lt;/span&gt; ?&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;I&nbsp;do&nbsp;not&nbsp;think&nbsp;that,&nbsp;i&nbsp;was&nbsp;puzzled&nbsp;by&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;XSS&nbsp;Cheat<br>
&nbsp;&nbsp;&nbsp;&nbsp;sheet&nbsp;strongly&nbsp;recommended&nbsp;a&nbsp;full&nbsp;escaping&nbsp;of&nbsp;all&nbsp;non-alphanum&nbsp;chars<br>
&nbsp;&nbsp;&nbsp;&nbsp;but&nbsp;that&nbsp;the&nbsp;java&nbsp;encoder&nbsp;lib&nbsp;wasn't&nbsp;doing&nbsp;that.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;&lt;span&nbsp;style=&quot;color:&nbsp;rgb(37,&nbsp;37,&nbsp;37);<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-family:&nbsp;sans-serif;&nbsp;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-variant-ligatures:&nbsp;normal;&nbsp;font-variant-caps:&nbsp;normal;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;2;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text-align:&nbsp;left;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;white-space:&nbsp;normal;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;background-color:&nbsp;rgb(255,&nbsp;255,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;255);&nbsp;text-decoration-style:&nbsp;initial;&nbsp;text-decoration-color:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;initial;&nbsp;display:&nbsp;inline&nbsp;!important;&nbsp;float:&nbsp;none;&quot;&gt;Except&nbsp;for<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;alphanumeric&nbsp;characters,&nbsp;escape&nbsp;all&nbsp;characters&nbsp;less&nbsp;than&nbsp;256<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;the&nbsp;\xHH&nbsp;format&nbsp;to&nbsp;prevent&nbsp;switching&nbsp;out&nbsp;of&nbsp;the&nbsp;data&nbsp;value<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;into&nbsp;the&nbsp;script&nbsp;context&nbsp;or&nbsp;into&nbsp;another&nbsp;attribute.&nbsp;DO&nbsp;NOT&nbsp;use<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;any&nbsp;escaping&nbsp;shortcuts&nbsp;like&nbsp;\&quot;&nbsp;because&nbsp;the&nbsp;quote&nbsp;character&nbsp;may<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;be&nbsp;matched&nbsp;by&nbsp;the&nbsp;HTML&nbsp;attribute&nbsp;parser&nbsp;which&nbsp;runs&nbsp;first.&nbsp;These<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escaping&nbsp;shortcuts&nbsp;are&nbsp;also&nbsp;susceptible&nbsp;to&nbsp;&quot;escape-the-escape&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;attacks&nbsp;where&nbsp;the&nbsp;attacker&nbsp;sends&nbsp;\&quot;&nbsp;and&nbsp;the&nbsp;vulnerable&nbsp;code<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;turns&nbsp;that&nbsp;into&nbsp;\\&quot;&nbsp;which&nbsp;enables&nbsp;the&nbsp;quote.&lt;/span&gt;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;EncodeForJavascript:&nbsp;&lt;script&gt;&lt;\/script&gt;&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;\x26&lt;&gt;\x27\/\x22!$&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;EncodeForJavascriptBlock:&nbsp;&lt;script&gt;&lt;\/script&gt;&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;\x26&lt;&gt;\'\/\&quot;!$&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;EncodeForJavascriptAttribute:&nbsp;&lt;script&gt;&lt;/script&gt;&nbsp;|<br>
&nbsp;&nbsp;&nbsp;&nbsp;\x26&lt;&gt;\x27/\x22!$&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;Also&nbsp;i&nbsp;did&nbsp;miss&nbsp;the&nbsp;fact&nbsp;that&nbsp;the&nbsp;encoder&nbsp;did&nbsp;at&nbsp;least&nbsp;escape&nbsp;the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&quot;/&quot;&nbsp;from&nbsp;the&nbsp;closing&nbsp;tag&nbsp;(not&nbsp;my&nbsp;brightest&nbsp;day),&nbsp;it's&nbsp;not&nbsp;as&nbsp;bad&nbsp;as<br>
&nbsp;&nbsp;&nbsp;&nbsp;i&nbsp;initialy&nbsp;saw&nbsp;it.&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
