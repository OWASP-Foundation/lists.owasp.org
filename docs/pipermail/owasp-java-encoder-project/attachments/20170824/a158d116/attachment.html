<tt>
&lt;html&gt;<br>
&nbsp;&nbsp;&lt;head&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta&nbsp;http-equiv=&quot;Content-Type&quot;&nbsp;content=&quot;text/html;&nbsp;charset=utf-8&quot;&gt;<br>
&nbsp;&nbsp;&lt;/head&gt;<br>
&nbsp;&nbsp;&lt;body&nbsp;text=&quot;#000000&quot;&nbsp;bgcolor=&quot;#FFFFFF&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;What&nbsp;security&nbsp;benefit&nbsp;do&nbsp;you&nbsp;get&nbsp;when&nbsp;encoding&nbsp;tags&nbsp;when&nbsp;you're<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;already&nbsp;in&nbsp;a&nbsp;JavaScript&nbsp;content?&nbsp;Out&nbsp;conjecture:&nbsp;none.&nbsp;This&nbsp;is&nbsp;a<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;performance&nbsp;enhancement&nbsp;over&nbsp;other&nbsp;libraries&nbsp;like&nbsp;ESAPI.&nbsp;These<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;functions&nbsp;are&nbsp;for&nbsp;contexts&nbsp;like:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;style=&quot;font-family:&nbsp;monospace,&nbsp;Courier;&nbsp;color:&nbsp;black;&nbsp;background-color:&nbsp;rgb(249,&nbsp;249,&nbsp;249);&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;rgb(221,&nbsp;221,&nbsp;221);&nbsp;padding:&nbsp;1em;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;line-height:&nbsp;1.3em;&nbsp;overflow-x:&nbsp;auto;&nbsp;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant-ligatures:&nbsp;normal;&nbsp;font-variant-caps:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;text-decoration-style:&nbsp;initial;&nbsp;text-decoration-color:&nbsp;initial;&quot;&gt;&nbsp;&lt;script&nbsp;type=&quot;text/javascript&quot;&gt;<br>
&nbsp;var&nbsp;msg&nbsp;=&nbsp;&quot;&lt;%=&nbsp;&lt;b&gt;Encode.forJavaScriptBlock(UNTRUSTED)&lt;/b&gt; %&gt;&quot;;<br>
&nbsp;alert(msg);<br>
&nbsp;&lt;/script&gt;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;..&nbsp;and&nbsp;...&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;style=&quot;font-family:&nbsp;monospace,&nbsp;Courier;&nbsp;color:&nbsp;black;&nbsp;background-color:&nbsp;rgb(249,&nbsp;249,&nbsp;249);&nbsp;border:&nbsp;1px&nbsp;solid&nbsp;rgb(221,&nbsp;221,&nbsp;221);&nbsp;padding:&nbsp;1em;&nbsp;white-space:&nbsp;pre-wrap;&nbsp;line-height:&nbsp;1.3em;&nbsp;overflow-x:&nbsp;auto;&nbsp;font-size:&nbsp;14px;&nbsp;font-style:&nbsp;normal;&nbsp;font-variant-ligatures:&nbsp;normal;&nbsp;font-variant-caps:&nbsp;normal;&nbsp;font-weight:&nbsp;normal;&nbsp;letter-spacing:&nbsp;normal;&nbsp;orphans:&nbsp;2;&nbsp;text-align:&nbsp;start;&nbsp;text-indent:&nbsp;0px;&nbsp;text-transform:&nbsp;none;&nbsp;widows:&nbsp;2;&nbsp;word-spacing:&nbsp;0px;&nbsp;-webkit-text-stroke-width:&nbsp;0px;&nbsp;text-decoration-style:&nbsp;initial;&nbsp;text-decoration-color:&nbsp;initial;&quot;&gt;&nbsp;&lt;button&nbsp;<br>
&nbsp;onclick=&quot;alert('&lt;%=&nbsp;&lt;b&gt;Encode.forJavaScriptAttribute(UNTRUSTED)&lt;/b&gt; %&gt;');&quot;&gt;<br>
&nbsp;click&nbsp;me&lt;/button&gt;&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;You're&nbsp;already&nbsp;in&nbsp;a&nbsp;script&nbsp;context&nbsp;with&nbsp;these&nbsp;functions.&nbsp;How&nbsp;does<br>
&nbsp;&nbsp;&nbsp;&nbsp;injecting&nbsp;a&nbsp;script&nbsp;tag&nbsp;-&nbsp;or&nbsp;any&nbsp;other&nbsp;tag&nbsp;-&nbsp;cause&nbsp;harm?&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;class=&quot;moz-cite-prefix&quot;&gt;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Aloha,&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Jim&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;8/24/17&nbsp;4:47&nbsp;AM,&nbsp;Benoit&nbsp;Plessis&nbsp;wrote:&lt;br&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/div&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;blockquote&nbsp;type=&quot;cite&quot;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cite=&quot;mid:ac372d80-181e-52be-adeb-0ef27ebe65c5@doyousoft.com&quot;&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;pre&nbsp;wrap=&quot;&quot;&gt;Hi,<br>
<br>
I'm&nbsp;a&nbsp;bit&nbsp;confused&nbsp;by&nbsp;the&nbsp;encoding&nbsp;provided&nbsp;with&nbsp;the&nbsp;java&nbsp;encoder<br>
project,&nbsp;mostly&nbsp;in&nbsp;comparaison&nbsp;with&nbsp;the&nbsp;ESAPI&nbsp;lib&nbsp;and&nbsp;the&nbsp;XSS&nbsp;prevention<br>
cheatsheat.<br>
<br>
I&nbsp;need&nbsp;to&nbsp;use&nbsp;advanced&nbsp;encoding&nbsp;function&nbsp;on&nbsp;an&nbsp;old&nbsp;Coldfusion&nbsp;engine<br>
which&nbsp;doesn't&nbsp;provide&nbsp;them,&nbsp;and&nbsp;the&nbsp;ESAPI&nbsp;Encoder&nbsp;seem&nbsp;is&nbsp;a&nbsp;bit&nbsp;complex<br>
to&nbsp;instantiate&nbsp;in&nbsp;our&nbsp;context&nbsp;as&nbsp;a&nbsp;&quot;simple&quot;<br>
<br>
 &nbsp;ESAPIEncoder&nbsp;=&nbsp;createObject(&quot;java&quot;,&nbsp;&quot;org.owasp.esapi.ESAPI&quot;).encoder();<br>
<br>
Trigger&nbsp;an&nbsp;error&nbsp;&quot;java.lang.reflect.InvocationTargetException<br>
SecurityConfiguration&nbsp;class<br>
(org.owasp.esapi.reference.DefaultSecurityConfiguration)&nbsp;CTOR&nbsp;threw<br>
exception&quot;<br>
<br>
So&nbsp;i'm&nbsp;focusing&nbsp;on&nbsp;the&nbsp;simpler&nbsp;OWASP&nbsp;Java&nbsp;Encoder&nbsp;which&nbsp;give&nbsp;me&nbsp;thoses<br>
modified&nbsp;string:<br>
<br>
EncodeForHTML:&nbsp;&amp;lt;script&amp;gt;&amp;lt;/script&amp;gt;&nbsp;|&nbsp;&amp;amp;&amp;lt;&amp;gt;&amp;#39;/&amp;#34;!$<br>
EncodeForHTMLContent:&nbsp;&amp;lt;script&amp;gt;&amp;lt;/script&amp;gt;&nbsp;|&nbsp;&amp;amp;&amp;lt;&amp;gt;'/&quot;!$<br>
EncodeForHTMLAttribute:&nbsp;&amp;lt;script&gt;&amp;lt;/script&gt;&nbsp;|&nbsp;&amp;amp;&amp;lt;&gt;&amp;#39;/&amp;#34;!$<br>
EncodeForJavascript:&nbsp;&lt;script&gt;&lt;\/script&gt;&nbsp;|&nbsp;\x26&lt;&gt;\x27\/\x22!$<br>
EncodeForJavascriptBlock:&nbsp;&lt;script&gt;&lt;\/script&gt;&nbsp;|&nbsp;\x26&lt;&gt;\'\/\&quot;!$<br>
EncodeForJavascriptAttribute:&nbsp;&lt;script&gt;&lt;/script&gt;&nbsp;|&nbsp;\x26&lt;&gt;\x27/\x22!$<br>
EncodeForUri:&nbsp;%3Cscript%3E%3C/script%3E&nbsp;|&nbsp;&amp;%3C%3E'/%22!$<br>
EncodeForCSSString:&nbsp;\3cscript\3e\3c\2fscript\3e&nbsp;|&nbsp;\26\3c\3e\27\2f\22!$<br>
<br>
I'm&nbsp;a&nbsp;bit&nbsp;puzzled&nbsp;as&nbsp;to&nbsp;why&nbsp;the&nbsp;&quot;&lt;script&gt;&lt;/script&gt;&quot;&nbsp;isn't&nbsp;replaced&nbsp;with&nbsp;the&nbsp;recommended&nbsp;hex-syntax&nbsp;when&nbsp;using&nbsp;the&nbsp;java&nbsp;encoded&nbsp;?<br>
<br>
When&nbsp;compared&nbsp;to&nbsp;Coldfusion&nbsp;11&nbsp;&quot;Native&quot;&nbsp;advanced&nbsp;function&nbsp;(using&nbsp;ESAPI&nbsp;2.0.1&nbsp;in&nbsp;the&nbsp;background)&nbsp;:<br>
<br>
Source:&nbsp;&lt;script&gt;&lt;/script&gt;&nbsp;|&nbsp;&amp;&lt;&gt;'/&quot;!$<br>
EncodeForHTML:&nbsp;&amp;lt;script&amp;gt;&amp;lt;&amp;#x2f;script&amp;gt;&nbsp;|<br>
&amp;amp;&amp;lt;&amp;gt;&amp;#x27;&amp;#x2f;&amp;quot;&amp;#x21;&amp;#x24;<br>
EncodeForHTMLAttribute:&nbsp;&amp;lt;script&amp;gt;&amp;lt;&amp;#x2f;script&amp;gt;&nbsp;|<br>
&amp;amp;&amp;lt;&amp;gt;&amp;#x27;&amp;#x2f;&amp;quot;&amp;#x21;&amp;#x24;<br>
EncodeForJavascript:&nbsp;\x3Cscript\x3E\x3C\x2Fscript\x3E&nbsp;|<br>
\x26\x3C\x3E\x27\x2F\x22\x21\x24<br>
EncodeForURL:&nbsp;%3Cscript%3E%3C%2Fscript%3E&nbsp;|&nbsp;%26%3C%3E%27%2F%22%21%24<br>
EncodeForCSS:&nbsp;\3c&nbsp;script\3e&nbsp;\3c&nbsp;\2f&nbsp;script\3e&nbsp;|&nbsp;\26&nbsp;\3c&nbsp;\3e&nbsp;\27&nbsp;\2f&nbsp;\22<br>
\21&nbsp;\24<br>
<br>
That&nbsp;seem&nbsp;a&nbsp;bit&nbsp;better..<br>
<br>
&lt;/pre&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/blockquote&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/body&gt;<br>
&lt;/html&gt;<br>

</tt>
