<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-java-encoder-project] Link Injection
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-java-encoder-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-java-encoder-project%5D%20Link%20Injection&In-Reply-To=%3CCAKAumBHoAPyxpkrwj1trfd-JFn_0z7%2BeX3Ajk6i%2BX2TJQmd2Rw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000001.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-java-encoder-project] Link Injection</H1>
    <B>Jeremy Long</B> 
    <A HREF="mailto:owasp-java-encoder-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-java-encoder-project%5D%20Link%20Injection&In-Reply-To=%3CCAKAumBHoAPyxpkrwj1trfd-JFn_0z7%2BeX3Ajk6i%2BX2TJQmd2Rw%40mail.gmail.com%3E"
       TITLE="[Owasp-java-encoder-project] Link Injection">jeremy.long at gmail.com
       </A><BR>
    <I>Tue Oct 22 01:05:01 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000001.html">[Owasp-java-encoder-project] Link Injection
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2">[ date ]</a>
              <a href="thread.html#2">[ thread ]</a>
              <a href="subject.html#2">[ subject ]</a>
              <a href="author.html#2">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Aaron,

Please provide a more specific example of what you want to do. Encoding for
content into links can be complicated; especially if you are allowing the
javascript protocol. My recommendation would be to completely avoid inline
script (i.e. the javascript protocol and all of the onclick, onerror, etc.
attributes). Instead utilize external JavaScript and hook the necessary
events. But I completely understand that not everyone gets to start green
field and build an application that can fully utilize CSP.

Consider looking at the DOM Based XSS cheatsheet's complex contexts:
<A HREF="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet#Complex_Contexts">https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet#Complex_Contexts</A>

If you are actually putting dynamic data into an href using the javascript
protocol you have to understand that the browser will first HTML Attribute
decode the entire URL, determine that it is using the javascript protocol,
then URL decode the data after the colon, and pass this data to the
JavaScript interpreter. So depending on your encoding library you may want
to follow the guidance from Romain Goucher @ Coverity and utilize
nested/layered encoding (
<A HREF="https://communities.coverity.com/blogs/security/2012/11/05/using-the-coverity-security-library-with-guidance-from-security-advisor">https://communities.coverity.com/blogs/security/2012/11/05/using-the-coverity-security-library-with-guidance-from-security-advisor</A>).
Or if you are using a robust encoder, which I believe the Java Encoder
Project is, you could just use the JavaScript encoding (depending of course
on the fact that the dynamic data is wrapped in quotes).

Hopefully that helps, if not please provide a more specific example
(including the location of the dynamic data you want to write out).

--Jeremy


On Mon, Oct 21, 2013 at 4:43 PM, Weaver, Aaron &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project">aaron.weaver at pearson.com</A>&gt;wrote:

&gt;<i> Quick question: What method do you recommend to encode for link injection?
</I>&gt;<i> For example:
</I>&gt;<i>
</I>&gt;<i> &lt;a href=&quot;javascript:alert(1)&quot;&gt;click here&lt;/a&gt;
</I>&gt;<i>
</I>&gt;<i> Thanks
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-java-encoder-project mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project">Owasp-java-encoder-project at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project">https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-java-encoder-project/attachments/20131021/de8ed09c/attachment.html">http://lists.owasp.org/pipermail/owasp-java-encoder-project/attachments/20131021/de8ed09c/attachment.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000001.html">[Owasp-java-encoder-project] Link Injection
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#2">[ date ]</a>
              <a href="thread.html#2">[ thread ]</a>
              <a href="subject.html#2">[ subject ]</a>
              <a href="author.html#2">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project">More information about the Owasp-java-encoder-project
mailing list</a><br>
</body></html>
