<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-java-encoder-project] JSON Output Encoding
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-java-encoder-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-java-encoder-project%5D%20JSON%20Output%20Encoding&In-Reply-To=%3C3b3b4dcc1b0d444d944a2331cac9c40c%40SVRP0004CB23.us.ups.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-java-encoder-project] JSON Output Encoding</H1>
    <B>rgural at ups.com</B> 
    <A HREF="mailto:owasp-java-encoder-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-java-encoder-project%5D%20JSON%20Output%20Encoding&In-Reply-To=%3C3b3b4dcc1b0d444d944a2331cac9c40c%40SVRP0004CB23.us.ups.com%3E"
       TITLE="[Owasp-java-encoder-project] JSON Output Encoding">rgural at ups.com
       </A><BR>
    <I>Fri Apr 27 12:33:13 UTC 2018</I>
    <P><UL>
        
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58">[ date ]</a>
              <a href="thread.html#58">[ thread ]</a>
              <a href="subject.html#58">[ subject ]</a>
              <a href="author.html#58">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>OWASP Java Encoder Project Team:
Hi &#8211; we are having trouble finding a standard library for JSON output encoding.  I was happy to see that OWASP had a program for output encoders to tackle common XSS exploits.  I was hoping there was one to handle our use case.

OWASP XSS (Cross Site Scripting) Prevention Cheat Sheet confirms what our InfoSec team is telling us for output encoding for JSON payloads, namely: [cid:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project">image001.png at 01D3DDFE.26043D00</A>]
Though this talks about JavaScript specifically, I&#8217;ve seen where it applies to JSON.  IETF RFC 8259 section 7 talks about the correctness of supplying \uXXXX substitution if necessary.
I saw that the org.owasp.encoder.Encode. forJavaScript method does include JSON in its scope (from JavaDoc):

&#183;         &#8220;public static String&lt;<A HREF="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html?is-external=true">http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html?is-external=true</A>&gt; forJavaScript(String&lt;<A HREF="http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html?is-external=true">http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html?is-external=true</A>&gt; input)

Encodes for a JavaScript string. It is safe for use in HTML script attributes (such as onclick), script blocks, JSON files, and JavaScript source.
&#8220;
However the encoding provided does not change the encoding for non-alphanumeric characters to \uXXXX form but instead I see some characters (but not all I was hoping for &#8211; though the document confirms the smaller scope) converted to \xDD form.  For instance:
String jSON = forJavascript(&quot;{\&quot;Name\&quot; : \&quot;!&lt;[(!@Evil_Script#$)]&gt;&#1042;&#1086;&#1085;&#1080; &#1085;&#1072;&#1076;&#1110;&#1083;&#1077;&#1085;&#1110; &#1088;&#1086;&#1079;&#1091;&#1084;&#1086;&#1084; &#1110; &#1089;&#1086;&#1074;&#1110;&#1089;&#1090;&#1102;&#22068;&#36967;&#17699;\&quot;}&quot;);
is converted to
Encoded JSON = {\x22Name\x22 : \x22!&lt;[(!@Evil_Script#$)]&gt;&#1042;&#1086;&#1085;&#1080; &#1085;&#1072;&#1076;&#1110;&#1083;&#1077;&#1085;&#1110; &#1088;&#1086;&#1079;&#1091;&#1084;&#1086;&#1084; &#1110; &#1089;&#1086;&#1074;&#1110;&#1089;&#1090;&#1102;&#22068;&#36967;&#17699;\x16\x22}

If there are no current encoders for JSON as described above, are there any plans to support a JSON encoder that can implement the XSS Prevention talked about above?  Does alphanumeric mean [a-z,A-Z,0-9] only or is it alphanumeric in any language?  Our InfoSec team interprets the meaning of the guidelines as the smaller alpha scope.  Any advice your members can provide would be of great benefit to us.
Thanks,
Roman
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-java-encoder-project/attachments/20180427/47fb15fa/attachment.html">http://lists.owasp.org/pipermail/owasp-java-encoder-project/attachments/20180427/47fb15fa/attachment.html</A>&gt;
-------------- next part --------------
A non-text attachment was scrubbed...
Name: image001.png
Type: image/png
Size: 4554 bytes
Desc: image001.png
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-java-encoder-project/attachments/20180427/47fb15fa/attachment.png">http://lists.owasp.org/pipermail/owasp-java-encoder-project/attachments/20180427/47fb15fa/attachment.png</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#58">[ date ]</a>
              <a href="thread.html#58">[ thread ]</a>
              <a href="subject.html#58">[ subject ]</a>
              <a href="author.html#58">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-java-encoder-project">More information about the Owasp-java-encoder-project
mailing list</a><br>
</body></html>
