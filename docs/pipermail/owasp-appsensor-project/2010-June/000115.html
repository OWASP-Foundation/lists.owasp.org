<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] [Esapi-dev] AppSensor &amp; ESAPI	Integration
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20%5BEsapi-dev%5D%20AppSensor%20%26%20ESAPI%0A%09Integration&In-Reply-To=4C1F96E8.3010809%40owasp.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000113.html">
   <LINK REL="Next"  HREF="000119.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] [Esapi-dev] AppSensor &amp; ESAPI	Integration</H1>
    <B>Kevin W. Wall</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20%5BEsapi-dev%5D%20AppSensor%20%26%20ESAPI%0A%09Integration&In-Reply-To=4C1F96E8.3010809%40owasp.org"
       TITLE="[Owasp-appsensor-project] [Esapi-dev] AppSensor &amp; ESAPI	Integration">kevin.w.wall at gmail.com
       </A><BR>
    <I>Tue Jun 22 08:02:13 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000113.html">[Owasp-appsensor-project] AppSensor &amp; ESAPI Integration
</A></li>
        <LI>Next message: <A HREF="000119.html">[Owasp-appsensor-project] [Esapi-dev] AppSensor &amp; ESAPI	Integration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#115">[ date ]</a>
              <a href="thread.html#115">[ thread ]</a>
              <a href="subject.html#115">[ subject ]</a>
              <a href="author.html#115">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Michael,

Michael Coates wrote:
&gt;<i> ESAPI Team,
</I>&gt;<i>
</I>&gt;<i> The AppSensor team has been working hard over the last several months to
</I>&gt;<i> create an AppSensor jar that is ready for ESAPI integration.
</I>&gt;<i>
</I>&gt;<i> AppSensor is a project to enable detailed attack intrusion and response
</I>&gt;<i> within application by integrating &quot;detection points&quot; into the
</I>&gt;<i> application itself (think detecting all access control failures,
</I>&gt;<i> malicious input, unexpected commands and more and then correlating that
</I>&gt;<i> against the logged in user and logging out/locking the attacker). That's
</I>&gt;<i> just the basics, more info on AppSensor here:
</I>&gt;<i> <A HREF="http://www.owasp.org/index.php/Category:OWASP_AppSensor_Project">http://www.owasp.org/index.php/Category:OWASP_AppSensor_Project</A>
</I>&gt;<i>
</I>&gt;<i> Here are the instructions for easily updating an existing ESAPI
</I>&gt;<i> application to use AppSensor. I encourage those interested to take a
</I>&gt;<i> quick read and respond with any comments.
</I>&gt;<i>
</I>&gt;<i> <A HREF="http://www.owasp.org/index.php/AppSensor_GettingStarted">http://www.owasp.org/index.php/AppSensor_GettingStarted</A>
</I>&gt;<i>
</I>&gt;<i> What's next:
</I>&gt;<i> 1. We'd like to use the Getting Started guide as an initial strategy for
</I>&gt;<i> users to begin leveraging AppSensor in their ESAPI apps. We're looking
</I>&gt;<i> for interested parties to begin using AppSensor within ESAPI and provide
</I>&gt;<i> their feedback.
</I>&gt;<i> 2. It would also be great for the ESAPI config to contain the
</I>&gt;<i> configuration line for AppSensor and a link to the getting started page.
</I>&gt;<i>
</I>&gt;<i> #Use OWASP AppSensor for enhanced application intrusion detection and
</I>&gt;<i> response
</I>&gt;<i> #See <A HREF="http://www.owasp.org/index.php/AppSensor_GettingStarted">http://www.owasp.org/index.php/AppSensor_GettingStarted</A> for
</I>&gt;<i> necessary JAR and configuration
</I>&gt;<i>
</I>#ESAPI.IntrusionDetector=org.owasp.appsensor.intrusiondetection.AppSensorIntrusionDetector
&gt;<i>
</I>&gt;<i> Thoughts and feedback please.
</I>
I've been following the AppSensor work for awhile now, but there has always
been a few points of confusion as it related to ESAPI and I suspect that other
ESAPI developers may have the same questions. Since I've really not dug into
AppSensor and done anything hands-on, my questions may be a bit naive, but
I'll hope you'll bare with my ignorance.

Anyhow, as you are no doubt aware, ESAPI also has a Web Application Firewall
(WAF) as one of its features. Do you see AppSensor as *replacing* this
built-in WAF or as augmenting it? If the former, what are the advantages of
using AppSensor rather than ESAPI's WAF feature? If it is to augment it, could
you explain how it does this because it would seem to me that there is a lot
of overlapping functionality. Is there some difference in _intent_?
Or is ESAPI's WAF simply a JavaEE Servlet Filter that invokes a more
rudimentary intrusion detector (DefaultIntrusionDetector) and
AppSensor is simply a more advanced version of an intrusion detector?

My second question is about the intrusion detection properties built into ESAPI.
Your Getting Started wiki page mentions replacing
ESAPI.IntrusionDetector=org.owasp.esapi.reference.DefaultIntrusionDetector
with
ESAPI.IntrusionDetector=org.owasp.appsensor.intrusiondetection.AppSensorIntrusionDetector

but there are also these other properties (see below). Do these properties also
control AppSensor or does it have it's own config file?

E.g., from the latest ESAPI.properties:

#===========================================================================
# ESAPI Intrusion Detection
#
# Each event has a base to which .count, .interval, and .action are added
# The IntrusionException will fire if we receive &quot;count&quot; events within
&quot;interval&quot; seconds
# The IntrusionDetector is configurable to take the following actions: log,
logout, and disable
#  (multiple actions separated by commas are allowed e.g.
event.test.actions=log,disable
#
# Custom Events
# Names must start with &quot;event.&quot; as the base
# Use IntrusionDetector.addEvent( &quot;test&quot; ) in your code to trigger &quot;event.test&quot; here
# You can also disable intrusion detection completely by changing
# the following parameter to true
#
IntrusionDetector.Disable=false
#
IntrusionDetector.event.test.count=2
IntrusionDetector.event.test.interval=10
IntrusionDetector.event.test.actions=disable,log

# Exception Events
# All EnterpriseSecurityExceptions are registered automatically
# Call IntrusionDetector.getInstance().addException(e) for Exceptions that do
not extend EnterpriseSecurityException
# Use the fully qualified classname of the exception as the base

# any intrusion is an attack
IntrusionDetector.org.owasp.esapi.errors.IntrusionException.count=1
IntrusionDetector.org.owasp.esapi.errors.IntrusionException.interval=1
IntrusionDetector.org.owasp.esapi.errors.IntrusionException.actions=log,disable,logout

# for test purposes
# CHECKME: Shouldn't there be something in the property name itself that designates
#		   that these are for testing???
IntrusionDetector.org.owasp.esapi.errors.IntegrityException.count=10
IntrusionDetector.org.owasp.esapi.errors.IntegrityException.interval=5
IntrusionDetector.org.owasp.esapi.errors.IntegrityException.actions=log,disable,logout

# rapid validation errors indicate scans or attacks in progress
# org.owasp.esapi.errors.ValidationException.count=10
# org.owasp.esapi.errors.ValidationException.interval=10
# org.owasp.esapi.errors.ValidationException.actions=log,logout

# sessions jumping between hosts indicates session hijacking
IntrusionDetector.org.owasp.esapi.errors.AuthenticationHostException.count=2
IntrusionDetector.org.owasp.esapi.errors.AuthenticationHostException.interval=10
IntrusionDetector.org.owasp.esapi.errors.AuthenticationHostException.actions=log,logout


#===========================================================================


Finally, a last question. It seems to me that some intrusion attempts can best
be detected from deep within ESAPI where the relevant context is available. A
good example of this is if someone were to be attempting a known ciphertext
attack on ESAPI's crypto, such as the Padded Oracle attack described by Rizzo
and Duong. In such cases, is adding explicit intrusion detection points required
or is it sufficient to just through some exception derived from ESAPI's
EnterpriseSecurityException class? In the case of crypto at least, there are
different things that can go wrong, but you need to be very careful not to
reveal what went long as that can leak information to an attacker leading to
a successful attack. (Such is the case with the Padded Oracle attack.)

Thanks,
-kevin
-- 
Kevin W. Wall
&quot;The most likely way for the world to be destroyed, most experts agree,
is by accident. That's where we come in; we're computer professionals.
We cause accidents.&quot;        -- Nathaniel Borenstein, co-creator of MIME
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000113.html">[Owasp-appsensor-project] AppSensor &amp; ESAPI Integration
</A></li>
	<LI>Next message: <A HREF="000119.html">[Owasp-appsensor-project] [Esapi-dev] AppSensor &amp; ESAPI	Integration
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#115">[ date ]</a>
              <a href="thread.html#115">[ thread ]</a>
              <a href="subject.html#115">[ subject ]</a>
              <a href="author.html#115">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
