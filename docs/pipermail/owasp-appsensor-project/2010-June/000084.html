<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Additional Detection Points -	Suspicious External User Behavior
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Additional%20Detection%20Points%20-%0A%09Suspicious%20External%20User%20Behavior&In-Reply-To=4C106DEC.6080907%40gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000077.html">
   <LINK REL="Next"  HREF="000089.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Additional Detection Points -	Suspicious External User Behavior</H1>
    <B>Colin Watson</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Additional%20Detection%20Points%20-%0A%09Suspicious%20External%20User%20Behavior&In-Reply-To=4C106DEC.6080907%40gmail.com"
       TITLE="[Owasp-appsensor-project] Additional Detection Points -	Suspicious External User Behavior">colin.watson at owasp.org
       </A><BR>
    <I>Thu Jun 10 04:53:17 EDT 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000077.html">[Owasp-appsensor-project] Additional Detection Points -	Suspicious External User Behavior
</A></li>
        <LI>Next message: <A HREF="000089.html">[Owasp-appsensor-project] Additional Detection Points - Suspicious External User Behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84">[ date ]</a>
              <a href="thread.html#84">[ thread ]</a>
              <a href="subject.html#84">[ subject ]</a>
              <a href="author.html#84">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>John and Kevin

I like &quot;navel gazing&quot; as a description!  I was thinking these were
external sensory feeds rather than the application itself doing the
sensing, and that would be rather different to the existing detection
points as you say.  But we do configure applications to run in each
environment, and therefore I wondered if there might be useful data
elsewhere that would help the application determine its response (e.g.
affect the thresholds).

I tried to make this detection point's description as broad as
possible, but that may not have helped.    It might be that some of
the existing sensors are more efficient if the data is collected
elsewhere (e.g. HTTP protocol analysis), or in some cases the data may
not be available directly to the application (e.g. missing static
content requests, but which the web server knows about).

But my first use-case would be to get data from a WAF.  For example,
ModSecurity can add an HTTP header with its transaction anomaly score
(X-WAF-Score).  This type of data is available from other WAFs too.
The response can then be determined by the application based on trends
and its other sensor data rather than the relatively crude WAF
response options.

The idea of more self-checks is interesting though.  I have previously
added code to ensure that dev/test/live applications settings couldn't
conflict with whether the site was on the public domain vs an internal
IP.  Code integrity... that would be interesting.

I wonder if we need an Appendix with experimental sensor ideas?  These
are good suggestions, and it would be a pity to lose the information.

Colin

On 10 June 2010 05:45, Kevin W. Wall &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">kevin.w.wall at gmail.com</A>&gt; wrote:
&gt;<i> While it is possible for an application to do its own sort of self-detection /
</I>&gt;<i> navel gazing (e.g., monitor its memory usage, # of threads, # of socket
</I>&gt;<i> connections, etc.) or monitor its own integrity (e.g., a static initializer
</I>&gt;<i> in a signed jar verifies the signature [not too hard to do] to see if the
</I>&gt;<i> jar has been tampered with since being signed), I agree with John that
</I>&gt;<i> typically these things are done by *external* monitoring rather than by
</I>&gt;<i> the application themselves.
</I>&gt;<i>
</I>&gt;<i> I suppose the benefit of doing it in some reusable code components (e.g., a jar,
</I>&gt;<i> a web service, etc.) is that is doesn't require any external set up. For
</I>&gt;<i> instance, if ESAPI for Java were to deliver a signed jar, how many developers
</I>&gt;<i> would actually take the time to verify the jar using 'jarsigner -verify' as
</I>&gt;<i> simple as this is. My bet...not too many. So in some cases, it might be useful
</I>&gt;<i> to have the &quot;application&quot; (or one of its components) do this sort of built-in
</I>&gt;<i> detection. (Disclaimer: I was planning something like this for a future version
</I>&gt;<i> of ESAPI.)
</I>&gt;<i>
</I>&gt;<i> Just my $.02,
</I>&gt;<i> -kevin
</I>&gt;<i>
</I>&gt;<i> John Melton wrote:
</I>&gt;&gt;<i> Not sure I'm on board with this one ... someone else can correct me if I'm
</I>&gt;&gt;<i> wrong, but this actually doesn't fit in the &quot;application&quot; doing detection.
</I>&gt;&gt;<i> By definition, something outside the app is doing the detection and is
</I>&gt;&gt;<i> feeding that info to the app. &#160;I think these are worthwhile sensors that can
</I>&gt;&gt;<i> produce data that an application could use to make decisions, but as for it
</I>&gt;&gt;<i> being considered app detection, I don't generally see these as falling into
</I>&gt;&gt;<i> that category. &#160;I may be convinced otherwise however :&gt;.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Wed, Jun 9, 2010 at 10:29 AM, Colin Watson &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">colin.watson at owasp.org</A>&gt;wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Suggestion to add a new detection point. &#160;Has this already been ruled
</I>&gt;&gt;&gt;<i> out? &#160;Should it be added? &#160;Is the description/categorization suitable?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Source
</I>&gt;&gt;&gt;<i> -----------------------------------
</I>&gt;&gt;&gt;<i> [Owasp-appsensor-project] AppSensor Feedback/Ideas, Sat Nov 21 13:32:39 EST
</I>&gt;&gt;&gt;<i> 2009
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/pipermail/owasp-appsensor-project">https://lists.owasp.org/pipermail/owasp-appsensor-project</A>
</I>&gt;&gt;&gt;<i> On Wed, Jun 9, 2010 at 10:29 AM, Colin Watson &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">colin.watson at owasp.org</A>&gt;wrote:
</I>&gt;&gt;&gt;<i> Suggestion to add a new detection point. &#160;Has this already been ruled
</I>&gt;&gt;&gt;<i> out? &#160;Should it be added? &#160;Is the description/categorization suitable?
</I>&gt;&gt;&gt;<i> /2009-November/000008.html&lt;<A HREF="https://lists.owasp.org/pipermail/owasp-appsensor-project/2009-November/000008.html">https://lists.owasp.org/pipermail/owasp-appsensor-project/2009-November/000008.html</A>&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Description
</I>&gt;&gt;&gt;<i> -----------------------------------
</I>&gt;&gt;&gt;<i> External (to the application) devices and systems (e.g. host and
</I>&gt;&gt;&gt;<i> network IDS, file integrity monitoring, disk usage monitoring,
</I>&gt;&gt;&gt;<i> anti-malware service, IPS, network firewall, web application firewall,
</I>&gt;&gt;&gt;<i> web server logging, XML gateway, database firewall, SIEM) have
</I>&gt;&gt;&gt;<i> detected anomalous behavior by the user (e.g. session or IP address).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Suggested categorization
</I>&gt;&gt;&gt;<i> -----------------------------------
</I>&gt;&gt;&gt;<i> In the suggested new category &quot;Reputation&quot; (see RP1 Suspicious User IP
</I>&gt;&gt;&gt;<i> Address)
</I>&gt;&gt;&gt;<i> RP2 Suspicious External User Behavior
</I>&gt;<i> --
</I>&gt;<i> Kevin W. Wall
</I>&gt;<i> &quot;The most likely way for the world to be destroyed, most experts agree,
</I>&gt;<i> is by accident. That's where we come in; we're computer professionals.
</I>&gt;<i> We cause accidents.&quot; &#160; &#160; &#160; &#160;-- Nathaniel Borenstein, co-creator of MIME
</I>&gt;<i>
</I></PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000077.html">[Owasp-appsensor-project] Additional Detection Points -	Suspicious External User Behavior
</A></li>
	<LI>Next message: <A HREF="000089.html">[Owasp-appsensor-project] Additional Detection Points - Suspicious External User Behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#84">[ date ]</a>
              <a href="thread.html#84">[ thread ]</a>
              <a href="subject.html#84">[ subject ]</a>
              <a href="author.html#84">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
