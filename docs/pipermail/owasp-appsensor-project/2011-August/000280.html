<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Implementing OWASP AppSensor Detection Points in the OWASP ModSecurity Core Rule Set
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Implementing%20OWASP%20AppSensor%20Detection%0A%20Points%20in%20the%20OWASP%20ModSecurity%20Core%20Rule%20Set&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000279.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Implementing OWASP AppSensor Detection Points in the OWASP ModSecurity Core Rule Set</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Implementing%20OWASP%20AppSensor%20Detection%0A%20Points%20in%20the%20OWASP%20ModSecurity%20Core%20Rule%20Set&In-Reply-To="
       TITLE="[Owasp-appsensor-project] Implementing OWASP AppSensor Detection Points in the OWASP ModSecurity Core Rule Set">ryan.barnett at owasp.org
       </A><BR>
    <I>Wed Aug 31 17:17:00 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000279.html">[Owasp-appsensor-project] Question about SE4: Substituting Another User's Valid Session ID or Cookie
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#280">[ date ]</a>
              <a href="thread.html#280">[ thread ]</a>
              <a href="subject.html#280">[ subject ]</a>
              <a href="author.html#280">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Please forgive the cross postings, but I wanted to make sure that all
relevant parties were informed of this update.  I have begun the process of
implementing the OWASP AppSensor Detection Points
(<A HREF="https://www.owasp.org/index.php/AppSensor_DetectionPoints">https://www.owasp.org/index.php/AppSensor_DetectionPoints</A>) within the OWASP
ModSecurity Core Rule Set
(<A HREF="https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Pr">https://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Pr</A>
oject).  

I am pleased to announce that I have just made an update to the OWASP CRS
SVN repository that fully implements the Request Exception (RE) category -
<A HREF="https://www.owasp.org/index.php/AppSensor_DetectionPoints#RequestException.">https://www.owasp.org/index.php/AppSensor_DetectionPoints#RequestException.</A>
See the following blog post for more details -
<A HREF="http://blog.spiderlabs.com/2011/08/implementing-appsensor-detection-points-i">http://blog.spiderlabs.com/2011/08/implementing-appsensor-detection-points-i</A>
n-modsecurity.html

The major change in this version vs. the earlier one outlined in this blog
post 
(<A HREF="http://blog.spiderlabs.com/2011/02/modsecurity-advanced-topic-of-the-week-r">http://blog.spiderlabs.com/2011/02/modsecurity-advanced-topic-of-the-week-r</A>
eal-time-application-profiling.html) is that both the profiling and
detection logic has been moved to Lua scripts.  With the increased logic
capabilities of Lua, we are now able to more accurately profile the
application in real-time by analyzing traffic and automatically generating
profiles for the following resource characteristics -
* Enforcing the expected Request Method(s)
* Enforce the number of expected parameters (min-max range)
* Enforce parameter names
* Enforce parameter lengths (min-max range)
* Enforce Character Classes
&gt;<i> * Flag (e.g. - /path/to/foo.php?param)
</I>&gt;<i> * Digits  (e.g. - /path/to/foo.php?param=1234)
</I>&gt;<i> * Alpha  (e.g. - /path/to/foo.php?param=abcd)
</I>&gt;<i> * AlphaNumeric  (e.g. - /path/to/foo.php?param=abcd1234)
</I>&gt;<i> * Email  (e.g. - /path/to/foo.php?param=<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">foo at bar.com</A>)
</I>&gt;<i> * Path  (e.g. - /path/to/foo.php?param=/dir/somefile.txt)
</I>&gt;<i> * URL  (e.g. - /path/to/foo.php?param=<A HREF="http://somehost/dir/file.txt">http://somehost/dir/file.txt</A>)
</I>&gt;<i> * SafeText  (e.g. - /path/to/foo.php?param=some_data-12)
</I>The updated rules files are in the /experimental_rules directory -
<A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/experi">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/experi</A>
mental_rules/
Look in the /lua folder to find the 2 scripts -
<A HREF="http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/lua/">http://mod-security.svn.sourceforge.net/viewvc/mod-security/crs/trunk/lua/</A>

I encourage people to test out these new rules and to report back their
experiences &#173; both good and bad.

FYI &#173; I also wanted to thank Josh Zlatin for assisting with the initial Lua
script creation.

Cheers.

--
Ryan Barnett
OWASP ModSecurity Core Rule Set Project Leader


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110831/d776cc3b/attachment.html">https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110831/d776cc3b/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000279.html">[Owasp-appsensor-project] Question about SE4: Substituting Another User's Valid Session ID or Cookie
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#280">[ date ]</a>
              <a href="thread.html#280">[ thread ]</a>
              <a href="subject.html#280">[ subject ]</a>
              <a href="author.html#280">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
