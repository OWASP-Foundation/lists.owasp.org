<tt>
Just&nbsp;wanted&nbsp;to&nbsp;point&nbsp;out&nbsp;2&nbsp;additional&nbsp;items. &nbsp;&lt;br&gt;-&nbsp;In&nbsp;reference&nbsp;to&nbsp;the&nbsp;config&nbsp;section&nbsp;from&nbsp;the&nbsp;ESAPI.properties&nbsp;file,&nbsp;AppSensor&nbsp;uses&nbsp;a&nbsp;class&nbsp;that&nbsp;reads&nbsp;in&nbsp;the&nbsp;ESAPI.properties&nbsp;file&nbsp;as&nbsp;well&nbsp;as&nbsp;the&nbsp;appsensor.properties&nbsp;file,&nbsp;and&nbsp;treats&nbsp;them&nbsp;as&nbsp;a&nbsp;merged&nbsp;list. &nbsp;Therefore,&nbsp;technically,&nbsp;the&nbsp;config&nbsp;for&nbsp;the&nbsp;threshold&nbsp;information&nbsp;could&nbsp;be&nbsp;in&nbsp;either&nbsp;file. &nbsp;&lt;br&gt;<br>
<br>
-&nbsp;The&nbsp;other&nbsp;point&nbsp;to&nbsp;note&nbsp;here&nbsp;is&nbsp;that&nbsp;AppSensor&nbsp;does&nbsp;use&nbsp;the&nbsp;same&nbsp;config&nbsp;format&nbsp;as&nbsp;the&nbsp;reference&nbsp;intrusion&nbsp;detector&nbsp;at&nbsp;the&nbsp;moment,&nbsp;and&nbsp;includes&nbsp;the&nbsp;same&nbsp;response&nbsp;actions&nbsp;(as&nbsp;well&nbsp;as&nbsp;some&nbsp;additional&nbsp;options). &nbsp;This&nbsp;means&nbsp;that&nbsp;if&nbsp;you&amp;#39;ve&nbsp;already&nbsp;configured&nbsp;thresholds&nbsp;for&nbsp;the&nbsp;various&nbsp;exception&nbsp;types,&nbsp;that&nbsp;data&nbsp;will&nbsp;continue&nbsp;to&nbsp;be&nbsp;used&nbsp;in&nbsp;the&nbsp;same&nbsp;way&nbsp;if&nbsp;you&nbsp;switch&nbsp;to&nbsp;using&nbsp;AppSensor. &nbsp;&lt;br&gt;<br>
<br>
Thanks,&lt;br&gt;John&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Tue,&nbsp;Jun&nbsp;22,&nbsp;2010&nbsp;at&nbsp;1:59&nbsp;PM,&nbsp;Michael&nbsp;Coates&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&amp;lt;&lt;a&nbsp;href=&quot;mailto:michael.coates@owasp.org&quot;&gt;michael.coates@owasp.org&lt;/a&gt;&amp;gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;border-left:&nbsp;1px&nbsp;solid&nbsp;rgb(204,&nbsp;204,&nbsp;204);&nbsp;margin:&nbsp;0pt&nbsp;0pt&nbsp;0pt&nbsp;0.8ex;&nbsp;padding-left:&nbsp;1ex;&quot;&gt;<br>
<br>
<br>
<br>
<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<br>
<br>
&lt;div&nbsp;bgcolor=&quot;#ffffff&quot;&nbsp;text=&quot;#000000&quot;&gt;<br>
Kevin,&lt;br&gt;<br>
&lt;br&gt;<br>
Thanks&nbsp;for&nbsp;your&nbsp;questions. &nbsp;My&nbsp;responses&nbsp;are&nbsp;below.&nbsp;By&nbsp;all&nbsp;means,&nbsp;keep<br>
the&nbsp;questions&nbsp;coming.&nbsp;We&nbsp;can&nbsp;use&nbsp;these&nbsp;questions&nbsp;to&nbsp;help&nbsp;build&nbsp;an&nbsp;FAQ<br>
to&nbsp;help&nbsp;others&nbsp;that&nbsp;are&nbsp;new&nbsp;to&nbsp;AppSensor.&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;pre&nbsp;cols=&quot;72&quot;&gt;Michael&nbsp;Coates<br>
OWASP&lt;/pre&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
&lt;br&gt;<br>
On&nbsp;6/22/10&nbsp;5:48&nbsp;AM,&nbsp;Jeff&nbsp;Williams&nbsp;wrote:<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<br>
&nbsp;&nbsp;<br>
<br>
&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&lt;p&gt;Here&amp;#39;s&nbsp;my&nbsp;understanding,&nbsp;but&nbsp;I&amp;#39;d&nbsp;really&nbsp;like<br>
to&nbsp;get<br>
Michael&amp;#39;s&nbsp;interpretation&nbsp;too.&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&nbsp;style=&quot;margin-left:&nbsp;0.5in;&quot;&gt;Do&nbsp;you&nbsp;see<br>
AppSensor&nbsp;as<br>
*replacing*&nbsp;this&nbsp;built-in&nbsp;WAF&nbsp;or&nbsp;as&nbsp;augmenting&nbsp;it?&nbsp;If&nbsp;the&nbsp;former,&nbsp;what<br>
are&nbsp;the<br>
advantages&nbsp;of&nbsp;using&nbsp;AppSensor&nbsp;rather&nbsp;than&nbsp;ESAPI&amp;#39;s&nbsp;WAF&nbsp;feature?&nbsp;If&nbsp;it&nbsp;is<br>
to&nbsp;augment<br>
it,&nbsp;could&nbsp;you&nbsp;explain&nbsp;how&nbsp;it&nbsp;does&nbsp;this&nbsp;because&nbsp;it&nbsp;would&nbsp;seem&nbsp;to&nbsp;me&nbsp;that<br>
there<br>
is&nbsp;a&nbsp;lot&nbsp;of&nbsp;overlapping&nbsp;functionality.&nbsp;Is&nbsp;there&nbsp;some&nbsp;difference&nbsp;in<br>
_intent_?&nbsp;Or<br>
is&nbsp;ESAPI&amp;#39;s&nbsp;WAF&nbsp;simply&nbsp;a&nbsp;JavaEE&nbsp;Servlet&nbsp;Filter&nbsp;that&nbsp;invokes&nbsp;a&nbsp;more<br>
rudimentary<br>
intrusion&nbsp;detector&nbsp;(DefaultIntrusionDetector)&nbsp;and&nbsp;AppSensor&nbsp;is&nbsp;simply&nbsp;a<br>
more<br>
advanced&nbsp;version&nbsp;of&nbsp;an&nbsp;intrusion&nbsp;detector?&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;Although&nbsp;there&nbsp;is&nbsp;a&nbsp;bit&nbsp;of&nbsp;overlap&nbsp;in&nbsp;the<br>
input<br>
validation&nbsp;area,&nbsp;there&nbsp;*&lt;b&gt;is&lt;/b&gt;*&nbsp;a&nbsp;difference&nbsp;in&nbsp;intent&nbsp;and<br>
capability.&nbsp;To<br>
me,&nbsp;the&nbsp;primary&nbsp;WAF&nbsp;use&nbsp;case&nbsp;is&nbsp;to&nbsp;block&nbsp;attacks&nbsp;with&nbsp;*&lt;b&gt;known&lt;/b&gt;*<br>
signatures<br>
(virtual&nbsp;patch).&nbsp;Of&nbsp;course&nbsp;it&nbsp;can&nbsp;do&nbsp;positive&nbsp;HTTP&nbsp;validation&nbsp;and&nbsp;other<br>
things<br>
as&nbsp;well.&nbsp;The&nbsp;IntrusionDetector,&nbsp;on&nbsp;the&nbsp;other&nbsp;hand&nbsp;can&nbsp;detect&nbsp;*&lt;b&gt;unknown&lt;/b&gt;*<br>
attacks<br>
using&nbsp;much&nbsp;more&nbsp;general&nbsp;heuristics&nbsp;and&nbsp;contextual&nbsp;information&nbsp;from&nbsp;the<br>
entire<br>
application,&nbsp;not&nbsp;just&nbsp;the&nbsp;request&nbsp;and&nbsp;response.&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&lt;/blockquote&gt;&lt;/div&gt;<br>
AppSensor&nbsp;can&nbsp;be&nbsp;seen&nbsp;as&nbsp;an&nbsp;enhanced&nbsp;alternative&nbsp;to&nbsp;ESAPI&amp;#39;s&nbsp;intrusion<br>
detector.&nbsp;AppSensor&nbsp;is&nbsp;not&nbsp;a&nbsp;replacement&nbsp;for&nbsp;the&nbsp;ESAPI&nbsp;WAF,&nbsp;nor&nbsp;is<br>
AppSensor&nbsp;a&nbsp;WAF&nbsp;at&nbsp;all. &nbsp;AppSensor&nbsp;works&nbsp;by&nbsp;deep&nbsp;integration&nbsp;into&nbsp;the<br>
application&nbsp;to&nbsp;identify&nbsp;custom&nbsp;application&nbsp;attacks&nbsp;that&nbsp;could&nbsp;not&nbsp;be<br>
detected&nbsp;by&nbsp;a&nbsp;WAF.&nbsp;A&nbsp;prime&nbsp;example&nbsp;is&nbsp;an&nbsp;access&nbsp;control&nbsp;violation&nbsp;via<br>
direct&nbsp;object&nbsp;tampering&lt;br&gt;<br>
&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.site.com?account=1234&quot;&nbsp;target=&quot;_blank&quot;&gt;www.site.com?account=1234&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;http://www.site.com?account=1235&quot;&nbsp;target=&quot;_blank&quot;&gt;www.site.com?account=1235&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;<br>
An&nbsp;attacker&nbsp;attempting&nbsp;to&nbsp;exploit&nbsp;weak&nbsp;access&nbsp;control&nbsp;policies&nbsp;may<br>
enumerate&nbsp;the&nbsp;direct&nbsp;object&nbsp;references&nbsp;to&nbsp;hopefully&nbsp;gain&nbsp;access&nbsp;to<br>
another&nbsp;account&amp;#39;s&nbsp;data.&nbsp;A&nbsp;good&nbsp;app&nbsp;will&nbsp;throw&nbsp;access&nbsp;control&nbsp;denied<br>
errors&nbsp;on&nbsp;each&nbsp;attempt.&nbsp;AppSensor&nbsp;is&nbsp;positioned&nbsp;within&nbsp;the&nbsp;application<br>
so&nbsp;that&nbsp;an&nbsp;AppSensor&nbsp;specific&nbsp;exception&nbsp;could&nbsp;also&nbsp;be&nbsp;created&nbsp;in&nbsp;this<br>
situation. &nbsp;This&nbsp;allows&nbsp;AppSensor&nbsp;to&nbsp;record&nbsp;the&nbsp;malicious&nbsp;event&nbsp;against<br>
the&nbsp;specific&nbsp;user.&nbsp;Once&nbsp;a&nbsp;defined&nbsp;threshold&nbsp;is&nbsp;reached,&nbsp;AppSensor&nbsp;logs<br>
out&nbsp;the&nbsp;user&nbsp;(or&nbsp;locks&nbsp;them,&nbsp;emails&nbsp;someone,&nbsp;whatever). &nbsp;This&nbsp;is&nbsp;the<br>
idea&nbsp;of&nbsp;AppSensor;&nbsp;placing&nbsp;detection&nbsp;points&nbsp;within&nbsp;the&nbsp;app&nbsp;to&nbsp;see<br>
attack&nbsp;activity&nbsp;that&nbsp;is&nbsp;specific&nbsp;and&nbsp;targeted&nbsp;to&nbsp;a&nbsp;unique&nbsp;app&nbsp;and&nbsp;then<br>
tie&nbsp;these&nbsp;actions&nbsp;back&nbsp;to&nbsp;the&nbsp;logged&nbsp;in&nbsp;user.&nbsp;These&nbsp;attacks&nbsp;are<br>
typically&nbsp;otherwise&nbsp;invisible&nbsp;to&nbsp;a&nbsp;WAF&nbsp;with&nbsp;no&nbsp;application&nbsp;specific<br>
knowledge&nbsp;and&nbsp;the&nbsp;WAF&nbsp;often&nbsp;lacks&nbsp;the&nbsp;ability&nbsp;to&nbsp;take&nbsp;action&nbsp;against<br>
the&nbsp;malicious&nbsp;user.&nbsp;All&nbsp;the&nbsp;detection&nbsp;points&nbsp;are&nbsp;listed&nbsp;here:<br>
&lt;a&nbsp;href=&quot;http://www.owasp.org/index.php/AppSensor_DetectionPoints&quot;&nbsp;target=&quot;_blank&quot;&gt;http://www.owasp.org/index.php/AppSensor_DetectionPoints&lt;/a&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&lt;p&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&nbsp;style=&quot;margin-left:&nbsp;0.5in;&quot;&gt;It&nbsp;seems&nbsp;to&nbsp;me<br>
that&nbsp;some<br>
intrusion&nbsp;attempts&nbsp;can&nbsp;best&nbsp;be&nbsp;detected&nbsp;from&nbsp;deep&nbsp;within&nbsp;ESAPI&nbsp;where<br>
the&nbsp;relevant<br>
context&nbsp;is&nbsp;available.&nbsp;A&nbsp;good&nbsp;example&nbsp;of&nbsp;this&nbsp;is&nbsp;if&nbsp;someone&nbsp;were&nbsp;to&nbsp;be<br>
attempting&nbsp;a&nbsp;known&nbsp;ciphertext&nbsp;attack&nbsp;on&nbsp;ESAPI&amp;#39;s&nbsp;crypto,&nbsp;such&nbsp;as&nbsp;the<br>
Padded<br>
Oracle&nbsp;attack&nbsp;described&nbsp;by&nbsp;Rizzo&nbsp;and&nbsp;Duong.&nbsp;In&nbsp;such&nbsp;cases,&nbsp;is&nbsp;adding<br>
explicit<br>
intrusion&nbsp;detection&nbsp;points&nbsp;required&nbsp;or&nbsp;is&nbsp;it&nbsp;sufficient&nbsp;to&nbsp;just&nbsp;through<br>
some<br>
exception&nbsp;derived&nbsp;from&nbsp;ESAPI&amp;#39;s&nbsp;EnterpriseSecurityException&nbsp;class?&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;This&nbsp;is&nbsp;exactly&nbsp;the&nbsp;contract&nbsp;that&nbsp;the<br>
IntrusionDetector<br>
(AppSensor)&nbsp;is&nbsp;intended&nbsp;to&nbsp;fulfill.&nbsp;The&nbsp;IntrusionDetector<br>
implementation&nbsp;is<br>
notified&nbsp;of &nbsp;all&nbsp;EnterpriseSecurityExceptions.&nbsp;The&nbsp;job&nbsp;of&nbsp;the&nbsp;detector<br>
is<br>
to&nbsp;identify&nbsp;attacks&nbsp;in&nbsp;that&nbsp;stream&nbsp;of&nbsp;events&nbsp;and&nbsp;respond&nbsp;to&nbsp;them&nbsp;in<br>
realtime.<br>
This&nbsp;type&nbsp;of&nbsp;attack&nbsp;could&nbsp;never&nbsp;be&nbsp;identified&nbsp;by&nbsp;the&nbsp;WAF.&lt;br&gt;<br>
&nbsp;&nbsp;&lt;br&gt;<br>
 --Jeff&lt;br&gt;<br>
&nbsp;&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Yep.&nbsp;This&nbsp;is&nbsp;the&nbsp;idea. &nbsp;Within&nbsp;the&nbsp;application&nbsp;cypto&amp;#39;s&nbsp;code&nbsp;you&nbsp;would<br>
perform&nbsp;sort&nbsp;of&nbsp;check&nbsp;for&nbsp;the&nbsp;padded&nbsp;oracle&nbsp;attack.&nbsp;If&nbsp;you&nbsp;detected<br>
this&nbsp;attack&nbsp;then&nbsp;you&nbsp;would&nbsp;add&nbsp;one&nbsp;more&nbsp;line&nbsp;to&nbsp;create&nbsp;the&nbsp;appsensor<br>
exception. &nbsp;At&nbsp;this&nbsp;point&nbsp;you&nbsp;could&nbsp;choose&nbsp;to&nbsp;also&nbsp;add&nbsp;a&nbsp;message&nbsp;to&nbsp;be<br>
displayed&nbsp;to&nbsp;the&nbsp;user,&nbsp;or&nbsp;just&nbsp;leave&nbsp;that&nbsp;blank. &nbsp;After&nbsp;this,&nbsp;the<br>
AppSensor&nbsp;code&nbsp;would&nbsp;take&nbsp;over&nbsp;to&nbsp;again&nbsp;record&nbsp;the&nbsp;attack&nbsp;event&nbsp;against<br>
the&nbsp;particular&nbsp;user&nbsp;and&nbsp;take&nbsp;responsive&nbsp;action&nbsp;if&nbsp;necessary.&lt;br&gt;<br>
&lt;br&gt;<br>
Pseudo&nbsp;Code&lt;br&gt;<br>
if&nbsp;(oracle&nbsp;padded&nbsp;attack){&lt;br&gt;<br>
<br>
&lt;pre&gt;new&nbsp;AppSensorException(&amp;quot;ECE1&amp;quot;,&nbsp;&amp;quot;(optional&nbsp;user&nbsp;msg)&nbsp;Sorry&nbsp;user,&nbsp;you&nbsp;are&nbsp;bad&amp;quot;,&nbsp;&amp;quot;(system&nbsp;log&nbsp;message)&nbsp;Attacker&nbsp;is&nbsp;attempting&nbsp;an&nbsp;Oracle&nbsp;Padded&nbsp;Attack);<br>
&lt;/pre&gt;&lt;div&nbsp;class=&quot;im&quot;&gt;<br>
} <br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;My&nbsp;second&nbsp;question&nbsp;is&nbsp;about&nbsp;the&nbsp;intrusion<br>
detection<br>
properties&nbsp;built&nbsp;into&nbsp;ESAPI.&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;Your&nbsp;Getting&nbsp;Started&nbsp;wiki&nbsp;page&nbsp;mentions<br>
replacing&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;ESAPI.IntrusionDetector=org.owasp.esapi.reference.DefaultIntrusionDetector&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;with&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;ESAPI.IntrusionDetector=org.owasp.appsensor.intrusiondetection.AppSensorIntrusionDetector&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;but&nbsp;there&nbsp;are&nbsp;also&nbsp;these&nbsp;other&nbsp;properties<br>
(see&nbsp;below).&nbsp;Do<br>
these&nbsp;properties&nbsp;also&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;control&nbsp;AppSensor&nbsp;or&nbsp;does&nbsp;it&nbsp;have&nbsp;it&amp;#39;s&nbsp;own<br>
config&nbsp;file?&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;br&gt;&lt;/div&gt;<br>
Good&nbsp;catch.&nbsp;We&nbsp;need&nbsp;to&nbsp;add&nbsp;a&nbsp;little&nbsp;more&nbsp;info&nbsp;here. &nbsp;After&nbsp;setting&nbsp;the<br>
intrusion&nbsp;detector&nbsp;to&nbsp;AppSensorIntrusionDetector&nbsp;then&nbsp;the&nbsp;user&nbsp;needs&nbsp;to<br>
customize&nbsp;the&nbsp;appsensor.properties&nbsp;document.&nbsp;This&nbsp;is&nbsp;basically&nbsp;an<br>
enhanced&nbsp;version&nbsp;of&nbsp;the&nbsp;ESAPI&nbsp;Intrusion&nbsp;Detection&nbsp;properties&nbsp;file. &nbsp;So<br>
essentially&nbsp;the&nbsp;portion&nbsp;of&nbsp;the&nbsp;ESAPI.properties&nbsp;file&nbsp;that&nbsp;you&amp;#39;ve<br>
mentioned&nbsp;below&nbsp;is&nbsp;no&nbsp;longer&nbsp;used&nbsp;by&nbsp;ESAPI&nbsp;(or&nbsp;AppSensor).&lt;div&gt;&lt;div&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;&lt;br&gt;<br>
&lt;blockquote&nbsp;type=&quot;cite&quot;&gt;<br>
&nbsp;&nbsp;&lt;div&gt;<br>
&nbsp;&nbsp;&lt;p&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;E.g.,&nbsp;from&nbsp;the&nbsp;latest&nbsp;ESAPI.properties:&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#===========================================================================&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;ESAPI&nbsp;Intrusion&nbsp;Detection&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;Each&nbsp;event&nbsp;has&nbsp;a&nbsp;base&nbsp;to&nbsp;which&nbsp;.count,<br>
.interval,&nbsp;and<br>
.action&nbsp;are&nbsp;added&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;The&nbsp;IntrusionException&nbsp;will&nbsp;fire&nbsp;if&nbsp;we<br>
receive<br>
&amp;quot;count&amp;quot;&nbsp;events&nbsp;within&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;&amp;quot;interval&amp;quot;&nbsp;seconds&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;The&nbsp;IntrusionDetector&nbsp;is&nbsp;configurable&nbsp;to<br>
take&nbsp;the<br>
following&nbsp;actions:&nbsp;log,&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;logout,&nbsp;and&nbsp;disable&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;# &nbsp;(multiple&nbsp;actions&nbsp;separated&nbsp;by&nbsp;commas&nbsp;are<br>
allowed<br>
e.g.&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;event.test.actions=log,disable&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;Custom&nbsp;Events&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;Names&nbsp;must&nbsp;start&nbsp;with&nbsp;&amp;quot;event.&amp;quot;&nbsp;as&nbsp;the&nbsp;base&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;Use&nbsp;IntrusionDetector.addEvent(&nbsp;&amp;quot;test&amp;quot;&nbsp;)&nbsp;in<br>
your&nbsp;code&nbsp;to&nbsp;trigger&nbsp;&amp;quot;event.test&amp;quot;&nbsp;here&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;You&nbsp;can&nbsp;also&nbsp;disable&nbsp;intrusion&nbsp;detection<br>
completely&nbsp;by<br>
changing&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;the&nbsp;following&nbsp;parameter&nbsp;to&nbsp;true&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.Disable=false&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.event.test.count=2&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.event.test.interval=10&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.event.test.actions=disable,log&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;Exception&nbsp;Events&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;All&nbsp;EnterpriseSecurityExceptions&nbsp;are<br>
registered<br>
automatically&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;Call<br>
IntrusionDetector.getInstance().addException(e)<br>
for&nbsp;Exceptions&nbsp;that&nbsp;do&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;not&nbsp;extend&nbsp;EnterpriseSecurityException&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;Use&nbsp;the&nbsp;fully&nbsp;qualified&nbsp;classname&nbsp;of&nbsp;the<br>
exception&nbsp;as<br>
the&nbsp;base&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;any&nbsp;intrusion&nbsp;is&nbsp;an&nbsp;attack&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.IntrusionException.count=1&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.IntrusionException.interval=1&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.IntrusionException.actions=log,disable,logout&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;for&nbsp;test&nbsp;purposes&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;CHECKME:&nbsp;Shouldn&amp;#39;t&nbsp;there&nbsp;be&nbsp;something&nbsp;in<br>
the&nbsp;property<br>
name&nbsp;itself&nbsp;that&nbsp;designates&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#          &nbsp;  <br>
that&nbsp;these&nbsp;are&nbsp;for&nbsp;testing???&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.IntegrityException.count=10&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.IntegrityException.interval=5&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.IntegrityException.actions=log,disable,logout&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;rapid&nbsp;validation&nbsp;errors&nbsp;indicate&nbsp;scans&nbsp;or<br>
attacks&nbsp;in<br>
progress&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#<br>
org.owasp.esapi.errors.ValidationException.count=10&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#<br>
org.owasp.esapi.errors.ValidationException.interval=10&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#<br>
org.owasp.esapi.errors.ValidationException.actions=log,logout&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#&nbsp;sessions&nbsp;jumping&nbsp;between&nbsp;hosts&nbsp;indicates<br>
session<br>
hijacking&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.AuthenticationHostException.count=2&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.AuthenticationHostException.interval=10&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;IntrusionDetector.org.owasp.esapi.errors.AuthenticationHostException.actions=log,logout&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;#===========================================================================&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;Finally,&nbsp;a&nbsp;last&nbsp;question.&nbsp;It&nbsp;seems&nbsp;to&nbsp;me&nbsp;that<br>
some<br>
intrusion&nbsp;attempts&nbsp;can&nbsp;best&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;be&nbsp;detected&nbsp;from&nbsp;deep&nbsp;within&nbsp;ESAPI&nbsp;where&nbsp;the<br>
relevant<br>
context&nbsp;is&nbsp;available.&nbsp;A&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;good&nbsp;example&nbsp;of&nbsp;this&nbsp;is&nbsp;if&nbsp;someone&nbsp;were&nbsp;to&nbsp;be<br>
attempting<br>
a&nbsp;known&nbsp;ciphertext&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;attack&nbsp;on&nbsp;ESAPI&amp;#39;s&nbsp;crypto,&nbsp;such&nbsp;as&nbsp;the&nbsp;Padded<br>
Oracle<br>
attack&nbsp;described&nbsp;by&nbsp;Rizzo&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;and&nbsp;Duong.&nbsp;In&nbsp;such&nbsp;cases,&nbsp;is&nbsp;adding&nbsp;explicit<br>
intrusion<br>
detection&nbsp;points&nbsp;required&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;or&nbsp;is&nbsp;it&nbsp;sufficient&nbsp;to&nbsp;just&nbsp;through&nbsp;some<br>
exception<br>
derived&nbsp;from&nbsp;ESAPI&amp;#39;s&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;EnterpriseSecurityException&nbsp;class?&nbsp;In&nbsp;the<br>
case&nbsp;of&nbsp;crypto<br>
at&nbsp;least,&nbsp;there&nbsp;are&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;different&nbsp;things&nbsp;that&nbsp;can&nbsp;go&nbsp;wrong,&nbsp;but&nbsp;you<br>
need&nbsp;to&nbsp;be<br>
very&nbsp;careful&nbsp;not&nbsp;to&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;reveal&nbsp;what&nbsp;went&nbsp;long&nbsp;as&nbsp;that&nbsp;can&nbsp;leak<br>
information&nbsp;to&nbsp;an<br>
attacker&nbsp;leading&nbsp;to&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;a&nbsp;successful&nbsp;attack.&nbsp;(Such&nbsp;is&nbsp;the&nbsp;case&nbsp;with<br>
the&nbsp;Padded<br>
Oracle&nbsp;attack.)&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt; &lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;Thanks,&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;-kevin&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;--&nbsp;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;Kevin&nbsp;W.&nbsp;Wall&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;&amp;quot;The&nbsp;most&nbsp;likely&nbsp;way&nbsp;for&nbsp;the&nbsp;world&nbsp;to&nbsp;be<br>
destroyed,<br>
most&nbsp;experts&nbsp;agree,&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;is&nbsp;by&nbsp;accident.&nbsp;That&amp;#39;s&nbsp;where&nbsp;we&nbsp;come&nbsp;in;<br>
we&amp;#39;re&nbsp;computer<br>
professionals.&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;We&nbsp;cause<br>
accidents.&amp;quot;       &nbsp;--&nbsp;Nathaniel<br>
Borenstein,&nbsp;co-creator&nbsp;of&nbsp;MIME&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;_______________________________________________&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;Esapi-dev&nbsp;mailing&nbsp;list&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;&lt;a&nbsp;href=&quot;mailto:Esapi-dev@lists.owasp.org&quot;&nbsp;target=&quot;_blank&quot;&gt;Esapi-dev@lists.owasp.org&lt;/a&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;p&gt;&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/esapi-dev&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/esapi-dev&lt;/a&gt;&lt;/p&gt;<br>
&nbsp;&nbsp;&lt;/div&gt;<br>
&lt;/blockquote&gt;<br>
&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>
<br>
&lt;br&gt;_______________________________________________&lt;br&gt;<br>
Esapi-dev&nbsp;mailing&nbsp;list&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;mailto:Esapi-dev@lists.owasp.org&quot;&gt;Esapi-dev@lists.owasp.org&lt;/a&gt;&lt;br&gt;<br>
&lt;a&nbsp;href=&quot;https://lists.owasp.org/mailman/listinfo/esapi-dev&quot;&nbsp;target=&quot;_blank&quot;&gt;https://lists.owasp.org/mailman/listinfo/esapi-dev&lt;/a&gt;&lt;br&gt;<br>
&lt;br&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;<br>

</tt>
