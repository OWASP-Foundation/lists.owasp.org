<tt>
&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&nbsp;style=&quot;word-wrap:&nbsp;break-word;&nbsp;-webkit-nbsp-mode:&nbsp;space;&nbsp;-webkit-line-break:&nbsp;after-white-space;&nbsp;color:&nbsp;rgb(0,&nbsp;0,&nbsp;0);&nbsp;font-size:&nbsp;14px;&nbsp;font-family:&nbsp;Calibri,&nbsp;sans-serif;&nbsp;&quot;&gt;&lt;div&gt;I&nbsp;wanted&nbsp;to&nbsp;share&nbsp;a&nbsp;blog&nbsp;post&nbsp;I&nbsp;did&nbsp;yesterday&nbsp;that&nbsp;would&nbsp;be&nbsp;a&nbsp;good&nbsp;reference&nbsp;for&nbsp;Example&nbsp;5&nbsp;of&nbsp;RP3:&nbsp;Suspicious&nbsp;Client-side&nbsp;Behavior&nbsp;-&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;https://www.owasp.org/index.php/AppSensor_DetectionPoints#RP3:_Suspicious_Client-Side_Behavior&quot;&gt;https://www.owasp.org/index.php/AppSensor_DetectionPoints#RP3:_Suspicious_Client-Side_Behavior&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Here&nbsp;is&nbsp;the&nbsp;blog&nbsp;post&nbsp;-&nbsp;&lt;/div&gt;&lt;div&gt;&lt;a&nbsp;href=&quot;http://blog.spiderlabs.com/2013/07/modsecurity-advanced-topic-of-the-week-detecting-banking-trojan-page-modifications.html&quot;&gt;http://blog.spiderlabs.com/2013/07/modsecurity-advanced-topic-of-the-week-detecting-banking-trojan-page-modifications.html&lt;/a&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;It&nbsp;uses&nbsp;ModSecurity&nbsp;to&nbsp;send&nbsp;down&nbsp;defensive&nbsp;JS&nbsp;code&nbsp;when&nbsp;banking&nbsp;clients&nbsp;access&nbsp;the&nbsp;login&nbsp;page.&nbsp;&nbsp;The&nbsp;JS&nbsp;code&nbsp;will&nbsp;then&nbsp;initiate&nbsp;an&nbsp;XHR&nbsp;request&nbsp;back&nbsp;to&nbsp;the&nbsp;app&nbsp;for&nbsp;the&nbsp;same&nbsp;page.&nbsp;&nbsp;This&nbsp;time,&nbsp;however,&nbsp;ModSecurity&nbsp;creates&nbsp;a&nbsp;Hash&nbsp;of&nbsp;the&nbsp;valid&nbsp;response&nbsp;body&nbsp;and&nbsp;adds&nbsp;this&nbsp;as&nbsp;a&nbsp;new&nbsp;response&nbsp;header&nbsp;called&nbsp;&quot;WebTripWireHash&quot;.&nbsp;&nbsp;When&nbsp;the&nbsp;XHR&nbsp;response&nbsp;is&nbsp;received,&nbsp;the&nbsp;JS&nbsp;code&nbsp;then&nbsp;locally&nbsp;calculates&nbsp;another&nbsp;Hash&nbsp;and&nbsp;compares&nbsp;it&nbsp;with&nbsp;the&nbsp;WebTripWireHash&nbsp;value&nbsp;sent&nbsp;by&nbsp;ModSecurity.&nbsp;&nbsp;If&nbsp;a&nbsp;baning&nbsp;trojan&nbsp;has&nbsp;modified&nbsp;the&nbsp;login&nbsp;page&nbsp;HTML&nbsp;to&nbsp;attempt&nbsp;to&nbsp;phish&nbsp;extra&nbsp;data&nbsp;from&nbsp;the&nbsp;user&nbsp;then&nbsp;this&nbsp;will&nbsp;catch&nbsp;it.&nbsp;&nbsp;The&nbsp;JS&nbsp;code&nbsp;then&nbsp;issues&nbsp;an&nbsp;alert&nbsp;pop-up&nbsp;warning&nbsp;the&nbsp;user&nbsp;and&nbsp;sends&nbsp;another&nbsp;XHR&nbsp;request&nbsp;back&nbsp;to&nbsp;the&nbsp;web&nbsp;server/ModSecurity&nbsp;to&nbsp;notify&nbsp;of&nbsp;the&nbsp;issue.&nbsp;&nbsp;This&nbsp;is&nbsp;somewhat&nbsp;similar&nbsp;in&nbsp;theory&nbsp;to&nbsp;a&nbsp;CSP&nbsp;violation&nbsp;report&nbsp;request.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;This&nbsp;may&nbsp;be&nbsp;a&nbsp;good&nbsp;reference&nbsp;link&nbsp;to&nbsp;include&nbsp;for&nbsp;Example&nbsp;5.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Thoughts/Comments?&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;-Ryan&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;<br>

</tt>
