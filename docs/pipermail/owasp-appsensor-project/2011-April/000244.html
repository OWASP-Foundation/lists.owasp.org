<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To=BANLkTi%3DwdfbrTArOyLSyhAO_hHVJSe%2Bi6w%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000243.html">
   <LINK REL="Next"  HREF="000245.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To=BANLkTi%3DwdfbrTArOyLSyhAO_hHVJSe%2Bi6w%40mail.gmail.com"
       TITLE="[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?">ryan.barnett at owasp.org
       </A><BR>
    <I>Thu Apr 14 20:53:36 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000243.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
        <LI>Next message: <A HREF="000245.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#244">[ date ]</a>
              <a href="thread.html#244">[ thread ]</a>
              <a href="subject.html#244">[ subject ]</a>
              <a href="author.html#244">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>With the OWASP ModSecurity CRS users can choose to run the rules in either traditional or anomaly scoring mode - <A HREF="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html</A>

If they run it in anomaly scoring mode - then it is similar to what you describe as all rules get a chance to analyze the data and generate alerts. 

If they choose traditional mode however, it acts like an IPS and a matching rule will trigger a block. In this case then the ordering of the rules is important. 

I suppose we could just keep the detection points the way they are and I could just list RE2 before RE1 in the CRS.

Ryan

On Apr 14, 2011, at 8:24 PM, Dennis Groves &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>&gt; wrote:

&gt;<i> My take is that when for example a request is received the pattern is that the OWASP AppSensor runs a 'detection' at that point in the code; it thus does a case statement based on the exception thrown and raises the appropriate alert or alerts to the analysis engine (in my case a stochastic analysis engine that statistically profiles exceptions) and then responds/defendes according to the output of the analysis engine... so I am not sure why the rules would be 'static' or 'linear' and require any sort of order.
</I>&gt;<i> 
</I>&gt;<i> Does this make sense?
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Dennis Groves, MSc
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Thu, Apr 14, 2011 at 8:00 PM, Michael Coates &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">michael.coates at owasp.org</A>&gt; wrote:
</I>&gt;<i> Seems fair to me. When I originally created the events I didn't put much thought into the  numbers and any sort of timelines.  Your suggestion makes sense.
</I>&gt;<i> 
</I>&gt;<i> Michael Coates
</I>&gt;<i> OWASP
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> On Apr 14, 2011, at 11:19 AM, Ryan Barnett wrote:
</I>&gt;<i> 
</I>&gt;<i> &gt; Question for you all &#8211; I am updating the OWASP CRS for more coverage of AppSensor Detection Points.  I am working through these step by step.  When reviewing RE1 and RE2 &#8211; it seems to me like the detection logic for these should be switched.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; RE1 should be the initial check to see if a request method submitted is not a valid one at all per the RFC.  So, if someone sends JUNK or TEST as the request method, then RE1 would trigger.
</I>&gt;<i> &gt; RE2 should then be the check to see if the request method submitted is not one that is expected for the current resource (expecting a POST but receiving a GET).
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; The reason why I came to this conclusion is that when implementing these rules in ModSecurity, if we keep the current ordering and using blocking, RE2 would never trigger as an unknown HTTP Request method would first violate RE1.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; To summarize &#8211; I think the detection logic of these two are fine but that the detection point labels should be switched.
</I>&gt;<i> &gt;
</I>&gt;<i> &gt; -Ryan
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; Owasp-appsensor-project mailing list
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;<i> &gt; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;<i> 
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110414/b6ca6c8b/attachment.html">https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110414/b6ca6c8b/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000243.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
	<LI>Next message: <A HREF="000245.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#244">[ date ]</a>
              <a href="thread.html#244">[ thread ]</a>
              <a href="subject.html#244">[ subject ]</a>
              <a href="author.html#244">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
