<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000240.html">
   <LINK REL="Next"  HREF="000242.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To="
       TITLE="[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?">ryan.barnett at owasp.org
       </A><BR>
    <I>Thu Apr 14 14:19:51 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000240.html">[Owasp-appsensor-project] Added RP3 Detection Point in ModSecurity	CRS
</A></li>
        <LI>Next message: <A HREF="000242.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#241">[ date ]</a>
              <a href="thread.html#241">[ thread ]</a>
              <a href="subject.html#241">[ subject ]</a>
              <a href="author.html#241">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Question for you all &#173; I am updating the OWASP CRS for more coverage of
AppSensor Detection Points.  I am working through these step by step.  When
reviewing RE1 and RE2 &#173; it seems to me like the detection logic for these
should be switched.

RE1 should be the initial check to see if a request method submitted is not
a valid one at all per the RFC.  So, if someone sends JUNK or TEST as the
request method, then RE1 would trigger.
RE2 should then be the check to see if the request method submitted is not
one that is expected for the current resource (expecting a POST but
receiving a GET).

The reason why I came to this conclusion is that when implementing these
rules in ModSecurity, if we keep the current ordering and using blocking,
RE2 would never trigger as an unknown HTTP Request method would first
violate RE1.

To summarize &#173; I think the detection logic of these two are fine but that
the detection point labels should be switched.

-Ryan


-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110414/ec1a13f2/attachment.html">https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110414/ec1a13f2/attachment.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000240.html">[Owasp-appsensor-project] Added RP3 Detection Point in ModSecurity	CRS
</A></li>
	<LI>Next message: <A HREF="000242.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#241">[ date ]</a>
              <a href="thread.html#241">[ thread ]</a>
              <a href="subject.html#241">[ subject ]</a>
              <a href="author.html#241">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
