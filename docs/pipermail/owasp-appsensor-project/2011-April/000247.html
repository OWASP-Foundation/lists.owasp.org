<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To=BANLkTi%3DBgD0WziEgL_fa27%2BMa-o4e3%3DgsA%40mail.gmail.com">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000246.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To=BANLkTi%3DBgD0WziEgL_fa27%2BMa-o4e3%3DgsA%40mail.gmail.com"
       TITLE="[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?">ryan.barnett at owasp.org
       </A><BR>
    <I>Fri Apr 15 08:05:57 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000246.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#247">[ date ]</a>
              <a href="thread.html#247">[ thread ]</a>
              <a href="subject.html#247">[ subject ]</a>
              <a href="author.html#247">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Agreed. I will just put RE2 before RE1 in the rules file and it should work fine in either mode. 

Thanks guys. 
Ryan

On Apr 15, 2011, at 7:57 AM, Colin Watson &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">colin.watson at owasp.org</A>&gt; wrote:

&gt;<i> I agree with the replies above.  I sort of read RE1 to mean it was a
</I>&gt;<i> supported method, but not for this particular entry point (e.g. PUT),
</I>&gt;<i> whereas RE2 is just some weird method name (e.g. PLACEORSOMETHING).
</I>&gt;<i> 
</I>&gt;<i> But I don't think we should change the naming of RE1 and RE2 because:
</I>&gt;<i> 
</I>&gt;<i> - if people have already referenced them, it will cause confusion
</I>&gt;<i> 
</I>&gt;<i> - the naming/numbering is not meant to be imply ordering
</I>&gt;<i> 
</I>&gt;<i> - you might want to know them all
</I>&gt;<i> 
</I>&gt;<i> - other systems/applications/WAFs might just have other detection
</I>&gt;<i> points earlier in the chain (e.g. ACE3 - Forced browsing, where the
</I>&gt;<i> application's entry points are being enforced, EE2 - unexpected
</I>&gt;<i> encoding)
</I>&gt;<i> 
</I>&gt;<i> So it may be important for CRS, but it isn't for the concept.  It's an
</I>&gt;<i> important issue to think about though.
</I>&gt;<i> 
</I>&gt;<i> Colin
</I>&gt;<i> 
</I>&gt;<i> On 15 April 2011 11:41, Dennis Groves &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I suppose of order is important for one mode, that we should very likely list them in that order so that people whom copy and don't think still gain the protections prescribed. However, we should also provided a statement explaining that when running in 'traditional mode' the rule order is significant.
</I>&gt;&gt;<i> And since 'Anomaly mode' is agnostic to the order it really doesn't matter. ;-)
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Dennis Groves, MSc
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Fri, Apr 15, 2011 at 1:53 AM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">ryan.barnett at owasp.org</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> With the OWASP ModSecurity CRS users can choose to run the rules in either traditional or anomaly scoring mode - <A HREF="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html</A>
</I>&gt;&gt;&gt;<i> If they run it in anomaly scoring mode - then it is similar to what you describe as all rules get a chance to analyze the data and generate alerts.
</I>&gt;&gt;&gt;<i> If they choose traditional mode however, it acts like an IPS and a matching rule will trigger a block. In this case then the ordering of the rules is important.
</I>&gt;&gt;&gt;<i> I suppose we could just keep the detection points the way they are and I could just list RE2 before RE1 in the CRS.
</I>&gt;&gt;&gt;<i> Ryan
</I>&gt;&gt;&gt;<i> On Apr 14, 2011, at 8:24 PM, Dennis Groves &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> My take is that when for example a request is received the pattern is that the OWASP AppSensor runs a 'detection' at that point in the code; it thus does a case statement based on the exception thrown and raises the appropriate alert or alerts to the analysis engine (in my case a stochastic analysis engine that statistically profiles exceptions) and then responds/defendes according to the output of the analysis engine... so I am not sure why the rules would be 'static' or 'linear' and require any sort of order.
</I>&gt;&gt;&gt;<i> Does this make sense?
</I>&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;<i> Dennis Groves, MSc
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> On Thu, Apr 14, 2011 at 8:00 PM, Michael Coates &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">michael.coates at owasp.org</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Seems fair to me. When I originally created the events I didn't put much thought into the  numbers and any sort of timelines.  Your suggestion makes sense.
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> Michael Coates
</I>&gt;&gt;&gt;&gt;<i> OWASP
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> On Apr 14, 2011, at 11:19 AM, Ryan Barnett wrote:
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> Question for you all &#8211; I am updating the OWASP CRS for more coverage of AppSensor Detection Points.  I am working through these step by step.  When reviewing RE1 and RE2 &#8211; it seems to me like the detection logic for these should be switched.
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> RE1 should be the initial check to see if a request method submitted is not a valid one at all per the RFC.  So, if someone sends JUNK or TEST as the request method, then RE1 would trigger.
</I>&gt;&gt;&gt;&gt;&gt;<i> RE2 should then be the check to see if the request method submitted is not one that is expected for the current resource (expecting a POST but receiving a GET).
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> The reason why I came to this conclusion is that when implementing these rules in ModSecurity, if we keep the current ordering and using blocking, RE2 would never trigger as an unknown HTTP Request method would first violate RE1.
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> To summarize &#8211; I think the detection logic of these two are fine but that the detection point labels should be switched.
</I>&gt;&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;&gt;<i> -Ryan
</I>&gt;&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;&gt;<i> 
</I></PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000246.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#247">[ date ]</a>
              <a href="thread.html#247">[ thread ]</a>
              <a href="subject.html#247">[ subject ]</a>
              <a href="author.html#247">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
