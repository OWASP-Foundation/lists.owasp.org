<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To=5556D540-9254-4E61-99BD-69F41DDCCB19%40owasp.org">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000244.html">
   <LINK REL="Next"  HREF="000246.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?</H1>
    <B>Dennis Groves</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20Should%20RE1%20and%20RE2%20detection%20logic%20be%0A%09switched%3F&In-Reply-To=5556D540-9254-4E61-99BD-69F41DDCCB19%40owasp.org"
       TITLE="[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?">dennis.groves at owasp.org
       </A><BR>
    <I>Fri Apr 15 06:41:52 EDT 2011</I>
    <P><UL>
        <LI>Previous message: <A HREF="000244.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
        <LI>Next message: <A HREF="000246.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#245">[ date ]</a>
              <a href="thread.html#245">[ thread ]</a>
              <a href="subject.html#245">[ subject ]</a>
              <a href="author.html#245">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I suppose of order is important for one mode, that we should very likely
list them in that order so that people whom copy and don't think still gain
the protections prescribed. However, we should also provided a statement
explaining that when running in 'traditional mode' the rule order is
significant.

And since 'Anomaly mode' is agnostic to the order it really doesn't matter.
;-)

-- 
Dennis Groves, MSc
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>

 &lt;<A HREF="http://www.owasp.org/">http://www.owasp.org/</A>&gt;



On Fri, Apr 15, 2011 at 1:53 AM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">ryan.barnett at owasp.org</A>&gt;wrote:

&gt;<i> With the OWASP ModSecurity CRS users can choose to run the rules in either
</I>&gt;<i> traditional or anomaly scoring mode - &lt;<A HREF="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html</A>&gt;
</I>&gt;<i> <A HREF="http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html">http://blog.spiderlabs.com/2010/11/advanced-topic-of-the-week-traditional-vs-anomaly-scoring-detection-modes.html</A>
</I>&gt;<i>
</I>&gt;<i> If they run it in anomaly scoring mode - then it is similar to what you
</I>&gt;<i> describe as all rules get a chance to analyze the data and generate alerts.
</I>&gt;<i>
</I>&gt;<i> If they choose traditional mode however, it acts like an IPS and a matching
</I>&gt;<i> rule will trigger a block. In this case then the ordering of the rules is
</I>&gt;<i> important.
</I>&gt;<i>
</I>&gt;<i> I suppose we could just keep the detection points the way they are and I
</I>&gt;<i> could just list RE2 before RE1 in the CRS.
</I>&gt;<i>
</I>&gt;<i> Ryan
</I>&gt;<i>
</I>&gt;<i> On Apr 14, 2011, at 8:24 PM, Dennis Groves &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i>
</I>&gt;<i> My take is that when for example a request is received the pattern is that
</I>&gt;<i> the OWASP AppSensor runs a 'detection' at that point in the code; it thus
</I>&gt;<i> does a case statement based on the exception thrown and raises
</I>&gt;<i> the appropriate alert or alerts to the analysis engine (in my case a
</I>&gt;<i> stochastic analysis engine that statistically profiles exceptions) and then
</I>&gt;<i> responds/defendes according to the output of the analysis engine... so I am
</I>&gt;<i> not sure why the rules would be 'static' or 'linear' and require any sort of
</I>&gt;<i> order.
</I>&gt;<i>
</I>&gt;<i> Does this make sense?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i> Dennis Groves, MSc
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">dennis.groves at owasp.org</A>
</I>&gt;<i>
</I>&gt;<i>  &lt;<A HREF="http://www.owasp.org/">http://www.owasp.org/</A>&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Thu, Apr 14, 2011 at 8:00 PM, Michael Coates &lt;&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">michael.coates at owasp.org</A>&gt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">michael.coates at owasp.org</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Seems fair to me. When I originally created the events I didn't put much
</I>&gt;&gt;<i> thought into the  numbers and any sort of timelines.  Your suggestion makes
</I>&gt;&gt;<i> sense.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Michael Coates
</I>&gt;&gt;<i> OWASP
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Apr 14, 2011, at 11:19 AM, Ryan Barnett wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> &gt; Question for you all &#8211; I am updating the OWASP CRS for more coverage of
</I>&gt;&gt;<i> AppSensor Detection Points.  I am working through these step by step.  When
</I>&gt;&gt;<i> reviewing RE1 and RE2 &#8211; it seems to me like the detection logic for these
</I>&gt;&gt;<i> should be switched.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; RE1 should be the initial check to see if a request method submitted is
</I>&gt;&gt;<i> not a valid one at all per the RFC.  So, if someone sends JUNK or TEST as
</I>&gt;&gt;<i> the request method, then RE1 would trigger.
</I>&gt;&gt;<i> &gt; RE2 should then be the check to see if the request method submitted is
</I>&gt;&gt;<i> not one that is expected for the current resource (expecting a POST but
</I>&gt;&gt;<i> receiving a GET).
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; The reason why I came to this conclusion is that when implementing these
</I>&gt;&gt;<i> rules in ModSecurity, if we keep the current ordering and using blocking,
</I>&gt;&gt;<i> RE2 would never trigger as an unknown HTTP Request method would first
</I>&gt;&gt;<i> violate RE1.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; To summarize &#8211; I think the detection logic of these two are fine but
</I>&gt;&gt;<i> that the detection point labels should be switched.
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; -Ryan
</I>&gt;&gt;<i> &gt; _______________________________________________
</I>&gt;&gt;<i> &gt; Owasp-appsensor-project mailing list
</I>&gt;&gt;<i> &gt; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;&gt;<i> &gt; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;&gt;<i>  &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;&gt;<i>  &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110415/19e92998/attachment-0001.html">https://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20110415/19e92998/attachment-0001.html</A> 
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000244.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
	<LI>Next message: <A HREF="000246.html">[Owasp-appsensor-project] Should RE1 and RE2 detection logic be	switched?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#245">[ date ]</a>
              <a href="thread.html#245">[ thread ]</a>
              <a href="subject.html#245">[ subject ]</a>
              <a href="author.html#245">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
