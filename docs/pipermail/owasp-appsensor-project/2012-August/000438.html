<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Appsensor in webgoat 5.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20Appsensor%20in%20webgoat%205.4&In-Reply-To=%3CCAM8z%3Dy%2B9-V8qowfTBZtF4SFxgQmw8PU_-G_s15dcXExUjJU-kQ%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000437.html">
   <LINK REL="Next"  HREF="000439.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Appsensor in webgoat 5.4</H1>
    <B>John Melton</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20Appsensor%20in%20webgoat%205.4&In-Reply-To=%3CCAM8z%3Dy%2B9-V8qowfTBZtF4SFxgQmw8PU_-G_s15dcXExUjJU-kQ%40mail.gmail.com%3E"
       TITLE="[Owasp-appsensor-project] Appsensor in webgoat 5.4">jtmelton at gmail.com
       </A><BR>
    <I>Thu Aug  2 00:16:16 UTC 2012</I>
    <P><UL>
        <LI>Previous message: <A HREF="000437.html">[Owasp-appsensor-project] Appsensor in webgoat 5.4
</A></li>
        <LI>Next message: <A HREF="000439.html">[Owasp-appsensor-project] Appsensor in webgoat 5.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#438">[ date ]</a>
              <a href="thread.html#438">[ thread ]</a>
              <a href="subject.html#438">[ subject ]</a>
              <a href="author.html#438">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Not sure where you did the configuration, but I assume the esapi.properties
file, but the intrusion detector is configured incorrectly. You have
AppSensortIntrusionDetector
where it should be
AppSensorIntrusionDetector

Hope this helps.
Thanks,
John

On Wed, Aug 1, 2012 at 5:43 PM, panosx13 panosx13 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">panosx13 at gmail.com</A>&gt;wrote:

&gt;<i> Hello, I'm trying to work with Appsensor in the webgoat 5.4, but I have
</I>&gt;<i> faced a problem.
</I>&gt;<i>
</I>&gt;<i> Actually for the installation of the webgoat I follow the steps in the
</I>&gt;<i> Readme.txt that is included in the wegoat's archive.
</I>&gt;<i>
</I>&gt;<i> a brief of what I did
</I>&gt;<i>
</I>&gt;<i> mvn compile
</I>&gt;<i> mvn install
</I>&gt;<i> mvn clean
</I>&gt;<i> mvn eclipse:clena
</I>&gt;<i> mvn eclipse:eclipse
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> for the appsensor I added in the pom.xml
</I>&gt;<i>
</I>&gt;<i>     &lt;dependency&gt;
</I>&gt;<i>             &lt;groupId&gt;org.owasp.appsensor&lt;/groupId&gt;
</I>&gt;<i>             &lt;artifactId&gt;AppSensor&lt;/artifactId&gt;
</I>&gt;<i>             &lt;version&gt;0.1.3&lt;/version&gt;
</I>&gt;<i>         &lt;/dependency&gt;
</I>&gt;<i>
</I>&gt;<i> and the esapi I installed it manual with the mvn.
</I>&gt;<i>
</I>&gt;<i> also I added the .esapi folder in my home directory
</I>&gt;<i>
</I>&gt;<i> As I can see when the webgoat loads, esapi sees the esapi.properties,
</I>&gt;<i> appsensor.properties etc in my home folder
</I>&gt;<i>
</I>&gt;<i> To test it I added in the main.jsp the following lines for the Appsesnosr
</I>&gt;<i>
</I>&gt;<i> &lt;%@ page contentType=&quot;text/html; charset=ISO-8859-1&quot; language=&quot;java&quot;
</I>&gt;<i>     import=&quot;org.owasp.webgoat.session.*,
</I>&gt;<i> org.owasp.webgoat.lessons.Category,
</I>&gt;<i> org.owasp.webgoat.lessons.AbstractLesson, org.owasp.webgoat.util.*,
</I>&gt;<i> java.util.*&quot;
</I>&gt;<i>     errorPage=&quot;&quot;  %&gt;
</I>&gt;<i>
</I>&gt;<i>  &lt;%@ page contentType=&quot;text/html; charset=ISO-8859-1&quot; language=&quot;java&quot;
</I>&gt;<i>
</I>&gt;<i> import=&quot;org.owasp.appsensor.*,org.owasp.appsensor.intrusiondetection.*,org.owasp.appsensor.intrusiondetection.AppSensorIntrusionDetector&quot;
</I>&gt;<i>
</I>&gt;<i>     errorPage=&quot;&quot; %&gt;
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> &lt;%
</I>&gt;<i> Course course = ((Course)session.getAttribute(&quot;course&quot;));
</I>&gt;<i> WebSession webSession = ((WebSession)session.getAttribute(&quot;websession&quot;));
</I>&gt;<i> AbstractLesson currentLesson = webSession.getCurrentLesson();
</I>&gt;<i> AttackDetectorUtils.verifyValidRequestMethod(request,AttackDetectorUtils.POST);
</I>&gt;<i>
</I>&gt;<i> %&gt;
</I>&gt;<i>
</I>&gt;<i> When I try to see the page the following error is occured
</I>&gt;<i>
</I>&gt;<i> Root Message: java.lang.ClassNotFoundException:
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
</I>&gt;<i> IntrusionDetector class
</I>&gt;<i> (org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
</I>&gt;<i> be in class path.
</I>&gt;<i> Do you know how I can solve this? Why claims that
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector isn't
</I>&gt;<i> in the class path ?
</I>&gt;<i>
</I>&gt;<i> As you can see tomcat gave the following export, I think that appsensor
</I>&gt;<i> detects the violation but after that the error occurs
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> ERROR ExampleApplication:AppSensorException - [SECURITY FAILURE
</I>&gt;<i> Anonymous:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">null at unknown</A> -&gt; /ExampleApplication/AppSensorException]
</I>&gt;<i> AppSensorIntrusion - Attacker is sending a non-POST request (GET) to page
</I>&gt;<i> designed for only POST
</I>&gt;<i> Aug 2, 2012 12:17:24 AM org.apache.catalina.core.ApplicationDispatcher
</I>&gt;<i> invoke
</I>&gt;<i> SEVERE: Servlet.service() for servlet jsp threw exception
</I>&gt;<i> java.lang.ClassNotFoundException:
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
</I>&gt;<i>     at java.lang.Class.forName0(Native Method)
</I>&gt;<i>     at java.lang.Class.forName(Class.java:186)
</I>&gt;<i>     at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:74)
</I>&gt;<i>     at org.owasp.esapi.ESAPI.intrusionDetector(ESAPI.java:128)
</I>&gt;<i>     at
</I>&gt;<i> org.owasp.appsensor.errors.AppSensorException.&lt;init&gt;(AppSensorException.java:79)
</I>&gt;<i>     at
</I>&gt;<i> org.owasp.appsensor.AttackDetectorUtils.verifyValidRequestMethod(AttackDetectorUtils.java:108)
</I>&gt;<i>     at org.apache.jsp.main_jsp._jspService(main_jsp.java:86)
</I>&gt;<i>     at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
</I>&gt;<i>     at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
</I>&gt;<i>     at org.owasp.webgoat.HammerHead.doPost(HammerHead.java:184)
</I>&gt;<i>     at org.owasp.webgoat.HammerHead.doGet(HammerHead.java:105)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
</I>&gt;<i>     at
</I>&gt;<i> java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
</I>&gt;<i>     at
</I>&gt;<i> java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
</I>&gt;<i>     at java.lang.Thread.run(Thread.java:679)
</I>&gt;<i> org.apache.jasper.JasperException:
</I>&gt;<i> org.owasp.esapi.errors.ConfigurationException:
</I>&gt;<i> java.lang.ClassNotFoundException:
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
</I>&gt;<i> IntrusionDetector class
</I>&gt;<i> (org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
</I>&gt;<i> be in class path.
</I>&gt;<i>     at
</I>&gt;<i> org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:470)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
</I>&gt;<i>     at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
</I>&gt;<i>     at org.owasp.webgoat.HammerHead.doPost(HammerHead.java:184)
</I>&gt;<i>     at org.owasp.webgoat.HammerHead.doGet(HammerHead.java:105)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
</I>&gt;<i>     at
</I>&gt;<i> java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
</I>&gt;<i>     at
</I>&gt;<i> java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
</I>&gt;<i>     at java.lang.Thread.run(Thread.java:679)
</I>&gt;<i> Caused by: org.owasp.esapi.errors.ConfigurationException:
</I>&gt;<i> java.lang.ClassNotFoundException:
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
</I>&gt;<i> IntrusionDetector class
</I>&gt;<i> (org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
</I>&gt;<i> be in class path.errorscreen createContent
</I>&gt;<i> Error:org.apache.jasper.JasperException:
</I>&gt;<i> org.owasp.esapi.errors.ConfigurationException:
</I>&gt;<i> java.lang.ClassNotFoundException:
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
</I>&gt;<i> IntrusionDetector class
</I>&gt;<i> (org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
</I>&gt;<i> be in class path. message:null
</I>&gt;<i>     at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:108)
</I>&gt;<i>     at org.owasp.esapi.ESAPI.intrusionDetector(ESAPI.java:128)
</I>&gt;<i>     at
</I>&gt;<i> org.owasp.appsensor.errors.AppSensorException.&lt;init&gt;(AppSensorException.java:79)
</I>&gt;<i>     at
</I>&gt;<i> org.owasp.appsensor.AttackDetectorUtils.verifyValidRequestMethod(AttackDetectorUtils.java:108)
</I>&gt;<i>     at org.apache.jsp.main_jsp._jspService(main_jsp.java:86)
</I>&gt;<i>     at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
</I>&gt;<i>     at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
</I>&gt;<i>     ... 29 more
</I>&gt;<i> Caused by: java.lang.ClassNotFoundException:
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
</I>&gt;<i>     at
</I>&gt;<i> org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
</I>&gt;<i>     at java.lang.Class.forName0(Native Method)
</I>&gt;<i>     at java.lang.Class.forName(Class.java:186)
</I>&gt;<i>     at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:74)
</I>&gt;<i>     ... 36 more
</I>&gt;<i> Aug 2, 2012 12:17:24 AM org.apache.catalina.core.ApplicationContext log
</I>&gt;<i> INFO: WebGoat: ERROR: org.apache.jasper.JasperException:
</I>&gt;<i> org.owasp.esapi.errors.ConfigurationException:
</I>&gt;<i> java.lang.ClassNotFoundException:
</I>&gt;<i> org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
</I>&gt;<i> IntrusionDetector class
</I>&gt;<i> (org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
</I>&gt;<i> be in class path.
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;<i>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20120801/592c45c4/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20120801/592c45c4/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000437.html">[Owasp-appsensor-project] Appsensor in webgoat 5.4
</A></li>
	<LI>Next message: <A HREF="000439.html">[Owasp-appsensor-project] Appsensor in webgoat 5.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#438">[ date ]</a>
              <a href="thread.html#438">[ thread ]</a>
              <a href="subject.html#438">[ subject ]</a>
              <a href="author.html#438">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
