<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Appsensor in webgoat 5.4
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20Appsensor%20in%20webgoat%205.4&In-Reply-To=%3CCANin3Ws2_BdJM8WGf5X2QKL_h_MokTwSQtSa-toD5CG7ijSfuw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000438.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Appsensor in webgoat 5.4</H1>
    <B>panosx13 panosx13</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20Appsensor%20in%20webgoat%205.4&In-Reply-To=%3CCANin3Ws2_BdJM8WGf5X2QKL_h_MokTwSQtSa-toD5CG7ijSfuw%40mail.gmail.com%3E"
       TITLE="[Owasp-appsensor-project] Appsensor in webgoat 5.4">panosx13 at gmail.com
       </A><BR>
    <I>Wed Aug  1 21:43:15 UTC 2012</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000438.html">[Owasp-appsensor-project] Appsensor in webgoat 5.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#437">[ date ]</a>
              <a href="thread.html#437">[ thread ]</a>
              <a href="subject.html#437">[ subject ]</a>
              <a href="author.html#437">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello, I'm trying to work with Appsensor in the webgoat 5.4, but I have
faced a problem.

Actually for the installation of the webgoat I follow the steps in the
Readme.txt that is included in the wegoat's archive.

a brief of what I did

mvn compile
mvn install
mvn clean
mvn eclipse:clena
mvn eclipse:eclipse


for the appsensor I added in the pom.xml

    &lt;dependency&gt;
            &lt;groupId&gt;org.owasp.appsensor&lt;/groupId&gt;
            &lt;artifactId&gt;AppSensor&lt;/artifactId&gt;
            &lt;version&gt;0.1.3&lt;/version&gt;
        &lt;/dependency&gt;

and the esapi I installed it manual with the mvn.

also I added the .esapi folder in my home directory

As I can see when the webgoat loads, esapi sees the esapi.properties,
appsensor.properties etc in my home folder

To test it I added in the main.jsp the following lines for the Appsesnosr

&lt;%@ page contentType=&quot;text/html; charset=ISO-8859-1&quot; language=&quot;java&quot;
    import=&quot;org.owasp.webgoat.session.*,
org.owasp.webgoat.lessons.Category,
org.owasp.webgoat.lessons.AbstractLesson, org.owasp.webgoat.util.*,
java.util.*&quot;
    errorPage=&quot;&quot;  %&gt;

 &lt;%@ page contentType=&quot;text/html; charset=ISO-8859-1&quot; language=&quot;java&quot;

import=&quot;org.owasp.appsensor.*,org.owasp.appsensor.intrusiondetection.*,org.owasp.appsensor.intrusiondetection.AppSensorIntrusionDetector&quot;

    errorPage=&quot;&quot; %&gt;


&lt;%
Course course = ((Course)session.getAttribute(&quot;course&quot;));
WebSession webSession = ((WebSession)session.getAttribute(&quot;websession&quot;));
AbstractLesson currentLesson = webSession.getCurrentLesson();
AttackDetectorUtils.verifyValidRequestMethod(request,AttackDetectorUtils.POST);

%&gt;

When I try to see the page the following error is occured

Root Message: java.lang.ClassNotFoundException:
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
IntrusionDetector class
(org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
be in class path.
Do you know how I can solve this? Why claims that
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector isn't in
the class path ?

As you can see tomcat gave the following export, I think that appsensor
detects the violation but after that the error occurs


ERROR ExampleApplication:AppSensorException - [SECURITY FAILURE
Anonymous:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">null at unknown</A> -&gt; /ExampleApplication/AppSensorException]
AppSensorIntrusion - Attacker is sending a non-POST request (GET) to page
designed for only POST
Aug 2, 2012 12:17:24 AM org.apache.catalina.core.ApplicationDispatcher
invoke
SEVERE: Servlet.service() for servlet jsp threw exception
java.lang.ClassNotFoundException:
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
    at
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
    at
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:186)
    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:74)
    at org.owasp.esapi.ESAPI.intrusionDetector(ESAPI.java:128)
    at
org.owasp.appsensor.errors.AppSensorException.&lt;init&gt;(AppSensorException.java:79)
    at
org.owasp.appsensor.AttackDetectorUtils.verifyValidRequestMethod(AttackDetectorUtils.java:108)
    at org.apache.jsp.main_jsp._jspService(main_jsp.java:86)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    at
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at
org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)
    at
org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)
    at
org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)
    at
org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
    at org.owasp.webgoat.HammerHead.doPost(HammerHead.java:184)
    at org.owasp.webgoat.HammerHead.doGet(HammerHead.java:105)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)
    at
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at
org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
    at
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)
org.apache.jasper.JasperException:
org.owasp.esapi.errors.ConfigurationException:
java.lang.ClassNotFoundException:
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
IntrusionDetector class
(org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
be in class path.
    at
org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
    at
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:470)
    at
org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at
org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:684)
    at
org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:471)
    at
org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)
    at
org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
    at org.owasp.webgoat.HammerHead.doPost(HammerHead.java:184)
    at org.owasp.webgoat.HammerHead.doGet(HammerHead.java:105)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at
org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at
org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at
org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at
org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:169)
    at
org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:581)
    at
org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at
org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at
org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at
org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at
org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at
org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:999)
    at
org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:565)
    at
org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:309)
    at
java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679)
Caused by: org.owasp.esapi.errors.ConfigurationException:
java.lang.ClassNotFoundException:
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
IntrusionDetector class
(org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
be in class path.errorscreen createContent
Error:org.apache.jasper.JasperException:
org.owasp.esapi.errors.ConfigurationException:
java.lang.ClassNotFoundException:
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
IntrusionDetector class
(org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
be in class path. message:null
    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:108)
    at org.owasp.esapi.ESAPI.intrusionDetector(ESAPI.java:128)
    at
org.owasp.appsensor.errors.AppSensorException.&lt;init&gt;(AppSensorException.java:79)
    at
org.owasp.appsensor.AttackDetectorUtils.verifyValidRequestMethod(AttackDetectorUtils.java:108)
    at org.apache.jsp.main_jsp._jspService(main_jsp.java:86)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at
org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    ... 29 more
Caused by: java.lang.ClassNotFoundException:
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
    at
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1711)
    at
org.apache.catalina.loader.WebappClassLoader.loadClass(WebappClassLoader.java:1556)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:186)
    at org.owasp.esapi.util.ObjFactory.make(ObjFactory.java:74)
    ... 36 more
Aug 2, 2012 12:17:24 AM org.apache.catalina.core.ApplicationContext log
INFO: WebGoat: ERROR: org.apache.jasper.JasperException:
org.owasp.esapi.errors.ConfigurationException:
java.lang.ClassNotFoundException:
org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector
IntrusionDetector class
(org.owasp.appsensor.intrusiondetection.AppSensortIntrusionDetector) must
be in class path.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20120802/302e397c/attachment.html">http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20120802/302e397c/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000438.html">[Owasp-appsensor-project] Appsensor in webgoat 5.4
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#437">[ date ]</a>
              <a href="thread.html#437">[ thread ]</a>
              <a href="subject.html#437">[ subject ]</a>
              <a href="author.html#437">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
