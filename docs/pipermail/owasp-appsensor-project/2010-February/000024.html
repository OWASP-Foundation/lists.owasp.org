<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] ModSecurity Core Rule Set (CRS) Project	Update - Rule Tag Data Linking to AppSensor
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20ModSecurity%20Core%20Rule%20Set%20%28CRS%29%20Project%0A%09Update%20-%20Rule%20Tag%20Data%20Linking%20to%20AppSensor&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000028.html">
   <LINK REL="Next"  HREF="000025.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] ModSecurity Core Rule Set (CRS) Project	Update - Rule Tag Data Linking to AppSensor</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=%5BOwasp-appsensor-project%5D%20ModSecurity%20Core%20Rule%20Set%20%28CRS%29%20Project%0A%09Update%20-%20Rule%20Tag%20Data%20Linking%20to%20AppSensor&In-Reply-To="
       TITLE="[Owasp-appsensor-project] ModSecurity Core Rule Set (CRS) Project	Update - Rule Tag Data Linking to AppSensor">rcbarnett at gmail.com
       </A><BR>
    <I>Fri Feb  5 16:19:11 EST 2010</I>
    <P><UL>
        <LI>Previous message: <A HREF="000028.html">[Owasp-appsensor-project] AppSensor Demo Code Now Available
</A></li>
        <LI>Next message: <A HREF="000025.html">[Owasp-appsensor-project] ModSecurity Core Rule Set (CRS)	Project Update - Rule Tag Data Linking to AppSensor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24">[ date ]</a>
              <a href="thread.html#24">[ thread ]</a>
              <a href="subject.html#24">[ subject ]</a>
              <a href="author.html#24">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Greetings everyone,
I am the OWASP ModSecurity Core Rule Set (CRS) Project Leader - 
<A HREF="http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project">http://www.owasp.org/index.php/Category:OWASP_ModSecurity_Core_Rule_Set_Project</A>

First off, I wanted to say that I really like the AppSensor concept.  There is some logical 
overlap between what categories of issues can be identified by AppSensor locally and what 
can be identified external to the app by an intermediary WAF.  There are however also some 
categories of issues that can only be determined when you have access to internal code 
logic and data (mainly authentication/authorization types of issues).  I also like some of 
the more behavioral detection capabilities that are presented to identify abnormal spikes 
in app usage.  I am planning to put some research into how some of this logic can be 
implemented in ModSecurity using the Lua API.

Anyways, onto my main point for this email.  While the CRS doesn't cover all of the 
detection category items in AppSensor, it does include some of them.  I have just released 
v2.0.5 of the CRS and in it, I have included additional TAG data referencing the 
corresponding AppSensor sections.  This data is presented to the user in the logs when 
rules trigger.  Here is an example when someone sends the DELETE request method, which is 
not allowed by default policy -

Message: Match of &quot;within %{tx.allowed_methods}&quot; against &quot;REQUEST_METHOD&quot; required. [file 
&quot;/usr/local/apache/conf/modsec_current/base_rules/modsecurity_crs_30_http_policy.conf&quot;] 
[line &quot;30&quot;] [id &quot;960032&quot;] [msg &quot;Method is not allowed by policy&quot;] [data &quot;DELETE&quot;] 
[severity &quot;CRITICAL&quot;] [tag &quot;POLICY/METHOD_NOT_ALLOWED&quot;] [tag &quot;WASCTC/WASC-15&quot;] [tag 
&quot;OWASP_TOP_10/A6&quot;] [tag &quot;OWASP_AppSensor/RE1&quot;] [tag &quot;PCI/12.1&quot;]

Notice that the the TAG data references AppSensor section RE1.

Anyways, I just wanted to share this info and say keep up the great work!

Cheers.

--
Ryan C. Barnett
WASC Distributed Open Proxy Honeypot Project Leader
OWASP ModSecurity Core Rule Set Project Leader
Tactical Web Application Security
<A HREF="http://tacticalwebappsec.blogspot.com">http://tacticalwebappsec.blogspot.com</A>

</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000028.html">[Owasp-appsensor-project] AppSensor Demo Code Now Available
</A></li>
	<LI>Next message: <A HREF="000025.html">[Owasp-appsensor-project] ModSecurity Core Rule Set (CRS)	Project Update - Rule Tag Data Linking to AppSensor
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#24">[ date ]</a>
              <a href="thread.html#24">[ thread ]</a>
              <a href="subject.html#24">[ subject ]</a>
              <a href="author.html#24">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
