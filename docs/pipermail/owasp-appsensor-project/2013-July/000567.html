<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] Recommend a new reference link for RP3: Suspicious Client-Side Behavior
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20Recommend%20a%20new%20reference%20link%20for%20RP3%3A%0A%20Suspicious%20Client-Side%20Behavior&In-Reply-To=%3CCE03F2AB.ADCF9%25ryan.barnett%40owasp.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000571.html">
   <LINK REL="Next"  HREF="000574.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] Recommend a new reference link for RP3: Suspicious Client-Side Behavior</H1>
    <B>Ryan Barnett</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20Recommend%20a%20new%20reference%20link%20for%20RP3%3A%0A%20Suspicious%20Client-Side%20Behavior&In-Reply-To=%3CCE03F2AB.ADCF9%25ryan.barnett%40owasp.org%3E"
       TITLE="[Owasp-appsensor-project] Recommend a new reference link for RP3: Suspicious Client-Side Behavior">ryan.barnett at owasp.org
       </A><BR>
    <I>Thu Jul 11 09:27:07 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000571.html">[Owasp-appsensor-project] Detection or protection from web	scraping
</A></li>
        <LI>Next message: <A HREF="000574.html">[Owasp-appsensor-project] Recommend a new reference link for RP3: Suspicious Client-Side Behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#567">[ date ]</a>
              <a href="thread.html#567">[ thread ]</a>
              <a href="subject.html#567">[ subject ]</a>
              <a href="author.html#567">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I wanted to share a blog post I did yesterday that would be a good reference
for Example 5 of RP3: Suspicious Client-side Behavior -
<A HREF="https://www.owasp.org/index.php/AppSensor_DetectionPoints#RP3:_Suspicious_Cl">https://www.owasp.org/index.php/AppSensor_DetectionPoints#RP3:_Suspicious_Cl</A>
ient-Side_Behavior

Here is the blog post -
<A HREF="http://blog.spiderlabs.com/2013/07/modsecurity-advanced-topic-of-the-week-de">http://blog.spiderlabs.com/2013/07/modsecurity-advanced-topic-of-the-week-de</A>
tecting-banking-trojan-page-modifications.html

It uses ModSecurity to send down defensive JS code when banking clients
access the login page.  The JS code will then initiate an XHR request back
to the app for the same page.  This time, however, ModSecurity creates a
Hash of the valid response body and adds this as a new response header
called &quot;WebTripWireHash&quot;.  When the XHR response is received, the JS code
then locally calculates another Hash and compares it with the
WebTripWireHash value sent by ModSecurity.  If a baning trojan has modified
the login page HTML to attempt to phish extra data from the user then this
will catch it.  The JS code then issues an alert pop-up warning the user and
sends another XHR request back to the web server/ModSecurity to notify of
the issue.  This is somewhat similar in theory to a CSP violation report
request.

This may be a good reference link to include for Example 5.

Thoughts/Comments?

-Ryan



-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20130711/a9672584/attachment.html">http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20130711/a9672584/attachment.html</A>&gt;
</PRE>








<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000571.html">[Owasp-appsensor-project] Detection or protection from web	scraping
</A></li>
	<LI>Next message: <A HREF="000574.html">[Owasp-appsensor-project] Recommend a new reference link for RP3: Suspicious Client-Side Behavior
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#567">[ date ]</a>
              <a href="thread.html#567">[ thread ]</a>
              <a href="subject.html#567">[ subject ]</a>
              <a href="author.html#567">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
