<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] New Detection Point Candidate: AE13: Deviation from normal GEO location during login
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20New%20Detection%20Point%20Candidate%3A%20AE13%3A%0A%20Deviation%20from%20normal%20GEO%20location%20during%20login&In-Reply-To=%3CCAM8z%3DyJ4zauDq7Fe8XY2pGb2yQVB3zY4yZLfgNC5o_ZGNwzMzw%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000563.html">
   <LINK REL="Next"  HREF="000566.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] New Detection Point Candidate: AE13: Deviation from normal GEO location during login</H1>
    <B>John Melton</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20New%20Detection%20Point%20Candidate%3A%20AE13%3A%0A%20Deviation%20from%20normal%20GEO%20location%20during%20login&In-Reply-To=%3CCAM8z%3DyJ4zauDq7Fe8XY2pGb2yQVB3zY4yZLfgNC5o_ZGNwzMzw%40mail.gmail.com%3E"
       TITLE="[Owasp-appsensor-project] New Detection Point Candidate: AE13: Deviation from normal GEO location during login">jtmelton at gmail.com
       </A><BR>
    <I>Thu Jul 11 05:44:39 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000563.html">[Owasp-appsensor-project] New Detection Point Candidate: AE13: Deviation from normal GEO location during login
</A></li>
        <LI>Next message: <A HREF="000566.html">[Owasp-appsensor-project] New Detection Point Candidate: AE13: Deviation from normal GEO location during login
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#564">[ date ]</a>
              <a href="thread.html#564">[ thread ]</a>
              <a href="subject.html#564">[ subject ]</a>
              <a href="author.html#564">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I'm trying to think of use cases here. The couple of examples listed are
banks authenticating a new IP or a site accessed from a new country. Banks
have several mechanisms they use to try and determine if a user is coming
from a trusted machine including geolocation, reusing an IP address, a
token on the host, etc. Some sites might only allow access from a given IP
block presumably (example being your vpn/non-vpn access or something like
it) You might only be allowed to login if you came over the VPN IP
address/geolocation. I can also see the usage of limiting site access by
country. Maybe you are doing something based on language
internationalization or you want to naively restrict certain countries
visitors from seeing your information.

One of the examples I can see based on what you mentioned is that a user
logs in from Western Europe to site X, then logs out. They then hop on the
VPN and are routed through central US and then log back onto site X within
a few minutes. There is no logical way a user could move that quickly that
fast, and that _may_ point to their session being hijacked.

I think the crucial thing here is &quot;some&quot; applications. I think as a general
rule, geolocation is only useful as a single indicator, not as the sole
decision point. There are just too many technical reasons it could be
invalid. If you have a specific use case where you know you can use it as
the determining factor and not adversely affect your users, then by all
means. I just don't think that's a common situation for geolocation.



On Thu, Jul 11, 2013 at 1:07 AM, Kevin W. Wall &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">kevin.w.wall at gmail.com</A>&gt;wrote:

&gt;<i> On Thu, Jul 4, 2013 at 8:35 AM, Colin Watson &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">colin.watson at owasp.org</A>&gt;
</I>&gt;<i> wrote:
</I>&gt;<i> &gt; Added:
</I>&gt;<i> &gt;
</I>&gt;<i> &gt;
</I>&gt;<i> <A HREF="https://www.owasp.org/index.php/AppSensor_DetectionPoints#AE13:_Deviation_from_Normal_GEO_Location">https://www.owasp.org/index.php/AppSensor_DetectionPoints#AE13:_Deviation_from_Normal_GEO_Location</A>
</I>&gt;<i>
</I>&gt;<i> All,
</I>&gt;<i>
</I>&gt;<i> Hate to be a fly in the ointment, but I think we need to think
</I>&gt;<i> this through a bit more.
</I>&gt;<i>
</I>&gt;<i> I think one question that ought to be asked if a person is normally
</I>&gt;<i> using a phone or other mobile device with GPS or other location
</I>&gt;<i> info made available and then all of a sudden, that information
</I>&gt;<i> stops coming, how would / should this detection point react?
</I>&gt;<i> Would it even be triggered? Might we consider it a normal thing
</I>&gt;<i> that someone disables their GPS? (I do that all the time to save
</I>&gt;<i> battery. Even more often since the Snowden leaks, but I digress.)
</I>&gt;<i> But if the geo-location information is based on something like
</I>&gt;<i> GPS or the courser-grained cell-tower triangulation and then an
</I>&gt;<i> app stops getting that? Do we flag it or not? How do we recommend
</I>&gt;<i> an application using this detection point in AppSensor proceed
</I>&gt;<i> if that information suddenly becomes unavailable?  Note that
</I>&gt;<i> having an answer for this is important. If we simply say &quot;okay,
</I>&gt;<i> it is normal for people to disable these services to save batteries
</I>&gt;<i> or whatever&quot;, then an attacker can just not send that information.
</I>&gt;<i> On the other hand, if you try to locate this simply based on
</I>&gt;<i> information for IP addresses, that is liable to have a lot of false
</I>&gt;<i> positives. For instance, if I login to my company VPN from home
</I>&gt;<i> and access your site, it puts me at one location. However, if I
</I>&gt;<i> access your site from the same PC directly (while still at my home),
</I>&gt;<i> it may look like I'm instantly a thousand miles or more away.
</I>&gt;<i>
</I>&gt;<i> The other issue that I have with basing location solely on IP
</I>&gt;<i> addresses is I'm not sure how well that is actually going to work
</I>&gt;<i> once (someday!) we all regularly start using IPv6.
</I>&gt;<i>
</I>&gt;<i> -kevin
</I>&gt;<i> --
</I>&gt;<i> Blog: <A HREF="http://off-the-wall-security.blogspot.com/">http://off-the-wall-security.blogspot.com/</A>
</I>&gt;<i> &quot;The most likely way for the world to be destroyed, most experts agree,
</I>&gt;<i> is by accident. That's where we come in; we're computer professionals.
</I>&gt;<i> We *cause* accidents.&quot;        -- Nathaniel Borenstein
</I>&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-appsensor-project mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">Owasp-appsensor-project at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project</A>
</I>&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20130711/635ed8ac/attachment.html">http://lists.owasp.org/pipermail/owasp-appsensor-project/attachments/20130711/635ed8ac/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000563.html">[Owasp-appsensor-project] New Detection Point Candidate: AE13: Deviation from normal GEO location during login
</A></li>
	<LI>Next message: <A HREF="000566.html">[Owasp-appsensor-project] New Detection Point Candidate: AE13: Deviation from normal GEO location during login
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#564">[ date ]</a>
              <a href="thread.html#564">[ thread ]</a>
              <a href="subject.html#564">[ subject ]</a>
              <a href="author.html#564">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
