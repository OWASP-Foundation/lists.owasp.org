<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-appsensor-project] AppSensor is very user-centric
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20AppSensor%20is%20very%20user-centric&In-Reply-To=%3CCAOPE6PgH74uqjjsxEumnon32n5UTB-6AX6-VVvf0ExHLXeNQ8A%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000490.html">
   <LINK REL="Next"  HREF="000492.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-appsensor-project] AppSensor is very user-centric</H1>
    <B>Kevin W. Wall</B> 
    <A HREF="mailto:owasp-appsensor-project%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-appsensor-project%5D%20AppSensor%20is%20very%20user-centric&In-Reply-To=%3CCAOPE6PgH74uqjjsxEumnon32n5UTB-6AX6-VVvf0ExHLXeNQ8A%40mail.gmail.com%3E"
       TITLE="[Owasp-appsensor-project] AppSensor is very user-centric">kevin.w.wall at gmail.com
       </A><BR>
    <I>Fri Feb  8 22:30:46 UTC 2013</I>
    <P><UL>
        <LI>Previous message: <A HREF="000490.html">[Owasp-appsensor-project] AppSensor is very user-centric
</A></li>
        <LI>Next message: <A HREF="000492.html">[Owasp-appsensor-project] AppSensor is very user-centric
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#491">[ date ]</a>
              <a href="thread.html#491">[ thread ]</a>
              <a href="subject.html#491">[ subject ]</a>
              <a href="author.html#491">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ryan, sorry for the repost. Meant to Reply-All in this case. My bad.


On Fri, Feb 8, 2013 at 4:21 PM, Ryan Barnett &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">ryan.barnett at owasp.org</A>&gt; wrote:
&gt;<i>
</I>&gt;<i> On 2/7/13 10:51 PM, &quot;Kevin W. Wall&quot; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">kevin.w.wall at gmail.com</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i>On Thu, Feb 7, 2013 at 1:55 PM, John Melton &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">jtmelton at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;<i> Luke,
</I>&gt;&gt;&gt;<i> Great question. The point you bring up is, in my experience, a common
</I>&gt;&gt;&gt;<i>one.
</I>&gt;&gt;&gt;<i> Part of deciding where to place your detection points requires
</I>&gt;&gt;&gt;<i>determining
</I>&gt;&gt;&gt;<i> whether they should account for logged in users, anonymous (system)
</I>&gt;&gt;&gt;<i>users,
</I>&gt;&gt;&gt;<i> or both. In general my approach is to:
</I>&gt;&gt;&gt;<i> 1. prefer tracking exceptions by user when possible (most granular) -
</I>&gt;&gt;&gt;<i>works
</I>&gt;&gt;&gt;<i> in authenticated-only sections of the app
</I>&gt;&gt;&gt;<i> 2. give the option of both in places where the user may or may not be
</I>&gt;&gt;&gt;<i>logged
</I>&gt;&gt;&gt;<i> in ... but use the preference of user tracking - works in all locations
</I>&gt;&gt;&gt;<i> 3. use system user exceptions in cases where the action is not
</I>&gt;&gt;&gt;<i>user-specific
</I>&gt;&gt;&gt;<i> or it should be tracked across the whole system, not per-user.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>A good idea might be to create some pseudo-user, say &quot;&lt;anonymous&gt;&quot;, that
</I>&gt;&gt;<i>the user elements throughout AppSensor defaults to, but gets replaced by
</I>&gt;&gt;<i>the actual user name if a user has authenticated. I believe that something
</I>&gt;&gt;<i>similar was done in ESAPI. That should at least prevent NPEs.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>-kevin
</I>&gt;<i>
</I>&gt;<i> Extending Kevin's pseudo-user concept - I like the idea but how do you
</I>&gt;<i> separate each &quot;anonymous&quot; user from each other?  I know that it is not
</I>&gt;<i> ideal, but the app can still use other methods to identify each client
</I>&gt;<i> using the following pre-auth intel:
</I>&gt;<i>
</I>&gt;<i> 1) IP Address
</I>&gt;<i> 2) Request Header data (Header ordering, User-Agent value, etc..)
</I>&gt;<i> 3) Client devide fingerprinting using Javascript (which adds a new cookie
</I>&gt;<i> hash value)
</I>&gt;<i>
</I>&gt;<i> The point is that even before authentication, without an app-user
</I>&gt;<i> identified, you should still be able to track events for each &quot;client&quot; and
</I>&gt;<i> initiate response actions.
</I>
We fortunately (or overall unfortunately IMHO, but fortunately in this case)
an HTTP session should be associated with this (as per the Java Servlet
Spec)...even before authentication. [And yes, I think this is really dumb and
Jeff Williams spent a lot of time trying to convince them of that, but they
more or less stuck their fingers in their ears and stated &quot;la, la, la; we can't
hear you!&quot;. Sigh.] So you should just be able to obtain the session id
for most of the cases and use it. (It may or may not change once the user
authenticates.) Of course, if someone is trying to manipulate the session
id prior to authenticating, you may need an alternate strategy. Better
User-Agent,
and remote IP address (and possibly X-Forwarded for), one could narrow it down
a bit. But that is never fool-proof. I'm not sure anything really ever
is; certainly
username / password is not (phishing, etc.). But we don't need to be perfect,
just good enough to make some reasonable statistical correlations. If we should
happen to disconnect the wrong unauthenticated user, it's not like we are
knocking them off life support. (I'm hoping that life support would require
appropriate authorization; otherwise, it's game over--quite literally. :-)

-kevin
-- 
Blog: <A HREF="http://off-the-wall-security.blogspot.com/">http://off-the-wall-security.blogspot.com/</A>
&quot;The most likely way for the world to be destroyed, most experts agree,
is by accident. That's where we come in; we're computer professionals.
We *cause* accidents.&quot;        -- Nathaniel Borenstein
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000490.html">[Owasp-appsensor-project] AppSensor is very user-centric
</A></li>
	<LI>Next message: <A HREF="000492.html">[Owasp-appsensor-project] AppSensor is very user-centric
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#491">[ date ]</a>
              <a href="thread.html#491">[ thread ]</a>
              <a href="subject.html#491">[ subject ]</a>
              <a href="author.html#491">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-appsensor-project">More information about the Owasp-appsensor-project
mailing list</a><br>
</body></html>
