<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;Reply&nbsp;inline!&lt;br&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Wed,&nbsp;Jun&nbsp;4,&nbsp;2014&nbsp;at&nbsp;7:43&nbsp;AM,&nbsp;Kevin&nbsp;W.&nbsp;Wall&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:kevin.w.wall@gmail.com&quot;&nbsp;target=&quot;_blank&quot;&gt;kevin.w.wall@gmail.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;While&nbsp;this&nbsp;likely&nbsp;may&nbsp;make&nbsp;the&nbsp;implementation&nbsp;a&nbsp;little&nbsp;bit&nbsp;more&nbsp;complex,&nbsp;I&nbsp;think&lt;br&gt;<br>
it&nbsp;will&nbsp;result&nbsp;in&nbsp;making&nbsp;your&nbsp;CSRF_Protector&nbsp;easier&nbsp;to&nbsp;use...and&nbsp;that&nbsp;is,&nbsp;in&lt;br&gt;<br>
addition&nbsp;to&nbsp;providing&nbsp;a&nbsp;method&nbsp;that&nbsp;can&nbsp;be&nbsp;overridden&nbsp;to&nbsp;define&nbsp;what&nbsp;GET&lt;br&gt;<br>
URLs&nbsp;should&nbsp;get&nbsp;a&nbsp;CSRF&nbsp;token&nbsp;added,&nbsp;I&nbsp;would&nbsp;also&nbsp;suggest&nbsp;that&lt;span&nbsp;style=&quot;color:rgb(204,0,0)&quot;&gt;&nbsp;you&nbsp;allow&lt;br&gt;<br>
some&nbsp;sort&nbsp;of&nbsp;simple&nbsp;pattern&nbsp;match&nbsp;to&nbsp;IGNORE&nbsp;all&nbsp;GET&nbsp;requests&lt;/span&gt;&nbsp;on&nbsp;certain&lt;br&gt;<br>
types&nbsp;of&nbsp;files.&nbsp;For&nbsp;instance,&lt;span&nbsp;style=&quot;color:rgb(204,0,0)&quot;&gt;&nbsp;most&nbsp;GETs&nbsp;originate&nbsp;from&nbsp;requesting&nbsp;images,&lt;br&gt;<br>
JavaScript,&nbsp;and&nbsp;cascading&nbsp;style-sheets&nbsp;and&nbsp;you&nbsp;generally&nbsp;don&#39;t&nbsp;need&nbsp;CSRF&lt;br&gt;<br>
tokens&nbsp;for&nbsp;those&nbsp;&lt;/span&gt;(I&nbsp;suppose&nbsp;you&nbsp;could&nbsp;if&nbsp;you&nbsp;are&nbsp;implementing&nbsp;a&nbsp;GET&nbsp;request&lt;br&gt;<br>
via&nbsp;an&nbsp;HTML&nbsp;form&nbsp;in&nbsp;JavaScript,&nbsp;but&nbsp;that&#39;s&nbsp;rare&nbsp;and&nbsp;hopefully&nbsp;there&#39;s&nbsp;a&nbsp;better&lt;br&gt;<br>
way&nbsp;to&nbsp;handle&nbsp;such&nbsp;edge&nbsp;cases).&nbsp;But&nbsp;I&nbsp;was&nbsp;thinking&nbsp;about&nbsp;something&nbsp;like&nbsp;a&lt;br&gt;<br>
property&nbsp;that&nbsp;would&nbsp;take&nbsp;a&nbsp;list&nbsp;of&nbsp;file&nbsp;suffixes&nbsp;to&nbsp;disregard&nbsp;with&lt;br&gt;<br>
respect&nbsp;to&nbsp;CSRF&lt;br&gt;<br>
tokens&nbsp;when&nbsp;made&nbsp;via&nbsp;GETs.&nbsp;E.g.,&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp;csrf_protector.get.ignore_suffix=.png,.gif,.jpg,.js,.css&lt;br&gt;<br>
&lt;br&gt;<br>
to&nbsp;ignore&nbsp;all&nbsp;PNG,&nbsp;GIF,&nbsp;JPEG,&nbsp;JavaScript,&nbsp;and&nbsp;cascading&nbsp;style&nbsp;sheets&lt;br&gt;<br>
requested&nbsp;via&nbsp;GETs.&nbsp;Those&nbsp;really&nbsp;are&nbsp;the&nbsp;bulk&nbsp;of&nbsp;the&nbsp;GET&nbsp;requests&lt;br&gt;<br>
anyway.&lt;br&gt;&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;+1&nbsp;for&nbsp;your&nbsp;point&nbsp;Kevin,&nbsp;We&#39;d&nbsp;have&nbsp;to&nbsp;take&nbsp;care&nbsp;of&nbsp;these&nbsp;while&nbsp;implementing&nbsp;the&nbsp;Apache&nbsp;module.&nbsp;In&nbsp;case&nbsp;of&nbsp;php&nbsp;library&nbsp;all&nbsp;requests&nbsp;are&nbsp;validated&nbsp;for&nbsp;php&nbsp;files&nbsp;only.&nbsp;So&nbsp;there&nbsp;will&nbsp;be&nbsp;no&nbsp;validation&nbsp;for&nbsp;js,css&nbsp;or&nbsp;images.&nbsp;Also,&nbsp;if&nbsp;the&nbsp;developer&nbsp;do&nbsp;not&nbsp;want&nbsp;validation&nbsp;on&nbsp;any&nbsp;GET&nbsp;request,&nbsp;all&nbsp;he&nbsp;have&nbsp;to&nbsp;do&nbsp;is&nbsp;keep&nbsp;the&nbsp;array&nbsp;of&nbsp;rules,&nbsp;empty&nbsp;in&nbsp;config&nbsp;file.&lt;br&gt;<br>
<br>
&lt;br&gt;&lt;br&gt;&lt;/div&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;Regarding&nbsp;logging,&nbsp;you&nbsp;would&nbsp;want&nbsp;to&nbsp;log&nbsp;the&nbsp;client&nbsp;IP&nbsp;address&nbsp;(and/or&lt;br&gt;<br>
proxied&nbsp;address,&lt;br&gt;<br>
X-Forwarded-For)&nbsp;if&nbsp;you&nbsp;can&nbsp;get&nbsp;them.&nbsp;&lt;span&nbsp;style=&quot;color:rgb(255,0,0)&quot;&gt;Also,&nbsp;if&nbsp;you&nbsp;know&nbsp;the&nbsp;authenticated&nbsp;user&lt;br&gt;<br>
name&nbsp;and&nbsp;have&nbsp;a&nbsp;uniform&nbsp;way&nbsp;to&nbsp;obtain&nbsp;it,&nbsp;that&nbsp;also&nbsp;is&nbsp;very&nbsp;useful.&lt;/span&gt;&nbsp; I&nbsp;know&nbsp;you&lt;br&gt;<br>
were&nbsp;talking&nbsp;about&nbsp;saving&nbsp;a&nbsp;hash&nbsp;of&nbsp;the&nbsp;session&nbsp;ID;&nbsp;I&nbsp;don&#39;t&nbsp;see&nbsp;it&lt;br&gt;<br>
there,&nbsp;but&nbsp;perhaps&lt;br&gt;<br>
that&nbsp;is&nbsp;what&nbsp;this&nbsp;is&nbsp;supposed&nbsp;to&nbsp;be:&lt;br&gt;<br>
&lt;br&gt;<br>
 &nbsp; &nbsp; $log[&#39;cookie&#39;]&nbsp;=&nbsp;$_COOKIE;&lt;br&gt;<br>
&lt;br&gt;<br>
I&nbsp;just&nbsp;don&#39;t&nbsp;know&nbsp;enough&nbsp;about&nbsp;PHP&nbsp;to&nbsp;know&nbsp;what&nbsp;that&nbsp;means....but&nbsp;in&nbsp;general,&lt;br&gt;<br>
I&nbsp;don&#39;t&nbsp;think&nbsp;you&nbsp;really&nbsp;want&nbsp;to&nbsp;log&nbsp;cookies,&nbsp;even&nbsp;if&nbsp;this&nbsp;is&nbsp;*only*&lt;br&gt;<br>
the&nbsp;session&nbsp;ID.&lt;br&gt;<br>
If&nbsp;may&nbsp;be&nbsp;low&nbsp;risk&nbsp;in&nbsp;most&nbsp;situations,&nbsp;but&nbsp;if&nbsp;you&nbsp;consider&nbsp;insider&lt;br&gt;<br>
attacks,&nbsp;in&nbsp;some&lt;br&gt;<br>
scenarios,&nbsp;logging&nbsp;session&nbsp;IDs&nbsp;would&nbsp;be&nbsp;forbidden&nbsp;where&nbsp;I&nbsp;work&nbsp;today.&lt;br&gt;<br>
&lt;/blockquote&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Each&nbsp;web&nbsp;app&nbsp;has&nbsp;its&nbsp;own&nbsp;way&nbsp;of&nbsp;storing&nbsp;user&nbsp;ids&nbsp;or&nbsp;other&nbsp;credentials.&nbsp;I&nbsp;guess&nbsp;best&nbsp;method&nbsp;here&nbsp;would&nbsp;be&nbsp;to&nbsp;allow&nbsp;the&nbsp;developer&nbsp;to&nbsp;override&nbsp;the&nbsp;default&nbsp;logging&nbsp;function,&nbsp;in&nbsp;case&nbsp;they&nbsp;want&nbsp;to&nbsp;log&nbsp;more/less&nbsp;data.&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt;About&nbsp;storing&nbsp;session&nbsp;Id&nbsp;in&nbsp;hash,&nbsp;in&nbsp;this&nbsp;case&nbsp;we&nbsp;will&nbsp;need&nbsp;database&nbsp;support.&nbsp;And&nbsp;If&nbsp;we&nbsp;are&nbsp;using&nbsp;database&nbsp;to&nbsp;map,&nbsp;hash&nbsp;to&nbsp;session&nbsp;id,&nbsp;isn&#39;t&nbsp;it&nbsp;better&nbsp;to&nbsp;actually&nbsp;save&nbsp;logs&nbsp;to&nbsp;db&nbsp;itself?&nbsp;And&nbsp;if&nbsp;you&nbsp;are&nbsp;suggesting&nbsp;that&nbsp;we&nbsp;should&nbsp;not&nbsp;log&nbsp;sessionid&nbsp;at&nbsp;all,&nbsp;how&nbsp;can&nbsp;we&nbsp;detect&nbsp;the&nbsp;victim&nbsp;of&nbsp;attack?&lt;br&gt;<br>
<br>
&lt;/div&gt;&lt;div&gt; &lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;<br>

</tt>
