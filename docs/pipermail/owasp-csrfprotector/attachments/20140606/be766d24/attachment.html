<tt>
&lt;div&nbsp;dir=&quot;ltr&quot;&gt;Also&nbsp;this&nbsp;is&nbsp;already&nbsp;an&nbsp;issue&nbsp;on&nbsp;github.&nbsp;here&#39;s&nbsp;the&nbsp;link &lt;a&nbsp;href=&quot;https://github.com/mebjas/CSRF-Protector-PHP/issues/4&quot;&gt;https://github.com/mebjas/CSRF-Protector-PHP/issues/4&lt;/a&gt;&lt;/div&gt;&lt;div&nbsp;class=&quot;gmail_extra&quot;&gt;<br>
<br>
&lt;br&nbsp;clear=&quot;all&quot;&gt;&lt;div&gt;&lt;div&nbsp;dir=&quot;ltr&quot;&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&nbsp;color=&quot;#444444&quot;&gt;Minhaz, &lt;/font&gt;&lt;div&gt;&lt;font&nbsp;face=&quot;courier&nbsp;new,&nbsp;monospace&quot;&nbsp;color=&quot;#444444&quot;&gt;&lt;a&nbsp;href=&quot;http://minhaz.cistoner.org&quot;&nbsp;target=&quot;_blank&quot;&gt;minhaz.cistoner.org&lt;/a&gt;&nbsp;||&nbsp;&lt;a&nbsp;href=&quot;http://cistoner.org&quot;&nbsp;target=&quot;_blank&quot;&gt;cistoner.org&lt;/a&gt;&lt;/font&gt;&lt;/div&gt;<br>
<br>
&lt;/div&gt;&lt;/div&gt;<br>
&lt;br&gt;&lt;br&gt;&lt;div&nbsp;class=&quot;gmail_quote&quot;&gt;On&nbsp;Fri,&nbsp;Jun&nbsp;6,&nbsp;2014&nbsp;at&nbsp;6:14&nbsp;AM,&nbsp;AbiusX&nbsp;&lt;span&nbsp;dir=&quot;ltr&quot;&gt;&lt;&lt;a&nbsp;href=&quot;mailto:notifications@github.com&quot;&nbsp;target=&quot;_blank&quot;&gt;notifications@github.com&lt;/a&gt;&gt;&lt;/span&gt;&nbsp;wrote:&lt;br&gt;&lt;blockquote&nbsp;class=&quot;gmail_quote&quot;&nbsp;style=&quot;margin:0&nbsp;0&nbsp;0&nbsp;.8ex;border-left:1px&nbsp;#ccc&nbsp;solid;padding-left:1ex&quot;&gt;<br>
<br>
First&nbsp;of&nbsp;all,&nbsp;$_GET&nbsp;and&nbsp;$_POST&nbsp;can&nbsp;be&nbsp;set&nbsp;for&nbsp;each&nbsp;request.&nbsp;Second,&nbsp;do&nbsp;not&nbsp;unset&nbsp;them,&nbsp;instead&nbsp;set&nbsp;them&nbsp;to&nbsp;an&nbsp;empty&nbsp;array.&nbsp;Unsetting&nbsp;them&nbsp;will&nbsp;break&nbsp;most&nbsp;apps.<br>
&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Third,&nbsp;you&nbsp;have&nbsp;a&nbsp;lot&nbsp;of&nbsp;repeated&nbsp;code.&nbsp;Change&nbsp;your&nbsp;logic&nbsp;to&nbsp;minimize&nbsp;them.<br>
&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Fourth,&nbsp;to&nbsp;the&nbsp;actual&nbsp;point.&nbsp;The&nbsp;way&nbsp;you’re&nbsp;doing&nbsp;it&nbsp;is&nbsp;wrong,&nbsp;it&nbsp;does&nbsp;not&nbsp;allow&nbsp;an&nbsp;application&nbsp;to&nbsp;have&nbsp;more&nbsp;than&nbsp;ONE&nbsp;simultaneus&nbsp;operation&nbsp;running.&nbsp;If&nbsp;you&nbsp;open&nbsp;two&nbsp;tabs,&nbsp;you&nbsp;will&nbsp;always&nbsp;fail&nbsp;on&nbsp;tokens.&nbsp;Only&nbsp;consume&nbsp;a&nbsp;token&nbsp;when&nbsp;its&nbsp;valid,&nbsp;or&nbsp;when&nbsp;it&nbsp;times&nbsp;out.<br>
&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
You&nbsp;are&nbsp;also&nbsp;storing&nbsp;the&nbsp;valid&nbsp;token&nbsp;in&nbsp;the&nbsp;cookies!&nbsp;That&nbsp;is&nbsp;totally&nbsp;wrong.&nbsp;You&nbsp;should&nbsp;store&nbsp;all&nbsp;valid&nbsp;CSRF&nbsp;tokens&nbsp;with&nbsp;their&nbsp;respective&nbsp;URLs&nbsp;in&nbsp;session&nbsp;(server-side)&nbsp;instead&nbsp;of&nbsp;in&nbsp;client&nbsp;cookies.<br>
&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
Please&nbsp;create&nbsp;an&nbsp;issue&nbsp;for&nbsp;this&nbsp;on&nbsp;GitHub&nbsp;so&nbsp;that&nbsp;we&nbsp;can&nbsp;track.<br>
&lt;br&gt;<br>
-A<br>
&lt;br&gt;<br>
______________________________________________________________<br>
&lt;br&gt;<br>
Notice:&nbsp;This&nbsp;message&nbsp;is&nbsp;digitally&nbsp;signed,&nbsp;its&nbsp;source&nbsp;and&nbsp;integrity&nbsp;are&nbsp;verifiable.<br>
&lt;br&gt;<br>
If&nbsp;you&nbsp;mail&nbsp;client&nbsp;does&nbsp;not&nbsp;support&nbsp;S/MIME&nbsp;verification,&nbsp;it&nbsp;will&nbsp;display&nbsp;a&nbsp;file&nbsp;(smime.p7s),&nbsp;which&nbsp;includes&nbsp;the&nbsp;X.509&nbsp;certificate&nbsp;and&nbsp;the&nbsp;signature&nbsp;body.&nbsp;&nbsp;Read&nbsp;more&nbsp;at&nbsp;Certified&nbsp;E-Mail&nbsp;with&nbsp;Comodo&nbsp;and&nbsp;Thunderbird&nbsp;in&nbsp;AbiusX.com<br>
&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
On&nbsp;Jun&nbsp;5,&nbsp;2014,&nbsp;at&nbsp;2:14&nbsp;PM,&nbsp;minhaz&nbsp;&lt;&lt;a&nbsp;href=&quot;mailto:notifications@github.com&quot;&nbsp;target=&quot;_blank&quot;&gt;notifications@github.com&lt;/a&gt;&gt;&nbsp;wrote:<br>
&lt;br&gt;<br>
<br>
&lt;br&gt;<br>
&gt;&nbsp;Currently&nbsp;its&nbsp;like,&nbsp;token&nbsp;is&nbsp;refreshed&nbsp;for&nbsp;every&nbsp;request.&nbsp;code:&nbsp;&lt;a&nbsp;href=&quot;https://github.com/mebjas/CSRF-Protector-PHP/blob/master/libs/csrf/csrfprotector.php#L142&quot;&nbsp;target=&quot;_blank&quot;&gt;https://github.com/mebjas/CSRF-Protector-PHP/blob/master/libs/csrf/csrfprotector.php#L142&lt;/a&gt;<br>
&lt;br&gt;<br>
&gt;&nbsp;<br>
&lt;br&gt;<br>
&gt;&nbsp;By&nbsp;consumed&nbsp;you&nbsp;mean&nbsp;used?<br>
&lt;br&gt;<br>
&gt;&nbsp;<br>
&lt;br&gt;<br>
&gt;&nbsp;—<br>
&lt;br&gt;&lt;div&nbsp;class=&quot;HOEnZb&quot;&gt;&lt;div&nbsp;class=&quot;h5&quot;&gt;<br>
&gt;&nbsp;Reply&nbsp;to&nbsp;this&nbsp;email&nbsp;directly&nbsp;or&nbsp;view&nbsp;it&nbsp;on&nbsp;GitHub.<br>
&lt;br&gt;<br>
&gt;&nbsp;<br>
<br>
&lt;p&nbsp;style=&quot;font-size:small;color:#666&quot;&gt;—&lt;br&gt;Reply&nbsp;to&nbsp;this&nbsp;email&nbsp;directly&nbsp;or&nbsp;&lt;a&nbsp;href=&quot;https://github.com/mebjas/CSRF-Protector-PHP/issues/4#issuecomment-45292236&quot;&nbsp;target=&quot;_blank&quot;&gt;view&nbsp;it&nbsp;on&nbsp;GitHub&lt;/a&gt;.&lt;img&nbsp;alt=&quot;&quot;&nbsp;height=&quot;1&quot;&nbsp;src=&quot;https://github.com/notifications/beacon/3007365__eyJzY29wZSI6Ik5ld3NpZXM6QmVhY29uIiwiZXhwaXJlcyI6MTcxNzYzNDY3NiwiZGF0YSI6eyJpZCI6MzM4MDU0NTl9fQ==--7630bcb68a3dbd3fc6ec3b85aeb555c8b80657d4.gif&quot;&nbsp;width=&quot;1&quot;&gt;&lt;/p&gt;<br>
<br>
&lt;/div&gt;&lt;/div&gt;&lt;/blockquote&gt;&lt;/div&gt;&lt;br&gt;&lt;/div&gt;<br>

</tt>
