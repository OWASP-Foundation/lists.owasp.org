<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfprotector] Needs Decision
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfprotector%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfprotector%5D%20Needs%20Decision&In-Reply-To=%3C9C3F09D7-0D4B-4036-93C6-11C8838266F4%40owasp.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000025.html">
   <LINK REL="Next"  HREF="000027.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfprotector] Needs Decision</H1>
    <B>Abbas Naderi</B> 
    <A HREF="mailto:owasp-csrfprotector%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfprotector%5D%20Needs%20Decision&In-Reply-To=%3C9C3F09D7-0D4B-4036-93C6-11C8838266F4%40owasp.org%3E"
       TITLE="[Owasp-csrfprotector] Needs Decision">abiusx at owasp.org
       </A><BR>
    <I>Mon Jun  2 22:47:22 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000025.html">[Owasp-csrfprotector] Needs Decision
</A></li>
        <LI>Next message: <A HREF="000027.html">[Owasp-csrfprotector] Needs Decision
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26">[ date ]</a>
              <a href="thread.html#26">[ thread ]</a>
              <a href="subject.html#26">[ subject ]</a>
              <a href="author.html#26">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hello,
Answers inline! Good work so far, keep it up. I am very proud of your progress.
-A
______________________________________________________________
Notice: This message is digitally signed, its source and integrity are verifiable.
If you mail client does not support S/MIME verification, it will display a file (smime.p7s), which includes the X.509 certificate and the signature body.  Read more at Certified E-Mail with Comodo and Thunderbird in AbiusX.com

On Jun 2, 2014, at 2:55 PM, Minhaz A V &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">minhazav at gmail.com</A>&gt; wrote:

&gt;<i> Hi,
</I>&gt;<i> Here is the list of ideas, we need to decide, what to do:
</I>&gt;<i> 
</I>&gt;<i> In GET requests we are using an array of patterns to find weather we need to validate for current request (for ex: *://*/* would mean validate for each request). The function checking this, is called by static method. So it can be overridden by the developer, in case he want to apply his own logic for this (Suggested by Abbas +1), So I guess this would be a nice feature to have. [implementation]
</I>		It is a nice workaround. We can bloat it later if needed.
&gt;<i> 
</I>&gt;<i> For the above part to work, we need to have similar logic in our js file. to check which all urls it need to be rewritten/modified: so we can pass this patterns to the js file as parameters. [my idea]: we can keep our javascript part as php file, and pass the patterns as JSON string in POST query to this file. the php file would give js output, and it will be parsed well by browser.
</I>	If you are concerned that copying the same rules in JS would let an attacker know URLs that are protected for CSRF, thats actually not a very bad idea. They eventually can extract it one way or another, and it makes it much easier to find and fix flaws! Just convert rules to regex strings, and both Javascript and PHP run them the same.
&gt;<i> 
</I>&gt;<i> Jim suggested to use similar method, for POST requests. it has its own pros and cons.
</I>&gt;<i> PROS
</I>&gt;<i> not all POST need CSRF protection
</I>&gt;<i> no overhead of validating every request on server side, and attaching the cookie on client side for each request.
</I>&gt;<i> makes the library configurable to a great extend.
</I>&gt;<i> CONS  
</I>&gt;<i> It complicates the logic a little and adds to developer's efforts. 
</I>&gt;<i> checking if a particular url should be considered or not has a worst case complexity of O(n), where n is the no of patterns in config file. so if there are lots of urls to check, say k, complexity would be O(nk) for js. while it would be like O(1) if we check for every POST request.
</I>	I believe we can make this complement GET request, i.e all GET requests are not checked by default, and a list of those needing a check are provided. All POST requests should be checked by default, and a list of those deemed safe can be provided.
&gt;<i> logging function is avalilable at: <A HREF="https://github.com/mebjas/CSRF-Protector-PHP/blob/master/libs/csrf/csrfprotector.php#L298">https://github.com/mebjas/CSRF-Protector-PHP/blob/master/libs/csrf/csrfprotector.php#L298</A> needs to know if anything else we shall log?
</I>	This can always be updated. Dont bother bloating at start. Just add whatever you know you will use immediately.
&gt;<i> Do we need to provide some method to inform the admin in case of detection, like using mail?
</I>	Definitely, but for now just run a hook (a configurable command in the configurations, run in terminal).
&gt;<i> _______________________________________________
</I>&gt;<i> Owasp-csrfprotector mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">Owasp-csrfprotector at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfprotector/attachments/20140602/12b7ef6c/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-csrfprotector/attachments/20140602/12b7ef6c/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000025.html">[Owasp-csrfprotector] Needs Decision
</A></li>
	<LI>Next message: <A HREF="000027.html">[Owasp-csrfprotector] Needs Decision
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#26">[ date ]</a>
              <a href="thread.html#26">[ thread ]</a>
              <a href="subject.html#26">[ subject ]</a>
              <a href="author.html#26">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">More information about the Owasp-csrfprotector
mailing list</a><br>
</body></html>
