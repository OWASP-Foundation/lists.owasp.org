<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfprotector] Do login pages need CSRF protection?
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfprotector%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfprotector%5D%20Do%20login%20pages%20need%20CSRF%20protection%3F&In-Reply-To=%3CF82970FD-0C9A-4E3E-A35D-36553777AAA0%40owasp.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000045.html">
   <LINK REL="Next"  HREF="000047.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfprotector] Do login pages need CSRF protection?</H1>
    <B>Abbas Naderi</B> 
    <A HREF="mailto:owasp-csrfprotector%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfprotector%5D%20Do%20login%20pages%20need%20CSRF%20protection%3F&In-Reply-To=%3CF82970FD-0C9A-4E3E-A35D-36553777AAA0%40owasp.org%3E"
       TITLE="[Owasp-csrfprotector] Do login pages need CSRF protection?">abiusx at owasp.org
       </A><BR>
    <I>Sat Jun  7 01:01:17 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000045.html">[Owasp-csrfprotector] Do login pages need CSRF protection?
</A></li>
        <LI>Next message: <A HREF="000047.html">[Owasp-csrfprotector] Do login pages need CSRF protection?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46">[ date ]</a>
              <a href="thread.html#46">[ thread ]</a>
              <a href="subject.html#46">[ subject ]</a>
              <a href="author.html#46">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>They don&#8217;t even need XSS for that. They can just do it by forms or images.
And most effective CSRF attacks (like creating an admin user) rely on XSS, since XSS is very easy to find, but CSRF has a high impact.
-A
______________________________________________________________
Notice: This message is digitally signed, its source and integrity are verifiable.
If you mail client does not support S/MIME verification, it will display a file (smime.p7s), which includes the X.509 certificate and the signature body.  Read more at Certified E-Mail with Comodo and Thunderbird in AbiusX.com

On Jun 6, 2014, at 8:59 PM, Kevin W. Wall &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">kevin.w.wall at gmail.com</A>&gt; wrote:

&gt;<i> If there is are XSS vulnerabilities, then all bets are pretty much off with
</I>&gt;<i> CSRF tokens anyhow.
</I>&gt;<i> 
</I>&gt;<i> -kevin
</I>&gt;<i> 
</I>&gt;<i> On Fri, Jun 6, 2014 at 8:54 PM, Abbas Naderi &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">abiusx at owasp.org</A>&gt; wrote:
</I>&gt;&gt;<i> There is a major flaw not mentioned in the stackoverflow page, which I just
</I>&gt;&gt;<i> added as a comment:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Login forms need to be CSRF protected, because otherwise an attacker can
</I>&gt;&gt;<i> brute-force passwords or login using known passwords using XSS. For exmaple,
</I>&gt;&gt;<i> a XSS snippet could easily login and change your router&#8217;s DNS, to hijack all
</I>&gt;&gt;<i> your connections if the router login form is not CSRF protected.
</I>&gt;&gt;<i> -A
</I>&gt;&gt;<i> ______________________________________________________________
</I>&gt;&gt;<i> Notice: This message is digitally signed, its source and integrity are
</I>&gt;&gt;<i> verifiable.
</I>&gt;&gt;<i> If you mail client does not support S/MIME verification, it will display a
</I>&gt;&gt;<i> file (smime.p7s), which includes the X.509 certificate and the signature
</I>&gt;&gt;<i> body.  Read more at Certified E-Mail with Comodo and Thunderbird in
</I>&gt;&gt;<i> AbiusX.com
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> On Jun 6, 2014, at 6:06 PM, Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">jim.manico at owasp.org</A>&gt; wrote:
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Ok fair, this looks reasonable anti-automation to me.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> - Jim
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> -----Original Message-----
</I>&gt;&gt;<i> From: Kevin W. Wall [mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">kevin.w.wall at gmail.com</A>]
</I>&gt;&gt;<i> Sent: Friday, June 06, 2014 11:58 AM
</I>&gt;&gt;<i> To: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">Owasp-csrfprotector at lists.owasp.org</A>; Jim Manico
</I>&gt;&gt;<i> Subject: Do login pages need CSRF protection?
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> I know that this topic briefly came up and I think that the consensus was
</I>&gt;&gt;<i> that they didn't, but these two links give a different take on this so we
</I>&gt;&gt;<i> may wish to rethink this. In fact, I just found out that if the login pages
</I>&gt;&gt;<i> do NOT provide these, that they site the source code for incomplete CSRF
</I>&gt;&gt;<i> protection at Wells Fargo.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> <A HREF="http://seclab.stanford.edu/websec/csrf/csrf.pdf">http://seclab.stanford.edu/websec/csrf/csrf.pdf</A>
</I>&gt;&gt;<i> <A HREF="http://stackoverflow.com/questions/6412813/do-login-forms-need-tokens-against-csrf-attacks">http://stackoverflow.com/questions/6412813/do-login-forms-need-tokens-against-csrf-attacks</A>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> If you have chance to peruse these, maybe we can discuss if we want to
</I>&gt;&gt;<i> re-think Minhaz' approach to this during tonight's discussion.
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> Thanks,
</I>&gt;&gt;<i> -kevin
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Blog: <A HREF="http://off-the-wall-security.blogspot.com/">http://off-the-wall-security.blogspot.com/</A>
</I>&gt;&gt;<i> NSA: All your crypto bit are belong to us.
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> Owasp-csrfprotector mailing list
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">Owasp-csrfprotector at lists.owasp.org</A>
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector</A>
</I>&gt;&gt;<i> 
</I>&gt;&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> -- 
</I>&gt;<i> Blog: <A HREF="http://off-the-wall-security.blogspot.com/">http://off-the-wall-security.blogspot.com/</A>
</I>&gt;<i> NSA: All your crypto bit are belong to us.
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfprotector/attachments/20140606/2411617e/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-csrfprotector/attachments/20140606/2411617e/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000045.html">[Owasp-csrfprotector] Do login pages need CSRF protection?
</A></li>
	<LI>Next message: <A HREF="000047.html">[Owasp-csrfprotector] Do login pages need CSRF protection?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#46">[ date ]</a>
              <a href="thread.html#46">[ thread ]</a>
              <a href="subject.html#46">[ subject ]</a>
              <a href="author.html#46">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">More information about the Owasp-csrfprotector
mailing list</a><br>
</body></html>
