<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-csrfprotector] Needs Decision
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-csrfprotector%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfprotector%5D%20Needs%20Decision&In-Reply-To=%3CCADCpCkg3X%3Driym4bafvDxcRr3DAbV_S9osWNLr9EsWsVBN291Q%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000027.html">
   <LINK REL="Next"  HREF="000029.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-csrfprotector] Needs Decision</H1>
    <B>Minhaz A V</B> 
    <A HREF="mailto:owasp-csrfprotector%40lists.owasp.org?Subject=Re%3A%20%5BOwasp-csrfprotector%5D%20Needs%20Decision&In-Reply-To=%3CCADCpCkg3X%3Driym4bafvDxcRr3DAbV_S9osWNLr9EsWsVBN291Q%40mail.gmail.com%3E"
       TITLE="[Owasp-csrfprotector] Needs Decision">minhazav at gmail.com
       </A><BR>
    <I>Wed Jun  4 09:45:37 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000027.html">[Owasp-csrfprotector] Needs Decision
</A></li>
        <LI>Next message: <A HREF="000029.html">[Owasp-csrfprotector] Schedule for 1st GSoC hangout?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28">[ date ]</a>
              <a href="thread.html#28">[ thread ]</a>
              <a href="subject.html#28">[ subject ]</a>
              <a href="author.html#28">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Reply inline!

On Wed, Jun 4, 2014 at 7:43 AM, Kevin W. Wall &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">kevin.w.wall at gmail.com</A>&gt; wrote

While this likely may make the implementation a little bit more complex, I
&gt;<i> think
</I>&gt;<i> it will result in making your CSRF_Protector easier to use...and that is,
</I>&gt;<i> in
</I>&gt;<i> addition to providing a method that can be overridden to define what GET
</I>&gt;<i> URLs should get a CSRF token added, I would also suggest that you allow
</I>&gt;<i> some sort of simple pattern match to IGNORE all GET requests on certain
</I>&gt;<i> types of files. For instance, most GETs originate from requesting images,
</I>&gt;<i> JavaScript, and cascading style-sheets and you generally don't need CSRF
</I>&gt;<i> tokens for those (I suppose you could if you are implementing a GET
</I>&gt;<i> request
</I>&gt;<i> via an HTML form in JavaScript, but that's rare and hopefully there's a
</I>&gt;<i> better
</I>&gt;<i> way to handle such edge cases). But I was thinking about something like a
</I>&gt;<i> property that would take a list of file suffixes to disregard with
</I>&gt;<i> respect to CSRF
</I>&gt;<i> tokens when made via GETs. E.g.,
</I>&gt;<i>
</I>&gt;<i>     csrf_protector.get.ignore_suffix=.png,.gif,.jpg,.js,.css
</I>&gt;<i>
</I>&gt;<i> to ignore all PNG, GIF, JPEG, JavaScript, and cascading style sheets
</I>&gt;<i> requested via GETs. Those really are the bulk of the GET requests
</I>&gt;<i> anyway.
</I>&gt;<i>
</I>
+1 for your point Kevin, We'd have to take care of these while implementing
the Apache module. In case of php library all requests are validated for
php files only. So there will be no validation for js,css or images. Also,
if the developer do not want validation on any GET request, all he have to
do is keep the array of rules, empty in config file.


Regarding logging, you would want to log the client IP address (and/or
&gt;<i> proxied address,
</I>&gt;<i> X-Forwarded-For) if you can get them. Also, if you know the authenticated
</I>&gt;<i> user
</I>&gt;<i> name and have a uniform way to obtain it, that also is very useful.  I
</I>&gt;<i> know you
</I>&gt;<i> were talking about saving a hash of the session ID; I don't see it
</I>&gt;<i> there, but perhaps
</I>&gt;<i> that is what this is supposed to be:
</I>&gt;<i>
</I>&gt;<i>      $log['cookie'] = $_COOKIE;
</I>&gt;<i>
</I>&gt;<i> I just don't know enough about PHP to know what that means....but in
</I>&gt;<i> general,
</I>&gt;<i> I don't think you really want to log cookies, even if this is *only*
</I>&gt;<i> the session ID.
</I>&gt;<i> If may be low risk in most situations, but if you consider insider
</I>&gt;<i> attacks, in some
</I>&gt;<i> scenarios, logging session IDs would be forbidden where I work today.
</I>&gt;<i>
</I>
Each web app has its own way of storing user ids or other credentials. I
guess best method here would be to allow the developer to override the
default logging function, in case they want to log more/less data.
About storing session Id in hash, in this case we will need database
support. And If we are using database to map, hash to session id, isn't it
better to actually save logs to db itself? And if you are suggesting that
we should not log sessionid at all, how can we detect the victim of attack?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-csrfprotector/attachments/20140604/c8899d76/attachment.html">http://lists.owasp.org/pipermail/owasp-csrfprotector/attachments/20140604/c8899d76/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000027.html">[Owasp-csrfprotector] Needs Decision
</A></li>
	<LI>Next message: <A HREF="000029.html">[Owasp-csrfprotector] Schedule for 1st GSoC hangout?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#28">[ date ]</a>
              <a href="thread.html#28">[ thread ]</a>
              <a href="subject.html#28">[ subject ]</a>
              <a href="author.html#28">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-csrfprotector">More information about the Owasp-csrfprotector
mailing list</a><br>
</body></html>
