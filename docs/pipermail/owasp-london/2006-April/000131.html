<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-london] London WAF event and HacmeBank
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-london%40lists.owasp.org?Subject=%5BOwasp-london%5D%20London%20WAF%20event%20and%20HacmeBank&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000130.html">
   <LINK REL="Next"  HREF="000132.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-london] London WAF event and HacmeBank</H1>
    <B>Dinis Cruz</B> 
    <A HREF="mailto:owasp-london%40lists.owasp.org?Subject=%5BOwasp-london%5D%20London%20WAF%20event%20and%20HacmeBank&In-Reply-To="
       TITLE="[Owasp-london] London WAF event and HacmeBank">dinis at ddplus.net
       </A><BR>
    <I>Sun Apr 23 21:08:02 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000130.html">[Owasp-london] OWASP training
</A></li>
        <LI>Next message: <A HREF="000132.html">[Owasp-london] [Fwd: London WAF event - Addidional vulnerabilities]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#131">[ date ]</a>
              <a href="thread.html#131">[ thread ]</a>
              <a href="subject.html#131">[ subject ]</a>
              <a href="author.html#131">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Since you might be interested, I am forwarding the email sent to the WAF
vendors that will participate on the next Owasp-London chapter event.

Note 1: The server mentioned (<A HREF="http://209.97.215.160">http://209.97.215.160</A>) is a server that I
just got from Rackspace and is currently dedicated for HacmeBank and
SiteGenerator tests. For obvious reasons, most of the server's pages are
password protected (except the install folder which is available to
anonymous users). If  you want to have access to this server (for
example to test HacmeBank V2 or SiteGenerator),  drop me an email with a
promise that you will not blow up the server (using HacmeBank's or
SiteGenerator's vulnerabilities) and I will send you an account to use.

Note 2: At the end, I've included a 'quick &amp; dirty' list of HacmeBank
vulnerabilities and exploits (organized using the Owasp Top 10)

Best regards

Dinis Cruz
Owasp .Net Project
www.owasp.net



-------- Original Message --------

Subject: 	London WAF event - Operational notes
Date: 	Mon, 24 Apr 2006 01:28:18 +0100
From: 	Dinis Cruz &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">dinis at ddplus.net</A>&gt;



Dear F5, Imperva, NetContinuum, Fortify and Breach

Here are a couple operational notes for this Tuesday's Owasp-London WAF
event.

    * The objective of this event is to create an environment where you
      (WAF vendor) are able to show your product in a scenario where
      WAFs add real value and business benefits. Please use it wisely
      since the audience is made of your potential clients.
    * For practical reasons (and due to a bug in SiteGenerator which is
      causing it to misbehave in some installation environments) we will
      use the latest version of Foundstone's HacmeBank (also Open Source
      and also developed by me)
    * I want you to focus your 15m/20m slot on how your product is able
      to mitigate against vulnerabilities that exist in HacmeBank.
    * At the end of this email I am including the specific HacmeBank
      vulnerabilities that I want to you to focus on (i.e. mitigate).
    * Ideally you should do a live demo since you (if participating)
      will have the products at InfoSec. This will help to maximize the
      impact of your presentation,
          o If that is not possible , then you can show pre-recorded
            videos (using for example Snag It). These videos can also be
            used as a backup in case there are some technical issues on
            the day
          o Please don't bring PowerPoints about your product. That said
            I don't see a problem with you making available to the
            audience marketing material about your product (i.e.
            brochures, CDs, etc...)
    * The version of HacmeBank that will be used is v2.00 which you can
      download from <A HREF="http://209.97.215.160/install:">http://209.97.215.160/install:</A>
          o Web Services installer:
            <A HREF="http://209.97.215.160/install/Hacme_Bank_WebService_Setup%20v2.0%20-%2018%20April%202006.msi">http://209.97.215.160/install/Hacme_Bank_WebService_Setup%20v2.0%20-%2018%20April%202006.msi</A>
          o Website Installer:
            <A HREF="http://209.97.215.160/install/Hacme_Bank_Website_Setup%20v2.0%20-%2018%20April%202006.msi">http://209.97.215.160/install/Hacme_Bank_Website_Setup%20v2.0%20-%2018%20April%202006.msi</A>
          o HacmeBank User and Solution guide (pdf):
            <A HREF="http://209.97.215.160/install/Foundstone%20Hacme%20Bank%20User%20and%20Solution%20Guide%20v2.1.pdf">http://209.97.215.160/install/Foundstone%20Hacme%20Bank%20User%20and%20Solution%20Guide%20v2.1.pdf</A>
    * In order to facilitate your tests I have set-up a server which you
      can use. This server contains a fully operational version of
      HacmeBank and you can access it here <A HREF="http://209.97.215.160">http://209.97.215.160</A> using
      the user name and password which I will send you in my next email.
    * Two changes on the event's schedule and presentations:
          o Fortify will not present the Asp.Net version of their WAF
            solution (still under development). Fortify will present how
            their J2EE solution is able to mitigate Owasp's Web Goat
            vulnerabilities.
          o Breach Security will be also participate

I known that you (WAF vendor) is having limited amount of time to
prepare for this event, but (on the positive side)  it does accurately
simulate a scenario where:

    * &quot;...  critical vulnerabilities have been identified on a very
      important website ...&quot;
    * &quot;.... no code changes can be made ...&quot;
    * &quot;.... vulnerabilities MUST be mitigated as soon as possible ...&quot;


Deployment is another area which I (and the event's audience) will be
very interested in, namely:

    - WAF installation and setup -  how long does it take to get the
appliance installed and working
    - 'Patch' rules deployment - how long does it take the to install
and active the relevant rules

I understand why some of you are having some reservations in bringing
the WAF appliance to the pub and setting it up there. All I will say
that if you do it (and it all goes smoothly) you will score a lot of
points with your potential clients. After all, if you are not able to
install and deploy your product in such environment, what changes will
your clients have when faced with a similar situation (having to deploy
ASAP a WAF on a site under attack ).

For me the the best WAF solution will be the one that :
    - is installed with minimum changes to the current environment,
    - is quick to install and activate
    - allows a quick and flexible upload/update of rules (i.e. patches
for known vulnerabilities)
    - has NO impact on the pages that have no rules assigned to

This last point is very important. When deploying a WAF on an existing
website, there is no margin for error on pages/forms that are not
affected by the vulnerabilities targeted by the WAF (i.e. the WAF cannot
have any negative side-effects).

The final objective is to resolve 100% of the known vulnerabilities 
with no negative impact on the website's functionality.

Please see at the end of this email the list of the HacmeBank
vulnerabilities that I want you to focus your presentation on.

Best regards

Dinis Cruz
Owasp .Net Project
www.owasp.net


----------------------------------------------------------------------------------------
HacmeBank v2.0 vulnerabilities (organized using the Owasp Top 10)
----------------------------------------------------------------------------------------

A1 Unvalidated Input

    Vulnerability: Account Transfer validation for negative values is
only performed at the client:
    Exploit: Use a proxy (or a browser tamper plugin) to inject a
negative number in the Form
<A HREF="http://209.97.215.160/aspx/main.aspx?function=AccountTransfer">http://209.97.215.160/aspx/main.aspx?function=AccountTransfer</A> (this will
transfer an amount TO the source account FROM the target account (i.e.
the opposite of expected behavior)

    Vulnerability: Maximum number of login attempts is controlled by
client-side cookie
    Exploit: Use a proxy (or a browser tamper plugin) to change the
value of the CookieLoginAttempts (for example to 5000)


A2 Broken Access Control:
   
    Vulnerability: Admin pages available to anonymous users:
    Exploit after login, a normal user is able to access the following
admin pages:
        <A HREF="http://209.97.215.160/aspx/Main.aspx?function=admin\Fetch_Web_Page">http://209.97.215.160/aspx/Main.aspx?function=admin\Fetch_Web_Page</A>
        <A HREF="http://209.97.215.160/aspx/Main.aspx?function=admin\Manage_Accounts">http://209.97.215.160/aspx/Main.aspx?function=admin\Manage_Accounts</A>
        <A HREF="http://209.97.215.160/aspx/Main.aspx?function=admin\Manage_Messages">http://209.97.215.160/aspx/Main.aspx?function=admin\Manage_Messages</A>
        <A HREF="http://209.97.215.160/aspx/Main.aspx?function=admin\Manage_Users">http://209.97.215.160/aspx/Main.aspx?function=admin\Manage_Users</A>
        <A HREF="http://209.97.215.160/aspx/Main.aspx?function=admin\Sql_Query">http://209.97.215.160/aspx/Main.aspx?function=admin\Sql_Query</A>
        <A HREF="http://209.97.215.160/aspx/Main.aspx?function=admin\Web_Services">http://209.97.215.160/aspx/Main.aspx?function=admin\Web_Services</A>
       
        Note: these pages must be available to valid administrators

A3 Broken Authentication
   
    Vulnerability: Session Hijacking via ASP.NET_Session cookie
    Exploit: discover a valid ASP.NET_Session cookie, and hijack that
account by changing the cookie on the browser or injecting it via a proxy

    Vulnerability: Admin site protected with weak cookie
    Exploit: Access to the admin site is controlled by a client side
cookie called 'admin' (On login, this value is false, and set to true
after successful Response to the Challenge posted here
<A HREF="http://209.97.215.160/aspx/main.aspx?function=AdminSection">http://209.97.215.160/aspx/main.aspx?function=AdminSection</A>). To access
the admin area, login as a normal user and change the value of the
'admin' cookie from false to true

    Vulnerability: WebServices are accessible by anonymous users:
    Exploit: Access the WebServices directly
   
A4 Cross site Scripting (XSS):

    Vulnerability: Cross site Scripting (XSS)
    Exploit: Insert XSS payload in:
        - Account Transfer 'Comment': field
<A HREF="http://209.97.215.160/aspx/main.aspx?function=AccountTransfer">http://209.97.215.160/aspx/main.aspx?function=AccountTransfer</A>
        - Request a Loan' 'Comment' field:
<A HREF="http://209.97.215.160/aspx/main.aspx?function=Loan">http://209.97.215.160/aspx/main.aspx?function=Loan</A>
        - Post Message 'Subject' or 'Text' fields:
<A HREF="http://209.97.215.160/aspx/main.aspx?function=PostMessageForm">http://209.97.215.160/aspx/main.aspx?function=PostMessageForm</A>

A6 Injection Flaws

    Vulnerability: SQL Injection
    Exploit: Insert SQL payload in:
        - Login Page 'Username' or 'Password' fields:
<A HREF="http://209.97.215.160/aspx/main.aspx?function=PostMessageForm">http://209.97.215.160/aspx/main.aspx?function=PostMessageForm</A>
        - Transaction Details account_no GET field:
<A HREF="http://209.97.215.160/aspx/Main.aspx?function=TransactionDetails&amp;account_no=5204320422040001">http://209.97.215.160/aspx/Main.aspx?function=TransactionDetails&amp;account_no=5204320422040001</A>
        - Account Transfer 'Comment': field
<A HREF="http://209.97.215.160/aspx/main.aspx?function=AccountTransfer">http://209.97.215.160/aspx/main.aspx?function=AccountTransfer</A>
        - Request a Loan' 'Comment' field:
<A HREF="http://209.97.215.160/aspx/main.aspx?function=Loan">http://209.97.215.160/aspx/main.aspx?function=Loan</A>
        - Post Message 'Subject' or 'Text' fields:
<A HREF="http://209.97.215.160/aspx/main.aspx?function=PostMessageForm">http://209.97.215.160/aspx/main.aspx?function=PostMessageForm</A>

A7 Improper Error Handling
    Vulnerability: Detailed error messages sent to client:
    Exploit: Force SQL errors on:
        - Login Page 'Username' or 'Password' fields:
<A HREF="http://209.97.215.160/aspx/main.aspx?function=PostMessageForm">http://209.97.215.160/aspx/main.aspx?function=PostMessageForm</A>   
        - Account Transfer 'Comment': field
<A HREF="http://209.97.215.160/aspx/main.aspx?function=AccountTransfer">http://209.97.215.160/aspx/main.aspx?function=AccountTransfer</A>
        - Request a Loan' 'Comment' field:
<A HREF="http://209.97.215.160/aspx/main.aspx?function=Loan">http://209.97.215.160/aspx/main.aspx?function=Loan</A>

A8 Insecure Storage:
    Vulnerability: SessionState contains Challenge's Response
    Exploit: 1) Decode the ViewState from the Admin Section login page
(<A HREF="http://209.97.215.160/aspx/main.aspx?function=AdminSection">http://209.97.215.160/aspx/main.aspx?function=AdminSection</A>), 2)
discover the Challenge's Response value in the decoded ViewState, and 3)
use that value to login to the admin area (the Challenge's Response
value is stored in a Asp.net control which is marked with
'visible=false' (but still stored in the ViewState))

    Vulnerability: Challenge's Response weak encryption
    Exploit: Brute force the Challenge's Response since it is calculated
by XORing the Challenge against a simple number

A10 Insecure Configuration Management

    Vulnerability: Directory Listing Enabled
    Exploit: Open the page <A HREF="http://209.97.215.160/install/">http://209.97.215.160/install/</A>   

















</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000130.html">[Owasp-london] OWASP training
</A></li>
	<LI>Next message: <A HREF="000132.html">[Owasp-london] [Fwd: London WAF event - Addidional vulnerabilities]
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#131">[ date ]</a>
              <a href="thread.html#131">[ thread ]</a>
              <a href="subject.html#131">[ subject ]</a>
              <a href="author.html#131">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-london">More information about the Owasp-london
mailing list</a><br>
</body></html>
