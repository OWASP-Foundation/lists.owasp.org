<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-london] [Fwd: London WAF event - Addidional vulnerabilities]
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-london%40lists.owasp.org?Subject=%5BOwasp-london%5D%20%5BFwd%3A%20London%20WAF%20event%20-%20Addidional%20vulnerabilities%5D&In-Reply-To=">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000131.html">
   <LINK REL="Next"  HREF="000137.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-london] [Fwd: London WAF event - Addidional vulnerabilities]</H1>
    <B>Dinis Cruz</B> 
    <A HREF="mailto:owasp-london%40lists.owasp.org?Subject=%5BOwasp-london%5D%20%5BFwd%3A%20London%20WAF%20event%20-%20Addidional%20vulnerabilities%5D&In-Reply-To="
       TITLE="[Owasp-london] [Fwd: London WAF event - Addidional vulnerabilities]">dinis at ddplus.net
       </A><BR>
    <I>Mon Apr 24 18:10:34 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000131.html">[Owasp-london] London WAF event and HacmeBank
</A></li>
        <LI>Next message: <A HREF="000137.html">[Owasp-london] HacmeBank PenTest Report
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#132">[ date ]</a>
              <a href="thread.html#132">[ thread ]</a>
              <a href="subject.html#132">[ subject ]</a>
              <a href="author.html#132">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Here are a couple more interesting vulnerabilities from HacmeBank (Note:
most are not mentioned in the Foundstone HacmeBank 2.0 User Guide pdf)

Dinis

-------- Original Message --------
Subject: 	London WAF event - Addidional vulnerabilities


Dear F5, Imperva, NetContinuum, Fortify and Breach

Following the positive response (from some of you) regarding the
successful mitigation of most of the vulnerabilities included on my last
email, here are 6 additional vulnerabilities (harder to mitigate):

    Vulnerability: Users are able to access account details belonging to
other users:
    Exploit: log-in as user jv and open the page
<A HREF="http://209.97.215.160/aspx/Main.aspx?function=TransactionDetails&amp;account_no=5204320422040001">http://209.97.215.160/aspx/Main.aspx?function=TransactionDetails&amp;account_no=5204320422040001</A>
    replace the 'account_no' GET value with 5204320422040003 (i.e.
<A HREF="http://209.97.215.160/aspx/Main.aspx?function=TransactionDetails&amp;account_no=5204320422040003">http://209.97.215.160/aspx/Main.aspx?function=TransactionDetails&amp;account_no=5204320422040003</A>)
and note that you are now accessing account details belonging to another
user (in this case the user jm)

    Vulnerability: Old Password requirement is not enforced in 'Change
Password' page    
    Exploit: Hijack user session (using for example a valid user's
Session Cookie), open the page
<A HREF="http://209.97.215.160/aspx/main.aspx?function=PasswordChange">http://209.97.215.160/aspx/main.aspx?function=PasswordChange</A> and change
that user's password (without knowledge of that user's current password)

    Vulnerability: ViewState replay vulnerability
    Exploit: The source account on the Transfer Funds page
(<A HREF="http://209.97.215.160/aspx/main.aspx?function=AccountTransfer">http://209.97.215.160/aspx/main.aspx?function=AccountTransfer</A>) is
controlled by ViewState. This means that the attacker cannot change this
value by POST form injection, but means that if the attacker is able to
grab a valid ViewState from another user (via Xss, cached copy of that
page on a Hard Disk or by sniffing the traffic), it can replay that
ViewState and make transfers from that account (to an external account).

    Vulnerability: Web Services Session ID is not enforced
    Exploit: Invoke the web services directly without needing a valid
SessionID.
    Solution: the correct resolution of this vulnerability is one where
the Web Services are still publicly available but control to the exposed
Web Services functionality is managed via the SessionID

    Vulnerability: 'WAF redirect on attack detection' information leak
    Exploit: The normal WAF functionality of redirecting attacks
detected to a custom error pages, provides information to attackers that
such type of defense (WAF) is in use, and creates very dangerous 'False
Positive' situations where valid user's input could be wrongly flagged -
something that would severely affect the user experience and business
value (imagine a user filling a 4 page web form being redirected to the
error page on the last page).
    Solution: Dynamically 'normalize' potentially malicious input. For
example, on a Form field vulnerable to SQL Injection, rewrite that field
with only the allowed chars (for example letters and numbers) and flag
an attack

    Vulnerability: &quot;How do we know we are being attacked?&quot;
    Exploit: Attack the website via 1) the vulnerabilities that are not
'patched' or 2) pages not protected by WAF (i.e. with no rules applied)
    Solution: Alert WAF operational staff when such attacks are occurring

Finally here is one last question and demo request: &quot;If your WAF has a
Web Interface, are you able to protect it using your WAF?&quot;

After all presentations are done, there will be Panel Discussion (with a
representative from each WAF vendor) where we will discuss ideas and
solutions for the mitigation of the most complex vulnerabilities.

Best regards

Dinis Cruz
Owasp .Net Project
www.owasp.net  





</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000131.html">[Owasp-london] London WAF event and HacmeBank
</A></li>
	<LI>Next message: <A HREF="000137.html">[Owasp-london] HacmeBank PenTest Report
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#132">[ date ]</a>
              <a href="thread.html#132">[ thread ]</a>
              <a href="subject.html#132">[ subject ]</a>
              <a href="author.html#132">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-london">More information about the Owasp-london
mailing list</a><br>
</body></html>
