<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [Owasp-london] RE: Owasp-london digest, Vol 1 #78 - 4 msgs
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-london%40lists.owasp.org?Subject=%5BOwasp-london%5D%20RE%3A%20Owasp-london%20digest%2C%20Vol%201%20%2378%20-%204%20msgs&In-Reply-To=20060501224901.AF00F33F07%40sc8-sf-spam1.sourceforge.net">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000135.html">
   <LINK REL="Next"  HREF="000136.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Owasp-london] RE: Owasp-london digest, Vol 1 #78 - 4 msgs</H1>
    <B>David Munge</B> 
    <A HREF="mailto:owasp-london%40lists.owasp.org?Subject=%5BOwasp-london%5D%20RE%3A%20Owasp-london%20digest%2C%20Vol%201%20%2378%20-%204%20msgs&In-Reply-To=20060501224901.AF00F33F07%40sc8-sf-spam1.sourceforge.net"
       TITLE="[Owasp-london] RE: Owasp-london digest, Vol 1 #78 - 4 msgs">david.munge at equallykeen.com
       </A><BR>
    <I>Tue May  2 06:55:35 EDT 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000135.html">[Owasp-london] Re: [WEB SECURITY] Re: [Owasp-dotnet] Review of Owasp-London Chapter meeting on WAF (Web Application Firewalls)
</A></li>
        <LI>Next message: <A HREF="000136.html">[Owasp-london] Re: [WEB SECURITY] Review of Owasp-London Chapter meeting on WAF (Web Application Firewalls)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#140">[ date ]</a>
              <a href="thread.html#140">[ thread ]</a>
              <a href="subject.html#140">[ subject ]</a>
              <a href="author.html#140">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>As a completely non technical OWASP follower (there are some) I thought I
might add a comment on the WAF shoot out organised by Dinis, in London the
other evening.  By the way it's a great compliment to Dinis's energy and
enthusiasm that the evening took place.

The standard of the presentations was very varied. f5 deserve credit for
fronting up, paying for the evening, and it was interesting that at least
one of their senior managers attended. As a non techi I found f5's
presentation suited my level the best.

There can be no pretense that the evening could be taken too seriously by
any company thinking of buying a WAF solution. There are just as many
questions unanswered from the evening as answered. However the strength of
such a meeting is the ability of both vendors and OWASP to build bridges and
to start to communicate with each other.

The requirement in security at all levels for belt and braces is paramount,
and it needs both sides of the argument to recognise this.

Dinis brings up the old issue of WASS and WAFS talking to each other, AVDL
was designed to make this happen, but there does not seem to be the will in
the vendor sector to make such a sensible idea happen.

What about starting with OWASP tools?

David Munge


-----Original Message-----
From: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london-admin at lists.sourceforge.net</A>
[mailto:<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london-admin at lists.sourceforge.net</A>] On Behalf Of
<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london-request at lists.sourceforge.net</A>
Sent: Monday, May 01, 2006 11:48 PM
To: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london at lists.sourceforge.net</A>
Subject: Owasp-london digest, Vol 1 #78 - 4 msgs

Send Owasp-london mailing list submissions to
	<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london at lists.sourceforge.net</A>

To subscribe or unsubscribe via the World Wide Web, visit
	<A HREF="https://lists.sourceforge.net/lists/listinfo/owasp-london">https://lists.sourceforge.net/lists/listinfo/owasp-london</A>
or, via email, send a message with subject or body 'help' to
	<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london-request at lists.sourceforge.net</A>

You can reach the person managing the list at
	<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london-admin at lists.sourceforge.net</A>

When replying, please edit your Subject line so it is more specific
than &quot;Re: Contents of Owasp-london digest...&quot;


Today's Topics:

   1. Review of Owasp-London Chapter meeting on WAF (Web Application
Firewalls) (Dinis Cruz)
   2. [WEB SECURITY] Review of Owasp-London Chapter meeting on WAF (Web
Application Firewalls) (Dinis Cruz)
   3. Re: [WEB SECURITY] Review of Owasp-London Chapter meeting on WAF
       (Web Application Firewalls) (Dinis Cruz)

--__--__--

Message: 1
Date: Mon, 01 May 2006 10:59:58 +0100
From: Dinis Cruz &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">dinis at ddplus.net</A>&gt;
To: &quot;'<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-dotnet at lists.sourceforge.net</A>'&quot;
&lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-dotnet at lists.sourceforge.net</A>&gt;,
  <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london at lists.sourceforge.net</A>,  <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">webappsec at securityfocus.com</A>, 
 <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">websecurity at webappsec.org</A>
Subject: [Owasp-london] Review of Owasp-London Chapter meeting on WAF (Web
Application Firewalls)

Hello

Here is my brain dump about what happened (from my point of view of 
course) last Tuesday (25th April) on the Owasp London Chapter meeting 
(hosted on a central London pub).

As you can read here 
(<A HREF="http://sourceforge.net/mailarchive/forum.php?thread_id=10209024&amp;forum_id=40">http://sourceforge.net/mailarchive/forum.php?thread_id=10209024&amp;forum_id=40</A>
284), 
here 
(<A HREF="http://sourceforge.net/mailarchive/forum.php?thread_id=10232868&amp;forum_id=40">http://sourceforge.net/mailarchive/forum.php?thread_id=10232868&amp;forum_id=40</A>
284) 
and here 
(<A HREF="http://sourceforge.net/mailarchive/forum.php?thread_id=10239385&amp;forum_id=40">http://sourceforge.net/mailarchive/forum.php?thread_id=10239385&amp;forum_id=40</A>
284) 
the theme of the night was &quot;Web Application Firewalls (WAF): Where do 
they add value and who should be using them&quot;. After a public invite for 
participation, 4 vendors committed to come in an present their WAF 
appliances: F5, Imperva, Breach and Fortify (I should actually say 3 WAF 
Appliance vendors since Fortify presented a similar tool with a 
different approach).

My objective with this presentation was to go beyond the Marketing BS 
and discuss the type of issues that these tools:

    - are able to defend out of the box (i.e. with minor configuration's 
by the user)
    - are able to defend with some customization
    - are NOT able to defend

I was also very interested in the usability of the tools and the user 
experience of the WAFifyed website  (i.e. what happens when a potential 
attack is detected).

To level the playing field, each vendor was given a vulnerable website 
that they needed to protect. This website was Foundstone's HacmeBank 
v2.0 (the original plan was to use Owasp's SiteGenerator but some 
vendors had some problems in getting it to work (prob with windows 2003 
SP1 I think), so due to time constrains we used the new version of 
HacmeBank (2.0) which is very stable and feature (i.e. vulnerability) 
rich :)

To give an extra humph to the event (and to justify the tight deadlines) 
I added the element &quot;Hacme Bank is under attack, here are the exploit 
vectors being used, your mission is to patch this system as soon as 
possible and stop the attackers&quot;. It should be noted that the vendors 
did not had a lot of time in their hands (from receiving the list of 
vulnerabilities to patch to the event).

For reference, here is a PDF (created using the new Owasp PenTest 
Reporter tool) describing all vulnerabilities: 
&quot;<A HREF="http://209.97.215.160/install/Hacme">http://209.97.215.160/install/Hacme</A> Bank Pentest Report (created by 
Owasp PenTest Reporter) - ).pdf&quot; .

Now that the scenario is set, here are my brain dump of the night:

    1) Firstly I am happy that the 4 vendors made it, that we had a good 
number of attendees (although not all Owasp London Chapter members :) 
and that the  F5 sponsorship went ok (with paid: pub dedicated to event, 
plasma screen, open bar and food)

    2) The audio recording also went ok, so give me a couple days and I 
will upload it to a server on MP3 format (need to do some audio 
normalization and minor editing)

    3) On the presentations it self (in the order they were made):
          a) F5
               - Brought their WAF Appliance (1U Rack) and did a live 
presentation
               - Showed several demos on the HacmeBank vulnerabilities 
(XSS, SQL Injection, Cookies)
               - Discussed briefly some advanced options that their 
product has: Leveraging the BigIP scripting capabilities, protecting 
admin pages by forcing a certain 'navigation path'
                - Maybe because this was the first presenter, but they 
really run out of time (the 20m minutes allocated were religiously 
enforced). I did felt that the presenter at times went over the top on 
the explanations given, and spent too much time on simple stuff. 
Basically I would had preferred if he gave the presentation at twice the 
pace covering twice the material.
          b) Imperva
               - Brought their WAF Appliance (1U Rack) and did a live 
presentation
               - Similar to F5, showed several demos on the HacmeBank 
vulnerabilities (XSS, SQL Injection, Cookies) covering roughly the same 
material
               - Shown very powerful functionality on their product, 
namely the Forms / Cookie rules creation user interface
               - Had several problems during the presentation (e.g. some 
demos that didn't work)
          c) Breach
               - No WAF Appliance, videos shown instead
               - A couple too many slides for my taste, and not enough 
demos.
               - That said, I liked Ofer style and he has clearly a very 
good technical understanding of the WAF world (he is also the organizer 
of the Owasp Chapter in Israel)
               - I didn't particularly agree with the concept of &quot;Dinis 
WAF Requirements&quot;, which imply that what I was asking the WAF vendors is 
very advanced, difficult and has very little customer demand.
          d) Fortify
               - Fortify didn't present a WAF Appliance. They took the 
concept of WAF and applied it to the actual targeted application. Steps 
used by their product: 1) reverse engineering the J2EE application, 2) 
identify the attack surface, 3) identify insecure coding practices, 4) 
apply 'security protection layers' were necessary, and 5) monitor and 
report malicious activity. Due to the fact that their .Net product is 
still under development, Fortify's demo was based on the Owasp Web Goat 
tool.
               - I was quite impressed with their solution and can see 
real-live cases where it could be very effective (especially since some 
of the security vulnerabilities that I want to address via a WAF 
solution can only be made at the Application layer)
               - The main problem with this solution is that it requires 
a binary change/redeployment of the targeted application, and it still a 
very young product (e.g. not used by a large number of clients to 
protect mission critical web applications)
 
[this next set of comments apply mainly to the 3 WAF vendors]

   5) Coming back to the WAF Appliance presentations, there are a couple 
of comments that I have to make:

        a) The presentations were all very BASIC (as in Simplistic). 
Come on!!!! doing an SQL injection or cookies demo using Paros? That is 
'so' last century. I was expecting at least some Unit Tests or custom 
use of Web Application Security Scanners. But Paros? (or for that mater 
Web Scarab, Fiddler, Firefox/IE Tamper request, @Stake Web Proxy, 
etc...). My problem here is not that such tool(s) were used, but the 
fact that they don't allow for the automated test of the numerous 
variations that exploits like SQL Injection have. Remember that the 
WAF's must be able to detect ALL (or most) types of SQL Injections (not 
only the ones with a quote). Think of the problems that IDS have in 
detecting RPC traffic, the WAF will have exactly the same types of issues.

        b) I might be wrong on this one, but I do get the feeling that 
these WAF vendors have a good understanding of 'data validation' attacks 
( SQL Injection, XSS, Cookies, etc) but fail to grasp the security 
implications of (for example) application logic attacks (like the one in 
Hacme Bank where user A is able to access data from user B). More 
worryingly, they seem happy with this situation since (from their point 
of view) their clients don't need that functionality.

       c) Where are the published independent security reviews of these 
products? I find amazing that vendors that are selling a 'security 
product', e.g. a software application (WAF) that protects other software 
applications (Websites), do not understand the value of hiring 
independent 3rd party security companies to perform source code security 
audits to their products (note that the final results of these audits 
must be published and made available to clients). As discussed during 
the panel, it is probably impossible to create bug/vulnerability free 
applications, but to NOT perform independent security audits to their 
code is crazy. Since these vendors are still in the 'Functionality Arms 
Race' phase of their products. Basically, the development teams are more 
focused on features, performance and user experience than on Security 
(and I don't have to tell you how 'secure' apps developed like this tend 
to be :). Maybe the solution is to put a WAF protecting a WAF protecting 
a WAF protecting a website :). Note to vendors: If am am wrong in this 
comment, feel free to prove me wrong and publish the security audits 
performed on your current product(s).

       d) another area which I still think the WAF don't get it, is the 
fact that no solution allows for the easy manipulation of the data being 
analyzed (both at input and at output). At the moment you only have two 
choices: 1) let the request go, 2) block the request and either show a 
custom error page or logout the user. This is to radical. We need the 
ability to change the contents of form fields (or page contents) 
dynamically. This will be the only way that some vulnerabilities can be 
effectively managed and mitigated (while limiting the damage cause by 
false positives). Note: same WAFs have the functionality to replace 
cookies with their own (WAF controlled value)

       e) Why don't they use their WAFs to protect the WAF's web 
interface? Clearly a great test for the usability of a WAF product is to 
use it to protect the complex GUIs used on the WAF management and 
monitoring. Also, when (not if) vulnerabilities are found in their 
product, they could use their WAF to mitigate those security issues.

       g) And what about their website? Are the vendor's websites 
protected by their WAFs?

       h) To the other companies/products that want to get into the WAF 
market, advice to them is: &quot;Create a WAF that allows a good PenTester to 
mitigate 90%+ of the vulnerabilities that he/she discovered&quot;. Basically, 
grab HacmeBank and SiteGenerator and use it to take your product were 
the current WAF vendors don't seem to want to go.

       i) What about the Web Application Firewall Evaluation Criteria 
(<A HREF="http://www.webappsec.org/projects/wafec/">http://www.webappsec.org/projects/wafec/</A>)? How do this WAF appliances 
rate to this? I might have missed it, but where is the public disclose 
of this information?

    6) After thinking about what happened for a couple days, and trying 
to come up with an explanation for the issues raised on item 5), I think 
that I came up with an answer. The problem is that the WAF technical 
teams don't have Web Penetration Testing experience. They have a 
reasonable level of understanding on how to attack an web application, 
but they are missing the advanced material (I am also puzzled by the 
lack of use of Web Application Security Scanners (WASS)). Maybe the 
solution is for a WAF company and a WASS company to merge and maximize 
the skills sets of both.

    7) Please take my comments with a pinch of salt :) . It is to late 
at night here and I am just doing a brain dump :)

    8) Moving forward, here are some ideas:

          a) Expand the current Hacme Bank challenge to all WAF vendors 
and see who is able to mitigate what. I already asked the 4 WAF vendors 
that participated on the London event to send me the list of issues 
(from Hacme Bank v2.0) that they product is: 
                * Able to protect with default functionality
                * Able to protect with Customization     
                * Not able to protect

          b) Implement all documented HacmeBank vulnerabilities in 
SiteGenerator (also add different types of navigation)

          c) help to organize other Owasp chapter events around the 
world on the same subject and using the same model (Owasp chapter 
leaders let-me know if you are interested)

          d) Implement the Foundstone Validator .Net tool on HacmeBank 
to show how most of those security issues can be resolved when the WAF 
has access to the application layer

          e) write a white paper about WAFs focusing on where they 
should be used and on where they are not effective

          f) expand the analysis of the Hacme Bank vulnerabilities and 
discuss how they could/should be mitigated at WAF

    9) Finally, I just want to give a warning to the WAF  vendors: &quot;you 
must make your appliance invisible to attackers&quot;. By invisible I mean 
that it should not be possible to fingerprint your appliance remotely 
from the Internet. Because if you do allow this to occur, then you 
dramatically increase the risk to your clients of being exploited by a 
vulnerability in your WAF (and remember the Witty worm 
(<A HREF="http://www.newsfactor.com/story.xhtml?story_id=23559">http://www.newsfactor.com/story.xhtml?story_id=23559</A> and 
<A HREF="http://news.zdnet.co.uk/internet/security/0,39020375,39149459,00.htm">http://news.zdnet.co.uk/internet/security/0,39020375,39149459,00.htm</A>) 
which was a targeted exploit on a security product).

That's it, thanks for reading, and I am looking forward to your comments.

Best regards

Dinis Cruz
Owasp .Net Project
www.owasp.net










--__--__--

Message: 2
Date:	Mon, 01 May 2006 10:59:58 +0100
From:	Dinis Cruz &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">dinis at ddplus.net</A>&gt;
To:	&quot;'<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-dotnet at lists.sourceforge.net</A>'&quot; 
	&lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-dotnet at lists.sourceforge.net</A>&gt;,
	<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london at lists.sourceforge.net</A>, <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">webappsec at securityfocus.com</A>,
	<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">websecurity at webappsec.org</A>
Subject: [Owasp-london] [WEB SECURITY] Review of Owasp-London Chapter
meeting on WAF (Web Application Firewalls)

Hello

Here is my brain dump about what happened (from my point of view of 
course) last Tuesday (25th April) on the Owasp London Chapter meeting 
(hosted on a central London pub).

As you can read here 
(<A HREF="http://sourceforge.net/mailarchive/forum.php?thread_id=10209024&amp;forum_id=40">http://sourceforge.net/mailarchive/forum.php?thread_id=10209024&amp;forum_id=40</A>
284), 
here 
(<A HREF="http://sourceforge.net/mailarchive/forum.php?thread_id=10232868&amp;forum_id=40">http://sourceforge.net/mailarchive/forum.php?thread_id=10232868&amp;forum_id=40</A>
284) 
and here 
(<A HREF="http://sourceforge.net/mailarchive/forum.php?thread_id=10239385&amp;forum_id=40">http://sourceforge.net/mailarchive/forum.php?thread_id=10239385&amp;forum_id=40</A>
284) 
the theme of the night was &quot;Web Application Firewalls (WAF): Where do 
they add value and who should be using them&quot;. After a public invite for 
participation, 4 vendors committed to come in an present their WAF 
appliances: F5, Imperva, Breach and Fortify (I should actually say 3 WAF 
Appliance vendors since Fortify presented a similar tool with a 
different approach).

My objective with this presentation was to go beyond the Marketing BS 
and discuss the type of issues that these tools:

    - are able to defend out of the box (i.e. with minor configuration's 
by the user)
    - are able to defend with some customization
    - are NOT able to defend

I was also very interested in the usability of the tools and the user 
experience of the WAFifyed website  (i.e. what happens when a potential 
attack is detected).

To level the playing field, each vendor was given a vulnerable website 
that they needed to protect. This website was Foundstone's HacmeBank 
v2.0 (the original plan was to use Owasp's SiteGenerator but some 
vendors had some problems in getting it to work (prob with windows 2003 
SP1 I think), so due to time constrains we used the new version of 
HacmeBank (2.0) which is very stable and feature (i.e. vulnerability) 
rich :)

To give an extra humph to the event (and to justify the tight deadlines) 
I added the element &quot;Hacme Bank is under attack, here are the exploit 
vectors being used, your mission is to patch this system as soon as 
possible and stop the attackers&quot;. It should be noted that the vendors 
did not had a lot of time in their hands (from receiving the list of 
vulnerabilities to patch to the event).

For reference, here is a PDF (created using the new Owasp PenTest 
Reporter tool) describing all vulnerabilities: 
&quot;<A HREF="http://209.97.215.160/install/Hacme">http://209.97.215.160/install/Hacme</A> Bank Pentest Report (created by 
Owasp PenTest Reporter) - ).pdf&quot; .

Now that the scenario is set, here are my brain dump of the night:

    1) Firstly I am happy that the 4 vendors made it, that we had a good 
number of attendees (although not all Owasp London Chapter members :) 
and that the  F5 sponsorship went ok (with paid: pub dedicated to event, 
plasma screen, open bar and food)

    2) The audio recording also went ok, so give me a couple days and I 
will upload it to a server on MP3 format (need to do some audio 
normalization and minor editing)

    3) On the presentations it self (in the order they were made):
          a) F5
               - Brought their WAF Appliance (1U Rack) and did a live 
presentation
               - Showed several demos on the HacmeBank vulnerabilities 
(XSS, SQL Injection, Cookies)
               - Discussed briefly some advanced options that their 
product has: Leveraging the BigIP scripting capabilities, protecting 
admin pages by forcing a certain 'navigation path'
                - Maybe because this was the first presenter, but they 
really run out of time (the 20m minutes allocated were religiously 
enforced). I did felt that the presenter at times went over the top on 
the explanations given, and spent too much time on simple stuff. 
Basically I would had preferred if he gave the presentation at twice the 
pace covering twice the material.
          b) Imperva
               - Brought their WAF Appliance (1U Rack) and did a live 
presentation
               - Similar to F5, showed several demos on the HacmeBank 
vulnerabilities (XSS, SQL Injection, Cookies) covering roughly the same 
material
               - Shown very powerful functionality on their product, 
namely the Forms / Cookie rules creation user interface
               - Had several problems during the presentation (e.g. some 
demos that didn't work)
          c) Breach
               - No WAF Appliance, videos shown instead
               - A couple too many slides for my taste, and not enough 
demos.
               - That said, I liked Ofer style and he has clearly a very 
good technical understanding of the WAF world (he is also the organizer 
of the Owasp Chapter in Israel)
               - I didn't particularly agree with the concept of &quot;Dinis 
WAF Requirements&quot;, which imply that what I was asking the WAF vendors is 
very advanced, difficult and has very little customer demand.
          d) Fortify
               - Fortify didn't present a WAF Appliance. They took the 
concept of WAF and applied it to the actual targeted application. Steps 
used by their product: 1) reverse engineering the J2EE application, 2) 
identify the attack surface, 3) identify insecure coding practices, 4) 
apply 'security protection layers' were necessary, and 5) monitor and 
report malicious activity. Due to the fact that their .Net product is 
still under development, Fortify's demo was based on the Owasp Web Goat 
tool.
               - I was quite impressed with their solution and can see 
real-live cases where it could be very effective (especially since some 
of the security vulnerabilities that I want to address via a WAF 
solution can only be made at the Application layer)
               - The main problem with this solution is that it requires 
a binary change/redeployment of the targeted application, and it still a 
very young product (e.g. not used by a large number of clients to 
protect mission critical web applications)
 
[this next set of comments apply mainly to the 3 WAF vendors]

   5) Coming back to the WAF Appliance presentations, there are a couple 
of comments that I have to make:

        a) The presentations were all very BASIC (as in Simplistic). 
Come on!!!! doing an SQL injection or cookies demo using Paros? That is 
'so' last century. I was expecting at least some Unit Tests or custom 
use of Web Application Security Scanners. But Paros? (or for that mater 
Web Scarab, Fiddler, Firefox/IE Tamper request, @Stake Web Proxy, 
etc...). My problem here is not that such tool(s) were used, but the 
fact that they don't allow for the automated test of the numerous 
variations that exploits like SQL Injection have. Remember that the 
WAF's must be able to detect ALL (or most) types of SQL Injections (not 
only the ones with a quote). Think of the problems that IDS have in 
detecting RPC traffic, the WAF will have exactly the same types of issues.

        b) I might be wrong on this one, but I do get the feeling that 
these WAF vendors have a good understanding of 'data validation' attacks 
( SQL Injection, XSS, Cookies, etc) but fail to grasp the security 
implications of (for example) application logic attacks (like the one in 
Hacme Bank where user A is able to access data from user B). More 
worryingly, they seem happy with this situation since (from their point 
of view) their clients don't need that functionality.

       c) Where are the published independent security reviews of these 
products? I find amazing that vendors that are selling a 'security 
product', e.g. a software application (WAF) that protects other software 
applications (Websites), do not understand the value of hiring 
independent 3rd party security companies to perform source code security 
audits to their products (note that the final results of these audits 
must be published and made available to clients). As discussed during 
the panel, it is probably impossible to create bug/vulnerability free 
applications, but to NOT perform independent security audits to their 
code is crazy. Since these vendors are still in the 'Functionality Arms 
Race' phase of their products. Basically, the development teams are more 
focused on features, performance and user experience than on Security 
(and I don't have to tell you how 'secure' apps developed like this tend 
to be :). Maybe the solution is to put a WAF protecting a WAF protecting 
a WAF protecting a website :). Note to vendors: If am am wrong in this 
comment, feel free to prove me wrong and publish the security audits 
performed on your current product(s).

       d) another area which I still think the WAF don't get it, is the 
fact that no solution allows for the easy manipulation of the data being 
analyzed (both at input and at output). At the moment you only have two 
choices: 1) let the request go, 2) block the request and either show a 
custom error page or logout the user. This is to radical. We need the 
ability to change the contents of form fields (or page contents) 
dynamically. This will be the only way that some vulnerabilities can be 
effectively managed and mitigated (while limiting the damage cause by 
false positives). Note: same WAFs have the functionality to replace 
cookies with their own (WAF controlled value)

       e) Why don't they use their WAFs to protect the WAF's web 
interface? Clearly a great test for the usability of a WAF product is to 
use it to protect the complex GUIs used on the WAF management and 
monitoring. Also, when (not if) vulnerabilities are found in their 
product, they could use their WAF to mitigate those security issues.

       g) And what about their website? Are the vendor's websites 
protected by their WAFs?

       h) To the other companies/products that want to get into the WAF 
market, advice to them is: &quot;Create a WAF that allows a good PenTester to 
mitigate 90%+ of the vulnerabilities that he/she discovered&quot;. Basically, 
grab HacmeBank and SiteGenerator and use it to take your product were 
the current WAF vendors don't seem to want to go.

       i) What about the Web Application Firewall Evaluation Criteria 
(<A HREF="http://www.webappsec.org/projects/wafec/">http://www.webappsec.org/projects/wafec/</A>)? How do this WAF appliances 
rate to this? I might have missed it, but where is the public disclose 
of this information?

    6) After thinking about what happened for a couple days, and trying 
to come up with an explanation for the issues raised on item 5), I think 
that I came up with an answer. The problem is that the WAF technical 
teams don't have Web Penetration Testing experience. They have a 
reasonable level of understanding on how to attack an web application, 
but they are missing the advanced material (I am also puzzled by the 
lack of use of Web Application Security Scanners (WASS)). Maybe the 
solution is for a WAF company and a WASS company to merge and maximize 
the skills sets of both.

    7) Please take my comments with a pinch of salt :) . It is to late 
at night here and I am just doing a brain dump :)

    8) Moving forward, here are some ideas:

          a) Expand the current Hacme Bank challenge to all WAF vendors 
and see who is able to mitigate what. I already asked the 4 WAF vendors 
that participated on the London event to send me the list of issues 
(from Hacme Bank v2.0) that they product is: 
                * Able to protect with default functionality
                * Able to protect with Customization     
                * Not able to protect

          b) Implement all documented HacmeBank vulnerabilities in 
SiteGenerator (also add different types of navigation)

          c) help to organize other Owasp chapter events around the 
world on the same subject and using the same model (Owasp chapter 
leaders let-me know if you are interested)

          d) Implement the Foundstone Validator .Net tool on HacmeBank 
to show how most of those security issues can be resolved when the WAF 
has access to the application layer

          e) write a white paper about WAFs focusing on where they 
should be used and on where they are not effective

          f) expand the analysis of the Hacme Bank vulnerabilities and 
discuss how they could/should be mitigated at WAF

    9) Finally, I just want to give a warning to the WAF  vendors: &quot;you 
must make your appliance invisible to attackers&quot;. By invisible I mean 
that it should not be possible to fingerprint your appliance remotely 
from the Internet. Because if you do allow this to occur, then you 
dramatically increase the risk to your clients of being exploited by a 
vulnerability in your WAF (and remember the Witty worm 
(<A HREF="http://www.newsfactor.com/story.xhtml?story_id=23559">http://www.newsfactor.com/story.xhtml?story_id=23559</A> and 
<A HREF="http://news.zdnet.co.uk/internet/security/0,39020375,39149459,00.htm">http://news.zdnet.co.uk/internet/security/0,39020375,39149459,00.htm</A>) 
which was a targeted exploit on a security product).

That's it, thanks for reading, and I am looking forward to your comments.

Best regards

Dinis Cruz
Owasp .Net Project
www.owasp.net









---------------------------------------------------------------------
The Web Security Mailing List
<A HREF="http://www.webappsec.org/lists/websecurity/">http://www.webappsec.org/lists/websecurity/</A>

The Web Security Mailing List Archives
<A HREF="http://www.webappsec.org/lists/websecurity/archive/">http://www.webappsec.org/lists/websecurity/archive/</A>



--__--__--

Message: 3
Date: Mon, 01 May 2006 23:47:25 +0100
From: Dinis Cruz &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">dinis at ddplus.net</A>&gt;
To:  <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">kirke11 at securenet.de</A>
CC:  <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">websecurity at webappsec.org</A>,  <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">webappsec at securityfocus.com</A>, 
 &quot;'<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-dotnet at lists.sourceforge.net</A>'&quot;
&lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-dotnet at lists.sourceforge.net</A>&gt;,
  <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">owasp-london at lists.sourceforge.net</A>
Subject: [Owasp-london] Re: [WEB SECURITY] Review of Owasp-London Chapter
meeting on WAF
 (Web Application Firewalls)

Achim Hoffmann wrote:
&gt;<i> hmm, does this mean that nobody is able to configure WebProxy to test ALL
</I>&gt;<i> (known) vulnerabilities of a categorie? Come on ;-)
</I>&gt;<i>   
</I>I am not saying that nobody would able to use a WebProxy to test ALL 
(known) vulnerabilities. That is even doable with notepad and NetCat :)

But that is not my point. My point is that these guys build WAF for a 
living, and I was expecting a more sophisticated method to automatically 
test these issues.

Remember that most HacmeBank vulnerabilities (namely the ones the WAF 
vendors did their demos on) are basic examples, which would be easy to 
implement in a automated test suite (if they had one)
&gt;<i> I guess that the majority of cases in the logical and semantical layer
</I>could
&gt;<i> not be detected by a WAF. 
</I>My argument is that they should be detected by a WAF (we might agree to 
disagree on this one :).
&gt;<i> That would require that the WAF knows the business
</I>&gt;<i> logic of all applications it protects.
</I>&gt;<i>   
</I>Exactly, and because that is a complex task, the WAF's vendors don't do 
it today (but in my point of view will need to do it in the future)

Think about this, normal firewalls don't do Layer 7 (port 80,443 traffic 
is not checked), if then you have WAFs (at layer 7) that only check for 
basic exploits, what happens next?

XYZ appliance that handles the Layer 7.5? (i.e. the application logic)
&gt;<i> Let the WAF detect the simplistic attacks, that's currently still a
</I>challenge.
&gt;<i>   
</I>Well I refuse to accept that WAFs can only handle simplistic attacks.

That said, If the bottom line is that (for now) WAFs can only handle 
simple attacks, then somebody needs to update they marketing material:

&quot;...TrafficShieldR is a web application firewall that provides 
comprehensive, proactive, network and application-layer protection from 
generalized and targeted attacks...&quot; 
(<A HREF="http://www.f5.com/products/TrafficShield/">http://www.f5.com/products/TrafficShield/</A>)

&quot;...The SecureSphere Web Application Firewall is the only solution to 
provide automated attack protection for Web and Web Services 
applications....Dynamic Profiling is the foundation of a multi-layer 
security architecture that provides complete protection for all layers 
of the application infrastructure, including the network, server and 
application&quot; 
(<A HREF="http://www.imperva.com/products/securesphere/web_application_firewall.html">http://www.imperva.com/products/securesphere/web_application_firewall.html</A>)

&quot;...WebDefend is a next-generation Internet security appliance that 
provides comprehensive Web application protection to resolve information 
security challenges such as Identity Theft, Information Leakage, 
regulatory compliance, and insecurely coded applications...&quot; 
(<A HREF="http://www.breach.com/products_breachgatewebdefend.asp">http://www.breach.com/products_breachgatewebdefend.asp</A>)
&gt;<i> !!        d) another area which I still think the WAF don't get it, is the
</I>&gt;<i> !! fact that no solution allows for the easy manipulation of the data
</I>being
&gt;<i> !! analyzed (both at input and at output). At the moment you only have two
</I>&gt;<i> !! choices: 1) let the request go, 2) block the request and either show a
</I>&gt;<i> !! custom error page or logout the user. This is to radical.
</I>&gt;<i>
</I>&gt;<i> hmm, the F in WAF stands for firewall and not for (substituting) filter.
</I>&gt;<i>   
</I>That depends on your definition of Firewall :)

Here is a good one:

&quot;What is a Web Application Firewall?
An intermediary device, sitting between a web-client and a web server, 
analyzing OSI Layer-7 messages for violations in the programmed security 
policy. A web application firewall is used as a security device 
protecting the web server from attack.&quot; 
(<A HREF="http://www.cgisecurity.com/questions/webappfirewall.shtml">http://www.cgisecurity.com/questions/webappfirewall.shtml</A>)

So unless you want to start dividing Layer 7 traffic into multiple 
sub-layers (Data Validation basic, Data Validation advanced, 
Authentication, Strong Authentication, Authorization, Deep Authorization 
(I made up this last one :), etc...) I would argue that Web Application 
Firewalls are layer 7 firewalls, and should be able to protect against 
all attacks deployed via that layer.
&gt;<i> Do you know of any network firewall which behaves this way?
</I>&gt;<i>   
</I>No I don't know of a WAF Appliance that behaves like this (which is a 
shame because I would have several clients for them). This gap in the 
market is exactly why I am defending that this is were the new 
generation of WAF vendors should be focusing their effort on.
&gt;<i> It's dangerous that a WAF has its own idea how to sort data out (even if
</I>&gt;<i> configuerable). 
</I>Why? Remember that I defend that the point where WAFs are most effective 
and valuable is when they are being configured by an experienced and 
knowledgeable security consultant (preferably not the one that found the 
vulnerability).

Note that I am not defending that you should actively use a WAF on the 
entire website (especially the functions that dynamically change data).

What I am defending is that If I (the client) know that a certain 
vulnerability exist (discovered by a security consultant or by analyzing 
the logs of a 'live' attack (occurring at that moment)), then what I 
(the client) want, is to be able to as quickly as possible (and with the 
least amount of side effects) deploy a 'patch' to my application which 
will a) mitigate the vulnerability and b) have zero or minimal impact on 
my normal user's session experience.

Being able to dynamically manipulate form's (and other http) content has 
the following advantages:

    1) There are some security issues that you cannot mitigate in any 
other way (for example information leakage, or certain types of data 
validation)
    2) It minimizes site effects and allows much more flexibility on how 
do you handle (potential) malicious input (remember that at the moment 
you get a black or white decision (allow or deny))
    3) It allows for the detection of an attack without giving the 
attackers any clue that the attack was detected (of course that I am 
assuming here that there are incident escalation procedures in place)
&gt;<i> Just an example: the username comes as O'Reilly and your
</I>&gt;<i> smart WAF replaces the '. Does it replace for SQL injection or for XSS?
</I>&gt;<i> Which one would you prefer if the application needs both?
</I>&gt;<i>   
</I>That depends on the case and on the specific vulnerability. What I know 
is that I don't want Mr O'Reilly to get a 404 page or to be logged out 
every time he signs up for a newsletter (let's assume that the login 
page was not vulnerable to SQL Injection, since Mr O'Reilly needs to 
login :) )

I also like to have the possibility to replace one ' with '' (two ' ) or 
with an html version of a ' (&amp;#39;)  or with an _ (underscore) or with a 
&quot;[quote was here]&quot; tag (to be replaced on the way out with a ' again :)

The bottom line is that you need to be able to have the flexibility to 
provide the business with a solution that A) solves/mitigates the 
security vulnerability and B) doesn't affect the user's experience
&gt;<i> Input data validation has to be done by each application for each value
</I>&gt;<i> and this validation is bound to the destination of the data. 
</I>Of course, Data Validation should ultimately be the responsibility of 
the Application. But with development cycles of weeks or months, WAFs 
'patches' are the perfect solution to stop current or future attacks on 
known vulnerabilities.

In the medium term, what would also help would be if web applications 
were able to provide (to the WAFs) xml feeds containing detailed 
information about all input points (i.e. the attack surface). Think 
Struts (<A HREF="http://struts.apache.org/">http://struts.apache.org/</A>)
&gt;<i> Something
</I>&gt;<i> a WAF usually does not know.
</I>&gt;<i>   
</I>It doesn't do know, but I wish they did
&gt;<i> !! We need the
</I>&gt;<i> !! ability to change the contents of form fields (or page contents)
</I>&gt;<i> !! dynamically. This will be the only way that some vulnerabilities can be
</I>&gt;<i> !! effectively managed and mitigated (while limiting the damage cause by
</I>&gt;<i> !! false positives). Note: same WAFs have the functionality to replace
</I>&gt;<i> !! cookies with their own (WAF controlled value)
</I>&gt;<i>
</I>&gt;<i> Don't know what you mean here. If you mean values of input fields, see
</I>above.
&gt;<i>   
</I>Do you still disagree with me that sometimes you NEED to be able to 
dynamically change the contents of an HTTP request (namely Form values)
&gt;<i> If you mean values of fields in output (response), then there're still a
</I>&gt;<i> couple of WAFs which could encrypt values in responses and check if the
</I>&gt;<i> correct value comes back in the next request.
</I>&gt;<i>   
</I>Sure and that is a good thing they do.

But what about when secret data is sent on a response? Shouldn't we be 
able to stop that?
&gt;<i> !!        e) Why don't they use their WAFs to protect the WAF's web
</I>&gt;<i> !! interface? Clearly a great test for the usability of a WAF product is
</I>to
&gt;<i> !! use it to protect the complex GUIs used on the WAF management and
</I>&gt;<i> !! monitoring. Also, when (not if) vulnerabilities are found in their
</I>&gt;<i> !! product, they could use their WAF to mitigate those security issues.
</I>&gt;<i>
</I>&gt;<i> OK, i.g. this is a true requirement. But keep in mind that a WAF is not
</I>&gt;<i> reachable from the internet, but it should only be reachable from trusted
</I>&gt;<i> hosts. Most WAFs support such a protection.
</I>True, but in large enterprises the number of nodes that will be able to 
connect to those boxes will be quite high, but (as I explain below) the 
main reason for this request is not to reduce the risk created by these 
web applications
&gt;<i>  Why should a WAF protect itself
</I>&gt;<i> from trusted hosts, that sounds overkill.
</I>&gt;<i>   
</I>Why? Surely a WAF should be able to handle such task without any 
problems? Aren't they all designed to handle complex websites generating 
large amounts of traffic?
&gt;<i> IMHO, such a protection is sufficient 'cause it only leaves the
</I>administration
&gt;<i> interface open to session riding (which could be solved with isolated
</I>&gt;<i> administration hosts).
</I>&gt;<i>   
</I>If isolation administration hosts worked in large corporate 
environments.... :)
&gt;<i> Anyway, I agree that it's a shame that some WAF have XSS, SQL injection
</I>&gt;<i> and some other vulnerabilities.
</I>&gt;<i>   
</I>The problem here is not that they have those issues (that is a problem 
with the software industry), the problem is that these WAF don't have a 
quick way to deploy patches for those vulnerabilities.

Also by using the WAF to protect their web applications (which are 
complex and feature rich) they (the WAF vendors) would gain a huge 
amount of experience on what a complex application looks like, and how 
to handle the issues that are created by protecting it with their product.

I would also be a great demo for them (unless they couldn't protect 
their WAF security issues with their WAF :)
&gt;<i> !!        g) And what about their website? Are the vendor's websites
</I>&gt;<i> !! protected by their WAFs?
</I>&gt;<i>
</I>&gt;<i> a simple LOL could be the comment here, but I'm aware that some vendors
</I>&gt;<i> are listening ...
</I>&gt;<i>   
</I>:<i>)
</I>&gt;<i> !!        i) What about the Web Application Firewall Evaluation Criteria
</I>&gt;<i> !! (<A HREF="http://www.webappsec.org/projects/wafec/">http://www.webappsec.org/projects/wafec/</A>)? How do this WAF appliances
</I>&gt;<i> !! rate to this? I might have missed it, but where is the public disclose
</I>&gt;<i> !! of this information?
</I>&gt;<i>
</I>&gt;<i> yes the WAFEC could be used for that. But did you read at least the first
</I>3
&gt;<i> paragraphs in the Introduction of that document before asking this
</I>question?
&gt;<i>   
</I>I had read the WAFEC document before, and just to make sure I didn't 
miss any thing major I just re-read those first the paragraphs 
(<A HREF="http://www.webappsec.org/projects/wafec/v1/wasc-wafec-v1.0.html">http://www.webappsec.org/projects/wafec/v1/wasc-wafec-v1.0.html</A>), and I 
don't understand your question. What is there in these 3 paragraphs that 
I should be aware of?

Note that all that I am asking for is for the WAF vendors to publicly 
disclose their WAFEC results.

Dinis Cruz
Owasp .Net Project
www.owasp.net




--__--__--

_______________________________________________
Owasp-london mailing list
<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-london">Owasp-london at lists.sourceforge.net</A>
<A HREF="https://lists.sourceforge.net/lists/listinfo/owasp-london">https://lists.sourceforge.net/lists/listinfo/owasp-london</A>


End of Owasp-london Digest




</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000135.html">[Owasp-london] Re: [WEB SECURITY] Re: [Owasp-dotnet] Review of Owasp-London Chapter meeting on WAF (Web Application Firewalls)
</A></li>
	<LI>Next message: <A HREF="000136.html">[Owasp-london] Re: [WEB SECURITY] Review of Owasp-London Chapter meeting on WAF (Web Application Firewalls)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#140">[ date ]</a>
              <a href="thread.html#140">[ thread ]</a>
              <a href="subject.html#140">[ subject ]</a>
              <a href="author.html#140">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-london">More information about the Owasp-london
mailing list</a><br>
</body></html>
