<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets] REST and STS
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20REST%20and%20STS&In-Reply-To=%3Ca3986ddc-b77a-cf80-af85-1f4049bf4d3c%40owasp.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000138.html">
   
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets] REST and STS</H1>
    <B>Jim Manico</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20REST%20and%20STS&In-Reply-To=%3Ca3986ddc-b77a-cf80-af85-1f4049bf4d3c%40owasp.org%3E"
       TITLE="[OWASP-cheat-sheets] REST and STS">jim.manico at owasp.org
       </A><BR>
    <I>Wed Dec 20 11:57:18 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="000138.html">[OWASP-cheat-sheets] [Java-project] JMS de-serialization
</A></li>
        
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#146">[ date ]</a>
              <a href="thread.html#146">[ thread ]</a>
              <a href="subject.html#146">[ subject ]</a>
              <a href="author.html#146">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>The problem as I see it Yo is way beyond just attitude. I think you're
missing the point about REST security in a big BIG way which deeply
harms the conversation. I implore you to consider the following words.

REST is all about (1) resources and (2) HTTP conventions. THESE are the
topics I would like us to focus on. There are a LOT of problems to solve
here still. Resources mixed with good access control is very
challenging. HTTP conventions are complex and as they relate to security
such as the fact that REST advocates GET for search which encourages
leakage of sensitive data. THESE are the challenges we should be facing.
We should also discuss HATEOAS which also makes access control quite
complex. In fact, we need to address access control at the resource,
HTTP Verb AND HATEOAS level.

We should also discuss some of the big anti-patterns like burying REST
services deep in your architecture without security - a common pattern
that is very damaging.

Fielding discusses statelessness and REST for performance and caching.
Stateless webservices is a conversation we can have elsewhere. It's
*tangential* to the core issues of REST and security in my opinion.

So I again suggest we all get back to the core of REST - a good resource
to understand the important issues is the /Richardson Rest Maturity
Model/. <A HREF="https://martinfowler.com/articles/richardsonMaturityModel.html">https://martinfowler.com/articles/richardsonMaturityModel.html</A>
Please note statelessness is only briefly discussed here.

On another note, something that I have faced as a board member, is that
when things were not going my way I acted out in very hurtful ways to
myself and the community so I stepped aside. That's why I really left
the board. So if you feel that a certain technical point it not going
you way and you feel like if you do not &quot;win&quot; that argument you want to
leave - that's a sign that you likely should step aside and let other
cooler heads prevail. I say this not in a judgement pointing way, it's a
interpersonal challenge I face myself on a regular basis.

I state[1] all of this with respect.

Aloha, Jim

[1] No pun intended.





&gt;<i> I know, Jim, I become a bad-mannered big-mouth when faced with
</I>&gt;<i> overwhelming evidence that I am wrong. Next phase is, I just stomp off
</I>&gt;<i> in a sulk.&#160;
</I>&gt;<i>
</I>&gt;<i> On 20 November 2017 at 20:31, Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     &gt; If the cheat sheet suggests otherwise, I want my name off.
</I>&gt;<i>
</I>&gt;<i>     Just for the record, this is how I used to talk to my brother and
</I>&gt;<i>     sister when I was around 8-12 years old.
</I>&gt;<i>
</I>&gt;<i>     - Jim
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>     On 11/19/17 9:17 PM, Johan Peeters wrote:
</I>&gt;&gt;<i>     I do not see the use of an IdP/STS as a necessary condition to
</I>&gt;&gt;<i>     qualify as a REST service. I would argue for a separate IdP/STS
</I>&gt;&gt;<i>     since otherwise users need to entrust their credentials to the
</I>&gt;&gt;<i>     clients and all the back-end services called. Not good from a
</I>&gt;&gt;<i>     security perspective.
</I>&gt;&gt;<i>     If the service authenticates the user and then sets a session
</I>&gt;&gt;<i>     cookie, that is not REST. If the cheat sheet suggests otherwise,
</I>&gt;&gt;<i>     I want my name off.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     On 19 November 2017 at 10:30, Erlend Oftedal
</I>&gt;&gt;<i>     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">erlend.oftedal at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">erlend.oftedal at owasp.org</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Good diagrams, but I would say there is a version missing,
</I>&gt;&gt;<i>         and it&#8217;s the one I commonly see. It&#8217;s close to 1, but the
</I>&gt;&gt;<i>         front end is static and there is a session with the REST
</I>&gt;&gt;<i>         services only. Yeah sessions, I know. But I wouldnt put it
</I>&gt;&gt;<i>         under 1 because there is no old school ajax page loads and no
</I>&gt;&gt;<i>         JSONP. The services are proper HATEOAS and the sessions is
</I>&gt;&gt;<i>         only used for authentication.&#160;
</I>&gt;&gt;<i>         I&#8217;m ok with writing this up in the cheat sheet as not optimal
</I>&gt;&gt;<i>         from a design perspective, but &#160;dont want to rule out a
</I>&gt;&gt;<i>         design I see a lot of people using. This is still a pretty
</I>&gt;&gt;<i>         common design for Single page web apps, where you dont have a
</I>&gt;&gt;<i>         separate IdpP/STS.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         And about JSONP. &#8220;STOP IT&#8221; is the best advice.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         Best regards
</I>&gt;&gt;<i>         Erlend
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>         On Fri, 17 Nov 2017 at 02:56, Jim Manico
</I>&gt;&gt;<i>         &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt; wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             Diagrams are totally possible in the CS. I can help with
</I>&gt;&gt;<i>             that! Are the diagrams below open source?
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             So Yo and Jan - really fantastic conversations. I
</I>&gt;&gt;<i>             appreciate everyone digging deeply into this. I'm
</I>&gt;&gt;<i>             definitely learning from it.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             - Jim
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             On 11/15/17 10:00 PM, Johan Peeters wrote:
</I>&gt;&gt;&gt;<i>             Great diagrams! I think they would clarify, although it
</I>&gt;&gt;&gt;<i>             would be a break with tradition - as far as I'm aware,
</I>&gt;&gt;&gt;<i>             no diagrams have been used in cheat sheets thus far. Are
</I>&gt;&gt;&gt;<i>             there any practical constraints adding them to the cheat
</I>&gt;&gt;&gt;<i>             sheet?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>             Category 3 is not only more scaleable in the sense that
</I>&gt;&gt;&gt;<i>             it allows for horizontal scaling of resource servers,
</I>&gt;&gt;&gt;<i>             AKA web services, but also that it becomes easy to add
</I>&gt;&gt;&gt;<i>             more, distinct, services.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>             An access token should identify which resource it is
</I>&gt;&gt;&gt;<i>             giving access to and the scope of this access. Whether,
</I>&gt;&gt;&gt;<i>             and how, an access token can give access to *several*
</I>&gt;&gt;&gt;<i>             resources, e.g. in the event of call chaining, is an
</I>&gt;&gt;&gt;<i>             interesting debate that I do not expect to be settled
</I>&gt;&gt;&gt;<i>             any time soon.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>             On 16 November 2017 at 00:58, Jan Wolff
</I>&gt;&gt;&gt;<i>             &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jan.wolff at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jan.wolff at owasp.org</A>&gt;&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 It appears to me that question how access control
</I>&gt;&gt;&gt;<i>                 can be done securely for REST Web services depends
</I>&gt;&gt;&gt;<i>                 more on the fashion how those services are used than
</I>&gt;&gt;&gt;<i>                 whether they are truly REST-ful. In my opinion, we
</I>&gt;&gt;&gt;<i>                 should not assume that our audience shares our
</I>&gt;&gt;&gt;<i>                 understanding of what REST implies. Instead, we
</I>&gt;&gt;&gt;<i>                 should point our readers to good advice depending on
</I>&gt;&gt;&gt;<i>                 their use of services.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 Let us differentiate between architectures that need
</I>&gt;&gt;&gt;<i>                 different handling of access control. If you want to
</I>&gt;&gt;&gt;<i>                 edit/fix/propose, the following figures can be
</I>&gt;&gt;&gt;<i>                 accessed here:
</I>&gt;&gt;&gt;<i>                 <A HREF="https://docs.google.com/presentation/d/1snVoMadFdbTiyiRypV8tX29zYrIpPalDfMgljACaPgM/edit?usp=sharing">https://docs.google.com/presentation/d/1snVoMadFdbTiyiRypV8tX29zYrIpPalDfMgljACaPgM/edit?usp=sharing</A>
</I>&gt;&gt;&gt;<i>                 &lt;<A HREF="https://docs.google.com/presentation/d/1snVoMadFdbTiyiRypV8tX29zYrIpPalDfMgljACaPgM/edit?usp=sharing">https://docs.google.com/presentation/d/1snVoMadFdbTiyiRypV8tX29zYrIpPalDfMgljACaPgM/edit?usp=sharing</A>&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 I mostly observed category 1 or category 2 in the
</I>&gt;&gt;&gt;<i>                 wild. Category 3 seems to be an emerging design for
</I>&gt;&gt;&gt;<i>                 better horizontal scaling without shared session
</I>&gt;&gt;&gt;<i>                 state. Please correct me or add alternatives if you
</I>&gt;&gt;&gt;<i>                 see it differently.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 For category 1, secure session management applies as
</I>&gt;&gt;&gt;<i>                 for web applications and we should point there.
</I>&gt;&gt;&gt;<i>                 For category 2, there might be a session based on
</I>&gt;&gt;&gt;<i>                 user authentication (passwords or even
</I>&gt;&gt;&gt;<i>                 client-certificates). This could be a service
</I>&gt;&gt;&gt;<i>                 backend for an app. Scaling brings the danger of
</I>&gt;&gt;&gt;<i>                 replicated data stores with credentials. I would
</I>&gt;&gt;&gt;<i>                 discourage users to scale this above one credential
</I>&gt;&gt;&gt;<i>                 database.
</I>&gt;&gt;&gt;<i>                 Category 3: I am not the expert for this, but I
</I>&gt;&gt;&gt;<i>                 would expect scalability to be superior because
</I>&gt;&gt;&gt;<i>                 services are truly independent from each other.
</I>&gt;&gt;&gt;<i>                 Tokens must not be used as proof of identity. Tokens
</I>&gt;&gt;&gt;<i>                 might be abused/leaked by service 1 and used on
</I>&gt;&gt;&gt;<i>                 service 2.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 What do you think, would sketches like that help
</I>&gt;&gt;&gt;<i>                 users of the cheat sheet understand which parts are
</I>&gt;&gt;&gt;<i>                 relevant to them?
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 Jan
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 Am 14.11.2017 um 10:56 schrieb Johan Peeters:
</I>&gt;&gt;&gt;&gt;<i>                 No sooner did Jim move the REST cheat sheet from draft to approved
</I>&gt;&gt;&gt;&gt;<i>                 mode than old controversies reared up again. The principal one was
</I>&gt;&gt;&gt;&gt;<i>                 whether we should cover session management, but I won't go into that
</I>&gt;&gt;&gt;&gt;<i>                 in this post.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>                 Here I want to discuss what the deal is with Security Token Services (STS).
</I>&gt;&gt;&gt;&gt;<i>                 Erlend asked me: can't you have a REST service without an STS? Sure,
</I>&gt;&gt;&gt;&gt;<i>                 if no authN/Z is needed, obviously. If the REST API is sensitive,
</I>&gt;&gt;&gt;&gt;<i>                 serves multiple clients and there are several resource servers, on the
</I>&gt;&gt;&gt;&gt;<i>                 other hand, then I would strongly recommend using an STS. This
</I>&gt;&gt;&gt;&gt;<i>                 centralises authentication logic in a dedicated component and avoids
</I>&gt;&gt;&gt;&gt;<i>                 passing credentials around.
</I>&gt;&gt;&gt;&gt;<i>                 If you do not have and do not anticipate having multiple clients or
</I>&gt;&gt;&gt;&gt;<i>                 resource servers, maybe REST APIs are not the right choice - probably
</I>&gt;&gt;&gt;&gt;<i>                 there are simpler designs that serve your purpose.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i>                 Yo
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>                 _______________________________________________
</I>&gt;&gt;&gt;<i>                 OWASP-cheat-sheets mailing list
</I>&gt;&gt;&gt;<i>                 <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">OWASP-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;<i>                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">OWASP-cheat-sheets at lists.owasp.org</A>&gt;
</I>&gt;&gt;&gt;<i>                 <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets</A>
</I>&gt;&gt;&gt;<i>                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets</A>&gt;
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>             -- 
</I>&gt;&gt;&gt;<i>             Johan Peeters
</I>&gt;&gt;&gt;<i>             <A HREF="https://www.johanpeeters.com">https://www.johanpeeters.com</A>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>             _______________________________________________
</I>&gt;&gt;&gt;<i>             OWASP-cheat-sheets mailing list
</I>&gt;&gt;&gt;<i>             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">OWASP-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;<i>             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">OWASP-cheat-sheets at lists.owasp.org</A>&gt;
</I>&gt;&gt;&gt;<i>             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets</A>
</I>&gt;&gt;&gt;<i>             &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>             _______________________________________________
</I>&gt;&gt;<i>             OWASP-cheat-sheets mailing list
</I>&gt;&gt;<i>             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">OWASP-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;<i>             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">OWASP-cheat-sheets at lists.owasp.org</A>&gt;
</I>&gt;&gt;<i>             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets</A>
</I>&gt;&gt;<i>             &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets</A>&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>     -- 
</I>&gt;&gt;<i>     Johan Peeters
</I>&gt;&gt;<i>     <A HREF="https://www.johanpeeters.com">https://www.johanpeeters.com</A>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> -- 
</I>&gt;<i> Johan Peeters
</I>&gt;<i> <A HREF="https://www.johanpeeters.com">https://www.johanpeeters.com</A>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20171220/d1c8051e/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20171220/d1c8051e/attachment-0001.html</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000138.html">[OWASP-cheat-sheets] [Java-project] JMS de-serialization
</A></li>
	
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#146">[ date ]</a>
              <a href="thread.html#146">[ thread ]</a>
              <a href="subject.html#146">[ subject ]</a>
              <a href="author.html#146">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
