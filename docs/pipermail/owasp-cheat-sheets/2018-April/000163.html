<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets] Clickjacking Defense CS: legacy vs CSP
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20Clickjacking%20Defense%20CS%3A%20legacy%20vs%20CSP&In-Reply-To=%3C20180412211316.GE32527%40home.lan%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000164.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets] Clickjacking Defense CS: legacy vs CSP</H1>
    <B>Alex Efros</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20Clickjacking%20Defense%20CS%3A%20legacy%20vs%20CSP&In-Reply-To=%3C20180412211316.GE32527%40home.lan%3E"
       TITLE="[OWASP-cheat-sheets] Clickjacking Defense CS: legacy vs CSP">powerman at powerman.name
       </A><BR>
    <I>Thu Apr 12 21:13:16 UTC 2018</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000164.html">[OWASP-cheat-sheets] Clickjacking Defense CS: legacy vs CSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#163">[ date ]</a>
              <a href="thread.html#163">[ thread ]</a>
              <a href="subject.html#163">[ subject ]</a>
              <a href="author.html#163">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Hi!

Looks like recommended clickjacking protection for legacy browsers[1]
require switching off much more powerful protection against XSS:

    Content-Security-Policy: default-src 'unsafe-inline';

I'm developing OAuth server and really need best clickjacking protection,
but I'm afraid this trade-off is too disadvantageous.

Maybe it's possible to somehow move recommended CSS and JS snippets to
separate files? I'm not really sure, but I suppose they are recommended to
keep in &lt;head&gt; for a reason, because with external files there is always a
chance they won't be (timely, at least) loaded for some reason.

Another option is to keep CSS/JS inline, but use 'nonce-*' or 'sha256-*'
instead of 'unsafe-inline' - but as these features of CSP2 I'm not sure is
this combination will works in all cases (legacy browser without CSP,
usual browser with CSP1, modern browser with CSP2).

So, how to get best clickjacking protection without relaxing CSP too much?

[1]: <A HREF="https://www.owasp.org/index.php/Clickjacking_Defense_Cheat_Sheet#Best-for-now_Legacy_Browser_Frame_Breaking_Script">https://www.owasp.org/index.php/Clickjacking_Defense_Cheat_Sheet#Best-for-now_Legacy_Browser_Frame_Breaking_Script</A>

-- 
			WBR, Alex.
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000164.html">[OWASP-cheat-sheets] Clickjacking Defense CS: legacy vs CSP
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#163">[ date ]</a>
              <a href="thread.html#163">[ thread ]</a>
              <a href="subject.html#163">[ subject ]</a>
              <a href="author.html#163">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
