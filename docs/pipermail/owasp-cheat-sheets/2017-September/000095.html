<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets] Question: ECDHE and DHE cipher orders
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20Question%3A%20ECDHE%20and%20DHE%20cipher%20orders&In-Reply-To=%3Ce68494bd-2a83-472e-9d6d-0ef701071865%40owasp.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000094.html">
   <LINK REL="Next"  HREF="000096.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets] Question: ECDHE and DHE cipher orders</H1>
    <B>Torsten Gigler</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20Question%3A%20ECDHE%20and%20DHE%20cipher%20orders&In-Reply-To=%3Ce68494bd-2a83-472e-9d6d-0ef701071865%40owasp.org%3E"
       TITLE="[OWASP-cheat-sheets] Question: ECDHE and DHE cipher orders">torsten.gigler at owasp.org
       </A><BR>
    <I>Tue Sep 12 22:24:14 UTC 2017</I>
    <P><UL>
        <LI>Previous message: <A HREF="000094.html">[OWASP-cheat-sheets] Question: ECDHE and DHE cipher orders
</A></li>
        <LI>Next message: <A HREF="000096.html">[OWASP-cheat-sheets] OWASP Cheat Sheet Workshop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95">[ date ]</a>
              <a href="thread.html#95">[ thread ]</a>
              <a href="subject.html#95">[ subject ]</a>
              <a href="author.html#95">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Kenneth,

thank you for your mail and your points for discussion.

About your question: DHE versus ECDHE:

  * DHE and ECDHE, both do support Forward Secrecy. So they should be offered by a server with
    hightest priority.
      o &quot;Highest priority for ciphers that support 'Forward Secrecy' (-&gt; Support ephemeral
        Diffie-Hellman key exchange, see rule above).&quot;
  * But there is still the need to start with one cipher. There have been a lot of discussions about
    the reliability of Elliptic Curves, and finally two Curves are about to be standardized for TLS
    (<A HREF="https://datatracker.ietf.org/doc/draft-ietf-tls-rfc4492bis/?include_text=1">https://datatracker.ietf.org/doc/draft-ietf-tls-rfc4492bis/?include_text=1</A>). Until now, only
    some crypto libraries support them and some of them have had vulnerabilities by implementing
    them, e.g. <A HREF="http://www.cvedetails.com/cve/CVE-2017-0379/">http://www.cvedetails.com/cve/CVE-2017-0379/</A>
    So I'd still favor DHE over ECDHE in general, but it's only a fine nuance:&#160;

          o &quot;Favor DHE over ECDHE (and monitor the CPU usage, see Notes below), ECDHE lacks now of
            really reliable Elliptic Curves, see discussion about secp{224,256,384,521}r1 and
            secp256k1, cf. [3] &lt;<A HREF="http://safecurves.cr.yp.to">http://safecurves.cr.yp.to</A>&gt;, [4]
            &lt;<A HREF="https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1675929">https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1675929</A>&gt;. The
            solution might be to use Brainpool Curves [German]
            &lt;<A HREF="http://www.researchgate.net/profile/Johannes_Merkle/publication/260050106_Standardisierung_der_Brainpool-Kurven_fr_TLS_und_IPSec/file/60b7d52f36a0cc2fdd.pdf">http://www.researchgate.net/profile/Johannes_Merkle/publication/260050106_Standardisierung_der_Brainpool-Kurven_fr_TLS_und_IPSec/file/60b7d52f36a0cc2fdd.pdf</A>&gt;,
            defined for TLS in RFC 7027 &lt;<A HREF="https://tools.ietf.org/html/rfc7027">https://tools.ietf.org/html/rfc7027</A>&gt;, or Edwards Curves
            &lt;<A HREF="http://eprint.iacr.org/2007/286">http://eprint.iacr.org/2007/286</A>&gt;. The most promising candidates for the latter are
            'Curve25519' &lt;<A HREF="https://tools.ietf.org/html/draft-josefsson-tls-curve25519-06">https://tools.ietf.org/html/draft-josefsson-tls-curve25519-06</A>&gt; and
            Ed448-Goldilocks &lt;<A HREF="http://sourceforge.net/p/ed448goldilocks/wiki/Home/">http://sourceforge.net/p/ed448goldilocks/wiki/Home/</A>&gt; (see RFC 7748 -
            Elliptic Curves for Security &lt;<A HREF="https://tools.ietf.org/html/rfc7748">https://tools.ietf.org/html/rfc7748</A>&gt;), that are about to
            be defined by RFC for TLS, cf. DRAFT-ietf-tls-rfc4492bis
            &lt;<A HREF="https://tools.ietf.org/html/draft-ietf-tls-rfc4492bis-11">https://tools.ietf.org/html/draft-ietf-tls-rfc4492bis-11</A>&gt; and IANA (temporary
            registrations for ecdh_x25519, ecdh_x448)
            &lt;<A HREF="http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8">http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8</A>&gt;,
            furthermore some crypto libraries support already Curve 25519
            &lt;<A HREF="https://en.wikipedia.org/wiki/Comparison_of_TLS_implementations#Supported_elliptic_curves">https://en.wikipedia.org/wiki/Comparison_of_TLS_implementations#Supported_elliptic_curves</A>&gt;.&quot;


    Meanwhile other influences get more weight, e.g. to favor GCM over CBC. So, I've discussed this
    with Achim Hoffmann and we have developed the DRAFT for
    '<A HREF="https://www.owasp.org/index.php/TLS_Cipher_String_Cheat_Sheet">https://www.owasp.org/index.php/TLS_Cipher_String_Cheat_Sheet</A>'. There has been a Cheat Sheet
    workshop in Germany the last two days and I've sent our draft as input. So now, I am awaiting
    feedback if they had time to discuss it. And yes, it is planned to link to the Transport Layer
    Protection Cheat Sheet with the TLS Cipher String Cheat Sheet if the feedback is positive. 

  * *Additional remarks*: The overall setup for DHE/ECDHE needs to be up to date: 'Use cryptographic
    parameters (like DH-parameter) that use a secure length that match to the supported keylength of
    your certificate (&gt;=2048 bits or equivalent Elliptic Curves).'
    -&gt; As a consequence do not use DHE if you can not use DH parameters with at least 2048 bits.
    Same for ECDHE, if you can not use curves with at least 250 bits, e.g. secp{256,384,521}r1,
    x25519 (weaker curves should be deactivated, which is still a challenge. In many cases you might
    get a standard list, mostly undocumented/or with a hard to find documentation).

Finally, thank you for the hint about the typo. I've fixed it already.

I hope that this answers help or start a deeper discussion.

Cheers
Torsten


Am 12.09.2017 um 20:32 schrieb Kenneth Po:
&gt;<i> To whom this may concern:
</I>&gt;<i>
</I>&gt;<i> I have seen some inconsistencies in various OWASP cipher ordering
</I>&gt;<i> guidance. I'm unsure which guidance is correct or if info is dated.
</I>&gt;<i> Would someone be able to clarify?
</I>&gt;<i>
</I>&gt;<i> 1. This lists that DHE is preferred over ECDHE.
</I>&gt;<i> <A HREF="https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet#Rule_-_Only_Support_Strong_Cryptographic_Ciphers">https://www.owasp.org/index.php/Transport_Layer_Protection_Cheat_Sheet#Rule_-_Only_Support_Strong_Cryptographic_Ciphers</A>
</I>&gt;<i>
</I>&gt;<i> 2. These various sites list ECDHE algorithms first:
</I>&gt;<i> 2A. OWASP NGINX: <A HREF="https://www.owasp.org/index.php/SCG_WS_nginx">https://www.owasp.org/index.php/SCG_WS_nginx</A>
</I>&gt;<i> 2B. SSL Labs lists out ECDHE before DHE:
</I>&gt;<i> <A HREF="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices">https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices</A>
</I>&gt;<i> 2C. Mozilla SSL Confguration Generator list out ECDHE before DHE:
</I>&gt;<i> <A HREF="https://mozilla.github.io/server-side-tls/ssl-config-generator/">https://mozilla.github.io/server-side-tls/ssl-config-generator/</A>
</I>&gt;<i> 2D. The logjam guidance site also lists out ECDHE first:
</I>&gt;<i> <A HREF="https://weakdh.org/sysadmin.html">https://weakdh.org/sysadmin.html</A>
</I>&gt;<i>
</I>&gt;<i> ---------
</I>&gt;<i> I'd be happy to update the cheat sheets to reflect changes. I know
</I>&gt;<i> that the word 'volantile' could be a German/Deutsch translation
</I>&gt;<i> mistake and should be replaced with 'volatile'.
</I>&gt;<i>
</I>&gt;<i> Additionally, the guidance may need to be applied to the draft version
</I>&gt;<i> of the TLS Cipher String Cheat Sheet
</I>&gt;<i> (<A HREF="https://www.owasp.org/index.php/TLS_Cipher_String_Cheat_Sheet">https://www.owasp.org/index.php/TLS_Cipher_String_Cheat_Sheet</A>)
</I>&gt;<i>
</I>&gt;<i> Thanks in advance.
</I>&gt;<i>
</I>&gt;<i> Kenneth Po
</I>&gt;<i> _______________________________________________
</I>&gt;<i> OWASP-cheat-sheets mailing list
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">OWASP-cheat-sheets at lists.owasp.org</A>
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets</A>
</I>

-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20170913/50e2ed6e/attachment.html">http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20170913/50e2ed6e/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000094.html">[OWASP-cheat-sheets] Question: ECDHE and DHE cipher orders
</A></li>
	<LI>Next message: <A HREF="000096.html">[OWASP-cheat-sheets] OWASP Cheat Sheet Workshop
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#95">[ date ]</a>
              <a href="thread.html#95">[ thread ]</a>
              <a href="subject.html#95">[ subject ]</a>
              <a href="author.html#95">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
