<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%0A%09https%3A//www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&In-Reply-To=%3CCANos97d5TKeFpXSGZ3Er4nhmbnYuy3Mw81V2-U_3e%2BRv6tSS8g%40mail.gmail.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000212.html">
   <LINK REL="Next"  HREF="000204.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet</H1>
    <B>Dominique Righetto</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%0A%09https%3A//www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&In-Reply-To=%3CCANos97d5TKeFpXSGZ3Er4nhmbnYuy3Mw81V2-U_3e%2BRv6tSS8g%40mail.gmail.com%3E"
       TITLE="[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">dominique.righetto at owasp.org
       </A><BR>
    <I>Fri Feb  8 16:53:20 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="000212.html">[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
        <LI>Next message: <A HREF="000204.html">[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#202">[ date ]</a>
              <a href="thread.html#202">[ thread ]</a>
              <a href="subject.html#202">[ subject ]</a>
              <a href="author.html#202">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Uppercase usage is not mandatory, they are not impact on the message.
Process is documented on the homepage of the project, personaly when i
contribute to a project i start by visiting the homepage to take news from
the project about any contribution change or update. It's like a Git Pull
before to work on a team project...If people do not take time to do this
little step it's not my fault, i communicate enought about any change on
the project.
My time is focus on the migration, i have not the time to lock every page,
very soon these page will be updated to point to the assocated CS on GitHub.
--
Cordialement, Best regards,
Dominique Righetto
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
&lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
<A HREF="https://righettod.eu">https://righettod.eu</A>
GPG: 323D19BA


On Fri, Feb 8, 2019 at 5:45 PM Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt; wrote:

&gt;<i> OK.   PLEASE lock the cheat sheet wiki pages themselves then to prevent
</I>&gt;<i> others from contributing and then having their time wasted by having it
</I>&gt;<i> thrown away.  And then maybe create a standard footer for ALL Cheat Sheets,
</I>&gt;<i> that describes how to contribute to them.
</I>&gt;<i>
</I>&gt;<i> I know you CAN lock them because the OWASP Top 10 wiki pages were locked
</I>&gt;<i> so only a few people, like me, could edit them.
</I>&gt;<i>
</I>&gt;<i> -Dave
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Fri, Feb 8, 2019 at 11:40 AM Dominique Righetto &lt;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt; wrote:
</I>&gt;<i>
</I>&gt;&gt;<i> Section &quot;Migration Pending&quot; from
</I>&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series">https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series</A>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I understand that you don't follow our communication channel but we use
</I>&gt;&gt;<i> it to communicate and it's the communication process choosen by the project
</I>&gt;&gt;<i> and we have many good feedback about it. Slack members of the CS channel
</I>&gt;&gt;<i> increase at a high speed.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I respect your point of view but, as PL, the wiki mode allow uncontrolled
</I>&gt;&gt;<i> process of edition/creation and Jim/Me are responsible/accountable for the
</I>&gt;&gt;<i> quality/integrity of the CS/projects. Moreover the wiki do not allow
</I>&gt;&gt;<i> integration into CI for create others format or automate control. GH allow
</I>&gt;&gt;<i> also a fully open discution about any operation on CS.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I respect also the fact that you do not like the gihub way but it's the
</I>&gt;&gt;<i> new way followed by new owasp projects (masvs, mstg, asvs, proactive
</I>&gt;&gt;<i> control and the top 10) and it faciliate the contribution even if you dont
</I>&gt;&gt;<i> like it. It's more easy to create a GH account than an OWASP one.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> If you dont like this way at the point that it block your to contribute
</I>&gt;&gt;<i> then i understand and respect your position but as PL Jim/Me has decided
</I>&gt;&gt;<i> this way so we will continue the road wihtout you even if we thanks you
</I>&gt;&gt;<i> very very much for your contribution.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> --
</I>&gt;&gt;<i> Cordialement, Best regards,
</I>&gt;&gt;<i> Dominique Righetto
</I>&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
</I>&gt;&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;&gt;<i> <A HREF="https://righettod.eu">https://righettod.eu</A>
</I>&gt;&gt;<i> GPG: 323D19BA
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> On Fri, Feb 8, 2019 at 5:27 PM Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;
</I>&gt;&gt;<i> wrote:
</I>&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> Clearly indicated on the home page where?  And I don't follow OWASP on
</I>&gt;&gt;&gt;<i> Slack or Twitter so I was completely unaware of this.  You say follow 'the
</I>&gt;&gt;&gt;<i> process' but I can't find it anywhere.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> If you really don't want the cheat sheets to be edited, lock them, and
</I>&gt;&gt;&gt;<i> put notes ON the cheat sheets themselves about what the process is/where to
</I>&gt;&gt;&gt;<i> find them.
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> I'm also concerned that this process will make it MUCH harder to
</I>&gt;&gt;&gt;<i> contribute, reducing people's willingness to do so (like me).
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> -Dave
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;<i> On Thu, Feb 7, 2019 at 11:54 PM Dominique Righetto &lt;
</I>&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt; wrote:
</I>&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Hello all
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Since december wiki update of cs are deprecated. It is clearly
</I>&gt;&gt;&gt;&gt;<i> indicated on the homepage and slack and Twitter and GitHub since 3 month.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> If you modify the wiki your update will simply be ignored and lost.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Please follow the process.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> All modification and creation of cs is now controlled by Jim and me as
</I>&gt;&gt;&gt;&gt;<i> PL along Continuous Integration process.
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;<i> Le ven. 8 f&#233;vr. 2019 &#224; 00:43, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;<i> a &#233;crit :
</I>&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hi Dave - Let&#8217;s continue our discussion here so that we have
</I>&gt;&gt;&gt;&gt;&gt;<i> everything tracked in the cheat sheet email list (copying our 1:1
</I>&gt;&gt;&gt;&gt;&gt;<i> conversation below).
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I really appreciate your support in the changes. I have few comments
</I>&gt;&gt;&gt;&gt;&gt;<i> below
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a)       Dominique and Jim decided to move cheat sheets to Github.
</I>&gt;&gt;&gt;&gt;&gt;<i> So, all new changes should be on Github CSRF
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.md">https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.md</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> page. I think they are also working on deprecating the old wiki pages on
</I>&gt;&gt;&gt;&gt;&gt;<i> OWASP. I am fine with all your changes (as most of them are
</I>&gt;&gt;&gt;&gt;&gt;<i> cosmetic/grammatical/structural) except [1]. If you don&#8217;t mind, can you do
</I>&gt;&gt;&gt;&gt;&gt;<i> these changes on the Github? I am fine with you moving the reference
</I>&gt;&gt;&gt;&gt;&gt;<i> example to a different page as well. I have plans to add some other content
</I>&gt;&gt;&gt;&gt;&gt;<i> (not anytime in next month) during which I will also try to trim the
</I>&gt;&gt;&gt;&gt;&gt;<i> content as much as possible.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b)      &#8220;If a developer forgets to add the token to any state
</I>&gt;&gt;&gt;&gt;&gt;<i> changing operation, they are making the application vulnerable to CSRF.&quot; is
</I>&gt;&gt;&gt;&gt;&gt;<i> flat out wrong.  If a dev forgets to add a token, then the server is simply
</I>&gt;&gt;&gt;&gt;&gt;<i> going to reject the request. It's not going to be vulnerable.  If you
</I>&gt;&gt;&gt;&gt;&gt;<i> agree, can you fix this?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> &gt;&gt; You are &#8216;assuming&#8217; here that the server has a token verification
</I>&gt;&gt;&gt;&gt;&gt;<i> system which is not true by default. By default, all applications are
</I>&gt;&gt;&gt;&gt;&gt;<i> vulnerable to CSRF unless developers add tokens / the system has a token
</I>&gt;&gt;&gt;&gt;&gt;<i> verification system.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> c)       I am removing the changes related to [1] for now as they are
</I>&gt;&gt;&gt;&gt;&gt;<i> clearly contradicting what we have in other parts of the cheat sheet. If
</I>&gt;&gt;&gt;&gt;&gt;<i> you disagree, I am open to discussion before we get them back to the
</I>&gt;&gt;&gt;&gt;&gt;<i> cheatsheet again. I might be missing something and I would love to hear
</I>&gt;&gt;&gt;&gt;&gt;<i> your side of the story.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *1.* Earlier, I rejected both the techniques you mentioned in
</I>&gt;&gt;&gt;&gt;&gt;<i> &#8220;Stateless/Tokenless Defense Techniques&#8221; to be in primary because
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *1.1* X-Requested-With: XMLHttpRequest Header: For the same FLASH
</I>&gt;&gt;&gt;&gt;&gt;<i> related reasons mentioned under this
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet#Use_of_Custom_Request_Headers&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> section. On a separate thread, I was working with Riyaz who authored
</I>&gt;&gt;&gt;&gt;&gt;<i> this
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://blog.appsecco.com/exploiting-csrf-on-json-endpoints-with-flash-and-redirects-681d4ad6b31b">https://blog.appsecco.com/exploiting-csrf-on-json-endpoints-with-flash-and-redirects-681d4ad6b31b</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> blog and you wouldn&#8217;t believe how many old browser versions are still
</I>&gt;&gt;&gt;&gt;&gt;<i> vulnerable to this FLASH based redirect CSRF vulnerability. He also gave
</I>&gt;&gt;&gt;&gt;&gt;<i> link to a HTML wrapper which seems to make this attack work on newer Chrome
</I>&gt;&gt;&gt;&gt;&gt;<i> versions as well. If you are interested, I can provide more details about
</I>&gt;&gt;&gt;&gt;&gt;<i> these. Hence, I don&#8217;t want users to be vulnerable by using this as a
</I>&gt;&gt;&gt;&gt;&gt;<i> primary defense.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *1.2 *Not a Simple HTTP Request Verification: Again, this is a
</I>&gt;&gt;&gt;&gt;&gt;<i> technique that I rejected in the later section
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet#Content-Type_Header_Validation&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> of the document along with the reasoning.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I just made some changes, feel free to review.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I also think this comment: &quot;If a developer forgets to add the token
</I>&gt;&gt;&gt;&gt;&gt;<i> to any state changing operation, they are making the application vulnerable
</I>&gt;&gt;&gt;&gt;&gt;<i> to CSRF.&quot; is flat out wrong.  If a dev forgets to add a token, then
</I>&gt;&gt;&gt;&gt;&gt;<i> the server is simply going to reject the request. It's not going to be
</I>&gt;&gt;&gt;&gt;&gt;<i> vulnerable.  If you agree, can you fix this?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The article is also REALLY LONG. If you can identify anything to trim
</I>&gt;&gt;&gt;&gt;&gt;<i> out, that would be great. I just trimmed out a few things, but I think we
</I>&gt;&gt;&gt;&gt;&gt;<i> can do a lot more. Cheat sheets are supposed to be SHORT, but I realize
</I>&gt;&gt;&gt;&gt;&gt;<i> many are not.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> For example, maybe we can move the reference example to a completely
</I>&gt;&gt;&gt;&gt;&gt;<i> different page? That would shorten this alot.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [image: <A HREF="https://ssl.gstatic.com/ui/v1/icons/mail/images/cleardot.gif">https://ssl.gstatic.com/ui/v1/icons/mail/images/cleardot.gif</A>]
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> -Dave
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Wed, Feb 6, 2019 at 5:25 PM manideep konakandla &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Yes. All those changes passed through review on email list but yes,
</I>&gt;&gt;&gt;&gt;&gt;<i> please feel free to provide any more comments.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Wed, Feb 6, 2019, 1:21 PM Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>  wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Are you:  Manideepk &lt;<A HREF="https://www.owasp.org/index.php/User:Manideepk">https://www.owasp.org/index.php/User:Manideepk</A>&gt; on
</I>&gt;&gt;&gt;&gt;&gt;<i> the OWASP site?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I have some questions/comments about your changes to the OWASP CSRF
</I>&gt;&gt;&gt;&gt;&gt;<i> Cheat Sheet.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The bulk of those changes are here:
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php?title=Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&amp;type=revision&amp;diff=244184&amp;oldid=242455">https://www.owasp.org/index.php?title=Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&amp;type=revision&amp;diff=244184&amp;oldid=242455</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> If this is you, I'll provide more details, but wanted to make sure I'm
</I>&gt;&gt;&gt;&gt;&gt;<i> in touch with the right person first.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> -Dave
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Sunday, December 23, 2018 4:13 AM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re: [OWASP-cheat-sheets]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanksyou very much for your support &#128077;&#128077;&#128077;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Le sam. 22 d&#233;c. 2018 &#224; 22:24, Konakandla, Manideep &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt; a &#233;crit :
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Let me know once the migration is started. I will do it for the CSRF
</I>&gt;&gt;&gt;&gt;&gt;<i> prevention cheatsheet page J
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Saturday, December 22, 2018 12:29 AM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re: [OWASP-cheat-sheets]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hello Manideep,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanks you for the update.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> For info we will migrate the entire project content (unless the
</I>&gt;&gt;&gt;&gt;&gt;<i> homepage) to github so it is possible that you need to also made the update
</I>&gt;&gt;&gt;&gt;&gt;<i> on the github repository.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The migration work will start on January, i will take some rest until
</I>&gt;&gt;&gt;&gt;&gt;<i> January, i really need it.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanks you very much for your help on this project :)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Happy holidays too
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;&gt;<i> Cordialement, Best regards,
</I>&gt;&gt;&gt;&gt;&gt;<i> Dominique Righetto
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://righettod.eu">https://righettod.eu</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> GPG: 323D19BA
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Sat, Dec 22, 2018 at 3:40 AM Konakandla, Manideep &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hello all,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I made a change to &#8220;Double Submit Cookie&#8221; technique [1]. I added a
</I>&gt;&gt;&gt;&gt;&gt;<i> variant to it which now mitigates well-known security issues with standard
</I>&gt;&gt;&gt;&gt;&gt;<i> &#8220;Double Submit Cookie&#8221; technique. So, people can use this technique without
</I>&gt;&gt;&gt;&gt;&gt;<i> any issues. Please let me know if anyone finds any issues within it.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Whenever I get some free time in next 1-2 months, I am planning to
</I>&gt;&gt;&gt;&gt;&gt;<i> include
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a)       Details about popular 6-7 web frameworks and the CSRF
</I>&gt;&gt;&gt;&gt;&gt;<i> mitigations implemented by them
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b)      Re-organize the page even more better by switching variant of
</I>&gt;&gt;&gt;&gt;&gt;<i> double submit cookie to primary defense (under stateless section) etc.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Happy holidays everyone J
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [1]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet#Double_Submit_Cookie
</I>&gt;&gt;&gt;&gt;&gt;<i> (read the last para under this mitigation)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Saturday, October 13, 2018 12:59 AM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;; Pankaj Upadhyay &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re: [OWASP-cheat-sheets]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> CS publishing released and notification sent to the community via
</I>&gt;&gt;&gt;&gt;&gt;<i> Twitter and Slack channel.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;&gt;<i> Cordialement, Best regards,
</I>&gt;&gt;&gt;&gt;&gt;<i> Dominique Righetto
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://righettod.eu">https://righettod.eu</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> GPG: 323D19BA
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Fri, Oct 12, 2018 at 3:47 AM Konakandla, Manideep &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Yes, I am feeling way better now. Thank you J
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *@ALL: *Cheat sheet is updated with all the changes now
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet&gt;.
</I>&gt;&gt;&gt;&gt;&gt;<i> Please let me know if you have any issues by end of tomorrow. If there are
</I>&gt;&gt;&gt;&gt;&gt;<i> no issues - I/we can start advertising the refactored cheat sheet in our
</I>&gt;&gt;&gt;&gt;&gt;<i> networks J
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanks a ton *Dominique* and *Jim* for all your help till date. I
</I>&gt;&gt;&gt;&gt;&gt;<i> really appreciate it!!! I will be actively maintaining this as well from
</I>&gt;&gt;&gt;&gt;&gt;<i> today J
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Regards,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Manideep Konakandla
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> www.manideepk.com
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Security Engineer @ Amazon
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Wednesday, October 10, 2018 10:39 PM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;; Pankaj
</I>&gt;&gt;&gt;&gt;&gt;<i> Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re: [OWASP-cheat-sheets]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Go for it!!! I hope you&#8217;re feeling better!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Jim Manico
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> @Manicode
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Oct 10, 2018, at 10:18 PM, Konakandla, Manideep &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Sorry for late reply. I was on sick leave for last 2 days.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I synced up with Dominique in a different email chain to clarify
</I>&gt;&gt;&gt;&gt;&gt;<i> something in his previous email. He gave me a go ahead to update wiki with
</I>&gt;&gt;&gt;&gt;&gt;<i> new re-factored cheat sheet. I am planning to do it sometime tomorrow.
</I>&gt;&gt;&gt;&gt;&gt;<i> *@Jim* : Is it with fine with you as well? Please let me know if you
</I>&gt;&gt;&gt;&gt;&gt;<i> have any concerns.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Monday, October 8, 2018 1:47 AM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;; Jim Manico &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re: [OWASP-cheat-sheets]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hello all,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> In order to move forward and deliver something in the project please
</I>&gt;&gt;&gt;&gt;&gt;<i> update the wiki with content from the refactoring from Konakandla Manideep.
</I>&gt;&gt;&gt;&gt;&gt;<i> If there missing points they will be added in another round it is the role
</I>&gt;&gt;&gt;&gt;&gt;<i> of the wiki based usage.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanks in advance for your understanding &#128521;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Le lun. 8 oct. 2018 &#224; 10:11, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> a &#233;crit :
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hey Folks J
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Good conversation :) Can you guys review the new cheat sheet once? I
</I>&gt;&gt;&gt;&gt;&gt;<i> am sure most of the discussion going on here is already answered in the new
</I>&gt;&gt;&gt;&gt;&gt;<i> re-factored cheat sheet I wrote.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> @Pankaj &#8211; Go through the respective sections in the new cheat sheet.
</I>&gt;&gt;&gt;&gt;&gt;<i> If they are not clear / you are not convinced, we can discuss more. Below
</I>&gt;&gt;&gt;&gt;&gt;<i> is the summary of my response to your questions (you will find the same
</I>&gt;&gt;&gt;&gt;&gt;<i> gist going through the cheat sheet as well).
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Go through [2] to understand more detailed on how flash based bypass
</I>&gt;&gt;&gt;&gt;&gt;<i> on CSRF custom mitigation defense works. You can see there that the origin
</I>&gt;&gt;&gt;&gt;&gt;<i> headers are passed along with the custom headers and hence current wiki
</I>&gt;&gt;&gt;&gt;&gt;<i> asks to do origin and/or referrer header check as defense-in-depth (it
</I>&gt;&gt;&gt;&gt;&gt;<i> would help even if flash sometime in the future repeats same mistake and
</I>&gt;&gt;&gt;&gt;&gt;<i> forwards custom headers without crossdomain.xml checks. Domain requesting
</I>&gt;&gt;&gt;&gt;&gt;<i> the redirected request might be fooled with custom header bypass but not
</I>&gt;&gt;&gt;&gt;&gt;<i> the origin header check). If both these checks are done, it is indeed a
</I>&gt;&gt;&gt;&gt;&gt;<i> good defense but origin header is not always included etc. (just as Jim
</I>&gt;&gt;&gt;&gt;&gt;<i> mentioned and also as new cheatsheet mentions).  I don&#8217;t think deprecating
</I>&gt;&gt;&gt;&gt;&gt;<i> custom header check is a good idea. It is indeed a good solution for
</I>&gt;&gt;&gt;&gt;&gt;<i> stateless services though they have to keep issues like I mentioned before
</I>&gt;&gt;&gt;&gt;&gt;<i> in mind. Your statement of custom header itself doesn&#8217;t mitigate CSRF
</I>&gt;&gt;&gt;&gt;&gt;<i> relies on the fact that &#8220;Flash being vulnerable to same bug again in
</I>&gt;&gt;&gt;&gt;&gt;<i> future&#8221;. We cannot rely on a future statement and deprecate a technique,
</I>&gt;&gt;&gt;&gt;&gt;<i> instead providing defense in depth measure for it and also cautioning users
</I>&gt;&gt;&gt;&gt;&gt;<i> about past issues might be good idea. Users can take their call. Please
</I>&gt;&gt;&gt;&gt;&gt;<i> read custom headers and origin check sections I re-wrote for more
</I>&gt;&gt;&gt;&gt;&gt;<i> in-details. It talks about the issues and people can select if they want to
</I>&gt;&gt;&gt;&gt;&gt;<i> use it or not.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Also, Login CSRF has nothing to do with custom header mitigation.
</I>&gt;&gt;&gt;&gt;&gt;<i> Login forms are usually handled on &lt;form&gt; tags and custom header mitigation
</I>&gt;&gt;&gt;&gt;&gt;<i> is only applicable on ajax calls because you cannot set custom headers on
</I>&gt;&gt;&gt;&gt;&gt;<i> form tags. It can be applicable if you are doing logins on Ajax/XHR
</I>&gt;&gt;&gt;&gt;&gt;<i> requests in which case my above response from custom header mitigation
</I>&gt;&gt;&gt;&gt;&gt;<i> applies. I also proposed few methods for mitigating login CSRF which aligns
</I>&gt;&gt;&gt;&gt;&gt;<i> with our primary defense on the new cheatsheet (tokens). Please review it
</I>&gt;&gt;&gt;&gt;&gt;<i> as well.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Also, CORS has nothing to do with CSRF. I infact added CORS as a
</I>&gt;&gt;&gt;&gt;&gt;<i> technique that should not be used/even thought for CSRF in the new
</I>&gt;&gt;&gt;&gt;&gt;<i> cheatsheet I wrote. Please check that and also read [1]
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [1]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2017/september/common-csrf-prevention-misconceptions/">https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2017/september/common-csrf-prevention-misconceptions/</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [2] <A HREF="https://www.whitehatsec.com/blog/flash-307-redirect-game-over/">https://www.whitehatsec.com/blog/flash-307-redirect-game-over/</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> BTW - Here is the link to the new cheat sheet -
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://tinyurl.com/y7k9fded">https://tinyurl.com/y7k9fded</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Again,  I you are not convinced &#8211; please let me know specific item and
</I>&gt;&gt;&gt;&gt;&gt;<i> we can happily discuss further J Alternatively, you can send us your
</I>&gt;&gt;&gt;&gt;&gt;<i> edits here for review and if it looks good for everyone &#8211; you can edit it
</I>&gt;&gt;&gt;&gt;&gt;<i> in the wiki.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Sunday, October 7, 2018 1:13 PM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;; Konakandla, Manideep &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re: [OWASP-cheat-sheets]
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Sync your update with one from Konakandla Manideep please &#128521;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Le dim. 7 oct. 2018 &#224; 21:54, Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> a &#233;crit :
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Aloha Jim!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> With XSS, even CSRF tokens can be stolen :).
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> But I'll keep your tip in mind when editing the wiki. I'm planning to
</I>&gt;&gt;&gt;&gt;&gt;<i> do that sometime this month.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Please feel free to review it whenever you guys get a chance.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Best,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Pankaj
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Sun, Oct 7, 2018 at 2:59 PM Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I agree JWT's architectures *where cookies are not involved* are
</I>&gt;&gt;&gt;&gt;&gt;<i> resistant to CSRF but those tokens are at the risk of being stolen over XSS!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The Origin header does not go with all requests and FireFox does not
</I>&gt;&gt;&gt;&gt;&gt;<i> fully support it yet. So careful!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> :)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On 10/7/18 9:48 AM, Pankaj Upadhyay wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I agree and that's why I would like to propose deprecation of 'custom
</I>&gt;&gt;&gt;&gt;&gt;<i> header approach' as a CSRF defense.
</I>&gt;&gt;&gt;&gt;&gt;<i> Presently the mechanism that seems to work across applications is
</I>&gt;&gt;&gt;&gt;&gt;<i> validating custom header as well as a forbidden header name (that cannot be
</I>&gt;&gt;&gt;&gt;&gt;<i> set by a software or a program) e.g. Origin. If we want to give it a new
</I>&gt;&gt;&gt;&gt;&gt;<i> name like 'Double Header Validation' or something else, I'm fine with that
</I>&gt;&gt;&gt;&gt;&gt;<i> but custom header alone doesn't seem sufficient to mitigate CSRF issue.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> There are some other best practices that should also be considered. I
</I>&gt;&gt;&gt;&gt;&gt;<i> think CORS is now mature enough to have a mention in the CSRF defense Also,
</I>&gt;&gt;&gt;&gt;&gt;<i> applications utilizing JWT token in the header seem immune to CSRF.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Please let me know what you guys think and if allowed, I can go ahead
</I>&gt;&gt;&gt;&gt;&gt;<i> and make some of these edits for your perusal.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Sun, Oct 7, 2018 at 2:29 AM Dominique Righetto &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Good question, I think it's more a point about to be consistent in
</I>&gt;&gt;&gt;&gt;&gt;<i> terms of CSRF check across the application. Indeed, if you begin to perform
</I>&gt;&gt;&gt;&gt;&gt;<i> different kind of CSRF check depending on the feature of the application
</I>&gt;&gt;&gt;&gt;&gt;<i> (login, business feature, reset password...) it becomes risky and you
</I>&gt;&gt;&gt;&gt;&gt;<i> significantly increase the chance to include location in which you will
</I>&gt;&gt;&gt;&gt;&gt;<i> have a CSRF check weakness...
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;&gt;<i> Cordialement, Best regards,
</I>&gt;&gt;&gt;&gt;&gt;<i> Dominique Righetto
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://righettod.eu">https://righettod.eu</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> GPG: 323D19BA
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Sat, Oct 6, 2018 at 9:51 PM Pankaj Upadhyay &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Do we know, regarding login CSRF, why validating the custom header as
</I>&gt;&gt;&gt;&gt;&gt;<i> well as the Origin/Host header is not a sufficient mitigation?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Fri, Sep 28, 2018 at 9:35 PM Konakandla, Manideep &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt; wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Login CSRF is a way of exploiting CSRF on login forms (details here
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://seclab.stanford.edu/websec/csrf/csrf.pdf">https://seclab.stanford.edu/websec/csrf/csrf.pdf</A>&gt;). Though there is
</I>&gt;&gt;&gt;&gt;&gt;<i> a line about it in referrer validation section, it was not explained
</I>&gt;&gt;&gt;&gt;&gt;<i> clearly and how it can scale with other techniques such as token based
</I>&gt;&gt;&gt;&gt;&gt;<i> mitigation. No worries, I added a section about it!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Finally, I am done with the document from my side and its sent for
</I>&gt;&gt;&gt;&gt;&gt;<i> internal reviews now. It should take 1-2 weeks before it comes to you guys.
</I>&gt;&gt;&gt;&gt;&gt;<i> Meanwhile, I still need help on below items from you guys. If no one was
</I>&gt;&gt;&gt;&gt;&gt;<i> able to find references for a), we can very well remove it.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a.     Under double submit cookie section, it is mentioned that DWR
</I>&gt;&gt;&gt;&gt;&gt;<i> uses that approach but I could not find that anywhere within DWR
</I>&gt;&gt;&gt;&gt;&gt;<i> documentation that it uses double submit cookie. Can someone help me
</I>&gt;&gt;&gt;&gt;&gt;<i> finding reference if they know any?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b.     One thing I wouldn&#8217;t be reviewing is the ASP.NET references mentioned
</I>&gt;&gt;&gt;&gt;&gt;<i> in the wiki
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages</A>&gt;.
</I>&gt;&gt;&gt;&gt;&gt;<i> Can someone with .NET expertize verify if these are still accurate? Looks
</I>&gt;&gt;&gt;&gt;&gt;<i> to me like there are latest resources than the one&#8217;s linked in current
</I>&gt;&gt;&gt;&gt;&gt;<i> cheatsheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Happy weekend folks J
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Thursday, September 27, 2018 3:02 AM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;; Jim Manico &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;; Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re:
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> ...as for (d) I dont see any problems with passing tokens as headers
</I>&gt;&gt;&gt;&gt;&gt;<i> or parameters
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I dont understand (e) can you explain that again?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> --
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Jim Manico
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> @Manicode
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Secure Coding Education
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> +1 (808) 652-3805
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On Sep 26, 2018, at 4:46 PM, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> 2 more questions added  (Jim already started helping me on #a)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a.     I requested for an OWASP account and it&#8217;s still in pending.
</I>&gt;&gt;&gt;&gt;&gt;<i> @JIM &#8211; Can you please help me in getting my account approved? (registered
</I>&gt;&gt;&gt;&gt;&gt;<i> with <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b.     Under double submit cookie section, it is mentioned that DWR
</I>&gt;&gt;&gt;&gt;&gt;<i> uses that approach but I could not find that anywhere within DWR
</I>&gt;&gt;&gt;&gt;&gt;<i> documentation that it uses double submit cookie. Can someone help me
</I>&gt;&gt;&gt;&gt;&gt;<i> finding reference if they know any?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> c.     One thing I wouldn&#8217;t be reviewing is the ASP.NET references mentioned
</I>&gt;&gt;&gt;&gt;&gt;<i> in the wiki
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages</A>&gt;.
</I>&gt;&gt;&gt;&gt;&gt;<i> Can someone with .NET expertize verify if these are still accurate? Looks
</I>&gt;&gt;&gt;&gt;&gt;<i> to me like there are latest resources than the one&#8217;s linked
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> d.     At few places within the wiki, I have seen recommending to
</I>&gt;&gt;&gt;&gt;&gt;<i> include token in headers for Ajax requests. I also don&#8217;t see a problem in
</I>&gt;&gt;&gt;&gt;&gt;<i> passing them as parameters as well. Do you guys see any?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> e.     I also have not seen at any place within the wiki talking
</I>&gt;&gt;&gt;&gt;&gt;<i> about login CSRF issues and how each of the techniques described can be
</I>&gt;&gt;&gt;&gt;&gt;<i> prone/immune to it. Is there any reason for it or are we open to include
</I>&gt;&gt;&gt;&gt;&gt;<i> that?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Konakandla, Manideep
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Wednesday, September 26, 2018 5:27 PM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* 'Jim Manico' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;; 'Dominique Righetto' &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* 'Jim Manico' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;; 'Dave Wichers' &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;; '<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>' &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* RE:
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Yeah. My understanding of the breadth of exploitation of XSS in an
</I>&gt;&gt;&gt;&gt;&gt;<i> application protected with just origin/referrer and other application
</I>&gt;&gt;&gt;&gt;&gt;<i> protected with just token based mitigation earlier was wrong. Dominique
</I>&gt;&gt;&gt;&gt;&gt;<i> earlier email thread cleared that to me (breadth of exploitation is same in
</I>&gt;&gt;&gt;&gt;&gt;<i> both the cases. i.e., if an XSS vulnerability is found in any individual
</I>&gt;&gt;&gt;&gt;&gt;<i> application protected with only one of those techniques, it still can
</I>&gt;&gt;&gt;&gt;&gt;<i> exploit all state changing operations on entire application [though the
</I>&gt;&gt;&gt;&gt;&gt;<i> complexity of exploitation is easy in origin/referrer check than token
</I>&gt;&gt;&gt;&gt;&gt;<i> based mitigation]).
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Anyway, I am all clear and also almost done with re-factoring the
</I>&gt;&gt;&gt;&gt;&gt;<i> cheatsheet  [1] J Should be fully completed by Friday unless
</I>&gt;&gt;&gt;&gt;&gt;<i> something comes up meanwhile. I will then send it to my colleagues for
</I>&gt;&gt;&gt;&gt;&gt;<i> review and then for Legal, PR approvals. Before that, I need help from you
</I>&gt;&gt;&gt;&gt;&gt;<i> guys on below items
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a.     I requested for an OWASP account and it&#8217;s still in pending.
</I>&gt;&gt;&gt;&gt;&gt;<i> @JIM &#8211; Can you please help me in getting my account approved? (registered
</I>&gt;&gt;&gt;&gt;&gt;<i> with <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b.     Under double submit cookie section, it is mentioned that DWR
</I>&gt;&gt;&gt;&gt;&gt;<i> uses that approach but I could not find that anywhere within DWR
</I>&gt;&gt;&gt;&gt;&gt;<i> documentation that it uses double submit cookie. Can someone help me
</I>&gt;&gt;&gt;&gt;&gt;<i> finding reference if they know any?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> c.     One thing I wouldn&#8217;t be reviewing is the ASP.NET references mentioned
</I>&gt;&gt;&gt;&gt;&gt;<i> in the wiki
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages</A>&gt;.
</I>&gt;&gt;&gt;&gt;&gt;<i> Can someone with .NET expertize verify if these are still accurate? Looks
</I>&gt;&gt;&gt;&gt;&gt;<i> to me like there are latest resources than the one&#8217;s linked
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [1] Below are changes done so far
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a. Switched primary, secondary defense and our reasoning behind it
</I>&gt;&gt;&gt;&gt;&gt;<i> (added lot of reasons on issues with origin/referrer header check and why
</I>&gt;&gt;&gt;&gt;&gt;<i> token should be made primary)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b. Added CSRF mitigation myths (CORS, content-type validation etc.)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> c. Added a section called &#8220;Not so popular CSRF mitigations&#8221; (mentioned
</I>&gt;&gt;&gt;&gt;&gt;<i> details about triple submit cookie)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> d. Included limitations / issues associated with double submit cookie,
</I>&gt;&gt;&gt;&gt;&gt;<i> same site cookie, captcha as a CSRF defense etc.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> e. Removed lot of obsolete content and added some new content to some
</I>&gt;&gt;&gt;&gt;&gt;<i> of the mitigations
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> f. Made document look more better by adding RFC&#8217;s links wherever
</I>&gt;&gt;&gt;&gt;&gt;<i> possible and lot of other minor changes.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Wednesday, September 26, 2018 4:19 PM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;; Dominique Righetto &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;; Dave Wichers &lt;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re:
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Well tokens can be placed in cookies.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> The real answer to avoid CSRF is tokens in JavaScript variable as
</I>&gt;&gt;&gt;&gt;&gt;<i> opposed to cookies. They are not automatically sent and indeed make CSRF
</I>&gt;&gt;&gt;&gt;&gt;<i> impossible - at the expense of tokens being fully stolen via XSS. Pick your
</I>&gt;&gt;&gt;&gt;&gt;<i> poison!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I recommend a COMBO of these defenses. For web apps, sychronizer token
</I>&gt;&gt;&gt;&gt;&gt;<i> + header verification + re-authentication for sensitive features.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> For API's double-cookie submit or just use JavaScript variable based
</I>&gt;&gt;&gt;&gt;&gt;<i> tokens + header verification for same-site API's + re-authentication for
</I>&gt;&gt;&gt;&gt;&gt;<i> sensitive features.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> &gt; [1] If there is an XSS vulnerability at a single place on a domain
</I>&gt;&gt;&gt;&gt;&gt;<i> (it can add custom header), it can be used to make CSRF *on all other
</I>&gt;&gt;&gt;&gt;&gt;<i> state changing operationswithin that domain *done to that AJAX
</I>&gt;&gt;&gt;&gt;&gt;<i> endpoint. Do you agree?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Absolutely!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On 9/20/18 11:12 AM, Konakandla, Manideep wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Yeah, I understand that any XSS and CSRF game is over but I am
</I>&gt;&gt;&gt;&gt;&gt;<i> stressing out on the highlighted part in [1]. I am trying to highlight and
</I>&gt;&gt;&gt;&gt;&gt;<i> get an affirmation on why my understanding on token based mitigation is
</I>&gt;&gt;&gt;&gt;&gt;<i> better than origin/referrer header check will also apply to &#8220;token based
</I>&gt;&gt;&gt;&gt;&gt;<i> mitigation Vs custom header mitigation (if static tokens are used in custom
</I>&gt;&gt;&gt;&gt;&gt;<i> headers)&#8221;.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> In case of tokens, we have an option to use different tokens on each
</I>&gt;&gt;&gt;&gt;&gt;<i> page (taking things like URL, timestamp etc. into consideration) and hence
</I>&gt;&gt;&gt;&gt;&gt;<i> XSS vulnerability on one page will only make state changing operations in
</I>&gt;&gt;&gt;&gt;&gt;<i> that page vulnerable to CSRF but not state changing operations on other
</I>&gt;&gt;&gt;&gt;&gt;<i> pages within that domain (because token value is different) but whereas in
</I>&gt;&gt;&gt;&gt;&gt;<i> origin/referrer header check and custom header check, the token value is
</I>&gt;&gt;&gt;&gt;&gt;<i> constant and hence XSS vulnerability in one page will also cause state
</I>&gt;&gt;&gt;&gt;&gt;<i> changing operations in other pages to be vulnerable to CSRF as well. Off
</I>&gt;&gt;&gt;&gt;&gt;<i> course, this can be mitigated in custom header checks by adding tokens to
</I>&gt;&gt;&gt;&gt;&gt;<i> custom headers rather than static constant but this cannot be mitigated in
</I>&gt;&gt;&gt;&gt;&gt;<i> origin/referrer check because those headers cannot be modified. So, yeah a
</I>&gt;&gt;&gt;&gt;&gt;<i> single XSS any CSRF is bypassed but the breadth of the impact is different
</I>&gt;&gt;&gt;&gt;&gt;<i> for each of them.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Regarding code samples &#8211; I currently was able to allocate only some
</I>&gt;&gt;&gt;&gt;&gt;<i> time for this task and I don&#8217;t think I will be able to do code samples
</I>&gt;&gt;&gt;&gt;&gt;<i> within this time frame. I am also leaving for a long vacation starting Oct
</I>&gt;&gt;&gt;&gt;&gt;<i> 12 and hence let&#8217;s try to get this out first and we can add code samples
</I>&gt;&gt;&gt;&gt;&gt;<i> later on considering my work load after I return from vacation.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [1] If there is an XSS vulnerability at a single place on a domain (it
</I>&gt;&gt;&gt;&gt;&gt;<i> can add custom header), it can be used to make CSRF *on all other
</I>&gt;&gt;&gt;&gt;&gt;<i> state changing operationswithin that domain *done to that AJAX
</I>&gt;&gt;&gt;&gt;&gt;<i> endpoint. Do you agree?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Sent:* Thursday, September 20, 2018 8:45 AM
</I>&gt;&gt;&gt;&gt;&gt;<i> *To:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i> *Cc:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;;
</I>&gt;&gt;&gt;&gt;&gt;<i> Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;; Dave
</I>&gt;&gt;&gt;&gt;&gt;<i> Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt; &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;;
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;&gt;&gt;&gt;&gt;<i> *Subject:* Re:
</I>&gt;&gt;&gt;&gt;&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hi,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanks for your contribution.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I like very much your plan &#128521;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I ask for some favor in addition :
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> - can you provide code sample (in one language like java or .net or
</I>&gt;&gt;&gt;&gt;&gt;<i> the one you want but it must be easy to read and understand) or libraires
</I>&gt;&gt;&gt;&gt;&gt;<i> along your proposal for each section?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> - can you use the syntaxhighlight tag for code?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> I'am agree with Jim, XSS  means game over because your browsing
</I>&gt;&gt;&gt;&gt;&gt;<i> context can be used as proxy so csrf protection will be defeated because
</I>&gt;&gt;&gt;&gt;&gt;<i> request came from the legitimate user.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Thanks you again for all your help &#128077;&#128077;&#128077;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Le jeu. 20 sept. 2018 &#224; 18:31, Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt; a &#233;crit :
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> &gt; If there is an XSS vulnerability at a single place on a domain (it
</I>&gt;&gt;&gt;&gt;&gt;<i> can add custom header), it can be used to make CSRF on all other state
</I>&gt;&gt;&gt;&gt;&gt;<i> changing operations within that domain done to that AJAX endpoint. Do you
</I>&gt;&gt;&gt;&gt;&gt;<i> agree?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Any XSS is game over and all CSRF are useless in the face of XSS. I
</I>&gt;&gt;&gt;&gt;&gt;<i> Agree!
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> - Jim
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> On 9/19/18 10:52 PM, Konakandla, Manideep wrote:
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Hey Guys,
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [1] is what I said for origin/referrer header check in this e-mail
</I>&gt;&gt;&gt;&gt;&gt;<i> thread. I also believe that this applies for custom headers for AJAX
</I>&gt;&gt;&gt;&gt;&gt;<i> endpoints as well. If there is an XSS vulnerability at a single place on a
</I>&gt;&gt;&gt;&gt;&gt;<i> domain (it can add custom header), it can be used to make CSRF on all other
</I>&gt;&gt;&gt;&gt;&gt;<i> state changing operations within that domain done to that AJAX endpoint. Do
</I>&gt;&gt;&gt;&gt;&gt;<i> you agree?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> Here is how I am keeping the new re-factored cheatsheet. Does this
</I>&gt;&gt;&gt;&gt;&gt;<i> look good to you guys?
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> 1.       Use token based method as primary defense
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a.       Can use synchronizer pattern for stateful applications
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b.       Can use hah based/ encryption based token pattern for
</I>&gt;&gt;&gt;&gt;&gt;<i> stateless applications
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> 2.       Defense in depth measures along with drawbacks of each one
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> a.       Origin/referrer header check
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> b.       Double submit cookie
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> c.       Samesite cookie
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> d.       Custom headers (people still need to use tokens for forms
</I>&gt;&gt;&gt;&gt;&gt;<i> etc. if they have mix of ajax endpoints and general HTML)
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> 3.       Strong CSRF defenses but very less usable : captcha etc.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> 4.       CSRF Myths / techniques that do not work section
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> [1] if we solely rely on origin/referrer header check - an XSS
</I>&gt;&gt;&gt;&gt;&gt;<i> vulnerability within a single page on that domain will also give CSRF
</I>&gt;&gt;&gt;&gt;&gt;<i> vulnerability to all other state changing operations under that entire
</I>&gt;&gt;&gt;&gt;&gt;<i> domain.
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i> *From:* Dominique Righetto &lt;span st &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>&gt;&gt;&gt;&gt;&gt;<i>
</I>-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20190208/5ac3d5f0/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20190208/5ac3d5f0/attachment-0001.html</A>&gt;
</PRE>









<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000212.html">[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
	<LI>Next message: <A HREF="000204.html">[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#202">[ date ]</a>
              <a href="thread.html#202">[ thread ]</a>
              <a href="subject.html#202">[ subject ]</a>
              <a href="author.html#202">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
