<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%0A%20https%3A//www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&In-Reply-To=%3Cdfeac335745a4c50b03e883d3e7bbd3a%40EX13D11UWB004.ant.amazon.com%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000204.html">
   <LINK REL="Next"  HREF="000209.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet</H1>
    <B>Konakandla, Manideep</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%0A%20https%3A//www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&In-Reply-To=%3Cdfeac335745a4c50b03e883d3e7bbd3a%40EX13D11UWB004.ant.amazon.com%3E"
       TITLE="[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">mkonakan at amazon.com
       </A><BR>
    <I>Fri Feb  8 21:41:57 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="000204.html">[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
        <LI>Next message: <A HREF="000209.html">[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#208">[ date ]</a>
              <a href="thread.html#208">[ thread ]</a>
              <a href="subject.html#208">[ subject ]</a>
              <a href="author.html#208">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>I haven&#8217;t used public facing Github much in last year and I am not sure about that. You guys might want to see it if it&#8217;s possible with the type of account you may have and if not, may you might wanna think about considering alternatives (I think making people editors for full package and providing them instructions to just make sure that they touch only their cheat sheet is not a bad idea too).

From: Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;
Sent: Friday, February 8, 2019 1:30 PM
To: Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;; Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;; Matt Tesauro &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">matt.tesauro at owasp.org</A>&gt;
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>; Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet


Will GitHub let us make you editor of the one cheatsheet you authored? If so I think that is ok.

Aloha, Jim
On 2/8/19 11:27 AM, Konakandla, Manideep wrote:
I personally feel that Github is a nice move as well &#8220;but&#8221; I think atleast 1 or 2 people should be given control over each cheat sheet along with the PLs. I agree PLs are great, knowledgable but I contributed a lot to CSRF cheat sheet recently and also have BUNCH of other things that I planned to add. I obviously would know more about this stuff than PLs (really, no offense, I am just saying that I know more about the stuff that I added). PLs can make sure the overall quality of the cheat sheets is being maintained and individual cheat sheet owners can make sure that their particular cheat sheet is in quality. I just feel that we are trying to convert a wide open Wikipedia (OWASP wikis) into closed controlled market. It&#8217;s fine doing it but atleast let the control be kept in few more deserved hands as well. What do you guys think about this? I would love to hear your side of the story.

Hi Dave, Regarding

a)     Feel free to go ahead and submit a PR for reflecting the clarity. I am fine with it, it&#8217;s not any technical change.

b)    I provided the resources you requested in a separate email. Unless there is some technical reasoning that those techniques are not having any vulnerability out in market today, I am not comfortable moving them to primary defense.

P.S: I tried putting up my views/opinions/answers as a friendly constructive conversation and would appreciate the same in return &#9786;

From: owasp-cheat-sheets-bounces+mkonakan=<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">amazon.com at lists.owasp.org</A>&lt;mailto:owasp-cheat-sheets-bounces+mkonakan=<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">amazon.com at lists.owasp.org</A>&gt; &lt;owasp-cheat-sheets-bounces+mkonakan=<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">amazon.com at lists.owasp.org</A>&gt;&lt;mailto:owasp-cheat-sheets-bounces+mkonakan=<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">amazon.com at lists.owasp.org</A>&gt; On Behalf Of Dominique Righetto
Sent: Friday, February 8, 2019 11:27 AM
To: Matt Tesauro &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">matt.tesauro at owasp.org</A>&gt;&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">matt.tesauro at owasp.org</A>&gt;
Cc: <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet

Thanks you very much Matt for your supports and your feedback.

Le ven. 8 f&#233;vr. 2019 &#224; 19:18, Matt Tesauro &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">matt.tesauro at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">matt.tesauro at owasp.org</A>&gt;&gt; a &#233;crit :
For what it's worth, I'd strongly support this move.  Putting the cheat sheets in Github in something like Markdown makes great sense both in terms of ease to transform that content to other formats with something like pandoc or Jekyll plus the ability to use Git, GH issues, PRs,  GH projects (&quot;kanban-like board) to discuss and track changes to that content.  Additionally, you could use GH Pages to provide nicely rendered version of the cheat sheets as well.

I believe it would help increase contribution to this great project.

Cheers!

--
-- Matt Tesauro
OWASP Foundation
Director of Community and Operations
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">matt.tesauro at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">matt.tesauro at owasp.org</A>&gt;

Consider giving back, and supporting the open source community by becoming a member&lt;<A HREF="https://www.owasp.org/index.php/Membership">https://www.owasp.org/index.php/Membership</A>&gt; or making a donation&lt;<A HREF="https://www.owasp.org/index.php/Donate">https://www.owasp.org/index.php/Donate</A>&gt; today!


On Fri, Feb 8, 2019 at 11:48 AM Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt; wrote:

We already as leaders made the call to move to the official OWASP GitHub. The Wiki is highly limited. We're close to deleting those pages and just reference Github. That way we have a comment system and a mature process for tracking requests.

It's already a done deal at this point, I'm sorry Dave.

Aloha, Jim
On 2/8/19 6:40 AM, Dominique Righetto wrote:
Section &quot;Migration Pending&quot; from <A HREF="https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series">https://www.owasp.org/index.php/OWASP_Cheat_Sheet_Series</A>

I understand that you don't follow our communication channel but we use it to communicate and it's the communication process choosen by the project and we have many good feedback about it. Slack members of the CS channel increase at a high speed.

I respect your point of view but, as PL, the wiki mode allow uncontrolled process of edition/creation and Jim/Me are responsible/accountable for the quality/integrity of the CS/projects. Moreover the wiki do not allow integration into CI for create others format or automate control. GH allow also a fully open discution about any operation on CS.

I respect also the fact that you do not like the gihub way but it's the new way followed by new owasp projects (masvs, mstg, asvs, proactive control and the top 10) and it faciliate the contribution even if you dont like it. It's more easy to create a GH account than an OWASP one.

If you dont like this way at the point that it block your to contribute then i understand and respect your position but as PL Jim/Me has decided this way so we will continue the road wihtout you even if we thanks you very very much for your contribution.

--
Cordialement, Best regards,
Dominique Righetto
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
<A HREF="https://righettod.eu">https://righettod.eu</A>
GPG: 323D19BA


On Fri, Feb 8, 2019 at 5:27 PM Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt; wrote:
Clearly indicated on the home page where?  And I don't follow OWASP on Slack or Twitter so I was completely unaware of this.  You say follow 'the process' but I can't find it anywhere.

If you really don't want the cheat sheets to be edited, lock them, and put notes ON the cheat sheets themselves about what the process is/where to find them.

I'm also concerned that this process will make it MUCH harder to contribute, reducing people's willingness to do so (like me).

-Dave


On Thu, Feb 7, 2019 at 11:54 PM Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt; wrote:
Hello all

Since december wiki update of cs are deprecated. It is clearly indicated on the homepage and slack and Twitter and GitHub since 3 month.

If you modify the wiki your update will simply be ignored and lost.

Please follow the process.

All modification and creation of cs is now controlled by Jim and me as PL along Continuous Integration process.

Le ven. 8 f&#233;vr. 2019 &#224; 00:43, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; a &#233;crit :
Hi Dave - Let&#8217;s continue our discussion here so that we have everything tracked in the cheat sheet email list (copying our 1:1 conversation below).

I really appreciate your support in the changes. I have few comments below


a)       Dominique and Jim decided to move cheat sheets to Github. So, all new changes should be on Github CSRF&lt;<A HREF="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.md">https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.md</A>&gt; page. I think they are also working on deprecating the old wiki pages on OWASP. I am fine with all your changes (as most of them are cosmetic/grammatical/structural) except [1]. If you don&#8217;t mind, can you do these changes on the Github? I am fine with you moving the reference example to a different page as well. I have plans to add some other content (not anytime in next month) during which I will also try to trim the content as much as possible.

b)      &#8220;If a developer forgets to add the token to any state changing operation, they are making the application vulnerable to CSRF.&quot; is flat out wrong.  If a dev forgets to add a token, then the server is simply going to reject the request. It's not going to be vulnerable.  If you agree, can you fix this?

&gt;&gt;<i> You are &#8216;assuming&#8217; here that the server has a token verification system which is not true by default. By default, all applications are vulnerable to CSRF unless developers add tokens / the system has a token verification system.
</I>
c)       I am removing the changes related to [1] for now as they are clearly contradicting what we have in other parts of the cheat sheet. If you disagree, I am open to discussion before we get them back to the cheatsheet again. I might be missing something and I would love to hear your side of the story.

1. Earlier, I rejected both the techniques you mentioned in &#8220;Stateless/Tokenless Defense Techniques&#8221; to be in primary because
1.1 X-Requested-With: XMLHttpRequest Header: For the same FLASH related reasons mentioned under this&lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet#Use_of_Custom_Request_Headers&gt; section. On a separate thread, I was working with Riyaz who authored this&lt;<A HREF="https://blog.appsecco.com/exploiting-csrf-on-json-endpoints-with-flash-and-redirects-681d4ad6b31b">https://blog.appsecco.com/exploiting-csrf-on-json-endpoints-with-flash-and-redirects-681d4ad6b31b</A>&gt; blog and you wouldn&#8217;t believe how many old browser versions are still vulnerable to this FLASH based redirect CSRF vulnerability. He also gave link to a HTML wrapper which seems to make this attack work on newer Chrome versions as well. If you are interested, I can provide more details about these. Hence, I don&#8217;t want users to be vulnerable by using this as a primary defense.
1.2 Not a Simple HTTP Request Verification: Again, this is a technique that I rejected in the later section&lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet#Content-Type_Header_Validation&gt; of the document along with the reasoning.

I just made some changes, feel free to review.

I also think this comment: &quot;If a developer forgets to add the token to any state changing operation, they are making the application vulnerable to CSRF.&quot; is flat out wrong.  If a dev forgets to add a token, then the server is simply going to reject the request. It's not going to be vulnerable.  If you agree, can you fix this?

The article is also REALLY LONG. If you can identify anything to trim out, that would be great. I just trimmed out a few things, but I think we can do a lot more. Cheat sheets are supposed to be SHORT, but I realize many are not.

For example, maybe we can move the reference example to a completely different page? That would shorten this alot.

-Dave


On Wed, Feb 6, 2019 at 5:25 PM manideep konakandla &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>&gt;&gt; wrote:
Yes. All those changes passed through review on email list but yes, please feel free to provide any more comments.

On Wed, Feb 6, 2019, 1:21 PM Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt; wrote:
Are you:  Manideepk&lt;<A HREF="https://www.owasp.org/index.php/User:Manideepk">https://www.owasp.org/index.php/User:Manideepk</A>&gt; on the OWASP site?

I have some questions/comments about your changes to the OWASP CSRF Cheat Sheet.

The bulk of those changes are here: <A HREF="https://www.owasp.org/index.php?title=Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&amp;type=revision&amp;diff=244184&amp;oldid=242455">https://www.owasp.org/index.php?title=Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&amp;type=revision&amp;diff=244184&amp;oldid=242455</A>

If this is you, I'll provide more details, but wanted to make sure I'm in touch with the right person first.

-Dave

From: Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
Sent: Sunday, December 23, 2018 4:13 AM
To: Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
Cc: Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet

Thanksyou very much for your support &#128077;&#128077;&#128077;

Le sam. 22 d&#233;c. 2018 &#224; 22:24, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; a &#233;crit :
Let me know once the migration is started. I will do it for the CSRF prevention cheatsheet page &#9786;

From: Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
Sent: Saturday, December 22, 2018 12:29 AM
To: Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
Cc: Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet

Hello Manideep,

Thanks you for the update.

For info we will migrate the entire project content (unless the homepage) to github so it is possible that you need to also made the update on the github repository.

The migration work will start on January, i will take some rest until January, i really need it.

Thanks you very much for your help on this project :)

Happy holidays too

--
Cordialement, Best regards,
Dominique Righetto
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
<A HREF="https://righettod.eu">https://righettod.eu</A>
GPG: 323D19BA


On Sat, Dec 22, 2018 at 3:40 AM Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; wrote:
Hello all,

I made a change to &#8220;Double Submit Cookie&#8221; technique [1]. I added a variant to it which now mitigates well-known security issues with standard &#8220;Double Submit Cookie&#8221; technique. So, people can use this technique without any issues. Please let me know if anyone finds any issues within it.

Whenever I get some free time in next 1-2 months, I am planning to include

a)       Details about popular 6-7 web frameworks and the CSRF mitigations implemented by them

b)      Re-organize the page even more better by switching variant of double submit cookie to primary defense (under stateless section) etc.

Happy holidays everyone &#9786;

[1]  <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet#Double_Submit_Cookie  (read the last para under this mitigation)


From: Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
Sent: Saturday, October 13, 2018 12:59 AM
To: Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
Cc: Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;; Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet

Hi,
CS publishing released and notification sent to the community via Twitter and Slack channel.
--
Cordialement, Best regards,
Dominique Righetto
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
<A HREF="https://righettod.eu">https://righettod.eu</A>
GPG: 323D19BA


On Fri, Oct 12, 2018 at 3:47 AM Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; wrote:
Yes, I am feeling way better now. Thank you &#9786;

@ALL: Cheat sheet is updated with all the changes now&lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet&gt;. Please let me know if you have any issues by end of tomorrow. If there are no issues - I/we can start advertising the refactored cheat sheet in our networks &#9786;

Thanks a ton Dominique and Jim for all your help till date. I really appreciate it!!! I will be actively maintaining this as well from today &#9786;

Regards,
Manideep Konakandla
www.manideepk.com&lt;<A HREF="http://www.manideepk.com">http://www.manideepk.com</A>&gt;
Security Engineer @ Amazon
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;

From: Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;
Sent: Wednesday, October 10, 2018 10:39 PM
To: Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
Cc: Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;; Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet

Go for it!!! I hope you&#8217;re feeling better!
--
Jim Manico
@Manicode


On Oct 10, 2018, at 10:18 PM, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; wrote:
Sorry for late reply. I was on sick leave for last 2 days.

I synced up with Dominique in a different email chain to clarify something in his previous email. He gave me a go ahead to update wiki with new re-factored cheat sheet. I am planning to do it sometime tomorrow. @Jim : Is it with fine with you as well? Please let me know if you have any concerns.

From: Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
Sent: Monday, October 8, 2018 1:47 AM
To: Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
Cc: Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;&gt;; Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet

Hello all,

In order to move forward and deliver something in the project please update the wiki with content from the refactoring from Konakandla Manideep. If there missing points they will be added in another round it is the role of the wiki based usage.

Thanks in advance for your understanding &#128521;

Le lun. 8 oct. 2018 &#224; 10:11, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; a &#233;crit :
Hey Folks &#9786;

Good conversation :) Can you guys review the new cheat sheet once? I am sure most of the discussion going on here is already answered in the new re-factored cheat sheet I wrote.

@Pankaj &#8211; Go through the respective sections in the new cheat sheet. If they are not clear / you are not convinced, we can discuss more. Below is the summary of my response to your questions (you will find the same gist going through the cheat sheet as well).

Go through [2] to understand more detailed on how flash based bypass on CSRF custom mitigation defense works. You can see there that the origin headers are passed along with the custom headers and hence current wiki asks to do origin and/or referrer header check as defense-in-depth (it would help even if flash sometime in the future repeats same mistake and forwards custom headers without crossdomain.xml checks. Domain requesting the redirected request might be fooled with custom header bypass but not the origin header check). If both these checks are done, it is indeed a good defense but origin header is not always included etc. (just as Jim mentioned and also as new cheatsheet mentions).  I don&#8217;t think deprecating custom header check is a good idea. It is indeed a good solution for stateless services though they have to keep issues like I mentioned before in mind. Your statement of custom header itself doesn&#8217;t mitigate CSRF relies on the fact that &#8220;Flash being vulnerable to same bug again in future&#8221;. We cannot rely on a future statement and deprecate a technique, instead providing defense in depth measure for it and also cautioning users about past issues might be good idea. Users can take their call. Please read custom headers and origin check sections I re-wrote for more in-details. It talks about the issues and people can select if they want to use it or not.

Also, Login CSRF has nothing to do with custom header mitigation. Login forms are usually handled on &lt;form&gt; tags and custom header mitigation is only applicable on ajax calls because you cannot set custom headers on form tags. It can be applicable if you are doing logins on Ajax/XHR requests in which case my above response from custom header mitigation applies. I also proposed few methods for mitigating login CSRF which aligns with our primary defense on the new cheatsheet (tokens). Please review it as well.

Also, CORS has nothing to do with CSRF. I infact added CORS as a technique that should not be used/even thought for CSRF in the new cheatsheet I wrote. Please check that and also read [1]

[1] <A HREF="https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2017/september/common-csrf-prevention-misconceptions/">https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2017/september/common-csrf-prevention-misconceptions/</A>
[2] <A HREF="https://www.whitehatsec.com/blog/flash-307-redirect-game-over/">https://www.whitehatsec.com/blog/flash-307-redirect-game-over/</A>

BTW - Here is the link to the new cheat sheet - <A HREF="https://tinyurl.com/y7k9fded">https://tinyurl.com/y7k9fded</A>

Again,  I you are not convinced &#8211; please let me know specific item and we can happily discuss further &#9786; Alternatively, you can send us your edits here for review and if it looks good for everyone &#8211; you can edit it in the wiki.

From: Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
Sent: Sunday, October 7, 2018 1:13 PM
To: Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;&gt;
Cc: Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;; Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
Subject: Re: [OWASP-cheat-sheets] <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet

Sync your update with one from Konakandla Manideep please &#128521;

Le dim. 7 oct. 2018 &#224; 21:54, Pankaj Upadhyay &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">p.upadhyay9999 at gmail.com</A>&gt;&gt; a &#233;crit :
Aloha Jim!
With XSS, even CSRF tokens can be stolen :).
But I'll keep your tip in mind when editing the wiki. I'm planning to do that sometime this month.
Please feel free to review it whenever you guys get a chance.

Best,
Pankaj


On Sun, Oct 7, 2018 at 2:59 PM Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt; wrote:

I agree JWT's architectures where cookies are not involved are resistant to CSRF but those tokens are at the risk of being stolen over XSS!

The Origin header does not go with all requests and FireFox does not fully support it yet. So careful!

:<i>)
</I>
On 10/7/18 9:48 AM, Pankaj Upadhyay wrote:
I agree and that's why I would like to propose deprecation of 'custom header approach' as a CSRF defense.
Presently the mechanism that seems to work across applications is validating custom header as well as a forbidden header name (that cannot be set by a software or a program) e.g. Origin. If we want to give it a new name like 'Double Header Validation' or something else, I'm fine with that but custom header alone doesn't seem sufficient to mitigate CSRF issue.

There are some other best practices that should also be considered. I think CORS is now mature enough to have a mention in the CSRF defense Also, applications utilizing JWT token in the header seem immune to CSRF.

Please let me know what you guys think and if allowed, I can go ahead and make some of these edits for your perusal.


On Sun, Oct 7, 2018 at 2:29 AM Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt; wrote:

--

Jim Manico

Manicode Security

<A HREF="https://www.manicode.com">https://www.manicode.com</A>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20190208/e2e18692/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20190208/e2e18692/attachment-0001.html</A>&gt;
</PRE>





<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000204.html">[OWASP-cheat-sheets]	https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
	<LI>Next message: <A HREF="000209.html">[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#208">[ date ]</a>
              <a href="thread.html#208">[ thread ]</a>
              <a href="subject.html#208">[ subject ]</a>
              <a href="author.html#208">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
