<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets] ECDHE is better
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20ECDHE%20is%20better&In-Reply-To=%3C5396065680934957796%40unknownmsgid%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000029.html">
   <LINK REL="Next"  HREF="000031.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets] ECDHE is better</H1>
    <B>Jim Manico</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20ECDHE%20is%20better&In-Reply-To=%3C5396065680934957796%40unknownmsgid%3E"
       TITLE="[OWASP-cheat-sheets] ECDHE is better">jim.manico at owasp.org
       </A><BR>
    <I>Sat Jun 21 18:17:54 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000029.html">[OWASP-cheat-sheets] ECDHE is better
</A></li>
        <LI>Next message: <A HREF="000031.html">[OWASP-cheat-sheets] DHE versus ECDHE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30">[ date ]</a>
              <a href="thread.html#30">[ thread ]</a>
              <a href="subject.html#30">[ subject ]</a>
              <a href="author.html#30">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Torsten,

(from another expert who shall remain nameless)

If your threat model includes the NSA -- which are suspected to be
behind the parameters of the NIST curves -- then you shouldn't be using TLS
in the first place. That line of thinking isn't very productive. 99.99% of
sites don't have the NSA as their adversary.

It's important to understand what you're defending against.

Some further points:

- I haven't seen any actual _evidence_ that the NIST curves are insecure.
They might or might not be (insecure), but you can't make decisions based
on speculation alone.

- Without ECDHE you're unlikely to have _any_ forward secrecy with
Microsoft platforms. SSL Labs warns about this for OWASP:

<A HREF="https://dev.ssllabs.com/ssltest/analyze.html?d=owasp.org&amp;hideResults=on">https://dev.ssllabs.com/ssltest/analyze.html?d=owasp.org&amp;hideResults=on</A>

- As a rule of thumb, resumption works 50% of the time.

- Curve 25519 is being added to TLS.

- OWASP's DH parameters are only 1024 DH bits, which is about 80 bits
of security. With ECDHE, you'd have super-strong 128 bits. That's a
fact, not speculation ;)

--
Jim Manico
@Manicode
(808) 652-3805

On Jun 19, 2014, at 5:01 PM, Torsten Gigler &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">torsten.gigler at owasp.org</A>&gt;
wrote:

 Hi Jim,

Thank you for forwarding the feedback.

Yes DHE versus ECDHE a very interesting part of the latest discussion, how
to set up Perfect Secrecy.
I have not found *any open Whitelist* saying this or that Elliptic Curve
defined for TLS and used by server and client implementations is secure (as
far as this can be proved today). I found only 4 Curves in
<A HREF="http://safecurves.cr.yp.to,">http://safecurves.cr.yp.to,</A> that were all 4 marked *not* to be safe! From
those marked to be safe, I did not find any that match to the definitions
of TLS (RFC4492, Appendix A).

Do you see any possibility as OWASP to support researches on this, or to
add Curves like Curve 25519 to the TLS standard?

As conclusion for the cheat sheet, I do think to favor a slower and more
secure TLS Cipher over a faster and less secure one (ECDHE) as long as
there do not appear any new inependantly approved Elliptic Curves.
Additionally the disadvantage of the the speed is concerning only the TLS
handshake . This happens only at the begin of a SSL/TLS connection and if
necessary following renegotiation phases, *not* the Data Encryption itself.

I added a hint on this discussion, and a link to the Note about the CPU
usage to the wiki:

&quot;* Favor DHE over ECDHE (and monitor the CPU usage, see Notes below), ECDHE
lacks now of really reliable Elliptic Curves, see discussion about
secp{224,256,384,521}r1 and secp256k1, cf. [2] &lt;<A HREF="http://safecurves.cr.yp.to">http://safecurves.cr.yp.to</A>&gt;,
[3]
&lt;<A HREF="https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1675929">https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1675929</A>&gt;;
One solution might be to use Edwards Curves
&lt;<A HREF="http://eprint.iacr.org/2007/286">http://eprint.iacr.org/2007/286</A>&gt;. The most promising candidate is
'Curve25519' &lt;<A HREF="https://tools.ietf.org/html/draft-josefsson-tls-curve25519-05">https://tools.ietf.org/html/draft-josefsson-tls-curve25519-05</A>&gt;,
that is not yet defined for TLS, cf. IANA
&lt;<A HREF="http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8">http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8</A>&gt;
...
*Notes:*
* ...**Monitor the performance of your server, e.g. the TLS handshake with
DHE hinders the CPU abt 2.4 times more than ECDHE, cf. Vincent Bernat, 2011
&lt;<A HREF="http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html#some-benchmarks">http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html#some-benchmarks</A>&gt;
.&quot;

Kind Regards
Torsten

PS: By the way: 'owap. org' does not support any ECDHE ciphers at the
moment, the first 6 Ciphers for TLSv12 are DHE ones ;-)
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300009E,
DHE-RSA-AES128-GCM-SHA256       , DHE_RSA_WITH_AES_128_GCM_SHA256
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300009F,
DHE-RSA-AES256-GCM-SHA384       , DHE_RSA_WITH_AES_256_GCM_SHA384
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000067,
DHE-RSA-AES128-SHA256           , DHE_RSA_WITH_AES_128_SHA256
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000033,
DHE-RSA-AES128-SHA              , DHE_RSA_WITH_AES_128_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300006B,
DHE-RSA-AES256-SHA256           , DHE_RSA_WITH_AES_256_SHA256
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000039,
DHE-RSA-AES256-SHA              , DHE_RSA_WITH_AES_256_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300009C,
AES128-GCM-SHA256               , RSA_WITH_AES_128_GCM_SHA256
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300009D,
AES256-GCM-SHA384               , RSA_WITH_AES_256_GCM_SHA384
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300003C,
AES128-SHA256                   , RSA_WITH_AES_128_SHA256
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300002F,
AES128-SHA                      , RSA_WITH_AES_128_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x0300003D,
AES256-SHA256                   , RSA_WITH_AES_256_SHA256
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000035,
AES256-SHA                      , RSA_WITH_AES_256_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000005,
RC4-SHA                         , RSA_RC4_128_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000088,
DHE-RSA-CAMELLIA256-SHA         , DHE_RSA_WITH_CAMELLIA_256_CBC_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000084,
CAMELLIA256-SHA                 , RSA_WITH_CAMELLIA_256_CBC_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000045,
DHE-RSA-CAMELLIA128-SHA         , DHE_RSA_WITH_CAMELLIA_128_CBC_SHA
owasp.org,   443, TLSv12 (0x0303), no SNI, Server Order, 0x03000041,
CAMELLIA128-SHA                 , RSA_WITH_CAMELLIA_128_CBC_SHA

If a commonly accepted cipher string is found, I'd suggest to set up
owasp.org as a reference installation ....

Am 18.06.2014 10:33, schrieb Jim Manico:

PS: ECDHE is _much_ faster and generally should be more secure.

(From Ivan)

--
Jim Manico
@Manicode
(808) 652-3805
_______________________________________________
OWASP-cheat-sheets mailing
<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">listOWASP-cheat-sheets at lists.owasp.orghttps</A>://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20140621/7b044545/attachment.html">http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20140621/7b044545/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000029.html">[OWASP-cheat-sheets] ECDHE is better
</A></li>
	<LI>Next message: <A HREF="000031.html">[OWASP-cheat-sheets] DHE versus ECDHE
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#30">[ date ]</a>
              <a href="thread.html#30">[ thread ]</a>
              <a href="subject.html#30">[ subject ]</a>
              <a href="author.html#30">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
