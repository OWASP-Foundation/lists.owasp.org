<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets] DHE versus ECDHE
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20DHE%20versus%20ECDHE&In-Reply-To=%3C53A72C81.8060200%40owasp.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000030.html">
   <LINK REL="Next"  HREF="000032.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets] DHE versus ECDHE</H1>
    <B>Torsten Gigler</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%20DHE%20versus%20ECDHE&In-Reply-To=%3C53A72C81.8060200%40owasp.org%3E"
       TITLE="[OWASP-cheat-sheets] DHE versus ECDHE">torsten.gigler at owasp.org
       </A><BR>
    <I>Sun Jun 22 19:20:33 UTC 2014</I>
    <P><UL>
        <LI>Previous message: <A HREF="000030.html">[OWASP-cheat-sheets] ECDHE is better
</A></li>
        <LI>Next message: <A HREF="000032.html">[OWASP-cheat-sheets] Cheat sheet changes in Sept 2012
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31">[ date ]</a>
              <a href="thread.html#31">[ thread ]</a>
              <a href="subject.html#31">[ subject ]</a>
              <a href="author.html#31">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Dear Jim,

thank you for forwarding this feedback.

Am 21.06.2014 20:17, schrieb Jim Manico:
&gt;<i> Torsten,
</I>&gt;<i>
</I>&gt;<i> (from another expert who shall remain nameless)
</I>It's a pity, it is is easier to discuss with somebody with a name.
&gt;<i>
</I>&gt;<i> If your threat model includes the NSA -- which are suspected to be
</I>&gt;<i> behind the parameters of the NIST curves -- then you shouldn't be 
</I>&gt;<i> using TLS in the first place. That line of thinking isn't very 
</I>&gt;<i> productive. 99.99% of sites don't have the NSA as their adversary.
</I>&gt;<i>
</I>&gt;<i> It's important to understand what you're defending against.
</I>Well, I run for Web Application Security in general. I see this as a 
fundamental Trade-Off between Security, Costs and Usability.
I do see for the decision DHE versus ECDHE in this case:
- Security: There are 2 Ways to realize Perfect Forward Secrecy (PFS) 
with TLS (to obtain long term security for the Transported Data):
   + DHE:     I have not found fundamental discussions about the 
security of this Protocol, which is considered as a reliable indicator 
for that it is simply doing for what is developed
   + ECDHE: There are serious discussions about the security of the 
NIST-Curves: Main issue is that 'Coefficients (are) generated by hashing 
the unexplained seed'. It had been claimed that this was done for 
'performance reasons'. As some cryptography specialists with the highest 
reputation could not confirm this, they even figured out just the 
opposite: &quot;Subsequent research ... showed that essentially all of these 
efficiency-related decisions were suboptimal, that many of them actively 
damaged efficiency, and that some of them were bad for security&quot; 
[<A HREF="http://safecurves.cr.yp.to/">http://safecurves.cr.yp.to/</A>], &quot;I no longer trust the constants. I 
believe the NSA has manipulated them through their relationships with 
industry.&quot; 
[<A HREF="https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1675929">https://www.schneier.com/blog/archives/2013/09/the_nsa_is_brea.html#c1675929</A>]. 

   =&gt; As a conclusion DHE is considered as the *first* and ECDHE only as 
the *second* best practice (from security aspect).

- Costs: As mentioned in the Cheat Sheet &quot;*TLS handshake* with DHE 
hinders the CPU abt 2.4 times more than ECDHE, cf. Vincent Bernat, 2011 
&lt;<A HREF="http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html#some-benchmarks">http://vincent.bernat.im/en/blog/2011-ssl-perfect-forward-secrecy.html#some-benchmarks</A>&gt;.&quot; 
-&gt; I think this is (generally) OK.

- Usability: The Ciphers are transparent for the users, so the worst 
that could happen should be some milliseconds longer time to wait -&gt; OK

So I do think it is a good practice to favor DHE over ECDHE (The server 
negotiates DHE with Browsers that support DHE+ECDHE or DHE, and ECDHE 
with Browsers that support solely ECDHE (like Internet Explorer))
Protection: I think, we should protect our services against any attacker 
if we can bring these 3 things in a line. All other things may be a 
local decision according to a personal risk assessment.
&gt;<i> Some further points:
</I>&gt;<i>
</I>&gt;<i> - I haven't seen any actual _evidence_ that the NIST curves 
</I>&gt;<i> are insecure. They might or might not be (insecure), but you can't 
</I>&gt;<i> make decisions based on speculation alone.
</I>I consider the above results as a fact that the line of arguments about 
the claimed use of the ECDHE parameters is not conclusive in itself (at 
least it could be seen as 'security by obscurity', as long as the 
responsible standardization institution does not explain more detailed 
the reason why the parameters are like they are). So why take the second 
quality? This may change when commonly accepted Curves will be available.
&gt;<i>
</I>&gt;<i> - Without ECDHE you're unlikely to have _any_ forward secrecy with
</I>&gt;<i> Microsoft platforms. SSL Labs warns about this for OWASP:
</I>&gt;<i>
</I>&gt;<i> <A HREF="https://dev.ssllabs.com/ssltest/analyze.html?d=owasp.org&amp;hideResults=on">https://dev.ssllabs.com/ssltest/analyze.html?d=owasp.org&amp;hideResults=on</A>
</I>&gt;<i>
</I>Yes, I agree with this. ECDHE is part of the cipher suite I am 
suggesting in the Cheat Sheet, but as second quality as a fall back for 
software and hardware that does *not* support DHE: E.g. IE7-11 on Vista 
and newer use 'TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)' according to 
my cipher simulation. Latency browsers like IE6/IE8 on XP/Win2003 will 
fall back to 'TLS_RSA_WITH_3DES_EDE_CBC_SHA (0xa)' (without perfect 
forward secrecy).
&gt;<i> - As a rule of thumb, resumption works 50% of the time.
</I>Thanks for this input. I'd like to add this to the 'Notes' section. Do 
you have any link for this?
&gt;<i>
</I>&gt;<i> - Curve 25519 is being added to TLS.
</I>I have *not* found it in the IANA standard, yet: 
<A HREF="http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8">http://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-8</A>
Do you have a latest information on this? Do you know implementations 
for TLS?
&gt;<i>
</I>&gt;<i> - OWASP's DH parameters are only 1024 DH bits, which is about 80 bits 
</I>&gt;<i> of security. With ECDHE, you'd have super-strong 128 bits. That's a 
</I>&gt;<i> fact, not speculation ;)
</I>&gt;<i>
</I>This is an issue of this site of today. I agree with you that this 
should be changed, too: &quot;If a commonly accepted cipher string is found, 
I'd suggest to set up owasp.org &lt;<A HREF="http://owasp.org">http://owasp.org</A>&gt; as a reference 
installation ....&quot; (this goes beyond the cipher sting). But this is a 
different discussion...

Kind regards and stay secure
Torsten
&gt;<i> --
</I>&gt;<i> Jim Manico
</I>&gt;<i> @Manicode
</I>&gt;<i> (808) 652-3805
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20140622/e58ed2b2/attachment.html">http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20140622/e58ed2b2/attachment.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000030.html">[OWASP-cheat-sheets] ECDHE is better
</A></li>
	<LI>Next message: <A HREF="000032.html">[OWASP-cheat-sheets] Cheat sheet changes in Sept 2012
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#31">[ date ]</a>
              <a href="thread.html#31">[ thread ]</a>
              <a href="subject.html#31">[ subject ]</a>
              <a href="author.html#31">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
