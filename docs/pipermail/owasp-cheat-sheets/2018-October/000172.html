<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%0A%20https%3A//www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&In-Reply-To=%3C7d8d7a7e-1b55-43cc-d151-93c7c25c3353%40owasp.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000171.html">
   <LINK REL="Next"  HREF="000173.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet</H1>
    <B>Jim Manico</B> 
    <A HREF="mailto:owasp-cheat-sheets%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-cheat-sheets%5D%0A%20https%3A//www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet&In-Reply-To=%3C7d8d7a7e-1b55-43cc-d151-93c7c25c3353%40owasp.org%3E"
       TITLE="[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">jim.manico at owasp.org
       </A><BR>
    <I>Tue Oct  2 01:54:04 UTC 2018</I>
    <P><UL>
        <LI>Previous message: <A HREF="000171.html">[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
        <LI>Next message: <A HREF="000173.html">[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#172">[ date ]</a>
              <a href="thread.html#172">[ thread ]</a>
              <a href="subject.html#172">[ subject ]</a>
              <a href="author.html#172">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>No rush and no timeline. Let me know when you want our review to start!

Aloha, Jim


On 10/1/18 2:41 PM, Konakandla, Manideep wrote:
&gt;<i>
</I>&gt;<i> For now, I removed the reference to DWR and also added a generic
</I>&gt;<i> statement about .NET protection till someone knows and updates the
</I>&gt;<i> in-details of its current state.
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> I also wanted to let you guys know that I will be off for vacation
</I>&gt;<i> from 16^th of October to end of November with very limited access to
</I>&gt;<i> my work resources and quite sure will be tied up with office work for
</I>&gt;<i> a while after I return. So, let&#8217;s plan to get the updated document on
</I>&gt;<i> OWASP page before October 16th. I am trying my level best from my side
</I>&gt;<i> to get it out ASAP to you guys for review.
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> Are there anything&#8217;s that need to be taken care now so that we can
</I>&gt;<i> save some time after I get the document to you people for review?
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> *From:*Konakandla, Manideep
</I>&gt;<i> *Sent:* Friday, September 28, 2018 6:35 PM
</I>&gt;<i> *To:* 'Jim Manico' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;
</I>&gt;<i> *Cc:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;; Jim Manico
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;; Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;<i> *Subject:* RE:
</I>&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> Login CSRF is a way of exploiting CSRF on login forms (details here
</I>&gt;<i> &lt;<A HREF="https://seclab.stanford.edu/websec/csrf/csrf.pdf">https://seclab.stanford.edu/websec/csrf/csrf.pdf</A>&gt;). Though there is a
</I>&gt;<i> line about it in referrer validation section, it was not explained
</I>&gt;<i> clearly and how it can scale with other techniques such as token based
</I>&gt;<i> mitigation. No worries, I added a section about it!
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> Finally, I am done with the document from my side and its sent for
</I>&gt;<i> internal reviews now. It should take 1-2 weeks before it comes to you
</I>&gt;<i> guys. Meanwhile, I still need help on below items from you guys. If no
</I>&gt;<i> one was able to find references for a), we can very well remove it.
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> a.&#160;&#160;&#160;&#160; Under double submit cookie section, it is mentioned that DWR
</I>&gt;<i> uses that approach but I could not find that anywhere within DWR
</I>&gt;<i> documentation that it uses double submit cookie. Can someone help me
</I>&gt;<i> finding reference if they know any?
</I>&gt;<i>
</I>&gt;<i> b.&#160;&#160;&#160;&#160; One thing I wouldn&#8217;t be reviewing is the ASP.NET
</I>&gt;<i> &lt;<A HREF="http://ASP.NET">http://ASP.NET</A>&gt; references mentioned in the wiki
</I>&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages</A>&gt;.
</I>&gt;<i> Can someone with .NET expertize verify if these are still accurate?
</I>&gt;<i> Looks to me like there are latest resources than the one&#8217;s linked in
</I>&gt;<i> current cheatsheet
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> Happy weekend folks J
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> *From:*Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;
</I>&gt;<i> *Sent:* Thursday, September 27, 2018 3:02 AM
</I>&gt;<i> *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
</I>&gt;<i> *Cc:* Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;; Jim Manico
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;; Dave Wichers
</I>&gt;<i> &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt;;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;;
</I>&gt;<i> <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
</I>&gt;<i> *Subject:* Re:
</I>&gt;<i> <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i> &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> ...as for (d) I dont see any problems with passing tokens as headers
</I>&gt;<i> or parameters
</I>&gt;<i>
</I>&gt;<i> &#160;
</I>&gt;<i>
</I>&gt;<i> I dont understand (e) can you explain that again?
</I>&gt;<i>
</I>&gt;<i> --
</I>&gt;<i>
</I>&gt;<i> Jim Manico
</I>&gt;<i>
</I>&gt;<i> @Manicode
</I>&gt;<i>
</I>&gt;<i> Secure Coding Education
</I>&gt;<i>
</I>&gt;<i> +1 (808) 652-3805
</I>&gt;<i>
</I>&gt;<i>
</I>&gt;<i> On Sep 26, 2018, at 4:46 PM, Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>     2 more questions added &#160;(Jim already started helping me on #a)
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     a.&#160;&#160;&#160;&#160; I requested for an OWASP account and it&#8217;s still in pending.
</I>&gt;<i>     @JIM &#8211; Can you please help me in getting my account approved?
</I>&gt;<i>     (registered with <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>&gt;)
</I>&gt;<i>
</I>&gt;<i>     b.&#160;&#160;&#160;&#160; Under double submit cookie section, it is mentioned that
</I>&gt;<i>     DWR uses that approach but I could not find that anywhere within
</I>&gt;<i>     DWR documentation that it uses double submit cookie. Can someone
</I>&gt;<i>     help me finding reference if they know any?
</I>&gt;<i>
</I>&gt;<i>     c.&#160;&#160;&#160;&#160; One thing I wouldn&#8217;t be reviewing is the ASP.NET
</I>&gt;<i>     &lt;<A HREF="http://ASP.NET">http://ASP.NET</A>&gt; references mentioned in the wiki
</I>&gt;<i>     &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages</A>&gt;.
</I>&gt;<i>     Can someone with .NET expertize verify if these are still
</I>&gt;<i>     accurate? Looks to me like there are latest resources than the
</I>&gt;<i>     one&#8217;s linked
</I>&gt;<i>
</I>&gt;<i>     d.&#160;&#160;&#160;&#160; At few places within the wiki, I have seen recommending to
</I>&gt;<i>     include token in headers for Ajax requests. I also don&#8217;t see a
</I>&gt;<i>     problem in passing them as parameters as well. Do you guys see any?
</I>&gt;<i>
</I>&gt;<i>     e.&#160;&#160;&#160;&#160; I also have not seen at any place within the wiki talking
</I>&gt;<i>     about login CSRF issues and how each of the techniques described
</I>&gt;<i>     can be prone/immune to it. Is there any reason for it or are we
</I>&gt;<i>     open to include that?
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     *From:*Konakandla, Manideep
</I>&gt;<i>     *Sent:* Wednesday, September 26, 2018 5:27 PM
</I>&gt;<i>     *To:* 'Jim Manico' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;;
</I>&gt;<i>     'Dominique Righetto' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
</I>&gt;<i>     *Cc:* 'Jim Manico' &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;; 'Dave Wichers'
</I>&gt;<i>     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt;;
</I>&gt;<i>     '<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;'
</I>&gt;<i>     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;&gt;;
</I>&gt;<i>     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">owasp-cheat-sheets at lists.owasp.org</A>&gt;
</I>&gt;<i>     *Subject:* RE:
</I>&gt;<i>     <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>     &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     Yeah. My understanding of the breadth of exploitation of XSS in an
</I>&gt;<i>     application protected with just origin/referrer and other
</I>&gt;<i>     application protected with just token based mitigation earlier was
</I>&gt;<i>     wrong. Dominique earlier email thread cleared that to me (breadth
</I>&gt;<i>     of exploitation is same in both the cases. i.e., if an XSS
</I>&gt;<i>     vulnerability is found in any individual application protected
</I>&gt;<i>     with only one of those techniques, it still can exploit all state
</I>&gt;<i>     changing operations on entire application [though the complexity
</I>&gt;<i>     of exploitation is easy in origin/referrer check than token based
</I>&gt;<i>     mitigation]).
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     Anyway, I am all clear and also almost done with re-factoring the
</I>&gt;<i>     cheatsheet &#160;[1] JShould be fully completed by Friday unless
</I>&gt;<i>     something comes up meanwhile. I will then send it to my colleagues
</I>&gt;<i>     for review and then for Legal, PR approvals. Before that, I need
</I>&gt;<i>     help from you guys on below items
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     a.&#160;&#160;&#160;&#160; I requested for an OWASP account and it&#8217;s still in pending.
</I>&gt;<i>     @JIM &#8211; Can you please help me in getting my account approved?
</I>&gt;<i>     (registered with <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mani.konakandla at gmail.com</A>&gt;)
</I>&gt;<i>
</I>&gt;<i>     b.&#160;&#160;&#160;&#160; Under double submit cookie section, it is mentioned that
</I>&gt;<i>     DWR uses that approach but I could not find that anywhere within
</I>&gt;<i>     DWR documentation that it uses double submit cookie. Can someone
</I>&gt;<i>     help me finding reference if they know any?
</I>&gt;<i>
</I>&gt;<i>     c.&#160;&#160;&#160;&#160; One thing I wouldn&#8217;t be reviewing is the ASP.NET
</I>&gt;<i>     &lt;<A HREF="http://ASP.NET">http://ASP.NET</A>&gt; references mentioned in the wiki
</I>&gt;<i>     &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet#ASP.NET.2C_MVC_and_.NET_Web_Pages</A>&gt;.
</I>&gt;<i>     Can someone with .NET expertize verify if these are still
</I>&gt;<i>     accurate? Looks to me like there are latest resources than the
</I>&gt;<i>     one&#8217;s linked
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     [1] Below are changes done so far
</I>&gt;<i>
</I>&gt;<i>     a. Switched primary, secondary defense and our reasoning behind it
</I>&gt;<i>     (added lot of reasons on issues with origin/referrer header check
</I>&gt;<i>     and why token should be made primary)
</I>&gt;<i>
</I>&gt;<i>     b. Added CSRF mitigation myths (CORS, content-type validation etc.)
</I>&gt;<i>
</I>&gt;<i>     c. Added a section called &#8220;Not so popular CSRF mitigations&#8221;
</I>&gt;<i>     (mentioned details about triple submit cookie)
</I>&gt;<i>
</I>&gt;<i>     d. Included limitations / issues associated with double submit
</I>&gt;<i>     cookie, same site cookie, captcha as a CSRF defense etc.
</I>&gt;<i>
</I>&gt;<i>     e. Removed lot of obsolete content and added some new content to
</I>&gt;<i>     some of the mitigations
</I>&gt;<i>
</I>&gt;<i>     f. Made document look more better by adding RFC&#8217;s links wherever
</I>&gt;<i>     possible and lot of other minor changes.
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     *From:*Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt;
</I>&gt;<i>     *Sent:* Wednesday, September 26, 2018 4:19 PM
</I>&gt;<i>     *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;; Dominique Righetto
</I>&gt;<i>     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
</I>&gt;<i>     *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i>     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;; Dave Wichers
</I>&gt;<i>     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt;;
</I>&gt;<i>     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>     *Subject:* Re:
</I>&gt;<i>     <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>     &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     Well tokens can be placed in cookies.
</I>&gt;<i>
</I>&gt;<i>     The real answer to avoid CSRF is tokens in JavaScript variable as
</I>&gt;<i>     opposed to cookies. They are not automatically sent and indeed
</I>&gt;<i>     make CSRF impossible - at the expense of tokens being fully stolen
</I>&gt;<i>     via XSS. Pick your poison!
</I>&gt;<i>
</I>&gt;<i>     I recommend a COMBO of these defenses. For web apps, sychronizer
</I>&gt;<i>     token + header verification + re-authentication for sensitive
</I>&gt;<i>     features.
</I>&gt;<i>
</I>&gt;<i>     For API's double-cookie submit or just use JavaScript variable
</I>&gt;<i>     based tokens + header verification for same-site API's +
</I>&gt;<i>     re-authentication for sensitive features.
</I>&gt;<i>
</I>&gt;<i>     &gt; [1] If there is an XSS vulnerability at a single place on a
</I>&gt;<i>     domain (it can add custom header), it can be used to make CSRF
</I>&gt;<i>     */on all other state changing operationswithin that domain /*done
</I>&gt;<i>     to that AJAX endpoint. Do you agree?
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     Absolutely!
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     On 9/20/18 11:12 AM, Konakandla, Manideep wrote:
</I>&gt;<i>
</I>&gt;<i>         Yeah, I understand that any XSS and CSRF game is over but I am
</I>&gt;<i>         stressing out on the highlighted part in [1]. I am trying to
</I>&gt;<i>         highlight and get an affirmation on why my understanding on
</I>&gt;<i>         token based mitigation is better than origin/referrer header
</I>&gt;<i>         check will also apply to &#8220;token based mitigation Vs custom
</I>&gt;<i>         header mitigation (if static tokens are used in custom headers)&#8221;.
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         In case of tokens, we have an option to use different tokens
</I>&gt;<i>         on each page (taking things like URL, timestamp etc. into
</I>&gt;<i>         consideration) and hence XSS vulnerability on one page will
</I>&gt;<i>         only make state changing operations in that page vulnerable to
</I>&gt;<i>         CSRF but not state changing operations on other pages within
</I>&gt;<i>         that domain (because token value is different) but whereas in
</I>&gt;<i>         origin/referrer header check and custom header check, the
</I>&gt;<i>         token value is constant and hence XSS vulnerability in one
</I>&gt;<i>         page will also cause state changing operations in other pages
</I>&gt;<i>         to be vulnerable to CSRF as well. Off course, this can be
</I>&gt;<i>         mitigated in custom header checks by adding tokens to custom
</I>&gt;<i>         headers rather than static constant but this cannot be
</I>&gt;<i>         mitigated in origin/referrer check because those headers
</I>&gt;<i>         cannot be modified. So, yeah a single XSS any CSRF is bypassed
</I>&gt;<i>         but the breadth of the impact is different for each of them.
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         Regarding code samples &#8211; I currently was able to allocate only
</I>&gt;<i>         some time for this task and I don&#8217;t think I will be able to do
</I>&gt;<i>         code samples within this time frame. I am also leaving for a
</I>&gt;<i>         long vacation starting Oct 12 and hence let&#8217;s try to get this
</I>&gt;<i>         out first and we can add code samples later on considering my
</I>&gt;<i>         work load after I return from vacation.
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         [1] If there is an XSS vulnerability at a single place on a
</I>&gt;<i>         domain (it can add custom header), it can be used to make CSRF
</I>&gt;<i>         */on all other state changing operations/**/within that domain
</I>&gt;<i>         /*done to that AJAX endpoint. Do you agree?
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         *From:*Dominique Righetto &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>         *Sent:* Thursday, September 20, 2018 8:45 AM
</I>&gt;<i>         *To:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt; &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;
</I>&gt;<i>         *Cc:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;; Jim Manico
</I>&gt;<i>         &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt; &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;; Dave
</I>&gt;<i>         Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;; <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>         *Subject:* Re:
</I>&gt;<i>         <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>         &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         Hi,
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         Thanks for your contribution.
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         I like very much your plan &#128521;
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         I ask for some favor in addition :
</I>&gt;<i>
</I>&gt;<i>         - can you provide code sample (in one language like java or
</I>&gt;<i>         .net or the one you want but it must be easy to read and
</I>&gt;<i>         understand) or libraires along your proposal for each section?
</I>&gt;<i>
</I>&gt;<i>         - can you use the syntaxhighlight tag for code?
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         I'am agree with Jim, XSS&#160; means game over because your
</I>&gt;<i>         browsing context can be used as proxy so csrf protection will
</I>&gt;<i>         be defeated because request came from the legitimate user.
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         Thanks you again for all your help &#128077;&#128077;&#128077;
</I>&gt;<i>
</I>&gt;<i>         &#160;
</I>&gt;<i>
</I>&gt;<i>         Le jeu. 20 sept. 2018 &#224; 18:31, Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>
</I>&gt;<i>         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim at manicode.com</A>&gt;&gt; a &#233;crit&#160;:
</I>&gt;<i>
</I>&gt;<i>             &gt; If there is an XSS vulnerability at a single place on a
</I>&gt;<i>             domain (it can add custom header), it can be used to make
</I>&gt;<i>             CSRF on all other state changing operations within that
</I>&gt;<i>             domain done to that AJAX endpoint. Do you agree?
</I>&gt;<i>
</I>&gt;<i>             Any XSS is game over and all CSRF are useless in the face
</I>&gt;<i>             of XSS. I Agree!
</I>&gt;<i>
</I>&gt;<i>             - Jim
</I>&gt;<i>
</I>&gt;<i>             &#160;
</I>&gt;<i>
</I>&gt;<i>             On 9/19/18 10:52 PM, Konakandla, Manideep wrote:
</I>&gt;<i>
</I>&gt;<i>                 Hey Guys,
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 [1] is what I said for origin/referrer header check in
</I>&gt;<i>                 this e-mail thread. I also believe that this applies
</I>&gt;<i>                 for custom headers for AJAX endpoints as well. If
</I>&gt;<i>                 there is an XSS vulnerability at a single place on a
</I>&gt;<i>                 domain (it can add custom header), it can be used to
</I>&gt;<i>                 make CSRF on all other state changing operations
</I>&gt;<i>                 within that domain done to that AJAX endpoint. Do you
</I>&gt;<i>                 agree?
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 Here is how I am keeping the new re-factored
</I>&gt;<i>                 cheatsheet. Does this look good to you guys?
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 1.&#160;&#160;&#160;&#160;&#160;&#160; Use token based method as primary defense
</I>&gt;<i>
</I>&gt;<i>                 a.&#160;&#160;&#160;&#160;&#160;&#160; Can use synchronizer pattern for stateful
</I>&gt;<i>                 applications
</I>&gt;<i>
</I>&gt;<i>                 b.&#160;&#160;&#160;&#160;&#160;&#160; Can use hah based/ encryption based token
</I>&gt;<i>                 pattern for stateless applications
</I>&gt;<i>
</I>&gt;<i>                 2.&#160;&#160;&#160;&#160;&#160;&#160; Defense in depth measures along with
</I>&gt;<i>                 drawbacks of each one
</I>&gt;<i>
</I>&gt;<i>                 a.&#160;&#160;&#160;&#160;&#160;&#160; Origin/referrer header check
</I>&gt;<i>
</I>&gt;<i>                 b.&#160;&#160;&#160;&#160;&#160;&#160; Double submit cookie
</I>&gt;<i>
</I>&gt;<i>                 c.&#160;&#160;&#160;&#160;&#160;&#160; Samesite cookie
</I>&gt;<i>
</I>&gt;<i>                 d.&#160;&#160;&#160;&#160;&#160;&#160; Custom headers (people still need to use
</I>&gt;<i>                 tokens for forms etc. if they have mix of ajax
</I>&gt;<i>                 endpoints and general HTML)
</I>&gt;<i>
</I>&gt;<i>                 3.&#160;&#160;&#160;&#160;&#160;&#160; Strong CSRF defenses but very less usable :
</I>&gt;<i>                 captcha etc.
</I>&gt;<i>
</I>&gt;<i>                 4.&#160;&#160;&#160;&#160;&#160;&#160; CSRF Myths / techniques that do not work section
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 [1] if we solely rely on origin/referrer header check
</I>&gt;<i>                 - an XSS vulnerability within a single page on that
</I>&gt;<i>                 domain will also give CSRF vulnerability to all other
</I>&gt;<i>                 state changing operations under that entire domain.
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 *From:*Dominique Righetto
</I>&gt;<i>                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>                 *Sent:* Wednesday, September 12, 2018 1:31 PM
</I>&gt;<i>                 *To:* Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;<i>                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;<i>                 *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;
</I>&gt;<i>                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;; Dave Wichers
</I>&gt;<i>                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;
</I>&gt;<i>                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;;
</I>&gt;<i>                 <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>                 *Subject:* Re:
</I>&gt;<i>                 <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>                 &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 Hi
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 Thanks you very much for the update&#160;
</I>&gt;<i>
</I>&gt;<i>                 &#160;
</I>&gt;<i>
</I>&gt;<i>                 Le mer. 12 sept. 2018 &#224; 21:33, Konakandla, Manideep
</I>&gt;<i>                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A> &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; a
</I>&gt;<i>                 &#233;crit&#160;:
</I>&gt;<i>
</I>&gt;<i>                     Just an update: I started working on this along
</I>&gt;<i>                     with other sprint tasks of mine today. I am hoping
</I>&gt;<i>                     to get it completed by end of next week and then
</I>&gt;<i>                     send it for legal/PR approvals.
</I>&gt;<i>
</I>&gt;<i>                     &#160;
</I>&gt;<i>
</I>&gt;<i>                     *From:*Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i>                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;
</I>&gt;<i>                     *Sent:* Thursday, August 23, 2018 6:49 AM
</I>&gt;<i>                     *To:* Dominique Righetto
</I>&gt;<i>                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;;
</I>&gt;<i>                     Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
</I>&gt;<i>                     *Cc:* Dave Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>
</I>&gt;<i>                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt;;
</I>&gt;<i>                     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;<i>                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>                     *Subject:* Re:
</I>&gt;<i>                     <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>                     &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                     &#160;
</I>&gt;<i>
</I>&gt;<i>                     Awesome! Thank you! :)
</I>&gt;<i>
</I>&gt;<i>                     - Jim
</I>&gt;<i>
</I>&gt;<i>                     &#160;
</I>&gt;<i>
</I>&gt;<i>                     On 8/23/18 2:41 AM, Dominique Righetto wrote:
</I>&gt;<i>
</I>&gt;<i>                         You are welcome :)
</I>&gt;<i>
</I>&gt;<i>                         --
</I>&gt;<i>                         Cordialement, Best regards,
</I>&gt;<i>                         Dominique Righetto
</I>&gt;<i>                         <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
</I>&gt;<i>                         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                         <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                         <A HREF="https://righettod.eu">https://righettod.eu</A>
</I>&gt;<i>                         GPG: 323D19BA
</I>&gt;<i>
</I>&gt;<i>                         &#160;
</I>&gt;<i>
</I>&gt;<i>                         &#160;
</I>&gt;<i>
</I>&gt;<i>                         On Thu, Aug 23, 2018 at 10:33 AM Konakandla,
</I>&gt;<i>                         Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>                         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>                             Np. I will keep u guys posted. Thanks for
</I>&gt;<i>                             the support and have good rest of your day!
</I>&gt;<i>
</I>&gt;<i>                             &#160;
</I>&gt;<i>
</I>&gt;<i>                             *From:*Dominique Righetto
</I>&gt;<i>                             &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
</I>&gt;<i>                             *Sent:* Thursday, August 23, 2018 1:29 AM
</I>&gt;<i>                             *To:* Konakandla, Manideep
</I>&gt;<i>                             &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
</I>&gt;<i>                             *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;; Dave
</I>&gt;<i>                             Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt;;
</I>&gt;<i>                             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>                             *Subject:* Re:
</I>&gt;<i>                             <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>                             &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                             &#160;
</I>&gt;<i>
</I>&gt;<i>                             Hi,
</I>&gt;<i>
</I>&gt;<i>                             &#160;
</I>&gt;<i>
</I>&gt;<i>                             Sounds goods for me.
</I>&gt;<i>
</I>&gt;<i>                             &#160;
</I>&gt;<i>
</I>&gt;<i>                             Thanks again for the contribution :)
</I>&gt;<i>
</I>&gt;<i>                             --
</I>&gt;<i>                             Cordialement, Best regards,
</I>&gt;<i>                             Dominique Righetto
</I>&gt;<i>                             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                             <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                             <A HREF="https://righettod.eu">https://righettod.eu</A>
</I>&gt;<i>                             GPG: 323D19BA
</I>&gt;<i>
</I>&gt;<i>                             &#160;
</I>&gt;<i>
</I>&gt;<i>                             &#160;
</I>&gt;<i>
</I>&gt;<i>                             On Thu, Aug 23, 2018 at 10:03 AM
</I>&gt;<i>                             Konakandla, Manideep &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>                             &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; wrote:
</I>&gt;<i>
</I>&gt;<i>                                 Ok, I received necessary approvals for
</I>&gt;<i>                                 working on this. I am hoping to start
</I>&gt;<i>                                 the work in 2 weeks and then deliver
</I>&gt;<i>                                 the document to you guys for review by
</I>&gt;<i>                                 end of September/1^st week of October
</I>&gt;<i>                                 (might be 1-2 weeks delay if approvals
</I>&gt;<i>                                 from Legal and other teams get
</I>&gt;<i>                                 delayed). My plan is to work on below
</I>&gt;<i>                                 things &#8211; Please let me know if I
</I>&gt;<i>                                 missed anything/you feel something
</I>&gt;<i>                                 else has to be added to this list.
</I>&gt;<i>
</I>&gt;<i>                                 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;
</I>&gt;<i>
</I>&gt;<i>                                 1.&#160;&#160;&#160;&#160;&#160;&#160; Change the order of primary
</I>&gt;<i>                                 and defense in depth measures
</I>&gt;<i>
</I>&gt;<i>                                 2.&#160;&#160;&#160;&#160;&#160;&#160; Include the pitfalls/caveats
</I>&gt;<i>                                 for each CSRF mitigation technique
</I>&gt;<i>                                 (origin/referrer header, samesite,
</I>&gt;<i>                                 double submit cookie etc.)
</I>&gt;<i>
</I>&gt;<i>                                 3.&#160;&#160;&#160;&#160;&#160;&#160; Re-structure entire page and
</I>&gt;<i>                                 remove outdated/ non-relevant stuff
</I>&gt;<i>
</I>&gt;<i>                                 &#160;
</I>&gt;<i>
</I>&gt;<i>                                 *From:*Dominique Righetto
</I>&gt;<i>                                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
</I>&gt;<i>                                 *Sent:* Thursday, August 16, 2018 12:02 PM
</I>&gt;<i>                                 *To:* Konakandla, Manideep
</I>&gt;<i>                                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;
</I>&gt;<i>                                 *Cc:* Jim Manico &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i>                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;; Dave
</I>&gt;<i>                                 Wichers &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>
</I>&gt;<i>                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt;;
</I>&gt;<i>                                 <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;<i>                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>                                 *Subject:* Re:
</I>&gt;<i>                                 <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>                                 &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                                 &#160;
</I>&gt;<i>
</I>&gt;<i>                                 Ok i perfectly understand.
</I>&gt;<i>
</I>&gt;<i>                                 Thanks for the info.
</I>&gt;<i>
</I>&gt;<i>                                 &#160;
</I>&gt;<i>
</I>&gt;<i>                                 Le jeu. 16 ao&#251;t 2018 &#224; 20:33,
</I>&gt;<i>                                 Konakandla, Manideep
</I>&gt;<i>                                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt; a &#233;crit&#160;:
</I>&gt;<i>
</I>&gt;<i>                                     I had an offline discussion with
</I>&gt;<i>                                     Jim and informed him that I will
</I>&gt;<i>                                     have to check few details before I
</I>&gt;<i>                                     give any commitment to update the
</I>&gt;<i>                                     guidance&#8217;s here.
</I>&gt;<i>
</I>&gt;<i>                                     &#160;
</I>&gt;<i>
</I>&gt;<i>                                     Update: I got approval internally
</I>&gt;<i>                                     from my team to work on this (fix
</I>&gt;<i>                                     issues and re-structure entire
</I>&gt;<i>                                     page) but I still need to get
</I>&gt;<i>                                     approval from Legal team to work
</I>&gt;<i>                                     on this. I will let you guys know
</I>&gt;<i>                                     when I hear back from them. Most
</I>&gt;<i>                                     likely they will ask me to just
</I>&gt;<i>                                     get it reviewed with them before
</I>&gt;<i>                                     sending it to you guys for
</I>&gt;<i>                                     review/get it published on OWASP page.
</I>&gt;<i>
</I>&gt;<i>                                     &#160;
</I>&gt;<i>
</I>&gt;<i>                                     *From:*Dominique Righetto
</I>&gt;<i>                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
</I>&gt;<i>
</I>&gt;<i>                                     *Sent:* Tuesday, August 14, 2018
</I>&gt;<i>                                     11:02 PM
</I>&gt;<i>                                     *To:* Jim Manico
</I>&gt;<i>                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;
</I>&gt;<i>                                     *Cc:* Konakandla, Manideep
</I>&gt;<i>                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;&gt;;
</I>&gt;<i>                                     Dave Wichers
</I>&gt;<i>                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;&gt;;
</I>&gt;<i>                                     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>                                     *Subject:* Re:
</I>&gt;<i>                                     <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>                                     &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                                     &#160;
</I>&gt;<i>
</I>&gt;<i>                                     Roadmap has been updated:
</I>&gt;<i>                                     <A HREF="https://trello.com/b/w020m3jQ/cs-roadmap">https://trello.com/b/w020m3jQ/cs-roadmap</A>
</I>&gt;<i>
</I>&gt;<i>                                     --
</I>&gt;<i>                                     Cordialement, Best regards,
</I>&gt;<i>                                     Dominique Righetto
</I>&gt;<i>                                     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                                     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at gmail.com</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                                     <A HREF="https://righettod.eu">https://righettod.eu</A>
</I>&gt;<i>                                     GPG: 323D19BA
</I>&gt;<i>
</I>&gt;<i>                                     &#160;
</I>&gt;<i>
</I>&gt;<i>                                     &#160;
</I>&gt;<i>
</I>&gt;<i>                                     On Mon, Aug 13, 2018 at 6:03 AM
</I>&gt;<i>                                     Dominique Righetto
</I>&gt;<i>                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>
</I>&gt;<i>                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;&gt;
</I>&gt;<i>                                     wrote:
</I>&gt;<i>
</I>&gt;<i>                                         I have finally achieved to
</I>&gt;<i>                                         read the thread, very
</I>&gt;<i>                                         interesting&#160; &#128521;
</I>&gt;<i>
</I>&gt;<i>                                         &#160;
</I>&gt;<i>
</I>&gt;<i>                                         I understand the need to
</I>&gt;<i>                                         simplify the cheat sheet and
</I>&gt;<i>                                         the solutions proposed. It is
</I>&gt;<i>                                         one of the reason why i have
</I>&gt;<i>                                         add code sample. So this
</I>&gt;<i>                                         contribution is a very good point.
</I>&gt;<i>
</I>&gt;<i>                                         &#160;
</I>&gt;<i>
</I>&gt;<i>                                         Just a little thing about
</I>&gt;<i>                                         header, take care to ensure
</I>&gt;<i>                                         that the referrer policy of
</I>&gt;<i>                                         the site is not set to
</I>&gt;<i>                                         no-referrer otherwise you
</I>&gt;<i>                                         cannot use origin/referrer
</I>&gt;<i>                                         headers couple to create a
</I>&gt;<i>                                         protection layer.
</I>&gt;<i>
</I>&gt;<i>                                         &#160;
</I>&gt;<i>
</I>&gt;<i>                                         Tanks you for the helps
</I>&gt;<i>                                         proposal &#128521;
</I>&gt;<i>
</I>&gt;<i>                                         &#160;
</I>&gt;<i>
</I>&gt;<i>                                         &#160;
</I>&gt;<i>
</I>&gt;<i>                                         Le dim. 12 ao&#251;t 2018 &#224; 22:21,
</I>&gt;<i>                                         Jim Manico
</I>&gt;<i>                                         &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>
</I>&gt;<i>                                         &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;&gt;
</I>&gt;<i>                                         a &#233;crit&#160;:
</I>&gt;<i>
</I>&gt;<i>                                             That makes sense. We're
</I>&gt;<i>                                             not going to get consensus
</I>&gt;<i>                                             but you demonstrated
</I>&gt;<i>                                             mastery over this
</I>&gt;<i>                                             material. I am impressed.
</I>&gt;<i>
</I>&gt;<i>                                             Please consider yourself
</I>&gt;<i>                                             owner of the page and edit
</I>&gt;<i>                                             as you see fit. I'll keep
</I>&gt;<i>                                             an eye on your edits and
</I>&gt;<i>                                             make comments as you go.
</I>&gt;<i>
</I>&gt;<i>                                             But please go ahead and
</I>&gt;<i>                                             charge.
</I>&gt;<i>
</I>&gt;<i>                                             &gt; I also personally don&#8217;t
</I>&gt;<i>                                             recommend double submit
</I>&gt;<i>                                             cookies for enterprises
</I>&gt;<i>                                             that have lot of
</I>&gt;<i>                                             subdomains for which they
</I>&gt;<i>                                             might not be sure if they
</I>&gt;<i>                                             are 100% secure
</I>&gt;<i>
</I>&gt;<i>                                             Makes sense, but what DO
</I>&gt;<i>                                             you suggest for stateless
</I>&gt;<i>                                             services and CSRF defense?
</I>&gt;<i>
</I>&gt;<i>                                             Aloha, Jim
</I>&gt;<i>
</I>&gt;<i>                                             &#160;
</I>&gt;<i>
</I>&gt;<i>                                             On 8/10/18 10:41 AM,
</I>&gt;<i>                                             Konakandla, Manideep wrote:
</I>&gt;<i>
</I>&gt;<i>                                                 Thanks. I also
</I>&gt;<i>                                                 personally don&#8217;t
</I>&gt;<i>                                                 recommend double
</I>&gt;<i>                                                 submit cookies for
</I>&gt;<i>                                                 enterprises that have
</I>&gt;<i>                                                 lot of subdomains for
</I>&gt;<i>                                                 which they might not
</I>&gt;<i>                                                 be sure if they are
</I>&gt;<i>                                                 100% secure. More
</I>&gt;<i>                                                 details are explained
</I>&gt;<i>                                                 here
</I>&gt;<i>                                                 &lt;<A HREF="https://media.blackhat.com/eu-13/briefings/Lundeen/bh-eu-13-deputies-still-confused-lundeen-wp.pdf">https://media.blackhat.com/eu-13/briefings/Lundeen/bh-eu-13-deputies-still-confused-lundeen-wp.pdf</A>&gt;(section
</I>&gt;<i>                                                 2.1.1). I think this
</I>&gt;<i>                                                 is something that has
</I>&gt;<i>                                                 to be mentioned in the
</I>&gt;<i>                                                 wiki as well.
</I>&gt;<i>
</I>&gt;<i>                                                 &#160;
</I>&gt;<i>
</I>&gt;<i>                                                 Do we have a consensus
</I>&gt;<i>                                                 process before we edit
</I>&gt;<i>                                                 the page? Or current
</I>&gt;<i>                                                 discussion is enough?&#160;
</I>&gt;<i>                                                 How do we want to go
</I>&gt;<i>                                                 next? I am not quite
</I>&gt;<i>                                                 sure at the moment if
</I>&gt;<i>                                                 I will be able to
</I>&gt;<i>                                                 contribute (I can let
</I>&gt;<i>                                                 you know after
</I>&gt;<i>                                                 checking few details).
</I>&gt;<i>
</I>&gt;<i>                                                 &#160;
</I>&gt;<i>
</I>&gt;<i>                                                 *From:*Jim Manico
</I>&gt;<i>                                                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;
</I>&gt;<i>                                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;
</I>&gt;<i>                                                 *Sent:* Friday, August
</I>&gt;<i>                                                 10, 2018 1:23 PM
</I>&gt;<i>                                                 *To:* Konakandla,
</I>&gt;<i>                                                 Manideep
</I>&gt;<i>                                                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;<i>                                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;;
</I>&gt;<i>                                                 Dominique Righetto
</I>&gt;<i>                                                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>                                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>                                                 *Cc:* Dave Wichers
</I>&gt;<i>                                                 &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;
</I>&gt;<i>                                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;;
</I>&gt;<i>                                                 <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;<i>                                                 &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>                                                 *Subject:* Re:
</I>&gt;<i>                                                 <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>                                                 &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                                                 &#160;
</I>&gt;<i>
</I>&gt;<i>                                                 All I'm saying is that
</I>&gt;<i>                                                 it's a good idea to
</I>&gt;<i>                                                 split browser standard
</I>&gt;<i>                                                 based CSRF defense and
</I>&gt;<i>                                                 defenses that require
</I>&gt;<i>                                                 tokens.
</I>&gt;<i>
</I>&gt;<i>                                                 And you know, I am not
</I>&gt;<i>                                                 at all opposed to
</I>&gt;<i>                                                 making tokens the
</I>&gt;<i>                                                 primary defense. I
</I>&gt;<i>                                                 think that's totally
</I>&gt;<i>                                                 fair. In fact for my
</I>&gt;<i>                                                 words its...
</I>&gt;<i>
</I>&gt;<i>                                                 1) Use a token method
</I>&gt;<i>                                                 - either normal
</I>&gt;<i>                                                 syncronizer tokens or
</I>&gt;<i>                                                 double-submit-cookies
</I>&gt;<i>                                                 for stateless
</I>&gt;<i>                                                 services. This is the
</I>&gt;<i>                                                 main defense in use today.
</I>&gt;<i>
</I>&gt;<i>                                                 2) I also do header
</I>&gt;<i>                                                 defense and think it's
</I>&gt;<i>                                                 secondary. I only use
</I>&gt;<i>                                                 headers by themselves
</I>&gt;<i>                                                 for lower risk
</I>&gt;<i>                                                 services and it's
</I>&gt;<i>                                                 normally easy to
</I>&gt;<i>                                                 deploy as long as I
</I>&gt;<i>                                                 only need to defense
</I>&gt;<i>                                                 posts. If get and
</I>&gt;<i>                                                 posts transact, this
</I>&gt;<i>                                                 becomes tough to deploy.
</I>&gt;<i>
</I>&gt;<i>                                                 3) I always use the
</I>&gt;<i>                                                 samesite cookie for
</I>&gt;<i>                                                 single-domain
</I>&gt;<i>                                                 applications. This
</I>&gt;<i>                                                 gets weird in mash-up
</I>&gt;<i>                                                 cases.
</I>&gt;<i>
</I>&gt;<i>                                                 So yea, I am totally
</I>&gt;<i>                                                 ok for moving tokens
</I>&gt;<i>                                                 to the primary defense
</I>&gt;<i>                                                 of this guide.
</I>&gt;<i>
</I>&gt;<i>                                                 - Jim
</I>&gt;<i>
</I>&gt;<i>                                                 On 8/10/18 10:16 AM,
</I>&gt;<i>                                                 Konakandla, Manideep
</I>&gt;<i>                                                 wrote:
</I>&gt;<i>
</I>&gt;<i>                                                     *This is a false
</I>&gt;<i>                                                     argument. *
</I>&gt;<i>
</I>&gt;<i>                                                     &gt;&gt; I am not sure if
</I>&gt;<i>                                                     you got the
</I>&gt;<i>                                                     context there. It
</I>&gt;<i>                                                     was is in response
</I>&gt;<i>                                                     to Dominique
</I>&gt;<i>                                                     statement which
</I>&gt;<i>                                                     said that we are
</I>&gt;<i>                                                     delegating part of
</I>&gt;<i>                                                     protection to
</I>&gt;<i>                                                     browsers if we
</I>&gt;<i>                                                     solely reply on
</I>&gt;<i>                                                     referrer/origin
</I>&gt;<i>                                                     headers properly
</I>&gt;<i>                                                     and hence we need
</I>&gt;<i>                                                     to depend on token
</I>&gt;<i>                                                     as well (for which
</I>&gt;<i>                                                     you +1&#8217;ed). I am
</I>&gt;<i>                                                     confused now that
</I>&gt;<i>                                                     you are saying it
</I>&gt;<i>                                                     as an browser
</I>&gt;<i>                                                     standard (which
</I>&gt;<i>                                                     means nothing
</I>&gt;<i>                                                     should wrong and
</I>&gt;<i>                                                     we don&#8217;t need to
</I>&gt;<i>                                                     worry about
</I>&gt;<i>                                                     delegating
</I>&gt;<i>                                                     protection to
</I>&gt;<i>                                                     browser). The
</I>&gt;<i>                                                     discussion was
</I>&gt;<i>                                                     also about
</I>&gt;<i>                                                     browsers handling
</I>&gt;<i>                                                     the data.
</I>&gt;<i>                                                     Origin/referrer
</I>&gt;<i>                                                     header check is
</I>&gt;<i>                                                     not easy
</I>&gt;<i>                                                     deployment as well
</I>&gt;<i>                                                     (considering
</I>&gt;<i>                                                     proxies,
</I>&gt;<i>                                                     individual domains
</I>&gt;<i>                                                     when a company
</I>&gt;<i>                                                     has, around 50+
</I>&gt;<i>                                                     subdomains etc.).
</I>&gt;<i>                                                     I feel token
</I>&gt;<i>                                                     mitigation is more
</I>&gt;<i>                                                     easy using some
</I>&gt;<i>                                                     OWASP libraries
</I>&gt;<i>                                                     that provide
</I>&gt;<i>                                                     auto-tokening
</I>&gt;<i>                                                     (this anyway is my
</I>&gt;<i>                                                     personal opinion).
</I>&gt;<i>
</I>&gt;<i>                                                     One more thing we
</I>&gt;<i>                                                     need to remember
</I>&gt;<i>                                                     is that, if we
</I>&gt;<i>                                                     solely rely on
</I>&gt;<i>                                                     origin/referrer
</I>&gt;<i>                                                     header check - an
</I>&gt;<i>                                                     XSS vulnerability
</I>&gt;<i>                                                     within a single
</I>&gt;<i>                                                     page on that
</I>&gt;<i>                                                     domain will also
</I>&gt;<i>                                                     give CSRF
</I>&gt;<i>                                                     vulnerability to
</I>&gt;<i>                                                     all other state
</I>&gt;<i>                                                     changing
</I>&gt;<i>                                                     operations under
</I>&gt;<i>                                                     that entire
</I>&gt;<i>                                                     domain.
</I>&gt;<i>                                                     Considering that
</I>&gt;<i>                                                     and also that
</I>&gt;<i>                                                     depending on
</I>&gt;<i>                                                     browsers to send
</I>&gt;<i>                                                     origin/referrer
</I>&gt;<i>                                                     header &#8211; I feel
</I>&gt;<i>                                                     token should be
</I>&gt;<i>                                                     used as a primary
</I>&gt;<i>                                                     mitigation and
</I>&gt;<i>                                                     origin/referrer
</I>&gt;<i>                                                     header check as
</I>&gt;<i>                                                     defense-in-depth.
</I>&gt;<i>                                                     Do we have any
</I>&gt;<i>                                                     similar issues for
</I>&gt;<i>                                                     tokens? If not &#8211;
</I>&gt;<i>                                                     maybe we should
</I>&gt;<i>                                                     just do that.
</I>&gt;<i>                                                     Either ways, it&#8217;s
</I>&gt;<i>                                                     just my opinion &#8211;
</I>&gt;<i>                                                     if there is no
</I>&gt;<i>                                                     consensus for it,
</I>&gt;<i>                                                     we can just stop
</I>&gt;<i>                                                     the debate and let
</I>&gt;<i>                                                     it be the way it
</I>&gt;<i>                                                     is. I will be more
</I>&gt;<i>                                                     than happy to
</I>&gt;<i>                                                     always learn if
</I>&gt;<i>                                                     there is something
</I>&gt;<i>                                                     that I am missing J
</I>&gt;<i>
</I>&gt;<i>                                                     *&gt; **Also, I know
</I>&gt;<i>                                                     that samesite
</I>&gt;<i>                                                     cookie itself is
</I>&gt;<i>                                                     not supported on
</I>&gt;<i>                                                     all browsers but
</I>&gt;<i>                                                     I&#8217;m more looking
</I>&gt;<i>                                                     towards the text
</I>&gt;<i>                                                     written on the
</I>&gt;<i>                                                     wiki (provides
</I>&gt;<i>                                                     /some/ protection
</I>&gt;<i>                                                     against cross-site
</I>&gt;<i>                                                     request forgery
</I>&gt;<i>                                                     attacks), is the
</I>&gt;<i>                                                     &#8220;some&#8221; here refers
</I>&gt;<i>                                                     to the partial
</I>&gt;<i>                                                     support of the
</I>&gt;<i>                                                     browsers? &#8211; Yes*
</I>&gt;<i>
</I>&gt;<i>                                                     It frankly does
</I>&gt;<i>                                                     not provide that
</I>&gt;<i>                                                     impression here.
</I>&gt;<i>                                                     When me/couple of
</I>&gt;<i>                                                     other
</I>&gt;<i>                                                     colleagues/friends
</I>&gt;<i>                                                     of mine read it,
</I>&gt;<i>                                                     we were thinking
</I>&gt;<i>                                                     on the angle of
</I>&gt;<i>                                                     issue with the
</I>&gt;<i>                                                     technology itself.
</I>&gt;<i>                                                     I will be more
</I>&gt;<i>                                                     than happy to edit
</I>&gt;<i>                                                     it if you guys
</I>&gt;<i>                                                     agree or else
</I>&gt;<i>                                                     again &#8211; we can
</I>&gt;<i>                                                     just let the way
</I>&gt;<i>                                                     it is :)
</I>&gt;<i>
</I>&gt;<i>                                                     &#160;
</I>&gt;<i>
</I>&gt;<i>                                                     *From:*Jim Manico
</I>&gt;<i>                                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;
</I>&gt;<i>                                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">jim.manico at owasp.org</A>&gt;
</I>&gt;<i>                                                     *Sent:* Friday,
</I>&gt;<i>                                                     August 10, 2018
</I>&gt;<i>                                                     12:51 PM
</I>&gt;<i>                                                     *To:* Konakandla,
</I>&gt;<i>                                                     Manideep
</I>&gt;<i>                                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;
</I>&gt;<i>                                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">mkonakan at amazon.com</A>&gt;;
</I>&gt;<i>                                                     Dominique Righetto
</I>&gt;<i>                                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>                                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dominique.righetto at owasp.org</A>&gt;
</I>&gt;<i>                                                     *Cc:* Dave Wichers
</I>&gt;<i>                                                     &lt;<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;
</I>&gt;<i>                                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">dave.wichers at owasp.org</A>&gt;;
</I>&gt;<i>                                                     <A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>
</I>&gt;<i>                                                     &lt;mailto:<A HREF="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">eric.sheridan at owasp.org</A>&gt;
</I>&gt;<i>                                                     *Subject:* Re:
</I>&gt;<i>                                                     <A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF</A>)_Prevention_Cheat_Sheet
</I>&gt;<i>                                                     &lt;<A HREF="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet">https://www.owasp.org/index.php/Cross-Site_Request_Forgery_%28CSRF%29_Prevention_Cheat_Sheet</A>&gt;
</I>&gt;<i>
</I>&gt;<i>                                                     &#160;
</I>&gt;<i>
</I>&gt;<i>                                                     &gt; In a sense/In
</I>&gt;<i>                                                     fact, we rely on
</I>&gt;<i>                                                     browsers to
</I>&gt;<i>                                                     protect CSRF
</I>&gt;<i>                                                     tokens as well &#8211;
</I>&gt;<i>                                                     so if we do not
</I>&gt;<i>                                                     trust browsers for
</I>&gt;<i>                                                     sending
</I>&gt;<i>                                                     referrer/origin
</I>&gt;<i>                                                     headers properly,
</I>&gt;<i>                                                     we shouldn&#8217;t be
</I>&gt;<i>                                                     trusting them to
</I>&gt;<i>                                                     secure our tokens
</I>&gt;<i>
</I>&gt;<i>                                                     This is a false
</I>&gt;<i>                                                     argument. One of
</I>&gt;<i>                                                     these is fully
</I>&gt;<i>                                                     controlled by the
</I>&gt;<i>                                                     browser via
</I>&gt;<i>                                                     browser standards,
</I>&gt;<i>                                                     one of these is
</I>&gt;<i>                                                     controlled by
</I>&gt;<i>                                                     individual
</I>&gt;<i>                                                     programmers.
</I>&gt;<i>
</I>&gt;<i>                                                     &gt; Unless there is
</I>&gt;<i>                                                     anything
</I>&gt;<i>                                                     additional that
</I>&gt;<i>                                                     origin/referrer
</I>&gt;<i>                                                     header check
</I>&gt;<i>                                                     provides that&#8217;s
</I>&gt;<i>                                                     not provided by
</I>&gt;<i>                                                     token based mitigation
</I>&gt;<i>
</I>&gt;<i>                                                     What it also
</I>&gt;<i>                                                     provides is VERY
</I>&gt;<i>                                                     easy deployment
</I>&gt;<i>                                                     capabilities like
</I>&gt;<i>                                                     the same site
</I>&gt;<i>                                                     token. One of
</I>&gt;<i>                                                     these is based on
</I>&gt;<i>                                                     browser standards
</I>&gt;<i>                                                     and again tokens
</I>&gt;<i>
</I>&gt;<i>     &#160;
</I>&gt;<i>
</I>&gt;<i>     -- 
</I>&gt;<i>
</I>&gt;<i>     Jim Manico
</I>&gt;<i>
</I>&gt;<i>     Manicode Security
</I>&gt;<i>
</I>&gt;<i>     <A HREF="https://www.manicode.com">https://www.manicode.com</A>
</I>&gt;<i>
</I>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: &lt;<A HREF="http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20181001/3e821f28/attachment-0001.html">http://lists.owasp.org/pipermail/owasp-cheat-sheets/attachments/20181001/3e821f28/attachment-0001.html</A>&gt;
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000171.html">[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
	<LI>Next message: <A HREF="000173.html">[OWASP-cheat-sheets] https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#172">[ date ]</a>
              <a href="thread.html#172">[ thread ]</a>
              <a href="subject.html#172">[ subject ]</a>
              <a href="author.html#172">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-cheat-sheets">More information about the OWASP-cheat-sheets
mailing list</a><br>
</body></html>
