<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-Ireland] PHP XML Remote Code Execution
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-ireland%40lists.owasp.org?Subject=%5BOWASP-Ireland%5D%20PHP%20XML%20Remote%20Code%20Execution&In-Reply-To=00fc01c5816a%248f291d40%24b700a8c0%40RITSPROD">
   <META NAME="robots" CONTENT="index,nofollow">
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000103.html">
   <LINK REL="Next"  HREF="000097.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-Ireland] PHP XML Remote Code Execution</H1>
    <B>Tony Palmer</B> 
    <A HREF="mailto:owasp-ireland%40lists.owasp.org?Subject=%5BOWASP-Ireland%5D%20PHP%20XML%20Remote%20Code%20Execution&In-Reply-To=00fc01c5816a%248f291d40%24b700a8c0%40RITSPROD"
       TITLE="[OWASP-Ireland] PHP XML Remote Code Execution">tony.palmer at vordel.com
       </A><BR>
    <I>Tue Jul  5 10:57:34 EDT 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000103.html">[OWASP-Ireland] PHP XML Remote Code Execution
</A></li>
        <LI>Next message: <A HREF="000097.html">[OWASP-Ireland] Certified Ethical Hacker Certification - u re	acon?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104">[ date ]</a>
              <a href="thread.html#104">[ thread ]</a>
              <a href="subject.html#104">[ subject ]</a>
              <a href="author.html#104">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Alexis,
   Good point, but I'd never suggest that you rely on the xml firewall
alone, your code still needs to be vigilant wrt its business logic.
I doubt that XML firewalls will ever fully develop the ability to
inspect data with the fullest business logic required and still remain a
pure firewall (even with BPEL). Now theres a Turing discussion I don't
want to get into! 
 
My point is that xml security should be multi-tiered so that any
weaknesses in the application can be snagged at the firewall (e.g. data
validation) and vice versa; weaknesses in the firewall can be addressed
at the application (i.e.lack of business logic). 
 
XML is a little different than other formats when it comes to data
validation. XML must conform to a specific syntax itself and there are
standard tools for examining its infoset(ASN1 anyone?). For example the
description of a Web Service using WSDL and tight XMLSchema constrains
the content appropriate for that service. It is a straightforward and
important check to make before allowing it to reach the application
itself . As Eoin said adding a regular expression to the schema is a
pretty standard and easy patch. As XML processing becomes more the norm
be prepared for more alerts like PHP XML Remote Code Execution.
 
Regards,
Tony
--------------------------------------------------------
Anthony Palmer
Senior Solution Architect 
Mob: (GSM)+353-87-9380331

 

Vordel - XML Web Services security
 &lt;<A HREF="http://www.vordel.com/">http://www.vordel.com/</A>&gt; <A HREF="http://www.vordel.com/">http://www.vordel.com/</A>
Boston, MA, USA Tel:+1-617-848 0974
Dublin, Ireland, EMEA Tel: +353-1-603 1700
--------------------------------------------------------


 

 

-----Original Message-----
From: Alexis FitzGerald [mailto:<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">alexis at rits.ie</A>] 
Sent: 05 July 2005 15:05
To: Tony Palmer; <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">OWASP-Ireland at lists.sourceforge.net</A>
Subject: Re: [OWASP-Ireland] PHP XML Remote Code Execution


Tony,
 
That's an interesting point about &quot;decoupling the security from the
application&quot; and putting the validation in the firewall layer. I agree
with you that it is easier. However I feel that the more validation that
goes into the firewall layer then the more that the firewall needs to
&quot;know&quot; about the application. This is especially true of business logic
validation where you have a relationship across various input fields.
That will probably remain in the application itself.
 
 
 

Alexis FitzGerald
 
Rits, Information Security Centre
2052 Citywest Business Park
Co. Dublin

Tel:      353 (01) 642 0500
Mobile: 353 (87) 2344429
 
 
----- Original Message ----- 

From: Tony  &lt;mailto:<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">tony.palmer at vordel.com</A>&gt; Palmer 
To: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">OWASP-Ireland at lists.sourceforge.net</A> 
Sent: Tuesday, July 05, 2005 12:59 PM
Subject: RE: [OWASP-Ireland] PHP XML Remote Code Execution


Eoin,
    Well thats the beauty of decoupling the security from the
application.
Updating your vulnerable systems and retesting --&gt;Painful
Updating your Firewall Data Validation--&gt;Easy
Tony
 
--------------------------------------------------------
Anthony Palmer
Senior Solution Architect 
Mob: (GSM)+353-87-9380331

 

Vordel - XML Web Services security
 &lt;<A HREF="http://www.vordel.com/">http://www.vordel.com/</A>&gt; <A HREF="http://www.vordel.com/">http://www.vordel.com/</A>
Boston, MA, USA Tel:+1-617-848 0974
Dublin, Ireland, EMEA Tel: +353-1-603 1700
--------------------------------------------------------


 

 

-----Original Message-----
From: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">Eoin.Keary at allianz.ie</A> [mailto:<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">Eoin.Keary at allianz.ie</A>] 
Sent: 05 July 2005 13:44
To: Tony Palmer
Cc: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">OWASP-Ireland at lists.sourceforge.net</A>
Subject: Re: [OWASP-Ireland] PHP XML Remote Code Execution



Excellent!! 

&lt;?xml version=&quot;1.0&quot;?&gt; 
&lt;methodCall&gt; 
&lt;methodName&gt;test.method&lt;/methodName&gt; 
        &lt;params&gt; 
                &lt;param&gt; 
                &lt;value&gt;&lt;name&gt;','')); phpinfo(); exit;/*&lt;/name&gt;&lt;/value&gt; 
                &lt;/param&gt; 
        &lt;/params&gt; 
&lt;/methodCall&gt; 

Do you think that a more stringent approach in the schema would also
help in mitigating against this kind of attack? 
i.e. a RegEX using  [A-Z a-z 1-9]{&lt;length&gt;} - If it fits into the
business requirements. 
So even if the &quot;product&quot; (PHPXMLRPC) vulnerability was not uncovered
that extra layer ( good schema) would defend against unknown exploits. 





Eoin Keary
Contractor
Allianz Ireland
IT Security (Tech Admin)
Security Projects Division
Dir: + 353-1-613-3490
Mob: + 353-87-904-1922
Mailto:<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">eoin.keary at allianz.ie</A>
Ph  01 6133490 




&quot;Tony Palmer&quot; &lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">tony.palmer at vordel.com</A>&gt; 
Sent by: <A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">owasp-ireland-admin at lists.sourceforge.net</A> 


07/05/2005 11:25 AM 


To
&lt;<A HREF="http://lists.owasp.org/mailman/listinfo/owasp-ireland">OWASP-Ireland at lists.sourceforge.net</A>&gt; 

cc

Subject
[OWASP-Ireland] PHP XML Remote Code Execution	

		




 &lt;<A HREF="http://www.gulftech.org/?node=research&amp;article_id=00088-07022005">http://www.gulftech.org/?node=research&amp;article_id=00088-07022005</A>&gt;
<A HREF="http://www.gulftech.org/?node=research&amp;article_id=00088-07022005">http://www.gulftech.org/?node=research&amp;article_id=00088-07022005</A> 
  
--------------------------------------------------------
Anthony Palmer
Senior Solution Architect 
Mob: (GSM)+353-87-9380331 
  
Vordel - XML Web Services security
 &lt;<A HREF="http://www.vordel.com/">http://www.vordel.com/</A>&gt; <A HREF="http://www.vordel.com/">http://www.vordel.com/</A>
Boston, MA, USA Tel:+1-617-848 0974
Dublin, Ireland, EMEA Tel: +353-1-603 1700
-------------------------------------------------------- 





This e-mail is business-confidential and may be privileged. If you are
not
the intended recipient, please notify us immediately and delete it. If
the
email does not relate to Vordel's business then it is neither from nor
authorized by Vordel. Thank you.


************************************************************************
******
This email and any files transmitted with it are confidential and 
intended solely for the use of the individual or entity to whom 
they are addressed. If you have received this email in error please 
contact the Helpdesk at 3955.
************************************************************************
******* 






xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
Allianz Ireland p.l.c. and Allianz Corporate Ireland p.l.c. are
companies of the Allianz Group, Europe's leading global insurer and
provider of financial services. 
For more information on our products and services log on to
www.allianz.ie or call us on (01)613 3000.

The information transmitted is intended only for the person or entity to
which it is addressed and may contain confidential and/or privileged
material. Any review, retransmission, dissemination or other use of, or
taking of any action or reliance upon, this information by persons or
entities other than the intended recipient is prohibited. If you have
received this in error, please contact the sender and delete the
material from your computer.

Allianz Ireland p.l.c. trading as Allianz is regulated by the Irish
Financial Services Regulatory Authority (IFSRA). 
Allianz Corporate Ireland p.l.c. trading as Allianz is regulated by the
Irish Financial Services Regulatory Authority (IFSRA).
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx







This e-mail is business-confidential and may be privileged. If you are
not
the intended recipient, please notify us immediately and delete it. If
the
email does not relate to Vordel's business then it is neither from nor
authorized by Vordel. Thank you.




This e-mail is business-confidential and may be privileged. If you are not
the intended recipient, please notify us immediately and delete it. If the
email does not relate to Vordel's business then it is neither from nor
authorized by Vordel. Thank you.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <A HREF="http://lists.owasp.org/pipermail/owasp-ireland/attachments/20050705/9a41408a/attachment.html">http://lists.owasp.org/pipermail/owasp-ireland/attachments/20050705/9a41408a/attachment.html</A> 
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000103.html">[OWASP-Ireland] PHP XML Remote Code Execution
</A></li>
	<LI>Next message: <A HREF="000097.html">[OWASP-Ireland] Certified Ethical Hacker Certification - u re	acon?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#104">[ date ]</a>
              <a href="thread.html#104">[ thread ]</a>
              <a href="subject.html#104">[ subject ]</a>
              <a href="author.html#104">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="http://lists.owasp.org/mailman/listinfo/owasp-ireland">More information about the Owasp-ireland
mailing list</a><br>
</body></html>
