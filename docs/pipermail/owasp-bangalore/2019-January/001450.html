<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [OWASP-Bangalore] Fwd:  CSP- Implementation Issue - Query
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:owasp-bangalore%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-Bangalore%5D%20Fwd%3A%20%20CSP-%20Implementation%20Issue%20-%20Query&In-Reply-To=%3Cda1d861b-7596-33bc-b8f9-cf40faf6bd84%40captnemo.in%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001449.html">
   <LINK REL="Next"  HREF="001451.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OWASP-Bangalore] Fwd:  CSP- Implementation Issue - Query</H1>
    <B>Nemo</B> 
    <A HREF="mailto:owasp-bangalore%40lists.owasp.org?Subject=Re%3A%20%5BOWASP-Bangalore%5D%20Fwd%3A%20%20CSP-%20Implementation%20Issue%20-%20Query&In-Reply-To=%3Cda1d861b-7596-33bc-b8f9-cf40faf6bd84%40captnemo.in%3E"
       TITLE="[OWASP-Bangalore] Fwd:  CSP- Implementation Issue - Query">me at captnemo.in
       </A><BR>
    <I>Mon Jan 21 20:23:52 UTC 2019</I>
    <P><UL>
        <LI>Previous message: <A HREF="001449.html">[OWASP-Bangalore] CSP- Implementation Issue - Query
</A></li>
        <LI>Next message: <A HREF="001451.html">[OWASP-Bangalore] Backdoor malware sources required
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1450">[ date ]</a>
              <a href="thread.html#1450">[ thread ]</a>
              <a href="subject.html#1450">[ subject ]</a>
              <a href="author.html#1450">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On 1/21/19 5:26 PM, cyber research wrote:

&gt;<i> Below implementation allowed white listed domains only in &quot;script-src&quot;
</I>&gt;<i> directive but a 'unsafe-inline' and 'unsafe-eval' directives also used
</I>&gt;<i> next 'self'.
</I>A CSP Policy only applies on the origin that is current. Or in other
words: the domain that you see on the address bar.

The following CSP:

```
content-security-policy:
script-src <A HREF="https://a.com">https://a.com</A> 'self' 'unsafe-inline' 'unsafe-eval'
```

in english means:

allow script tags on the current webpage (where this header is being
served) to use the following 4 sources.

So a script tag of &lt;script src=&quot;<A HREF="https://a.com/a.js">https://a.com/a.js</A>&quot;&gt; will load, but
&lt;script src=&quot;<A HREF="https://b.com/b.js">https://b.com/b.js</A>&quot;&gt; will immediately get rejected.

The self, unsafe-inline, and unsafe-eval also _only apply on the current
page. If for some reason you have a &lt;iframe src=&quot;x.com&quot;&gt;, this policy
won't apply there.

For eg, for embedded resources, the spec[0] says:

&gt;<i>The policy of the embedding resource controls what may be embedded. The
</I>embedded resource, however, is controlled by the policy delivered with
the resource, or the policy of the embedding resource if the embedded
resource is a globally unique identifier (or a srcdoc frame).

As with all things CSP, it is easiest to answer questions by testing out
things, just setup 2 webservers on different ports and test out by
sending different headers/content and observe the behaviour.

Hope this helps,
Nemo

[0]: <A HREF="https://www.w3.org/TR/CSP2/#which-policy-applies">https://www.w3.org/TR/CSP2/#which-policy-applies</A>
</PRE>


<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001449.html">[OWASP-Bangalore] CSP- Implementation Issue - Query
</A></li>
	<LI>Next message: <A HREF="001451.html">[OWASP-Bangalore] Backdoor malware sources required
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1450">[ date ]</a>
              <a href="thread.html#1450">[ thread ]</a>
              <a href="subject.html#1450">[ subject ]</a>
              <a href="author.html#1450">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.owasp.org/mailman/listinfo/owasp-bangalore">More information about the OWASP-Bangalore
mailing list</a><br>
</body></html>
